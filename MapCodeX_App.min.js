var js={framework:{}};js.framework.base={};js.framework.base.McxJsFramework={};js.framework.base.McxJsFramework.McxAjaxServiceCall={};function McxAjaxServiceCall(){}McxAjaxServiceCall.getAjaxCall=function(a,b,c,d,e,f,g,h,k){return McxAjaxServiceCall.AjaxCall("GET",null,a,b,"application/x-www-form-urlencoded; charset=UTF-8",c,d,e,f,g,h,k)};McxAjaxServiceCall.postAjaxCall=function(a,b,c,d,e,f,g,h,k,m,n){return McxAjaxServiceCall.AjaxCall("POST",b,a,c,d,e,f,g,h,k,m,n)};
McxAjaxServiceCall.PostAjaxStreamCall=function(a,b,c,d,e){var f=new XMLHttpRequest;f.onprogress=c;f.onloadend=d;f.onerror=e;f.open("POST",a,!0);f.setRequestHeader("Accept","application/json, text/javascript, */*; q=0.01");f.send(b);return f};
McxAjaxServiceCall.AjaxCall=function(a,b,c,d,e,f,g,h,k,m,n,p){a="GET"==a?{type:a,url:c,data:d,contentType:e,qty_input:f,dataType:g,cache:h,processData:!1,jsonp:!1,async:m,success:n,error:p}:{type:a,url:c,data:d,contentType:e,qty_input:f,dataType:g,cache:h,async:m,success:n,error:p};null!=k&&(a.timeout=k);null!=b&&(a.crossDomain=b);b=$.ajax(a);b.onprogress=function(){};return b};js.framework.base.McxJsFramework.McxBase={};
var COMPILED=!1,mcx={global:this,inherits:function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a},base:function(a,b,c){var d=arguments.callee.caller;if(d.superClass_)return d.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var e=Array.prototype.slice.call(arguments,2),f=!1,g=a.constructor;g;g=g.superClass_&&g.superClass_.constructor)if(g.prototype[b]===d)f=!0;else if(f)return g.prototype[b].apply(a,e);
if(a[b]===d)return a.constructor.prototype[b].apply(a,e)},provide:function(a){if(!COMPILED){if(mcx.isProvided_(a))return;delete mcx.implicitNamespaces_[a];for(var b=a;(b=b.substring(0,b.lastIndexOf(".")))&&!mcx.getObjectByName(b);)mcx.implicitNamespaces_[b]=!0}mcx.exportPath_(a)}};COMPILED||(mcx.isProvided_=function(a){return!mcx.implicitNamespaces_[a]&&!!mcx.getObjectByName(a)},mcx.implicitNamespaces_={});
mcx.exportPath_=function(a,b){var c=a.split("."),d=mcx.global;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&mcx.isDef(b)?d[e]=b:d=d[e]?d[e]:d[e]={}};mcx.getObjectByName=function(a,b){for(var c=a.split("."),d=b||mcx.global,e;e=c.shift();)if(mcx.isDefAndNotNull(d[e]))d=d[e];else return null;return d};mcx.isDefAndNotNull=function(a){return null!=a};mcx.isDef=function(a){return void 0!==a};
mcx.sleep=function(a){for(var b=(new Date).getTime(),c=0;1E7>c&&!((new Date).getTime()-b>a);c++);};mcx.exportSymbol=function(a,b){mcx.exportPath_(a,b)};mcx.abstractMethod=function(){alert("unimplemented abstract method")};mcx.notSupported=function(){alert("not supported")};mcx.notImplemented=function(){alert("not implemented")};mcx.areStringEqual=function(a,b,c){return a==b?!0:null==a||null==b?!1:c&&a.toLowerCase()==b.toLowerCase()?!0:!1};
mcx.getBase64Image=function(a){var b=document.createElement("canvas");b.innerHTML="yes";b.width=a.width;b.height=a.height;b.getContext("2d").drawImage(a,0,0);return b.toDataURL().replace(/^data:image\/(png|jpg);base64,/,"")};mcx.isInstanceOf=function(a,b){return a?a instanceof b?!0:mcx.isDefAndNotNull(a.superClass_)?mcx.isInstanceOf(a.superClass_,b):!1:!1};
String.format||(String.format=function(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(/\{(\d+)\}/g,function(a,d){return d in b?b[d]:a})});mcx.proxy=function(a,b,c){return function(){return a.apply(b||this,c)}};mcx.cry=function(a){return CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(a),CryptoJS.enc.Utf8.parse("8080808080808080"),{keySize:16,iv:CryptoJS.enc.Utf8.parse("8080808080808080"),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}).toString()};
mcx.urlEncode=function(a){return encodeURI(a).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/\+/g,"%2B")};mcx.urlDecode=function(a){return decodeURI((a+"").replace(/\+/g,"%20").replace(/%/g,"%25"))};
mcx.mm2Px=function(a,b){var c=function(a,b){var c=new String(a);if(-1!=c.indexOf("E")||-1!=c.indexOf("e")){var d=/^(\d+.\d+)[Ee]([\+\-]?\d+)$/.exec(a),e="",c="";if(null!=d){e=d[1];c=d[2];var d=e,e=d+" ",n=e.match(/e/i);if("e"!=n&&"E"!=n){var n=d*=1,p=0;0>d&&(d*=-1,p=1);var q=Math.pow(.1,b);d<10*q?d=n:(e.length>b+1&&(d=d.toFixed(b),d=d.replace(/0+$/,""),d=d.replace(/\.$/,"")),1==p&&(d*=-1))}10==d&&(d=1,c="+"+(1*c+1));return d=d+"e"+c}}return a},d=function(a,b){var d=a+" ",e=d.match(/e/i);if("e"==e||
"E"==e)return a=c(a,b);a*=1;e=0;0>a&&(a*=-1,e=1);d.length>b+1&&(a=a.toFixed(b),a=a.replace(/0+$/,""),a=a.replace(/\.$/,""));1==e&&(a*=-1);return a},e=function(a){var b=a;0>a&&(a*=-1);var e=new String(a);if(-1!=e.indexOf("E")||-1!=e.indexOf("e"))return a=c(a,6);a*=1;if(1E8<a)return a=a.toExponential(8),a=c(a,6);.1<a?a=d(a,6):.01<a?a=d(a,8):.01>a&&1E-4<a?a=d(a,10):1E-4>a&&1E-6<a?a=d(a,12):1E-6>a&&1E-8<a?a=d(a,14):1E-8>a&&1E-10<a?a=d(a,16):1E-10>a&&1E-12<a?a=d(a,18):1E-12>a&&1E-14<a?a=d(a,20):1E-14>
a&&1E-16<a?a=d(a,22):1E-16>a&&1E-18<a?a=d(a,24):1E-18>a&&1E-20<a?a=d(a,26):1E-20>a&&1E-22<a?a=d(a,28):1E-22>a&&1E-24<a&&(a=d(a,30));0>b&&(a*=-1);return a};return function(a,b){var c=0,d=0;if(""!=a&&""!=b||""==a&&""==b)return 0;""!=a&&(a*=1,c+=1);""!=b&&(b*=1,c+=1);if(1!=c)return 0;""==a&&(a=e(.26458333331386*b),d=1);""==b&&(b=3.7795275593333*a,b=e(b));return 0==d?b:a}(a,b)};mcx.version="Developer Version";js.framework.base.McxJsFramework.McxClassName={};function McxClassName(){}McxClassName.getObjectClassName=function(a){return/(\w+)\(/.exec(a.constructor.toString())[1]};js.framework.base.McxJsFramework.McxColor={};function McxColor(){this._hex="000";this._blue=this._green=this._red=0}McxColor.prototype.setColorFromHex=function(a){this._hex=a;a=McxColor.hexToRgb(a);this._red=parseFloat(a.r);this._green=parseFloat(a.g);this._blue=parseFloat(a.b)};McxColor.prototype.setColorFromRgb=function(a,b,c){this._red=a;this._green=b;this._blue=c;this._hex=McxColor.rgbToHex(a,b,c)};McxColor.prototype.getRed=function(){return Math.round(this._red)};
McxColor.prototype.getGreen=function(){return Math.round(this._green)};McxColor.prototype.getBlue=function(){return Math.round(this._blue)};McxColor.prototype.getHex=function(){return this._hex};McxColor.prototype.getRgbStyleString=function(){return"rgb("+this.getRed()+","+this.getGreen()+","+this.getBlue()+")"};McxColor.prototype.getRgbReverseStyleString=function(){return"rgb("+(255-this.getRed())+","+(255-this.getGreen())+","+(255-this.getBlue())+")"};
McxColor.fromRgb=function(a,b,c){var d=new McxColor;d.setColorFromRgb(a,b,c);return d};McxColor.fromHex=function(a){var b=new McxColor;b.setColorFromHex(a);return b};McxColor.getSoftColor=function(){var a=McxRandomizer.getRandomInt(0,255),b=100*Math.random(),c=McxRandomizer.getRandomInt(192,224)/255*100;return"hsl("+a.toString()+","+b.toString()+"%,"+c.toString()+"%)"};
McxColor.fromRgbRange=function(a,b){var c=McxRandomizer.getRandomInt(a,b),d=McxRandomizer.getRandomInt(a,b),e=McxRandomizer.getRandomInt(a,b);return"rgb("+c.toString()+","+d.toString()+",F"+e.toString()+")"};McxColor.getSharpColor=function(){return McxColor.fromRgbRange(0,128)};McxColor.getRandomColor=function(){for(var a="0123456789ABCDEF".split(""),b="#",c=0;6>c;c++)b+=a[Math.round(15*Math.random())];return b};McxColor.rgbToHex=function(a,b,c){return(16777216+(a<<16)+(b<<8)+c).toString(16).slice(1)};
McxColor.hslToHex=function(a,b,c){a=McxColor.hslToRgb(a,b,c);return McxColor.rgbToHex(a.r,a.g,a.b)};
McxColor.hslToRgb=function(a,b,c){var d,e;isFinite(a)||(a=0);isFinite(b)||(b=0);isFinite(c)||(c=0);a/=60;0>a&&(a=6- -a%6);a%=6;b=Math.max(0,Math.min(1,b/100));c=Math.max(0,Math.min(1,c/100));e=(1-Math.abs(2*c-1))*b;d=e*(1-Math.abs(a%2-1));1>a?(a=e,b=d,d=0):2>a?(a=d,b=e,d=0):3>a?(a=0,b=e):4>a?(a=0,b=d,d=e):5>a?(a=d,b=0,d=e):(a=e,b=0);c-=e/2;a=Math.round(255*(a+c));b=Math.round(255*(b+c));d=Math.round(255*(d+c));return{r:a,g:b,b:d}};
McxColor.hexToRgb=function(a){return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:{r:0,g:0,b:0}};McxColor.toHex=function(a){a=a.toString(16);1==a.length&&(a="0"+a);return a};
McxColor.extractColorAndAlpha=function(a){McxColor.ctx.clearRect(0,0,1,1);McxColor.ctx.fillStyle=a;McxColor.ctx.fillRect(0,0,1,1);a=McxColor.ctx.getImageData(0,0,1,1).data;return{color:"#"+McxColor.toHex(a[0])+McxColor.toHex(a[1])+McxColor.toHex(a[2]),alpha:Math.round(1E3*a[3]/255)/1E3}};var canvas=document.createElement("canvas");canvas.width=canvas.height=1;McxColor.ctx=canvas.getContext("2d");
McxColor.colorStringToHex=function(a){return"#"===a.substr(0,1)?a:-1<a.indexOf("rgb")?McxColor.rgbStringToHex(a):-1<a.indexOf("hsl")?McxColor.hslStringToHex(a):"#000"};McxColor.rgbStringToHex=function(a){var b=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(a),b=b||/(.*?)rgb\((\d+),(\d+),(\d+)\)/.exec(a);a=parseFloat(b[2]);var c=parseFloat(b[3]);a=parseFloat(b[4])|c<<8|a<<16;return b[1]+"#"+a.toString(16)};McxColor.hslStringToHex=function(a){a=McxColor.hslStringToRgb(a);return McxColor.rgbStringToHex(a)};
McxColor.hslStringToRgb=function(a){var b=/(.*?)hsl\((\d+), (\d+), (\d+)\)/.exec(a),b=b||/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(a);a=parseFloat(b[1]);var c=parseFloat(b[2]),b=parseFloat(b[3]),d,e;isFinite(a)||(a=0);isFinite(c)||(c=0);isFinite(b)||(b=0);a/=60;0>a&&(a=6- -a%6);a%=6;c=Math.max(0,Math.min(1,c/100));b=Math.max(0,Math.min(1,b/100));e=(1-Math.abs(2*b-1))*c;d=e*(1-Math.abs(a%2-1));1>a?(a=e,c=d,d=0):2>a?(a=d,c=e,d=0):3>a?(a=0,c=e):4>a?(a=0,c=d,d=e):5>a?(a=d,c=0,d=e):(a=e,c=0);b-=e/
2;a=Math.round(255*(a+b));c=Math.round(255*(c+b));d=Math.round(255*(d+b));return"rgb("+a+","+c+","+d+")"};js.framework.base.McxJsFramework.McxCursors={};
var McxCursors={auto:"auto",move:"move,",noDrop:"no-drop",colResize:"col-resize",allScroll:"all-scroll",pointer:"pointer",notAllowed:"not-allowed",rowResize:"row-resize",crossHair:"crosshair",progress:"progress",eResize:"e-resize",neResize:"ne-resize",Default:"default",text:"text",nResize:"n-resize",nwResize:"nw-resize",help:"help",verticalText:"vertical-text",sResize:"s-resize",seResize:"se-resize",inherit:"inherit",wait:"wait",wResize:"w-resize",swResize:"sw-resize",none:"none",openHand:"$McxApplication/assets/img/hand_open.cur",
closeHand:"$McxApplication/assets/img/hand_close.cur",zoomWindow:"$McxApplication/assets/img/zoom_window.cur",selectFeature:"$McxApplication/assets/img/hand2.cur",measure:"$McxApplication/assets/img/measure.cur",location:"$McxApplication/assets/img/location.cur"};js.framework.base.McxJsFramework.McxEventArgs={};function McxEventArgs(a){this.args=a||Object}McxEventArgs.prototype.getArgs=function(){return this.args};js.framework.base.McxJsFramework.McxCancelEventArgs={};function McxCancelEventArgs(a){mcx.base(this,a);this.cancelled=!1}mcx.inherits(McxCancelEventArgs,McxEventArgs);McxCancelEventArgs.prototype.cancel=function(){this.cancelled=!0};McxCancelEventArgs.prototype.isCanceled=function(){return this.cancelled};js.framework.base.McxJsFramework.McxEventHandler={};function McxEventHandler(){this.onSuccesslisteners=[];this.onFailedlisteners=[];this.listenerScopes=[]}McxEventHandler.prototype.addListener=function(a,b,c){null!=a&&(this.onSuccesslisteners.push(a),this.onFailedlisteners.push(b),this.listenerScopes.push(c))};
McxEventHandler.prototype.removeListener=function(a){if(null!=a)for(var b=0;b<this.onSuccesslisteners.length;b++)this.onSuccesslisteners[b]==a&&(this.onSuccesslisteners[b]=null,this.onSuccesslisteners.splice(b,1),this.onFailedlisteners[b]=null,this.onFailedlisteners.splice(b,1),this.listenerScopes[b]=null,this.listenerScopes.splice(b,1))};
McxEventHandler.prototype.dispatchOnSuccess=function(a,b){for(var c=0;c<this.onSuccesslisteners.length;c++){var d=this.listenerScopes[c];null==d&&(d=a);this.onSuccesslisteners[c].call(d,b)}};McxEventHandler.prototype.dispatchOnFailed=function(a,b){for(var c=0;c<this.onFailedlisteners.length;c++)this.onFailedlisteners[c].call(a,b)};js.framework.base.McxJsFramework.McxGuid={};var McxGuid={createGuid:function(){var a=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()).toUpperCase()}};js.framework.base.McxJsFramework.McxKeyCode={};
var McxKeyCode={none:0,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,capsLock:20,escape:27,space:32,"page up":33,"page down":34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,"delete":46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,add:107,subtract:109};js.framework.base.McxJsFramework.McxKeyEventArgs={};function McxKeyEventArgs(a){this.keyCode=McxKeyCode.none;this.altKey=a.altKey;this.ctrlKey=a.ctrlKey;this.shiftKey=a.shiftKey;this.initialize(a)}McxKeyEventArgs.prototype.initialize=function(a){a.which?this.keyCode=a.which:a.keyCode?this.keyCode=a.keyCode:a.charCode&&(this.keyCode=a.charCode)};McxKeyEventArgs.prototype.getKeyCode=function(){return this.keyCode};McxKeyEventArgs.prototype.altKeyPresses=function(){return this.altKey};
McxKeyEventArgs.prototype.ctrlKeyPresses=function(){return this.ctrlKey};McxKeyEventArgs.prototype.shiftKeyPresses=function(){return this.shiftKey};js.framework.base.McxJsFrameWork={};js.framework.base.McxJsFrameWork.McxLocalizationManager={};function McxLocalizationManager(){}McxLocalizationManager._localeFolderPathArray={};McxLocalizationManager._bannedLocaleFolderPathArray={};var currentLanguage=$.defaultLanguage;McxLocalizationManager.onLocalizationDoneHandler=function(){McxLocalizationManager._localizationDoneHandler||(McxLocalizationManager._localizationDoneHandler=new McxEventHandler);return McxLocalizationManager._localizationDoneHandler};
McxLocalizationManager.addLocalePath=function(a){a=McxPathFinder.getFullPath(a);McxLocalizationManager._bannedLocaleFolderPathArray[a]||(McxLocalizationManager._localeFolderPathArray[a]=a)};
McxLocalizationManager.applyLocalization=function(a){currentLanguage=a=a||currentLanguage||"en";var b=0,c;for(c in McxLocalizationManager._localeFolderPathArray)$("[data-localize]").localize(McxLocalizationManager._localeFolderPathArray[c],{language:a,callback:function(a,c){c(a);b++;b==Object.keys(McxLocalizationManager._localeFolderPathArray).length&&McxLocalizationManager.onLocalizationDoneHandler().dispatchOnSuccess(null,null)},error:$.proxy(McxLocalizationManager.onError,{path:c})})};
McxLocalizationManager.addBannedLocalePath=function(a){a=McxPathFinder.getFullPath(a);McxLocalizationManager._bannedLocaleFolderPathArray[a]=a};McxLocalizationManager.applyPath=function(a){a=McxPathFinder.getFullPath(a);""!=a&&($("[data-localize]").localize(a,{language:currentLanguage}),McxLocalizationManager._localeFolderPathArray[a]=a)};McxLocalizationManager.deletePath=function(a){a=McxPathFinder.getFullPath(a);delete McxLocalizationManager._localeFolderPathArray[a]};
McxLocalizationManager.onError=function(){McxLocalizationManager._bannedLocaleFolderPathArray[this.path]=this.path;McxLocalizationManager.deletePath(this.path)};McxLocalizationManager.getLocaleValue=function(a){var b=a.split("-"),c=null;2==b.length&&(c=b[0]);for(var d in McxLocalizationManager._localeFolderPathArray){!$.localize.data[d]&&c&&-1<d.toString().indexOf(c)&&McxLocalizationManager.downloadPath(d);for(var e in $.localize.data[d])if(e==a)return $.localize.data[d][e]||a}return a};
McxLocalizationManager.getLanguage=function(){return currentLanguage};
McxLocalizationManager.localizeContent=function(a,b,c){if(a)if(b)b=McxPathFinder.getFullPath(b),0==mcx.isDefAndNotNull(McxLocalizationManager._localeFolderPathArray[b])&&McxLocalizationManager.addLocalePath(b),a.is("[data-localize]")&&a.localize(McxLocalizationManager._localeFolderPathArray[b],{language:McxLocalizationManager.getLanguage(),async:!c,error:$.proxy(McxLocalizationManager.onError,{path:b})}),a.find("[data-localize]").localize(McxLocalizationManager._localeFolderPathArray[b],{language:McxLocalizationManager.getLanguage(),
async:!c,error:$.proxy(McxLocalizationManager.onError,{path:b})});else for(var d in McxLocalizationManager._localeFolderPathArray)a.is("[data-localize]")&&a.localize(McxLocalizationManager._localeFolderPathArray[d],{language:McxLocalizationManager.getLanguage(),async:!c,error:$.proxy(McxLocalizationManager.onError,{path:b})}),a.find("[data-localize]").localize(McxLocalizationManager._localeFolderPathArray[d],{language:McxLocalizationManager.getLanguage(),async:!c,error:$.proxy(McxLocalizationManager.onError,
{path:b})})};McxLocalizationManager.downloadPath=function(a){a=McxPathFinder.getFullPath(a);0==mcx.isDefAndNotNull(McxLocalizationManager._localeFolderPathArray[a])&&McxLocalizationManager.addLocalePath(a);$("<div/>").localize(McxLocalizationManager._localeFolderPathArray[a],{language:McxLocalizationManager.getLanguage(),async:!1})};js.framework.base.McxJsFramework.McxMath={};var McxMath={radianToDegree:function(a){return 57.2957795*a},degreeToRadian:function(a){return.0174532925*a},geographicToDecimals:function(a){var b=a.split("*");a=parseFloat(b[0]);var c=parseFloat(b[1]),b=parseFloat(b[2]);return a+c/60+b/3600}};js.framework.base.McxJsFramework.McxMobile={};function McxMobile(){}McxMobile.checkIfMobile=function(){return 767>$(window).width()};
McxMobile.isMobile={Android:function(){return null!=navigator.userAgent.match(/Android/i)},BlackBerry:function(){return null!=navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return null!=navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return null!=navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return null!=navigator.userAgent.match(/IEMobile/i)},any:function(){return McxMobile.isMobile.Android()||McxMobile.isMobile.BlackBerry()||McxMobile.isMobile.iOS()||McxMobile.isMobile.Opera()||
McxMobile.isMobile.Windows()}};js.framework.base.McxJsFramework.McxMouseEventArgs={};function McxMouseEventArgs(a){this.y=this.x=0;this.button="none";this.wheelDelta=0;this.event={};a&&(this.event=a,this.initialize(a))}
McxMouseEventArgs.prototype.initialize=function(a){var b;a||(a=window.event);a.target?b=a.currentTarget:a.srcElement&&(b=a.srcElement);3==b.nodeType&&(b=b.parentNode);this.x=a.pageX-$(b).offset().left;this.y=a.pageY-$(b).offset().top;this.button="left";1==a.button?this.button="middle":2==a.button&&(this.button="right");this.wheelDelta=0>a.detail||0<a.wheelDelta?.5:2};McxMouseEventArgs.prototype.getX=function(){return this.x};McxMouseEventArgs.prototype.getY=function(){return this.y};
McxMouseEventArgs.prototype.setX=function(a){this.x=a};McxMouseEventArgs.prototype.setY=function(a){this.y=a};McxMouseEventArgs.prototype.getWheelDelta=function(){return this.wheelDelta};McxMouseEventArgs.prototype.setWheelDelta=function(a){this.wheelDelta=a};McxMouseEventArgs.prototype.getButton=function(){return this.button};McxMouseEventArgs.prototype.setButton=function(a){this.button=a};McxMouseEventArgs.prototype.getEvent=function(){return this.event};js.framework.base.McxJsFramework.McxPathFinder={};
var McxPathFinder={addonPaths:[],addAddonPath:function(a){McxPathFinder.addonPaths.push(a)},getFullPath:function(a){if(null==a||""==a)return a;var b="";if("$"==a[0]){a=a.split("/");for(var c=a[0].replace("$",""),d=document.getElementsByTagName("script"),e=[],f=0;f<McxPathFinder.addonPaths.length;f++)e.push(McxPathFinder.addonPaths[f]);for(f=0;f<d.length;f++)e.push(d[f].src);for(f=0;f<e.length;f++){var g=e[f],d=!1;if(-1!=g.indexOf(c)){for(var g=g.split("/"),h=0;h<g.length-1;h++){if(g[h]==c){d=!0;break}b+=
g[h]+"/"}if(d){b+=c+"/";for(f=1;f<a.length;f++)b+=a[f],f<a.length-1&&(b+="/");break}else b=""}}e=document.getElementsByTagName("mcxpath");for(f=0;f<e.length;f++)if(d=e[f],g=d.getAttribute("src"),h=d.getAttribute("name"),d=!1,c==h){g=g.split("/");for(h=0;h<g.length-1;h++){if(g[h]==c){d=!0;break}b+=g[h]+"/"}if(d){b+=c+"/";for(f=1;f<a.length;f++)b+=a[f],f<a.length-1&&(b+="/");break}else b=""}return b}return a}};js.framework.base.McxJsFramework.McxRandomizer={};function McxRandomizer(){}McxRandomizer.getRandomNumber=function(a,b){return Math.random()*(b-a)+a};McxRandomizer.getRandomInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a};js.framework.base.McxJsFramework.McxTouchEventArgs={};function McxTouchEventArgs(a){this.time=this.wheelDelta=this.deltaY=this.deltaX=this.y=this.x=0;this.initialize(a)}McxTouchEventArgs.prototype.initialize=function(a){var b=a.gesture;this.wheelDelta=b.scale;var c;a.target?c=a.target:a.srcElement&&(c=a.srcElement);3==c.nodeType&&(c=a.parentNode);this.x=a.gesture.center.pageX-$(c).offset().left;this.y=a.gesture.center.pageY-$(c).offset().top;this.deltaY=b.deltaY;this.deltaX=b.deltaX;this.time=b.deltaTime};
McxTouchEventArgs.prototype.getX=function(){return this.x};McxTouchEventArgs.prototype.getY=function(){return this.y};McxTouchEventArgs.prototype.getWheelDelta=function(){return this.wheelDelta};McxTouchEventArgs.prototype.getDeltaX=function(){return this.deltaX};McxTouchEventArgs.prototype.getDeltaY=function(){return this.deltaY};McxTouchEventArgs.prototype.getDeltaTime=function(){return this.time};js.framework.base.McxJsFramework.McxXmlNode={};function McxXmlNode(a){this._xmlJqueryElem=null;this.initialize(a)}McxXmlNode.prototype.initialize=function(a){var b=null;try{b="string"===typeof a?$.parseXML(a):a}catch(c){}this._xmlJqueryElem=$(b)};McxXmlNode.prototype.getNodes=function(a){var b=[];this._xmlJqueryElem.children().children(a.toLowerCase()).each(function(a,d){b.push(new McxXmlNode(this))});return b};
McxXmlNode.prototype.findNodes=function(a){var b=[];this.find(a).each(function(a,d){b.push(new McxXmlNode(this))});return b};McxXmlNode.prototype.getAttributeValue=function(a){return this._xmlJqueryElem.attr(a)?this._xmlJqueryElem.attr(a).toString():this._xmlJqueryElem.attr(a.toLowerCase()).toString()};McxXmlNode.prototype.getValue=function(){return this._xmlJqueryElem.text().toString()};McxXmlNode.prototype.setValue=function(a){this._xmlJqueryElem.text(a)};
McxXmlNode.prototype.addAttributeValue=function(a,b){this._xmlJqueryElem.attr(a,b)};McxXmlNode.prototype.appendNode=function(a){mcx.isDefAndNotNull(a)&&this._xmlJqueryElem.append(a._xmlJqueryElem[0])};McxXmlNode.prototype.appendTextNode=function(a,b){var c=document.createElement(a),c=new McxXmlNode(c);c.setValue(b);this.appendNode(c);return c};McxXmlNode.prototype.getSingleNode=function(a){return new McxXmlNode(this.get(a)[0])};McxXmlNode.prototype.findSingleNode=function(a){return new McxXmlNode(this.find(a)[0])};
McxXmlNode.prototype.toString=function(){return(new XMLSerializer).serializeToString(this._xmlJqueryElem[0])};McxXmlNode.prototype.hasChildNode=function(a){return 0<this.find(a).length};McxXmlNode.prototype.find=function(a){return this._xmlJqueryElem.find("*").filter(function(){return this.nodeName.toLowerCase()==a.toLowerCase()})};McxXmlNode.prototype.get=function(a){return this._xmlJqueryElem.children().filter(function(){return this.nodeName.toLowerCase()==a.toLowerCase()})};
McxXmlNode.prototype.getNodeName=function(){return this._xmlJqueryElem[0].nodeName.toString().toLowerCase()};McxXmlNode.prototype.isEmpty=function(){return 0==this._xmlJqueryElem.length};McxXmlNode.prototype.hasAttribute=function(a){return mcx.isDefAndNotNull(this._xmlJqueryElem.attr(a)||this._xmlJqueryElem.attr(a.toLowerCase())||this._xmlJqueryElem.attr(a.toUpperCase()))};
McxXmlNode.prototype.stringToXML=function(a){if(window.ActiveXObject){var b=new ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(a)}else b=(new DOMParser).parseFromString(a,"text/xml");return b};js.framework.base.McxJsFramework.McxXMLReader={};function McxXMLReader(){}McxXMLReader.createXMLDocFromString=function(a){var b;window.DOMParser?b=(new DOMParser).parseFromString(a,"text/xml"):(b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(a));return b};McxXMLReader.createXmlDocument=function(a){return new McxXmlNode(a)};McxXMLReader.createXmlNode=function(a){a=document.createElement(a);return new McxXmlNode(a)};
js.framework.base.McxCoreGis={};js.framework.base.McxCoreGis.CoordinateSystem={};js.framework.base.McxCoreGis.CoordinateSystem.IMcxCoordinateSystem={};function IMcxCoordinateSystem(a){}IMcxCoordinateSystem.prototype.getName=function(){};IMcxCoordinateSystem.prototype.getCode=function(){};IMcxCoordinateSystem.prototype.getUnits=function(){};IMcxCoordinateSystem.prototype.equals=function(a){};IMcxCoordinateSystem.prototype.toString=function(){};IMcxCoordinateSystem.prototype.getDistancePerUnit=function(){};
IMcxCoordinateSystem.prototype.toWkt=function(){};js.framework.base.McxCoreGis.CoordinateSystem.IMcxCoordinateSystemFactory={};function IMcxCoordinateSystemFactory(){}IMcxCoordinateSystemFactory.prototype.createCoordinateSystem=function(a){};js.framework.base.McxCoreGis.CoordinateSystem.IMcxCoordinateTransform={};function IMcxCoordinateTransform(){}IMcxCoordinateTransform.prototype.transformGeometry=function(a,b,c){};IMcxCoordinateTransform.prototype.transform=function(a,b,c,d){};js.framework.base.McxCoreGis.CoordinateSystem.IMcxCoordinateTransformFactory={};function IMcxCoordinateTransformFactory(){}IMcxCoordinateTransformFactory.prototype.createCoordinateTransform=function(){};js.framework.base.McxCoreGis.Data={};js.framework.base.McxCoreGis.Data.IMcxAjaxParameter={};function IMcxAjaxParameter(){}IMcxAjaxParameter.prototype.getSuccess=function(){};IMcxAjaxParameter.prototype.getError=function(){};IMcxAjaxParameter.prototype.getScope=function(){};IMcxAjaxParameter.prototype.getArgs=function(){};IMcxAjaxParameter.prototype.setArgs=function(a){};IMcxAjaxParameter.prototype.getAsync=function(){};IMcxAjaxParameter.prototype.setAsync=function(a){};
IMcxAjaxParameter.prototype.setParameters=function(a,b,c){};IMcxAjaxParameter.prototype.getCacheable=function(){};IMcxAjaxParameter.prototype.setCacheable=function(a){};IMcxAjaxParameter.prototype.getTimeOut=function(){};IMcxAjaxParameter.prototype.setTimeOut=function(a){};IMcxAjaxParameter.prototype.setRange=function(a,b){};IMcxAjaxParameter.prototype.getMin=function(){};IMcxAjaxParameter.prototype.getMax=function(){};js.framework.base.McxCoreGis.Data.IMcxCodedValue={};function IMcxCodedValue(){}IMcxCodedValue.prototype.getCode=function(){};IMcxCodedValue.prototype.getValue=function(){};js.framework.base.McxCoreGis.Data.IMcxDataSource={};function IMcxDataSource(){}IMcxDataSource.prototype.getName=function(){};IMcxDataSource.prototype.getSource=function(){};IMcxDataSource.prototype.getDriver=function(){};IMcxDataSource.prototype.getLayer=function(a,b,c){};IMcxDataSource.prototype.createLayer=function(a,b,c,d){};IMcxDataSource.prototype.deleteLayer=function(a){};IMcxDataSource.prototype.copyLayer=function(a,b,c){};IMcxDataSource.prototype.fullTextSearch=function(a,b,c,d){};
IMcxDataSource.prototype.testCapability=function(a){};js.framework.base.McxCoreGis.Data.IMcxDomain={};function IMcxDomain(){}IMcxDomain.prototype.getDomainName=function(){};IMcxDomain.prototype.getCodedValues=function(){};IMcxDomain.prototype.lookup=function(a){};js.framework.base.McxCoreGis.Data.IMcxDomainDataSource={};function IMcxDomainDataSource(){}IMcxDomainDataSource.prototype.createDomain=function(a){};IMcxDomainDataSource.prototype.deleteDomain=function(a){};IMcxDomainDataSource.prototype.alterDomain=function(a,b){};IMcxDomainDataSource.prototype.createCodedValue=function(a,b){};IMcxDomainDataSource.prototype.deleteCodedValue=function(a,b){};IMcxDomainDataSource.prototype.alterCodedValue=function(a,b,c){};
IMcxDomainDataSource.prototype.getDomain=function(a,b){};IMcxDomainDataSource.prototype.getDomains=function(a){};js.framework.base.McxCoreGis.Data.IMcxDriver={};function IMcxDriver(){}IMcxDriver.prototype.getName=function(){};IMcxDriver.prototype.getDriverID=function(){};IMcxDriver.prototype.openDataSource=function(a){};IMcxDriver.prototype.testCapability=function(a){};IMcxDriver.prototype.getDataSourceInfo=function(a,b,c){};IMcxDriver.prototype.getLayerInfo=function(a,b,c,d,e){};js.framework.base.McxCoreGis.Data.IMcxEdit={};function IMcxEdit(){}IMcxEdit.prototype.insert=function(a,b){};IMcxEdit.prototype.insertRange=function(a,b){};IMcxEdit.prototype.update=function(a,b){};IMcxEdit.prototype.updateRange=function(a,b){};IMcxEdit.prototype.delete=function(a,b){};IMcxEdit.prototype.deleteRange=function(a,b){};IMcxEdit.prototype.deleteFeature=function(a,b){};IMcxEdit.prototype.deleteFeatureRange=function(a,b){};js.framework.base.McxCoreGis.Data.IMcxFeature={};function IMcxFeature(){}IMcxFeature.prototype.getSymbolizer=function(){};IMcxFeature.prototype.setSymbolizer=function(a){};IMcxFeature.prototype.getLayer=function(){};IMcxFeature.prototype.getSchema=function(){};IMcxFeature.prototype.getFieldCount=function(){};IMcxFeature.prototype.getField=function(a){};IMcxFeature.prototype.getFieldName=function(a){};IMcxFeature.prototype.getFieldOrdinal=function(a){};IMcxFeature.prototype.getFieldType=function(a){};
IMcxFeature.prototype.getValue=function(a){};IMcxFeature.prototype.setValue=function(a,b){};IMcxFeature.prototype.getFeatureID=function(){};IMcxFeature.prototype.setFeatureID=function(a){};IMcxFeature.prototype.getGlobalID=function(){};IMcxFeature.prototype.setGlobalID=function(a){};IMcxFeature.prototype.getGeometry=function(){};IMcxFeature.prototype.setGeometry=function(a){};IMcxFeature.prototype.unChangeField=function(a){};IMcxFeature.prototype.isFieldChange=function(a){};
IMcxFeature.prototype.isInstanceOf=function(a){};IMcxFeature.prototype.convertToString=function(a){};js.framework.base.McxCoreGis.Data.IMcxFeatureReader={};function IMcxFeatureReader(){}IMcxFeatureReader.prototype.read=function(){};IMcxFeatureReader.prototype.getCurrent=function(){};IMcxFeatureReader.prototype.addFeature=function(a){};IMcxFeatureReader.prototype.count=function(){};IMcxFeatureReader.prototype.toArray=function(){};js.framework.base.McxCoreGis.Data.IMcxFieldDefinition={};function IMcxFieldDefinition(){}IMcxFieldDefinition.prototype.getFieldName=function(){};IMcxFieldDefinition.prototype.setFieldName=function(a){};IMcxFieldDefinition.prototype.getAlias=function(){};IMcxFieldDefinition.prototype.setAlias=function(a){};IMcxFieldDefinition.prototype.getFieldType=function(){};IMcxFieldDefinition.prototype.setFieldType=function(a){};IMcxFieldDefinition.prototype.getSize=function(){};
IMcxFieldDefinition.prototype.setSize=function(a){};IMcxFieldDefinition.prototype.getPrecision=function(){};IMcxFieldDefinition.prototype.setPrecision=function(a){};IMcxFieldDefinition.prototype.isPrimaryKey=function(){};IMcxFieldDefinition.prototype.setIsPrimaryKey=function(a){};IMcxFieldDefinition.prototype.isRequired=function(){};IMcxFieldDefinition.prototype.setIsRequired=function(a){};IMcxFieldDefinition.prototype.isEditable=function(){};IMcxFieldDefinition.prototype.setIsEditable=function(a){};
IMcxFieldDefinition.prototype.getDomainName=function(){};IMcxFieldDefinition.prototype.setDomainName=function(a){};IMcxFieldDefinition.prototype.getDefaultValue=function(){};IMcxFieldDefinition.prototype.setDefaultValue=function(a){};IMcxFieldDefinition.prototype.isIgnored=function(){};IMcxFieldDefinition.prototype.setIsIgnored=function(a){};IMcxFieldDefinition.prototype.setDescription=function(a){};IMcxFieldDefinition.prototype.getDescription=function(){};IMcxFieldDefinition.prototype.clone=function(){};js.framework.base.McxCoreGis.Data.IMcxFilter={};function IMcxFilter(){}IMcxFilter.prototype.getGeometry=function(){};IMcxFilter.prototype.setGeometry=function(a){};IMcxFilter.prototype.getSpatialRelation=function(){};IMcxFilter.prototype.setSpatialRelation=function(a){};IMcxFilter.prototype.getAttributeFilter=function(){};IMcxFilter.prototype.setAttributeFilter=function(a){};IMcxFilter.prototype.getFilterId=function(){};IMcxFilter.prototype.setFilterId=function(a){};
IMcxFilter.prototype.getBounds=function(){};js.framework.base.McxCoreGis.Data.IMcxFilterCollection={};function IMcxFilterCollection(){}IMcxFilterCollection.prototype.getFilter=function(a){};IMcxFilterCollection.prototype.indexOf=function(a){};IMcxFilterCollection.prototype.add=function(a){};IMcxFilterCollection.prototype.addRange=function(a){};IMcxFilterCollection.prototype.insert=function(a,b){};IMcxFilterCollection.prototype.clear=function(){};IMcxFilterCollection.prototype.containsGuid=function(a){};
IMcxFilterCollection.prototype.containsFilter=function(a){};IMcxFilterCollection.prototype.find=function(a){};IMcxFilterCollection.prototype.removeWithGuid=function(a){};IMcxFilterCollection.prototype.removeFilter=function(a){};IMcxFilterCollection.prototype.removeAt=function(a){};IMcxFilterCollection.prototype.removeRange=function(a){};IMcxFilterCollection.prototype.getCount=function(){};IMcxFilterCollection.prototype.getFilterAddedEventHandler=function(){};
IMcxFilterCollection.prototype.getFilterRemovedEventHandler=function(){};IMcxFilterCollection.prototype.getFilterResetEventHandler=function(){};IMcxFilterCollection.prototype.toString=function(){};js.framework.base.McxCoreGis.Data.IMcxLayer={};function IMcxLayer(){}IMcxLayer.prototype.getClassId=function(){};IMcxLayer.prototype.getName=function(){};IMcxLayer.prototype.getFullName=function(){};IMcxLayer.prototype.getAlias=function(){};IMcxLayer.prototype.setAlias=function(a){};IMcxLayer.prototype.getInfo=function(a){};IMcxLayer.prototype.getDataSource=function(){};IMcxLayer.prototype.getKeyField=function(){};IMcxLayer.prototype.getGuidField=function(){};
IMcxLayer.prototype.getGeometryField=function(){};IMcxLayer.prototype.getSymbolizerField=function(){};IMcxLayer.prototype.getLabelSymbolizerField=function(){};IMcxLayer.prototype.getGeometryType=function(){};IMcxLayer.prototype.getFeatureCount=function(a){};IMcxLayer.prototype.getEnvelope=function(a){};IMcxLayer.prototype.getCoordinateSystem=function(){};IMcxLayer.prototype.setCoordinateSystem=function(a){};IMcxLayer.prototype.findFeature=function(a){};IMcxLayer.prototype.createEdit=function(){};
IMcxLayer.prototype.spatialOperation=function(a,b,c,d){};IMcxLayer.prototype.getVisible=function(){};IMcxLayer.prototype.setVisible=function(a){};IMcxLayer.prototype.getOrder=function(){};IMcxLayer.prototype.setOrder=function(a){};IMcxLayer.prototype.setMinScale=function(a){};IMcxLayer.prototype.getVisibilityChangeHandler=function(){};IMcxLayer.prototype.getOpacityChangeHandler=function(){};IMcxLayer.prototype.getMinScale=function(){};IMcxLayer.prototype.setMaxScale=function(a){};
IMcxLayer.prototype.getMaxScale=function(){};IMcxLayer.prototype.setScaledLines=function(a){};IMcxLayer.prototype.getScaledLines=function(){};IMcxLayer.prototype.setEditable=function(a){};IMcxLayer.prototype.getEditable=function(){};IMcxLayer.prototype.setSymbolizer=function(a){};IMcxLayer.prototype.getSymbolizer=function(){};IMcxLayer.prototype.isCacheable=function(){};IMcxLayer.prototype.setCacheable=function(a){};IMcxLayer.prototype.isSingleTile=function(){};IMcxLayer.prototype.setSingleTile=function(a){};
IMcxLayer.prototype.isInstanceOf=function(a){};IMcxLayer.prototype.createFeatureBuffer=function(){};IMcxLayer.prototype.isInsertSupported=function(){};IMcxLayer.prototype.isDeleteSupported=function(){};IMcxLayer.prototype.isUpdateSupported=function(){};IMcxLayer.prototype.onFeatureInserted=function(a){};IMcxLayer.prototype.onFeatureInserting=function(a){};IMcxLayer.prototype.onFeaturesDeleted=function(a){};IMcxLayer.prototype.onFeaturesUpdated=function(a){};IMcxLayer.prototype.setOpacity=function(a){};
IMcxLayer.prototype.getOpacity=function(){};IMcxLayer.prototype.getFeatureInsertedEventHandler=function(){};IMcxLayer.prototype.getFeatureInsertingEventHandler=function(){};IMcxLayer.prototype.getFeatureDeletedEventHandler=function(){};IMcxLayer.prototype.getFeatureDeletingEventHandler=function(){};IMcxLayer.prototype.getFeatureUpdatedEventHandler=function(){};IMcxLayer.prototype.getFeatureUpdatingEventHandler=function(){};IMcxLayer.prototype.getGroupName=function(){};
IMcxLayer.prototype.setGroupName=function(a){};IMcxLayer.prototype.getDataSourceName=function(){};IMcxLayer.prototype.testCapability=function(a){};IMcxLayer.prototype.isShowLabels=function(){};IMcxLayer.prototype.setShowLabels=function(a){};IMcxLayer.prototype.isScaledLabels=function(){};IMcxLayer.prototype.setScaledLabels=function(a){};IMcxLayer.prototype.getMinLabelScale=function(){};IMcxLayer.prototype.setMinLabelScale=function(a){};IMcxLayer.prototype.getMaxLabelScale=function(){};
IMcxLayer.prototype.setMaxLabelScale=function(a){};IMcxLayer.prototype.getLabelFormat=function(){};IMcxLayer.prototype.setLabelFormat=function(a){};IMcxLayer.prototype.labelOf=function(a){};IMcxLayer.prototype.getLabelSymbolizer=function(){};IMcxLayer.prototype.setLabelSymbolizer=function(a){};IMcxLayer.prototype.getLabelVisibilityChangedEventHandler=function(){};IMcxLayer.prototype.getLabelScalabilityChangedEventHandler=function(){};IMcxLayer.prototype.getLabelVisibleRangeChangedEventHandler=function(){};
IMcxLayer.prototype.getLabelFormatChangedEventHandler=function(){};IMcxLayer.prototype.getLabelSymbolizerChangedEventHandler=function(){};IMcxLayer.prototype.getSubtypes=function(){};IMcxLayer.prototype.getTag=function(){};IMcxLayer.prototype.setTag=function(a){};IMcxLayer.prototype.getSubtypeChangedEventHandler=function(){};IMcxLayer.prototype.setSubtypeType=function(a){};IMcxLayer.prototype.getSubtypeType=function(){};IMcxLayer.prototype.getFeatures=function(a,b){};
IMcxLayer.prototype.setClassId=function(a){};IMcxLayer.prototype.setName=function(a){};IMcxLayer.prototype.setFullName=function(a){};IMcxLayer.prototype.setKeyField=function(a){};IMcxLayer.prototype.getGlobalIdField=function(){};IMcxLayer.prototype.setGlobalIdField=function(a){};IMcxLayer.prototype.setGeometryField=function(a){};IMcxLayer.prototype.setSymbolizerField=function(a){};IMcxLayer.prototype.setLabelSymbolizerField=function(a){};IMcxLayer.prototype.setGeometryType=function(a){};
IMcxLayer.prototype.getQuery=function(){};IMcxLayer.prototype.setSnappable=function(a){};IMcxLayer.prototype.getSnappable=function(){};IMcxLayer.prototype.getSnappableChangedEventHandler=function(){};IMcxLayer.prototype.setSelectable=function(a){};IMcxLayer.prototype.isSelectable=function(){};IMcxLayer.prototype.setSelectionColor=function(a){};IMcxLayer.prototype.getSelectionColor=function(){};IMcxLayer.prototype.getSelectionOpacity=function(){};IMcxLayer.prototype.setSelectionOpacity=function(a){};
IMcxLayer.prototype.getSelectionCount=function(){};IMcxLayer.prototype.getSelectableChangedEventHandler=function(){};IMcxLayer.prototype.getAddSelectionEventHandler=function(){};IMcxLayer.prototype.getRemoveSelectionEventHandler=function(){};IMcxLayer.prototype.getSelectionColorChangedEventHandler=function(){};IMcxLayer.prototype.addSelection=function(a){};IMcxLayer.prototype.clearSelection=function(){};IMcxLayer.prototype.getSelection=function(){};IMcxLayer.prototype.isFeatureSelected=function(a){};
IMcxLayer.prototype.removeSelection=function(a){};IMcxLayer.prototype.onSelectionChanged=function(a){};IMcxLayer.prototype.setPainterMode=function(a){};IMcxLayer.prototype.getPainterMode=function(){};IMcxLayer.prototype.createField=function(a){};IMcxLayer.prototype.deleteField=function(a){};IMcxLayer.prototype.alterField=function(a,b){};IMcxLayer.prototype.getSchema=function(){};IMcxLayer.prototype.getFilterCollection=function(){};IMcxLayer.prototype.query=function(a,b,c){};
IMcxLayer.prototype.search=function(a,b,c,d,e){};IMcxLayer.prototype.getUniqueId=function(){};IMcxLayer.prototype.setUniqueId=function(a){};js.framework.base.McxCoreGis.Data.IMcxMarker={};function IMcxMarker(){}IMcxMarker.prototype.getMarkerId=function(){};IMcxMarker.prototype.getGeometry=function(){};IMcxMarker.prototype.setGeometry=function(a){};IMcxMarker.prototype.setSymbolizer=function(a){};IMcxMarker.prototype.getSymbolizer=function(){};IMcxMarker.prototype.paint=function(a){};IMcxMarker.prototype.getTag=function(){};IMcxMarker.prototype.setTag=function(a){};IMcxMarker.prototype.getMinLabelScale=function(){};
IMcxMarker.prototype.setMinLabelScale=function(a){};IMcxMarker.prototype.getMaxLabelScale=function(){};IMcxMarker.prototype.setMaxLabelScale=function(a){};js.framework.base.McxCoreGis.Data.IMcxMediaCategory={};function IMcxMediaCategory(){}IMcxMediaCategory.prototype.getCategoryId=function(){};IMcxMediaCategory.prototype.setCategoryId=function(a){};IMcxMediaCategory.prototype.getCategoryName=function(){};IMcxMediaCategory.prototype.setCategoryName=function(a){};IMcxMediaCategory.prototype.getMediaType=function(){};IMcxMediaCategory.prototype.setMediaType=function(a){};IMcxMediaCategory.prototype.getStorageType=function(){};
IMcxMediaCategory.prototype.setStorageType=function(a){};IMcxMediaCategory.prototype.getUri=function(){};IMcxMediaCategory.prototype.setUri=function(a){};js.framework.base.McxCoreGis.Data.IMcxMediaInfo={};function IMcxMediaInfo(){}IMcxMediaInfo.prototype.getMediaId=function(){};IMcxMediaInfo.prototype.getCategoryId=function(){};IMcxMediaInfo.prototype.getFileName=function(){};IMcxMediaInfo.prototype.getOriginalFileName=function(){};IMcxMediaInfo.prototype.getFileSize=function(){};IMcxMediaInfo.prototype.getContentType=function(){};IMcxMediaInfo.prototype.getDateCreated=function(){};IMcxMediaInfo.prototype.getUserInfo=function(){};js.framework.base.McxCoreGis.Data.IMcxMediaManager={};function IMcxMediaManager(){}IMcxMediaManager.prototype.deleteMedia=function(a,b){};IMcxMediaManager.prototype.deleteMediaByFeatureId=function(a,b){};IMcxMediaManager.prototype.deleteMediaByGlobalId=function(a,b){};IMcxMediaManager.prototype.getMediaCategories=function(a){};IMcxMediaManager.prototype.getMediaCategory=function(a,b){};IMcxMediaManager.prototype.getMediaData=function(a,b){};IMcxMediaManager.prototype.getMediaInfo=function(a,b){};
IMcxMediaManager.prototype.getMediaInfoByMediaGlobalId=function(a,b){};IMcxMediaManager.prototype.getMediaInfoByFeatureId=function(a,b,c){};IMcxMediaManager.prototype.getMediaInfosByFeatureIds=function(a,b,c){};IMcxMediaManager.prototype.getMediaInfoByGlobalId=function(a,b,c){};IMcxMediaManager.prototype.getMediaInfosByGlobalIds=function(a,b,c){};IMcxMediaManager.prototype.addMediaContent=function(a,b,c,d,e,f){};js.framework.base.McxCoreGis.Data.IMcxRelation={};function IMcxRelation(){}IMcxRelation.prototype.getRelationName=function(){};IMcxRelation.prototype.getOriginTable=function(){};IMcxRelation.prototype.getOriginPrimaryKey=function(){};IMcxRelation.prototype.getOriginForeignKey=function(){};IMcxRelation.prototype.getDestTable=function(){};IMcxRelation.prototype.getDestPrimaryKey=function(){};IMcxRelation.prototype.getDestForeignKey=function(){};IMcxRelation.prototype.getDestValueKey=function(){};
IMcxRelation.prototype.getFilterValue=function(){};IMcxRelation.prototype.getOriginLabel=function(){};IMcxRelation.prototype.getDestLabel=function(){};IMcxRelation.prototype.getSpatialRelation=function(){};js.framework.base.McxCoreGis.Data.IMcxRelationalDataSource={};function IMcxRelationalDataSource(){}IMcxRelationalDataSource.prototype.createRelation=function(a){};IMcxRelationalDataSource.prototype.deleteRelation=function(a){};IMcxRelationalDataSource.prototype.alterRelation=function(a,b){};IMcxRelationalDataSource.prototype.getRelation=function(a,b,c,d){};IMcxRelationalDataSource.prototype.getRelations=function(a,b,c){};IMcxRelationalDataSource.prototype.getAllRelations=function(a,b){};js.framework.base.McxCoreGis.Data.IMcxSchema={};function IMcxSchema(){}IMcxSchema.prototype.getFieldCount=function(){};IMcxSchema.prototype.getField=function(a){};IMcxSchema.prototype.getFieldOrdinal=function(a){};IMcxSchema.prototype.getFields=function(){};IMcxSchema.prototype.clone=function(){};js.framework.base.McxCoreGis.Data.IMcxScript={};function IMcxScript(){}IMcxScript.prototype.getScript=function(){};IMcxScript.prototype.run=function(a){};js.framework.base.McxCoreGis.Data.IMcxSubtype={};function IMcxSubtype(){}IMcxSubtype.prototype.getLabelSymbolizer=function(){};IMcxSubtype.prototype.setLabelSymbolizer=function(a){};IMcxSubtype.prototype.getSymbolizer=function(){};IMcxSubtype.prototype.setSymbolizer=function(a){};IMcxSubtype.prototype.getTag=function(){};IMcxSubtype.prototype.setTag=function(a){};IMcxSubtype.prototype.getValue=function(){};IMcxSubtype.prototype.setValue=function(a){};IMcxSubtype.prototype.isVisible=function(){};
IMcxSubtype.prototype.setVisibility=function(a){};IMcxSubtype.prototype.getMinScale=function(){};IMcxSubtype.prototype.setMinScale=function(a){};IMcxSubtype.prototype.getMaxScale=function(){};IMcxSubtype.prototype.setMaxScale=function(a){};IMcxSubtype.prototype.getScript=function(){};IMcxSubtype.prototype.setScript=function(a){};js.framework.base.McxCoreGis.Data.IMcxSubtypeCollection={};function IMcxSubtypeCollection(){}IMcxSubtypeCollection.prototype.getCount=function(){};IMcxSubtypeCollection.prototype.getLayer=function(){};IMcxSubtypeCollection.prototype.getSubtypeWithValue=function(a){};IMcxSubtypeCollection.prototype.getResetEventHandler=function(){};IMcxSubtypeCollection.prototype.getSubtypeAddedEventHandler=function(){};IMcxSubtypeCollection.prototype.getSubtypeRemovedEventHandler=function(){};
IMcxSubtypeCollection.prototype.add=function(a){};IMcxSubtypeCollection.prototype.clear=function(){};IMcxSubtypeCollection.prototype.remove=function(a){};IMcxSubtypeCollection.prototype.getAt=function(a){};IMcxSubtypeCollection.prototype.getFields=function(){};js.framework.base.McxCoreGis.Data.McxButtonState={};var McxButtonState={active:0,normal:1,disabled:2,danger:3,error:4,predefined:5};js.framework.base.McxCoreGis.Data.McxCapabilityNames={};
var McxCapabilityNames={CanCreateLayer:"CanCreateLayer",CanDeleteLayer:"CanDeleteLayer",CanCopyLayer:"CanCopyLayer",CanCreateDomain:"CanCreateDomain",CanDeleteDomain:"CanDeleteDomain",CanAlterDomain:"CanAlterDomain",CanCreateCodedValue:"CanCreateCodedValue",CanDeleteCodedValue:"CanDeleteCodedValue",CanAlterCodedValue:"CanAlterCodedValue",CanCreateField:"CanCreateField",CanDeleteField:"CanDeleteField",CanAlterField:"CanAlterField",CanSetAlias:"CanSetAlias",CanSetCoordinateSystem:"CanSetCoordinateSystem",
CanSetLayerSymbolizer:"CanSetLayerSymbolizer",CanSetLayerLabelSymbolizer:"CanSetLabelSymbolizer",CanCreateFeature:"CanCreateFeature",CanDeleteFeature:"CanDeleteFeature",CanUpdateFeature:"CanAlterFeature",CanCreateDataSource:"CanCreateDataSource",CanDeleteDataSource:"CanDeleteDataSource",CanCopyDataSource:"CanCopyDataSource"};js.framework.base.McxCoreGis.Data.McxDataType={};var McxDataType={Boolean:0,Byte:1,Int16:2,Int32:3,Int64:4,UInt16:5,UInt32:6,UInt64:7,Float:8,Double:9,Decimal:10,String:11,DateTime:12,Guid:13,ByteArray:14,IMcxGeometry:15,IMcxSymbolizer:16,Object:17,Unknown:18};js.framework.base.McxCoreGis.Data.McxDefinedSubtypeObject={};function McxDefinedSubtypeObject(a,b){this.subtypeType=McxSubtypeType.Undefined;this.subtypeField="";void 0!=a&&(this.subtypeType=a);void 0!=b&&(this.subtypeField=b)}McxDefinedSubtypeObject.prototype.getSubtypeType=function(){return this.subtypeType};McxDefinedSubtypeObject.prototype.setSubtypeType=function(a){this.subtypeType=a};McxDefinedSubtypeObject.prototype.getSubtypeField=function(){return this.subtypeField};
McxDefinedSubtypeObject.prototype.setSubtypeField=function(a){this.subtypeField=a};js.framework.base.McxCoreGis.Data.McxDrawEventArgs={};function McxDrawEventArgs(a,b,c){mcx.base(this,c);this.mouseEventArgs=a;this.points=b}mcx.inherits(McxDrawEventArgs,McxEventArgs);McxDrawEventArgs.prototype.getPoints=function(){return this.points};McxDrawEventArgs.prototype.getMouseEventArgs=function(){return this.mouseEventArgs};js.framework.base.McxCoreGis.Data.McxExceptionMessage={};function McxExceptionMessage(a){this.fault=$.parseJSON(a.responseText)}McxExceptionMessage.prototype.getException=function(){return this.fault.ExceptionMessage};McxExceptionMessage.prototype.getInnerException=function(){return this.fault.InnerException};McxExceptionMessage.prototype.getStackTrace=function(){return this.fault.StackTrace};js.framework.base.McxCoreGis.Data.McxFeatureCancelEventArgs={};function McxFeatureCancelEventArgs(a,b,c){mcx.base(this,c);this.layer=a;this.features=b}mcx.inherits(McxFeatureCancelEventArgs,McxCancelEventArgs);McxFeatureCancelEventArgs.prototype.getFeatures=function(){return this.features};McxFeatureCancelEventArgs.prototype.getLayer=function(){return this.layer};js.framework.base.McxCoreGis.Data.McxFeatureEventArgs={};function McxFeatureEventArgs(a,b,c){mcx.base(this,c);this.layer=a;this.features=b}mcx.inherits(McxFeatureEventArgs,McxEventArgs);McxFeatureEventArgs.prototype.getFeatures=function(){return this.features};McxFeatureEventArgs.prototype.getLayer=function(){return this.layer};js.framework.base.McxCoreGis.Data.McxFeatureInfoDataType={};var McxFeatureInfoDataType={Text:"Text",GML2:"GML2",GML3:"GML3",HTML:"text/html",JSON:"JSON",JSONP:"JSONP"};js.framework.base.McxCoreGis.Data.McxFeatureInfoParams={};function McxFeatureInfoParams(){this._version="1.1.1";this._height=this._width=256;this._infoFormat="application/json";this._featureCount=1;this._queryLayers=this._styles="";this._bbox=null;this._y=this._x=0;this._coordinateSystem=null}McxFeatureInfoParams.prototype.setVersion=function(a){this._version=a};McxFeatureInfoParams.prototype.setInfoFormat=function(a){this._infoFormat=a};
McxFeatureInfoParams.prototype.setStyles=function(a){this._styles=a};McxFeatureInfoParams.prototype.setQueryLayers=function(a){this._queryLayers=a};McxFeatureInfoParams.prototype.setFeatureCount=function(a){this._featureCount=a};McxFeatureInfoParams.prototype.setBbox=function(a){this._bbox=a};McxFeatureInfoParams.prototype.setX=function(a){this._x=a};McxFeatureInfoParams.prototype.setY=function(a){this._y=a};McxFeatureInfoParams.prototype.setWidth=function(a){this._width=a};
McxFeatureInfoParams.prototype.setHeight=function(a){this._height=a};McxFeatureInfoParams.prototype.getVersion=function(){return this._version};McxFeatureInfoParams.prototype.getBbox=function(){return this._bbox};McxFeatureInfoParams.prototype.getX=function(){return this._x};McxFeatureInfoParams.prototype.getY=function(){return this._y};McxFeatureInfoParams.prototype.getWidth=function(){return this._width};McxFeatureInfoParams.prototype.getHeight=function(){return this._height};
McxFeatureInfoParams.prototype.getFeatureCount=function(){return this._featureCount};McxFeatureInfoParams.prototype.getInfoFormat=function(){return this._infoFormat};McxFeatureInfoParams.prototype.getStyles=function(){return this._styles};McxFeatureInfoParams.prototype.getQueryLayers=function(){return this._queryLayers};McxFeatureInfoParams.prototype.setCoordinateSystem=function(a){this._coordinateSystem=a};McxFeatureInfoParams.prototype.getCoordinateSystem=function(){return this._coordinateSystem};js.framework.base.McxCoreGis.Data.McxLayerEventArgs={};function McxLayerEventArgs(a){mcx.base(this,null);this.layer=a}mcx.inherits(McxLayerEventArgs,McxEventArgs);McxLayerEventArgs.prototype.getLayer=function(){return this.layer};js.framework.base.McxCoreGis.Data.McxMediaCategory={};function McxMediaCategory(){this._categoryName="";this._categoryId=-1;this._uri="";this._mediaType=McxMediaType.File;this._storageType=McxMediaStorageType.Linked}McxMediaCategory.prototype.getCategoryName=function(){return this._categoryName};McxMediaCategory.prototype.setCategoryId=function(a){this._categoryId=a};McxMediaCategory.prototype.getUri=function(){return this._uri};
McxMediaCategory.prototype.setMediaType=function(a){this._mediaType=a};McxMediaCategory.prototype.setStorageType=function(a){this._storageType=a};McxMediaCategory.prototype.getMediaType=function(){return this._mediaType};McxMediaCategory.prototype.getStorageType=function(){return this._storageType};McxMediaCategory.prototype.setUri=function(a){this._uri=a};McxMediaCategory.prototype.setCategoryName=function(a){this._categoryName=a};McxMediaCategory.prototype.getCategoryId=function(){return this._categoryId};js.framework.base.McxCoreGis.Data.McxMediaContent={};function McxMediaContent(a,b){this._mediaId=a;this._name=b;this._url=""}McxMediaContent.prototype.getMediaId=function(){return this._mediaId};McxMediaContent.prototype.getMediaName=function(){return this._name};McxMediaContent.prototype.getMediaUrl=function(){return this._url};McxMediaContent.prototype.setMediaUrl=function(a){this._url=a};js.framework.base.McxCoreGis.Data.McxMediaStorageType={};var McxMediaStorageType={Linked:1,Embedded:2};js.framework.base.McxCoreGis.Data.McxMediaType={};var McxMediaType={File:1,Image:2,Audio:3,Video:4,Panaroma:5};js.framework.base.McxCoreGis.Data.McxMediaUserInfo={};function McxMediaUserInfo(){this._description=this._userName="";this._userId=-1}McxMediaUserInfo.prototype.getUserName=function(){return this._userName};McxMediaUserInfo.prototype.setUserName=function(a){this._userName=a};McxMediaUserInfo.prototype.getDescription=function(){return this._description};McxMediaUserInfo.prototype.setDescription=function(a){this._description=a};McxMediaUserInfo.prototype.getUserId=function(){return this._userId};
McxMediaUserInfo.prototype.setUserId=function(a){this._userId=a};js.framework.base.McxCoreGis.Data.McxRelationDirection={};var McxRelationDirection={up:1,down:2};js.framework.base.McxCoreGis.Data.McxRendererEventArgs={};function McxRendererEventArgs(a){mcx.base(this,[]);this.status=a}mcx.inherits(McxRendererEventArgs,McxEventArgs);McxRendererEventArgs.prototype.getStatus=function(){return this.status};js.framework.base.McxCoreGis.Data.McxRendererStatus={};var McxRendererStatus={End:0,Canceled:1};js.framework.base.McxCoreGis.Data.McxResult={};function McxResult(a){this.args=a;this.images=this.exceptionMessage=this.request=null}McxResult.prototype.getArgs=function(){return this.args};McxResult.prototype.setArgs=function(a){this.args=a};McxResult.prototype.setRequest=function(a){this.request=a};McxResult.prototype.getRequest=function(){return this.request};McxResult.prototype.getExceptionMessage=function(){return this.exceptionMessage};
McxResult.prototype.setExceptionMessage=function(a){this.exceptionMessage=a};McxResult.prototype.addImage=function(a){null==this.images&&(this.images=[]);this.images=this.images.concat(a)};McxResult.prototype.abort=function(){if(null!=this.images&&0<this.images.length)for(var a=0;a<this.images.length;a++)this.images[a].complete||(this.images[a].src="",this.images.splice(a,1),a--);null!=this.request&&this.request.abort()};js.framework.base.McxCoreGis.Data.McxCommitResult={};function McxCommitResult(){mcx.base(this);this.features=[]}mcx.inherits(McxCommitResult,McxResult);McxCommitResult.prototype.getFeatures=function(){return this.features};McxCommitResult.prototype.setFeatures=function(a){this.features=a};js.framework.base.McxCoreGis.Data.McxFullTextSearchResult={};function McxFullTextSearchResult(){mcx.base(this);this.featureReader=null}mcx.inherits(McxFullTextSearchResult,McxResult);McxFullTextSearchResult.prototype.getFeatureReader=function(){return this.featureReader};McxFullTextSearchResult.prototype.setFeatureReader=function(a){this.featureReader=a};js.framework.base.McxCoreGis.Data.McxGetDataSourceInfoResult={};function McxGetDataSourceInfoResult(){mcx.base(this,null);this.dataSourceNames=[]}mcx.inherits(McxGetDataSourceInfoResult,McxResult);McxGetDataSourceInfoResult.prototype.setDataSourceNames=function(a){this.dataSourceNames=a};McxGetDataSourceInfoResult.prototype.getDataSourceNames=function(){return this.dataSourceNames};js.framework.base.McxCoreGis.Data.McxGetDomainResult={};function McxGetDomainResult(){mcx.base(this,null);this.domain=null}mcx.inherits(McxGetDomainResult,McxResult);McxGetDomainResult.prototype.setDomain=function(a){this.domain=a};McxGetDomainResult.prototype.getDomain=function(){return this.domain};js.framework.base.McxCoreGis.Data.McxGetDomainsResult={};function McxGetDomainsResult(){mcx.base(this,null);this.domains=null}mcx.inherits(McxGetDomainsResult,McxResult);McxGetDomainsResult.prototype.setDomains=function(a){this.domains=a};McxGetDomainsResult.prototype.getDomains=function(){return this.domains};js.framework.base.McxCoreGis.Data.McxGetEnvelopeResult={};function McxGetEnvelopeResult(){mcx.base(this);this.envelope=null}mcx.inherits(McxGetEnvelopeResult,McxResult);McxGetEnvelopeResult.prototype.getEnvelope=function(){return this.envelope};McxGetEnvelopeResult.prototype.setEnvelope=function(a){this.envelope=a};js.framework.base.McxCoreGis.Data.McxGetFeatureCountResult={};function McxGetFeatureCountResult(){mcx.base(this,null);this.featureCount=0}mcx.inherits(McxGetFeatureCountResult,McxResult);McxGetFeatureCountResult.prototype.getFeatureCount=function(){return this.featureCount};McxGetFeatureCountResult.prototype.setFeatureCount=function(a){this.featureCount=a};js.framework.base.McxCoreGis.Data.McxGetLayerInfoResult={};function McxGetLayerInfoResult(){mcx.base(this,null);this.layerNames=[]}mcx.inherits(McxGetLayerInfoResult,McxResult);McxGetLayerInfoResult.prototype.getLayerNames=function(){return this.layerNames};McxGetLayerInfoResult.prototype.setLayerNames=function(a){this.layerNames=a};js.framework.base.McxCoreGis.Data.McxGetLayerResult={};function McxGetLayerResult(){mcx.base(this,null);this.layers=[]}mcx.inherits(McxGetLayerResult,McxResult);McxGetLayerResult.prototype.setLayers=function(a){this.layers=a};McxGetLayerResult.prototype.getLayers=function(){return this.layers};js.framework.base.McxCoreGis.Data.McxGetRelationResult={};function McxGetRelationResult(){mcx.base(this,null);this.relation=null}mcx.inherits(McxGetRelationResult,McxResult);McxGetRelationResult.prototype.setRelation=function(a){this.relation=a};McxGetRelationResult.prototype.getRelation=function(){return this.relation};js.framework.base.McxCoreGis.Data.McxGetRelationsResult={};function McxGetRelationsResult(){mcx.base(this,null);this.relations=null}mcx.inherits(McxGetRelationsResult,McxResult);McxGetRelationsResult.prototype.setRelations=function(a){this.relations=a};McxGetRelationsResult.prototype.getRelations=function(){return this.relations};js.framework.base.McxCoreGis.Data.McxMediaCategoryResult={};function McxMediaCategoryResult(){mcx.base(this);this._mediaCategories=[]}mcx.inherits(McxMediaCategoryResult,McxResult);McxMediaCategoryResult.prototype.getMediaCategories=function(){return this._mediaCategories};McxMediaCategoryResult.prototype.setMediaCategories=function(a){this._mediaCategories=a};js.framework.base.McxCoreGis.Data.McxMediaDataResult={};function McxMediaDataResult(){mcx.base(this);this._mediaData=[]}mcx.inherits(McxMediaDataResult,McxResult);McxMediaDataResult.prototype.getMediaData=function(){return this._mediaData};McxMediaDataResult.prototype.setMediaData=function(a){this._mediaData=a};js.framework.base.McxCoreGis.Data.McxMediaInfoResult={};function McxMediaInfoResult(){mcx.base(this);this._mediaInfoArr=[]}mcx.inherits(McxMediaInfoResult,McxResult);McxMediaInfoResult.prototype.getMediaInfo=function(){return this._mediaInfoArr};McxMediaInfoResult.prototype.setMediaInfo=function(a){this._mediaInfoArr=a};js.framework.base.McxCoreGis.Data.McxOpenDataSourceResult={};function McxOpenDataSourceResult(){mcx.base(this);this.dataSource=null}mcx.inherits(McxOpenDataSourceResult,McxResult);McxOpenDataSourceResult.prototype.getDataSource=function(){return this.dataSource};McxOpenDataSourceResult.prototype.setDataSource=function(a){this.dataSource=a};js.framework.base.McxCoreGis.Data.McxSearchResult={};function McxSearchResult(){mcx.base(this);this.labelReader=this.layer=this.featureReader=null}mcx.inherits(McxSearchResult,McxResult);McxSearchResult.prototype.getFeatureReader=function(){return this.featureReader};McxSearchResult.prototype.setFeatureReader=function(a){this.featureReader=a};McxSearchResult.prototype.getLabelReader=function(){return this.labelReader};McxSearchResult.prototype.setLabelString=function(a){this.labelReader=new McxFsLabelReader(a)};
McxSearchResult.prototype.getLayer=function(){return this.layer};McxSearchResult.prototype.setLayer=function(a){this.layer=a};js.framework.base.McxCoreGis.Data.McxSelectionChangedEventArgs={};function McxSelectionChangedEventArgs(a,b){mcx.base(this,b);this.features=a}mcx.inherits(McxSelectionChangedEventArgs,McxEventArgs);McxSelectionChangedEventArgs.prototype.getFeatures=function(){return this.features};js.framework.base.McxCoreGis.Data.McxSpatialOperationType={};var McxSpatialOperationType={Erase:"Erase",Intersection:"Intersection"};js.framework.base.McxCoreGis.Data.McxSubtypeType={};var McxSubtypeType={Undefined:-1,CodedValueSubtype:0,UniqueValueSubtype:1,RangedValueSubtype:2};js.framework.base.McxCoreGis.Data.McxTileScaleLevel={};function McxTileScaleLevel(a,b,c){this._levelId=a;this._resolution=b;this._scale=c}McxTileScaleLevel.prototype.getLevelId=function(){return this._levelId};McxTileScaleLevel.prototype.setLevelId=function(a){this._levelId=a};McxTileScaleLevel.prototype.getScale=function(){return this._scale};McxTileScaleLevel.prototype.setScale=function(a){this._scale=a};McxTileScaleLevel.prototype.getResolution=function(){return this._resolution};
McxTileScaleLevel.prototype.setResolution=function(a){this._resolution=a};js.framework.base.McxCoreGis.Geometry={};js.framework.base.McxCoreGis.Geometry.IMcxBounds={};function IMcxBounds(){}IMcxBounds.prototype.equals=function(a){};IMcxBounds.prototype.getCoordinateSystem=function(){};IMcxBounds.prototype.setCoordinateSystem=function(a){};IMcxBounds.prototype.getCentroid=function(){};IMcxBounds.prototype.getLeft=function(){};IMcxBounds.prototype.getRight=function(){};IMcxBounds.prototype.getTop=function(){};IMcxBounds.prototype.getBottom=function(){};
IMcxBounds.prototype.getWidth=function(){};IMcxBounds.prototype.getHeight=function(){};IMcxBounds.prototype.intersectsBounds=function(a){};IMcxBounds.prototype.scale=function(a,b){};IMcxBounds.prototype.distanceTo=function(a,b){};IMcxBounds.prototype.getSortedSegments=function(){};IMcxBounds.prototype.getPoints=function(){};IMcxBounds.prototype.contains=function(a,b){};IMcxBounds.prototype.transformTo=function(a){};IMcxBounds.prototype.merge=function(a){};IMcxBounds.prototype.inflate=function(a,b){};
IMcxBounds.prototype.intersectedArea=function(a){};IMcxBounds.prototype.clone=function(){};js.framework.base.McxCoreGis.Geometry.IMcxGeometry={};function IMcxGeometry(){}IMcxGeometry.prototype.equals=function(a){};IMcxGeometry.prototype.intersects=function(a){};IMcxGeometry.prototype.calculateBounds=function(){};IMcxGeometry.prototype.getBounds=function(){};IMcxGeometry.prototype.getCentroid=function(){};IMcxGeometry.prototype.isInstanceOf=function(a){};IMcxGeometry.prototype.distanceTo=function(a){};IMcxGeometry.prototype.getArea=function(){};IMcxGeometry.prototype.getSortedSegments=function(){};
IMcxGeometry.prototype.contains=function(a){};IMcxGeometry.prototype.getCoordinateSystem=function(){};IMcxGeometry.prototype.setCoordinateSystem=function(a){};IMcxGeometry.prototype.transformTo=function(a){};IMcxGeometry.prototype.clone=function(){};IMcxGeometry.prototype.translate=function(a,b){};IMcxGeometry.prototype.rotate=function(a,b){};IMcxGeometry.prototype.scale=function(a,b){};IMcxGeometry.prototype.buffer=function(a){};IMcxGeometry.prototype.toString=function(){};js.framework.base.McxCoreGis.Geometry.IMcxGeometryCollection={};function IMcxGeometryCollection(){}IMcxGeometryCollection.prototype.getCount=function(){};IMcxGeometryCollection.prototype.getComponents=function(){};js.framework.base.McxCoreGis.Geometry.IMcxGeometryFactory={};function IMcxGeometryFactory(){}IMcxGeometryFactory.prototype.createLineSegment=function(a,b){};IMcxGeometryFactory.prototype.createPolygon=function(a,b){};IMcxGeometryFactory.prototype.createLineString=function(a){};IMcxGeometryFactory.prototype.createPoint=function(a,b){};IMcxGeometryFactory.prototype.createBounds=function(a,b,c,d){};IMcxGeometryFactory.prototype.createLinearRing=function(a){};
IMcxGeometryFactory.prototype.createSize=function(a,b){};IMcxGeometryFactory.prototype.createMultiPolygon=function(a){};IMcxGeometryFactory.prototype.createMultiLineString=function(a){};IMcxGeometryFactory.prototype.createMultiPoint=function(a){};IMcxGeometryFactory.prototype.createEllipse=function(a,b,c,d){};IMcxGeometryFactory.prototype.createEllipticArc=function(a,b,c,d,e,f){};js.framework.base.McxCoreGis.Geometry.IMcxLinearRing={};function IMcxLinearRing(){}IMcxLinearRing.prototype.setPoints=function(a){};IMcxLinearRing.prototype.getPoints=function(){};IMcxLinearRing.prototype.calculateBounds=function(){};IMcxLinearRing.prototype.getBounds=function(){};IMcxLinearRing.prototype.containsPoint=function(a){};IMcxLinearRing.prototype.closeRing=function(){};js.framework.base.McxCoreGis.Geometry.IMcxLineSegment={};function IMcxLineSegment(){}IMcxLineSegment.prototype.getStartPoint=function(){};IMcxLineSegment.prototype.getEndPoint=function(){};IMcxLineSegment.prototype.getStartX=function(){};IMcxLineSegment.prototype.getStartY=function(){};IMcxLineSegment.prototype.getEndX=function(){};IMcxLineSegment.prototype.getEndY=function(){};IMcxLineSegment.prototype.setPoints=function(a){};IMcxLineSegment.prototype.intersectSegment=function(a,b){};
IMcxLineSegment.prototype.intersectSegmentWithOptions=function(a,b){};IMcxLineSegment.prototype.contains=function(a){};IMcxLineSegment.prototype.getSortedSegments=function(){};IMcxLineSegment.prototype.getPerpendicularFoot=function(a,b){};IMcxLineSegment.prototype.getAltitudePoint=function(a,b){};IMcxLineSegment.prototype.getAngleFromNorth=function(a,b){};IMcxLineSegment.prototype.getAngle=function(){};js.framework.base.McxCoreGis.Geometry.IMcxLineString={};function IMcxLineString(a){}IMcxLineString.prototype.setPoints=function(a){};IMcxLineString.prototype.getPoints=function(){};IMcxLineString.prototype.getEndPoint=function(){};IMcxLineString.prototype.getStartPoint=function(){};IMcxLineString.prototype.distanceTo=function(a){};IMcxLineString.prototype.getSortedSegments=function(){};IMcxLineString.prototype.offset=function(a){};IMcxLineString.prototype.segmentize=function(){};
IMcxLineString.prototype.getLength=function(){};IMcxLineString.prototype.insertPoints=function(a,b){};IMcxLineString.prototype.intersection=function(a){};js.framework.base.McxCoreGis.Geometry.IMcxMultiLineString={};function IMcxMultiLineString(){}IMcxMultiLineString.prototype.getLines=function(){};IMcxMultiLineString.prototype.getLength=function(){};js.framework.base.McxCoreGis.Geometry.IMcxMultiPoint={};function IMcxMultiPoint(){}IMcxMultiPoint.prototype.getPoints=function(){};js.framework.base.McxCoreGis.Geometry.IMcxMultiPolygon={};function IMcxMultiPolygon(){}IMcxMultiPolygon.prototype.getCount=function(){};IMcxMultiPolygon.prototype.getComponents=function(){};IMcxMultiPolygon.prototype.getPolygons=function(){};js.framework.base.McxCoreGis.Geometry.IMcxPoint={};function IMcxPoint(){}IMcxPoint.prototype.getX=function(){};IMcxPoint.prototype.getY=function(){};IMcxPoint.prototype.equals=function(a){};IMcxPoint.prototype.equalsWithEpsilon=function(a,b){};IMcxPoint.prototype.intersects=function(a){};IMcxPoint.prototype.getSortedSegments=function(){};IMcxPoint.prototype.subtract=function(a){};js.framework.base.McxCoreGis.Geometry.IMcxPolygon={};function IMcxPolygon(){}IMcxPolygon.prototype.containsPoint=function(a){};IMcxPolygon.prototype.intersects=function(a){};IMcxPolygon.prototype.getShell=function(){};IMcxPolygon.prototype.setShell=function(a){};IMcxPolygon.prototype.getHoles=function(){};IMcxPolygon.prototype.setHoles=function(a){};IMcxPolygon.prototype.isClockWise=function(){};js.framework.base.McxCoreGis.Geometry.IMcxPolyLine={};function IMcxPolyLine(){}IMcxPolyLine.prototype.removeComponent=function(a){};IMcxPolyLine.prototype.intersects=function(a){};IMcxPolyLine.prototype.getSortedSegments=function(){};IMcxPolyLine.prototype.splitWithSegment=function(a,b){};IMcxPolyLine.prototype.split=function(a,b){};IMcxPolyLine.prototype.simplify=function(a){};js.framework.base.McxCoreGis.Geometry.IMcxSize={};function IMcxSize(){}IMcxSize.prototype.equals=function(a){};IMcxSize.prototype.getWidth=function(){};IMcxSize.prototype.getHeight=function(){};js.framework.base.McxCoreGis.Geometry.McxGeometryType={};var McxGeometryType={Unknown:0,Point:1,LineString:2,Polygon:3,MultiPoint:4,MultiLineString:5,MultiPolygon:6,GeometryCollection:7,None:8,LinearRing:9,LineSegment:10};js.framework.base.McxCoreGis.Geometry.McxSpatialRelation={};var McxSpatialRelation={None:"None",Equals:"Equals",Disjoint:"Disjoint",Intersects:"Intersects",Touches:"Touches",Within:"Within",Contains:"Contains",Overlaps:"Overlaps",Crosses:"Crosses"};js.framework.base.McxCoreGis.Geometry.McxTopologyRelation={};var McxTopologyRelation={None:"None",Equals:"Equals",Disjoint:"Disjoint",Intersects:"Intersects",Touches:"Touches",Within:"Within",Contains:"Contains",Overlaps:"Overlaps",Crosses:"Crosses",IntersectWithStartAndEnd:"IntersectWithStartAndEnd"};js.framework.base.McxCoreGis.Mapping={};js.framework.base.McxCoreGis.Mapping.IMcxAction={};function IMcxAction(){}IMcxAction.prototype.execute=function(a){};IMcxAction.prototype.isInstanceOf=function(a){};js.framework.base.McxCoreGis.Mapping.IMcxCanvas={};function IMcxCanvas(){}IMcxCanvas.prototype.getLayers=function(){};IMcxCanvas.prototype.paintLayer=function(a,b){};IMcxCanvas.prototype.draw=function(a,b){};IMcxCanvas.prototype.paintLabels=function(a){};IMcxCanvas.prototype.drawLabels=function(a,b){};IMcxCanvas.prototype.paintSelection=function(a){};IMcxCanvas.prototype.isInstanceOf=function(a){};IMcxCanvas.prototype.clearCanvas=function(){};IMcxCanvas.prototype.zoomTo=function(a,b,c){};
IMcxCanvas.prototype.translate=function(a,b){};IMcxCanvas.prototype.resetTranslation=function(){};IMcxCanvas.prototype.dispose=function(){};IMcxCanvas.prototype.clearBackBuffer=function(){};IMcxCanvas.prototype.paintBackBuffer=function(){};IMcxCanvas.prototype.setZoomAnimationClass=function(a){};IMcxCanvas.prototype.resetZoomAnimationClass=function(){};IMcxCanvas.prototype.setOrder=function(a,b){};IMcxCanvas.prototype.setOpacity=function(a){};IMcxCanvas.prototype.setDisplay=function(a,b){};
IMcxCanvas.prototype.clearCache=function(){};IMcxCanvas.prototype.abortRender=function(){};IMcxCanvas.prototype.getRendererEventHandler=function(){};IMcxCanvas.prototype.getLabelRendererEventHandler=function(){};IMcxCanvas.prototype.backBufferEnabled=function(a){};IMcxCanvas.prototype.canAddLayer=function(a){};IMcxCanvas.prototype.addLayer=function(a){};js.framework.base.McxCoreGis.Mapping.IMcxCanvasProvider={};function IMcxCanvasProvider(){}IMcxCanvasProvider.prototype.createCanvas=function(a,b){};js.framework.base.McxCoreGis.Mapping.IMcxCell={};function IMcxCell(){}IMcxCell.prototype.getIndexX=function(){};IMcxCell.prototype.getIndexY=function(){};IMcxCell.prototype.getWorld=function(){};IMcxCell.prototype.getDisplay=function(){};js.framework.base.McxCoreGis.Mapping.IMcxController={};function IMcxController(){}IMcxController.prototype.getCursor=function(){};IMcxController.prototype.getDescription=function(){};IMcxController.prototype.startInteraction=function(a){};IMcxController.prototype.endInteraction=function(){};IMcxController.prototype.paint=function(a){};IMcxController.prototype.isInstanceOf=function(a){};IMcxController.prototype.getOptionUI=function(){};js.framework.base.McxCoreGis.Mapping.IMcxControllerMessage={};function IMcxControllerMessage(){}IMcxControllerMessage.prototype.getContent=function(){};IMcxControllerMessage.prototype.setPosition=function(a,b){};IMcxControllerMessage.prototype.getX=function(){};IMcxControllerMessage.prototype.getY=function(){};IMcxControllerMessage.prototype.setMessage=function(a){};IMcxControllerMessage.prototype.getMessage=function(){};IMcxControllerMessage.prototype.showMessage=function(){};js.framework.base.McxCoreGis.Mapping.IMcxControllerUI={};function IMcxControllerUI(){}IMcxControllerUI.prototype.getContent=function(){};IMcxControllerUI.prototype.getLocalizationPath=function(){};IMcxControllerUI.prototype.setLocalizationPath=function(a){};IMcxControllerUI.prototype.setTitle=function(a,b){};IMcxControllerUI.prototype.setWidth=function(a){};IMcxControllerUI.prototype.setDefaultButtonsVisibility=function(a,b){};IMcxControllerUI.prototype.getSubmitHandler=function(){};
IMcxControllerUI.prototype.onCancel=function(){};IMcxControllerUI.prototype.displayMessage=function(a,b){};IMcxControllerUI.prototype.getUIStatus=function(){};IMcxControllerUI.prototype.setUIStatus=function(a){};IMcxControllerUI.prototype.setAsStartUp=function(a){};IMcxControllerUI.prototype.getStartStatus=function(){};IMcxControllerUI.prototype.showUI=function(){};IMcxControllerUI.prototype.hideUI=function(){};IMcxControllerUI.prototype.onShowEventHandler=function(){};
IMcxControllerUI.prototype.onHideEventHandler=function(){};IMcxControllerUI.prototype.setOkButtonState=function(a){};IMcxControllerUI.prototype.setCancelButtonState=function(a){};js.framework.base.McxCoreGis.Mapping.IMcxDrawContext={};function IMcxDrawContext(){}IMcxDrawContext.prototype.getGeodeticGraphics=function(){};IMcxDrawContext.prototype.getMap=function(){};js.framework.base.McxCoreGis.Mapping.IMcxGeodeticGraphics={};function IMcxGeodeticGraphics(){}IMcxGeodeticGraphics.prototype.clear=function(){};IMcxGeodeticGraphics.prototype.clearRectangle=function(a,b,c,d){};IMcxGeodeticGraphics.prototype.clearWithColor=function(a){};IMcxGeodeticGraphics.prototype.clearRectangleWithColor=function(a,b,c,d,e){};IMcxGeodeticGraphics.prototype.drawPoint=function(a,b,c,d,e){};IMcxGeodeticGraphics.prototype.drawContent=function(a,b,c){};
IMcxGeodeticGraphics.prototype.drawLineSegment=function(a,b,c,d,e,f){};IMcxGeodeticGraphics.prototype.drawLineString=function(a,b,c,d,e){};IMcxGeodeticGraphics.prototype.drawPolygon=function(a,b,c,d,e){};IMcxGeodeticGraphics.prototype.drawPolygonWithHoles=function(a,b,c,d,e,f){};IMcxGeodeticGraphics.prototype.drawRectangle=function(a,b,c,d){};IMcxGeodeticGraphics.prototype.drawText=function(a,b,c,d,e,f){};IMcxGeodeticGraphics.prototype.drawTextWithBackGround=function(a,b,c,d,e){};
IMcxGeodeticGraphics.prototype.drawImage=function(a,b,c,d,e){};IMcxGeodeticGraphics.prototype.drawCircle=function(a,b,c,d,e,f,g,h,k,m){};IMcxGeodeticGraphics.prototype.useTransform=function(a){};IMcxGeodeticGraphics.prototype.setContentDiv=function(a){};js.framework.base.McxCoreGis.Mapping.IMcxInputHandler={};function IMcxInputHandler(){}IMcxInputHandler.prototype.execute=function(a){};IMcxInputHandler.prototype.getController=function(){};IMcxInputHandler.prototype.setController=function(a){};IMcxInputHandler.prototype.onMouseClick=function(a){};IMcxInputHandler.prototype.onMouseWheel=function(a){};IMcxInputHandler.prototype.onKeyUp=function(a){};IMcxInputHandler.prototype.onKeyDown=function(a){};IMcxInputHandler.prototype.onKeyPress=function(a){};
IMcxInputHandler.prototype.onTap=function(a){};IMcxInputHandler.prototype.onDoubleTap=function(a){};IMcxInputHandler.prototype.onPinch=function(a){};IMcxInputHandler.prototype.onSwipe=function(a){};IMcxInputHandler.prototype.onSwipeLeft=function(a){};IMcxInputHandler.prototype.onSwipeRight=function(a){};IMcxInputHandler.prototype.onSwipeUp=function(a){};IMcxInputHandler.prototype.onSwipeDown=function(a){};IMcxInputHandler.prototype.onRotate=function(a){};IMcxInputHandler.prototype.onDragStart=function(a){};
IMcxInputHandler.prototype.onDragEnd=function(a){};IMcxInputHandler.prototype.onDrag=function(a){};IMcxInputHandler.prototype.onRelease=function(a){};IMcxInputHandler.prototype.getUndoLimit=function(){};IMcxInputHandler.prototype.setUndoLimit=function(a){};IMcxInputHandler.prototype.canUndo=function(){};IMcxInputHandler.prototype.canRedo=function(){};IMcxInputHandler.prototype.getUndo=function(){};IMcxInputHandler.prototype.getRedo=function(){};IMcxInputHandler.prototype.addUndoable=function(a){};
IMcxInputHandler.prototype.undo=function(){};IMcxInputHandler.prototype.redo=function(){};IMcxInputHandler.prototype.getUndoStateChangeEventHandler=function(){};IMcxInputHandler.prototype.getInspectorStatus=function(){};IMcxInputHandler.prototype.setInspectorStatus=function(a){};js.framework.base.McxCoreGis.Mapping.IMcxKeyListener={};function IMcxKeyListener(){}IMcxKeyListener.prototype.onKeyPress=function(a){};IMcxKeyListener.prototype.onKeyUp=function(a){};IMcxKeyListener.prototype.onKeyDown=function(a){};js.framework.base.McxCoreGis.Mapping.IMcxLayerCollection={};function IMcxLayerCollection(){}IMcxLayerCollection.prototype.getCount=function(){};IMcxLayerCollection.prototype.getAt=function(a){};IMcxLayerCollection.prototype.add=function(a){};IMcxLayerCollection.prototype.insert=function(a,b){};IMcxLayerCollection.prototype.getActiveLayer=function(){};IMcxLayerCollection.prototype.setActiveLayer=function(a){};IMcxLayerCollection.prototype.removeAt=function(a){};
IMcxLayerCollection.prototype.remove=function(a){};IMcxLayerCollection.prototype.indexOf=function(a){};IMcxLayerCollection.prototype.onLayerAdded=function(){};IMcxLayerCollection.prototype.onLayerRemoved=function(){};IMcxLayerCollection.prototype.onActiveLayerChanged=function(){};IMcxLayerCollection.prototype.changeOrder=function(a,b){};IMcxLayerCollection.prototype.toLayerArray=function(){};IMcxLayerCollection.prototype.setLayerOpacity=function(a,b){};
IMcxLayerCollection.prototype.getLayerOrderChangeHandler=function(){};js.framework.base.McxCoreGis.Mapping.IMcxMap={};function IMcxMap(){}IMcxMap.prototype.getName=function(){};IMcxMap.prototype.getLayers=function(){};IMcxMap.prototype.getRenderer=function(){};IMcxMap.prototype.getMarkerCollection=function(){};IMcxMap.prototype.setWorld=function(a,b,c,d){};IMcxMap.prototype.getWorld=function(){};IMcxMap.prototype.getDisplay=function(){};IMcxMap.prototype.setDisplay=function(a,b){};IMcxMap.prototype.getTileSize=function(){};IMcxMap.prototype.setTileSize=function(a){};
IMcxMap.prototype.viewToWorld=function(a,b){};IMcxMap.prototype.worldToView=function(a,b){};IMcxMap.prototype.geometryToView=function(a){};IMcxMap.prototype.setScale=function(a){};IMcxMap.prototype.getScale=function(){};IMcxMap.prototype.setInputHandler=function(a){};IMcxMap.prototype.getInputHandler=function(){};IMcxMap.prototype.getPixelScale=function(){};IMcxMap.prototype.setCoordinateSystem=function(a){};IMcxMap.prototype.getCoordinateSystem=function(){};IMcxMap.prototype.createDrawContext=function(){};
IMcxMap.prototype.getPaintedFeatures=function(a){};IMcxMap.prototype.getSnapEngines=function(){};IMcxMap.prototype.getScaleChangedEventHandler=function(){};IMcxMap.prototype.getCRSChangedEventHandler=function(){};IMcxMap.prototype.getResizeEventHandler=function(){};IMcxMap.prototype.inVisibleRange=function(a,b){};IMcxMap.prototype.setRestrictedExtend=function(a){};IMcxMap.prototype.getRestrictedExtend=function(){};IMcxMap.prototype.getContent=function(){};IMcxMap.prototype.getScaleSet=function(){};
IMcxMap.prototype.setScaleSet=function(a){};IMcxMap.prototype.setBackColor=function(a){};IMcxMap.prototype.getBackColor=function(){};IMcxMap.prototype.setOpeningBounds=function(a){};IMcxMap.prototype.getOpeningBounds=function(a){};js.framework.base.McxCoreGis.Mapping.IMcxMarkerCollection={};function IMcxMarkerCollection(){}IMcxMarkerCollection.prototype.getMarker=function(a){};IMcxMarkerCollection.prototype.indexOf=function(a){};IMcxMarkerCollection.prototype.add=function(a){};IMcxMarkerCollection.prototype.addRange=function(a){};IMcxMarkerCollection.prototype.insert=function(a,b){};IMcxMarkerCollection.prototype.clear=function(){};IMcxMarkerCollection.prototype.containsGuid=function(a){};
IMcxMarkerCollection.prototype.containsMarker=function(a){};IMcxMarkerCollection.prototype.find=function(a){};IMcxMarkerCollection.prototype.removeWithGuid=function(a){};IMcxMarkerCollection.prototype.removeMarker=function(a){};IMcxMarkerCollection.prototype.removeAt=function(a){};IMcxMarkerCollection.prototype.removeRange=function(a){};IMcxMarkerCollection.prototype.getCount=function(){};IMcxMarkerCollection.prototype.getMarkerAddedEventHandler=function(){};
IMcxMarkerCollection.prototype.getMarkerRemovedEventHandler=function(){};IMcxMarkerCollection.prototype.getResetEventHandler=function(){};js.framework.base.McxCoreGis.Mapping.IMcxMouseListener={};function IMcxMouseListener(){}IMcxMouseListener.prototype.onMouseClick=function(a){};IMcxMouseListener.prototype.onMouseWheel=function(a){};IMcxMouseListener.prototype.onMouseMove=function(a){};IMcxMouseListener.prototype.onMouseUp=function(a){};IMcxMouseListener.prototype.onMouseDown=function(a){};js.framework.base.McxCoreGis.Mapping.IMcxPaintedFeatures={};function IMcxPaintedFeatures(){}IMcxPaintedFeatures.prototype.getKeyAt=function(a){};IMcxPaintedFeatures.prototype.addFeature=function(a,b){};IMcxPaintedFeatures.prototype.clear=function(){};IMcxPaintedFeatures.prototype.removeFeature=function(a){};IMcxPaintedFeatures.prototype.setSize=function(a){};IMcxPaintedFeatures.prototype.elementAt=function(a){};IMcxPaintedFeatures.prototype.getCount=function(){};
IMcxPaintedFeatures.prototype.getAll=function(){};IMcxPaintedFeatures.prototype.getElementWithIndex=function(a){};js.framework.base.McxCoreGis.Mapping.IMcxPainter={};function IMcxPainter(){}IMcxPainter.prototype.setSymbolizer=function(a){};IMcxPainter.prototype.getSymbolizer=function(){};IMcxPainter.prototype.paint=function(a,b,c,d){};IMcxPainter.prototype.isInstanceOf=function(a){};js.framework.base.McxCoreGis.Mapping.IMcxRenderer={};function IMcxRenderer(){}IMcxRenderer.prototype.paintLayer=function(a,b,c){};IMcxRenderer.prototype.draw=function(a,b,c){};IMcxRenderer.prototype.paintLabels=function(){};IMcxRenderer.prototype.paintNonLayer=function(){};IMcxRenderer.prototype.paintSelections=function(){};IMcxRenderer.prototype.zoomTo=function(a,b,c){};IMcxRenderer.prototype.translate=function(a,b,c){};IMcxRenderer.prototype.abortRender=function(){};
IMcxRenderer.prototype.getRendererStartEventHandler=function(){};IMcxRenderer.prototype.getRendererEndEventHandler=function(){};IMcxRenderer.prototype.addCanvasProvider=function(a){};IMcxRenderer.prototype.removeCanvasProvider=function(a){};IMcxRenderer.prototype.setZoomAnimationClass=function(a){};IMcxRenderer.prototype.setPanAnimationClass=function(a){};IMcxRenderer.prototype.getZoomAnimationClass=function(){};IMcxRenderer.prototype.getPanAnimationClass=function(){};
IMcxRenderer.prototype.clearBackBuffer=function(){};IMcxRenderer.prototype.isAnimationActive=function(){};IMcxRenderer.prototype.setAnimationActive=function(a){};js.framework.base.McxCoreGis.Mapping.IMcxSketchUndoable={};function IMcxSketchUndoable(){}IMcxSketchUndoable.prototype.finish=function(){};js.framework.base.McxCoreGis.Mapping.IMcxSnapEngine={};function IMcxSnapEngine(){}IMcxSnapEngine.prototype.setEnable=function(a){};IMcxSnapEngine.prototype.isEnable=function(){};IMcxSnapEngine.prototype.getSnapBuffer=function(){};IMcxSnapEngine.prototype.find=function(a,b){};IMcxSnapEngine.prototype.paint=function(a,b){};IMcxSnapEngine.prototype.isInstanceOf=function(a){};js.framework.base.McxCoreGis.Mapping.IMcxTouchListener={};function IMcxTouchListener(){}IMcxTouchListener.prototype.onTap=function(a){};IMcxTouchListener.prototype.onDoubleTap=function(a){};IMcxTouchListener.prototype.onHold=function(a){};IMcxTouchListener.prototype.onPinch=function(a){};IMcxTouchListener.prototype.onSwipe=function(a){};IMcxTouchListener.prototype.onSwipeLeft=function(a){};IMcxTouchListener.prototype.onSwipeRight=function(a){};IMcxTouchListener.prototype.onSwipeUp=function(a){};
IMcxTouchListener.prototype.onSwipeDown=function(a){};IMcxTouchListener.prototype.onRotate=function(a){};IMcxTouchListener.prototype.onDragStart=function(a){};IMcxTouchListener.prototype.onDragEnd=function(a){};IMcxTouchListener.prototype.onDrag=function(a){};js.framework.base.McxCoreGis.Mapping.IMcxUndoableAction={};function IMcxUndoableAction(){}IMcxUndoableAction.prototype.undo=function(){};IMcxUndoableAction.prototype.redo=function(){};IMcxUndoableAction.prototype.HasUndo=function(){};IMcxUndoableAction.prototype.HasRedo=function(){};IMcxUndoableAction.prototype.execute=function(a){};js.framework.base.McxCoreGis.Mapping.IMcxUndoBuffer={};function IMcxUndoBuffer(){}IMcxUndoBuffer.prototype.undo=function(){};IMcxUndoBuffer.prototype.redo=function(){};IMcxUndoBuffer.prototype.getDateTime=function(){};js.framework.base.McxCoreGis.Mapping.McxPainterMode={};var McxPainterMode={ByLayer:0,ByFeature:1,ByImage:2};js.framework.base.McxCoreGis.Mapping.McxScaleSet={};function McxScaleSet(a){this.scaleArray=a;this.selectedIndex=-1}McxScaleSet.prototype.getZoomLevelAt=function(a){return this.scaleArray[a]};McxScaleSet.prototype.getScaleLength=function(){return this.scaleArray.length};McxScaleSet.prototype.getSelectedIndex=function(){return this.selectedIndex};McxScaleSet.prototype.setSelectedIndex=function(a){this.selectedIndex=a};js.framework.base.McxCoreGis.Style={};js.framework.base.McxCoreGis.Style.IMcxAnchorPoint={};function IMcxAnchorPoint(){}IMcxAnchorPoint.prototype.getAnchorPointX=function(){};IMcxAnchorPoint.prototype.setAnchorPointX=function(a){};IMcxAnchorPoint.prototype.getAnchorPointY=function(){};IMcxAnchorPoint.prototype.setAnchorPointY=function(a){};IMcxAnchorPoint.prototype.clone=function(){};js.framework.base.McxCoreGis.Style.IMcxCompositeSymbolizer={};function IMcxCompositeSymbolizer(){}IMcxCompositeSymbolizer.prototype.getPointSymbolizer=function(){};IMcxCompositeSymbolizer.prototype.setPointSymbolizer=function(a){};IMcxCompositeSymbolizer.prototype.getLineSymbolizer=function(){};IMcxCompositeSymbolizer.prototype.setLineSymbolizer=function(a){};IMcxCompositeSymbolizer.prototype.getPolygonSymbolizer=function(){};IMcxCompositeSymbolizer.prototype.setPolygonSymbolizer=function(a){};
IMcxCompositeSymbolizer.prototype.getRasterSymbolizer=function(){};IMcxCompositeSymbolizer.prototype.setRasterSymbolizer=function(a){};IMcxCompositeSymbolizer.prototype.setOpacity=function(a){};IMcxCompositeSymbolizer.prototype.getOpacity=function(){};js.framework.base.McxCoreGis.Style.IMcxContentSymbol={};function IMcxContentSymbol(){}IMcxContentSymbol.prototype.getContent=function(){};IMcxContentSymbol.prototype.setRotation=function(a){};IMcxContentSymbol.prototype.getRotation=function(){};IMcxContentSymbol.prototype.setScale=function(a){};IMcxContentSymbol.prototype.getScale=function(){};js.framework.base.McxCoreGis.Style.IMcxDisplacement={};function IMcxDisplacement(){}IMcxDisplacement.prototype.getDisplacementX=function(){};IMcxDisplacement.prototype.setDisplacementX=function(a){};IMcxDisplacement.prototype.getDisplacementY=function(){};IMcxDisplacement.prototype.setDisplacementY=function(a){};IMcxDisplacement.prototype.clone=function(){};js.framework.base.McxCoreGis.Style.IMcxFill={};function IMcxFill(){}IMcxFill.prototype.getColor=function(){};IMcxFill.prototype.setColor=function(a){};IMcxFill.prototype.getOpacity=function(){};IMcxFill.prototype.setOpacity=function(a){};IMcxFill.prototype.clone=function(){};js.framework.base.McxCoreGis.Style.IMcxFont={};function IMcxFont(){}IMcxFont.prototype.setFontFamily=function(a){};IMcxFont.prototype.getFontFamily=function(){};IMcxFont.prototype.setFontSize=function(a){};IMcxFont.prototype.getFontSize=function(){};IMcxFont.prototype.setFontAlign=function(a){};IMcxFont.prototype.getFontAlign=function(){};IMcxFont.prototype.setFontUnit=function(a){};IMcxFont.prototype.getFontUnit=function(){};IMcxFont.prototype.setFontWeight=function(a){};
IMcxFont.prototype.getFontWeight=function(){};IMcxFont.prototype.clone=function(){};IMcxFont.prototype.toString=function(){};js.framework.base.McxCoreGis.Style.IMcxGraphic={};function IMcxGraphic(){};js.framework.base.McxCoreGis.Style.IMcxLabelPlacement={};function IMcxLabelPlacement(){};js.framework.base.McxCoreGis.Style.IMcxLinePlacement={};function IMcxLinePlacement(){}IMcxLinePlacement.prototype.getPerpendicularOffset=function(){};IMcxLinePlacement.prototype.setPerpendicularOffset=function(a){};IMcxLinePlacement.prototype.isAligned=function(){};IMcxLinePlacement.prototype.setAligned=function(a){};IMcxLinePlacement.prototype.isGeneralized=function(){};IMcxLinePlacement.prototype.setGeneralized=function(a){};IMcxLinePlacement.prototype.isRepeated=function(){};
IMcxLinePlacement.prototype.setRepeated=function(a){};IMcxLinePlacement.prototype.getInitialGap=function(){};IMcxLinePlacement.prototype.setInitialGap=function(a){};IMcxLinePlacement.prototype.getGap=function(){};IMcxLinePlacement.prototype.setGap=function(a){};js.framework.base.McxCoreGis.Style.IMcxLineSymbolizer={};function IMcxLineSymbolizer(){}IMcxLineSymbolizer.prototype.getStroke=function(){};IMcxLineSymbolizer.prototype.setStroke=function(a){};js.framework.base.McxCoreGis.Style.IMcxMark={};function IMcxMark(){}IMcxMark.prototype.getStroke=function(){};IMcxMark.prototype.setStroke=function(a){};IMcxMark.prototype.getFill=function(){};IMcxMark.prototype.setFill=function(a){};IMcxMark.prototype.getWellKnownName=function(){};IMcxMark.prototype.isInstanceOf=function(a){};IMcxMark.prototype.clone=function(){};js.framework.base.McxCoreGis.Style.IMcxObjSymbolizer={};function IMcxObjSymbolizer(){}IMcxObjSymbolizer.prototype.getObjFilePath=function(){};IMcxObjSymbolizer.prototype.getMtlFilePath=function(){};IMcxObjSymbolizer.prototype.setMtlFilePath=function(a){};IMcxObjSymbolizer.prototype.setScaleX=function(a){};IMcxObjSymbolizer.prototype.setScaleY=function(a){};IMcxObjSymbolizer.prototype.setScaleZ=function(a){};IMcxObjSymbolizer.prototype.getScaleX=function(){};IMcxObjSymbolizer.prototype.getScaleY=function(){};
IMcxObjSymbolizer.prototype.getScaleZ=function(){};IMcxObjSymbolizer.prototype.setRotateX=function(a){};IMcxObjSymbolizer.prototype.setRotateY=function(a){};IMcxObjSymbolizer.prototype.setRotateZ=function(a){};IMcxObjSymbolizer.prototype.getRotateX=function(){};IMcxObjSymbolizer.prototype.getRotateY=function(){};IMcxObjSymbolizer.prototype.getRotateZ=function(){};js.framework.base.McxCoreGis.Style.IMcxPointPlacement={};function IMcxPointPlacement(){}IMcxPointPlacement.prototype.getAnchorPoint=function(){};IMcxPointPlacement.prototype.setAnchorPoint=function(a){};IMcxPointPlacement.prototype.getDisplacement=function(){};IMcxPointPlacement.prototype.setDisplacement=function(a){};IMcxPointPlacement.prototype.getRotation=function(){};IMcxPointPlacement.prototype.setRotation=function(a){};js.framework.base.McxCoreGis.Style.IMcxPointSymbolizer={};function IMcxPointSymbolizer(){}IMcxPointSymbolizer.prototype.setSymbols=function(a){};IMcxPointSymbolizer.prototype.getSymbols=function(){};IMcxPointSymbolizer.prototype.getAnchorPoint=function(){};IMcxPointSymbolizer.prototype.setAnchorPoint=function(a){};IMcxPointSymbolizer.prototype.getDisplacement=function(){};IMcxPointSymbolizer.prototype.setDisplacement=function(a){};IMcxPointSymbolizer.prototype.getGap=function(){};
IMcxPointSymbolizer.prototype.setGap=function(a){};IMcxPointSymbolizer.prototype.getInitialGap=function(){};IMcxPointSymbolizer.prototype.setInitialGap=function(a){};IMcxPointSymbolizer.prototype.getOpacity=function(){};IMcxPointSymbolizer.prototype.setOpacity=function(a){};IMcxPointSymbolizer.prototype.getRotation=function(){};IMcxPointSymbolizer.prototype.setRotation=function(a){};IMcxPointSymbolizer.prototype.getSize=function(){};IMcxPointSymbolizer.prototype.setSize=function(a){};js.framework.base.McxCoreGis.Style.IMcxPolygonSymbolizer={};function IMcxPolygonSymbolizer(){}IMcxPolygonSymbolizer.prototype.getFill=function(){};IMcxPolygonSymbolizer.prototype.setFill=function(a){};IMcxPolygonSymbolizer.prototype.getStroke=function(){};IMcxPolygonSymbolizer.prototype.setStroke=function(a){};js.framework.base.McxCoreGis.Style.IMcxRasterSymbolizer={};function IMcxRasterSymbolizer(){}IMcxRasterSymbolizer.prototype.getOpacity=function(){};IMcxRasterSymbolizer.prototype.setOpacity=function(a){};js.framework.base.McxCoreGis.Style.IMcxStroke={};function IMcxStroke(){}IMcxStroke.prototype.getColor=function(){};IMcxStroke.prototype.setColor=function(a){};IMcxStroke.prototype.getOpacity=function(){};IMcxStroke.prototype.setOpacity=function(a){};IMcxStroke.prototype.getWidth=function(){};IMcxStroke.prototype.setWidth=function(a){};IMcxStroke.prototype.getDashPattern=function(){};IMcxStroke.prototype.setDashPattern=function(a){};IMcxStroke.prototype.getDashOffset=function(){};
IMcxStroke.prototype.setDashOffset=function(a){};IMcxStroke.prototype.getStartCap=function(){};IMcxStroke.prototype.setStartCap=function(a){};IMcxStroke.prototype.getEndCap=function(){};IMcxStroke.prototype.setEndCap=function(a){};IMcxStroke.prototype.getLineJoin=function(){};IMcxStroke.prototype.setLineJoin=function(a){};IMcxStroke.prototype.clone=function(){};js.framework.base.McxCoreGis.Style.IMcxStyleFactory={};function IMcxStyleFactory(){}IMcxStyleFactory.prototype.createStroke=function(){};IMcxStyleFactory.prototype.createStrokeFromColor=function(a){};IMcxStyleFactory.prototype.createStrokeWithColorAndWidth=function(a,b){};IMcxStyleFactory.prototype.createFill=function(){};IMcxStyleFactory.prototype.createFillFromColor=function(a){};IMcxStyleFactory.prototype.createPointSymbolizer=function(){};IMcxStyleFactory.prototype.createLineSymbolizer=function(){};
IMcxStyleFactory.prototype.createLineSymbolizerWithColor=function(a){};IMcxStyleFactory.prototype.createLineSymbolizerWithColorAndWidth=function(a,b){};IMcxStyleFactory.prototype.createPolygonSymbolizer=function(){};IMcxStyleFactory.prototype.createPolygonSymbolizerWithStrokeAndFill=function(a,b){};IMcxStyleFactory.prototype.createTextSymbolizer=function(){};IMcxStyleFactory.prototype.createCompositeSymbolizer=function(){};
IMcxStyleFactory.prototype.createCompositeSymbolizerWithSymbolizers=function(a,b,c){};IMcxStyleFactory.prototype.createRasterSymbolizer=function(){};IMcxStyleFactory.prototype.createSymbolizerFromSld=function(a){};IMcxStyleFactory.prototype.getDefaultPointSymbolizer=function(){};IMcxStyleFactory.prototype.getDefaultLineSymbolizer=function(){};IMcxStyleFactory.prototype.getDefaultPolygonSymbolizer=function(){};js.framework.base.McxCoreGis.Style.IMcxSymbol={};function IMcxSymbol(){}IMcxSymbol.prototype.isInstanceOf=function(a){};IMcxSymbol.prototype.clone=function(){};js.framework.base.McxCoreGis.Style.IMcxSymbolizer={};function IMcxSymbolizer(){}IMcxSymbolizer.prototype.toSLD=function(){};IMcxSymbolizer.prototype.clone=function(){};IMcxSymbolizer.prototype.isInstanceOf=function(a){};js.framework.base.McxCoreGis.Style.IMcxTextMark={};function IMcxTextMark(){}IMcxTextMark.prototype.getStroke=function(){};IMcxTextMark.prototype.setStroke=function(a){};IMcxTextMark.prototype.getFill=function(){};IMcxTextMark.prototype.setFill=function(a){};IMcxTextMark.prototype.getFont=function(){};IMcxTextMark.prototype.setFont=function(a){};IMcxTextMark.prototype.getSymbol=function(){};IMcxTextMark.prototype.setSymbol=function(a){};js.framework.base.McxCoreGis.Style.IMcxTextSymbolizer={};function IMcxTextSymbolizer(){}IMcxTextSymbolizer.prototype.getFill=function(){};IMcxTextSymbolizer.prototype.setFill=function(a){};IMcxTextSymbolizer.prototype.getFont=function(){};IMcxTextSymbolizer.prototype.setFont=function(a){};IMcxTextSymbolizer.prototype.setAnchorPoint=function(a){};IMcxTextSymbolizer.prototype.getAnchorPoint=function(){};IMcxTextSymbolizer.prototype.getDisplacement=function(){};
IMcxTextSymbolizer.prototype.setDisplacement=function(a){};IMcxTextSymbolizer.prototype.getRotation=function(){};IMcxTextSymbolizer.prototype.setRotation=function(a){};IMcxTextSymbolizer.prototype.isInstanceOf=function(a){};js.framework.base.McxCoreGis.Style.McxLineCap={};var McxLineCap={Butt:"butt",Round:"round",Square:"square"};js.framework.base.McxCoreGis.Style.McxLineJoin={};var McxLineJoin={Miter:"miter",Round:"round",Bevel:"bevel"};js.framework.base.McxCoreGis.Style.McxWellKnownName={};var McxWellKnownName={Circle:"circle",Cross:"cross",DiagCross:"diagCross",Triangle:"triangle",Square:"square",Star:"star"};
js.framework.base.McxGeospatial={};js.framework.base.McxGeospatial.McxGeospatialServiceManager={};
var McxGeospatialServiceManager={serviceUri:"",getServiceUri:function(){return McxGeospatialServiceManager.serviceUri},contains:function(a,b){var c=!1,d={};d.Geometry=a.toString();d.OtherGeometry=b.toString();var e=McxGeospatialServiceManager.getServiceUri()+"Contains";McxAjaxServiceCall.postAjaxCall(e,!0,JSON.stringify(d),"application/json",null,"json",!0,null,!1,function(a){c=a},function(a){a=new McxExceptionMessage(a);throw Error(a.getException());});return c},crosses:function(a,b){var c=!1,d=
{};d.Geometry=a.toString();d.OtherGeometry=b.toString();var e=McxGeospatialServiceManager.getServiceUri()+"Crosses";McxAjaxServiceCall.postAjaxCall(e,!0,JSON.stringify(d),"application/json",null,"json",!0,null,!1,function(a){c=a},function(a){a=new McxExceptionMessage(a);throw Error(a.getException());});return c},difference:function(a,b){var c=null,d={};d.Geometry=a.toString();d.OtherGeometry=b.toString();var e=McxGeospatialServiceManager.getServiceUri()+"Difference";McxAjaxServiceCall.postAjaxCall(e,
!0,JSON.stringify(d),"application/json",null,"json",!0,null,!1,function(a){c=McxFsConverter.parseGeometry(a,null,null)},function(a){a=new McxExceptionMessage(a);throw Error(a.getException());});return c},disjoint:function(a,b){var c=!1,d={};d.Geometry=a.toString();d.OtherGeometry=b.toString();var e=McxGeospatialServiceManager.getServiceUri()+"Disjoint";McxAjaxServiceCall.postAjaxCall(e,!0,JSON.stringify(d),"application/json",null,"json",!0,null,!1,function(a){c=a},function(a){a=new McxExceptionMessage(a);
throw Error(a.getException());});return c},distance:function(a,b){var c=0,d={};d.Geometry=a.toString();d.OtherGeometry=b.toString();var e=McxGeospatialServiceManager.getServiceUri()+"Distance";McxAjaxServiceCall.postAjaxCall(e,!0,JSON.stringify(d),"application/json",null,"json",!0,null,!1,function(a){c=a},function(a){a=new McxExceptionMessage(a);throw Error(a.getException());});return c},intersection:function(a,b){var c=null,d={};d.Geometry=a.toString();d.OtherGeometry=b.toString();var e=McxGeospatialServiceManager.getServiceUri()+
"Intersection";McxAjaxServiceCall.postAjaxCall(e,!0,JSON.stringify(d),"application/json",null,"json",!0,null,!1,function(a){c=McxFsConverter.parseGeometry(a,null,null)},function(a){a=new McxExceptionMessage(a);throw Error(a.getException());});return c},intersects:function(a,b){var c=!1,d={};d.Geometry=a.toString();d.OtherGeometry=b.toString();var e=McxGeospatialServiceManager.getServiceUri()+"Intersects";McxAjaxServiceCall.postAjaxCall(e,!0,JSON.stringify(d),"application/json",null,"json",!0,null,
!1,function(a){c=a},function(a){a=new McxExceptionMessage(a);throw Error(a.getException());});return c},overlaps:function(a,b){var c=!1,d={};d.Geometry=a.toString();d.OtherGeometry=b.toString();var e=McxGeospatialServiceManager.getServiceUri()+"Overlaps";McxAjaxServiceCall.postAjaxCall(e,!0,JSON.stringify(d),"application/json",null,"json",!0,null,!1,function(a){c=a},function(a){a=new McxExceptionMessage(a);throw Error(a.getException());});return c},relate:function(a,b,c){var d=!1,e={};e.Geometry=
a.toString();e.OtherGeometry=b.toString();e.Relation=c;a=McxGeospatialServiceManager.getServiceUri()+"Relate";McxAjaxServiceCall.postAjaxCall(a,!0,JSON.stringify(e),"application/json",null,"json",!0,null,!1,function(a){d=a},function(a){a=new McxExceptionMessage(a);throw Error(a.getException());});return d},symDifference:function(a,b){var c=null,d={};d.Geometry=a.toString();d.OtherGeometry=b.toString();var e=McxGeospatialServiceManager.getServiceUri()+"SymDifference";McxAjaxServiceCall.postAjaxCall(e,
!0,JSON.stringify(d),"application/json",null,"json",!0,null,!1,function(a){c=McxFsConverter.parseGeometry(a,null,null)},function(a){a=new McxExceptionMessage(a);throw Error(a.getException());});return c},touches:function(a,b){var c=!1,d={};d.Geometry=a.toString();d.OtherGeometry=b.toString();var e=McxGeospatialServiceManager.getServiceUri()+"Touches";McxAjaxServiceCall.postAjaxCall(e,!0,JSON.stringify(d),"application/json",null,"json",!0,null,!1,function(a){c=a},function(a){a=new McxExceptionMessage(a);
throw Error(a.getException());});return c},union:function(a){for(var b=null,c={},d=[],e=0;e<a.length;e++)d.push(a[e].toString());c.GeometryArray=d;a=McxGeospatialServiceManager.getServiceUri()+"Union";McxAjaxServiceCall.postAjaxCall(a,!0,JSON.stringify(c),"application/json",null,"json",!0,null,!1,function(a){b=McxFsConverter.parseGeometry(a,null,null)},function(a){a=new McxExceptionMessage(a);throw Error(a.getException());});return b},within:function(a,b){var c=!1,d={};d.Geometry=a.toString();d.OtherGeometry=
b.toString();var e=McxGeospatialServiceManager.getServiceUri()+"Within";McxAjaxServiceCall.postAjaxCall(e,!0,JSON.stringify(d),"application/json",null,"json",!0,null,!1,function(a){c=a},function(a){a=new McxExceptionMessage(a);throw Error(a.getException());});return c}};js.framework.base.McxGeospatial.CoordinateSystem={};js.framework.base.McxGeospatial.CoordinateSystem.McxCoordinateSystem={};function McxCoordinateSystem(a){this.definition=a;this.wkt=this.serviceUri=this.name="";this.proj=null;this.code="0";this.init()}
McxCoordinateSystem.prototype.init=function(){if("number"==typeof this.definition){var a=this.getServiceUri();""!=a&&$.ajax({url:a+"GetCSDefinition?epsgCode="+this.definition,dataType:"json",cache:!0,async:!1,success:$.proxy(this.csDefinitionSuccess,this)})}else this.proj=McxLib.proj4().Proj(this.definition),this.name=this.proj.srsCode,this.wkt=this.definition};McxCoordinateSystem.prototype.getName=function(){return this.name};
McxCoordinateSystem.prototype.getCode=function(){return null==this.code||"0"==this.code?"EPSG:4326":"EPSG:"+this.code};McxCoordinateSystem.prototype.getUnits=function(){return this.proj?this.proj.units:null};McxCoordinateSystem.prototype.equals=function(a){var b=!1;a&&a instanceof McxCoordinateSystem&&(b=this.getProj()==a.getProj());return b};McxCoordinateSystem.prototype.toString=function(){return this.name};
McxCoordinateSystem.prototype.getDistancePerUnit=function(){return this.proj&&"longlat"==this.proj.projName?111034:1};McxCoordinateSystem.prototype.getProj=function(){return this.proj};McxCoordinateSystem.prototype.toWkt=function(){if(""==this.wkt){var a=this.getServiceUri();if(""==a)return"";$.ajax({url:a+"GetWkt?epsgCode="+this.definition,dataType:"json",cache:!0,async:!1,success:$.proxy(this.wktSuccess,this)})}return this.wkt};
McxCoordinateSystem.prototype.getServiceUri=function(){if(""!=this.serviceUri)return this.serviceUri;var a=this;$.ajax({url:$("mcxconfigurationpath").attr("src")||"src/appdata/McxConfiguration.xml",dataType:"xml",cache:!0,async:!1,success:function(b){b=$(b).find("services").find("geospatialService");a.serviceUri=b.find("uri").text()+"/rest/json/"}});return a.serviceUri};
McxCoordinateSystem.prototype.csDefinitionSuccess=function(a){if(null!=a){var b="EPSG:"+this.definition;null==McxLib.proj4().defs[b]&&McxLib.proj4().defs(b,"+title="+a.Name+a.Proj4);this.code=a.Code.toString();this.proj=McxLib.proj4().Proj(b);this.name=a.Name}};McxCoordinateSystem.prototype.wktSuccess=function(a){this.wkt=a};js.framework.base.McxGeospatial.CoordinateSystem.McxCoordinateTransform={};function McxCoordinateTransform(){}McxCoordinateTransform.prototype.transform=function(a,b,c,d){return this.transformGeometry(a,b,new McxPoint(c,d,a))};
McxCoordinateTransform.prototype.transformGeometry=function(a,b,c){if(!a||!b||a.equals(b))return c;if(c.isInstanceOf(McxGeometryType.Point))return this.transformPoint(a,b,c);if(c.isInstanceOf(McxGeometryType.LineString))return this.transformLineString(a,b,c);if(c.isInstanceOf(McxGeometryType.Polygon))return this.transformPolygon(a,b,c);if(c.isInstanceOf(McxGeometryType.LinearRing))return this.transformLinearRing(a,b,c);if(c.isInstanceOf(McxGeometryType.MultiPoint))return this.transformMultiPoint(a,
b,c);if(c.isInstanceOf(McxGeometryType.MultiLineString))return this.transformMultiLineString(a,b,c);if(c.isInstanceOf(McxGeometryType.MultiPolygon))return this.transformMultiPolygon(a,b,c);c.setCoordinateSystem(b);return c};McxCoordinateTransform.prototype.transformPoint=function(a,b,c){c=new McxPoint(c.getX(),c.getY(),b);return McxLib.proj4().transform(a.getProj(),b.getProj(),c)};
McxCoordinateTransform.prototype.transformLineString=function(a,b,c){for(var d=[c.getPoints().length],e=0;e<c.getPoints().length;e++){var f=this.transformPoint(a,b,c.getPoints()[e]);d[e]=f}return new McxLineString(d,b)};McxCoordinateTransform.prototype.transformLinearRing=function(a,b,c){for(var d=[c.getPoints().length],e=0;e<c.getPoints().length;e++){var f=this.transformPoint(a,b,c.getPoints()[e]);d[e]=f}return new McxLinearRing(d,b)};
McxCoordinateTransform.prototype.transformPolygon=function(a,b,c){for(var d=this.transformLinearRing(a,b,c.getShell()),e=Array(c.getHoles().length),f=0;f<c.getHoles().length;f++){var g=this.transformLinearRing(a,b,c.getHoles()[f]);e[f]=g}return new McxPolygon(d,e,b)};McxCoordinateTransform.prototype.transformMultiPoint=function(a,b,c){var d=c.getPoints();c=[c.getComponents().length];for(var e=0;e<d.length;e++){var f=this.transformPoint(a,b,d[e]);c[e]=f}return new McxMultiPoint(c,b)};
McxCoordinateTransform.prototype.transformMultiLineString=function(a,b,c){c=c.getLines();for(var d=[c.length],e=0;e<c.length;e++){var f=this.transformLineString(a,b,c[e]);d[e]=f}return new McxMultiLineString(d,b)};McxCoordinateTransform.prototype.transformMultiPolygon=function(a,b,c){c=c.getPolygons();for(var d=[c.length],e=0;e<c.length;e++){var f=this.transformPolygon(a,b,c[e]);d[e]=f}return new McxMultiPolygon(d,b)};js.framework.base.McxGeospatial.Geometry={};js.framework.base.McxGeospatial.Geometry.McxBounds={};function McxBounds(a,b,c,d,e){this.left=a;this.bottom=b;this.right=c;this.top=d;this.width=this.left-this.bottom;this.height=this.top-this.bottom;this.coordinateSystem=e}McxBounds.prototype.getLeft=function(){return this.left};McxBounds.prototype.getRight=function(){return this.right};McxBounds.prototype.getTop=function(){return this.top};McxBounds.prototype.getBottom=function(){return this.bottom};
McxBounds.prototype.getWidth=function(){return this.right-this.left};McxBounds.prototype.getHeight=function(){return this.top-this.bottom};McxBounds.prototype.getCoordinateSystem=function(){return this.coordinateSystem};McxBounds.prototype.setCoordinateSystem=function(a){this.coordinateSystem=a};McxBounds.prototype.equals=function(a){var b=!1;null!=a&&(b=this.left==a.getLeft()&&this.right==a.getRight()&&this.top==a.getTop()&&this.bottom==a.getBottom());return b};
McxBounds.prototype.intersectsBounds=function(a){return this.left<=a.getRight()&&this.right>=a.getLeft()&&this.bottom<=a.getTop()&&this.top>=a.getBottom()};McxBounds.prototype.scale=function(a,b){null==b&&(b=this.getCentroid());var c=b.getX(),d=b.getY();return new McxBounds((this.left-c)*a+c,(this.bottom-d)*a+d,(this.right-c)*a+c,(this.top-d)*a+d,this.coordinateSystem)};McxBounds.prototype.getCentroid=function(){return new McxPoint((this.left+this.right)/2,(this.top+this.bottom)/2,this.coordinateSystem)};
McxBounds.prototype.distanceTo=function(a,b){};McxBounds.prototype.getSortedSegments=function(){};McxBounds.prototype.getPoints=function(){var a=[],b=new McxPoint(this.getLeft(),this.getBottom(),this.coordinateSystem),c=new McxPoint(this.getLeft(),this.getTop(),this.coordinateSystem),d=new McxPoint(this.getRight(),this.getTop(),this.coordinateSystem),e=new McxPoint(this.getRight(),this.getBottom(),this.coordinateSystem);a.push(b);a.push(c);a.push(d);a.push(e);return a};
McxBounds.prototype.contains=function(a,b){return this.getLeft()<a&&this.getRight()>a&&this.getBottom()<b&&this.getTop()>b};McxBounds.prototype.transformTo=function(a){var b=new McxPoint(this.getLeft(),this.getTop(),this.coordinateSystem),c=new McxPoint(this.getRight(),this.getBottom(),this.coordinateSystem),b=b.transformTo(a),c=c.transformTo(a);return new McxBounds(b.getX(),c.getY(),c.getX(),b.getY(),a)};
McxBounds.prototype.merge=function(a){var b=Math.min(this.left,a.getLeft()),c=Math.min(this.bottom,a.getBottom()),d=Math.max(this.right,a.getRight());a=Math.max(this.top,a.getTop());return new McxBounds(b,c,d,a,this.coordinateSystem)};McxBounds.prototype.inflate=function(a,b){return new McxBounds(this.left-a/2,this.bottom-b/2,this.right+a/2,this.top+b/2,this.coordinateSystem)};
McxBounds.prototype.intersectedArea=function(a){var b=new McxBounds(0,0,0,0,this.coordinateSystem);if(!this.intersectsBounds(a))return b;var b=this.left<a.getLeft()?this:a,c=this.left<a.getLeft()?a:this;a=Math.max(b.getLeft(),c.getLeft());var d=Math.min(b.getRight(),c.getRight()),e=Math.min(b.getTop(),c.getTop()),b=Math.max(b.getBottom(),c.getBottom());return new McxBounds(a,b,d,e,this.coordinateSystem)};
McxBounds.prototype.clone=function(){return new McxBounds(this.left,this.bottom,this.right,this.top,this.coordinateSystem)};McxBounds.prototype.toString=function(){var a="";null!=this.coordinateSystem&&(a=this.coordinateSystem.getCode());""==a&&(a="0");null!=this.coordinateSystem&&(a=this.coordinateSystem.getCode(),a=a.toLowerCase().split("epsg:")[1]);return a+" "+this.left+" "+this.bottom+" "+this.right+" "+this.top};js.framework.base.McxGeospatial.Geometry.McxGeometryParser={};
var McxGeometryParser={cursorLocation:0,geometryString:"",parse:function(a){McxGeometryParser.cursorLocation=0;McxGeometryParser.geometryString=a;a=McxGeometryParser.readInteger(" ");var b=McxGeometryParser.readInteger(" "),b=new McxCoordinateSystem(b),c=null;switch(a){case McxGeometryType.Point:c=McxGeometryParser.parsePoint();break;case McxGeometryType.LineString:c=McxGeometryParser.parseLineString();break;case McxGeometryType.Polygon:c=McxGeometryParser.parsePolygon();break;case McxGeometryType.MultiPoint:c=
McxGeometryParser.parseMultiPoint();break;case McxGeometryType.MultiLineString:c=McxGeometryParser.parseMultiLineString();break;case McxGeometryType.MultiPolygon:c=McxGeometryParser.parseMultiPolygon()}null!=c&&c.setCoordinateSystem(b);return c},readNext:function(a){for(var b="";McxGeometryParser.cursorLocation<McxGeometryParser.geometryString.length;)if(McxGeometryParser.geometryString[McxGeometryParser.cursorLocation]==a){McxGeometryParser.cursorLocation++;break}else b+=McxGeometryParser.geometryString[McxGeometryParser.cursorLocation],
McxGeometryParser.cursorLocation++;return b},readFloat:function(a){return parseFloat(McxGeometryParser.readNext(a))},readInteger:function(a){return parseInt(McxGeometryParser.readNext(a),10)},parsePoint:function(){var a=McxGeometryParser.readFloat(" "),b=McxGeometryParser.readFloat(" ");return new McxPoint(a,b,null)},parseLineString:function(){for(var a=McxGeometryParser.readInteger(" "),b=Array(a),c=0;c<a;c++)b[c]=McxGeometryParser.parsePoint();return new McxLineString(b,null)},parseLinearRing:function(){for(var a=
McxGeometryParser.readInteger(" "),b=Array(a),c=0;c<a;c++)b[c]=McxGeometryParser.parsePoint();return new McxLinearRing(b,null)},parsePolygon:function(){var a=McxGeometryParser.readInteger(" "),b=McxGeometryParser.parseLinearRing(),c=null;if(1<a)for(var c=Array(a-1),d=0;d<a-1;d++)c[d]=McxGeometryParser.parseLinearRing();return new McxPolygon(b,c,null)},parseMultiPoint:function(){for(var a=McxGeometryParser.readInteger(" "),b=Array(a),c=0;c<a;c++)b[c]=McxGeometryParser.parsePoint();return new McxMultiPoint(b,
null)},parseMultiLineString:function(){for(var a=McxGeometryParser.readInteger(" "),b=Array(a),c=0;c<a;c++)b[c]=McxGeometryParser.parseLineString();return new McxMultiLineString(b,null)},parseMultiPolygon:function(){for(var a=McxGeometryParser.readInteger(" "),b=[],c=[],d=null,e=0;e<a;e++)if("-"==McxGeometryParser.geometryString[McxGeometryParser.cursorLocation]){McxGeometryParser.cursorLocation++;var f=McxGeometryParser.parseLinearRing();c.push(f)}else null!=d&&(d=1<c.length?new McxPolygon(d,c,null):
new McxPolygon(d,null,null),c=[],b.push(d)),d=McxGeometryParser.parseLinearRing();null!=d&&(d=1<c.length?new McxPolygon(d,c,null):new McxPolygon(d,null,null),b.push(d));return new McxMultiPolygon(b,null)}};js.framework.base.McxGeospatial.Geometry.McxLinearRing={};function McxLinearRing(a,b){this.points=a;this.coordinateSystem=b;this.bounds=null}McxLinearRing.prototype.setPoints=function(a){this.points=a};McxLinearRing.prototype.getPoints=function(){return this.points};McxLinearRing.prototype.getEndPoint=function(){return this.points[this.points.length-1]};McxLinearRing.prototype.getStartPoint=function(){return this.points[0]};
McxLinearRing.prototype.calculateBounds=function(){for(var a=Number.MAX_VALUE,b=Number.MAX_VALUE,c=Number.MIN_VALUE,d=Number.MIN_VALUE,e=0;e<this.points.length;e++)this.points[e].getX()<a&&(a=this.points[e].getX()),this.points[e].getX()>c&&(c=this.points[e].getX()),this.points[e].getY()<b&&(b=this.points[e].getY()),this.points[e].getY()>d&&(d=this.points[e].getY());this.bounds=new McxBounds(a,b,c,d,this.coordinateSystem)};
McxLinearRing.prototype.getBounds=function(){null==this.bounds&&this.calculateBounds();return this.bounds};McxLinearRing.prototype.intersects=function(a){var b=!1;a.isInstanceOf(McxGeometryType.Point)||(b=a.intersects(this));return b};
McxLinearRing.prototype.intersection=function(a){if(a.isInstanceOf(McxGeometryType.LineString)||a.isInstanceOf(McxGeometryType.LinearRing)){var b=this.segmentize();a=a.segmentize();for(var c=[],d=0;d<b.length;d++)for(var e=0;e<a.length;e++){var f=b[d].intersectSegment(a[e],!1);null!=f&&c.push(f)}return new McxMultiPoint(c,this.coordinateSystem)}return null};
McxLinearRing.prototype.equals=function(a){if(!a.isInstanceOf(McxGeometryType.LineString)||a.getPoints().length!=this.points.length)return!1;for(var b=0;b<this.points.length;b++)if(!this.points[b].equals(a.getPoints()[b]))return!1;return!0};McxLinearRing.prototype.isInstanceOf=function(a){return a==McxGeometryType.LineString||a==McxGeometryType.LinearRing};
McxLinearRing.prototype.distanceTo=function(a){if(a.isInstanceOf(McxGeometryType.LineString)||a.isInstanceOf(McxGeometryType.LinearRing)||a.isInstanceOf(McxGeometryType.Polygon)){a=a.isInstanceOf(McxGeometryType.LineString)||a.isInstanceOf(McxGeometryType.LinearRing)?a.segmentize():a.getShell().segmentize();for(var b=this.segmentize(),c=Number.MAX_VALUE,d=0;d<b.length;d++)for(var e=0;e<a.length;e++){var f=a[e].distanceTo(b[d]);c>f&&(c=f)}this.coordinateSystem&&(c*=this.coordinateSystem.getDistancePerUnit());
return c}return a.distanceTo(this)};McxLinearRing.prototype.getSortedSegments=function(){};McxLinearRing.prototype.getCoordinateSystem=function(){return this.coordinateSystem};McxLinearRing.prototype.setCoordinateSystem=function(a){this.coordinateSystem=a};McxLinearRing.prototype.transformTo=function(a){return(new McxCoordinateTransform).transformGeometry(this.coordinateSystem,a,this)};
McxLinearRing.prototype.offset=function(a){var b=[],c=this.segmentize();if(1==c.length){var d=c[0].offset(a);b.push(new McxPoint(d.getStartX(),d.getStartY(),this.coordinateSystem));b.push(new McxPoint(d.getEndX(),d.getEndY(),this.coordinateSystem))}for(var e=0;e<c.length-1;e++){var d=c[e].offset(a),f=c[e+1].offset(a),d=d.intersectSegment(f,!0);null!=d&&b.push(new McxPoint(d.getX(),d.getY(),this.coordinateSystem))}d=c[c.length-1].offset(a);f=c[0].offset(a);d=d.intersectSegment(f,!0);null!=d&&b.push(new McxPoint(d.getX(),
d.getY(),this.coordinateSystem));a=new McxLinearRing(b,this.coordinateSystem);a.closeRing();return a};McxLinearRing.prototype.segmentize=function(){for(var a=[],b=0;b<this.points.length-1;b++){var c=new McxLineSegment(this.points[b].getX(),this.points[b].getY(),this.points[b+1].getX(),this.points[b+1].getY(),this.coordinateSystem);a.push(c)}return a};
McxLinearRing.prototype.containsPoint=function(a){var b=a.getX();a=a.getY();for(var c=this.points.length-1,d,e,f,g,h,k=0,m=0;m<c;++m)if(d=this.points[m],f=d.getX(),d=d.getY(),e=this.points[m+1],g=e.getX(),e=e.getY(),d==e){if(a==d&&(f<=g&&b>=f&&b<=g||f>=g&&b<=f&&b>=g)){k=-1;break}}else{h=(g-f)/(e-d)*(a-e)+g;if(h==b&&(d<e&&a>=d&&a<=e||d>e&&a<=d&&a>=e)){k=-1;break}h<=b||f!=g&&(h<Math.min(f,g)||h>Math.max(f,g))||(d<e&&a>=d&&a<e||d>e&&a<d&&a>=e)&&++k}return-1==k?1:!!(k&1)};
McxLinearRing.prototype.getLength=function(){for(var a=0,b=0;b<this.points.length-1;b++)a+=Math.sqrt(Math.pow(this.points[b].getX()-this.points[b+1].getX(),2)+Math.pow(this.points[b].getY()-this.points[b+1].getY(),2));this.coordinateSystem&&(a*=this.coordinateSystem.getDistancePerUnit());return a};McxLinearRing.prototype.clone=function(){for(var a=[],b=0;b<this.points.length;b++)a.push(this.points[b].clone());return new McxLinearRing(a,this.coordinateSystem)};
McxLinearRing.prototype.closeRing=function(){this.points[this.points.length-1].equals(this.points[0])||this.points.push(this.points[0].clone())};McxLinearRing.prototype.translate=function(a,b){for(var c=0;c<this.points.length-1;c++)this.points[c].translate(a,b);this.points[this.points.length-1]=this.points[0].clone();this.bounds=null};
McxLinearRing.prototype.rotate=function(a,b){for(var c=0;c<this.points.length-1;c++)this.points[c].rotate(a,b);this.points[this.points.length-1]=this.points[0].clone();this.bounds=null};McxLinearRing.prototype.scale=function(a,b){for(var c=0;c<this.points.length-1;c++)this.points[c].scale(a,b);this.points[this.points.length-1]=this.points[0].clone();this.bounds=null};
McxLinearRing.prototype.buffer=function(a){a=this.offset(a).getPoints();a=new McxLinearRing(a,this.coordinateSystem);a.closeRing();return new McxPolygon(a,null,this.coordinateSystem)};McxLinearRing.prototype.insertPoints=function(a,b){if(b instanceof Array)for(var c=0;c<b.length;c++)this.points.splice(a+c,0,b[c]);else this.points.splice(a,0,b)};McxLinearRing.prototype.getArea=function(){};McxLinearRing.prototype.getCentroid=function(){};McxLinearRing.prototype.contains=function(a){};js.framework.base.McxGeospatial.Geometry.McxLineSegment={};function McxLineSegment(a,b,c,d,e){this.x1=a;this.x2=c;this.y1=b;this.y2=d;this.startPoint=new McxPoint(a,b,e);this.endPoint=new McxPoint(c,d,e);this.coordinateSystem=e;this.bounds=null}McxLineSegment.prototype.getStartPoint=function(){return this.startPoint};McxLineSegment.prototype.getEndPoint=function(){return this.endPoint};McxLineSegment.prototype.getStartX=function(){return this.x1};McxLineSegment.prototype.getStartY=function(){return this.y1};
McxLineSegment.prototype.getEndX=function(){return this.x2};McxLineSegment.prototype.getEndY=function(){return this.y2};McxLineSegment.prototype.setPoints=function(a){this.startPoint=a[0];this.endPoint=a[1];this.x1=this.startPoint.getX();this.x2=this.endPoint.getX();this.y1=this.startPoint.getY();this.y2=this.endPoint.getY()};McxLineSegment.prototype.getPoints=function(){var a=[];a.push(this.startPoint);a.push(this.endPoint);return a};McxLineSegment.prototype.getSortedSegments=function(){return[this]};
McxLineSegment.prototype.getPerpendicularFoot=function(a,b){if(null==a)return null;var c=(a.getX()-this.startPoint.getX())*(this.endPoint.getX()-this.startPoint.getX())+(a.getY()-this.startPoint.getY())*(this.endPoint.getY()-this.startPoint.getY()),d=Math.pow(this.endPoint.getX()-this.startPoint.getX(),2)+Math.pow(this.endPoint.getY()-this.startPoint.getY(),2),d=0!=d?c/d:0;0>=d&&!b?c=this.startPoint:1<=d&&!b?c=this.endPoint:(c=this.startPoint.getX()+d*(this.endPoint.getX()-this.startPoint.getX()),
d=this.startPoint.getY()+d*(this.endPoint.getY()-this.startPoint.getY()),c=new McxPoint(c,d,this.coordinateSystem));return c};McxLineSegment.prototype.getBounds=function(){null==this.bounds&&this.calculateBounds();return this.bounds};
McxLineSegment.prototype.calculateBounds=function(){var a=Math.min(this.startPoint.getX(),this.endPoint.getX()),b=Math.min(this.startPoint.getY(),this.endPoint.getY()),c=Math.max(this.startPoint.getX(),this.endPoint.getX()),d=Math.max(this.startPoint.getY(),this.endPoint.getY());this.bounds=new McxBounds(a,b,c,d,this.coordinateSystem)};
McxLineSegment.prototype.contains=function(a){var b=[];if(a.isInstanceOf(McxGeometryType.Point))b.push(a);else if(a.isInstanceOf(McxGeometryType.MultiPoint))b=b.concat(a.getPoints());else if(a.isInstanceOf(McxGeometryType.LineString)||a.isInstanceOf(McxGeometryType.LinearRing))b=b.concat(a.getPoints());else if(a.isInstanceOf(McxGeometryType.Polygon))b=b.concat(a.getShell().getPoints());else if(a.isInstanceOf(McxGeometryType.MultiPolygon)){var c=a.getPolygons();for(a=0;a<c.length;a++)b=b.concat(c[a].getShell().getPoints())}else if(a.isInstanceOf(McxGeometryType.MultiLineString))for(c=
a.getLines(),a=0;a<c.length;a++)b=b.concat(c[a].getPoints());for(a=0;a<b.length;a++){var d=b[a],c=(d.getX()-this.x1)/(this.x2-this.x1),d=(d.getY()-this.y1)/(this.y2-this.y1);if(1E-10<Math.abs(c-d))return!1}return!0};
McxLineSegment.prototype.intersectSegment=function(a,b){var c=0,d=0,e=this.x2-this.x1,f=this.y2-this.y1,c=a.getEndX()-a.getStartX(),g=a.getEndY()-a.getStartY(),d=c*f-e*g;if(0==d)return null;c=(g*(this.x1-a.getStartX())+c*(a.getStartY()-this.y1))/d;d=(f*(this.x1-a.getStartX())+e*(a.getStartY()-this.y1))/d;e=new McxPoint(this.x1+c*e,this.y1+c*f,this.coordinateSystem);if(b)return e;if(0>c||1<c)e=null;if(0>d||1<d)e=null;return e};
McxLineSegment.prototype.intersectSegmentWithOptions=function(a,b){var c=0,d=0,e=this.x2-this.x1,f=this.y2-this.y1,c=a.getEndX()-a.getStartX(),g=a.getEndY()-a.getStartY(),d=c*f-e*g;if(0==d)return[null,-1,-1,!1];c=(g*(this.x1-a.getStartX())+c*(a.getStartY()-this.y1))/d;d=(f*(this.x1-a.getStartX())+e*(a.getStartY()-this.y1))/d;e=new McxPoint(this.x1+c*e,this.y1+c*f,this.coordinateSystem);f=!0;if(b)return[e,c,d,f];if(!b){if(0>c||1<c)e=null,f=!1;if(0>d||1<d)e=null,f=!1}return[e,c,d,f]};
McxLineSegment.prototype.offset=function(a){null!=this.coordinateSystem&&(a/=this.coordinateSystem.getDistancePerUnit());var b=Math.sqrt((this.x1-this.x2)*(this.x1-this.x2)+(this.y1-this.y2)*(this.y1-this.y2));return new McxLineSegment(this.x1+a*(this.y1-this.y2)/b,this.y1+a*(this.x2-this.x1)/b,this.x2+a*(this.y1-this.y2)/b,this.y2+a*(this.x2-this.x1)/b,this.coordinateSystem)};
McxLineSegment.prototype.distanceTo=function(a){if(a.isInstanceOf(McxGeometryType.LineSegment)){if(this.intersectSegment(a,!1))return 0;var b=this.getEndPoint().distanceTo(a.getEndPoint()),c=this.getStartPoint().distanceTo(a.getStartPoint()),d=this.getEndPoint().distanceTo(a.getStartPoint());a=this.getStartPoint().distanceTo(a.getEndPoint());b=Math.min(Math.min(b,c),Math.min(d,a));this.coordinateSystem&&(b*=this.coordinateSystem.getDistancePerUnit());return b}if(a.isInstanceOf(McxGeometryType.LineString)||
a.isInstanceOf(McxGeometryType.LinearRing)||a.isInstanceOf(McxGeometryType.Polygon)){b=a.isInstanceOf(McxGeometryType.LineString)||a.isInstanceOf(McxGeometryType.LinearRing)?a.segmentize():a.getShell().segmentize();c=this.segmentize();d=Number.MAX_VALUE;for(a=0;a<c.length;a++)for(var e=0;e<b.length;e++){var f=b[e].distanceTo(c[a]);d>f&&(d=f)}this.coordinateSystem&&(d*=this.coordinateSystem.getDistancePerUnit());return d}return a.distanceTo(this)};McxLineSegment.prototype.segmentize=function(){return[this.clone()]};
McxLineSegment.prototype.getAltitudePoint=function(a,b){var c=this.endPoint.getX()-this.startPoint.getX(),d=this.endPoint.getY()-this.startPoint.getY(),e=this.getLength();this.coordinateSystem&&(e/=this.coordinateSystem.getDistancePerUnit(),a/=this.coordinateSystem.getDistancePerUnit());var f=0,g=0;0!=e&&(f=d/e,g=c/e);c=this.startPoint.getX()+g*a-f*b;f=this.startPoint.getY()+f*a+g*b;return new McxPoint(c,f,this.coordinateSystem)};
McxLineSegment.prototype.getAngleFromNorth=function(a,b){var c=this.endPoint.getY()-this.startPoint.getY(),d=this.endPoint.getX()-this.startPoint.getX();1E-16>=a&&(a+=400);var e=0;0<c&&0<d?e=200/Math.PI*Math.atan(Math.abs(c)/Math.abs(d))+a:0<c&&0>d?e=200/Math.PI*Math.atan(Math.abs(d)/Math.abs(c))+a+100:0>c&&0>d?e=200/Math.PI*Math.atan(Math.abs(c)/Math.abs(d))+a+200:0>c&&0<d?e=200/Math.PI*Math.atan(Math.abs(d)/Math.abs(c))+a+300:0<c&&0==d?e=a+100:0==c&&0<d?e=a:0>c&&0==d?e=a+300:0==c&&0>d&&(e=a+200);
400<=e&&(e-=400);c=Math.sin(Math.PI*e/200)*b+this.startPoint.getY();e=Math.cos(Math.PI*e/200)*b+this.startPoint.getX();return new McxPoint(c,e,this.coordinateSystem)};McxLineSegment.prototype.getLength=function(){var a=Math.sqrt(Math.pow(this.startPoint.getX()-this.endPoint.getX(),2)+Math.pow(this.startPoint.getY()-this.endPoint.getY(),2));this.coordinateSystem&&(a*=this.coordinateSystem.getDistancePerUnit());return a};McxLineSegment.prototype.getCoordinateSystem=function(){return this.coordinateSystem};
McxLineSegment.prototype.setCoordinateSystem=function(a){this.coordinateSystem=a};McxLineSegment.prototype.transformTo=function(a){return(new McxCoordinateTransform).transformGeometry(this.coordinateSystem,a,this)};
McxLineSegment.prototype.buffer=function(a){null!=this.coordinateSystem&&(a/=this.coordinateSystem.getDistancePerUnit());var b=this.offset(a);a=this.offset(-1*a);b=b.getPoints();b=b.concat(a.getPoints());b=new McxLinearRing(b,this.coordinateSystem);b.closeRing();return new McxPolygon(b,null,this.coordinateSystem)};McxLineSegment.prototype.clone=function(){return new McxLineSegment(this.x1,this.y1,this.x2,this.y2,this.coordinateSystem)};
McxLineSegment.prototype.equals=function(a){if(!a.isInstanceOf(McxGeometryType.LineString)||a.getPoints().length!=this.getPoints().length)return!1;for(var b=0;b<this.getPoints().length;b++)if(!this.getPoints()[b].equals(a.getPoints()[b]))return!1;return!0};McxLineSegment.prototype.isInstanceOf=function(a){return McxGeometryType.LineString==a||McxGeometryType.LineSegment==a};McxLineSegment.prototype.insertPoints=function(a,b){};McxLineSegment.prototype.intersection=function(a){};
McxLineSegment.prototype.getAngle=function(){var a=Math.abs(this.endPoint.getX()-this.startPoint.getX()),b=Math.abs(this.endPoint.getY()-this.startPoint.getY()),a=0<a?Math.atan(b/a):0,a=McxMath.radianToDegree(a),b=this.endPoint.subtract(this.startPoint);0>b.getX()&&0<b.getY()?a=180-a:0>b.getX()&&0>b.getY()?a+=180:0<b.getX()&&0>b.getY()?a=360-a:0<b.getX()&&0==b.getY()?a=0:0==b.getX()&&0<b.getY()?a=90:0>b.getX()&&0==b.getY()?a=180:0==b.getX()&&0>b.getY()&&(a=270);return a};
McxLineSegment.prototype.getArea=function(){};McxLineSegment.prototype.getCentroid=function(){};McxLineSegment.prototype.intersects=function(a){};McxLineSegment.prototype.translate=function(a,b){};McxLineSegment.prototype.rotate=function(a,b){this.startPoint.rotate(a,b);this.endPoint.rotate(a,b);this.x1=this.startPoint.getX();this.y1=this.startPoint.getY();this.x2=this.endPoint.getX();this.y2=this.endPoint.getY();this.bounds=null};McxLineSegment.prototype.scale=function(a,b){};js.framework.base.McxGeospatial.Geometry.McxLineString={};function McxLineString(a,b){this.points=a;this.coordinateSystem=b;this.bounds=null}McxLineString.prototype.getPoints=function(){return this.points};McxLineString.prototype.setPoints=function(a){this.points=a};McxLineString.prototype.getEndPoint=function(){return this.points[this.points.length-1]};McxLineString.prototype.getStartPoint=function(){return this.points[0]};McxLineString.prototype.getArea=function(){};
McxLineString.prototype.getBounds=function(){null==this.bounds&&this.calculateBounds();return this.bounds};
McxLineString.prototype.calculateBounds=function(){for(var a=Number.MAX_VALUE,b=Number.MAX_VALUE,c=Number.MIN_VALUE,d=Number.MIN_VALUE,e=0;e<this.points.length;e++)this.points[e].getX()<a&&(a=this.points[e].getX()),this.points[e].getX()>c&&(c=this.points[e].getX()),this.points[e].getY()<b&&(b=this.points[e].getY()),this.points[e].getY()>d&&(d=this.points[e].getY());this.bounds=new McxBounds(a,b,c,d,this.coordinateSystem)};
McxLineString.prototype.equals=function(a){if(!a.isInstanceOf(McxGeometryType.LineString)||a.getPoints().length!=this.points.length)return!1;for(var b=0;b<this.points.length;b++)if(!this.points[b].equals(a.getPoints()[b]))return!1;return!0};McxLineString.prototype.getCentroid=function(){};McxLineString.prototype.isInstanceOf=function(a){return a==McxGeometryType.LineString};
McxLineString.prototype.distanceTo=function(a){if(a.isInstanceOf(McxGeometryType.LineString)||a.isInstanceOf(McxGeometryType.LinearRing)||a.isInstanceOf(McxGeometryType.Polygon)){a=a.isInstanceOf(McxGeometryType.LineString)||a.isInstanceOf(McxGeometryType.LinearRing)?a.segmentize():a.getShell().segmentize();for(var b=this.segmentize(),c=Number.MAX_VALUE,d=0;d<b.length;d++)for(var e=0;e<a.length;e++){var f=a[e].distanceTo(b[d]);c>f&&(c=f)}this.coordinateSystem&&(c*=this.coordinateSystem.getDistancePerUnit());
return c}return a.distanceTo(this)};
McxLineString.prototype.intersects=function(a){var b=!1;if(a.isInstanceOf(McxGeometryType.LineString)||a.isInstanceOf(McxGeometryType.LinearRing)||a.isInstanceOf(McxGeometryType.Point)){var c=this.segmentize();if(a.isInstanceOf(McxGeometryType.Point)){for(var d=0;d<c.length;d++)if(c[d].contains(a))return!0;return!1}for(var e=a.segmentize(),d=0;d<c.length;d++)for(var f=0;f<e.length;f++)if(a=c[d].intersectSegment(e[f],!1),null!=a)return!0}else b=a.intersects(this);return b};
McxLineString.prototype.getSortedSegments=function(){for(var a=this.points.length-1,b=Array(a),c,d,e=0;e<a;++e)c=this.points[e],d=this.points[e+1],b[e]=c.x<d.x?new McxLineSegment(c.x,c.y,d.x,d.y,this.coordinateSystem):new McxLineSegment(d.x,d.y,c.x,c.y,this.coordinateSystem);return b.sort(function(a,b){return a.getEndPoint().getX()-b.getEndPoint().getX()})};McxLineString.prototype.getCoordinateSystem=function(){return this.coordinateSystem};
McxLineString.prototype.setCoordinateSystem=function(a){this.coordinateSystem=a};McxLineString.prototype.transformTo=function(a){return(new McxCoordinateTransform).transformGeometry(this.coordinateSystem,a,this)};
McxLineString.prototype.offset=function(a){var b=[],c=this.segmentize();if(1==c.length){var d=c[0].offset(a);b.push(new McxPoint(d.getStartX(),d.getStartY(),this.coordinateSystem));b.push(new McxPoint(d.getEndX(),d.getEndY(),this.coordinateSystem))}for(var e=0;e<c.length-1;e++){var d=c[e].offset(a),f=c[e+1].offset(a);0==e&&b.push(new McxPoint(d.getStartX(),d.getStartY(),this.coordinateSystem));var g=d.intersectSegment(f,!0);null==g?b.push(new McxPoint(d.getEndX(),d.getEndY(),this.coordinateSystem)):
(b.push(new McxPoint(g.getX(),g.getY(),this.coordinateSystem)),e==c.length-2&&b.push(new McxPoint(f.getEndX(),f.getEndY(),this.coordinateSystem)))}return new McxLineString(b,this.coordinateSystem)};
McxLineString.prototype.toString=function(){var a="";null!=this.coordinateSystem&&(a=this.coordinateSystem.getCode(),a=a.toLowerCase().split("epsg:")[1]);a&&""!=a||(a="0");for(var a=""+(McxGeometryType.LineString+" "+a+" "),a=a+(this.points.length+" "),b=0;b<this.points.length;b++)a+=this.points[b].getX()+" "+this.points[b].getY()+" ";return a};
McxLineString.prototype.segmentize=function(){for(var a=[],b=0;b<this.points.length-1;b++){var c=new McxLineSegment(this.points[b].getX(),this.points[b].getY(),this.points[b+1].getX(),this.points[b+1].getY(),this.coordinateSystem);a.push(c)}return a};
McxLineString.prototype.getLength=function(){for(var a=0,b=0;b<this.points.length-1;b++)a+=Math.sqrt(Math.pow(this.points[b].getX()-this.points[b+1].getX(),2)+Math.pow(this.points[b].getY()-this.points[b+1].getY(),2));this.coordinateSystem&&(a*=this.coordinateSystem.getDistancePerUnit());return a};McxLineString.prototype.contains=function(a){for(var b=this.segmentize(),c=0;c<b.length;c++)if(b[c].contains(a))return!0;return!1};
McxLineString.prototype.clone=function(){for(var a=[],b=0;b<this.points.length;b++)a.push(this.points[b].clone());return new McxLineString(a,this.coordinateSystem)};McxLineString.prototype.buffer=function(a){null!=this.coordinateSystem&&(a/=this.coordinateSystem.getDistancePerUnit());var b=this.offset(a);a=this.offset(-a);b=b.getPoints();b=b.concat(a.getPoints().reverse());b=new McxLinearRing(b,this.coordinateSystem);b.closeRing();return new McxPolygon(b,null,this.coordinateSystem)};
McxLineString.prototype.translate=function(a,b){for(var c=0;c<this.points.length;c++)this.points[c].translate(a,b);this.bounds=null};McxLineString.prototype.rotate=function(a,b){for(var c=0;c<this.points.length;c++)this.points[c].rotate(a,b);this.bounds=null};McxLineString.prototype.scale=function(a,b){for(var c=0;c<this.points.length;c++)this.points[c].scale(a,b);this.bounds=null};
McxLineString.prototype.insertPoints=function(a,b){if(b instanceof Array)for(var c=0;c<b.length;c++)this.points.splice(a+c,0,b[c]);else this.points.splice(a,0,b)};McxLineString.prototype.intersection=function(a){};js.framework.base.McxGeospatial.Geometry.McxMultiLineString={};function McxMultiLineString(a,b){this.lineStrings=a;this.coordinateSystem=b;this.bounds=null}McxMultiLineString.prototype.getCount=function(){return this.lineStrings.length};McxMultiLineString.prototype.getLength=function(){for(var a=0,b=0;b<this.lineStrings.length;b++)a+=this.lineStrings[b].getLength();return a};McxMultiLineString.prototype.getComponents=function(){return this.lineStrings};McxMultiLineString.prototype.getLines=function(){return this.lineStrings};
McxMultiLineString.prototype.equals=function(a){if(!a.isInstanceOf(McxGeometryType.MultiLineString)||this.lineStrings.length!=a.getLines().length)return!1;for(var b=0;b<this.lineStrings.length;b++)if(!this.lineStrings[b].equals(a.getLines()[b]))return!1;return!0};McxMultiLineString.prototype.intersects=function(a){for(var b=0;b<this.lineStrings.length;b++)if(this.lineStrings[b].intersects(a))return!0;return!1};
McxMultiLineString.prototype.calculateBounds=function(){for(var a=this.getLines(),b=[],c=0;c<a.length;c++)b.push(a[c].getBounds());for(var d=a=Number.MAX_VALUE,e=Number.MIN_VALUE,f=Number.MIN_VALUE,c=0;c<b.length;c++)b[c].getLeft()<a&&(a=b[c].getLeft()),b[c].getRight()>e&&(e=b[c].getRight()),b[c].getBottom()<d&&(d=b[c].getBottom()),b[c].getTop()>f&&(f=b[c].getTop());this.bounds=new McxBounds(a,d,e,f,this.coordinateSystem)};
McxMultiLineString.prototype.getBounds=function(){null==this.bounds&&this.calculateBounds();return this.bounds};McxMultiLineString.prototype.getCentroid=function(){};McxMultiLineString.prototype.isInstanceOf=function(a){return a==McxGeometryType.MultiLineString};McxMultiLineString.prototype.distanceTo=function(a){for(var b=Number.MAX_VALUE,c=0;c<this.lineStrings;c++){var d=this.lineStrings[c].distanceTo(a);d<b&&(b=d)}return b};McxMultiLineString.prototype.getArea=function(){};
McxMultiLineString.prototype.getSortedSegments=function(){};McxMultiLineString.prototype.getCoordinateSystem=function(){return this.coordinateSystem};McxMultiLineString.prototype.setCoordinateSystem=function(a){this.coordinateSystem=a};McxMultiLineString.prototype.transformTo=function(a){for(var b=[],c=0;c<this.lineStrings.length;c++){var d=this.lineStrings[c].transformTo(a);b.push(d)}return new McxMultiLineString(b,this.coordinateSystem)};
McxMultiLineString.prototype.contains=function(a){for(var b=0;b<this.lineStrings.length;b++)if(this.lineStrings[b].contains(a))return!0;return!1};McxMultiLineString.prototype.clone=function(){for(var a=[],b=0;b<this.lineStrings.length;b++)a.push(this.lineStrings[b].clone());a=new McxMultiLineString(a,this.coordinateSystem);a.setCoordinateSystem(this.coordinateSystem);return a};
McxMultiLineString.prototype.buffer=function(a){for(var b=[],c=0;c<this.lineStrings.length;c++)b.push(this.lineStrings[c].buffer(a));return new McxMultiPolygon(b,this.coordinateSystem)};McxMultiLineString.prototype.translate=function(a,b){for(var c=0;c<this.lineStrings.length;c++)this.lineStrings[c].translate(a,b);this.bounds=null};McxMultiLineString.prototype.rotate=function(a,b){for(var c=0;c<this.lineStrings.length;c++)this.lineStrings[c].rotate(a,b);this.bounds=null};
McxMultiLineString.prototype.scale=function(a,b){for(var c=0;c<this.lineStrings.length;c++)this.lineStrings[c].scale(a,b);this.bounds=null};
McxMultiLineString.prototype.toString=function(){var a;a=""+(this.lineStrings.length+" ");for(var b=0;b<this.lineStrings.length;b++){var c=this.lineStrings[b].getPoints();a+=c.length+" ";for(var d=0;d<c.length;d++)a+=c[d].getX()+" "+c[d].getY()+" "}b="";null!=this.coordinateSystem&&(b=this.coordinateSystem.getCode(),b=b.toLowerCase().split("epsg:")[1]);b&&""!=b||(b="0");return McxGeometryType.MultiLineString+" "+b+" "+a};js.framework.base.McxGeospatial.Geometry.McxMultiPoint={};function McxMultiPoint(a,b){this.points=a;this.coordinateSystem=b;this.bounds=null}McxMultiPoint.prototype.getCount=function(){return this.points.length};McxMultiPoint.prototype.getComponents=function(){return this.points};McxMultiPoint.prototype.getPoints=function(){return this.points};
McxMultiPoint.prototype.equals=function(a){if(!a.isInstanceOf(McxGeometryType.MultiPoint)||this.points.length!=a.getPoints().length)return!1;for(var b=0;b<this.points.length;b++)if(!this.points[b].equals(a.getPoints()[b]))return!1;return!0};McxMultiPoint.prototype.intersects=function(a){for(var b=0;b<this.points.length;b++)if(this.points[b].intersects(a))return!0;return!1};McxMultiPoint.prototype.contains=function(a){for(var b=0;b<this.points.length;b++)if(this.points[b].contains(a))return!0;return!1};
McxMultiPoint.prototype.calculateBounds=function(){};McxMultiPoint.prototype.getBounds=function(){};McxMultiPoint.prototype.getCentroid=function(){};McxMultiPoint.prototype.isInstanceOf=function(a){};McxMultiPoint.prototype.distanceTo=function(a){for(var b=Number.MAX_VALUE,c=0;c<this.points;c++){var d=this.points[c].distanceTo(a);d<b&&(b=d)}return b};McxMultiPoint.prototype.getArea=function(){};McxMultiPoint.prototype.getSortedSegments=function(){};McxMultiPoint.prototype.getCoordinateSystem=function(){return this.coordinateSystem};
McxMultiPoint.prototype.setCoordinateSystem=function(a){this.coordinateSystem=a};McxMultiPoint.prototype.transformTo=function(a){for(var b=[],c=0;c<this.points.length;c++){var d=this.points[c].transformTo(a);b.push(d)}return new McxMultiPoint(b,this.coordinateSystem)};McxMultiPoint.prototype.clone=function(){for(var a=[],b=0;b<this.points.length;b++)a.push(this.points[b].clone());return new McxMultiPoint(a,this.coordinateSystem)};
McxMultiPoint.prototype.buffer=function(a){for(var b=[],c=0;c<this.points.length;c++)b.push(this.points[c].buffer(a));return new McxMultiPolygon(b,this.coordinateSystem)};McxMultiPoint.prototype.translate=function(a,b){for(var c=0;c<this.points.length;c++)this.points[c].translate(a,b);this.bounds=null};McxMultiPoint.prototype.rotate=function(a,b){for(var c=0;c<this.points.length;c++)this.points[c].rotate(a,b);this.bounds=null};
McxMultiPoint.prototype.scale=function(a,b){for(var c=0;c<this.points.length;c++)this.points[c].scale(a,b);this.bounds=null};McxMultiPoint.prototype.toString=function(){var a;a=""+(this.points.length+" ");for(var b=0;b<this.points.length;b++)a+=this.points[b].getX()+" "+this.points[b].getY()+" ";b="";null!=this.coordinateSystem&&(b=this.coordinateSystem.getCode(),b=b.toLowerCase().split("epsg:")[1]);b&&""!=b||(b="0");return McxGeometryType.MultiPoint+" "+b+" "+a};js.framework.base.McxGeospatial.Geometry.McxMultiPolygon={};function McxMultiPolygon(a,b){this.polygons=a;this.coordinateSystem=b;this.bounds=null}McxMultiPolygon.prototype.getCount=function(){return this.polygons.length};McxMultiPolygon.prototype.getComponents=function(){return this.polygons};McxMultiPolygon.prototype.getPolygons=function(){return this.polygons};McxMultiPolygon.prototype.isInstanceOf=function(a){return a==McxGeometryType.MultiPolygon};McxMultiPolygon.prototype.equals=function(a){};
McxMultiPolygon.prototype.intersects=function(a){for(var b=0;b<this.polygons.length;b++)if(this.polygons[b].intersects(a))return!0;return!1};
McxMultiPolygon.prototype.calculateBounds=function(){for(var a=Number.MAX_VALUE,b=Number.MAX_VALUE,c=Number.MIN_VALUE,d=Number.MIN_VALUE,e=0;e<this.polygons.length;e++){for(var f=this.polygons[e].getShell().getPoints(),g=0;g<f.length;g++)f[g].getX()<a&&(a=f[g].getX()),f[g].getX()>c&&(c=f[g].getX()),f[g].getY()<b&&(b=f[g].getY()),f[g].getY()>d&&(d=f[g].getY());for(var h=this.polygons[e].getHoles(),k=0;k<h.length;k++)for(f=h[k].getPoints(),g=0;g<f.length;g++)f[g].getX()<a&&(a=f[g].getX()),f[g].getX()>
c&&(c=f[g].getX()),f[g].getY()<b&&(b=f[g].getY()),f[g].getY()>d&&(d=f[g].getY())}this.bounds=new McxBounds(a,b,c,d,this.coordinateSystem)};McxMultiPolygon.prototype.getBounds=function(){null==this.bounds&&this.calculateBounds();return this.bounds};McxMultiPolygon.prototype.getCentroid=function(){};McxMultiPolygon.prototype.distanceTo=function(a){for(var b=Number.MAX_VALUE,c=0;c<this.polygons;c++){var d=this.polygons[c].distanceTo(a);d<b&&(b=d)}return b};
McxMultiPolygon.prototype.getArea=function(){for(var a=0,b=0;b<this.polygons.length;b++)a+=this.polygons[b].getArea();return a};McxMultiPolygon.prototype.getSortedSegments=function(){};McxMultiPolygon.prototype.getCoordinateSystem=function(){return this.coordinateSystem};McxMultiPolygon.prototype.setCoordinateSystem=function(a){this.coordinateSystem=a};
McxMultiPolygon.prototype.transformTo=function(a){for(var b=[],c=0;c<this.polygons.length;c++)b.push(this.polygons[c].transformTo(a));return new McxMultiPolygon(b,a)};McxMultiPolygon.prototype.clone=function(){for(var a=[],b=0;b<this.polygons.length;b++)a.push(this.polygons[b].clone());return new McxMultiPolygon(a,this.coordinateSystem)};McxMultiPolygon.prototype.buffer=function(a){for(var b=[],c=0;c<this.polygons.length;c++)b.push(this.polygons[c].buffer(a));return new McxMultiPolygon(b,this.coordinateSystem)};
McxMultiPolygon.prototype.translate=function(a,b){for(var c=0;c<this.polygons.length;c++)this.polygons[c].translate(a,b);this.bounds=null};McxMultiPolygon.prototype.rotate=function(a,b){for(var c=0;c<this.polygons.length;c++)this.polygons[c].rotate(a,b);this.bounds=null};McxMultiPolygon.prototype.scale=function(a,b){for(var c=0;c<this.polygons.length;c++)this.polygons[c].scale(a,b);this.bounds=null};
McxMultiPolygon.prototype.toString=function(){for(var a="",b=0,c=0;c<this.polygons.length;c++)b+=this.polygons[c].getHoles().length+1;a+=b+" ";for(c=0;c<this.polygons.length;c++){for(var b=this.polygons[c],d=b.getShell(),a=a+(d.getPoints().length+" "),e=0;e<d.getPoints().length;e++)a+=d.getPoints()[e].getX()+" "+d.getPoints()[e].getY()+" ";for(d=0;d<b.getHoles().length;d++)for(var f=b.getHoles()[d],a=a+(-1*f.getPoints().length+" "),e=0;e<f.getPoints().length;e++)a+=f.getPoints()[e].getX()+" "+f.getPoints()[e].getY()+
" "}c="";null!=this.coordinateSystem&&(c=this.coordinateSystem.getCode(),c=c.toLowerCase().split("epsg:")[1]);c&&""!=c||(c="0");return McxGeometryType.MultiPolygon+" "+c+" "+a};McxMultiPolygon.prototype.contains=function(a){for(var b=0;b<this.polygons.length;b++)if(this.polygons[b].contains(a))return!0;return!1};js.framework.base.McxGeospatial.Geometry.McxPoint={};function McxPoint(a,b,c){this.x=a;this.y=b;this.bounds=null;this.coordinateSystem=c}McxPoint.createEllipse=function(a,b,c,d,e){a=McxPoint.defineEllipseWithPoints(a,b,c,d,0,2*Math.PI,e);if(null==a||0>=a.length)return new McxLinearRing([],e);a.push(a[0]);return new McxLinearRing(a,e)};
McxPoint.defineEllipseWithPoints=function(a,b,c,d,e,f,g){for(var h=[];e<f;e+=.1){var k=a-c*Math.sin(e)*Math.sin(0*Math.PI)+d*Math.cos(e)*Math.cos(0*Math.PI),m=b+d*Math.cos(e)*Math.sin(0*Math.PI)+c*Math.sin(e)*Math.cos(0*Math.PI);h.push(new McxPoint(k,m,g))}return h};McxPoint.prototype.getX=function(){return this.x};McxPoint.prototype.getY=function(){return this.y};McxPoint.prototype.calculateBounds=function(){this.bounds=new McxBounds(this.x,this.y,this.x,this.y,this.coordinateSystem)};
McxPoint.prototype.getBounds=function(){null==this.bounds&&this.calculateBounds();return this.bounds};McxPoint.prototype.equals=function(a){if(!a||!a.isInstanceOf(McxGeometryType.Point))return!1;var b=!1;null!=a&&(b=this.x==a.getX()&&this.y==a.getY()||isNaN(this.x)&&isNaN(this.y)&&isNaN(a.getX())&&isNaN(a.getY()));return b};McxPoint.prototype.equalsWithEpsilon=function(a,b){return a&&a.isInstanceOf(McxGeometryType.Point)?Math.abs(a.getX()-this.x)<b&&Math.abs(a.getY()-this.y)<b:!1};
McxPoint.prototype.intersects=function(a){var b=!1;return b=a.isInstanceOf(McxGeometryType.Point)?this.equals(a):a.intersects(this)};
McxPoint.prototype.contains=function(a){var b=[];if(a.isInstanceOf(McxGeometryType.Point))b.push(a);else if(a.isInstanceOf(McxGeometryType.MultiPoint))b=b.concat(a.getPoints());else if(a.isInstanceOf(McxGeometryType.LineString)||a.isInstanceOf(McxGeometryType.LinearRing))b=b.concat(a.getPoints());else if(a.isInstanceOf(McxGeometryType.Polygon))b=b.concat(a.getShell().getPoints());else if(a.isInstanceOf(McxGeometryType.MultiPolygon)){var c=a.getPolygons();for(a=0;a<c.length;a++)b=b.concat(c[a].getShell().getPoints())}else if(a.isInstanceOf(McxGeometryType.MultiLineString))for(c=
a.getLines(),a=0;a<c.length;a++)b=b.concat(c[a].getPoints());for(a=0;a<b.length;a++)if(!this.equals(b[a]))return!1;return!0};McxPoint.prototype.isInstanceOf=function(a){return a==McxGeometryType.Point};
McxPoint.prototype.distanceTo=function(a){var b,c,d,e,f,g;if(null==a)return Number.MAX_VALUE;if(a.isInstanceOf(McxGeometryType.Point))c=this.x,d=this.y,e=a.getX(),f=a.getY(),b=Math.sqrt(Math.pow(c-e,2)+Math.pow(d-f,2)),this.coordinateSystem&&(b*=this.coordinateSystem.getDistancePerUnit()),g=b;else{if(a.isInstanceOf(McxGeometryType.LineSegment)){e=a;c=this.x;d=this.y;f=e.getStartPoint();var h=e.getEndPoint();e=f.getX();f=f.getY();var k=h.getX(),h=h.getY(),m=k-e,n=h-f,p=(m*(c-e)+n*(d-f))/(Math.pow(m,
2)+Math.pow(n,2));0>=p||(1<=p?(e=k,f=h):(e+=p*m,f+=p*n));b=Math.sqrt(Math.pow(e-c,2)+Math.pow(f-d,2));this.coordinateSystem&&(b*=this.coordinateSystem.getDistancePerUnit());return b}if(a.isInstanceOf(McxGeometryType.LineString)||a.isInstanceOf(McxGeometryType.LinearRing)){a=a.segmentize();g=Number.MAX_VALUE;for(b=0;b<a.length;b++)e=a[b],c=this.x,d=this.y,f=e.getStartPoint(),h=e.getEndPoint(),e=f.getX(),f=f.getY(),k=h.getX(),h=h.getY(),m=k-e,n=h-f,p=(m*(c-e)+n*(d-f))/(Math.pow(m,2)+Math.pow(n,2)),
0>=p||(1<=p?(e=k,f=h):(e+=p*m,f+=p*n)),c=Math.sqrt(Math.pow(e-c,2)+Math.pow(f-d,2)),c<g&&(g=c);this.coordinateSystem&&(g*=this.coordinateSystem.getDistancePerUnit())}else if(a.isInstanceOf(McxGeometryType.Polygon)){g=a.getShell();a=g.segmentize();g=Number.MAX_VALUE;for(b=0;b<a.length;b++){c=Number.MAX_VALUE;if(null==a[b].getPerpendicularFoot(this,!1))c=this.distanceTo(a[b].getStartPoint()),d=this.distanceTo(a[b].getEndPoint()),c=Math.min(c,d);else{e=a[b].getStartX();k=a[b].getEndX();f=a[b].getStartY();
h=a[b].getEndY();c=this.x-e;d=this.y-f;e=k-e;f=h-f;if(0==Math.sqrt(e*e+f*f))continue;c=Math.abs(c*f-e*d)/Math.sqrt(e*e+f*f)}c<g&&(g=c)}this.coordinateSystem&&(g*=this.coordinateSystem.getDistancePerUnit())}else{if(a.isInstanceOf(McxGeometryType.MultiPoint)){g=Number.MAX_VALUE;for(c=0;c<a.getPoints().length;c++)b=this.distanceTo(a.getPoints()[c]),b<g&&(g=b);this.coordinateSystem&&(g*=this.coordinateSystem.getDistancePerUnit());return g}if(a.isInstanceOf(McxGeometryType.MultiLineString)){g=Number.MAX_VALUE;
for(c=0;c<a.getLines().length;c++)b=this.distanceTo(a.getLines()[c]),b<g&&(g=b);this.coordinateSystem&&(g*=this.coordinateSystem.getDistancePerUnit());return g}if(a.isInstanceOf(McxGeometryType.MultiPolygon)){g=Number.MAX_VALUE;for(c=0;c<a.getPolygons().length;c++)b=this.distanceTo(a.getPolygons()[c]),b<g&&(g=b);this.coordinateSystem&&(g*=this.coordinateSystem.getDistancePerUnit());return g}return Number.MAX_VALUE}}return g};McxPoint.prototype.getSortedSegments=function(){};
McxPoint.prototype.getCoordinateSystem=function(){return this.coordinateSystem};McxPoint.prototype.setCoordinateSystem=function(a){this.coordinateSystem=a};McxPoint.prototype.transformTo=function(a){return(new McxCoordinateTransform).transformGeometry(this.coordinateSystem,a,this)};McxPoint.prototype.subtract=function(a){return new McxPoint(this.getX()-a.getX(),this.getY()-a.getY(),this.coordinateSystem)};McxPoint.prototype.clone=function(){return new McxPoint(this.x,this.y,this.coordinateSystem)};
McxPoint.prototype.buffer=function(a){null!=this.coordinateSystem&&(a/=this.coordinateSystem.getDistancePerUnit());a=McxPoint.createEllipse(this.x,this.y,a,a,this.coordinateSystem);return new McxPolygon(a,null,this.coordinateSystem)};McxPoint.prototype.translate=function(a,b){this.x+=a;this.y+=b;this.bounds=null};
McxPoint.prototype.toString=function(){var a="";null!=this.coordinateSystem&&(a=this.coordinateSystem.getCode(),a=a.toLowerCase().split("epsg:")[1]);a&&""!=a||(a="0");return McxGeometryType.Point+" "+a+" "+this.x+" "+this.y+" "};McxPoint.prototype.getArea=function(){};McxPoint.prototype.getCentroid=function(){return this.clone()};
McxPoint.prototype.rotate=function(a,b){this.translate(-a.getX(),-a.getY());var c=Math.sin(b),d=Math.cos(b),e=this.x,f=this.y;this.x=e*d-f*c;this.y=e*c+f*d;this.translate(a.getX(),a.getY())};McxPoint.prototype.scale=function(a,b){this.x=a.getX()+(this.x-a.getX())*b;this.y=a.getY()+(this.y-a.getY())*b};js.framework.base.McxGeospatial.Geometry.McxPolygon={};function McxPolygon(a,b,c){this.shell=a;this.holes=[];null!=b&&(this.holes=b);this.bounds=null;this.coordinateSystem=c}McxPolygon.prototype.getShell=function(){return this.shell};McxPolygon.prototype.setShell=function(a){this.shell=a};McxPolygon.prototype.getHoles=function(){return this.holes?this.holes:[]};McxPolygon.prototype.setHoles=function(a){this.holes=null==this.holes?[]:a};
McxPolygon.prototype.getArea=function(){var a=0,b=this.shell.getPoints();if(this.coordinateSystem&&1!=this.coordinateSystem.getDistancePerUnit()){var c=b.length;if(2<c){for(var d,e,f=0;f<c-1;f++)d=b[f],e=b[f+1],a+=(e.x-d.x)*Math.PI/180*(2+Math.sin(d.y*Math.PI/180)+Math.sin(e.y*Math.PI/180));a=40680631590769*a/2}}else{c=b.length;for(d=0;d<c;d++)a+=b[d].getX()*b[(d+1)%c].getY()-b[d].getY()*b[(d+1)%c].getX();a=Math.abs(a/2)}return Math.abs(a)};
McxPolygon.prototype.intersects=function(a){var b=!1,c,d;if(a.isInstanceOf(McxGeometryType.Point))b=this.containsPoint(a);else if(a.isInstanceOf(McxGeometryType.LineString)||a.isInstanceOf(McxGeometryType.LinearRing)){for(c=0;c<a.getPoints().length;c++)if(this.containsPoint(a.getPoints()[c]))return!0;var e=this.shell.segmentize(),f=a.segmentize();c=0;for(d=e.length;c<d;++c)for(a=0;a<f.length;a++)if(null!=e[c].intersectSegment(f[a],!1))return!0}else if(a.isInstanceOf(McxGeometryType.Polygon)){d=this.getShell().getPoints();
for(c=0;c<d.length;c++)if(a.containsPoint(d[c]))return!0;d=a.getShell().getPoints();for(c=0;c<d.length;c++)if(this.containsPoint(d[c]))return!0;d=this.getShell().segmentize();e=a.getShell().segmentize();for(c=0;c<d.length;c++)for(a=0;a<e.length;a++)if(d[c].intersectSegment(e[a],!1))return!0}else for(c=0,d=a.getComponents().length;c<d&&!(b=this.intersects(a.getComponents()[c]));++c);return"number"==typeof b?!0:b};
McxPolygon.prototype.containsPoint=function(a){var b=this.holes.length+1,c=!1;if(0<b&&(c=this.shell.containsPoint(a),"number"!=typeof c&&c&&1<b))for(var d=0;d<this.holes.length;++d)if(b=this.holes[d].containsPoint(a)){c=1===b?1:!1;break}return c};
McxPolygon.prototype.contains=function(a){var b=[];if(a.isInstanceOf(McxGeometryType.Point))b.push(a);else if(a.isInstanceOf(McxGeometryType.MultiPoint))b=b.concat(a.getPoints());else if(a.isInstanceOf(McxGeometryType.LineString)||a.isInstanceOf(McxGeometryType.LinearRing))b=b.concat(a.getPoints());else if(a.isInstanceOf(McxGeometryType.Polygon))b=b.concat(a.getShell().getPoints());else if(a.isInstanceOf(McxGeometryType.MultiPolygon)){var c=a.getPolygons();for(a=0;a<c.length;a++)b=b.concat(c[a].getShell().getPoints())}else if(a.isInstanceOf(McxGeometryType.MultiLineString))for(c=
a.getLines(),a=0;a<c.length;a++)b=b.concat(c[a].getPoints());for(a=0;a<b.length;a++)if(!this.containsPoint(b[a]))return!1;return!0};McxPolygon.prototype.equals=function(a){if(!a.isInstanceOf(McxGeometryType.Polygon)||!this.shell.equals(a.getShell())||this.holes.length!=a.getHoles().length)return!1;for(var b=0;b<this.holes.length;b++)if(!this.holes[b].equals(a.getHoles()[b]))return!1;return!0};
McxPolygon.prototype.calculateBounds=function(){var a=Number.MAX_VALUE,b=Number.MAX_VALUE,c=Number.MIN_VALUE,d=Number.MIN_VALUE,e=this.shell.getBounds();e.getLeft()<a&&(a=e.getLeft());e.getRight()>c&&(c=e.getRight());e.getBottom()<b&&(b=e.getBottom());e.getTop()>d&&(d=e.getTop());this.bounds=new McxBounds(a,b,c,d,this.coordinateSystem)};McxPolygon.prototype.getBounds=function(){null==this.bounds&&this.calculateBounds();return this.bounds};
McxPolygon.prototype.isClockWise=function(){var a,b,c,d=0,e,f=this.shell.getPoints(),g=f.length;for(a=0;a<g;a++)b=(a+1)%g,c=(a+2)%g,e=(f[b].getX()-f[a].getX())*(f[c].getY()-f[b].getY()),e-=(f[b].getY()-f[a].getY())*(f[c].getX()-f[b].getX()),0>e?d--:0<e&&d++;return 0<d?!1:!0};McxPolygon.prototype.isInstanceOf=function(a){return a==McxGeometryType.Polygon};
McxPolygon.prototype.distanceTo=function(a){if(a.isInstanceOf(McxGeometryType.Polygon)){a=a.getShell().segmentize();for(var b=this.shell.segmentize(),c=Number.MAX_VALUE,d=0;d<b.length;d++)for(var e=0;e<a.length;e++){var f=a[e].distanceTo(b[d]);c>f&&(c=f)}this.coordinateSystem&&(c*=this.coordinateSystem.getDistancePerUnit());return c}return a.distanceTo(this)};McxPolygon.prototype.getCoordinateSystem=function(){return this.coordinateSystem};
McxPolygon.prototype.setCoordinateSystem=function(a){this.coordinateSystem=a};McxPolygon.prototype.transformTo=function(a){return(new McxCoordinateTransform).transformGeometry(this.coordinateSystem,a,this)};McxPolygon.prototype.clone=function(){for(var a=[],b=this.shell.clone(),c=0;c<this.holes.length;c++)a.push(this.holes[c].clone());return new McxPolygon(b,a,this.coordinateSystem)};
McxPolygon.prototype.buffer=function(a){this.isClockWise()||(a*=-1);var b=this.shell.buffer(a).getShell();b.setCoordinateSystem(this.coordinateSystem);for(var c=[],d=0;d<this.holes.length;d++){var e=this.holes[d].buffer(a);e.setCoordinateSystem(this.coordinateSystem);c.push(e)}0>=c.length&&(c=null);return new McxPolygon(b,c,this.coordinateSystem)};McxPolygon.prototype.translate=function(a,b){this.shell.translate(a,b);for(var c=0;c<this.holes.length;c++)this.holes[c].translate(a,b);this.bounds=null};
McxPolygon.prototype.rotate=function(a,b){this.shell.rotate(a,b);for(var c=0;c<this.holes.length;c++)this.holes[c].rotate(a,b);this.bounds=null};McxPolygon.prototype.scale=function(a,b){this.shell.scale(a,b);for(var c=0;c<this.holes.length;c++)this.holes[c].scale(a,b);this.bounds=null};
McxPolygon.prototype.toString=function(){var a;a=""+(this.holes.length+1+" ");var b=this.shell.getPoints();a+=b.length+" ";for(var c=0;c<b.length;c++)a+=b[c].getX()+" "+b[c].getY()+" ";for(b=0;b<this.holes.length;b++){var d=this.holes[b];a+=d.getPoints().length+" ";for(c=0;c<d.getPoints().length;c++)a+=d.getPoints()[c].getX()+" "+d.getPoints()[c].getY()+" "}c="";null!=this.coordinateSystem&&(c=this.coordinateSystem.getCode(),c=c.toLowerCase().split("epsg:")[1]);c&&""!=c||(c="0");return McxGeometryType.Polygon+
" "+c+" "+a};McxPolygon.prototype.getSortedSegments=function(){};McxPolygon.prototype.getCentroid=function(){};js.framework.base.McxGeospatial.Geometry.McxSize={};function McxSize(a,b){this.width=a;this.height=b}McxSize.prototype.getWidth=function(){return this.width};McxSize.prototype.getHeight=function(){return this.height};McxSize.prototype.equals=function(a){var b=!1;null!=a&&(b=this.width==a.getWidth()&&this.height==a.getHeight()||isNaN(this.width)&&isNaN(this.height)&&isNaN(a.getWidth())&&isNaN(a.getHeight()));return b};
js.framework.base.McxStyle={};js.framework.base.McxStyle.McxAnchorPoint={};function McxAnchorPoint(){this.y=this.x=.5}McxAnchorPoint.prototype.getAnchorPointX=function(){return this.x};McxAnchorPoint.prototype.setAnchorPointX=function(a){this.x=a};McxAnchorPoint.prototype.getAnchorPointY=function(){return this.y};McxAnchorPoint.prototype.setAnchorPointY=function(a){this.y=a};McxAnchorPoint.prototype.clone=function(){var a=new McxAnchorPoint;a.setAnchorPointX(this.x);a.setAnchorPointY(this.y);return a};js.framework.base.McxStyle.McxCompositeSymbolizer={};function McxCompositeSymbolizer(){this.pointSymbolizer=new McxPointSymbolizer;this.lineSymbolizer=new McxLineSymbolizer;this.polygonSymbolizer=new McxPolygonSymbolizer;this.rasterSymbolizer=new McxRasterSymbolizer;this.opacity=1}McxCompositeSymbolizer.prototype.toSLD=function(){return McxSldWriter.writeCompositeSymbolizerToXml(this)};
McxCompositeSymbolizer.prototype.clone=function(){var a=new McxCompositeSymbolizer;a.setLineSymbolizer(this.lineSymbolizer.clone());a.setPointSymbolizer(this.pointSymbolizer.clone());a.setPolygonSymbolizer(this.polygonSymbolizer.clone());a.setRasterSymbolizer(this.rasterSymbolizer.clone());return a};McxCompositeSymbolizer.prototype.getPointSymbolizer=function(){return this.pointSymbolizer};McxCompositeSymbolizer.prototype.setPointSymbolizer=function(a){this.pointSymbolizer=a};
McxCompositeSymbolizer.prototype.getLineSymbolizer=function(){return this.lineSymbolizer};McxCompositeSymbolizer.prototype.setLineSymbolizer=function(a){this.lineSymbolizer=a};McxCompositeSymbolizer.prototype.getPolygonSymbolizer=function(){return this.polygonSymbolizer};McxCompositeSymbolizer.prototype.setPolygonSymbolizer=function(a){this.polygonSymbolizer=a};McxCompositeSymbolizer.prototype.getRasterSymbolizer=function(){return this.rasterSymbolizer};
McxCompositeSymbolizer.prototype.setRasterSymbolizer=function(a){this.rasterSymbolizer=a};McxCompositeSymbolizer.prototype.isInstanceOf=function(a){return"IMcxCompositeSymbolizer"==a||"McxCompositeSymbolizer"==a};McxCompositeSymbolizer.prototype.setOpacity=function(a){this.opacity=a};McxCompositeSymbolizer.prototype.getOpacity=function(){return this.opacity};js.framework.base.McxStyle.McxContentSymbol={};function McxContentSymbol(a){this.htmlElement=a;this.rotation=0;this.scale=1}McxContentSymbol.prototype.clone=function(){var a=new McxContentSymbol($(this.htmlElement).clone(!0)[0]);a.setRotation(this.rotation);a.setScale(this.scale);return a};McxContentSymbol.prototype.isInstanceOf=function(a){return"IMcxContentSymbol"==a||"McxContentSymbol"==a};McxContentSymbol.prototype.getContent=function(){return this.htmlElement};
McxContentSymbol.prototype.getRotation=function(){return this.rotation};McxContentSymbol.prototype.setRotation=function(a){this.rotation=a};McxContentSymbol.prototype.getScale=function(){return this.scale};McxContentSymbol.prototype.setScale=function(a){this.scale=a};js.framework.base.McxStyle.McxDisplacement={};function McxDisplacement(){this.displacementY=this.displacementX=0}McxDisplacement.prototype.getDisplacementX=function(){return this.displacementX};McxDisplacement.prototype.setDisplacementX=function(a){this.displacementX=a};McxDisplacement.prototype.getDisplacementY=function(){return this.displacementY};McxDisplacement.prototype.setDisplacementY=function(a){this.displacementY=a};
McxDisplacement.prototype.clone=function(){var a=new McxDisplacement;a.setDisplacementX(this.displacementX);a.setDisplacementY(this.displacementY);return a};js.framework.base.McxStyle.McxFill={};function McxFill(){this.color=McxColor.getSoftColor();this.opacity=1}McxFill.prototype.getColor=function(){return this.color};McxFill.prototype.setColor=function(a){this.color=a};McxFill.prototype.getOpacity=function(){return this.opacity};McxFill.prototype.setOpacity=function(a){this.opacity=a};McxFill.prototype.clone=function(){var a=new McxFill;a.setColor(this.color);a.setOpacity(this.opacity);return a};js.framework.base.McxStyle.McxFont={};function McxFont(){this.fontFamily="Calibri";this.fontSize=8;this.fontWeight=this.fontAlign="normal";this.fontUnit="pt"}McxFont.prototype.setFontFamily=function(a){this.fontFamily=a};McxFont.prototype.getFontFamily=function(){return this.fontFamily};McxFont.prototype.setFontSize=function(a){this.fontSize=a};McxFont.prototype.getFontSize=function(){return this.fontSize};McxFont.prototype.setFontAlign=function(a){this.fontAlign=a};
McxFont.prototype.getFontAlign=function(){return this.fontAlign};McxFont.prototype.setFontUnit=function(a){this.fontUnit=a};McxFont.prototype.getFontUnit=function(){return this.fontUnit};McxFont.prototype.setFontWeight=function(a){this.fontWeight=a};McxFont.prototype.getFontWeight=function(){return this.fontWeight};
McxFont.prototype.clone=function(){var a=new McxFont;a.setFontAlign(this.fontAlign);a.setFontFamily(this.fontFamily);a.setFontSize(this.fontSize);a.setFontUnit(this.fontUnit);a.setFontUnit(this.fontWeight);return a};McxFont.prototype.toString=function(){return this.fontAlign+" "+this.fontWeight+" "+this.fontSize+this.fontUnit+" "+this.fontFamily};js.framework.base.McxStyle.McxLinePlacement={};function McxLinePlacement(){this.gap=this.initialGap=this.perpendicularOffset=0;this.repeated=this.generalized=this.aligned=!1}McxLinePlacement.prototype.getPerpendicularOffset=function(){return this.perpendicularOffset};McxLinePlacement.prototype.setPerpendicularOffset=function(a){this.perpendicularOffset=a};McxLinePlacement.prototype.isAligned=function(){return this.aligned};McxLinePlacement.prototype.setAligned=function(a){this.aligned=a};
McxLinePlacement.prototype.isGeneralized=function(){return this.generalized};McxLinePlacement.prototype.setGeneralized=function(a){this.generalized=a};McxLinePlacement.prototype.isRepeated=function(){return this.repeated};McxLinePlacement.prototype.setRepeated=function(a){this.repeated=a};McxLinePlacement.prototype.getInitialGap=function(){return this.initialGap};McxLinePlacement.prototype.setInitialGap=function(a){this.initialGap=a};McxLinePlacement.prototype.getGap=function(){return this.gap};
McxLinePlacement.prototype.setGap=function(a){this.gap=a};js.framework.base.McxStyle.McxLineSymbolizer={};function McxLineSymbolizer(){this.stroke=new McxStroke;this.dashes=[]}McxLineSymbolizer.prototype.toSLD=function(){return McxSldWriter.writeLineSymbolizerToXml(this)};McxLineSymbolizer.prototype.clone=function(){var a=new McxLineSymbolizer;null!=this.stroke?a.setStroke(this.stroke.clone()):a.setStroke(null);return a};McxLineSymbolizer.prototype.getStroke=function(){return this.stroke};McxLineSymbolizer.prototype.setStroke=function(a){this.stroke=a};
McxLineSymbolizer.prototype.isInstanceOf=function(a){return"IMcxLineSymbolizer"==a||"McxLineSymbolizer"==a};js.framework.base.McxStyle.McxMark={};function McxMark(){this.stroke=new McxStroke;this.stroke.setColor("black");this.fill=new McxFill;this.fill.setColor("black");this.wellKnownName=McxWellKnownName.Square}McxMark.prototype.getStroke=function(){return this.stroke};McxMark.prototype.setStroke=function(a){this.stroke=a};McxMark.prototype.getFill=function(){return this.fill};McxMark.prototype.setFill=function(a){this.fill=a};McxMark.prototype.getWellKnownName=function(){return this.wellKnownName};
McxMark.prototype.isInstanceOf=function(a){return"IMcxMark"==a||"McxMark"==a};McxMark.prototype.clone=function(){var a=new McxMark;a.setFill(this.fill.clone());a.setStroke(this.stroke.clone());a.wellKnownName=this.wellKnownName;return a};js.framework.base.McxStyle.McxCircleMark={};function McxCircleMark(){mcx.base(this);this.base=this;this.base.wellKnownName=McxWellKnownName.Circle}mcx.inherits(McxCircleMark,McxMark);js.framework.base.McxStyle.McxCrossMark={};function McxCrossMark(){mcx.base(this);this.base=this;this.base.wellKnownName=McxWellKnownName.Cross}mcx.inherits(McxCrossMark,McxMark);js.framework.base.McxStyle.McxCustomMark={};function McxCustomMark(){mcx.base(this);this.base=this}mcx.inherits(McxCustomMark,McxMark);McxCustomMark.prototype.setWellKnownName=function(a){this.base.wellKnownName=a};js.framework.base.McxStyle.McxDiagCrossMark={};function McxDiagCrossMark(){mcx.base(this);this.base=this;this.base.wellKnownName=McxWellKnownName.DiagCross}mcx.inherits(McxDiagCrossMark,McxMark);js.framework.base.McxStyle.McxObjSymbolizer={};function McxObjSymbolizer(a){this.objFilePath=a;this.mtlFilePath="";this.scaleZ=this.scaleY=this.scaleX=1;this.rotateZ=this.rotateY=this.rotateX=0}McxObjSymbolizer.prototype.getObjFilePath=function(){return this.objFilePath};McxObjSymbolizer.prototype.getMtlFilePath=function(){return this.mtlFilePath};McxObjSymbolizer.prototype.setMtlFilePath=function(a){this.mtlFilePath=a};McxObjSymbolizer.prototype.setScaleX=function(a){this.scaleX=a};
McxObjSymbolizer.prototype.setScaleY=function(a){this.scaleY=a};McxObjSymbolizer.prototype.setScaleZ=function(a){this.scaleZ=a};McxObjSymbolizer.prototype.getScaleX=function(){return this.scaleX};McxObjSymbolizer.prototype.getScaleY=function(){return this.scaleY};McxObjSymbolizer.prototype.getScaleZ=function(){return this.scaleZ};McxObjSymbolizer.prototype.setRotateX=function(a){this.rotateX=a};McxObjSymbolizer.prototype.setRotateY=function(a){this.rotateY=a};
McxObjSymbolizer.prototype.setRotateZ=function(a){this.rotateZ=a};McxObjSymbolizer.prototype.getRotateX=function(){return this.rotateX};McxObjSymbolizer.prototype.getRotateY=function(){return this.rotateY};McxObjSymbolizer.prototype.getRotateZ=function(){return this.rotateZ};McxObjSymbolizer.prototype.toSLD=function(){return McxSldWriter.writeObjSymbolizerToXml(this)};
McxObjSymbolizer.prototype.clone=function(){var a=new McxObjSymbolizer(this.objFilePath);a.setMtlFilePath(this.mtlFilePath);a.setScaleX(this.scaleX);a.setScaleY(this.scaleY);a.setScaleZ(this.scaleZ);a.setRotateX(this.rotateX);a.setRotateY(this.rotateY);a.setRotateZ(this.rotateZ);return a};McxObjSymbolizer.prototype.isInstanceOf=function(a){return"McxObjSymbolizer"==a||"IMcxObjSymbolizer"==a};js.framework.base.McxStyle.McxPointPlacement={};function McxPointPlacement(){this.anchorPoint=new McxAnchorPoint;this.displacement=new McxDisplacement;this.rotation=0}McxPointPlacement.prototype.getAnchorPoint=function(){return this.anchorPoint};McxPointPlacement.prototype.setAnchorPoint=function(a){this.anchorPoint=a};McxPointPlacement.prototype.getDisplacement=function(){return this.displacement};McxPointPlacement.prototype.setDisplacement=function(a){this.displacement=a};
McxPointPlacement.prototype.getRotation=function(){return this.rotation};McxPointPlacement.prototype.setRotation=function(a){this.rotation=a};js.framework.base.McxStyle.McxPointSymbolizer={};function McxPointSymbolizer(){this.anchorPoint=new McxAnchorPoint;this.displacement=new McxDisplacement;this.initialGap=this.gap=0;this.opacity=1;this.rotation=0;this.size=3;this.symbols=[];var a=new McxCircleMark;this.symbols.push(a)}McxPointSymbolizer.prototype.toSLD=function(){return McxSldWriter.writePointSymbolizerToXml(this)};
McxPointSymbolizer.prototype.clone=function(){for(var a=new McxPointSymbolizer,b=[],c=0;c<this.symbols.length;c++)b.push(this.symbols[c].clone());a.setSize(this.getSize());a.setRotation(this.getRotation());a.setSymbols(b);return a};McxPointSymbolizer.prototype.setSymbols=function(a){this.symbols=a};McxPointSymbolizer.prototype.getSymbols=function(){return this.symbols};McxPointSymbolizer.prototype.getAnchorPoint=function(){return this.anchorPoint};
McxPointSymbolizer.prototype.setAnchorPoint=function(a){this.anchorPoint=a};McxPointSymbolizer.prototype.getDisplacement=function(){return this.displacement};McxPointSymbolizer.prototype.setDisplacement=function(a){this.displacement=a};McxPointSymbolizer.prototype.getGap=function(){return this.gap};McxPointSymbolizer.prototype.setGap=function(a){this.gap=a};McxPointSymbolizer.prototype.getInitialGap=function(){return this.initialGap};
McxPointSymbolizer.prototype.setInitialGap=function(a){this.initialGap=a};McxPointSymbolizer.prototype.getOpacity=function(){return this.opacity};McxPointSymbolizer.prototype.setOpacity=function(a){this.opacity=a};McxPointSymbolizer.prototype.getRotation=function(){return this.rotation};McxPointSymbolizer.prototype.setRotation=function(a){this.rotation=a};McxPointSymbolizer.prototype.getSize=function(){return this.size};McxPointSymbolizer.prototype.setSize=function(a){this.size=a};
McxPointSymbolizer.prototype.isInstanceOf=function(a){return"IMcxPointSymbolizer"==a||"McxPointSymbolizer"==a};js.framework.base.McxStyle.McxPolygonSymbolizer={};function McxPolygonSymbolizer(){this.fill=new McxFill;this.stroke=new McxStroke}McxPolygonSymbolizer.prototype.toSLD=function(){return McxSldWriter.writePolygonSymbolizerToXml(this)};McxPolygonSymbolizer.prototype.clone=function(){var a=new McxPolygonSymbolizer;null!=this.fill?a.setFill(this.fill.clone()):a.setFill(null);null!=this.stroke?a.setStroke(this.stroke.clone()):a.setStroke(null);return a};McxPolygonSymbolizer.prototype.getFill=function(){return this.fill};
McxPolygonSymbolizer.prototype.setFill=function(a){this.fill=a};McxPolygonSymbolizer.prototype.getStroke=function(){return this.stroke};McxPolygonSymbolizer.prototype.setStroke=function(a){this.stroke=a};McxPolygonSymbolizer.prototype.isInstanceOf=function(a){return"IMcxPolygonSymbolizer"==a||"McxPolygonSymbolizer"==a};js.framework.base.McxStyle.McxRasterSymbolizer={};function McxRasterSymbolizer(){this.opacity=1}McxRasterSymbolizer.prototype.toSLD=function(){return McxSldWriter.writeRasterSymbolizerToXml(this)};McxRasterSymbolizer.prototype.clone=function(){var a=new McxRasterSymbolizer;a.setOpacity(this.opacity);return a};McxRasterSymbolizer.prototype.getOpacity=function(){return this.opacity};McxRasterSymbolizer.prototype.setOpacity=function(a){this.opacity=a};
McxRasterSymbolizer.prototype.isInstanceOf=function(a){return"IMcxRasterSymbolizer"==a||"McxRasterSymbolizer"==a};js.framework.base.McxStyle.McxSldReader={};function McxSldReader(){}McxSldReader.readTextSymbolizer=function(a){var b=new McxTextSymbolizer;a=a.findSingleNode("TextSymbolizer");var c=a.findSingleNode("Fill");b.setFill(McxSldReader.readFill(c));c=a.findSingleNode("Font");b.setFont(McxSldReader.readFont(c));c=a.findSingleNode("AnchorPoint");b.setAnchorPoint(McxSldReader.readAnchorPoint(c));a=a.findSingleNode("Displacement");b.setDisplacement(McxSldReader.readDisplacement(a));return b};
McxSldReader.readRasterSymbolizer=function(a){var b=new McxRasterSymbolizer;a=a.getElementsByTagName("RasterSymbolizer")[0].getElementsByTagName("CssParameter");for(var c=0;c<a.length;c++){var d=a[c];"opacity"==d.parentNode.nodeName&&b.setOpacity(parseFloat(McxSldReader.getInnerHtml(d)))}return b};
McxSldReader.readSymbolizer=function(a){return"compositesymbolizer"==a.getNodeName()||a.hasChildNode("compositesymbolizer")?McxSldReader.readCompositeSymbolizer(a):"polygonsymbolizer"==a.getNodeName()||a.hasChildNode("polygonsymbolizer")?McxSldReader.readPolygonSymbolizer(a):"linesymbolizer"==a.getNodeName()||a.hasChildNode("linesymbolizer")?McxSldReader.readLineSymbolizer(a):"pointsymbolizer"==a.getNodeName()||a.hasChildNode("pointsymbolizer")?McxSldReader.readPointSymbolizer(a):"objsymbolizer"==
a.getNodeName()||a.hasChildNode("objsymbolizer")?McxSldReader.readObjSymbolizer(a):null};
McxSldReader.readCompositeSymbolizer=function(a){var b=new McxCompositeSymbolizer,c="compositesymbolizer"==a.getNodeName().toLowerCase()?a:a.findSingleNode("compositesymbolizer");c.isEmpty()&&(c=a);a=new McxPointSymbolizer;c.hasChildNode("pointsymbolizer")&&(a=McxSldReader.readPointSymbolizer(c.findSingleNode("pointsymbolizer")));var d=new McxLineSymbolizer;c.hasChildNode("linesymbolizer")&&(d=McxSldReader.readLineSymbolizer(c.findSingleNode("linesymbolizer")));var e=new McxPolygonSymbolizer;c.hasChildNode("polygonsymbolizer")&&
(e=McxSldReader.readPolygonSymbolizer(c.findSingleNode("polygonsymbolizer")));b.setPointSymbolizer(a);b.setLineSymbolizer(d);b.setPolygonSymbolizer(e);b.setOpacity(parseFloat(c.findSingleNode("Opacity").getValue()));return b};
McxSldReader.readPointSymbolizer=function(a){var b=new McxPointSymbolizer;a=a.findSingleNode("Graphic");var c=McxSldReader.readSymbols(a);b.setSymbols(c);var c=a.findSingleNode("Size"),d=a.findSingleNode("Rotation"),e=a.findSingleNode("Displacement");a=a.findSingleNode("AnchorPoint");c.isEmpty()||b.setSize(parseFloat(c.getValue()));d.isEmpty()||b.setRotation(parseFloat(d.getValue()));e.isEmpty()||(b.getDisplacement().setDisplacementX(parseFloat(e.findSingleNode("DisplacementX").getValue())),b.getDisplacement().setDisplacementY(parseFloat(e.findSingleNode("DisplacementY").getValue())));
a.isEmpty()||(b.getAnchorPoint().setAnchorPointX(parseFloat(a.findSingleNode("AnchorPointX").getValue())),b.getAnchorPoint().setAnchorPointY(parseFloat(a.findSingleNode("AnchorPointY").getValue())));return b};McxSldReader.readLineSymbolizer=function(a){a=a.findSingleNode("stroke");a=McxSldReader.readStroke(a);var b=new McxLineSymbolizer;b.setStroke(a);return b};
McxSldReader.readPolygonSymbolizer=function(a){var b=a.findSingleNode("stroke"),b=McxSldReader.readStroke(b);a=a.findSingleNode("fill");a=McxSldReader.readFill(a);var c=new McxPolygonSymbolizer;c.setFill(a);c.setStroke(b);return c};McxSldReader.readSymbols=function(a){var b=[];a=a.findNodes("Symbols");for(var c=0;c<a.length;c++){for(var d=a[c],e=d.findNodes("Mark"),f=0;f<e.length;f++)b.push(McxSldReader.readMark(e[f]));d=d.findNodes("ContentSymbol");for(f=0;f<d.length;f++)b.push(McxSldReader.readContentSymbol(d[f]))}return b};
McxSldReader.readContentSymbol=function(a){a=a.findSingleNode("Content").getValue();a=McxSldReader.stringToHtml(a);return new McxContentSymbol(a)};
McxSldReader.readObjSymbolizer=function(a){var b=a.findSingleNode("ObjFile").getValue(),c=a.findSingleNode("MtlFile").getValue(),d=a.findSingleNode("Scale").getValue(),e=a.findSingleNode("Rotate").getValue(),f=d.split(" "),d=parseFloat(f[0]);a=parseFloat(f[1]);var f=parseFloat(f[2]),g=e.split(" "),e=parseFloat(g[0]),h=parseFloat(g[1]),g=parseFloat(g[2]),b=new McxObjSymbolizer(b);b.setMtlFilePath(c);b.setRotateX(e);b.setRotateY(h);b.setRotateZ(g);b.setScaleX(d);b.setScaleY(a);b.setScaleZ(f);return b};
McxSldReader.readMark=function(a){var b=a.findSingleNode("WellKnownName").getValue(),c=new McxMark;b==McxWellKnownName.Circle?c=new McxCircleMark:b==McxWellKnownName.Cross?c=new McxCrossMark:b==McxWellKnownName.DiagCross?c=new McxDiagCrossMark:b==McxWellKnownName.Square?c=new McxSquareMark:b==McxWellKnownName.Star?c=new McxStarMark:b==McxWellKnownName.Triangle&&(c=new McxTriangleMark);b=a.findSingleNode("fill");b=McxSldReader.readFill(b);a=a.findSingleNode("stroke");a=McxSldReader.readStroke(a);c.setFill(b);
c.setStroke(a);return c};
McxSldReader.readStroke=function(a){if(a.isEmpty())return null;var b=new McxStroke;a=a.findNodes("cssparameter");for(var c=0;c<a.length;c++){var d=a[c];if(!d.isEmpty()){var e=d.getAttributeValue("name");"stroke"==e?b.setColor(d.getValue()):"stroke-width"==e?b.setWidth(parseFloat(d.getValue())):"stroke-opacity"==e?b.setOpacity(parseFloat(d.getValue())):"stroke-dasharray"==e?b.setDashPattern(McxSldReader.parseDashPatternString(d.getValue())):"stroke-dashoffset"==e?b.setDashOffset(parseFloat(d.getValue())):"stroke-startcap"==
e?b.setStartCap(McxSldReader.parseLineCapString(d.getValue())):"stroke-endcap"==e?b.setEndCap(McxSldReader.parseLineCapString(d.getValue())):"stroke-linecap"==e?(b.setStartCap(McxSldReader.parseLineCapString(d.getValue())),b.setEndCap(McxSldReader.parseLineCapString(d.getValue()))):"stroke-linejoin"==e&&b.setLineJoin(McxSldReader.parseLineJoinString(d.getValue()))}}return b};
McxSldReader.readFill=function(a){if(a.isEmpty())return null;var b=new McxFill;a=a.findNodes("cssparameter");for(var c=0;c<a.length;c++){var d=a[c];d.isEmpty()||("fill"==d.getAttributeValue("name")?b.setColor(d.getValue()):"fill-opacity"==d.getAttributeValue("name")&&b.setOpacity(parseFloat(d.getValue())))}return b};
McxSldReader.readDisplacement=function(a){var b=new McxDisplacement;if(a.isEmpty())return b;var c=a.findSingleNode("displacementx");a=a.findSingleNode("displacementy");c=c&&!c.isEmpty()?parseFloat(c.getValue()):0;a=a&&!a.isEmpty()?parseFloat(a.getValue()):0;b.setDisplacementX(isNaN(c)?0:c);b.setDisplacementY(isNaN(a)?0:a);return b};
McxSldReader.readAnchorPoint=function(a){var b=new McxAnchorPoint;if(a.isEmpty())return b;var c=a.findSingleNode("anchorpointx");a=a.findSingleNode("anchorpointy");c=c&&!c.isEmpty()?parseFloat(c.getValue()):.5;a=a&&!a.isEmpty()?parseFloat(a.getValue()):.5;b.setAnchorPointX(isNaN(c)?.5:c);b.setAnchorPointY(isNaN(a)?.5:a);return b};
McxSldReader.readFont=function(a){var b=new McxFont;a=a.findNodes("cssparameter");for(var c=0;c<a.length;c++){var d=a[c];"font-family"==d.getAttributeValue("name")?b.setFontFamily(d.getValue()):"font-size"==d.getAttributeValue("name")?b.setFontSize(parseFloat(d.getValue())):"font-weight"==d.getAttributeValue("name")?b.setFontWeight(d.getValue()):"font-align"==d.getAttributeValue("name")?b.setFontAlign(d.getValue()):"font-unit"==d.getAttributeValue("name")&&b.setFontUnit(d.getValue())}return b};
McxSldReader.parseDashPatternString=function(a){var b=[];a=a.split(" ");for(var c=0;c<a.length;c++)b.push(parseFloat(a[c]));return b};McxSldReader.parseLineCapString=function(a){switch(a){case "butt":return McxLineCap.Butt;case "round":return McxLineCap.Round;case "square":return McxLineCap.Square;default:return McxLineCap.Butt}};
McxSldReader.parseLineJoinString=function(a){switch(a){case "mitre":return McxLineJoin.Miter;case "round":return McxLineJoin.Round;case "bevel":return McxLineJoin.Bevel;default:return McxLineJoin.Miter}};McxSldReader.getInnerHtml=function(a){var b=a.innerHTML;b||(b=a.textContent);return b};McxSldReader.stringToHtml=function(a){var b=document.createElement("DIV");b.innerHTML=a;return b.firstChild};js.framework.base.McxStyle.McxSldWriter={};function McxSldWriter(){}
McxSldWriter.writeFont=function(a,b){var c=McxXMLReader.createXmlNode("Font");McxSldWriter.writeCssParameter("font-family",a.getFontFamily(),c);McxSldWriter.writeCssParameter("font-size",a.getFontSize().toString(),c);McxSldWriter.writeCssParameter("font-weight",a.getFontWeight().toString(),c);McxSldWriter.writeCssParameter("font-align",a.getFontAlign().toString(),c);McxSldWriter.writeCssParameter("font-unit",a.getFontUnit().toString(),c);b.appendNode(c)};
McxSldWriter.writeFill=function(a,b){if(0!=mcx.isDefAndNotNull(a)){var c=McxXMLReader.createXmlNode("Fill");McxSldWriter.writeCssParameter("fill",McxColor.colorStringToHex(a.getColor()),c);McxSldWriter.writeCssParameter("fill-opacity",a.getOpacity().toString(),c);b.appendNode(c)}};
McxSldWriter.writeDisplacement=function(a,b){if(0!=mcx.isDefAndNotNull(a)){var c=McxXMLReader.createXmlNode("Displacement");c.appendTextNode("DisplacementX",a.getDisplacementX().toString());c.appendTextNode("DisplacementY",a.getDisplacementY().toString());b.appendNode(c)}};
McxSldWriter.writeAnchorPoint=function(a,b){if(0!=mcx.isDefAndNotNull(a)){var c=McxXMLReader.createXmlNode("AnchorPoint");c.appendTextNode("AnchorPointX",a.getAnchorPointX().toString());c.appendTextNode("AnchorPointY",a.getAnchorPointY().toString());b.appendNode(c)}};
McxSldWriter.writeStroke=function(a,b){if(0!=mcx.isDefAndNotNull(a)){var c=McxXMLReader.createXmlNode("Stroke");McxSldWriter.writeCssParameter("stroke",McxColor.colorStringToHex(a.getColor()),c);McxSldWriter.writeCssParameter("stroke-opacity",a.getOpacity().toString(),c);McxSldWriter.writeCssParameter("stroke-width",a.getWidth().toString(),c);McxSldWriter.writeCssParameter("stroke-dashoffset",a.getDashOffset().toString(),c);McxSldWriter.writeCssParameter("stroke-startcap",a.getStartCap().toString(),
c);McxSldWriter.writeCssParameter("stroke-endcap",a.getEndCap().toString(),c);McxSldWriter.writeCssParameter("stroke-linecap",a.getEndCap().toString(),c);McxSldWriter.writeCssParameter("stroke-linejoin",a.getLineJoin().toString(),c);mcx.isDefAndNotNull(a.getDashPattern())&&McxSldWriter.writeCssParameter("stroke-dasharray",a.getDashPattern().join(" "),c);b.appendNode(c)}};
McxSldWriter.writeCssParameter=function(a,b,c){var d=McxXMLReader.createXmlNode("CssParameter");d.addAttributeValue("name",a);d.setValue(b);c.appendNode(d)};McxSldWriter.writeMark=function(a,b){var c=McxXMLReader.createXmlNode("Mark");c.appendTextNode("WellKnownName",a.getWellKnownName().toString());mcx.isDefAndNotNull(a.getFill())&&McxSldWriter.writeFill(a.getFill(),c);mcx.isDefAndNotNull(a.getStroke())&&McxSldWriter.writeStroke(a.getStroke(),c);b.appendNode(c)};
McxSldWriter.writeTextSymbolizerToXml=function(a){var b=McxXMLReader.createXmlNode("TextSymbolizer"),c=McxXMLReader.createXmlNode("LabelPlacement"),d=McxXMLReader.createXmlNode("PointPlacement");c.appendNode(d);b.appendNode(c);McxSldWriter.writeFont(a.getFont(),b);McxSldWriter.writeFill(a.getFill(),b);McxSldWriter.writeDisplacement(a.getDisplacement(),d);McxSldWriter.writeAnchorPoint(a.getAnchorPoint(),d);return b};
McxSldWriter.writeRasterSymbolizerToXml=function(a){var b=McxXMLReader.createXmlNode("RasterSymbolizer");1!=a.getOpacity()&&b.appendTextNode("Opacity",a.getOpacity().toString());return b};
McxSldWriter.writeCompositeSymbolizerToXml=function(a){var b=McxXMLReader.createXmlNode("CompositeSymbolizer"),c=a.getPointSymbolizer(),d=a.getLineSymbolizer(),e=a.getPolygonSymbolizer(),f=a.getRasterSymbolizer();mcx.isDefAndNotNull(c)&&b.appendNode(McxSldWriter.writePointSymbolizerToXml(c));mcx.isDefAndNotNull(d)&&b.appendNode(McxSldWriter.writeLineSymbolizerToXml(d));mcx.isDefAndNotNull(e)&&b.appendNode(McxSldWriter.writePolygonSymbolizerToXml(e));mcx.isDefAndNotNull(f)&&b.appendNode(McxSldWriter.writeRasterSymbolizerToXml(f));
b.appendTextNode("Opacity",a.getOpacity().toString());return b};
McxSldWriter.writePointSymbolizerToXml=function(a){for(var b=McxXMLReader.createXmlNode("PointSymbolizer"),c=McxXMLReader.createXmlNode("Graphic"),d=McxXMLReader.createXmlNode("Symbols"),e=McxXMLReader.createXmlNode("Size"),f=McxXMLReader.createXmlNode("Rotation"),g=a.getSymbols(),h=0;h<g.length;h++){var k=g[h];k.isInstanceOf("IMcxMark")||k.isInstanceOf("IMcxTextMark")?McxSldWriter.writeMark(k,d):k.isInstanceOf("IMcxContentSymbol")&&McxSldWriter.writeContentSymbol(k,d)}e.setValue(a.getSize().toString());
f.setValue(a.getRotation().toString());c.appendNode(d);c.appendNode(e);c.appendNode(f);McxSldWriter.writeDisplacement(a.getDisplacement(),c);McxSldWriter.writeAnchorPoint(a.getAnchorPoint(),c);b.appendNode(c);return b};McxSldWriter.writeLineSymbolizerToXml=function(a){var b=McxXMLReader.createXmlNode("LineSymbolizer");McxSldWriter.writeStroke(a.getStroke(),b);return b};
McxSldWriter.writePolygonSymbolizerToXml=function(a){var b=McxXMLReader.createXmlNode("PolygonSymbolizer");McxSldWriter.writeStroke(a.getStroke(),b);McxSldWriter.writeFill(a.getFill(),b);return b};McxSldWriter.writeContentSymbol=function(a,b){var c=McxXMLReader.createXmlNode("ContentSymbol");c.appendTextNode("Content",McxSldWriter.htmlToString(a.getContent()));b.appendNode(c)};
McxSldWriter.writeObjSymbolizerToXml=function(a){var b=McxXMLReader.createXmlNode("objsymbolizer");b.appendTextNode("ObjFile",a.getObjFilePath());b.appendTextNode("MtlFile",a.getObjFilePath());b.appendTextNode("Scale",a.getScaleX().toString()+" "+a.getScaleY().toString()+" "+a.getScaleZ().toString());b.appendTextNode("Rotate",a.getRotateX().toString()+" "+a.getRotateY().toString()+" "+a.getRotateZ().toString());return b};McxSldWriter.htmlToString=function(a){var b=a.innerHTML;b||(b=a.outerHTML);return b};js.framework.base.McxStyle.McxSquareMark={};function McxSquareMark(){mcx.base(this);this.base=this;this.base.wellKnownName=McxWellKnownName.Square}mcx.inherits(McxSquareMark,McxMark);js.framework.base.McxStyle.McxStarMark={};function McxStarMark(){mcx.base(this);this.base=this;this.base.wellKnownName=McxWellKnownName.Star}mcx.inherits(McxStarMark,McxMark);js.framework.base.McxStyle.McxStroke={};function McxStroke(){this.color="black";this.opacity=1;this.lineJoin=McxLineJoin.Round;this.endCap=this.startCap=McxLineCap.Butt;this.dashOffset=0;this.dashPattern=null;this.width=1}McxStroke.prototype.getColor=function(){return this.color};McxStroke.prototype.setColor=function(a){this.color=a};McxStroke.prototype.getOpacity=function(){return this.opacity};McxStroke.prototype.setOpacity=function(a){this.opacity=a};McxStroke.prototype.getWidth=function(){return this.width};
McxStroke.prototype.setWidth=function(a){this.width=a};McxStroke.prototype.getDashPattern=function(){return this.dashPattern};McxStroke.prototype.setDashPattern=function(a){this.dashPattern=a};McxStroke.prototype.getDashOffset=function(){return this.dashOffset};McxStroke.prototype.setDashOffset=function(a){this.dashOffset=a};McxStroke.prototype.getStartCap=function(){return this.startCap};McxStroke.prototype.setStartCap=function(a){this.startCap=a};McxStroke.prototype.getEndCap=function(){return this.endCap};
McxStroke.prototype.setEndCap=function(a){this.endCap=a};McxStroke.prototype.getLineJoin=function(){return this.lineJoin};McxStroke.prototype.setLineJoin=function(a){this.lineJoin=a};McxStroke.prototype.clone=function(){var a=new McxStroke;a.setColor(this.color);a.setDashOffset(this.dashOffset);a.setDashPattern(this.dashPattern);a.setEndCap(this.endCap);a.setLineJoin(this.lineJoin);a.setOpacity(this.opacity);a.setStartCap(this.startCap);a.setWidth(this.width);return a};js.framework.base.McxStyle.McxStyleFactory={};function McxStyleFactory(){}McxStyleFactory.prototype.createStroke=function(){return new McxStroke};McxStyleFactory.prototype.createStrokeFromColor=function(a){var b=new McxStroke;b.setColor(a);return b};McxStyleFactory.prototype.createStrokeWithColorAndWidth=function(a,b){var c=new McxStroke;c.setColor(a);c.setWidth(b);return c};McxStyleFactory.prototype.createFill=function(){return new McxFill};
McxStyleFactory.prototype.createFillFromColor=function(a){var b=new McxFill;b.setColor(a);return b};McxStyleFactory.prototype.createPointSymbolizer=function(){return new McxPointSymbolizer};McxStyleFactory.prototype.createLineSymbolizer=function(){return new McxLineSymbolizer};McxStyleFactory.prototype.createLineSymbolizerWithColor=function(a){var b=new McxLineSymbolizer,c=new McxStroke;c.setColor(a);b.setStroke(c);return b};
McxStyleFactory.prototype.createLineSymbolizerWithColorAndWidth=function(a,b){var c=new McxLineSymbolizer,d=new McxStroke;d.setColor(a);d.setWidth(b);c.setStroke(d);return c};McxStyleFactory.prototype.createPolygonSymbolizer=function(){return new McxPolygonSymbolizer};McxStyleFactory.prototype.createPolygonSymbolizerWithStrokeAndFill=function(a,b){var c=new McxPolygonSymbolizer;c.setFill(b);c.setStroke(a);return c};McxStyleFactory.prototype.createTextSymbolizer=function(){return new McxTextSymbolizer};
McxStyleFactory.prototype.createCompositeSymbolizer=function(){return new McxCompositeSymbolizer};McxStyleFactory.prototype.createCompositeSymbolizerWithSymbolizers=function(a,b,c){var d=new McxCompositeSymbolizer;d.setPointSymbolizer(a);d.setLineSymbolizer(b);d.setPolygonSymbolizer(c);return d};McxStyleFactory.prototype.createRasterSymbolizer=function(){return new McxRasterSymbolizer};
McxStyleFactory.prototype.createSymbolizerFromSld=function(a){a=McxXMLReader.createXmlDocument(a);if(a.isEmpty())return null;switch(a.getNodeName()){case "pointsymbolizer":return McxSldReader.readPointSymbolizer(a);case "linesymbolizer":return McxSldReader.readLineSymbolizer(a);case "polygonsymbolizer":return McxSldReader.readPolygonSymbolizer(a);case "textsymbolizer":return McxSldReader.readTextSymbolizer(a);case "compositesymbolizer":return McxSldReader.readCompositeSymbolizer(a)}return null};
McxStyleFactory.prototype.getDefaultPointSymbolizer=function(){return new McxPointSymbolizer};McxStyleFactory.prototype.getDefaultLineSymbolizer=function(){var a=new McxLineSymbolizer,b=new McxStroke;b.setColor("black");a.setStroke(b);return a};McxStyleFactory.prototype.getDefaultPolygonSymbolizer=function(){var a=new McxPolygonSymbolizer,b=new McxFill;b.setColor("teal");var c=new McxStroke;c.setColor("darkslateblue");a.setFill(b);a.setStroke(c);return a};js.framework.base.McxStyle.McxTextMark={};function McxTextMark(){this.fill=new McxFill;this.fill.setColor("black");this.stroke=new McxStroke;this.fill.setColor("black");this.font=new McxFont;this.symbol=""}McxTextMark.prototype.getStroke=function(){return this.stroke};McxTextMark.prototype.setStroke=function(a){this.stroke=a};McxTextMark.prototype.getFill=function(){return this.fill};McxTextMark.prototype.setFill=function(a){this.fill=a};McxTextMark.prototype.getFont=function(){return this.font};
McxTextMark.prototype.setFont=function(a){this.font=a};McxTextMark.prototype.getSymbol=function(){return this.symbol};McxTextMark.prototype.setSymbol=function(a){this.symbol=a};McxTextMark.prototype.isInstanceOf=function(a){return"IMcxTextMark"==a||"McxTextMark"==a};McxTextMark.prototype.clone=function(){return new McxTextMark};js.framework.base.McxStyle.McxTextSymbolizer={};function McxTextSymbolizer(){this.fill=new McxFill;this.fill.setColor("black");this.font=new McxFont;this.anchorPoint=new McxAnchorPoint;this.displacement=new McxDisplacement;this.rotation=0}McxTextSymbolizer.prototype.toSLD=function(){return McxSldWriter.writeTextSymbolizerToXml(this)};
McxTextSymbolizer.prototype.clone=function(){var a=new McxTextSymbolizer;a.setFill(this.fill.clone());a.setFont(this.font.clone());a.setAnchorPoint(this.anchorPoint.clone());a.setDisplacement(this.displacement.clone());a.setRotation(this.rotation);return a};McxTextSymbolizer.prototype.getFill=function(){return this.fill};McxTextSymbolizer.prototype.setFill=function(a){this.fill=a};McxTextSymbolizer.prototype.getFont=function(){return this.font};
McxTextSymbolizer.prototype.setFont=function(a){this.font=a};McxTextSymbolizer.prototype.setAnchorPoint=function(a){this.anchorPoint=a};McxTextSymbolizer.prototype.getAnchorPoint=function(){return this.anchorPoint};McxTextSymbolizer.prototype.setDisplacement=function(a){this.displacement=a};McxTextSymbolizer.prototype.getDisplacement=function(){return this.displacement};McxTextSymbolizer.prototype.getRotation=function(){return this.rotation};
McxTextSymbolizer.prototype.setRotation=function(a){this.rotation=a};McxTextSymbolizer.prototype.isInstanceOf=function(a){return"IMcxTextSymbolizer"==a||"McxTextSymbolizer"==a};js.framework.base.McxStyle.McxTriangleMark={};function McxTriangleMark(){mcx.base(this);this.base=this;this.base.wellKnownName=McxWellKnownName.Triangle}mcx.inherits(McxTriangleMark,McxMark);
js.framework.base.McxCommon={};js.framework.base.McxCommon.Data={};js.framework.base.McxCommon.Data.IMcxSettingsManager={};function IMcxSettingsManager(){}IMcxSettingsManager.prototype.read=function(a,b){};IMcxSettingsManager.prototype.write=function(a,b,c){};IMcxSettingsManager.prototype.delete=function(a,b){};IMcxSettingsManager.prototype.isAvailable=function(){};IMcxSettingsManager.prototype.setUri=function(a){};js.framework.base.McxCommon.Data.McxAbstractDataSource={};function McxAbstractDataSource(a,b){this.source=b;this.driver=a;this.connectionString=b;this.credentials="";this.layerArray=[];this.dataSourceName="";this.initialize()}McxAbstractDataSource.prototype.initialize=function(){var a=this.connectionString.split("@");null!=a[2]&&(this.credentials=a[2]);this.dataSourceName=a[3]};McxAbstractDataSource.prototype.getName=function(){return this.dataSourceName};
McxAbstractDataSource.prototype.getSource=function(){return this.connectionString};McxAbstractDataSource.prototype.getDriver=function(){return this.driver};McxAbstractDataSource.prototype.getLayer=function(a,b,c){};McxAbstractDataSource.prototype.createLayer=function(a,b,c,d){};McxAbstractDataSource.prototype.deleteLayer=function(a){};McxAbstractDataSource.prototype.copyLayer=function(a,b,c){};McxAbstractDataSource.prototype.fullTextSearch=function(a,b,c,d){};
McxAbstractDataSource.prototype.createDomain=function(a){};McxAbstractDataSource.prototype.deleteDomain=function(a){};McxAbstractDataSource.prototype.alterDomain=function(a,b){};McxAbstractDataSource.prototype.createCodedValue=function(a,b){};McxAbstractDataSource.prototype.deleteCodedValue=function(a,b){};McxAbstractDataSource.prototype.alterCodedValue=function(a,b,c){};McxAbstractDataSource.prototype.getDomain=function(a,b){};McxAbstractDataSource.prototype.getDomains=function(a){};
McxAbstractDataSource.prototype.createRelation=function(a){};McxAbstractDataSource.prototype.deleteRelation=function(a){};McxAbstractDataSource.prototype.alterRelation=function(a,b){};McxAbstractDataSource.prototype.getRelation=function(a,b,c,d){};McxAbstractDataSource.prototype.getRelations=function(a,b,c){};McxAbstractDataSource.prototype.getAllRelations=function(a,b){};McxAbstractDataSource.prototype.testCapability=function(a){mcx.abstractMethod();return!1};
McxAbstractDataSource.prototype.createServiceUri=function(a){a=a.split("@");a=a[a.length-1];return a+"/Rest/Json/"};McxAbstractDataSource.prototype.add=function(a){this.layerArray.push(a)};js.framework.base.McxCommon.Data.McxAbstractLayer={};
function McxAbstractLayer(a){this.schema=null;this.dataSource=a;this.classId=McxGuid.createGuid();this.uniqueId=McxGuid.createGuid();this.layerName="layer";this.serviceLayerName="serviceLayer";this.description=this.alias=this.fullName="";this.isHasAttributes=this.editable=!0;this.fieldKey="FEATUREID";this.fieldGuid="GLOBALID";this.fieldLabelSymbolizer=this.fieldGlobalID=this.fieldSymbolizer="";this.fieldGeometry="GEOMETRY";this.fieldGeometryArea="GEOMETRY_AREA";this.fieldGeometryLength="GEOMETRY_LENGTH";
this.fieldGeometryX="GEOMETRY_X";this.fieldGeometryY="GEOMETRY_Y";this.fieldGeometryZ="GEOMETRY_Z";this.hasParameter=!1;this.geometryType=McxGeometryType.Unknown;this.coordinateSystem=this.envelope=null;this.filterCollection=new McxFilterCollection;this.visible=!0;this.onVisibilityChangeHandler=new McxEventHandler;this.onOpacityChangeHandler=new McxEventHandler;this.maxScale=this.minScale=Number.NaN;this.singleTile=!1;this.maxLabelScale=this.minLabelScale=Number.NaN;this.scaledLabels=!1;this.lineScale=
!0;this.symbolizer=new McxCompositeSymbolizer;this.cacheable=!1;this.updateSupported=this.deleteSupported=this.insertSupported=!0;this.featureInsertedEventHandler=new McxEventHandler;this.featureInsertingEventHandler=new McxEventHandler;this.featureUpdatedEventHandler=new McxEventHandler;this.featureUpdatingEventHandler=new McxEventHandler;this.featureDeletedEventHandler=new McxEventHandler;this.featureDeletingEventHandler=new McxEventHandler;this.opacity=1;this.groupName="";this.isGroup=!1;this.dataSourceName=
"";this.featureReader=null;this.selectable=!1;this.selectionColor="blue";this.selectionOpacity=.2;this.selectedFeatures={};this.selectionColorChangedEventHandler=new McxEventHandler;this.addSelectionEventHandler=new McxEventHandler;this.removeSelectionEventHandler=new McxEventHandler;this.selectableChangedEventHandler=new McxEventHandler;this.painterMode=McxPainterMode.ByLayer;this.showLabels=!1;this.labelFormat="";this.labelSymbolizer=new McxTextSymbolizer;this.labelVisibilityChangedEventHandler=
new McxEventHandler;this.labelScalabilityChangedEventHandler=new McxEventHandler;this.labelVisibleRangeChangedEventHandler=new McxEventHandler;this.labelFormatChangedEventHandler=new McxEventHandler;this.labelSymbolizerChangedEventHandler=new McxEventHandler;this.snappable=!0;this.snappableChangedEventHandler=new McxEventHandler;this.fieldSubtype="";this.subtypes=new McxSubtypeCollection(this);this.tag=null;this.subtypeFieldChangedEventHandler=new McxEventHandler;this.subtypeType=new McxDefinedSubtypeObject;
this._order=0;this.layerOrderChangeEventHandler=new McxEventHandler}McxAbstractLayer.prototype.getClassId=function(){return this.classId};McxAbstractLayer.prototype.getName=function(){return this.layerName};McxAbstractLayer.prototype.getFullName=function(){return this.fullName};McxAbstractLayer.prototype.getAlias=function(){return""==this.alias?this.getName():this.alias};McxAbstractLayer.prototype.setAlias=function(a){this.alias=a};McxAbstractLayer.prototype.getInfo=function(a){return this.description};
McxAbstractLayer.prototype.getDataSource=function(){return this.dataSource};McxAbstractLayer.prototype.getKeyField=function(){return this.fieldKey};McxAbstractLayer.prototype.getGuidField=function(){return this.fieldGuid};McxAbstractLayer.prototype.getSymbolizerField=function(){return this.fieldSymbolizer};McxAbstractLayer.prototype.getLabelSymbolizerField=function(){return this.fieldLabelSymbolizer};McxAbstractLayer.prototype.labelOf=mcx.abstractMethod;
McxAbstractLayer.prototype.getGeometryType=function(){return this.geometryType};McxAbstractLayer.prototype.getFeatureCount=function(a){return new McxGetFeatureCountResult};McxAbstractLayer.prototype.getEnvelope=function(a){var b=new McxGetEnvelopeResult;b.setArgs(a.getArgs());var c=null;null!=this.envelope&&(c=this.envelope.transformTo(this.coordinateSystem));b.setEnvelope(c);a.getAsync()&&a.getSuccess().call(a.getScope(),b);return b};McxAbstractLayer.prototype.getCoordinateSystem=function(){return this.coordinateSystem};
McxAbstractLayer.prototype.setCoordinateSystem=function(a){this.coordinateSystem=a;var b=this.getName().split("@");5==b.length&&null!=a&&(b[4]=a.getCode().split(":")[1],this.layerName=b.join("@"))};McxAbstractLayer.prototype.findFeature=function(a){return null};McxAbstractLayer.prototype.createEdit=function(){return null};McxAbstractLayer.prototype.spatialOperation=function(a,b,c,d){a=new McxResult;a.setArgs(c.getArgs());c.getAsync()&&c.getSuccess().call(c.getScope(),a);return a};
McxAbstractLayer.prototype.getVisible=function(){return this.visible};McxAbstractLayer.prototype.setVisible=function(a){this.visible=a;this.onVisibilityChangeHandler.dispatchOnSuccess(this,null)};McxAbstractLayer.prototype.getOrder=function(){return this._order};McxAbstractLayer.prototype.setOrder=function(a){this._order=a;this.getOrderChangeEventHandler().dispatchOnSuccess(this,null)};McxAbstractLayer.prototype.getOrderChangeEventHandler=function(){return this.layerOrderChangeEventHandler};
McxAbstractLayer.prototype.getVisibilityChangeHandler=function(){return this.onVisibilityChangeHandler};McxAbstractLayer.prototype.getOpacityChangeHandler=function(){return this.onOpacityChangeHandler};McxAbstractLayer.prototype.setMinScale=function(a){this.minScale=a};McxAbstractLayer.prototype.getMinScale=function(){return this.minScale};McxAbstractLayer.prototype.setMaxScale=function(a){this.maxScale=a};McxAbstractLayer.prototype.getMaxScale=function(){return this.maxScale};
McxAbstractLayer.prototype.setScaledLines=function(a){this.lineScale=a};McxAbstractLayer.prototype.getScaledLines=function(){return this.lineScale};McxAbstractLayer.prototype.setEditable=function(a){this.editable=a};McxAbstractLayer.prototype.getEditable=function(){return this.editable};McxAbstractLayer.prototype.setSymbolizer=function(a){null!=a&&(this.symbolizer=a)};McxAbstractLayer.prototype.getSymbolizer=function(){return this.symbolizer};McxAbstractLayer.prototype.isCacheable=function(){return this.cacheable};
McxAbstractLayer.prototype.setCacheable=function(a){this.cacheable=a};McxAbstractLayer.prototype.isSingleTile=function(){return this.singleTile};McxAbstractLayer.prototype.setSingleTile=function(a){this.singleTile=a};McxAbstractLayer.prototype.isInstanceOf=function(a){return!1};McxAbstractLayer.prototype.createFeatureBuffer=function(){mcx.notSupported();return null};McxAbstractLayer.prototype.isInsertSupported=function(){return this.insertSupported};McxAbstractLayer.prototype.isDeleteSupported=function(){return this.deleteSupported};
McxAbstractLayer.prototype.isUpdateSupported=function(){return this.updateSupported};McxAbstractLayer.prototype.onFeatureInserted=function(a){return this.featureInsertedEventHandler.dispatchOnSuccess(this,a)};McxAbstractLayer.prototype.onFeatureInserting=function(a){return this.featureInsertingEventHandler.dispatchOnSuccess(this,a)};McxAbstractLayer.prototype.onFeaturesDeleted=function(a){return this.featureDeletedEventHandler.dispatchOnSuccess(this,a)};
McxAbstractLayer.prototype.onFeaturesDeleting=function(a){return this.featureDeletingEventHandler.dispatchOnSuccess(this,a)};McxAbstractLayer.prototype.onFeaturesUpdated=function(a){return this.featureUpdatedEventHandler.dispatchOnSuccess(this,a)};McxAbstractLayer.prototype.onFeaturesUpdating=function(a){return this.featureUpdatingEventHandler.dispatchOnSuccess(this,a)};McxAbstractLayer.prototype.setOpacity=function(a){this.opacity=a;this.onOpacityChangeHandler.dispatchOnSuccess(this,null)};
McxAbstractLayer.prototype.getOpacity=function(){return this.opacity};McxAbstractLayer.prototype.getFeatureInsertedEventHandler=function(){return this.featureInsertedEventHandler};McxAbstractLayer.prototype.getFeatureInsertingEventHandler=function(){return this.featureInsertingEventHandler};McxAbstractLayer.prototype.getFeatureDeletedEventHandler=function(){return this.featureDeletedEventHandler};McxAbstractLayer.prototype.getFeatureDeletingEventHandler=function(){return this.featureDeletingEventHandler};
McxAbstractLayer.prototype.getFeatureUpdatedEventHandler=function(){return this.featureUpdatedEventHandler};McxAbstractLayer.prototype.getFeatureUpdatingEventHandler=function(){return this.featureUpdatingEventHandler};McxAbstractLayer.prototype.getGroupName=function(){return this.groupName};McxAbstractLayer.prototype.setGroupName=function(a){this.groupName=a};McxAbstractLayer.prototype.getDataSourceName=function(){return this.dataSourceName};
McxAbstractLayer.prototype.testCapability=function(a){mcx.abstractMethod();return!1};McxAbstractLayer.prototype.getFeatures=function(a,b){};McxAbstractLayer.prototype.setFeatures=function(a){this.featureReader=a};McxAbstractLayer.prototype.setClassId=function(a){this.classId=a};McxAbstractLayer.prototype.setName=function(a){this.layerName=a};McxAbstractLayer.prototype.setFullName=function(a){this.fullName=a};
McxAbstractLayer.prototype.setKeyField=function(a){this.fieldKey=a;var b=this.getName().split("@");5==b.length&&(b[1]=a,this.layerName=b.join("@"))};McxAbstractLayer.prototype.getGlobalIdField=function(){return this.fieldGlobalID};McxAbstractLayer.prototype.setGlobalIdField=function(a){this.fieldGlobalID=a};McxAbstractLayer.prototype.setGeometryField=function(a){this.fieldGeometry=a;var b=this.getName().split("@");5==b.length&&(b[2]=a,this.layerName=b.join("@"))};
McxAbstractLayer.prototype.getGeometryField=function(){return this.fieldGeometry};McxAbstractLayer.prototype.setSymbolizerField=function(a){this.fieldSymbolizer=a};McxAbstractLayer.prototype.setLabelSymbolizerField=function(a){this.fieldLabelSymbolizer=a};McxAbstractLayer.prototype.setGeometryType=function(a){this.geometryType=a;var b=this.getName().split("@");5==b.length&&(b[3]=a.toString(),this.layerName=b.join("@"))};McxAbstractLayer.prototype.getQuery=function(){};
McxAbstractLayer.prototype.setSelectable=function(a){this.selectable!=a&&(this.selectable=a,this.selectableChangedEventHandler.dispatchOnSuccess(this,null))};McxAbstractLayer.prototype.isSelectable=function(){return this.selectable};McxAbstractLayer.prototype.setSelectionColor=function(a){this.selectionColor!=a&&(this.selectionColor=a,this.selectionColorChangedEventHandler.dispatchOnSuccess(this,null))};McxAbstractLayer.prototype.getSelectionColor=function(){return this.selectionColor};
McxAbstractLayer.prototype.getSelectionOpacity=function(){return this.selectionOpacity};McxAbstractLayer.prototype.setSelectionOpacity=function(a){this.selectionOpacity=a};McxAbstractLayer.prototype.getSelectionCount=function(){return Object.keys(this.selectedFeatures).length};McxAbstractLayer.prototype.getSelectableChangedEventHandler=function(){return this.selectableChangedEventHandler};McxAbstractLayer.prototype.getAddSelectionEventHandler=function(){return this.addSelectionEventHandler};
McxAbstractLayer.prototype.getRemoveSelectionEventHandler=function(){return this.removeSelectionEventHandler};McxAbstractLayer.prototype.getSelectionColorChangedEventHandler=function(){return this.selectionColorChangedEventHandler};
McxAbstractLayer.prototype.addSelection=function(a){var b=[];if("[object Array]"==Object.prototype.toString.call(a))for(var c in a)this.selectedFeatures.hasOwnProperty(a[c].getFeatureID().toString())||b.push(a[c]),this.selectedFeatures[a[c].getFeatureID().toString()]=a[c];else this.selectedFeatures.hasOwnProperty(a.getFeatureID().toString())||b.push(a),this.selectedFeatures[a.getFeatureID().toString()]=a;0>=b.length||(a=new McxSelectionChangedEventArgs(b,null),this.addSelectionEventHandler.dispatchOnSuccess(this,
a))};McxAbstractLayer.prototype.clearSelection=function(){var a=[],b;for(b in this.selectedFeatures)a.push(this.selectedFeatures[b]);this.selectedFeatures={};0>=a.length||(a=new McxSelectionChangedEventArgs(a,null),this.removeSelectionEventHandler.dispatchOnSuccess(this,a))};McxAbstractLayer.prototype.getSelection=function(){mcx.notSupported();return null};McxAbstractLayer.prototype.isFeatureSelected=function(a){return this.selectedFeatures.hasOwnProperty(a.getFeatureID().toString())};
McxAbstractLayer.prototype.removeSelection=function(a){var b=[];if("[object Array]"==Object.prototype.toString.call(a))for(var c in a){var d=a[c].getFeatureID();this.selectedFeatures.hasOwnProperty(d.toString())&&b.push(this.selectedFeatures[d]);delete this.selectedFeatures[a[c].getFeatureID()]}else void 0!=this.selectedFeatures[a.getFeatureID().toString()]&&b.push(this.selectedFeatures[a.getFeatureID().toString()]),delete this.selectedFeatures[a.getFeatureID().toString()];0>=b.length||(a=new McxSelectionChangedEventArgs(b,
null),this.removeSelectionEventHandler.dispatchOnSuccess(this,a))};McxAbstractLayer.prototype.onSelectionChanged=function(a){};McxAbstractLayer.prototype.setPainterMode=function(a){this.painterMode=a};McxAbstractLayer.prototype.getPainterMode=function(){return this.painterMode};McxAbstractLayer.prototype.isShowLabels=function(){return this.showLabels};McxAbstractLayer.prototype.setShowLabels=function(a){this.showLabels=a};McxAbstractLayer.prototype.isScaledLabels=function(){return this.scaledLabels};
McxAbstractLayer.prototype.setScaledLabels=function(a){this.scaledLabels=a};McxAbstractLayer.prototype.getMinLabelScale=function(){return this.minLabelScale};McxAbstractLayer.prototype.setMinLabelScale=function(a){this.minLabelScale=a};McxAbstractLayer.prototype.getMaxLabelScale=function(){return this.maxLabelScale};McxAbstractLayer.prototype.setMaxLabelScale=function(a){this.maxLabelScale=a};McxAbstractLayer.prototype.getLabelFormat=function(){return this.labelFormat};
McxAbstractLayer.prototype.setLabelFormat=function(a){a!=this.labelFormat&&(this.labelFormat=a,this.labelFormatChangedEventHandler.dispatchOnSuccess(this,null))};McxAbstractLayer.prototype.getLabelSymbolizer=function(){return this.labelSymbolizer};McxAbstractLayer.prototype.setLabelSymbolizer=function(a){this.labelSymbolizer=a};McxAbstractLayer.prototype.getLabelVisibilityChangedEventHandler=function(){return this.labelVisibilityChangedEventHandler};
McxAbstractLayer.prototype.getLabelScalabilityChangedEventHandler=function(){return this.labelScalabilityChangedEventHandler};McxAbstractLayer.prototype.getLabelVisibleRangeChangedEventHandler=function(){return this.labelVisibleRangeChangedEventHandler};McxAbstractLayer.prototype.getLabelFormatChangedEventHandler=function(){return this.labelFormatChangedEventHandler};McxAbstractLayer.prototype.getLabelSymbolizerChangedEventHandler=function(){return this.labelSymbolizerChangedEventHandler};
McxAbstractLayer.prototype.setSnappable=function(a){this.snappable!=a&&(this.snappable=a,this.snappableChangedEventHandler.dispatchOnSuccess(this,null))};McxAbstractLayer.prototype.getSnappable=function(){return this.snappable};McxAbstractLayer.prototype.getSnappableChangedEventHandler=function(){return this.snappableChangedEventHandler};McxAbstractLayer.prototype.getSubtypes=function(){return this.subtypes};McxAbstractLayer.prototype.getTag=function(){return this.tag};
McxAbstractLayer.prototype.setTag=function(a){this.tag=a};McxAbstractLayer.prototype.getSubtypeChangedEventHandler=function(){return this.subtypeFieldChangedEventHandler};McxAbstractLayer.prototype.setSubtypeType=function(a){this.subtypeType=a};McxAbstractLayer.prototype.getSubtypeType=function(){return this.subtypeType};McxAbstractLayer.prototype.createField=function(a){};McxAbstractLayer.prototype.deleteField=function(a){};McxAbstractLayer.prototype.alterField=function(a,b){};
McxAbstractLayer.prototype.getSchema=function(){return this.schema};McxAbstractLayer.prototype.getFilterCollection=function(){return this.filterCollection};McxAbstractLayer.prototype.setFilterCollection=function(a){this.filterCollection=a};McxAbstractLayer.prototype.query=function(a,b,c){};McxAbstractLayer.prototype.search=function(a,b,c,d,e){};McxAbstractLayer.prototype.getUniqueId=function(){return this.uniqueId};McxAbstractLayer.prototype.setUniqueId=function(a){this.uniqueId=a};js.framework.base.McxCommon.Data.McxAjaxParameter={};function McxAjaxParameter(){this.args=this.errorFunction=this.successFunction=this.scope=null;this.cacheable=this.async=!0;this.timeOut=45E3;this.max=this.min=-1}McxAjaxParameter.prototype.getSuccess=function(){return this.successFunction};McxAjaxParameter.prototype.getError=function(){return this.errorFunction};McxAjaxParameter.prototype.getArgs=function(){return this.args};McxAjaxParameter.prototype.setArgs=function(a){this.args=a};
McxAjaxParameter.prototype.getScope=function(){return this.scope};McxAjaxParameter.prototype.getAsync=function(){return this.async};McxAjaxParameter.prototype.setAsync=function(a){this.async=a};McxAjaxParameter.prototype.getCacheable=function(){return this.cacheable};McxAjaxParameter.prototype.setCacheable=function(a){this.cacheable=a};McxAjaxParameter.prototype.getTimeOut=function(){return this.timeOut};McxAjaxParameter.prototype.setTimeOut=function(a){this.timeOut=a};
McxAjaxParameter.prototype.setParameters=function(a,b,c){this.successFunction=b;this.errorFunction=c;this.scope=a};McxAjaxParameter.prototype.setRange=function(a,b){this.min=a;this.max=b};McxAjaxParameter.prototype.getMin=function(){return this.min};McxAjaxParameter.prototype.getMax=function(){return this.max};js.framework.base.McxCommon.Data.McxCodedValue={};function McxCodedValue(a,b){this.code=a;this.value=b}McxCodedValue.prototype.getCode=function(){return this.code};McxCodedValue.prototype.getValue=function(){return this.value};js.framework.base.McxCommon.Data.McxDateTime={};function McxDateTime(){this._moment=window.moment;if(!this._moment)throw"moment.js bulunamad\u0131";this._defaultFormat="MM/DD/YYYY HH:mm:ss";this._date=this._moment("01/01/0001 00:00:00",this._defaultFormat)}McxDateTime.now=function(){var a=window.moment;return(new McxDateTime).setDate(a().format("MM/DD/YYYY HH:mm:ss"),"MM/DD/YYYY HH:mm:ss")};McxDateTime.prototype.addDays=function(a){this._date.add(a,"days");return this};
McxDateTime.prototype.addMonths=function(a){this._date.add(a,"months");return this};McxDateTime.prototype.addYears=function(a){this._date.add(a,"years");return this};McxDateTime.prototype.addSeconds=function(a){this._date.add(a,"seconds");return this};McxDateTime.prototype.addMinutes=function(a){this._date.add(a,"minutes");return this};McxDateTime.prototype.addHours=function(a){this._date.add(a,"hours");return this};
McxDateTime.prototype.toString=function(a){return this._date.isValid()&&"01/01/0001 00:00:00"!=this._date.format(this._defaultFormat)?this._date.format(a||this._defaultFormat):""};McxDateTime.prototype.getDayOfMonth=function(){return parseFloat(this._date.dates())};McxDateTime.prototype.getDayOfWeek=function(){return parseFloat(this._date.days())};McxDateTime.prototype.getMonthOfYear=function(){return parseFloat(this._date.months()+1)};McxDateTime.prototype.toDateString=function(){return this._date.format("DD/MM/YYYY")};
McxDateTime.prototype.setDate=function(a,b){a&&(this._date=this._moment(a,b||this._defaultFormat));return this};js.framework.base.McxCommon.Data.McxDictionary={};function McxDictionary(){this._items=[]}McxDictionary.prototype.setValue=function(a,b){var c=this.getItemByKey(a);c?c.setValue(b):this._items[this._items.length]=new McxKeyValuePair(a,b)};McxDictionary.prototype.getValue=function(a){return(a=this.getItemByKey(a))?a.getValue():null};McxDictionary.prototype.getItemByKey=function(a){for(var b=0;b<this._items.length;b++)if(this._items[b].getKey()==a)return this._items[b];return null};
McxDictionary.prototype.getItems=function(){return this._items};js.framework.base.McxCommon.Data.McxDomain={};function McxDomain(a,b){this.domainName=a;this.codedValues=b}McxDomain.prototype.getDomainName=function(){return this.domainName};McxDomain.prototype.getCodedValues=function(){return this.codedValues};McxDomain.prototype.lookup=function(a){for(var b=0;b<this.codedValues.length;b++)if(this.codedValues[b].getCode()==a)return this.codedValues[b].getValue();return""};js.framework.base.McxCommon.Data.McxFeatureGroup={};function McxFeatureGroup(a){this.layer=a;this.features=[]}McxFeatureGroup.prototype.addFeature=function(a){this.features=this.features.concat(a)};McxFeatureGroup.prototype.getLayer=function(){return this.layer};McxFeatureGroup.prototype.getFeatures=function(){return this.features};
McxFeatureGroup.groupFeatures=function(a){for(var b={},c=0;c<a.length;c++)if(null!=a[c]){var d=a[c].getLayer().getClassId(),e=b[d];e||(e=[],e.push(a[c].getLayer()));e.push(a[c]);b[d]=e}a=[];for(c in b)e=b[c][0],d=b[c].slice(1,b[c].length),e=new McxFeatureGroup(e),e.addFeature(d),a.push(e);return a};js.framework.base.McxCommon.Data.McxFieldDefinition={};function McxFieldDefinition(){this.domainName=this.fieldName=this.alias="";this.required=this.primaryKey=this.ignored=this.editable=!1;this.size=this.precision=0;this.defaultValue={};this.fieldType=McxDataType.Object;this._description=""}McxFieldDefinition.prototype.isIgnored=function(){return this.ignored};McxFieldDefinition.prototype.setIsIgnored=function(a){this.ignored=a};McxFieldDefinition.prototype.getFieldName=function(){return this.fieldName};
McxFieldDefinition.prototype.setFieldName=function(a){this.fieldName=a};McxFieldDefinition.prototype.isEditable=function(){return this.editable};McxFieldDefinition.prototype.setIsEditable=function(a){this.editable=a};McxFieldDefinition.prototype.getDefaultValue=function(){return this.defaultValue};McxFieldDefinition.prototype.setDefaultValue=function(a){this.defaultValue=a};McxFieldDefinition.prototype.isRequired=function(){return this.required};
McxFieldDefinition.prototype.setIsRequired=function(a){this.required=a};McxFieldDefinition.prototype.getSize=function(){return this.size};McxFieldDefinition.prototype.setSize=function(a){this.size=a};McxFieldDefinition.prototype.getDomainName=function(){return this.domainName};McxFieldDefinition.prototype.setDomainName=function(a){this.domainName=a};McxFieldDefinition.prototype.getAlias=function(){return this.alias};McxFieldDefinition.prototype.setAlias=function(a){this.alias=a};
McxFieldDefinition.prototype.getFieldType=function(){return this.fieldType};
McxFieldDefinition.prototype.setFieldType=function(a){switch(a){case "IMcxGeometry":this.fieldType=McxDataType.IMcxGeometry;break;case "IMcxSymbolizer":this.fieldType=McxDataType.IMcxSymbolizer;break;case "Boolean":this.fieldType=McxDataType.Boolean;break;case "Byte":this.fieldType=McxDataType.Byte;break;case "Int16":this.fieldType=McxDataType.Int16;break;case "Int32":this.fieldType=McxDataType.Int32;break;case "Int64":this.fieldType=McxDataType.Int64;break;case "Float":this.fieldType=McxDataType.Float;
break;case "Double":this.fieldType=McxDataType.Double;break;case "DateTime":this.fieldType=McxDataType.DateTime;break;case "String":this.fieldType=McxDataType.String;break;case "Guid":this.fieldType=McxDataType.Guid;break;case "Object":this.fieldType=McxDataType.Object;break;case "Unknown":this.fieldType=McxDataType.Unknown;break;default:this.fieldType=McxDataType.IMcxGeometry}};
McxFieldDefinition.prototype.getFieldTypeName=function(){switch(this.fieldType){case McxDataType.IMcxGeometry:return"IMcxGeometry";case McxDataType.IMcxSymbolizer:return"IMcxSymbolizer";case McxDataType.Boolean:return"Boolean";case McxDataType.Byte:return"Byte";case McxDataType.Int16:return"Int16";case McxDataType.Int32:return"Int32";case McxDataType.Int64:return"Int64";case McxDataType.Float:return"Float";case McxDataType.Double:return"Double";case McxDataType.DateTime:return"DateTime";case McxDataType.String:return"String";
case McxDataType.Guid:return"Guid";case McxDataType.Object:return"Object";case McxDataType.Unknown:return"Unknown";default:return"IMcxGeometry"}};McxFieldDefinition.prototype.isPrimaryKey=function(){return this.primaryKey};McxFieldDefinition.prototype.setIsPrimaryKey=function(a){this.primaryKey=a};McxFieldDefinition.prototype.getPrecision=function(){return this.precision};McxFieldDefinition.prototype.setPrecision=function(a){this.precision=a};
McxFieldDefinition.isTypeCompatible=function(a,b){if(a==b)return!0;switch(a){case McxDataType.Int32:return b==McxDataType.Int16||b==McxDataType.Int32;case McxDataType.Int64:return b==McxDataType.Int16||b==McxDataType.Int32||b==McxDataType.Int64;case McxDataType.Float:return b==McxDataType.Int16||b==McxDataType.Int32||b==McxDataType.Int64||b==McxDataType.Float;case McxDataType.Double:return b==McxDataType.Int16||b==McxDataType.Int32||b==McxDataType.Int64||b==McxDataType.Double;case McxDataType.String:return!(b==
McxDataType.Object||b==McxDataType.IMcxGeometry)}return!1};
McxFieldDefinition.tryChangeType=function(a,b){if(0==mcx.isDefAndNotNull(a))return null;var c=a.toString();switch(b){case McxDataType.Boolean:if(c=c.toLowerCase(),"0"==c||"false"==c)break;else return"1"==c||"true"==c?!0:null;case McxDataType.Int16:var d=/^-?[0-9]*$/i;return d.test(c)&&(c=parseInt(c,0),32767>c&&-32767<c)?c:null;case McxDataType.Int32:return d=/^-?[0-9]*$/i,d.test(c)&&(c=parseInt(c,0),2147483647>c&&-2147483648<c)?c:null;case McxDataType.Int64:return d=/^-?[0-9]*$/i,d.test(c)&&(c=parseInt(c,
0),0x7fffffffffffffff>c&&-9223372036854775808<c)?c:null;case McxDataType.Float:return d=/^-?[0-9]*(.[0-9]*)?$/i,d.test(c)?(d=c.indexOf("."),d=c.length-d,c=parseInt(c,d)):null;case McxDataType.Double:return d=/^-?[0-9]*(.[0-9]*)?$/i,d.test(c)?(d=c.indexOf("."),d=c.length-d,c=parseInt(c,d)):null;case McxDataType.DateTime:return null;case McxDataType.String:return c;case McxDataType.Guid:return d=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i,d.test(c)?c:null}return!1};
McxFieldDefinition.prototype.setDescription=function(a){this._description=a};McxFieldDefinition.prototype.getDescription=function(){return this._description};
McxFieldDefinition.prototype.clone=function(){var a=new McxFieldDefinition;a.setAlias(this.getAlias());a.setDefaultValue(this.getDefaultValue());a.setDescription(this.getDescription());a.setFieldName(this.getFieldName());a.setFieldType(this.getFieldTypeName());a.setIsEditable(this.isEditable());a.setIsIgnored(this.isIgnored());a.setIsPrimaryKey(this.isPrimaryKey());a.setPrecision(this.getPrecision());a.setSize(this.getSize());return a};js.framework.base.McxCommon.Data.McxFilter={};function McxFilter(){this._geometry=null;this._spatialRelation=McxSpatialRelation.None;this._attributeFilter="";this._filterId="default";this._bounds=null}McxFilter.prototype.getGeometry=function(){return this._geometry};McxFilter.prototype.setGeometry=function(a){this._geometry=a};McxFilter.prototype.getSpatialRelation=function(){return this._spatialRelation};McxFilter.prototype.setSpatialRelation=function(a){this._spatialRelation=a};
McxFilter.prototype.getAttributeFilter=function(){return this._attributeFilter};McxFilter.prototype.setAttributeFilter=function(a){this._attributeFilter=a};McxFilter.prototype.getFilterId=function(){return this._filterId};McxFilter.prototype.setFilterId=function(a){this._filterId=a};McxFilter.prototype.getBounds=function(){return this._bounds};js.framework.base.McxCommon.Data.McxFilterCollection={};function McxFilterCollection(){this._filters=[];this._filterAddedEventHandler=new McxEventHandler;this._filterRemovedEventHandler=new McxEventHandler;this._filterResetEventHandler=new McxEventHandler}McxFilterCollection.prototype.getFilter=function(a){return a>=this._filters.length?null:this._filters[a]};McxFilterCollection.prototype.indexOf=function(a){for(var b=0;b<this._filters.length;b++)if(this._filters[b]==a)return b;return-1};
McxFilterCollection.prototype.add=function(a){this._filters.push(a)};McxFilterCollection.prototype.addRange=function(a){for(var b=0;b<a.length;b++)this._filters.push(a[b])};McxFilterCollection.prototype.insert=function(a,b){};McxFilterCollection.prototype.clear=function(){this._filters=[]};McxFilterCollection.prototype.containsGuid=function(a){for(var b=0;b<this._filters.length;b++)if(this._filters[b].getFilterId()==a)return!0;return!1};
McxFilterCollection.prototype.containsFilter=function(a){for(var b=0;b<this._filters.length;b++)if(this._filters[b].getFilterId()==a.getFilterId())return!0;return!1};McxFilterCollection.prototype.find=function(a){for(var b=[],c=0;c<this._filters.length;c++)this._filters[c].getFilterId()==a&&b.push(this._filters[c]);return b};McxFilterCollection.prototype.removeWithGuid=function(a){for(var b=!1,c=0;c<this._filters.length;c++)this._filters[c].getFilterId()==a&&(b=!0,this._filters.splice(c,1),c--);return b};
McxFilterCollection.prototype.removeFilter=function(a){for(var b=!1,c=0;c<this._filters.length;c++)this._filters[c]==a&&(b=!0,this._filters.splice(c,1),c--);return b};McxFilterCollection.prototype.removeAt=function(a){this._filters.splice(a,1)};McxFilterCollection.prototype.removeRange=function(a){for(var b=0;b<a.length;b++)for(var c=0;c<this._filters.length;c++)this._filters[c]==a[b]&&this.removeAt(c)};McxFilterCollection.prototype.getCount=function(){return this._filters.length};
McxFilterCollection.prototype.getFilterAddedEventHandler=function(){return this._filterAddedEventHandler};McxFilterCollection.prototype.getFilterRemovedEventHandler=function(){return this._filterRemovedEventHandler};McxFilterCollection.prototype.getFilterResetEventHandler=function(){return this._filterResetEventHandler};
McxFilterCollection.prototype.toString=function(){for(var a=[],b=0;b<this._filters.length;b++){var c=[],d=this._filters[b];d.getAttributeFilter()&&c.push(d.getAttributeFilter());d.getGeometry()&&c.push(d.getGeometry());d.getSpatialRelation()&&c.push(d.getSpatialRelation());d.getBounds()&&c.push(d.getBounds());a.push(c.join(";"))}return a.join("~")};js.framework.base.McxCommon.Data.McxGradient={};function McxGradient(){this._gradientStopArray=[];this._specialName=null;this.calculatedValues={}}McxGradient.prototype.addGradientStop=function(a){this._gradientStopArray.push(a)};McxGradient.prototype.getName=function(){return(this._specialName||"Custom gradient").toString()};McxGradient.prototype.setName=function(a){this._specialName=a};
McxGradient.prototype.getColorAtStop=function(a){for(var b=0,c=Number.MAX_VALUE,d=null,e=null,f=0;f<this._gradientStopArray.length;f++){var g=this._gradientStopArray[f];if(g.getStop()==a)return g.getColor();g.getStop()<a&&g.getStop()>=b&&(b=g.getStop(),d=g);g.getStop()>a&&g.getStop()<=c&&(c=g.getStop(),e=g)}if(0==mcx.isDefAndNotNull(e)||0==mcx.isDefAndNotNull(d))return McxColor.fromHex("000");var f=new McxColor,h=c-b,g=e.getColor().getRed()-d.getColor().getRed(),c=e.getColor().getGreen()-d.getColor().getGreen(),
e=e.getColor().getBlue()-d.getColor().getBlue(),b=(a-b)/h,g=b*g+d.getColor().getRed(),c=b*c+d.getColor().getGreen(),d=b*e+d.getColor().getBlue();f.setColorFromRgb(g,c,d);b=Math.round(g);e=Math.round(c);d=Math.round(d);this.calculatedValues[b.toString()+"_"+e.toString()+"_"+d.toString()]=a;return f};McxGradient.prototype.getValueOfColor=function(a,b,c){a=Math.round(a);b=Math.round(b);c=Math.round(c);return(c=this.calculatedValues[a.toString()+"_"+b.toString()+"_"+c.toString()])?c:Number.MIN_VALUE};
McxGradient.prototype.paintElement=function(a,b){b=b||"left";var c=[];a.css("background","none");for(var d=0;d<this._gradientStopArray.length;d++){var e=this._gradientStopArray[d];c.push("#"+e.getColor().getHex()+" "+e.getStop()+"%")}a.css("background","linear-gradient("+b+","+c.join(",")+")");$.browser.webkit&&a.css("background","-webkit-linear-gradient("+b+", "+c.join(",")+")");$.browser.mozilla&&a.css("background","-moz-linear-gradient("+b+", "+c.join(",")+")");$.browser.msie&&a.css("background",
"-ms-linear-gradient("+b+", "+c.join(",")+")");$.browser.opera&&a.css("background","-o-linear-gradient("+b+", "+c.join(",")+")")};McxGradient.fromJSON=function(a){var b=new McxGradient;b.setName(a.name);a=a.stops;for(var c in a)b.addGradientStop(new McxGradientStop(parseFloat(c),McxColor.fromRgb(a[c].r,a[c].g,a[c].b)));return b};McxGradient.prototype.getStops=function(){return this._gradientStopArray};McxGradient.prototype.clear=function(){this.calculatedValues=[]};
McxGradient.prototype.getReversedClone=function(){for(var a=this.getStops(),b=[],c=new McxGradient,d=0;d<a.length;d++)b.push(new McxGradientStop(100-a[d].getStop(),a[d].getColor()));b.sort(function(a,b){return a.getStop()<b.getStop()?-1:a.getStop()>b.getStop()?1:0});for(a=0;a<b.length;a++)c.addGradientStop(b[a]);return c};js.framework.base.McxCommon.Data.McxGradientStop={};function McxGradientStop(a,b){this._stop=a||0;this._color=b||null}McxGradientStop.prototype.setColorFromHex=function(a){this._color=new McxColor;this._color.setColorFromHex(a)};McxGradientStop.prototype.setStop=function(a){this._stop=a};McxGradientStop.prototype.getColor=function(){return this._color};McxGradientStop.prototype.getStop=function(){return this._stop};McxGradientStop.prototype.clone=function(){return new McxGradientStop(this._stop,this._color)};js.framework.base.McxCommon.Data.McxKeyValuePair={};function McxKeyValuePair(a,b){this._key=a;this._value=b}McxKeyValuePair.prototype.getKey=function(){return this._key};McxKeyValuePair.prototype.getValue=function(){return this._value};McxKeyValuePair.prototype.setKey=function(a){this._key=a};McxKeyValuePair.prototype.setValue=function(a){this._value=a};js.framework.base.McxCommon.Data.McxLabel={};function McxLabel(a,b,c,d){this.x=a;this.y=b;this.angle=d;this.value=c}McxLabel.prototype.getX=function(){return this.x};McxLabel.prototype.getY=function(){return this.y};McxLabel.prototype.getAngle=function(){return this.angle};McxLabel.prototype.getValue=function(){return this.value};js.framework.base.McxCommon.Data.McxLayerRequestFilter={};function McxLayerRequestFilter(){this._filter=this._layer=null}McxLayerRequestFilter.prototype.getLayer=function(){return this._layer};McxLayerRequestFilter.prototype.setLayer=function(a){this._layer=a};McxLayerRequestFilter.prototype.getFilter=function(){return this._filter};McxLayerRequestFilter.prototype.setFilter=function(a){this._filter=a};js.framework.base.McxCommon.Data.McxMediaInfo={};function McxMediaInfo(){this._fileName=this._dateCreated="";this._userInfo=null;this._mediaId=-1;this._contentType="";this._fileSize=0;this._originalFileName="";this._categoryId=-1}McxMediaInfo.prototype.getDateCreated=function(){return this._dateCreated};McxMediaInfo.prototype.setDateCreated=function(a){this._dateCreated=a};McxMediaInfo.prototype.getFileName=function(){return this._fileName};
McxMediaInfo.prototype.setFileName=function(a){this._fileName=a};McxMediaInfo.prototype.getUserInfo=function(){return this._userInfo};McxMediaInfo.prototype.setUserInfo=function(a){this._userInfo=a};McxMediaInfo.prototype.getMediaId=function(){return this._mediaId};McxMediaInfo.prototype.setMediaId=function(a){this._mediaId=a};McxMediaInfo.prototype.getContentType=function(){return this._contentType};McxMediaInfo.prototype.setContentType=function(a){this._contentType=a};
McxMediaInfo.prototype.getFileSize=function(){return this._fileSize};McxMediaInfo.prototype.setFileSize=function(a){this._fileSize=a};McxMediaInfo.prototype.getOriginalFileName=function(){return this._originalFileName};McxMediaInfo.prototype.setOriginalFileName=function(a){this._originalFileName=a};McxMediaInfo.prototype.getCategoryId=function(){return this._categoryId};McxMediaInfo.prototype.setCategoryId=function(a){this._categoryId=a};js.framework.base.McxCommon.Data.McxQueryDefinition={};function McxQueryDefinition(a,b,c){this.name=a;this.dataSource=b;this.sql=c}McxQueryDefinition.prototype.getSql=function(){return this.sql};McxQueryDefinition.prototype.getName=function(){return this.name};McxQueryDefinition.prototype.getDataSource=function(){return this.dataSource};js.framework.base.McxCommon.Data.McxRequestFilter={};function McxRequestFilter(){this._geometryArray=[];this._spatialRelation=McxSpatialRelation.None;this._attributeFilter=""}McxRequestFilter.prototype.getGeometryArray=function(){return this._geometryArray};McxRequestFilter.prototype.addGeometry=function(a){this._geometryArray.push(a)};McxRequestFilter.prototype.getSpatialRelation=function(){return this._spatialRelation};
McxRequestFilter.prototype.setSpatialRelation=function(a){this._spatialRelation=a};McxRequestFilter.prototype.getAttributeFilter=function(){return this._attributeFilter};McxRequestFilter.prototype.setAttributeFilter=function(a){this._attributeFilter=a};js.framework.base.McxCommon.Data.McxSchema={};function McxSchema(){this.fieldDefinitionArray=[]}McxSchema.prototype.getFieldOrdinal=function(a){for(var b=0;b<this.fieldDefinitionArray.length;b++)if(this.fieldDefinitionArray[b].getFieldName()==a)return b;return-1};McxSchema.prototype.getFields=function(){return this.fieldDefinitionArray};
McxSchema.prototype.getField=function(a){if("string"==typeof a)for(var b=0;b<this.fieldDefinitionArray.length;b++){if(a==this.fieldDefinitionArray[b].getFieldName())return this.fieldDefinitionArray[b]}else if("number"==typeof a)return this.fieldDefinitionArray[a];return null};McxSchema.prototype.getFieldCount=function(){return this.fieldDefinitionArray.length};McxSchema.prototype.clone=function(){for(var a=new McxSchema,b=0;b<this.getFieldCount();b++){var c=this.getField(b).clone();a.addField(c)}return a};
McxSchema.prototype.addField=function(a){this.fieldDefinitionArray.push(a)};McxSchema.prototype.deleteField=function(a){this.fieldDefinitionArray.length>a&&this.fieldDefinitionArray.splice(a,1)};McxSchema.prototype.alterField=function(a,b){this.fieldDefinitionArray[a]=b};js.framework.base.McxCommon.Data.McxScript={};function McxScript(a){this.script=a;this.fields=[];this.parseFields()}McxScript.prototype.getScript=function(){return this.script};McxScript.prototype.run=function(a){for(var b=this.script,c=0;c<this.fields.length;c++){var d=this.fields[c],e=a.getValue(d)?a.getValue(d):"null";a.getField(d).getFieldType()==McxDataType.String&&(e="'"+e+"'");b=b.split("["+d+"]").join(e.toString())}return eval(b)};
McxScript.prototype.parseFields=function(){for(var a=[],b=/\[(.*?)\]/g,c;null!=(c=b.exec(this.script));)-1==a.indexOf(c[1])&&a.push(c[1]);this.fields=a};McxScript.prototype.getFields=function(){return this.fields};js.framework.base.McxCommon.Data.McxServerRelation={};function McxServerRelation(){this.bufferValue=this.filterValue=this.originLabel=this.destLabel=this.destValueKey=this.destForeignKey=this.destPrimaryKey=this.destTable=this.originForeignKey=this.originPrimaryKey=this.originTable=this.relationName="";this.spatialRelation=McxTopologyRelation.None}McxServerRelation.prototype.getRelationName=function(){return this.relationName};McxServerRelation.prototype.getOriginTable=function(){return this.originTable};
McxServerRelation.prototype.getOriginPrimaryKey=function(){return this.originPrimaryKey};McxServerRelation.prototype.getOriginForeignKey=function(){return this.originForeignKey};McxServerRelation.prototype.getDestTable=function(){return this.destTable};McxServerRelation.prototype.getDestPrimaryKey=function(){return this.destPrimaryKey};McxServerRelation.prototype.getDestForeignKey=function(){return this.destForeignKey};McxServerRelation.prototype.getDestValueKey=function(){return this.destValueKey};
McxServerRelation.prototype.getSpatialRelation=function(){return this.spatialRelation};McxServerRelation.prototype.getOriginLabel=function(){return this.originLabel};McxServerRelation.prototype.getDestLabel=function(){return this.destLabel};McxServerRelation.prototype.getFilterValue=function(){return this.filterValue};McxServerRelation.prototype.getBufferValue=function(){return this.bufferValue};McxServerRelation.prototype.setRelationName=function(a){this.relationName=a};
McxServerRelation.prototype.setOriginTable=function(a){this.originTable=a};McxServerRelation.prototype.setOriginPrimaryKey=function(a){this.originPrimaryKey=a};McxServerRelation.prototype.setOriginForeignKey=function(a){this.originForeignKey=a};McxServerRelation.prototype.setDestTable=function(a){this.destTable=a};McxServerRelation.prototype.setDestPrimaryKey=function(a){this.destPrimaryKey=a};McxServerRelation.prototype.setDestForeignKey=function(a){return this.destForeignKey=a};
McxServerRelation.prototype.setDestValueKey=function(a){this.destValueKey=a};McxServerRelation.prototype.setSpatialRelation=function(a){this.spatialRelation=a};McxServerRelation.prototype.setOriginLabel=function(a){this.originLabel=a};McxServerRelation.prototype.setDestLabel=function(a){this.destLabel=a};McxServerRelation.prototype.setFilterValue=function(a){this.filterValue=a};McxServerRelation.prototype.setBufferValue=function(a){this.bufferValue=a};js.framework.base.McxCommon.Data.McxSettingsManager={};var McxSettingsManager={settingsManager:new McxStorageSettingsManager,read:function(a,b){return McxSettingsManager.settingsManager.read(a,b)},write:function(a,b,c){McxSettingsManager.settingsManager.write(a,b,c)},delete:function(a,b){McxSettingsManager.settingsManager.delete(a,b)},isAvailable:function(){return McxSettingsManager.settingsManager.isAvailable()}};js.framework.base.McxCommon.Data.McxSettingsResult={};function McxSettingsResult(){mcx.base(this,null);this.settings=[]}mcx.inherits(McxSettingsResult,McxResult);McxSettingsResult.prototype.getSettings=function(){return this.settings};McxSettingsResult.prototype.setSettings=function(a){this.settings=a};js.framework.base.McxCommon.Data.McxStorageSettingsManager={};function McxStorageSettingsManager(){}McxStorageSettingsManager.prototype.read=function(a,b){if(null==b){b=new McxAjaxParameter;var c=function(){};b.setParameters(this,c,c);b.setAsync(!1)}var c=new McxSettingsResult,d=$.jStorage.get(a);d&&c.setSettings($.isArray(d)?d:[d]);b.getAsync()&&b.getSuccess().call(b.getScope(),c);return c};
McxStorageSettingsManager.prototype.write=function(a,b,c){if(null==c){c=new McxAjaxParameter;var d=function(){};c.setParameters(this,d,d);c.setAsync(!1)}$.jStorage.set(a,b);c.getAsync()&&c.getSuccess().call(c.getScope(),null)};McxStorageSettingsManager.prototype.delete=function(a,b){if(null==b){b=new McxAjaxParameter;var c=function(){};b.setParameters(this,c,c);b.setAsync(!1)}$.jStorage.deleteKey(a);b.getAsync()&&b.getSuccess().call(b.getScope(),null)};
McxStorageSettingsManager.prototype.isAvailable=function(){return $.jStorage.storageAvailable()};McxStorageSettingsManager.prototype.setUri=function(a){};js.framework.base.McxCommon.Data.McxSubtype={};function McxSubtype(a){this.value=this.tag=this.compositeSymbolizer=this.labelSymbolizer=null;this.visible=!0;this.minScale=Number.MAX_VALUE;this.maxScale=Number.MIN_VALUE;this.name="";this.script=a}McxSubtype.prototype.getLabelSymbolizer=function(){return this.labelSymbolizer};McxSubtype.prototype.setLabelSymbolizer=function(a){this.labelSymbolizer=a};McxSubtype.prototype.getSymbolizer=function(){return this.compositeSymbolizer};
McxSubtype.prototype.setSymbolizer=function(a){this.compositeSymbolizer=a};McxSubtype.prototype.getTag=function(){return this.tag};McxSubtype.prototype.setTag=function(a){this.tag=a};McxSubtype.prototype.getValue=function(){return this.value};McxSubtype.prototype.setValue=function(a){this.value=a};McxSubtype.prototype.isVisible=function(){return this.visible};McxSubtype.prototype.setVisibility=function(a){this.visible=a};McxSubtype.prototype.getMinScale=function(){return this.minScale};
McxSubtype.prototype.setMinScale=function(a){this.minScale=a};McxSubtype.prototype.getMaxScale=function(){return this.maxScale};McxSubtype.prototype.setMaxScale=function(a){this.maxScale=a};McxSubtype.prototype.getScript=function(){return this.script};McxSubtype.prototype.setScript=function(a){this.script=a};McxSubtype.prototype.getName=function(){return this.name};McxSubtype.prototype.setName=function(a){this.name=a};js.framework.base.McxCommon.Data.McxSubtypeCollection={};function McxSubtypeCollection(a){this.layer=a;this.subtypes=[];this.resetEventHandler=new McxEventHandler;this.subtypeAddedEventHandler=new McxEventHandler;this.subtypeRemovedEventHandler=new McxEventHandler}McxSubtypeCollection.prototype.getCount=function(){return this.subtypes.length};McxSubtypeCollection.prototype.getLayer=function(){return this.layer};
McxSubtypeCollection.prototype.getSubtypeWithValue=function(a){return $.grep(this.subtypes,function(b){return b.value==a})};McxSubtypeCollection.prototype.getResetEventHandler=function(){return this.resetEventHandler};McxSubtypeCollection.prototype.getSubtypeAddedEventHandler=function(){return this.subtypeAddedEventHandler};McxSubtypeCollection.prototype.getSubtypeRemovedEventHandler=function(){return this.subtypeRemovedEventHandler};
McxSubtypeCollection.prototype.add=function(a){var b=a.getScript().getScript();this.subtypes.push({name:b,value:a})};McxSubtypeCollection.prototype.clear=function(){this.subtypes=[]};McxSubtypeCollection.prototype.remove=function(a){var b=$.grep(this.subtypes,function(b){return b.name==a}),b=this.subtypes.indexOf(b);this.subtypes.splice(b,1);return!0};McxSubtypeCollection.prototype.getAt=function(a){return this.subtypes[a].value};
McxSubtypeCollection.prototype.getFields=function(){var a={},b;for(b in this.subtypes){var c=this.subtypes[b].value.getScript().getFields(),d;for(d in c)a[c[d]]=c[d]}b=[];for(var e in a)b.push(a[e]);return b};js.framework.base.McxCommon.Dialog={};js.framework.base.McxCommon.Dialog.McxSubmitEventArgs={};function McxSubmitEventArgs(){mcx.base(this,null);this._isValidated=!0}mcx.inherits(McxSubmitEventArgs,McxEventArgs);McxSubmitEventArgs.prototype.getIsValidated=function(){return this._isValidated};McxSubmitEventArgs.prototype.setIsValidated=function(a){this._isValidated=a};js.framework.base.McxCommon.Dialog.MessageBox={};js.framework.base.McxCommon.Dialog.MessageBox.McxMessageBoxResult={};var McxMessageBoxResult={None:0,Ok:1,Cancel:2};js.framework.base.McxCommon.Dialog.MessageBox.McxMessageBoxResultArgs={};function McxMessageBoxResultArgs(a){mcx.base(this,null);this._result=a}mcx.inherits(McxMessageBoxResultArgs,McxEventArgs);McxMessageBoxResultArgs.prototype.getResult=function(){return this._result};js.framework.base.McxCommon.Dialog.MessageBox.McxMessageBoxType={};var McxMessageBoxType={Information:0,Warning:1,Error:2,Confirm:3};js.framework.base.McxCommon.Mapping={};js.framework.base.McxCommon.Mapping.McxCell={};function McxCell(a,b,c,d){this.indexX=a;this.indexY=b;this.world=c;this.display=d}McxCell.prototype.getIndexX=function(){return this.indexX};McxCell.prototype.getIndexY=function(){return this.indexY};McxCell.prototype.getWorld=function(){return this.world};McxCell.prototype.getDisplay=function(){return this.display};js.framework.base.McxCommon.Mapping.McxDrawContext={};function McxDrawContext(a,b){this.map=a;this.geodeticGraphics=new McxGeodeticGraphics(a,b)}McxDrawContext.prototype.getMap=function(){return this.map};McxDrawContext.prototype.getGeodeticGraphics=function(){return this.geodeticGraphics};js.framework.base.McxCommon.Mapping.McxGeodeticGraphics={};function McxGeodeticGraphics(a,b){this.map=a;this.context=b;this.useTransformation=!0;this.contentDiv=$("<div/>")}
McxGeodeticGraphics.prototype.drawRectangle=function(a,b,c,d){d=a;var e=b;this.useTransformation&&(d=this.map.worldToView(a.getX(),a.getY()),e=this.map.worldToView(b.getX(),b.getY()));a=null!=c.getStroke();b=null!=c.getFill();if(a||b){if(a){var f=c.getStroke().getColor();this.context.strokeStyle!=f&&(this.context.strokeStyle=f)}b&&(f=c.getFill().getColor(),this.context.fillStyle!=f&&(this.context.fillStyle=f),this.context.globalAlpha=c.getFill().getOpacity());var f=Math.min(d.getX(),e.getX()),g=Math.min(d.getY(),
e.getY()),h=Math.max(d.getX(),e.getX());d=Math.max(d.getY(),e.getY());b&&this.context.fillRect(f,g,h-f,d-g);a&&(this.context.lineWidth=c.getStroke().getWidth(),this.context.strokeRect(f,g,h-f,d-g))}};
McxGeodeticGraphics.prototype.drawPolygonWithHoles=function(a,b,c,d,e,f){d=null!=c.getFill();var g=null!=c.getStroke();if(d||g){if(d){var h=c.getFill().getColor();h!=this.context.fillStyle&&(this.context.fillStyle=h)}if(g){h=c.getStroke().getDashPattern();null!=h&&this.context.setLineDash(h);h=c.getStroke().getColor();h!=this.context.strokeStyle&&(this.context.strokeStyle=h);h=c.getStroke().getWidth();h!=this.context.lineWidth&&(this.context.lineWidth=h);h=c.getStroke().getStartCap();h!=this.context.lineCap&&
(this.context.lineCap=h);var k=c.getStroke().getLineJoin();h!=this.context.lineJoin&&(this.context.lineJoin=k)}this.context.beginPath();for(h=0;h<a.length;h++)a[h].y!=Number.NaN&&a[h].x!=Number.NaN&&(k=a[h],this.useTransformation&&(k=this.map.worldToView(a[h].x,a[h].y)),0==h?this.context.moveTo(k.x-e,k.y-f):this.context.lineTo(k.x-e,k.y-f));this.context.closePath();d&&(a=c.getFill().getOpacity(),this.context.globalAlpha!=a&&(this.context.globalAlpha=a));for(a=0;a<b.length;a++)for(var m=b[a].getPoints(),
h=0;h<m.length;h++)m[h].y!=Number.NaN&&m[h].x!=Number.NaN&&(k=m[h],this.useTransformation&&(k=this.map.worldToView(m[h].x,m[h].y)),0==h?this.context.moveTo(k.x-e,k.y-f):this.context.lineTo(k.x-e,k.y-f));d&&this.context.fill();g&&(a=c.getStroke().getOpacity(),this.context.globalAlpha!=a&&(this.context.globalAlpha=c.getStroke().getOpacity()));g&&this.context.stroke()}};
McxGeodeticGraphics.prototype.drawPolygon=function(a,b,c,d,e){c=null!=b.getFill();var f=null!=b.getStroke();if(c||f){if(c){var g=b.getFill().getColor();g!=this.context.fillStyle&&(this.context.fillStyle=g)}if(f){g=b.getStroke().getDashPattern();null!=g&&this.context.setLineDash(g);g=b.getStroke().getColor();g!=this.context.strokeStyle&&(this.context.strokeStyle=g);g=b.getStroke().getWidth();g!=this.context.lineWidth&&(this.context.lineWidth=g);g=b.getStroke().getStartCap();g!=this.context.lineCap&&
(this.context.lineCap=g);var h=b.getStroke().getLineJoin();g!=this.context.lineJoin&&(this.context.lineJoin=h)}this.context.beginPath();for(g=0;g<a.length;g++)a[g].y!=Number.NaN&&a[g].x!=Number.NaN&&(h=a[g],this.useTransformation&&(h=this.map.worldToView(a[g].x,a[g].y)),this.context.lineTo(h.x-d,h.y-e));this.context.closePath();c&&(a=b.getFill().getOpacity(),this.context.globalAlpha!=a&&(this.context.globalAlpha=a));c&&this.context.fill();f&&(a=b.getStroke().getOpacity(),this.context.globalAlpha!=
a&&(this.context.globalAlpha=b.getStroke().getOpacity()));f&&this.context.stroke()}};
McxGeodeticGraphics.prototype.drawText=function(a,b,c,d,e,f){this.useTransformation&&(b=this.map.worldToView(b.getX(),b.getY()));var g=c.getAnchorPoint(),h=g.getAnchorPointX(),k=g.getAnchorPointY(),g=c.getDisplacement();b=b.clone();b.translate(g.getDisplacementX(),g.getDisplacementY());var g=this.context.textBaseline,m=this.context.textAlign;this.context.textBaseline=0<=k&&.25>=k?"bottom":.25<k&&.75>k?"middle":"top";this.context.textAlign=0<=h&&.25>=h?"right":.25<h&&.75>h?"center":"left";h=this.context.globalCompositeOperation;
k=c.getFill().getColor();this.context.fillStyle!=k&&(this.context.fillStyle=k);this.context.globalAlpha!=c.getFill().getOpacity()&&(this.context.globalAlpha=c.getFill().getOpacity());this.context.save();this.context.translate(b.getX()-e,b.getY()-f);this.context.scale(d,d);0!=c.getRotation()&&this.context.rotate(c.getRotation()*Math.PI/180);this.context.translate(-(b.getX()-e),-(b.getY()-f));this.context.font=c.getFont().toString();d=b.getY()-f;c=c.getFont().getFontSize();a=a.split("\n");for(f=0;f<
a.length;f++)this.context.fillText(a[f],b.getX()-e,d),d+=c+4;this.context.textBaseline=g;this.context.textAlign=m;this.context.globalCompositeOperation=h;this.context.restore()};
McxGeodeticGraphics.prototype.drawTextWithBackGround=function(a,b,c,d,e){e=this.context.measureText(a).width/2;var f=this.measureTextHeight(this.context.font,a),g=d.getStroke().getColor();this.context.strokeStyle!=g&&(this.context.strokeStyle=g);g=d.getFill().getColor();this.context.fillStyle!=g&&(this.context.fillStyle=g);this.context.globalAlpha=d.getFill().getOpacity();this.context.lineWidth=d.getStroke().getWidth();d=d.getStroke().getWidth();this.context.fillRect(b.getX()-e-d-2,b.getY()-f-d,2*
e+2*d+2,f+2*d+2);this.context.globalAlpha=1;this.context.strokeRect(b.getX()-e-d-2,b.getY()-f-d,2*e+2*d+2,f+2*d+2);this.context.fillStyle=c.getFill().getColor();this.context.font=c.getFont().toString();this.context.fillText(a,b.getX()-e,b.getY())};McxGeodeticGraphics.prototype.measureTextHeight=function(a,b){this.context.font=a;return this.context.measureText("M").width};
McxGeodeticGraphics.prototype.drawPoint=function(a,b,c,d,e){c=a;this.useTransformation&&(c=this.map.worldToView(a.getX(),a.getY()));c.translate(-d,-e);1>b.getSymbols().length||this.drawSymbol(b.getSymbols()[0],c,b)};
McxGeodeticGraphics.prototype.drawContent=function(a,b){var c=$(a.getContent()).clone();c.addClass("ContentSymbol");var d=this.context.canvas;this.contentDiv.append($(c));var e=d.style.transform;e||(e=d.style.webkitTransform);var f=0,d=0;e&&null!=e&&""!=e&&(f=parseFloat(e.split("(")[1].split(",")[0].replace("px","")),d=parseFloat(e.split("(")[1].split(",")[1].replace("px","")));e=b.getX()+f;d=b.getY()+d;$(c).css("position","absolute").css("left",e-$(c).outerWidth(!0)/2).css("top",d-$(c).outerHeight(!0)/
2).css("transform","rotate("+a.getRotation()+"deg)")};
McxGeodeticGraphics.prototype.drawLineString=function(a,b,c,d,e){if(null!=b.getStroke()){this.context.scale(c,c);null!=b.getStroke().getDashPattern()&&this.context.setLineDash(b.getStroke().getDashPattern());c=b.getStroke().getColor();this.context.strokeStyle!=c&&(this.context.strokeStyle=c);this.context.globalAlpha=b.getStroke().getOpacity();this.context.beginPath();for(c=0;c<a.length;c++){var f=a[c];this.useTransformation&&(f=this.map.worldToView(a[c].x,a[c].y));this.context.lineTo(f.getX()-d,f.getY()-
e)}this.context.lineWidth=b.getStroke().getWidth();this.context.lineCap=b.getStroke().getStartCap();this.context.lineJoin=b.getStroke().getLineJoin();this.context.stroke();this.context.restore();this.context.closePath()}};
McxGeodeticGraphics.prototype.drawLineSegment=function(a,b,c,d,e,f){this.context.save();null!=c.getStroke().getDashPattern()&&this.context.setLineDash(c.getStroke().getDashPattern());d=c.getStroke().getColor();this.context.strokeStyle!=d&&(this.context.strokeStyle=d);this.context.lineWidth=c.getStroke().getWidth();this.context.beginPath();c=a;d=b;this.useTransformation&&(c=this.map.worldToView(a.getX(),a.getY()),d=this.map.worldToView(b.getX(),b.getY()),c.translate(-e,-f),d.translate(-e,-f));this.context.lineTo(c.getX(),
c.getY());this.context.lineTo(d.getX(),d.getY());this.context.stroke();this.context.restore();this.context.closePath()};McxGeodeticGraphics.prototype.drawSymbol=function(a,b,c){a.isInstanceOf("IMcxTextMark")?this.drawTextMark(a,b,c):a.isInstanceOf("IMcxMark")?this.drawMark(a,b,c):a.isInstanceOf("IMcxContentSymbol")&&this.drawContent(a,b)};McxGeodeticGraphics.prototype.drawTextMark=function(a,b,c){};
McxGeodeticGraphics.prototype.drawMark=function(a,b,c){var d=a.getFill(),e=a.getStroke();a.getWellKnownName()==McxWellKnownName.Circle?this.drawCircleSymbol(d,e,b,c):a.getWellKnownName()==McxWellKnownName.Cross?this.drawCrossSymbol(d,e,b,c):a.getWellKnownName()==McxWellKnownName.DiagCross?this.drawDiagCrossSymbol(d,e,b,c):a.getWellKnownName()==McxWellKnownName.Square?this.drawSquareSymbol(d,e,b,c):a.getWellKnownName()==McxWellKnownName.Star?this.drawStarSymbol(d,e,b,c):a.getWellKnownName()==McxWellKnownName.Triangle&&
this.drawTriangleSymbol(d,e,b,c)};
McxGeodeticGraphics.prototype.drawCircleSymbol=function(a,b,c,d){if(null!=b||null!=a){c=this.calculateCenter(c,d,d.getSize());var e=d.getSize();c=this.defineEllipseWithPoints(c.getX(),c.getY(),e,e,0,2*Math.PI);null==c&&this.context.save();d=d.getOpacity();this.context.globalAlpha!=d&&(this.context.globalAlpha=d);null!=b&&(d=b.getColor(),this.context.strokeStyle!=d&&(this.context.strokeStyle=d),d=b.getWidth(),this.context.lineWidth!=d&&(this.context.lineWidth=d));null!=a&&(d=a.getColor(),this.context.fillStyle!=
d&&(this.context.fillStyle=d));this.context.beginPath();for(d=0;d<c.length;d++)c[d].y!=Number.NaN&&c[d].x!=Number.NaN&&(0==d?this.context.moveTo(c[d].getX(),c[d].getY()):this.context.lineTo(c[d].getX(),c[d].getY()));this.context.closePath();null!=a&&this.context.fill();null!=b&&this.context.stroke();this.context.restore()}};
McxGeodeticGraphics.prototype.drawCrossSymbol=function(a,b,c,d){if(null!=a||null!=b){var e=d.getOpacity();e!=this.context.globalAlpha&&(this.context.globalAlpha=e);null!=a&&a.getColor()!=this.context.fillStyle&&(this.context.fillStyle=a.getColor());null!=b&&b.getColor()!=this.context.strokeStyle&&(this.context.strokeStyle=b.getColor());var f=this.calculateCenter(c,d,2*d.getSize());c=d.getSize();var e=f.getX(),f=f.getY(),g=4*c;d=(new McxBounds(e-c/2,f-g/2,e+c/2,f+g/2,null)).getPoints();c=(new McxBounds(e-
g/2,f-c/2,e+g/2,f+c/2,null)).getPoints();this.context.beginPath();for(e=0;e<d.length;e++)d[e].y!=Number.NaN&&d[e].x!=Number.NaN&&(0==e?this.context.moveTo(d[e].getX(),d[e].getY()):this.context.lineTo(d[e].getX(),d[e].getY()));this.context.closePath();null!=a&&this.context.fill();null!=b&&this.context.stroke();this.context.beginPath();for(e=0;e<c.length;e++)c[e].y!=Number.NaN&&c[e].x!=Number.NaN&&(0==e?this.context.moveTo(c[e].getX(),c[e].getY()):this.context.lineTo(c[e].getX(),c[e].getY()));this.context.closePath();
null!=a&&this.context.fill();null!=b&&this.context.stroke()}};
McxGeodeticGraphics.prototype.drawDiagCrossSymbol=function(a,b,c,d){if(null!=b){var e=d.getOpacity();e!=this.context.globalAlpha&&(this.context.globalAlpha=e);null!=a&&(a=a.getColor(),this.context.fillStyle!=a&&(this.context.fillStyle=a));null!=b&&(b.getColor()!=this.context.strokeStyle&&(this.context.strokeStyle=b.getColor()),this.context.lineWidth=4,this.context.lineCap=McxLineCap.Butt);c=this.calculateCenter(c,d,2*d.getSize());d=d.getSize();b=c.getX();c=c.getY();a=2*d/3;d=new McxBounds(b-a,c-d,
b+a,c+d,null);this.context.beginPath();this.context.moveTo(d.getLeft(),d.getTop());this.context.lineTo(d.getRight(),d.getBottom());this.context.closePath();this.context.stroke();this.context.beginPath();this.context.moveTo(d.getLeft(),d.getBottom());this.context.lineTo(d.getRight(),d.getTop());this.context.closePath();this.context.stroke()}};
McxGeodeticGraphics.prototype.drawSquareSymbol=function(a,b,c,d){if(null!=b||null!=a){var e=this.calculateCenter(c,d,2*d.getSize());c=d.getSize();var f=e.getX(),e=e.getY();c=new McxBounds(f-c,e-c,f+c,e+c,null);this.context.save();d=d.getOpacity();d!=this.context.globalAlpha&&(this.context.globalAlpha=d);null!=a&&(d=a.getColor(),this.context.fillStyle!=d&&(this.context.fillStyle=d));null!=b&&b.getColor()!=this.context.strokeStyle&&(this.context.strokeStyle=b.getColor());d=c.getPoints();this.context.beginPath();
for(c=0;c<d.length;c++)d[c].y!=Number.NaN&&d[c].x!=Number.NaN&&(0==c?this.context.moveTo(d[c].getX(),d[c].getY()):this.context.lineTo(d[c].getX(),d[c].getY()));this.context.closePath();null!=a&&this.context.fill();null!=b&&this.context.stroke();this.context.restore()}};
McxGeodeticGraphics.prototype.drawStarSymbol=function(a,b,c,d){if(null!=a||null!=b){var e=this.calculateCenter(c,d,2*d.getSize());d.getSize();c=e.getX();e=e.getY();this.context.save();d=d.getOpacity();d!=this.context.globalAlpha&&(this.context.globalAlpha=d);null!=a&&(d=a.getColor(),this.context.fillStyle!=d&&(this.context.fillStyle=d));null!=b&&b.getColor()!=this.context.strokeStyle&&(this.context.strokeStyle=b.getColor());this.context.beginPath();this.context.translate(c,e);this.context.moveTo(0,
-8);for(c=0;5>c;c++)this.context.rotate(Math.PI/5),this.context.lineTo(0,-4),this.context.rotate(Math.PI/5),this.context.lineTo(0,-8);null!=a&&this.context.fill();null!=b&&this.context.stroke();this.context.restore()}};
McxGeodeticGraphics.prototype.drawTriangleSymbol=function(a,b,c,d){if(null!=a||null!=b){var e=d.getSize(),f=this.calculateCenter(c,d,2*d.getSize());c=f.getX();var g=f.getY(),f=g-e,h=c-e,k=g+e,m=c+e,e=g+e;this.context.save();d=d.getOpacity();d!=this.context.globalAlpha&&(this.context.globalAlpha=d);null!=a&&(d=a.getColor(),this.context.fillStyle!=d&&(this.context.fillStyle=d));null!=b&&b.getColor()!=this.context.strokeStyle&&(this.context.strokeStyle=b.getColor());this.context.beginPath();this.context.moveTo(c,
f);this.context.lineTo(h,k);this.context.lineTo(m,e);this.context.lineTo(c,f);this.context.closePath();null!=a&&this.context.fill();null!=b&&this.context.stroke();this.context.restore()}};McxGeodeticGraphics.prototype.clear=function(){this.context.clearRect(0,0,this.map.getDisplay().getWidth(),this.map.getDisplay().getHeight())};McxGeodeticGraphics.prototype.clearRectangle=function(a,b,c,d){this.context.clearRect(a,b,c,d)};
McxGeodeticGraphics.prototype.clearWithColor=function(a){this.context.save();this.context.fillStyle=a;this.context.fillRect(0,0,this.map.getDisplay().getWidth(),this.map.getDisplay().getHeight());this.context.restore()};McxGeodeticGraphics.prototype.clearRectangleWithColor=function(a,b,c,d,e){this.context.save();this.context.fillStyle=a;this.context.fillRect(b,c,d,e);this.context.restore()};
McxGeodeticGraphics.toDisplay=function(a,b){if(b.isInstanceOf(McxGeometryType.Point))return a.worldToView(b.x,b.y);if(b.isInstanceOf(McxGeometryType.LineString)){for(var c=b.getPoints(),d=[],e=0;e<c.length;e++){var f=a.worldToView(c[e].x,c[e].y);d.push(f)}return new McxLineString(d,null)}if(b.isInstanceOf(McxGeometryType.Polygon)){for(var c=b.getShell().getPoints(),d=[],g=0;g<c.length;g++)f=a.worldToView(c[g].x,c[g].y),d.push(f);for(var d=new McxLinearRing(d,null),h=[],k=b.getHoles(),e=0;e<k.length;e++){for(var c=
k[e].getPoints(),m=[],g=0;g<c.length;g++)f=a.worldToView(c[g].getX(),c[g].getY()),m.push(f);c=new McxLinearRing(m,null);h.push(c)}return new McxPolygon(d,h,null)}if(b.isInstanceOf(McxGeometryType.MultiPoint)){c=b.getPoints();f=[];for(e=0;e<c.length;e++)f.push(McxGeodeticGraphics.toDisplay(a,c[e]));return new McxMultiPoint(f,null)}if(b.isInstanceOf(McxGeometryType.MultiLineString)){c=b.getLines();f=[];for(e=0;e<c.length;e++)f.push(McxGeodeticGraphics.toDisplay(a,c[e]));return new McxMultiLineString(f,
null)}if(b.isInstanceOf(McxGeometryType.MultiPolygon)){c=b.getPolygons();f=[];for(e=0;e<c.length;e++)f.push(McxGeodeticGraphics.toDisplay(a,c[e]));return new McxMultiPolygon(f,null)}return null};McxGeodeticGraphics.prototype.drawImage=function(a,b,c,d,e){this.context.drawImage(a,b,c,d,e)};
McxGeodeticGraphics.prototype.drawCircle=function(a,b,c,d,e,f,g,h,k,m){h=null!=g.getFill();var n=null!=g.getStroke(),p=new McxPoint(a,b,null);this.useTransformation&&(p=this.map.worldToView(a,b));p.translate(-k,-m);a=c;this.useTransformation&&(a=c/this.map.getPixelScale());this.context.save();this.context.beginPath();h&&(c=g.getFill().getColor(),this.context.fillStyle!=c&&(this.context.fillStyle=c),this.context.globalAlpha=g.getFill().getOpacity());n&&(c=g.getStroke().getColor(),c!=this.context.strokeStyle&&
(this.context.strokeStyle=c),this.context.lineWidth=g.getStroke().getWidth());this.context.arc(p.getX(),p.getY(),a,d,e,f);h&&this.context.fill();n&&this.context.stroke()};McxGeodeticGraphics.prototype.useTransform=function(a){this.useTransformation=a};
McxGeodeticGraphics.prototype.defineEllipseWithPoints=function(a,b,c,d,e,f){for(var g=[];e<f;e+=.2){var h=a-c*Math.sin(e)*Math.sin(0*Math.PI)+d*Math.cos(e)*Math.cos(0*Math.PI),k=b+d*Math.cos(e)*Math.sin(0*Math.PI)+c*Math.sin(e)*Math.cos(0*Math.PI);g.push(new McxPoint(h,k,null))}return g};
McxGeodeticGraphics.prototype.getEllipsePoints=function(a,b,c,d){var e=[];e.push(new McxPoint(a+c,b+d,null));e.push(new McxPoint(a-c,b+d,null));e.push(new McxPoint(a+c,b-d,null));e.push(new McxPoint(a-c,b-d,null));return e};
McxGeodeticGraphics.prototype.calculateCenter=function(a,b,c){var d=a.clone(),e=b.getAnchorPoint(),f=b.getDisplacement(),g=e.getAnchorPointX()-.5,e=e.getAnchorPointY()-.5,e=2*c*e;d.translate(2*c*g+f.getDisplacementX(),e+f.getDisplacementY());b=b.getRotation();0!=b&&(d=new McxLineSegment(d.x,d.y,a.x,a.y,null),d.rotate(new McxPoint(a.x,a.y,null),b),d=new McxPoint(d.getStartX(),d.getStartY(),null));return d};McxGeodeticGraphics.prototype.getContext=function(){return this.context};
McxGeodeticGraphics.prototype.setContentDiv=function(a){this.contentDiv=a};js.framework.base.McxCommon.Mapping.McxLayerCollection={};function McxLayerCollection(){this.layers=[];this.activeLayer=null;this.layerAdded=new McxEventHandler;this.layerRemoved=new McxEventHandler;this.layerOrderChangeHandler=new McxEventHandler;this.activeLayerChanged=new McxEventHandler}McxLayerCollection.prototype.getCount=function(){return this.layers.length};McxLayerCollection.prototype.getAt=function(a){return this.layers[a]};
McxLayerCollection.prototype.add=function(a){this.layers.push(a);if(null==this.activeLayer||a.isInstanceOf("McxMemLayer"))this.activeLayer=a,this.activeLayerChanged.dispatchOnSuccess(this,new McxEventArgs(null))};McxLayerCollection.prototype.insert=function(a,b){a>=this.layers.length?this.layers.push(b):this.layers.splice(a,0,b);this.layerAdded.dispatchOnSuccess(this,new McxLayerEventArgs(b))};McxLayerCollection.prototype.getActiveLayer=function(){return this.activeLayer};
McxLayerCollection.prototype.setActiveLayer=function(a){this.activeLayer=a;this.activeLayerChanged.dispatchOnSuccess(this,new McxEventArgs(null))};McxLayerCollection.prototype.removeAt=function(a){var b=this.layers[a];null!=b&&(this.layers.splice(a,1),b.getClassId()==this.activeLayer.getClassId()&&(this.activeLayer=0==this.layers.length?null:this.layers[0],this.activeLayerChanged.dispatchOnSuccess(this,new McxEventArgs(null))),this.layerRemoved.dispatchOnSuccess(this,new McxLayerEventArgs(b)))};
McxLayerCollection.prototype.remove=function(a){var b=this.indexOf(a);if(0>b)return!1;this.layers.splice(b,1);this.layerRemoved.dispatchOnSuccess(this,new McxLayerEventArgs(a));return!0};McxLayerCollection.prototype.indexOf=function(a){for(var b=0;b<this.layers.length;b++)if(this.layers[b].getClassId()==a.getClassId())return b;return-1};McxLayerCollection.prototype.onLayerAdded=function(){return this.layerAdded};McxLayerCollection.prototype.onLayerRemoved=function(){return this.layerRemoved};
McxLayerCollection.prototype.onActiveLayerChanged=function(){return this.activeLayerChanged};McxLayerCollection.prototype.changeOrder=function(a,b){var c=a.getOrder();if(b!=a.getOrder()){this.layers.splice(c,1);var c=this.layers.slice(0,b),d=this.layers.slice(b);c.push(a);this.layers=$.merge(c,d)}this.layerOrderChangeHandler.dispatchOnSuccess(this,null)};McxLayerCollection.prototype.toLayerArray=function(){return this.layers};McxLayerCollection.prototype.setLayerOpacity=function(a,b){a.setOpacity(b)};
McxLayerCollection.prototype.getLayerOrderChangeHandler=function(){return this.layerOrderChangeHandler};js.framework.base.McxCommon.Mapping.McxLineStringPainter={};function McxLineStringPainter(){this.symbolizer=null}McxLineStringPainter.prototype.setSymbolizer=function(a){this.symbolizer=a};McxLineStringPainter.prototype.getSymbolizer=function(){return this.symbolizer};
McxLineStringPainter.prototype.paint=function(a,b,c,d){var e=null,e=null==b.getGeometry().getCoordinateSystem()||null==a.getMap().getCoordinateSystem()||b.getGeometry().getCoordinateSystem().equals(a.getMap().getCoordinateSystem())?b.getGeometry():b.getGeometry().transformTo(a.getMap().getCoordinateSystem()),f=this.symbolizer;null==f&&(f=b.getLayer().getSymbolizer().getLineSymbolizer());a.getGeodeticGraphics().drawLineString(e.getPoints(),f,1,c,d);return!0};
McxLineStringPainter.prototype.isInstanceOf=function(a){return"McxLineStringPainter"==a};js.framework.base.McxCommon.Mapping.McxMultiLinePainter={};function McxMultiLinePainter(){this.symbolizer=null}McxMultiLinePainter.prototype.setSymbolizer=function(a){this.symbolizer=a};McxMultiLinePainter.prototype.getSymbolizer=function(){return this.symbolizer};
McxMultiLinePainter.prototype.paint=function(a,b,c,d){var e=null,e=null==b.getGeometry().getCoordinateSystem()||null==a.getMap().getCoordinateSystem()||b.getGeometry().getCoordinateSystem().equals(a.getMap().getCoordinateSystem())?b.getGeometry():b.getGeometry().transformTo(a.getMap().getCoordinateSystem()),f=this.symbolizer;null==f&&(f=b.getLayer().getSymbolizer().getLineSymbolizer());b=e.getLines();for(e=0;e<b.length;e++)a.getGeodeticGraphics().drawLineString(b[e].getPoints(),f,1,c,d);return!0};
McxMultiLinePainter.prototype.isInstanceOf=function(a){return"McxMultiLinePainter"==a};js.framework.base.McxCommon.Mapping.McxMultiPointPainter={};function McxMultiPointPainter(){this.symbolizer=null}McxMultiPointPainter.prototype.setSymbolizer=function(a){this.symbolizer=a};McxMultiPointPainter.prototype.getSymbolizer=function(){return this.symbolizer};
McxMultiPointPainter.prototype.paint=function(a,b,c,d){var e=null,e=null==b.getGeometry().getCoordinateSystem()||null==a.getMap().getCoordinateSystem()||b.getGeometry().getCoordinateSystem().equals(a.getMap().getCoordinateSystem())?b.getGeometry():b.getGeometry().transformTo(a.getMap().getCoordinateSystem()),e=e.getPoints(),f=this.symbolizer;null==f&&(f=b.getLayer().getSymbolizer().getPointSymbolizer());for(b=0;b<e.length;b++)a.getGeodeticGraphics().drawPoint(e[b],f,1,c,d);return!0};
McxMultiPointPainter.prototype.isInstanceOf=function(a){return"McxMultiPointPainter"==a};js.framework.base.McxCommon.Mapping.McxMultiPolygonPainter={};function McxMultiPolygonPainter(){this.symbolizer=null}McxMultiPolygonPainter.prototype.setSymbolizer=function(a){this.symbolizer=a};McxMultiPolygonPainter.prototype.getSymbolizer=function(){return this.symbolizer};
McxMultiPolygonPainter.prototype.paint=function(a,b,c,d){var e=null,e=null==b.getGeometry().getCoordinateSystem()||null==a.getMap().getCoordinateSystem()||b.getGeometry().getCoordinateSystem().equals(a.getMap().getCoordinateSystem())?b.getGeometry():b.getGeometry().transformTo(a.getMap().getCoordinateSystem()),e=e.getComponents(),f=this.symbolizer;null==f&&(f=b.getLayer().getSymbolizer().getPolygonSymbolizer());for(b=0;b<e.length;b++){var g=e[b].getShell().getPoints();a.getGeodeticGraphics().drawPolygon(g,
f,1,c,d)}return!0};McxMultiPolygonPainter.prototype.isInstanceOf=function(a){return"McxMultiPolygonPainter"==a};js.framework.base.McxCommon.Mapping.McxPaintedFeatures={};function McxPaintedFeatures(a){this.size=a;this.geometries=Array(a);this.cursor=1;this.clear()}McxPaintedFeatures.prototype.getKeyAt=function(a){return Object.keys(this.geometries)[a]};McxPaintedFeatures.prototype.addFeature=function(a,b){if(this.cursor>=this.size)return!0;if(this.geometries[a])return this.geometries[a]=b,!0;this.geometries[a]=b;this.cursor++;return!0};
McxPaintedFeatures.prototype.clear=function(){this.geometries=Array(this.size);this.cursor=1};McxPaintedFeatures.prototype.removeFeature=function(a){};McxPaintedFeatures.prototype.setSize=function(a){this.size=a;this.clear()};McxPaintedFeatures.prototype.elementAt=function(a){return a+1<this.cursor?this.geometries[Object.keys(this.geometries)[a]]:null};McxPaintedFeatures.prototype.getCount=function(){return this.cursor};McxPaintedFeatures.prototype.getAll=function(){return this.geometries};
McxPaintedFeatures.prototype.getElementWithIndex=function(a){return this.geometries[a]};js.framework.base.McxCommon.Mapping.McxPointPainter={};function McxPointPainter(){this.symbolizer=null}McxPointPainter.prototype.setSymbolizer=function(a){this.symbolizer=a};McxPointPainter.prototype.getSymbolizer=function(){return this.symbolizer};
McxPointPainter.prototype.paint=function(a,b,c,d){var e;e=null==b.getGeometry().getCoordinateSystem()||null==a.getMap().getCoordinateSystem()||b.getGeometry().getCoordinateSystem().equals(a.getMap().getCoordinateSystem())?b.getGeometry():b.getGeometry().transformTo(a.getMap().getCoordinateSystem());var f=this.symbolizer;null==f&&(f=b.getLayer().getSymbolizer().getPointSymbolizer());a.getGeodeticGraphics().drawPoint(e,f,1,c,d);return!0};
McxPointPainter.prototype.isInstanceOf=function(a){return"McxPointPainter"==a};js.framework.base.McxCommon.Mapping.McxPolygonPainter={};function McxPolygonPainter(){this.symbolizer=null}McxPolygonPainter.prototype.setSymbolizer=function(a){this.symbolizer=a};McxPolygonPainter.prototype.getSymbolizer=function(){return this.symbolizer};
McxPolygonPainter.prototype.paint=function(a,b,c,d){var e=null,e=b.getGeometry(),e=null==e.getCoordinateSystem()||null==a.getMap().getCoordinateSystem()||b.getGeometry().getCoordinateSystem().equals(a.getMap().getCoordinateSystem())?e:e.transformTo(a.getMap().getCoordinateSystem()),f=e.getShell().getPoints(),g=this.symbolizer;null==g&&(g=b.getLayer().getSymbolizer().getPolygonSymbolizer());a.getGeodeticGraphics().drawPolygonWithHoles(f,e.getHoles(),g,1,c,d);return!0};
McxPolygonPainter.prototype.isInstanceOf=function(a){return"McxPolygonPainter"==a};js.framework.base.McxCommon.Mapping.McxPrintOptions={};function McxPrintOptions(){this._context=null;this._height=this._width=0;this._map=null;this._layers=[];this._bounds=this._ajaxParameter=null;this._fillStyle="";this._smoothingEnabled=!0}McxPrintOptions.prototype.setContext=function(a){this._context=a};McxPrintOptions.prototype.setWidth=function(a){this._width=a};McxPrintOptions.prototype.setHeight=function(a){this._height=a};McxPrintOptions.prototype.setMap=function(a){this._map=a};
McxPrintOptions.prototype.setLayers=function(a){this._layers=a};McxPrintOptions.prototype.setAjaxParameter=function(a){this._ajaxParameter=a};McxPrintOptions.prototype.getContext=function(){return this._context};McxPrintOptions.prototype.getWidth=function(){return this._width};McxPrintOptions.prototype.getHeight=function(){return this._height};McxPrintOptions.prototype.getMap=function(){return this._map};McxPrintOptions.prototype.getLayers=function(){return this._layers};
McxPrintOptions.prototype.setBounds=function(a){this._bounds=a};McxPrintOptions.prototype.getBounds=function(){return this._bounds};McxPrintOptions.prototype.getAjaxParameter=function(){return this._ajaxParameter};McxPrintOptions.prototype.setFillStyle=function(a){this._fillStyle=a};McxPrintOptions.prototype.getFillStyle=function(){return this._fillStyle};McxPrintOptions.prototype.setImageSmoothingEnabled=function(a){this._smoothingEnabled=a};McxPrintOptions.prototype.getImageSmoothingEnabled=function(){return this._smoothingEnabled};js.framework.base.McxCommon.Mapping.McxZoomUndo={};function McxZoomUndo(a,b,c){this.map=a;this.oldWorld=null;this.oldWorld=b.transformTo(this.map.getCoordinateSystem());this.newWorld=null;this.newWorld=c.transformTo(this.map.getCoordinateSystem())}McxZoomUndo.prototype.undo=function(){this.map.setWorld(this.oldWorld.getLeft(),this.oldWorld.getBottom(),this.oldWorld.getRight(),this.oldWorld.getTop());this.map.getRenderer().paintLayer(null,null)};
McxZoomUndo.prototype.redo=function(){this.map.setWorld(this.newWorld.getLeft(),this.newWorld.getBottom(),this.newWorld.getRight(),this.newWorld.getTop());this.map.getRenderer().paintLayer(null,null)};McxZoomUndo.prototype.HasUndo=function(){};McxZoomUndo.prototype.HasRedo=function(){};js.framework.base.McxCommon.Mapping.Marker={};js.framework.base.McxCommon.Mapping.Marker.McxContentMarker={};function McxContentMarker(a,b,c){this.content=c;this.point=a;this.guid=b;this.tag=null;this.transformY=this.transformX=0;this.mouseEnterArgs=this.mouseEnterCallBackFunction=this.args=this.clickCallBackFunction=null;this.minLabelScale=Number.MAX_VALUE;this.maxLabelScale=Number.MIN_VALUE}McxContentMarker.prototype.getMarkerId=function(){return this.guid};
McxContentMarker.prototype.getGeometry=function(){return this.point};McxContentMarker.prototype.setGeometry=function(a){this.point=a};McxContentMarker.prototype.setSymbolizer=function(a){};McxContentMarker.prototype.getSymbolizer=function(){};McxContentMarker.prototype.setClickListener=function(a,b){this.clickCallBackFunction=a;this.args=b};McxContentMarker.prototype.setMouseEnterListener=function(a,b){this.mouseEnterCallBackFunction=a;this.mouseEnterArgs=b};
McxContentMarker.prototype.paint=function(a){if(a.getMap().inVisibleRange(this.minLabelScale,this.maxLabelScale)){var b=this.point.transformTo(a.getMap().getCoordinateSystem()),b=a.getMap().worldToView(b.getX(),b.getY());b.translate(this.transformX,this.transformY);a=a.getMap().getName()+"_markerContainer";$("#"+a).append(this.content);if(null!=this.clickCallBackFunction)this.content.on("click",this.args,$.proxy(this.clickCallBackFunction,this));if(null!=this.mouseEnterCallBackFunction)this.content.on("mouseenter",
this.mouseEnterArgs,$.proxy(this.mouseEnterCallBackFunction,this));this.content.id=this.guid;$(this.content).css("position","absolute").css("left",b.getX()-$(this.content).outerWidth(!0)/2).css("top",b.getY()-$(this.content).outerHeight())}};McxContentMarker.prototype.getTag=function(){return this.tag};McxContentMarker.prototype.setTag=function(a){this.tag=a};McxContentMarker.prototype.setTransformX=function(a){this.transformX=a};
McxContentMarker.prototype.setTransformY=function(a){this.transformY=a};McxContentMarker.prototype.getTransformX=function(){return this.transformX};McxContentMarker.prototype.getTransformY=function(){return this.transformY};McxContentMarker.prototype.getMinLabelScale=function(){return this.minLabelScale};McxContentMarker.prototype.setMinLabelScale=function(a){this.minLabelScale=a};McxContentMarker.prototype.getMaxLabelScale=function(){return this.maxLabelScale};
McxContentMarker.prototype.setMaxLabelScale=function(a){this.maxLabelScale=a};js.framework.base.McxCommon.Mapping.Marker.McxLineSegmentMarker={};function McxLineSegmentMarker(a,b){this.lineSegment=a;this.guid=b;this.symbolizer=new McxLineSymbolizer;this.tag=null;this.minLabelScale=Number.MAX_VALUE;this.maxLabelScale=Number.MIN_VALUE}McxLineSegmentMarker.prototype.getMarkerId=function(){return this.guid};McxLineSegmentMarker.prototype.getGeometry=function(){return this.lineSegment};
McxLineSegmentMarker.prototype.setSymbolizer=function(a){a.isInstanceOf("IMcxLineSymbolizer")&&(this.symbolizer=a)};McxLineSegmentMarker.prototype.getSymbolizer=function(){return this.symbolizer};McxLineSegmentMarker.prototype.paint=function(a){if(a.getMap().inVisibleRange(this.minLabelScale,this.maxLabelScale)){var b=this.lineSegment.transformTo(a.getMap().getCoordinateSystem());a.getGeodeticGraphics().drawLineSegment(b.getStartPoint(),b.getEndPoint(),this.symbolizer,1,0,0)}};
McxLineSegmentMarker.prototype.getTag=function(){return this.tag};McxLineSegmentMarker.prototype.setGeometry=function(a){a.isInstanceOf(McxGeometryType.LineSegment)&&(this.lineSegment=a)};McxLineSegmentMarker.prototype.setTag=function(a){this.tag=a};McxLineSegmentMarker.prototype.getMinLabelScale=function(){return this.minLabelScale};McxLineSegmentMarker.prototype.setMinLabelScale=function(a){this.minLabelScale=a};McxLineSegmentMarker.prototype.getMaxLabelScale=function(){return this.maxLabelScale};
McxLineSegmentMarker.prototype.setMaxLabelScale=function(a){this.maxLabelScale=a};js.framework.base.McxCommon.Mapping.Marker.McxLineStringMarker={};function McxLineStringMarker(a,b){this.lineString=a;this.guid=b;this.symbolizer=new McxLineSymbolizer;this.tag=null;this.minLabelScale=Number.MAX_VALUE;this.maxLabelScale=Number.MIN_VALUE}McxLineStringMarker.prototype.getMarkerId=function(){return this.guid};McxLineStringMarker.prototype.getGeometry=function(){return this.lineString};McxLineStringMarker.prototype.setGeometry=function(a){this.lineString=a};
McxLineStringMarker.prototype.setSymbolizer=function(a){a.isInstanceOf("IMcxLineSymbolizer")&&(this.symbolizer=a)};McxLineStringMarker.prototype.getSymbolizer=function(){return this.symbolizer};McxLineStringMarker.prototype.paint=function(a){if(a.getMap().inVisibleRange(this.minLabelScale,this.maxLabelScale)){var b=this.lineString.transformTo(a.getMap().getCoordinateSystem());a.getGeodeticGraphics().drawLineString(b.getPoints(),this.symbolizer,1,0,0)}};McxLineStringMarker.prototype.getTag=function(){return this.tag};
McxLineStringMarker.prototype.setTag=function(a){this.tag=a};McxLineStringMarker.prototype.getMinLabelScale=function(){return this.minLabelScale};McxLineStringMarker.prototype.setMinLabelScale=function(a){this.minLabelScale=a};McxLineStringMarker.prototype.getMaxLabelScale=function(){return this.maxLabelScale};McxLineStringMarker.prototype.setMaxLabelScale=function(a){this.maxLabelScale=a};js.framework.base.McxCommon.Mapping.Marker.McxMultiLineStringMarker={};function McxMultiLineStringMarker(a,b){this.multiLineString=a;this.guid=b;this.symbolizer=new McxLineSymbolizer;this.tag=null;this.minLabelScale=Number.MAX_VALUE;this.maxLabelScale=Number.MIN_VALUE}McxMultiLineStringMarker.prototype.getMarkerId=function(){return this.guid};McxMultiLineStringMarker.prototype.getGeometry=function(){return this.multiLineString};
McxMultiLineStringMarker.prototype.setGeometry=function(a){this.multiLineString=a};McxMultiLineStringMarker.prototype.setSymbolizer=function(a){a.isInstanceOf("IMcxLineSymbolizer")&&(this.symbolizer=a)};McxMultiLineStringMarker.prototype.getSymbolizer=function(){return this.symbolizer};
McxMultiLineStringMarker.prototype.paint=function(a){if(a.getMap().inVisibleRange(this.minLabelScale,this.maxLabelScale))for(var b=0;b<this.multiLineString.getLines().length;b++){this.multiLineString.getLines();var c=this.multiLineString.getLines()[b].transformTo(a.getMap().getCoordinateSystem());a.getGeodeticGraphics().drawLineString(c.getPoints(),this.symbolizer,1,0,0)}};McxMultiLineStringMarker.prototype.getTag=function(){return this.tag};
McxMultiLineStringMarker.prototype.setTag=function(a){this.tag=a};McxMultiLineStringMarker.prototype.getMinLabelScale=function(){return this.minLabelScale};McxMultiLineStringMarker.prototype.setMinLabelScale=function(a){this.minLabelScale=a};McxMultiLineStringMarker.prototype.getMaxLabelScale=function(){return this.maxLabelScale};McxMultiLineStringMarker.prototype.setMaxLabelScale=function(a){this.maxLabelScale=a};js.framework.base.McxCommon.Mapping.Marker.McxMultiPolygonMarker={};function McxMultiPolygonMarker(a,b){this.multiPolygon=a;this.guid=b;this.symbolizer=new McxPolygonSymbolizer;this.tag=null;this.minLabelScale=Number.MAX_VALUE;this.maxLabelScale=Number.MIN_VALUE}McxMultiPolygonMarker.prototype.getMarkerId=function(){return this.guid};McxMultiPolygonMarker.prototype.getGeometry=function(){return this.multiPolygon};McxMultiPolygonMarker.prototype.setGeometry=function(a){this.multiPolygon=a};
McxMultiPolygonMarker.prototype.setSymbolizer=function(a){a.isInstanceOf("IMcxPolygonSymbolizer")&&(this.symbolizer=a)};McxMultiPolygonMarker.prototype.getSymbolizer=function(){return this.symbolizer};
McxMultiPolygonMarker.prototype.paint=function(a){if(a.getMap().inVisibleRange(this.minLabelScale,this.maxLabelScale))for(var b=this.symbolizer,c=0;c<this.multiPolygon.getComponents().length;c++){var d=this.multiPolygon.getPolygons()[c].transformTo(a.getMap().getCoordinateSystem());a.getGeodeticGraphics().drawPolygon(d.getShell().getPoints(),b,1,0,0)}};McxMultiPolygonMarker.prototype.getTag=function(){return this.tag};McxMultiPolygonMarker.prototype.setTag=function(a){this.tag=a};
McxMultiPolygonMarker.prototype.getMinLabelScale=function(){return this.minLabelScale};McxMultiPolygonMarker.prototype.setMinLabelScale=function(a){this.minLabelScale=a};McxMultiPolygonMarker.prototype.getMaxLabelScale=function(){return this.maxLabelScale};McxMultiPolygonMarker.prototype.setMaxLabelScale=function(a){this.maxLabelScale=a};js.framework.base.McxCommon.Mapping.Marker.McxPointMarker={};function McxPointMarker(a,b){this.point=a;this.guid=b;this.symbolizer=new McxPointSymbolizer;this.tag=null;this.minLabelScale=Number.MAX_VALUE;this.maxLabelScale=Number.MIN_VALUE}McxPointMarker.prototype.getMarkerId=function(){return this.guid};McxPointMarker.prototype.getGeometry=function(){return this.point};McxPointMarker.prototype.setGeometry=function(a){this.point=a};
McxPointMarker.prototype.setSymbolizer=function(a){a.isInstanceOf("IMcxPointSymbolizer")&&(this.symbolizer=a)};McxPointMarker.prototype.getSymbolizer=function(){return this.symbolizer};McxPointMarker.prototype.paint=function(a){if(a.getMap().inVisibleRange(this.minLabelScale,this.maxLabelScale)){var b=this.point.transformTo(a.getMap().getCoordinateSystem());a.getGeodeticGraphics().drawPoint(b,this.symbolizer,1,0,0)}};McxPointMarker.prototype.getX=function(){return this.point.getX()};
McxPointMarker.prototype.getTag=function(){return this.tag};McxPointMarker.prototype.setTag=function(a){this.tag=a};McxPointMarker.prototype.getMinLabelScale=function(){return this.minLabelScale};McxPointMarker.prototype.setMinLabelScale=function(a){this.minLabelScale=a};McxPointMarker.prototype.getMaxLabelScale=function(){return this.maxLabelScale};McxPointMarker.prototype.setMaxLabelScale=function(a){this.maxLabelScale=a};js.framework.base.McxCommon.Mapping.Marker.McxPolygonMarker={};function McxPolygonMarker(a,b){this.polygon=a;this.guid=b;this.symbolizer=new McxPolygonSymbolizer;this.tag=null;this.minLabelScale=Number.MAX_VALUE;this.maxLabelScale=Number.MIN_VALUE}McxPolygonMarker.prototype.getMarkerId=function(){return this.guid};McxPolygonMarker.prototype.getGeometry=function(){return this.polygon};McxPolygonMarker.prototype.setGeometry=function(a){this.polygon=a};
McxPolygonMarker.prototype.setSymbolizer=function(a){a.isInstanceOf("IMcxPolygonSymbolizer")&&(this.symbolizer=a)};McxPolygonMarker.prototype.getSymbolizer=function(){return this.symbolizer};McxPolygonMarker.prototype.paint=function(a){if(a.getMap().inVisibleRange(this.minLabelScale,this.maxLabelScale)){var b=this.polygon.transformTo(a.getMap().getCoordinateSystem());a.getGeodeticGraphics().drawPolygon(b.getShell().getPoints(),this.symbolizer,1,0,0)}};McxPolygonMarker.prototype.getTag=function(){return this.tag};
McxPolygonMarker.prototype.setTag=function(a){this.tag=a};McxPolygonMarker.prototype.getMinLabelScale=function(){return this.minLabelScale};McxPolygonMarker.prototype.setMinLabelScale=function(a){this.minLabelScale=a};McxPolygonMarker.prototype.getMaxLabelScale=function(){return this.maxLabelScale};McxPolygonMarker.prototype.setMaxLabelScale=function(a){this.maxLabelScale=a};js.framework.base.McxCommon.UserControl={};js.framework.base.McxCommon.UserControl.McxUIBehavior={};function McxUIBehavior(a,b){this._isDraggable=a||!1;this._isCloseable=b||!1}McxUIBehavior.prototype.setIsDraggable=function(a){this._isDraggable=a};McxUIBehavior.prototype.setIsCloseable=function(a){this._isCloseable=a};McxUIBehavior.prototype.getIsDraggable=function(){return this._isDraggable};McxUIBehavior.prototype.getIsCloseable=function(){return this._isCloseable};js.framework.base.McxCommon.UserControl.McxUIPosition={};function McxUIPosition(a,b,c){this._x=a||0;this._y=b||0;this._referencePoint=c||McxUIReferencePoint.topLeft}McxUIPosition.prototype.setX=function(a){this._x=a};McxUIPosition.prototype.setY=function(a){this._y=a};McxUIPosition.prototype.setUIReferencePoint=function(a){this._referencePoint=a};McxUIPosition.prototype.getX=function(){return this._x};McxUIPosition.prototype.getY=function(){return this._y};
McxUIPosition.prototype.getUIReferencePoint=function(){return this._referencePoint};js.framework.base.McxCommon.UserControl.McxUIReferencePoint={};var McxUIReferencePoint={topLeft:0,topRight:1,bottomLeft:2,bottomRight:3};js.framework.base.McxCommon.UserControl.McxUserControl={};
function McxUserControl(){this._children=[];this._lastLocaleLanguage="";this._initialDisplay="block";this._isCloseable=this._isDraggable=!1;this._parent=this.___closeButton=null;this._onDropHandler=new McxEventHandler;this._tags=new McxDictionary;this.getContent=this.getContent||mcx.abstractMethod;this._additionalData=new McxDictionary;this._userControlResizeHandleLeft=$("<div/>").addClass("mcx-dialog-resize-handle direction-left");this._userControlResizeHandleRight=$("<div/>").addClass("mcx-dialog-resize-handle direction-right");
this._userControlResizeHandleBottom=$("<div/>").addClass("mcx-dialog-resize-handle direction-bottom");this._userControlResizeHandleTop=$("<div/>").addClass("mcx-dialog-resize-handle direction-top");this._userControlMoveEndEventHandler=new McxEventHandler;this._userControlMoveStartEventHandler=new McxEventHandler;this._userControlMoveEventHandler=new McxEventHandler}
McxUserControl.prototype.enableResize=function(a,b,c,d,e){if(a=a||this.getContent()){0!=b&&a.append(this._userControlResizeHandleLeft);0!=c&&a.append(this._userControlResizeHandleRight);0!=d&&a.append(this._userControlResizeHandleTop);0!=e&&a.append(this._userControlResizeHandleBottom);a.addClass("resize-enabled");a.data("startY",null);a.data("startX",null);a.data("startOffset",null);a.data("startHeight",null);a.data("startWidth",null);a.data("resizeDirection",null);McxUserControl.delegateEvent(window,
"mousedown",this._userControlResizeHandleLeft[0],function(){a.data("resizeDirection","H_L")},!0);McxUserControl.delegateEvent(window,"mousedown",this._userControlResizeHandleRight[0],function(){a.data("resizeDirection","H_R")},!0);McxUserControl.delegateEvent(window,"mousedown",this._userControlResizeHandleBottom[0],function(){a.data("resizeDirection","V_B")},!0);McxUserControl.delegateEvent(window,"mousedown",this._userControlResizeHandleTop[0],function(){a.data("resizeDirection","V_T")},!0);b=function(a){this.resizeContent.data("startY",
a.pageY);this.resizeContent.data("startX",a.pageX);this.resizeContent.data("startOffset",this.resizeContent.offset());this.resizeContent.data("startHeight",this.resizeContent.height());this.resizeContent.data("startWidth",this.resizeContent.width());McxUserControl.___isResizing=!0;window.addEventListener("mouseup",h,!0);window.addEventListener("mousemove",k,!0);a.stopPropagation()};McxUserControl.delegateEvent(window,"mousedown",this._userControlResizeHandleLeft[0],$.proxy(b,{resizeContent:a,self:this}),
!0);McxUserControl.delegateEvent(window,"mousedown",this._userControlResizeHandleRight[0],$.proxy(b,{resizeContent:a,self:this}),!0);McxUserControl.delegateEvent(window,"mousedown",this._userControlResizeHandleBottom[0],$.proxy(b,{resizeContent:a,self:this}),!0);McxUserControl.delegateEvent(window,"mousedown",this._userControlResizeHandleTop[0],$.proxy(b,{resizeContent:a,self:this}),!0);var f=function(a){this.resizeContent.data("startY",null);this.resizeContent.data("startX",null);this.resizeContent.data("startOffset",
null);this.resizeContent.data("startHeight",null);this.resizeContent.data("startWidth",null);this.resizeContent.data("resizeDirection",null);McxUserControl.___isResizing=!1;$(window)[0].removeEventListener("mousemove",g,!0);$(window)[0].removeEventListener("mouseup",f,!0);this.self.updateLayout()},g=function(a){if(McxUserControl.___isResizing){var b=this.resizeContent,c=b.data("resizeDirection");if("V_B"==c||"V_T"==c)a=a.pageY-b.data("startY"),"V_B"==c&&b.height(b.data("startHeight")+a),"V_T"==c&&
(b.height(b.data("startHeight")-a),b.offset({top:b.data("startOffset").top+a}));else if("H_L"==c||"H_R"==c){c="H_L"==c;a=a.pageX-b.data("startX");a*=c?-1:1;var d=b.data("startWidth")+a;240>d&&d<b.data("startWidth")||(b.width(d),c&&b.offset({left:b.data("startOffset").left-a}))}}else window.removeEventListener("mousemove",k,!0),window.removeEventListener("mouseup",h,!0)},h=$.proxy(f,{resizeContent:a,self:this}),k=$.proxy(g,{resizeContent:a,self:this})}};
McxUserControl.prototype.addChild=function(a,b,c){var d=b.getParent();d!=this&&(d&&d.detachChild(b),c=c||McxUserControlAddMethod.append,c==McxUserControlAddMethod.append?a.append(b.getContent()):a.prepend(b.getContent()),this.registerChild(b))};McxUserControl.prototype.getParent=function(){return this._parent};McxUserControl.prototype.getParents=function(){var a=this._parent;if(!a)return null;var b=[a];return(a=a.getParents())?b.concat(a):b};
McxUserControl.prototype.getParentsOfType=function(a){var b=this.getParents();if(!b)return null;for(var c=[],d=0;d<b.length;d++)mcx.isInstanceOf(b[d],a)&&(c[c.length]=b[d]);return c};McxUserControl.prototype.setParent=function(a){this._parent=a};McxUserControl.prototype.registerChild=function(a){mcx.isInstanceOf(a,McxUserControl)&&(McxUserControl.registerLocalePath(a),this._children[this._children.length]=a,a.setParent(this))};
McxUserControl.prototype.removeChild=function(a){var b=this._children.indexOf(a);this._children.splice(b,1);a.getContent().remove()};McxUserControl.prototype.remove=function(){var a=this.getParent();a?a.removeChild(this):this.getContent().remove()};McxUserControl.prototype.detach=function(){var a=this.getParent();a?a.detachChild(this):this.getContent().detach()};McxUserControl.prototype.detachChild=function(a){var b=this._children.indexOf(a);this._children.splice(b,1);a.setParent(null);a.getContent().detach()};
McxUserControl.prototype.removeAllChildren=function(){for(;0<this._children.length;)this.removeChild(this._children[0])};McxUserControl.prototype.removeAllChildrenOfType=function(a){a=this.getInnerChildrenOfType(a);for(var b=0;b<a.length;b++)a[b].remove()};McxUserControl.prototype.detachAllChildren=function(){for(;0<this._children.length;)this.detachChild(this._children[0])};McxUserControl.prototype.detachChildrenOfType=function(a){a=this.getChildrenOfType(a);for(var b=0;b<a.length;b++)this.detachChild(a[b])};
McxUserControl.prototype.injectLocalizationKey=function(a,b){a.attr("data-localize",b)};McxUserControl.prototype.getChildren=function(){return this._children};McxUserControl.prototype.setAdditionalData=function(a,b){this._additionalData.setValue(a,b)};McxUserControl.prototype.getAdditionalData=function(a){return this._additionalData.getValue(a)};
McxUserControl.prototype.getChildrenOfType=function(a){for(var b=[],c=0;c<this._children.length;c++)mcx.isInstanceOf(this._children[c],a)&&(b[b.length]=this._children[c]);return b};McxUserControl.prototype.getInnerChildrenOfType=function(a){for(var b=[],c=0;c<this._children.length;c++)b=b.concat(this._children[c].getInnerChildrenOfType(a));return b.concat(this.getChildrenOfType(a))};
McxUserControl.prototype.getInnerChildren=function(){for(var a=[],b=0;b<this._children.length;b++)a=a.concat(this._children[b].getInnerChildren());return a.concat(this.getChildren())};McxUserControl.prototype.getContent=mcx.abstractMethod;McxUserControl.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};McxUserControl.prototype.downloadLocalizationFile=function(){this._lastLocaleLanguage=McxLocalizationManager.getLanguage();McxLocalizationManager.downloadPath(this.getLocalizationPath())};
McxUserControl.prototype.getLocaleValue=function(a){McxLocalizationManager.getLocaleValue(a)!=a&&this._lastLocaleLanguage==McxLocalizationManager.getLanguage()||this.downloadLocalizationFile();return McxLocalizationManager.getLocaleValue(a)};
McxUserControl.prototype.localize=function(){McxLocalizationManager.localizeContent(this.getContent(),this.getLocalizationPath());for(var a={},b=this.getInnerChildren(),c=0;c<b.length;c++)b[c]&&(a[b[c].getLocalizationPath()]=b[c].getLocalizationPath());for(var d in a)McxLocalizationManager.localizeContent(this.getContent(),d)};McxUserControl.prototype.dispose=function(){for(var a=0;a<this._children.length;a++)this._children[a].dispose();this.getContent().remove()};
McxUserControl.prototype.show=function(){"none"==this.getContent().css("display")&&this.getContent().css("display",this._initialDisplay)};McxUserControl.prototype.css=function(a,b){this.getContent().css(a,b);return this};McxUserControl.prototype.addClass=function(a){this.getContent().addClass(a);return this};McxUserControl.prototype.toggleClass=function(a){this.getContent().toggleClass(a);return this};McxUserControl.prototype.removeClass=function(a){this.getContent().removeClass(a);return this};
McxUserControl.prototype.hide=function(){var a=this.getContent().css("display").toString();this._initialDisplay="none"!=a?a:this._initialDisplay;this.getContent().css("display","none")};
McxUserControl.prototype.visibleArea=function(a){a=a||this.getContent()[0];for(var b=a.offsetHeight,c=a.offsetWidth,d=a.offsetTop||0,e=a.offsetLeft||0,f=a.offsetParent,g,h,k;null!==(a=a.parentNode);)try{if((g=window.getComputedStyle(a))&&"hidden"===g.overflow)return h=a.offsetHeight-d,k=a.offsetWidth-e,a!==f&&(h+=a.offsetTop||0,k+=a.offsetLeft||0),h<b&&(b=0>h?0:h),k<c&&(c=0>k?0:k),new McxSize(c,b);a===f&&(d+=a.offsetTop||0,e+=a.offsetLeft||0,f=a.offsetParent)}catch(m){}return new McxSize(c,b)};
McxUserControl.prototype.addChildControl=function(a,b,c){var d=b.getUIReferencePoint(),e=d==McxUIReferencePoint.topLeft||d==McxUIReferencePoint.topRight?b.getY()+"px":"auto",f=d==McxUIReferencePoint.bottomLeft||d==McxUIReferencePoint.bottomRight?b.getY()+"px":"auto",g=d==McxUIReferencePoint.topLeft||d==McxUIReferencePoint.bottomLeft?b.getX()+"px":"auto";b=d==McxUIReferencePoint.topRight||d==McxUIReferencePoint.bottomRight?b.getX()+"px":"auto";a.css("top",e.toString());a.css("bottom",f.toString());
a.css("left",g.toString());a.css("right",b.toString());a.css("position","absolute");e=this.getContent();f=e.css("position");"absolute"!=f&&"relative"!=f&&"fixed"!=f&&e.css("position","relative");this.addChild(e,a);c&&(a.setIsMovable(c.getIsDraggable()),a.setIsClosable(c.getIsCloseable()))};McxUserControl.prototype.removeChildControl=function(a){this.removeChild(a)};
McxUserControl.prototype.setIsMovable=function(a,b,c){this._isDraggable!=a&&(b=b||this.getContent(),c=c||this.getContent(),(this._isDraggable=a)?(b.addClass("mcx-drag-handle"),c.addClass("mcx-draggable"),this.getContent().on("mcxmovestart",$.proxy(function(){this.getMoveStartEventHandler().dispatchOnSuccess(this,new McxEventArgs(null))},this)),this.getContent().on("mcxmoveend",$.proxy(function(){this.getMoveEndEventHandler().dispatchOnSuccess(this,new McxEventArgs(null))},this)),this.getContent().on("mcxmove",
$.proxy(function(){this.getMoveEventHandler().dispatchOnSuccess(this,new McxEventArgs(null))},this))):(b.removeClass("mcx-drag-handle"),c.removeClass("mcx-draggable")))};McxUserControl.prototype.getMoveStartEventHandler=function(){return this._userControlMoveStartEventHandler};McxUserControl.prototype.getMoveEndEventHandler=function(){return this._userControlMoveEndEventHandler};McxUserControl.prototype.getMoveEventHandler=function(){return this._userControlMoveEventHandler};
McxUserControl.prototype.setIsClosable=function(a){this._isCloseable!=a&&(this._isCloseable=a,this.getContent().addClass("mcx-closable"),a?this.___closeButton?this.___closeButton.show():(a=new McxButton,a.setImage("img-close16"),a.setButtonSize(McxButtonSize.small),a.setButtonVisualType(McxButtonVisualType.linkButton),a.getContent().addClass("mcx-closeable-button"),a.css("margin","0").css("padding","0"),this.addChildControl(a,new McxUIPosition(-14,-9,McxUIReferencePoint.topRight)),this.___closeButton=
a,this.___closeButton.getClickHandler().addListener(function(){this.dispose()},null,this)):this.___closeButton&&this.___closeButton.hide())};McxUserControl.prototype.setAttributeValue=function(a,b){this.getContent().attr(a,b)};McxUserControl.prototype.setCssDisplay=function(a){this.getContent().css("display",a)};McxUserControl.prototype.updateLayout=function(){};McxUserControl.prototype.setTag=function(a,b){this._tags.setValue(a,b)};McxUserControl.prototype.getTagValue=function(a){return this._tags.getValue(a)};
McxUserControl.initialize=function(){$(document).ready(function(){McxUserControl.___isResizing=!1;McxUserControl.___dragging=null;McxUserControl.___registeredPaths={};document.body.addEventListener("mousemove",function(a){if(McxUserControl.___dragging&&!McxUserControl.___isResizing){var b=McxUserControl.___dragging.data("dragStartOffset");b||(b={x:a.pageX-McxUserControl.___dragging.offset().left,y:a.pageY-McxUserControl.___dragging.offset().top},McxUserControl.___dragging.data("dragStartOffset",b));
var c=a.pageY-b.y;a=a.pageX-b.x;var b=c+McxUserControl.___dragging.height(),d=a+McxUserControl.___dragging.width();0>c&&(c=0);0>a&&(a=0);$("body").width()<d&&(a=$("body").width()-McxUserControl.___dragging.width());$("body").height()<b&&(c=$("body").height()-McxUserControl.___dragging.height());McxUserControl.___dragging.css({bottom:"auto",right:"auto"}).offset({top:0>c?0:c,left:0>a?0:a});McxUserControl.___dragging.trigger("mcxmove")}},!0);McxUserControl.delegateEvent(document.body,"mousedown",".mcx-draggable",
function(a){McxUserControl.___isResizing||0<$(this).find(".mcx-drag-handle").length||(McxUserControl.___dragging=$(this),McxUserControl.___dragging.data("dragStartOffset",{x:a.pageX-McxUserControl.___dragging.offset().left,y:a.pageY-McxUserControl.___dragging.offset().top}),McxUserControl.___dragging.trigger("mcxmovestart"))},!0);McxUserControl.delegateEvent(document.body,"mousedown",".mcx-drag-handle",function(a){McxUserControl.___isResizing||($(this).hasClass("mcx-draggable")?McxUserControl.___dragging=
$(this):McxUserControl.___dragging=$(this).parents(".mcx-draggable"),McxUserControl.___dragging.data("dragStartOffset",{x:a.pageX-McxUserControl.___dragging.offset().left,y:a.pageY-McxUserControl.___dragging.offset().top}),McxUserControl.___dragging.trigger("mcxmovestart"),a.stopPropagation())},!0);document.body.addEventListener("mouseup",function(){McxUserControl.___dragging&&(McxUserControl.___dragging.data("dragStartOffset",null),McxUserControl.___dragging.trigger("mcxmoveend"));McxUserControl.___dragging=
null},!0)})};McxUserControl.registerLocalePath=function(a){a=a.getLocalizationPath();McxUserControl.___registeredPaths[a]||McxLocalizationManager.addLocalePath(a);McxUserControl.___registeredPaths[a]=!0};
McxUserControl.prototype.enableDropping=function(a){a=a||this.getContent();a.bind("dragenter",$.proxy(function(a){a.preventDefault();$(".state-dragover").removeClass("state-dragover");this.getContent().addClass("state-dragover")},this)).bind("dragover",$.proxy(function(a){0==this.getContent().hasClass("state-dragover")&&this.getContent().addClass("state-dragover");a.preventDefault()},this)).bind("dragleave",$.proxy(function(b){b.preventDefault();a.removeClass("state-dragover")},this)).bind("drop",
$.proxy(function(b){b.preventDefault();$(".state-dragover").removeClass("state-dragover");$(".state-dragging").removeClass("state-dragging");if(!($(b.target).hasClass("state-dragging")||0<$(b.target).parents(".state-dragging").length)){var c=$(window).data("drag-item");c!=this&&mcx.isDefAndNotNull(c)&&(c=new McxDropEventArgs(c,a),this.onDrop().dispatchOnSuccess(this,c),c.getIsHandled()&&b.stopPropagation())}},this))};
McxUserControl.prototype.enableDragging=function(a){a=a||this.getContent();a.prop("draggable",!0).bind("dragstart",$.proxy(function(a){a.originalEvent.dataTransfer.setData("URL","anything");this.getContent().addClass("state-dragging");$(window).data("drag-item",this);a.stopPropagation()},this)).bind("drag",$.proxy(function(a){},this)).bind("dragend",$.proxy(function(a){this.getContent().removeClass("state-dragging")},this))};
McxUserControl.enableDragging=function(a){a.prop("draggable",!0).bind("dragstart",function(a){a.originalEvent.dataTransfer.setData("URL","anything");$(this).addClass("state-dragging");$(window).data("drag-item",$(this));a.stopPropagation()}).bind("drag",function(a){}).bind("dragend",function(a){$(this).removeClass("state-dragging")})};McxUserControl.disableDragging=function(a){a.prop("draggable",!1)};McxUserControl.prototype.onDrop=function(){return this._onDropHandler};
McxUserControl.prototype.enable=function(){this.getContent().removeClass("mcx-user-control-state-disabled")};McxUserControl.prototype.disable=function(){var a=this.getContent();"static"==a.css("position")&&a.css("position","relative");0==a.children(".mcx-user-control-overlay").length&&a.append($("<div/>").addClass("mcx-user-control-overlay"));a.addClass("mcx-user-control-state-disabled")};
McxUserControl.prototype.getIsDisabled=function(){return this.getContent().hasClass("mcx-user-control-state-disabled")||!1};
McxUserControl.delegateEvent=function(a,b,c,d,e){a.addEventListener(b,$.proxy(function(a){var b=mcx.isInstanceOf(this.delegateSelector,Element);b&&this.delegateSelector==a.target&&this.callback.call(a.target,a);!b&&(0<$(a.target).parents(this.delegateSelector).length||$(a.target).is(this.delegateSelector))&&this.callback.call($(a.target).parents(this.delegateSelector)[0]||a.target,a)},{delegateSelector:c,callback:d}),e)};McxUserControl.initialize();js.framework.base.McxCommon.Dialog.McxDialogBase={};
function McxDialogBase(){mcx.base(this);this.base=this;this._size=null;this._submitEventHandler=new McxEventHandler;this._onCloseDialogHandler=new McxEventHandler;this._onDialogShownHandler=new McxEventHandler;this._dialogElem=$("<div/>").addClass("mcx-dialog visibility-hidden no-buttons").prop("tabindex","0").addClass("mcx-draggable");this._dialogTitle=$("<div/>").addClass("mcx-dialog-title");this._dialogToolButtonClose=$("<div/>").addClass("mcx-dialog-header-tool-button role-close");this._dialogToolButtonMaximize=
$("<div/>").addClass("mcx-dialog-header-tool-button role-maximize");this._dialogToolButtonMinimize=$("<div/>").addClass("mcx-dialog-header-tool-button role-minimize");this._dialogFooter=$("<div/>").addClass("mcx-dialog-footer");this._dialogBody=$("<div/>").addClass("mcx-dialog-body");this._dialogResizeHandleLeft=$("<div/>").addClass("mcx-dialog-resize-handle direction-left");this._dialogResizeHandleRight=$("<div/>").addClass("mcx-dialog-resize-handle direction-right");this._dialogResizeHandleBottom=
$("<div/>").addClass("mcx-dialog-resize-handle direction-bottom");this._dialogCancelButton=new McxButton;this._dialogOkButton=new McxButton;this._dialogContent=null;this._defaultDialogLocalizationPath=McxPathFinder.getFullPath("$McxCommon/Dialog/locale/mcxDialog");this._onMoveStartEventHandler=new McxEventHandler;this._onMoveEndEventHandler=new McxEventHandler;this._onCloseButtonClickHandler=new McxEventHandler;this._maximizeButtonClikEventHandler=new McxEventHandler;this._acceptButton=null;this._isInitialized=
!1;this.createDialogElem();this.bindBaseDialogEvents()}mcx.inherits(McxDialogBase,McxUserControl);McxDialogBase.prototype.getDialogImageUrl=function(){return""};McxDialogBase.prototype.initialize=function(){};McxDialogBase.prototype.onCloseDialog=function(){return this._onCloseDialogHandler};McxDialogBase.prototype.onDialogShown=function(){return this._onDialogShownHandler};McxDialogBase.prototype.onClose=function(){};
McxDialogBase.prototype.enableResize=function(){this._dialogElem.addClass("resize-enabled");var a=this,b,c,d,e,f,g,h=!1;this._dialogResizeHandleLeft.mousedown(function(){g="H_L"});this._dialogResizeHandleRight.mousedown(function(){g="H_R"});this._dialogResizeHandleBottom.mousedown(function(){g="V"});var k=function(g){b=g.pageY;c=g.pageX;d=a._dialogElem.offset();e=a._dialogBody.height();f=a._dialogElem.width();h=!0;$("body").mouseup(m);$("body").mousemove(n)};this._dialogResizeHandleLeft.mousedown(k);
this._dialogResizeHandleRight.mousedown(k);this._dialogResizeHandleBottom.mousedown(k);var m=function(k){g=e=f=d=c=b=null;h=!1;$("body").unbind("mousemove",n);$("body").unbind("mouseup",m);a.updateLayout()},n=function(k){if(!h)$("body").unbind("mousemove",n),$("body").unbind("mouseup",m);else if("V"==g)a._dialogBody.height(e+(k.pageY-b));else if("H_L"==g||"H_R"==g){var q="H_L"==g;k=k.pageX-c;k*=q?-1:1;var r=f+k;240>r&&r<f||(a._dialogElem.width(r),q&&a._dialogElem.offset({left:d.left-k}))}}};
McxDialogBase.prototype.clearEasyUiPanels=function(){$(".mcx-gradient-select-box-list").detach()};McxDialogBase.prototype.hideEasyUiPanels=function(){$(".mcx-gradient-select-box-list").css("display","none")};McxDialogBase.prototype.creationComplete=function(){};McxDialogBase.prototype.getDialogMaxHeight=function(){return"auto"};McxDialogBase.prototype.getDialogMinHeight=function(){return 30};McxDialogBase.prototype.getDialogHeight=function(){return"auto"};McxDialogBase.prototype.getDialogSize=function(){return this._size};
McxDialogBase.prototype.setDialogSize=function(a){this._size=a;this.updateDialogSize()};McxDialogBase.prototype.getLocalizationPath=function(){};McxDialogBase.prototype.setLocaleFolderPath=function(a){};McxDialogBase.prototype.getDialogTitle=function(){};McxDialogBase.prototype.getContent=function(){return this._dialogContent};McxDialogBase.prototype.setContent=function(a){this._dialogContent=a};
McxDialogBase.prototype.setAsActiveDialog=function(){this._dialogElem.hasClass("state-active")||($(".mcx-dialog.state-active").removeClass("state-active"),this._dialogElem.addClass("state-active"))};
McxDialogBase.prototype.showDialog=function(a,b){a?this._dialogElem.addClass("state-modal"):this._dialogElem.removeClass("state-modal");b&&this.enableResize();if(this.getIsSingleInstance()&&McxDialogBase.isExistDialogOfType(this.constructor))McxDialogBase.getExistDialogOfType(this.constructor).show();else{if(0==this._dialogElem.parents("body").length){var c=this;$("body").append(c._dialogElem);setTimeout(function(){c._dialogElem.focus();c._dialogElem.removeClass("anim-show").removeClass("anim-suspend");
c._dialogElem.css("opacity",0);c._dialogElem.removeClass("visibility-hidden");0==c._dialogElem.offset().top&&0==c._dialogElem.offset().left?c.centralizeDialog():c.repositionIfDialogOverlows();c.updateLayout();c._dialogElem.css("opacity",1);c._dialogElem.addClass("anim-show")},25)}0>McxDialogBase._currentDialogs.indexOf(this)&&McxDialogBase._currentDialogs.push(this);this._isInitialized||(this.initialize(),this._dialogBody.append(this.getContent()),this.creationComplete(),this.enableHotKeys(),this._isInitialized=
!0);this.update();this.focusFirstInput();this.setAsActiveDialog();this.onDialogShown().dispatchOnSuccess(this,null)}};McxDialogBase.prototype.getIsShown=function(){return 0<this._dialogElem.parents("body").length&&0==this._dialogElem.hasClass("visibility-hidden")&&0==this._dialogElem.parents(".mcx-dialog-minimize-container").length};
McxDialogBase.prototype.addFooterButton=function(a){this._dialogElem.hasClass("no-buttons")&&this._dialogElem.removeClass("no-buttons");a.setButtonSize(McxButtonSize.medium);a.getButtonState()==McxButtonState.predefined&&a.setButtonState(McxButtonState.active);this.base.addChild(this._dialogFooter,a)};McxDialogBase.prototype.createAndAddFooterButton=function(a,b){var c=new McxButton;c.setText(a);b&&c.setLocalizationKey(b);this.addFooterButton(c);return c};
McxDialogBase.prototype.bindBaseDialogEvents=function(){function a(a){a.stopPropagation()}this._dialogElem.keydown(a);this._dialogElem.keypress(a);this._dialogElem.keyup(a);this.onCloseDialog().addListener(function(){$(".mcx-map-focus-fix").focus()},null,this);this._dialogElem.bind("mcxmoveend",$.proxy(function(){0==this._dialogElem.hasClass("size-fullscreen")&&this.onMoveEnd().dispatchOnSuccess(this,null)},this));this._dialogElem.bind("mcxmovestart",$.proxy(function(){0==this._dialogElem.hasClass("size-fullscreen")&&
this.onMoveStart().dispatchOnSuccess(this,null)},this));this._submitEventHandler.addListener(function(a){if(a.getIsValidated()){for(var b=this.base.getInnerChildrenOfType(McxValidatableControl),e=!0,f=0;f<b.length;f++){var g=b[f];g.getIsDisabled()||(e=e&&g.validate())}a.setIsValidated(e)}},null,this);this._dialogOkButton.getClickHandler().addListener(function(){var a=new McxSubmitEventArgs;this.getSubmitHandler().dispatchOnSuccess(this,a);a.getIsValidated()&&this.close()},null,this);this._dialogOkButton.getClickHandler().addListener(this.onOkButtonClick,
null,this);this._dialogCancelButton.getClickHandler().addListener(this.onCancelButtonClick,null,this);this._dialogCancelButton.getClickHandler().addListener(this.close,null,this);this._dialogToolButtonClose.click($.proxy(function(){this.getCloseButtonClickHandler().dispatchOnSuccess(this,null);this.onCloseButtonClick();this.close()},this));this._dialogToolButtonMaximize.click($.proxy(this.toggleMaximize,this));this._dialogToolButtonMinimize.click($.proxy(this.minimize,this));var b=function(a){a.stopPropagation()};
this._dialogToolButtonClose.mousedown(b);this._dialogToolButtonMaximize.mousedown(b);this._dialogToolButtonMinimize.mousedown(b)};McxDialogBase.prototype.toggleMaximize=function(){this._dialogElem.toggleClass("size-fullscreen");this.updateLayout();this.getMaximizeButtonClickHandler().dispatchOnSuccess(this,null)};McxDialogBase.prototype.minimize=function(){McxDialogBase.minimizeDialog(this);this.clearEasyUiPanels()};McxDialogBase.prototype.maximize=function(){this._dialogElem.addClass("size-fullscreen")};
McxDialogBase.prototype.updateDialogTitle=function(){this._dialogTitle.prop("title",this.getDialogTitle()).html(this.getDialogTitle()).attr("data-localize-for","title,content").attr("data-localize",this.getDialogTitle())};
McxDialogBase.prototype.updateDialogSize=function(){this._dialogElem.removeClass("size-auto").removeClass("size-small").removeClass("size-medium").removeClass("size-large").removeClass("size-large").removeClass("size-xlarge").removeClass("size-xxlarge");switch(this._size||this.getDialogSize()||McxDialogSize.auto){case McxDialogSize.auto:this._dialogElem.addClass("size-auto");break;case McxDialogSize.small:this._dialogElem.addClass("size-small");break;case McxDialogSize.medium:this._dialogElem.addClass("size-medium");
break;case McxDialogSize.large:this._dialogElem.addClass("size-large");break;case McxDialogSize.xlarge:this._dialogElem.addClass("size-xlarge");break;case McxDialogSize.xxlarge:this._dialogElem.addClass("size-xxlarge")}this._dialogBody.css({height:this.getDialogHeight(),"max-height":this.getDialogMaxHeight(),"min-height":this.getDialogMinHeight()})};
McxDialogBase.prototype.createToolButtons=function(a){var b=this.getDialogToolButtons();b&&b!=McxDialogToolButtons.all&&b!=McxDialogToolButtons.minimize&&b!=McxDialogToolButtons.closeMinimize&&b!=McxDialogToolButtons.minimizeMaximize||a.append(this._dialogToolButtonMinimize);b&&b!=McxDialogToolButtons.all&&b!=McxDialogToolButtons.maximize&&b!=McxDialogToolButtons.closeMaximize&&b!=McxDialogToolButtons.minimizeMaximize||a.append(this._dialogToolButtonMaximize);b&&b!=McxDialogToolButtons.all&&b!=McxDialogToolButtons.close&&
b!=McxDialogToolButtons.closeMinimize&&b!=McxDialogToolButtons.closeMaximize||a.append(this._dialogToolButtonClose)};
McxDialogBase.prototype.createDialogElem=function(){var a=$("<div/>").addClass("mcx-dialog-header").addClass("mcx-drag-handle"),b=$("<div/>").addClass("mcx-dialog-header-image"),c=$("<div/>").addClass("mcx-dialog-header-tool-container");this._dialogCancelButton.setText("Cancel");this._dialogCancelButton.setLocalizationKey("mcxDialogCancel");this._dialogOkButton.setText("Ok");this._dialogOkButton.setLocalizationKey("mcxDialogOk");this._dialogElem.append(a).append(this._dialogBody).append(this._dialogFooter).append(this._dialogResizeHandleLeft).append(this._dialogResizeHandleRight).append(this._dialogResizeHandleBottom).append($("<div/>").addClass("mcx-dialog-overlay"));
a.append(b).append(this._dialogTitle).append(c);this.createToolButtons(c);this._dialogFooter.hide(0)};McxDialogBase.prototype.getDialogElement=function(){return this._dialogElem};McxDialogBase.prototype.getContainerElement=function(){return this._dialogBody};McxDialogBase.prototype.getFooterElement=function(){return this._dialogFooter};McxDialogBase.prototype.getSubmitHandler=function(){return this._submitEventHandler};McxDialogBase.prototype.getOkButtonClickHandler=function(){return this._dialogOkButton.getClickHandler()};
McxDialogBase.prototype.getMaximizeButtonClickHandler=function(){return this._maximizeButtonClikEventHandler};McxDialogBase.prototype.getCancelButtonClickHandler=function(){return this._dialogCancelButton.getClickHandler()};McxDialogBase.prototype.getCloseButtonClickHandler=function(){return this._onCloseButtonClickHandler};McxDialogBase.prototype.onMoveEnd=function(){return this._onMoveEndEventHandler};McxDialogBase.prototype.onMoveStart=function(){return this._onMoveStartEventHandler};
McxDialogBase.prototype.update=function(){this.updateDialogTitle();this.updateDialogSize();this.updateDialogButtons();McxLocalizationManager.localizeContent(this._dialogElem,this.getLocalizationPath());McxLocalizationManager.localizeContent(this._dialogElem,this._defaultDialogLocalizationPath);this.base.localize()};
McxDialogBase.prototype.updateDialogButtons=function(){if(this.getDialogButtons()==McxDialogButtons.ok||this.getDialogButtons()==McxDialogButtons.okCancel)this._acceptButton=this._acceptButton||this._dialogOkButton,this.addFooterButton(this._dialogOkButton);this.getDialogButtons()!=McxDialogButtons.cancel&&this.getDialogButtons()!=McxDialogButtons.okCancel||this.addFooterButton(this._dialogCancelButton)};McxDialogBase.prototype.setDialogPosition=function(a,b){this._dialogElem.offset({top:b,left:a})};
McxDialogBase.prototype.getDialogPosition=function(){var a=this._dialogElem.offset();return new McxUIPosition(a.left,a.top)};McxDialogBase.prototype.close=function(){this._dialogElem.find($(".mcx-dialog-overlay").css("opacity",0));this._dialogElem.addClass("visibility-hidden");this.onCloseDialog().dispatchOnSuccess(this,null);this.clearEasyUiPanels();this.onClose();var a=McxDialogBase._currentDialogs.indexOf(this);-1<a&&McxDialogBase._currentDialogs.splice(a,1);this._dialogElem.detach()};
McxDialogBase.prototype.hide=function(){this._dialogElem.addClass("visibility-hidden")};
McxDialogBase.prototype.show=function(){if(this.getIsShown()){var a=this.__minimizeBox;$("body").append(this.getDialogElement().removeClass("anim-suspend"));McxDialogBase.removeItem.call(a);this.getDialogElement().addClass("mcx-draggable")}else $("body").append(this.getDialogElement().removeClass("anim-suspend")),McxDialogBase.removeItem.call(this.__minimizeBox),this.getDialogElement().addClass("mcx-draggable"),this.onCloseDialog().removeListener(McxDialogBase.removeItem)};
McxDialogBase.prototype.updateLayout=function(){};McxDialogBase.prototype.focusFirstInput=function(){setTimeout(mcx.proxy(function(){var a=this.getContent().find("input:not([disabled])");0<a.length?a.eq(0).focus():0<this._dialogFooter.find(".mcx-button").length?this._dialogFooter.find(".mcx-button:last").focus():this._dialogElem.focus()},this),200)};
McxDialogBase.prototype.setTitle=function(a,b){this._dialogTitle.prop("title",a).html(a).removeAttr("data-localize");b&&this._dialogTitle.attr("data-localize",b).attr("data-localize-for","title,content");this.getDialogTitle=function(){return a}};McxDialogBase.prototype.setAsIdle=function(){this._dialogElem.removeClass("state-busy")};McxDialogBase.prototype.setAsBusy=function(){this._dialogElem.addClass("state-busy")};
McxDialogBase.prototype.setOkButtonEnabled=function(a){a?this._dialogOkButton.setButtonState(McxButtonState.active):this._dialogOkButton.setButtonState(McxButtonState.disabled)};McxDialogBase.prototype.setVisibility=function(a){a?this._dialogElem.removeClass("visibility-hidden"):this._dialogElem.addClass("visibility-hidden")};
McxDialogBase.prototype.centralizeDialog=function(){this._dialogElem.offset({top:($("body").height()-this._dialogElem.height())/2,left:($("body").width()-this._dialogElem.width())/2});this.repositionIfDialogOverlows()};McxDialogBase.prototype.repositionIfDialogOverlows=function(){var a=this._dialogElem.offset(),b=$("body").height(),c=$("body").width(),d=this._dialogElem.height(),e=this._dialogElem.width();a.top+d>b&&(a.top=b-d);a.left+e>c&&(a.left=c-e);0>a.top&&(a.top=0);0>a.left&&(a.left=0);this._dialogElem.offset(a)};
McxDialogBase.prototype.getDialogButtons=function(){return McxDialogButtons.ok};McxDialogBase.prototype.getIsSingleInstance=function(){return!0};McxDialogBase.prototype.setOkButtonText=function(a,b){this._dialogOkButton.setText(a);b&&this._dialogOkButton.setLocalizationKey(b)};McxDialogBase.prototype.setCancelButtonText=function(a,b){this._dialogCancelButton.setText(a);b&&this._dialogCancelButton.setLocalizationKey(b)};McxDialogBase.prototype.disableOkButton=function(){this._dialogOkButton.setButtonState(McxButtonState.disabled)};
McxDialogBase.prototype.disableCancelButton=function(){this._dialogCancelButton.setButtonState(McxButtonState.disabled)};McxDialogBase.prototype.enableOkButton=function(){this._dialogOkButton.setButtonState(McxButtonState.active)};McxDialogBase.prototype.enableCancelButton=function(){this._dialogCancelButton.setButtonState(McxButtonState.active)};McxDialogBase.prototype.onOkButtonClick=function(){};McxDialogBase.prototype.onCancelButtonClick=function(){};
McxDialogBase.prototype.onCloseButtonClick=function(){};McxDialogBase._currentDialogs=[];McxDialogBase.isExistDialogOfType=function(a){for(var b=McxDialogBase._currentDialogs,c=0;c<b.length;c++)if(b[c].constructor==a)return!0;return!1};McxDialogBase.getExistDialogOfType=function(a){for(var b=McxDialogBase._currentDialogs,c=0;c<b.length;c++){var d=b[c];if(d.constructor==a)return d}return null};McxDialogBase.prototype.setAsFullscreen=function(){this._dialogElem.addClass("size-fullscreen")};
McxDialogBase.prototype.enableHotKeys=function(){var a=this,b=this._dialogBody.find("input, select");b.keydown(function(c){c.keyCode==McxKeyCode.enter&&(c=b.filter(function(){return $(this).is(":visible")&&"hidden"!=$(this).css("visibility")}),c=c.eq(c.index($(this))+1),0<c.length?c.eq(0).focus():a._acceptButton&&a._acceptButton.getButtonState()!=McxButtonState.disabled&&a._acceptButton.getContent().is(":visible")&&a._acceptButton.getClickHandler().dispatchOnSuccess(a,null))});this._dialogElem.keyup(function(b){b.keyCode==
McxKeyCode.escape&&a.close()});this._dialogElem.focus(function(){a.setAsActiveDialog()});this._dialogElem.blur(function(a){})};McxDialogBase.prototype.setAcceptButton=function(a){this._acceptButton=a};McxDialogBase.prototype.getDialogState=function(){return this._dialogElem.hasClass("size-fullscreen")?McxDialogState.fullscreen:McxDialogState.windowed};McxDialogBase.prototype.getDialogToolButtons=function(){return McxDialogToolButtons.all};
McxDialogBase.removeItem=function(){$(this).remove();0==McxDialogBase.__minimeContainer.find(".mcx-dialog-minimize-box").length&&McxDialogBase.__minimeContainer.addClass("state-empty").removeClass("state-open")};
McxDialogBase.minimizeDialog=function(a){McxDialogBase.__minimeContainer.removeClass("state-blink");a.getDialogElement().addClass("anim-suspend");var b=$("<div/>").addClass("mcx-dialog-minimize-box").append(a.getDialogElement());a.__minimizeBox=b;a.getDialogElement().removeClass("mcx-draggable");McxDialogBase.__minimeContainer.append(b.click($.proxy(function(a){a.stopPropagation();a=this.dialog;var b=this.minimizeBox;$("body").append(a.getDialogElement().removeClass("anim-suspend"));McxDialogBase.removeItem.call(b);
a.getDialogElement().addClass("mcx-draggable");a.onCloseDialog().removeListener(McxDialogBase.removeItem)},{dialog:a,minimizeBox:b})));a.onCloseDialog().addListener(McxDialogBase.removeItem,null,b);setTimeout(function(){McxDialogBase.__minimeContainer.removeClass("state-empty").addClass("state-blink")},5)};
McxDialogBase.initializeDialogBase=function(){$(document).ready(function(){McxDialogBase.__minimeContainer||(McxDialogBase.__minimeContainer=$("<div/>").addClass("mcx-dialog-minimize-container state-empty"),McxDialogBase.__minimeContainer[0].addEventListener("mouseenter",function(){$(this).addClass("state-open")}),McxDialogBase.__minimeContainer[0].addEventListener("mouseleave",function(){$(this).removeClass("state-open")}),$("body").append(McxDialogBase.__minimeContainer))})};McxDialogBase.initializeDialogBase();
var McxDialogSize={auto:0,small:1,medium:2,large:3,xlarge:4,xxlarge:5},McxDialogButtons={none:0,ok:1,cancel:2,okCancel:3},McxDialogState={windowed:0,fullscreen:1,minimized:2},McxDialogToolButtons={none:1,minimize:2,maximize:3,close:4,closeMinimize:5,closeMaximize:6,minimizeMaximize:7,all:8};js.framework.base.McxCommon.Dialog.McxDialog={};function McxDialog(){mcx.base(this);this.base=this;this.getHtmlPageUrl=this.getHtmlPageUrl||mcx.abstractMethod;this._dialogContent=null}mcx.inherits(McxDialog,McxDialogBase);McxDialog.prototype.getContent=function(){0==mcx.isDefAndNotNull(this._dialogContent)&&this.loadContent();return this._dialogContent};
McxDialog.prototype.loadContent=function(){if(0!=mcx.isInstanceOf(this,McxDialog)){var a=this,b=function(b){a.base.setContent($(b))},c=function(){McxMessageBox.show(null,"McxDialog-DialogNotLoadedError",McxMessageBoxType.Error)};mcx.isInstanceOf(this,McxDialog)&&McxAjaxServiceCall.getAjaxCall(McxPathFinder.getFullPath(this.getHtmlPageUrl()),null,null,"text",!0,null,!1,b,c)}};js.framework.base.McxCommon.Dialog.MessageBox.McxMessageBox={};
function McxMessageBox(a,b,c,d){mcx.base(this);this._buttons=mcx.isDefAndNotNull(d)?d:McxDialogButtons.ok;this.title=a;this.message=b;this.type=c||McxMessageBoxType.Information;this.infoImageClass="mcx-message-box-info";this.warningImageClass="mcx-message-box-warning";this.errorImageClass="mcx-message-box-error";this.confirmImageClass="mcx-message-box-confirm";this._messageBoxMessageElement=this._messageBoxImageElement=this._content=null;this.cssSelectorInput="#mcxMessageBoxValue";this._messageBoxResult=
McxMessageBoxResult.None;this._messageBoxResultHandler=new McxEventHandler;this.base=this}mcx.inherits(McxMessageBox,McxDialogBase);McxMessageBox.prototype.setMessageResult=function(a){this._messageBoxResult=a;this.getMessageResultHandler().dispatchOnSuccess(this,new McxMessageBoxResultArgs(this._messageBoxResult))};
McxMessageBox.prototype.bindEvents=function(){this.base.getOkButtonClickHandler().addListener(function(){this.setMessageResult(McxMessageBoxResult.Ok)},null,this);this.base.getCancelButtonClickHandler().addListener(function(){this.setMessageResult(McxMessageBoxResult.Cancel)},null,this);this.base.getCloseButtonClickHandler().addListener(function(){this.setMessageResult(McxMessageBoxResult.None)},null,this)};
McxMessageBox.prototype.initialize=function(){this._messageBoxImageElement=$("<div/>").addClass("");this._messageBoxMessageElement=$("<div/>").css("padding-right","15px").addClass("");var a=$("<div/>").addClass("vcenter").addClass("mcx-row-fluid"),b=$("<div/>").addClass("mcx-span2");b.append(this._messageBoxImageElement);var c=$("<div/>").addClass("mcx-span10");c.append(this._messageBoxMessageElement);c.css("text-align","center");c.css("margin-left","-20px");c.css("padding-left","15px");a.append(b);
a.append(c);this._content=$("<div/>").append(a);this.setMessageType(this.type);this.setMessage(this.message);this.bindEvents();this.base.getDialogElement().addClass("mcx-message-box")};McxMessageBox.prototype.setMessageType=function(a){a=a==McxMessageBoxType.Confirm?this.confirmImageClass:a==McxMessageBoxType.Error?this.errorImageClass:a==McxMessageBoxType.Information?this.infoImageClass:this.warningImageClass;this._messageBoxImageElement.removeClass().addClass("mcx-message-box-image").addClass(a)};
McxMessageBox.prototype.setMessage=function(a){this._messageBoxMessageElement.html(a)};McxMessageBox.prototype.getDialogButtons=function(){return this._buttons};McxMessageBox.prototype.getIsSingleInstance=function(){return!1};McxMessageBox.prototype.getMessageResultHandler=function(){return this._messageBoxResultHandler};McxMessageBox.prototype.getDialogTitle=function(){return this.title};McxMessageBox.prototype.getValue=function(){return $(this.cssSelectorInput).val().toString()};
McxMessageBox.prototype.getLocalizationPath=function(){return"$McxCommon/Dialog/MessageBox/locale/mcxMessageBox"};McxMessageBox.prototype.getContent=function(){return this._content};McxMessageBox.prototype.getMessageResult=function(){return this._messageBoxResult};
McxMessageBox.show=function(a,b,c,d){c=c||McxMessageBoxType.Information;if(0==mcx.isDefAndNotNull(a)||""==a)switch(c){case McxMessageBoxType.Confirm:a="mcxMessageBoxConfirm";d=d||McxDialogButtons.okCancel;break;case McxMessageBoxType.Error:a="mcxMessageBoxError";break;case McxMessageBoxType.Warning:a="mcxMessageBoxWarning";break;default:a="mcxMessageBoxInformation"}a=new McxMessageBox(a.toString(),b,c,d);a.showDialog(!0);return a};McxMessageBox.prototype.getDialogSize=function(){return McxDialogSize.medium};js.framework.base.McxCommon.UserControl.McxDropEventArgs={};function McxDropEventArgs(a,b){mcx.base(this);this._dragItem=a;this._dropElement=b;this._isHandled=!1}mcx.inherits(McxDropEventArgs,McxEventArgs);McxDropEventArgs.prototype.getDragItem=function(){return this._dragItem};McxDropEventArgs.prototype.getDropElement=function(){return this._dropElement};McxDropEventArgs.prototype.stopPropagation=function(){return this._isHandled=!0};McxDropEventArgs.prototype.getIsHandled=function(){return this._isHandled};js.framework.base.McxCommon.UserControl.McxUserControlAddMethod={};var McxUserControlAddMethod={append:0,prepend:1};js.framework.base.McxCommon.UserControl.McxUserControlDisplay={};var McxUserControlDisplay={none:"none",block:"block",inline:"inline",inlineBlock:"inline-block"};js.framework.base.McxCommon.UserControl.McxValidatableControl={};function McxValidatableControl(){mcx.base(this);this.base=this;this._isRequired=!1;this._notEqualValue=this._exactValue=this._maxValue=this._minValue=null;this._customValidaters=[];this._changeEventHandler=new McxEventHandler}mcx.inherits(McxValidatableControl,McxUserControl);McxValidatableControl.prototype.isRequired=function(a){this._isRequired=a};
McxValidatableControl.prototype.isInRange=function(a,b){this._minValue=a;this._maxValue=b};McxValidatableControl.prototype.isEqualTo=function(a){this._exactValue=a};McxValidatableControl.prototype.isNotEqualTo=function(a){this._notEqualValue=a};McxValidatableControl.prototype.addCustomValidator=function(a){this._customValidaters.push(a)};McxValidatableControl.prototype.getValue=function(){alert("Unimplemented Method : McxValidatableControl.prototype.getValue")};
McxValidatableControl.prototype.setValue=mcx.abstractMethod;
McxValidatableControl.prototype.validate=function(){var a=this.getValue(),b=!0;1==this._isRequired&&(!mcx.isDefAndNotNull(a)||""==a||"Number"==a.constructor.name&&isNaN(a))&&(b=!1);null!=this._exactValue&&this._exactValue!=a&&(b=!1);null!=this._notEqualValue&&this._notEqualValue==a&&(b=!1);null!=this._maxValue&&a>this._maxValue&&(b=!1);null!=this._minValue&&a<this._minValue&&(b=!1);if(0<this._customValidaters.length)for(var c=0;c<this._customValidaters.length;c++)if(!this._customValidaters[c].call(this,a)){b=
!1;break}b?this.base.removeClass("mcx-user-control-invalid"):(console.log({isValid:!1,control:this}),this.base.addClass("mcx-user-control-invalid"));return b};McxValidatableControl.prototype.getChangeEventHandler=function(){return this._changeEventHandler};js.framework.base.McxCommon.UserControl.Button={};js.framework.base.McxCommon.UserControl.Button.McxButton={};
function McxButton(){mcx.base(this);this.base=this;this._buttonLabelElement=this._buttonImageElement=this._rootElement=null;this._clickHandler=new McxEventHandler;this._mouseDownHandler=new McxEventHandler;this._buttonSize=McxButtonSize.small;this._buttonFontSize=McxButtonFontSize.normal;this._buttonVisaulType=McxButtonVisualType.button;this._buttonState=McxButtonState.predefined;this.initialize()}mcx.inherits(McxButton,McxUserControl);
McxButton.prototype.initialize=function(){this._rootElement=$("<div/>").addClass("mcx-button-no-label").addClass("mcx-button-no-image").addClass("mcx-button").prop("tabindex","0");this._buttonImageElement=$("<div/>").css("display","none").addClass("mcx-button-image");this._buttonLabelElement=$("<div/>").css("display","none").addClass("mcx-button-label");this._rootElement.append(this._buttonImageElement);this._rootElement.append(this._buttonLabelElement);this._rootElement.keypress($.proxy(this.onKeyPress,
this));this._rootElement.click($.proxy(this.onClick,this));this._rootElement.mousedown($.proxy(this.onMouseDown,this))};
McxButton.prototype.setImage=function(a){0==mcx.isDefAndNotNull(a)?(this._rootElement.addClass("mcx-button-no-image"),this._buttonImageElement.css("display","none")):(-1<a.indexOf(".png")||-1<a.indexOf(".gif")||-1<a.indexOf(".jpg")?this._buttonImageElement.removeClass().addClass("mcx-button-image").css("background-image",'url("'+McxPathFinder.getFullPath(a)+'")'):this._buttonImageElement.removeClass().addClass("mcx-button-image").addClass(a),this._buttonImageElement.css("display","inline-block"),
this._rootElement.removeClass("mcx-button-no-image"))};McxButton.prototype.setFontSize=function(a){this._buttonFontSize=a;this._rootElement.removeClass("font-small").removeClass("font-normal").removeClass("font-large").removeClass("font-xlarge");switch(a){case McxButtonFontSize.small:this._rootElement.addClass("font-small");break;case McxButtonFontSize.large:this._rootElement.addClass("font-large");break;case McxButtonFontSize.xlarge:this._rootElement.addClass("font-xlarge")}};
McxButton.prototype.setText=function(a){0==mcx.isDefAndNotNull(a)?(this._rootElement.addClass("mcx-button-no-label"),this._buttonLabelElement.css("display","none")):(this._buttonLabelElement.html(a),this._buttonLabelElement.css("display","inline-block"),this._rootElement.remove("mcx-button-no-label"))};McxButton.prototype.setLocalizationKey=function(a){this.base.injectLocalizationKey(this._buttonLabelElement,a)};
McxButton.prototype.onKeyPress=function(a){this.getButtonState()==McxButtonState.disabled||a.keyCode!=McxKeyCode.enter&&a.keyCode!=McxKeyCode.space||(a.stopPropagation(),this.getClickHandler().dispatchOnSuccess(this,null))};McxButton.prototype.onClick=function(){this._buttonState!=McxButtonState.disabled&&this.getClickHandler().dispatchOnSuccess(this,null)};McxButton.prototype.onMouseDown=function(){this._buttonState!=McxButtonState.disabled&&this.getMouseDownHandler().dispatchOnSuccess(this,null)};
McxButton.prototype.setButtonSize=function(a){this._buttonSize=a;this._rootElement.removeClass("size-small").removeClass("size-medium").removeClass("size-large").removeClass("size-xlarge");switch(a){case McxButtonSize.small:this._rootElement.addClass("size-small");break;case McxButtonSize.medium:this._rootElement.addClass("size-medium");break;case McxButtonSize.large:this._rootElement.addClass("size-large");break;case McxButtonSize.xlarge:this._rootElement.addClass("size-xlarge")}};
McxButton.prototype.setButtonVisualType=function(a){this._buttonVisaulType=a;this._rootElement.removeClass("type-link-button");a==McxButtonVisualType.linkButton&&this._rootElement.addClass("type-link-button")};
McxButton.prototype.setButtonState=function(a){this._buttonState=a;this._rootElement.removeClass("state-active").removeClass("state-normal").removeClass("state-danger").removeClass("state-error").removeClass("state-default").removeClass("state-disabled");switch(a){case McxButtonState.active:this._rootElement.addClass("state-active");break;case McxButtonState.disabled:this._rootElement.addClass("state-disabled");break;case McxButtonState.danger:this._rootElement.addClass("state-danger");break;case McxButtonState.error:this._rootElement.addClass("state-error");
break;case McxButtonState.normal:this._rootElement.addClass("state-normal");break;default:case McxButtonState.predefined:this._rootElement.addClass("state-default")}};McxButton.prototype.getButtonState=function(){return this._buttonState};McxButton.prototype.focus=function(){this._rootElement.focus()};McxButton.prototype.getClickHandler=function(){return this._clickHandler};McxButton.prototype.getMouseDownHandler=function(){return this._mouseDownHandler};
McxButton.prototype.setIsFullWidth=function(a){a?this._rootElement.addClass("fit"):this._rootElement.removeClass("fit")};McxButton.prototype.getContent=function(){return this._rootElement};McxButton.prototype.setData=function(a,b){this._rootElement.data(a,b)};McxButton.prototype.getData=function(a){return this._rootElement.data(a)};McxButton.prototype.getButtonImageContent=function(){return this._buttonImageElement};js.framework.base.McxCommon.UserControl.Button.McxButtonFontSize={};var McxButtonFontSize={small:0,normal:1,large:2,xlarge:3};js.framework.base.McxCommon.UserControl.Button.McxButtonSize={};var McxButtonSize={small:0,medium:1,large:2,xlarge:3};js.framework.base.McxCommon.UserControl.Button.McxButtonVisualType={};var McxButtonVisualType={button:0,linkButton:1};
js.framework.base.McxSystem={};js.framework.base.McxSystem.McxCoordinateSystemFactory={};function McxCoordinateSystemFactory(){}McxCoordinateSystemFactory.prototype.createCoordinateSystem=function(a){return 0==a?null:new McxCoordinateSystem(a)};js.framework.base.McxSystem.McxCoordinateTransformFactory={};function McxCoordinateTransformFactory(){}McxCoordinateTransformFactory.prototype.createCoordinateTransform=function(){return new McxCoordinateTransform};js.framework.base.McxSystem.McxFactoryFinder={};
var McxFactoryFinder={_drawingPointCount:-1,CoordinateSystemFactory:function(){return new McxCoordinateSystemFactory},GeometryFactory:function(a){0>McxFactoryFinder._drawingPointCount&&McxFactoryFinder.setDrawingPointCount();a=new McxGeometryFactory(a);a.setDrawingPointCount(McxFactoryFinder._drawingPointCount);return a},TransformFactory:function(){return new McxCoordinateTransformFactory},StyleFactory:function(){return new McxStyleFactory},setDrawingPointCount:function(){var a=64,b=McxSettingsManager.read("DrawSettings",
null).getSettings(),c="";b&&0<b.length&&(c=JSON.parse(b[0]),a=parseInt(c.AreaDrawPointCount,10));McxFactoryFinder._drawingPointCount=8<a?a:64}};js.framework.base.McxSystem.McxGeometryFactory={};function McxGeometryFactory(a){this.coordinateSystem=a;this._drawingPointCount=64}McxGeometryFactory.prototype.createPolygon=function(a,b){if(null!=b){var c;return new McxPolygon(a,b,this.coordinateSystem)}a.isInstanceOf&&a.isInstanceOf(McxGeometryType.LinearRing)?c=a:(c=a.getPoints(),c.push(c[0]),c=this.createLinearRing(c));return new McxPolygon(c,null,this.coordinateSystem)};
McxGeometryFactory.prototype.createLineString=function(a){return new McxLineString(a,this.coordinateSystem)};McxGeometryFactory.prototype.createLineSegment=function(a,b){return new McxLineSegment(a.getX(),a.getY(),b.getX(),b.getY(),this.coordinateSystem)};McxGeometryFactory.prototype.createPoint=function(a,b){return new McxPoint(a,b,this.coordinateSystem)};McxGeometryFactory.prototype.createBounds=function(a,b,c,d){return new McxBounds(a,b,c,d,this.coordinateSystem)};
McxGeometryFactory.prototype.createLinearRing=function(a){return new McxLinearRing(a,this.coordinateSystem)};McxGeometryFactory.prototype.createSize=function(a,b){return new McxSize(a,b)};McxGeometryFactory.prototype.createMultiPolygon=function(a){return new McxMultiPolygon(a,this.coordinateSystem)};McxGeometryFactory.prototype.createMultiLineString=function(a){return new McxMultiLineString(a,this.coordinateSystem)};
McxGeometryFactory.prototype.createMultiPoint=function(a){return new McxMultiPoint(a,this.coordinateSystem)};McxGeometryFactory.prototype.createEllipse=function(a,b,c,d){a=this.defineEllipseWithPoints(a,b,c,d,0,2*Math.PI);if(null==a||0>=a.length)return new McxLinearRing([],this.coordinateSystem);a.push(a[0]);return new McxLinearRing(a,this.coordinateSystem)};
McxGeometryFactory.prototype.defineEllipseWithPoints=function(a,b,c,d,e,f){if(null!=this.coordinateSystem){var g=this.coordinateSystem.getDistancePerUnit();c/=g;d/=g}for(g=[];e<f;e+=2*Math.PI/this._drawingPointCount){var h=a-c*Math.sin(e)*Math.sin(0*Math.PI)+d*Math.cos(e)*Math.cos(0*Math.PI),k=b+d*Math.cos(e)*Math.sin(0*Math.PI)+c*Math.sin(e)*Math.cos(0*Math.PI);g.push(new McxPoint(h,k,this.coordinateSystem))}return g};
McxGeometryFactory.prototype.getEllipsePoints=function(a,b,c,d){var e=[];e.push(new McxPoint(a+c,b+d,this.coordinateSystem));e.push(new McxPoint(a-c,b+d,this.coordinateSystem));e.push(new McxPoint(a+c,b-d,this.coordinateSystem));e.push(new McxPoint(a-c,b-d,this.coordinateSystem));return e};McxGeometryFactory.prototype.createEllipticArc=function(a,b,c,d,e,f){e=McxMath.degreeToRadian(e);f=McxMath.degreeToRadian(f);a=this.defineEllipseWithPoints(a,b,c,d,e,f);return new McxLineString(a,this.coordinateSystem)};
McxGeometryFactory.prototype.setDrawingPointCount=function(a){this._drawingPointCount=a};
js.framework.driver={};js.framework.driver.McxMemDriver={};js.framework.driver.McxMemDriver.McxFieldPair={};function McxFieldPair(a,b){this._fieldDefinition=a;this._value=b}McxFieldPair.prototype.getFieldDefinition=function(){return this._fieldDefinition};McxFieldPair.prototype.getValue=function(){return this._value};McxFieldPair.prototype.setFieldDefinition=function(a){this._fieldDefinition=a};McxFieldPair.prototype.setValue=function(a){this._value=a};js.framework.driver.McxMemDriver.McxMemDataSource={};function McxMemDataSource(a,b){mcx.base(this,a,b);this._domains=[]}mcx.inherits(McxMemDataSource,McxAbstractDataSource);McxMemDataSource.prototype.testCapability=function(a){};McxMemDataSource.prototype.getName=function(){return"McxMemDataSource"};McxMemDataSource.prototype.createLayer=function(a,b,c,d){d=new McxMemLayer(this);d.setName(a);d.setCoordinateSystem(b);d.setGeometryType(c);return d};
McxMemDataSource.prototype.getDomains=function(a){var b=new McxGetDomainsResult;b.setDomains(this._domains);a.getAsync()&&a.getSuccess().call(a.getScope(),b);return b};McxMemDataSource.prototype.getDomain=function(a,b){var c=new McxGetDomainResult;this._domains.some(function(b){b.getDomainName()==a&&c.setDomain(b)});b.getAsync()&&b.getSuccess().call(b.getScope(),c);return c};McxMemDataSource.prototype.setDomains=function(a){this._domains=a};js.framework.driver.McxMemDriver.McxMemDriver={};function McxMemDriver(){}McxMemDriver.prototype.openDataSource=function(a){if(""==a&&null==a)return null;a+="@@@";var b=new McxOpenDataSourceResult;a=new McxMemDataSource(this,a);b.setDataSource(a);return b};McxMemDriver.prototype.getDriverID=function(){return"{0EE691BA-AB24-49EB-A7DA-44573B80B087}"};McxMemDriver.prototype.getName=function(){return"MapCodeX Memory Driver"};
McxMemDriver.prototype.testCapability=function(a){return a==McxCapabilityNames.CanCreateLayer?!0:!1};McxMemDriver.prototype.isInstanceOf=function(a){return"IMcxDriver"==a||"McxMemDriver"==a};McxMemDriver.prototype.getDataSourceInfo=function(a,b){};McxMemDriver.prototype.getLayerInfo=function(a,b,c,d,e){};js.framework.driver.McxMemDriver.McxMemEdit={};function McxMemEdit(a){this._vectorLayer=a}McxMemEdit.prototype.insert=function(a,b){return this.insertRange([a],b)};McxMemEdit.prototype.insertRange=function(a,b){var c=new McxFeatureCancelEventArgs(this._vectorLayer,a,b.getArgs());this._vectorLayer.onFeatureInserting(c);return c.isCanceled()?(b.getAsync()&&b.getError().call(b.getScope(),new McxCommitResult),new McxCommitResult):this._vectorLayer.insertFeatures(a,b)};
McxMemEdit.prototype.update=function(a,b){return this.updateRange([a],b)};McxMemEdit.prototype.updateRange=function(a,b){return this._vectorLayer.updateFeatures(a,b)};McxMemEdit.prototype.delete=function(a,b){return this._vectorLayer.deleteFeatures([a],b)};McxMemEdit.prototype.deleteRange=function(a,b){return this._vectorLayer.deleteFeatures(a,b)};McxMemEdit.prototype.deleteFeature=function(a,b){return this.deleteFeatureRange([a],b)};
McxMemEdit.prototype.deleteFeatureRange=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(a[d].getFeatureID());return this.deleteRange(c,b)};js.framework.driver.McxMemDriver.McxMemFeature={};function McxMemFeature(a,b){this._layer=a;this._changedValues={};this._values={};this._symbolizer=null;this._geometryField=a.getGeometryField();this._keyField=a.getKeyField();this._symbolizerField=a.getSymbolizerField();this._schema=b;this.initialize(b)}
McxMemFeature.prototype.initialize=function(a){if(null==a){a=this._layer.getSchema().getFieldCount();for(var b=0;b<a;b++){var c=this._layer.getSchema().getField(b),d=new McxFieldPair(c,void 0);this._values[c.getFieldName()]=d;this._changedValues[c.getFieldName()]=!1}}else for(b=0;b<a.getFieldCount();b++)c=a.getField(b),d=new McxFieldPair(c,null),this._values[c.getFieldName()]=d,this._changedValues[c.getFieldName()]=!1};
McxMemFeature.prototype.getSymbolizer=function(){return this._values[this._symbolizerField]?this._values[this._symbolizerField].getValue():null};McxMemFeature.prototype.setSymbolizer=function(a){this._values[this._symbolizerField]&&(this._values[this._symbolizerField].setValue(a),this._changedValues[this._symbolizerField]=!0)};McxMemFeature.prototype.addField=function(a,b){var c=new McxFieldPair(a,b);this._values[a.getFieldName()]=c};
McxMemFeature.prototype.getGeometry=function(){var a=this._values[this._geometryField];return a&&null!=a?this._values[this._geometryField].getValue():null};McxMemFeature.prototype.setGeometry=function(a){this._values[this._layer.getGeometryField()]&&(this._values[this._layer.getGeometryField()].setValue(a),this._changedValues[this._layer.getGeometryField()]=!0)};McxMemFeature.prototype.getFieldCount=function(){return Object.keys(this._values).length};
McxMemFeature.prototype.getField=function(a){var b=a;"number"==typeof a&&(b=this.getFieldName(a));return(a=this._values[b])?a.getFieldDefinition():null};McxMemFeature.prototype.getValueWithName=function(a){return this._values[a].getValue()};McxMemFeature.prototype.getFieldName=function(a){return Object.keys(this._values)[a]};McxMemFeature.prototype.getGlobalID=function(){return this._layer.getGuidField()?this.getValue(this._layer.getGuidField()):""};
McxMemFeature.prototype.setGlobalID=function(a){this.setValue(this._layer.getGuidField(),a);this._changedValues[this._layer.getGuidField()]=!0};McxMemFeature.prototype.getFieldOrdinal=function(a){return Object.keys(this._values).indexOf(a)||0};McxMemFeature.prototype.getLayer=function(){return this._layer};McxMemFeature.prototype.getFeatureID=function(){return void 0==this._values[this._keyField].getValue()?-1:this._values[this._keyField].getValue()};
McxMemFeature.prototype.setFeatureID=function(a){this._values[this._keyField]&&(this._values[this._keyField].setValue(a),this._changedValues[this._keyField]=!0)};McxMemFeature.prototype.getFieldType=function(a){a="number"==typeof a?this.getFieldName(a):a;return this._values[a].getFieldDefinition().getFieldType()};McxMemFeature.prototype.getValueWithNameCaseInsensitive=function(a){return this._values[a]||this._values[a.toLowerCase()]||this._values[a.toUpperCase()]};
McxMemFeature.prototype.getValue=function(a){var b=a;"number"==typeof a&&(b=this.getFieldName(a));a=this.getValueWithNameCaseInsensitive(b?b.toString():"");return void 0==a?null:a.getValue()};McxMemFeature.prototype.setValue=function(a,b){var c;c="number"==typeof a?Object.keys(this._values)[a]:a;var d=this.getValueWithNameCaseInsensitive(c);d&&(d.setValue(b),this._changedValues[c]=!0)};McxMemFeature.prototype.isInstanceOf=function(a){return"McxMemFeature"==a||"IMcxFeature"==a};
McxMemFeature.prototype.isFieldSet=function(a){a="number"==typeof a?this._values.keys[a]:a;return this._values[a]?void 0!=this._values[a].getValue():!1};McxMemFeature.prototype.unsetField=function(a){"number"==typeof a&&(a=this.getFieldName(a));this._changedValues[a]=!1};McxMemFeature.prototype.isFieldChange=function(a){"number"==typeof a&&(a=this.getFieldName(a));return this._changedValues[a]&&void 0!=this._changedValues[a]?this._changedValues[a]:!1};
McxMemFeature.prototype.unChangeField=function(a){"number"==typeof a&&(a=this.getFieldName(a));this._changedValues[a]=!1};
McxMemFeature.prototype.setMissing=function(a){var b=new McxSetFieldResult;b.setArgs(a.getArgs());if(!this.getLayer().isInstanceOf("McxFsLayer"))return a.getAsync()&&a.getSuccess().call(a.getScope(),b),b;var c=function(c){c=c.getFeatureReader();if(null!=c){c.read();c=c.getCurrent();for(var d=0;d<c.getFieldCount();d++){var e=c.getField(d);void 0!=c.getValue(d)&&this.setValue(e.getFieldName(),c.getValue(d))}}b.setFeature(this);a.getAsync()&&a.getSuccess().call(a.getScope(),b)},d=new McxAjaxParameter;
d.setParameters(this,c,function(){a.getAsync()&&a.getError().call(a.getScope(),b)});d.setAsync(a.getAsync());for(var e=[],f="",g=0;g<this.getFieldCount();g++)void 0!=this._values[this.getFieldName(g)]&&void 0!=this._values[this.getFieldName(g)].getValue()||e.push(this.getFieldName(g));if(0>=e.length)return a.getAsync()&&a.getSuccess().call(a.getScope(),this),b;for(g=0;g<e.length;g++)f+=e[g],g!=e.length-1&&(f+=",");d=this._layer.query(f,this._keyField+"="+this.getFeatureID(),d);b.setRequest(d.getRequest());
a.getAsync()||c.call(this,d);return b};
McxMemFeature.prototype.setGeometryField=function(a){var b=new McxSetFieldResult;b.setArgs(a.getArgs());var c=new McxAjaxParameter;c.setAsync(a.getAsync());c.setParameters(this,function(c){c=c.getFeatureReader();c.read();c=c.getCurrent();for(var e=0;e<c.getFieldCount();e++){var f=c.getField(e);void 0!=c.getValue(e)&&this.setValue(f.getFieldName(),c.getValue(e))}b.setFeature(c);a.getAsync()&&a.getSuccess().call(a.getScope(),b)},function(){});if(void 0==this._values[this._layer.getGeometryField()]||void 0!=
this._values[this._layer.getGeometryField()].getValue())return b.setFeature(this),a.getAsync()&&a.getSuccess().call(a.getScope(),b),b;this._layer.query(this._layer.getGeometryField(),this._keyField+"="+this.getFeatureID(),c);return b};
McxMemFeature.prototype.setAttribute=function(a,b){var c=new McxSetFieldResult;c.setArgs(a.getArgs());var d=function(b){var d=b.getFeatureReader();b=null;if(null!=d)for(d.read(),b=d.getCurrent(),d=0;d<this.getFieldCount();d++){var e=this.getField(d);void 0!=this.getValue(d)&&b.setValue(e.getFieldName(),this.getValue(d))}c.setFeature(b);a.getAsync()&&a.getSuccess().call(a.getScope(),c)},e=new McxAjaxParameter;e.setParameters(this,d,function(){});e.setAsync(a.getAsync());if(!this._values[b]||void 0!=
this._values[b].getValue())return c.setFeature(this),a.getAsync()&&a.getSuccess().call(a.getScope(),c),c;e=this._layer.query(b,this._keyField+"="+this.getFeatureID(),e);d.call(this,e);return c};
McxMemFeature.prototype.setAttributes=function(a,b){var c=new McxSetFieldResult;c.setArgs(a.getArgs());if(this._layer.isInstanceOf("McxMemLayer"))return c.setFeature(this),a.getAsync()&&a.getSuccess().call(a.getScope(),c),c;var d=new McxAjaxParameter;d.setParameters(this,function(b){b=b.getFeatureReader();b.read();b=b.getCurrent();for(var d=0;d<b.getFieldCount();d++){var e=b.getField(d);void 0!=b.getValue(d)&&this.setValue(e.getFieldName(),b.getValue(d))}c.setFeature(this);a.getAsync()&&a.getSuccess().call(a.getScope(),
c)},function(){});d.setAsync(a.getAsync());for(var e=[],f=0;f<b.length;f++)void 0!=this._values[b[f]]&&void 0!=this._values[b[f]].getValue()||e.push(b[f]);if(0>=e.length)return c.setFeature(this),a.getAsync()&&a.getSuccess().call(a.getScope(),c),c;for(var g="",f=0;f<e.length;f++)g+=e[f],f!=e.length-1&&(g+=",");this._layer.query(g,this._keyField+"="+this.getFeatureID(),d);return c};
McxMemFeature.prototype.setAllAttributes=function(a){var b=new McxSetFieldResult;b.setArgs(a.getArgs());if(this._layer.isInstanceOf("McxMemLayer"))return b.setFeature(this),a.getAsync()&&a.getSuccess().call(a.getScope(),b),b;var c=function(c){c=c.getFeatureReader();if(c.read()){c=c.getCurrent();for(var d=0;d<c.getFieldCount();d++){var e=c.getField(d);void 0!=c.getValue(d)&&this.setValue(e.getFieldName(),c.getValue(d))}b.setFeature(this);a.getAsync()&&a.getSuccess().call(a.getScope(),b)}else a.getSuccess().call(a.getScope(),
b)},d=new McxAjaxParameter;d.setParameters(this,c,function(){});d.setAsync(a.getAsync());for(var e=[],f=0;f<this._layer.getSchema().getFieldCount();f++){var g=this._layer.getSchema().getField(f);g.getFieldName()!=this._layer.getGeometryField()&&void 0==this._values[g.getFieldName()].getValue()&&e.push(g.getFieldName())}if(0>=e.length)return b.setFeature(this),a.getAsync()&&a.getSuccess().call(a.getScope(),b),b;g="";for(f=0;f<e.length;f++)g+=e[f],f!=e.length-1&&(g+=",");d.setArgs([this]);d=this._layer.query(g,
this._keyField+"="+this.getFeatureID(),d);null!=d.getFeatureReader()&&c.call(this,d);b.setRequest(d.getRequest());return b};McxMemFeature.prototype.createFromFeature=function(a){a.getLayer();for(var b=[],c=0;c<a.getFieldCount();c++){var d=a.getField(c);b.push(d)}for(c=0;c<b.length;c++){var d=b[c],e=new McxFieldPair(d,null);this._values[d.getFieldName()]=e}for(c=0;c<a.getFieldCount();c++)b=a.getValue(c),this.setValue(c,b)};
McxMemFeature.prototype.getClone=function(){var a=new McxMemFeature(this._layer,null);a.createFromFeature(this);return a};McxMemFeature.prototype.getAttributes=function(){for(var a={},b=0;b<this._layer.getSchema().getFieldCount();b++){var c=this._layer.getSchema().getField(b);a[c.getFieldName()]=this._values[c.getFieldName()].getValue()}return a};
McxMemFeature.prototype.convertToString=function(a){for(var b="",c=0;c<this._layer.getSchema().getFieldCount();c++){var d=this._layer.getSchema().getField(c);if(null!=a){for(var e=!1,f=0;f<a.length;f++)if(a[f]==d.getFieldName()){e=!0;break}if(!e)continue}d="";void 0!=this.getValueWithName(this.getFieldName(c))&&(d=this.getValueWithName(this.getFieldName(c)).toString());if(null==d||""==d)d="null";void 0==this.getValueWithName(this.getFieldName(c))&&(d="");b+=d+";"}return b};
McxMemFeature.prototype.getSchema=function(){return this._schema};js.framework.driver.McxMemDriver.McxMemFeatureReader={};function McxMemFeatureReader(a){this._features=a;this._cursor=0}McxMemFeatureReader.prototype.read=function(){if(null==this._features||0>=this._features.length)return!1;var a=this._cursor<this._features.length;this._cursor++;return a};McxMemFeatureReader.prototype.getCurrent=function(){return this._features[this._cursor-1]};McxMemFeatureReader.prototype.addFeature=function(a){this._features.push(a)};McxMemFeatureReader.prototype.count=function(){return this._features.length};
McxMemFeatureReader.prototype.indexOf=function(a){for(var b=0;b<this._features.length;b++)if(this._features[b].getFeatureID()==a.getFeatureID())return b;return-1};McxMemFeatureReader.prototype.toArray=function(){return this._features};js.framework.driver.McxMemDriver.McxMemLayer={};function McxMemLayer(a){mcx.base(this,a);this.base=this;this._features=[];this._featureidCounter=0;this.initialize()}mcx.inherits(McxMemLayer,McxAbstractLayer);
McxMemLayer.prototype.initialize=function(){this.base.fieldGeometry="geometry";this.base.fieldKey="featureid";this.base.fieldSymbolizer="symbolizer";this.base.fieldLabelSymbolizer="labelsymbolizer";var a=new McxSchema,b=new McxFieldDefinition;b.setFieldName(this.base.fieldKey);b.setFieldType("Integer");a.addField(b);b=new McxFieldDefinition;b.setFieldName(this.base.fieldGeometry);b.setFieldType("IMcxGeometry");a.addField(b);b=new McxFieldDefinition;b.setFieldName(this.base.fieldSymbolizer);b.setFieldType("IMcxSymbolizer");
a.addField(b);b=new McxFieldDefinition;b.setFieldName(this.base.fieldLabelSymbolizer);b.setFieldType("IMcxSymbolizer");a.addField(b);this.base.schema=a;this.base.labelFormat="[featureid]"};
McxMemLayer.prototype.getEnvelope=function(a){var b=new McxGetEnvelopeResult;b.setArgs(a.getArgs());if(null==this.base.envelope){if(0>=this._features.length||!this._features[0]||void 0==this._features[0].getGeometry())return a=new McxBounds(0,0,10,10,this.base.coordinateSystem),b.setEnvelope(a),b;for(var c=this._features[0].getGeometry().getBounds(),c=new McxBounds(c.getLeft(),c.getBottom(),c.getRight(),c.getTop(),this.base.coordinateSystem),d=0;d<this._features.length;d++)null!=this._features[d]&&
void 0!=this._features[d].getGeometry()&&(c=c.merge(this._features[d].getGeometry().getBounds()));this.base.envelope=c}b.setEnvelope(this.base.envelope);a.getAsync()&&a.getSuccess().call(a.getScope(),b);return b};McxMemLayer.prototype.getFeatureCount=function(a){var b=new McxGetFeatureCountResult;b.setFeatureCount(this._features.length);b.setArgs(a.getArgs());a.getAsync()&&a.getSuccess().call(a.getScope(),b);return b};McxMemLayer.prototype.alterField=function(a,b){};
McxMemLayer.prototype.findFeature=function(a){for(var b=0;b<this._features.length;b++)if(this._features[b].getValue(this.getKeyField())==a)return this._features[b];return McxMemLayer.superClass_.findFeature.call(this,a)};McxMemLayer.prototype.setFeatureWithId=function(a,b){for(var c=0;c<this._features.length;c++)if(this._features[c].getValue(this.getKeyField())==a)return this._features[c]=b,!0;return!1};McxMemLayer.prototype.getNewFeatureId=function(){this._featureidCounter++;return this._featureidCounter};
McxMemLayer.prototype.searchByEnvelope=function(a,b,c,d,e){a=new McxSearchResult;a.setArgs(e.getArgs());c=c.transformTo(this.base.coordinateSystem);c=McxFactoryFinder.GeometryFactory(c.getCoordinateSystem()).createPolygon(c,null);if("Intersects"==d){d=[];for(b=0;b<this._features.length;b++){var f=this._features[b].getGeometry();f&&null!=f&&f.intersects(c)&&d.push(this._features[b])}a.setFeatureReader(new McxMemFeatureReader(d));a.setLayer(this);e.getAsync()&&e.getSuccess().call(e.getScope(),a)}return a};
McxMemLayer.prototype.search=function(a,b,c,d,e){a=new McxSearchResult;a.setArgs(e.getArgs());a.setLayer(this);if("Intersects"==d){b=[];for(d=0;d<this._features.length;d++){var f=this._features[d].getGeometry();f&&null!=f&&f.intersects(c)&&b.push(this._features[d])}a.setFeatureReader(new McxMemFeatureReader(b))}else if("Contains"==d){b=[];for(d=0;d<this._features.length;d++)c.contains(this._features[d].getGeometry())&&b.push(this._features[d]);a.setFeatureReader(new McxMemFeatureReader(b))}else if("Within"==
d){b=[];for(d=0;d<this._features.length;d++)this._features[d].getGeometry().contains(c)&&b.push(this._features[d]);a.setFeatureReader(new McxMemFeatureReader(b))}else a.setFeatureReader(new McxMemFeatureReader([]));e.getAsync()&&e.getSuccess().call(e.getScope(),a);return a};McxMemLayer.prototype.query=function(a,b,c){new McxMemFeatureReader(this._features);a=new McxSearchResult;a.setFeatureReader(null);a.setLayer(this);a.setArgs(c.getArgs());c.getAsync()&&c.getSuccess().call(c.getScope(),a);return a};
McxMemLayer.prototype.createEdit=function(){return new McxMemEdit(this)};McxMemLayer.prototype.isInstanceOf=function(a){return"IMcxLabeledLayer"==a||"McxMemLayer"==a||"IMcxSelectableLayer"==a||"IMcxSnappableLayer"==a||"IMcxSubtypedLayer"==a};McxMemLayer.prototype.addFeature=function(a){a instanceof Array?this._features=this._features.concat(a):this._features.push(a)};
McxMemLayer.prototype.removeFeature=function(a){if(a instanceof Array)for(var b=0;b<this._features.length;b++){if(this._features[b])for(var c=0;c<a.length;c++)this._features[b]&&this._features[b].getFeatureID()==a[c].getFeatureID()&&(this._features.splice(b,1),b--)}else for(b=0;b<this._features.length;b++)this._features[b].getFeatureID()==a.getFeatureID()&&(this._features.splice(b,1),b--)};McxMemLayer.prototype.createFeatureBuffer=function(){return new McxMemFeature(this,null)};
McxMemLayer.prototype.createField=function(a){McxMemLayer.superClass_.createField.call(this,a);for(var b=0;b<this._features.length;b++){var c=this._features[b],d=new McxFieldPair(a,null);c.values[a.getFieldName()]=d;c.changedValues[a.getFieldName()]=!1}};McxMemLayer.prototype.getSelection=function(){var a=[],b;for(b in this.base.selectedFeatures)a.push(this.base.selectedFeatures[b]);return new McxMemFeatureReader(a)};
McxMemLayer.prototype.labelOf=function(a){var b=this.getLabelFormat(),c=!0;if(null==b)return b;for(;1==c;){var d=b.match(/\[(.*?)\]/);if(null==d)c=!1;else{var e="",f=d[1],g=a.getValue(f);g||(g=new McxAjaxParameter,g.setAsync(!1),a.setAttribute(g,f),g=a.getValue(f));if(g){f=a.getField(f).getDomainName();if(!g)return"---";if(f){var h=new McxAjaxParameter;h.setAsync(!1);var k=this.getDataSourceName();if(f=this.getDataSource().getDomain(k,f,h).getDomain()){var f=f.getCodedValues(),m;for(m in f)if(f[m].getCode()==
g){e=f[m].getValue();break}else e=g.toString()}else e=g.toString()}else e=g.toString()}e=e&&"null"!=e?e:"";b=b.replace(d[0],e)}}return b};McxMemLayer.prototype.insertFeatures=function(a,b){1>a.length&&b.getError().call(b.getScope(),null);for(var c=new McxCommitResult,d=0;d<a.length;d++)a[d].setFeatureID(this.getNewFeatureId()),this._features.push(a[d]);c.setFeatures(a);b.getAsync()&&b.getSuccess().call(b.getScope(),c);return c};
McxMemLayer.prototype.deleteFeatures=function(a,b){1>a.length&&b.getError().call(b.getScope(),null);var c=new McxCommitResult;if(a instanceof Array)for(var d=0;d<this._features.length;d++){if(this._features[d])for(var e=0;e<a.length;e++)this._features[d]&&this._features[d].getFeatureID()==a[e]&&(this._features.splice(d,1),d--)}else for(d=0;d<this._features.length;d++)this._features[d].getFeatureID()==a&&(this._features.splice(d,1),d--);c.setFeatures(this._features);b.getAsync()&&b.getSuccess().call(b.getScope(),
c);return c};
McxMemLayer.prototype.updateFeatures=function(a,b){1>a.length&&b.getError().call(b.getScope(),null);var c=new McxCommitResult;if(a instanceof Array)for(var d=0;d<this._features.length;d++){if(this._features[d])for(var e=0;e<a.length;e++)this._features[d]&&this._features[d].getFeatureID()==a[e].getFeatureID()&&(this._features[d]=a[e])}else for(d=0;d<this._features.length;d++)this._features[d].getFeatureID()==a.getFeatureID()&&(this._features[d]=a);c.setFeatures(this._features);b.getAsync()&&b.getSuccess().call(b.getScope(),
c);return c};js.framework.driver.McxMemDriver.McxSetFieldResult={};function McxSetFieldResult(){mcx.base(this);this.feature=null}mcx.inherits(McxSetFieldResult,McxResult);McxSetFieldResult.prototype.getFeature=function(){return this.feature};McxSetFieldResult.prototype.setFeature=function(a){this.feature=a};
js.framework.driver.McxFsDriver={};js.framework.driver.McxFsDriver.McxFsConverter={};function McxFsConverter(){}
McxFsConverter.castGeometryTypeFromString=function(a){switch(a){case "GeometryCollection":return McxGeometryType.GeometryCollection;case "LinearRing":return McxGeometryType.LinearRing;case "LineString":return McxGeometryType.LineString;case "MultiLineString":return McxGeometryType.MultiLineString;case "MultiPoint":return McxGeometryType.MultiPoint;case "MultiPolygon":return McxGeometryType.MultiPolygon;case "None":return McxGeometryType.None;case "Point":return McxGeometryType.Point;case "Polygon":return McxGeometryType.Polygon;
default:return McxGeometryType.Unknown}};
McxFsConverter.parseFeature=function(a,b,c,d,e){var f=[],g="",h=!1,k=0,m=null;null!=b&&(m=b.split(","));for(b=0;b<a.length;b++){if("&"==a[b]){var n=parseInt(g,10)-1;if(0>=n)continue;f=Array(n);g="";break}g+=a[b]}var n=0,p=new McxMemFeature(c,null);for(b=0;b<a.length;b++)if(";"==a[b]){k++;for(var q=g,r=0;r<c.getSchema().getFieldCount();r++){var t=c.getSchema().getField(r);if(null!=m&&m[k-1]==t.getFieldName()){c.getGeometryField()==t.getFieldName()?p.setGeometry(McxFsConverter.parseGeometry(q,d,e)):
c.getGuidField()==t.getFieldName()?p.setGlobalID(q):c.getKeyField()==t.getFieldName()?p.setFeatureID(parseInt(q,10)):p[t.getFieldName()]=q;g="";break}}}else"&"==a[b]&&0==h?(h=!0,g=""):(m.length==k&&(f[n]=p,n++,p=new McxMemFeature(c,null),g="",k=0),g+=a[b]);return f};
McxFsConverter.parseGeometry=function(a,b,c){var d=null;switch(parseInt(a.slice(0,a.indexOf(" ")),10)){case McxGeometryType.Point:d=McxFsConverter.parsePoint(a,b,c);break;case McxGeometryType.LineString:d=McxFsConverter.parseLineString(a,b,c);break;case McxGeometryType.Polygon:d=McxFsConverter.parsePolygon(a,b,c);break;case McxGeometryType.MultiPoint:d=McxFsConverter.parseMultiPoint(a,b,c);break;case McxGeometryType.MultiLineString:d=McxFsConverter.parseMultiLine(a,b,c);break;case McxGeometryType.MultiPolygon:d=
McxFsConverter.parseMultiPolygon(a,b,c)}return d};McxFsConverter.parsePoint=function(a,b,c){b=a.split(" ");c=b[1];a=null;null!=c&&""!=c&&(a=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(parseInt(c,10)));c=parseFloat(b[2]);b=parseFloat(b[3]);return new McxPoint(c,b,a)};
McxFsConverter.parseLineString=function(a,b,c){a=a.split(" ");c=a[1];b=null;null!=c&&""!=c&&(b=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(parseInt(c,10)));c=[];for(var d=3;d<a.length-1;d+=2){var e=parseFloat(a[d]),f=parseFloat(a[d+1]);c.push(new McxPoint(e,f,b))}return new McxLineString(c,b)};
McxFsConverter.parsePolygon=function(a,b,c){b=a.split(" ");c=b[1];a=null;null!=c&&""!=c&&(a=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(parseInt(c,10)));var d=[];c=[];var e=parseInt(b[2],10);if(1<e){var f=0;c=Array(e-1);for(var g=0;g<e-1;g++){for(var f=f+parseInt(b[3],10),h=[],k=3;k<3+2*f;k+=2){var m=parseFloat(b[k]),n=parseFloat(b[k+1]);h.push(new McxPoint(m,n,a))}c.push(new McxLinearRing(h,a))}}for(g=4;g<b.length-1;g+=2)e=parseFloat(b[g]),f=parseFloat(b[g+1]),d.push(new McxPoint(e,
f,a));b=new McxLinearRing(d,a);return new McxPolygon(b,c,a)};
McxFsConverter.parseMultiPolygon=function(a,b,c){a=a.split(" ");c=a[1];b=null;null!=c&&""!=c&&(b=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(parseInt(c,10)));c=parseInt(a[2],10);for(var d=[],e=3,f=0,g=0;g<c;g++){var h=[],f=parseInt(a[e],10);e++;for(var k=e;k<e+2*f;k+=2){var m=parseFloat(a[k]),n=parseFloat(a[k+1]);h.push(new McxPoint(m,n,b))}e+=2*f;f=McxFactoryFinder.GeometryFactory(b).createLinearRing(h);f=McxFactoryFinder.GeometryFactory(b).createPolygon(f,null);d.push(f)}return new McxMultiPolygon(d,
null)};McxFsConverter.parseMultiLine=function(a,b,c){a=a.split(" ");c=a[1];b=null;null!=c&&""!=c&&(b=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(parseInt(c,10)));c=parseInt(a[2],10);for(var d=[],e=3,f=0,g=0;g<c;g++){f=parseInt(a[e],10);e++;for(var h=[],k=e;k<e+2*f;k+=2){var m=parseFloat(a[k]),n=parseFloat(a[k+1]);h.push(new McxPoint(m,n,b))}e+=2*f;d.push(new McxLineString(h,b))}return new McxMultiLineString(d,b)};
McxFsConverter.parseMultiPoint=function(a,b,c){a=a.split(" ");parseInt(a[2],10);c=a[1];b=null;null!=c&&""!=c&&(b=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(parseInt(c,10)));c=[];for(var d=3;3>d;d+=2){var e=parseFloat(a[d]),f=parseFloat(a[d+1]);c.push(new McxPoint(e,f,b))}return new McxMultiPoint(c,b)};
McxFsConverter.transformToWorld=function(a,b,c,d){if(0>=c.getWidth()||0>=c.getHeight())return null;var e=c.getLeft(),f=c.getBottom(),g=c.getWidth()/d.getWidth();c=c.getHeight()/d.getHeight();b=d.getHeight()-b;a=(d.getLeft()+a)*g+e;d=(d.getBottom()+b)*c+f;return new McxPoint(a,d,null)};
McxFsConverter.featuresToString=function(a,b,c){var d="",e=-1,f=null;null==b&&""==b&&(f=b.split(","),e=f.length);for(var g=b=0;g<a.length;g++){var h=a[g];0>e&&(e=h.getLayer().getSchema().getFieldCount());var k="",k=c?McxFsConverter.getUnChangedFields(h,f):h.convertToString(f),d=d+k;b++}return b+";"+e+";"+d};
McxFsConverter.getUnChangedFields=function(a,b){for(var c="",d=a.getLayer(),e=0;e<d.getSchema().getFieldCount();e++){var f=d.getSchema().getField(e);if(null!=b){for(var g=!1,h=0;h<b.length;h++)if(b[h]==f.getFieldName()){g=!0;break}if(!g)continue}f="";a.isFieldChange(e)&&(void 0!=a.getValue(a.getFieldName(e))&&(f=a.getValue(a.getFieldName(e)).toString()),null==f&&(f="null"));c+=f+";"}return c};js.framework.driver.McxFsDriver.McxFsDataSource={};function McxFsDataSource(a,b,c){mcx.base(this,a,b);this.base=this;this.domains=[];this.serviceUri=this.base.createServiceUri(b);this.token=c;this.uploadUri=this.createUploadServiceUri(b)}mcx.inherits(McxFsDataSource,McxAbstractDataSource);McxFsDataSource.prototype.createUploadServiceUri=function(a){a=a.split("@");a=a[a.length-1].split("/");for(var b="",c=0;c<a.length-1;c++)b+=a[c]+"/";return b+"Upload"};
McxFsDataSource.prototype.getDomains=function(a){var b=new McxGetDomainsResult,c=new McxAjaxParameter;c.setParameters(this,function(){b.setDomains(this.domains);a.getAsync()&&a.getSuccess().call(a.getScope(),b)},function(){});c.setAsync(a.getAsync());this.getDataSourceDomains(c);return b};
McxFsDataSource.prototype.fullTextSearch=function(a,b,c,d){var e=new McxFullTextSearchResult;e.setArgs(d.getArgs());if(!this.base.dataSourceName||null==this.base.dataSourceName||""==this.base.dataSourceName)return a=McxLocalizationManager.getLocaleValue("McxFsDriver-funcDataSourceNameErrorMessage"),a=String.format(a,"Execute Dialect").toString(),McxMessageBox.show("",a,McxMessageBoxType.Error),e;var f=this.serviceUri+"FullTextSearch?";null!=this.base.credentials&&""!=this.base.credentials&&(f+="token="+
encodeURIComponent(this.token)+"&");a=McxAjaxServiceCall.getAjaxCall(f+("dataSourceName="+this.base.dataSourceName+"&name="+name+"&text="+a+"&limit"+b+"&offset="+c),{},[this],"json",!1,null,d.getAsync(),function(a){d.getAsync()&&d.getSuccess().call(d.getScope(),e)},function(a){a=new McxExceptionMessage(a);e.setExceptionMessage(a);d.getAsync()&&d.getError().call(d.getScope(),null)});e.setRequest(a);return e};McxFsDataSource.prototype.testCapability=function(a){};
McxFsDataSource.prototype.getDomain=function(a,b){var c=new McxGetDomainResult;(new McxAjaxParameter).setAsync(!1);this.getDataSourceDomains(b);for(var d=0;d<this.domains.length;d++)if(this.domains[d].getDomainName()==a){c.setDomain(this.domains[d]);break}b.getAsync()&&b.getSuccess().call(b.getScope(),c);return c};
McxFsDataSource.prototype.getLayer=function(a,b,c){var d=new McxGetLayerResult;d.setArgs(b.getArgs());var e=this,f=[],g=a.split(";"),h=[];for(a=0;a<g.length;a++)if(""!=g[a]){var k=g[a].split(":");if(2!=k.length&&""!=k[0]){var m;try{m=mcx.urlDecode(k[0]),m=mcx.urlEncode(m)}catch(n){m=mcx.urlEncode(k[0])}k=this.getName()+":"+m}else k=g[a];h.push(k)}m=[];for(k=0;k<h.length;k++){var p=!1;for(a=0;a<this.base.layerArray.length;a++)c||this.base.layerArray[a].getName()!=h[k]||(p=!0,f.push(this.base.layerArray[a]));
p||m.push(h[k])}if(0<f.length&&g.length==f.length)return d.setLayers(f),b.getAsync()&&b.getSuccess().call(b.getScope(),d),d;c="";for(a=0;a<m.length;a++)c+=m[a]+";";a=this.serviceUri+"getLayer?";null!=this.base.credentials&""!=this.base.credentials&&(a+="token="+encodeURIComponent(this.token)+"&");c=McxAjaxServiceCall.getAjaxCall(a+("layers="+c),{},[this,b,f],"text",!1,null,b.getAsync(),function(a){a=jQuery.parseJSON(a.replace(/\bNaN\b/g,"null"));null==a&&b.getError().call(b.getScope(),d);for(var c=
0;c<a.length;c++){var g=new McxFsLayer(e.token,e,e.serviceUri,a[c]);f.push(g);e.add(g)}d.setLayers(f);b.getAsync()&&b.getSuccess().call(b.getScope(),d)},function(){b.getError().call(b.getScope(),d)});d.setRequest(c);return d};
McxFsDataSource.prototype.getDataSourceDomains=function(a){if(this.base.dataSourceName&&null!=this.base.dataSourceName&&""!=this.base.dataSourceName){var b=this,c=this.serviceUri+"getDomains?";null!=this.base.credentials&""!=this.base.credentials&&(c+="token="+encodeURIComponent(this.token)+"&");c+="dataSourceName="+this.base.dataSourceName;McxAjaxServiceCall.getAjaxCall(c,{},null,"json",!0,null,a.getAsync(),function(c){if(null!=c){for(var e=Array(c.length),f=0;f<c.length;f++){for(var g=c[f],h=g.Name,
g=g.CodedValues,k=[g.length],m=0;m<g.length;m++)k[m]=new McxCodedValue(g[m].Code,g[m].Value);e[f]=new McxDomain(h,k)}b.domains=e;a.getSuccess()&&null!=a.getSuccess()&&a.getSuccess().call(a.getScope(),null)}},function(a){a=jQuery.parseJSON(a.responseText);alert(a.ExceptionMessage)})}else c=McxLocalizationManager.getLocaleValue("McxFsDriver-funcDataSourceNameErrorMessage"),null==c&&(c=""),c=String.format(c,"Domain").toString(),McxMessageBox.show("",c,McxMessageBoxType.Error)};
McxFsDataSource.prototype.getServerReports=function(a,b,c){var d=this,e=new McxFsReportResult;e.setArgs(a.getArgs());var f={};f.Name=b;f.Parameters=[];f.Queries=[];f.ReportType=c;b=McxAjaxServiceCall.postAjaxCall(this.serviceUri+"PrepareExportReport",!0,JSON.stringify(f),"application/json",a.getArgs(),"json",!0,null,a.getAsync(),function(b){e.setReports([d.serviceUri+"ExportReport?name="+b]);a.getAsync()&&a.getSuccess().call(a.getScope(),e)},function(a){a=JSON.parse(a.responseText);McxMessageBox.show("",
a.ExceptionMessage,McxMessageBoxType.Error)});e.setRequest(b);return e};McxFsDataSource.prototype.getReportUri=function(a,b,c,d){var e="",f;for(f in b)e+=f+":"+b[f]+";";b="";for(f in c)b+=f+":"+c[f]+";";c=this.serviceUri;c=c+"GetReport?"+("name="+a+"&");c+="queries="+e+"&";c+="parameters="+b+"&";return c+="reportType="+d};
McxFsDataSource.prototype.importData=function(a,b,c){var d=new McxResult;d.setArgs(a.getArgs());var e=this.serviceUri+"ImportData?";null!=this.base.credentials&&""!=this.base.credentials&&(e+="token="+this.token+"&");e+="dataSourceName="+this.base.dataSourceName+"&";b=McxAjaxServiceCall.PostAjaxStreamCall(e+("authorityCode="+b),c,null,function(){a.getAsync()&&a.getSuccess().call(a.getScope(),d)},function(b){a.getError().call(a.getScope(),d)});d.setRequest(b);return d};
McxFsDataSource.prototype.getRelation=function(a,b,c,d){d||(d=new McxAjaxParameter,d.setAsync(!1));if(!a||!b)return new McxGetRelationResult;b=this.getRelationsFromDataSource(d,c,a,b);a=new McxGetRelationResult;(b=b.getRelations())&&0<b.length&&a.setRelation(b[0]);return a};McxFsDataSource.prototype.getRelations=function(a,b,c){return a?this.getRelationsFromDataSource(c,b,a):new McxGetRelationsResult};
McxFsDataSource.prototype.getAllRelations=function(a,b){return this.getRelationsFromDataSource(a,null,null,null,b)};
McxFsDataSource.prototype.getRelationsFromDataSource=function(a,b,c,d,e){var f=new McxGetRelationsResult;f.setArgs(a.getArgs());if(!this.base.dataSourceName||null==this.base.dataSourceName||""==this.base.dataSourceName)return a.getAsync()&&a.getSuccess().call(a.getScope(),f),f;var g,h;b&&(g=b==McxRelationDirection.up?"OrginTable":"DestTable",h=b==McxRelationDirection.up?"OrginForeignKey":"DestForeignKey");var k=this.serviceUri+"getRelations?";null!=this.base.credentials&&""!=this.base.credentials&&
(k+="token="+encodeURIComponent(this.token)+"&");k+="dataSourceName="+this.base.dataSourceName;k=McxAjaxServiceCall.getAjaxCall(k,{},null,"json",!0,null,a.getAsync(),function(k){if(null==k)return null;for(var n=[],p=0;p<k.length;p++){var q=k[p];if(!b||!c||c==q[g])if(!b||!d||d==q[h]){var r=q.SpatialRelation;if(!e||r&&McxTopologyRelation[r]!=McxTopologyRelation.None){var t=new McxServerRelation;t.setDestForeignKey(q.DestForeignKey);t.setDestPrimaryKey(q.DestPrimaryKey);t.setDestTable(q.DestTable);t.setDestValueKey(q.DestValueKey);
t.setOriginForeignKey(q.OrginForeignKey);t.setOriginPrimaryKey(q.OrginPrimaryKey);t.setOriginTable(q.OrginTable);t.setRelationName(q.RelationName);t.setOriginLabel(q.OriginLabel);t.setFilterValue(q.FilterValue);t.setBufferValue(q.BufferValue);t.setDestLabel(q.DestLabel);t.setDestLabel(q.DestLabel);t.setSpatialRelation(McxTopologyRelation[r]);n[n.length]=t}}}f.setRelations(n);a.getAsync()&&a.getSuccess()&&null!=a.getSuccess()&&a.getSuccess().call(a.getScope(),f)},function(b){a.getError()&&null!=a.getError()&&
a.getError().call(a.getScope(),null)});f.setRequest(k);return f};js.framework.driver.McxFsDriver.McxFsDriver={};function McxFsDriver(){}
McxFsDriver.prototype.openDataSource=function(a){if(0==mcx.isDefAndNotNull(a))return null;var b=a.substr(0,8);if("MFS@REST"!=b.toUpperCase()&&"MFS@SOAP"!=b.toUpperCase())return null;var b=a.split("@"),c="credentials="+encodeURIComponent(b[2]),b=McxAjaxServiceCall.getAjaxCall(b[4]+"/rest/json/createToken?"+c,[],[],"json",!1,null,!1,null,null).responseText;if(void 0==b)return null;b=b.slice(1,b.length-1);a=new McxFsDataSource(this,a,b);b=new McxOpenDataSourceResult;b.setDataSource(a);return b};
McxFsDriver.prototype.getDriverID=function(){return"{86B1198C-5CE5-4D1D-9C12-E0051121BABA}"};McxFsDriver.prototype.getName=function(){return"MapCodex Server Driver"};McxFsDriver.prototype.testCapability=function(a){return!1};McxFsDriver.prototype.isInstanceOf=function(a){return"IMcxDriver"==a};
McxFsDriver.prototype.getDataSourceInfo=function(a,b,c){var d=a+"/createToken?credentials="+encodeURIComponent(b),d=McxAjaxServiceCall.getAjaxCall(d,[],[],"json",!1,null,!1,null,null).responseText,d=encodeURIComponent(d.slice(1,d.length-1)),e=new McxGetDataSourceInfoResult,f=[],g="";""!=b&&(g="token="+d);a=McxAjaxServiceCall.getAjaxCall(a+"/GetDataSourceInfo?"+g,null,null,"json",!1,null,!1,function(a){for(var b=0;b<a.length;b++)f.push(a[b].DataSourceName.toString());e.setDataSourceNames(f);c.getAsync()&&
c.getSuccess().call(c.getScope(),e)},function(){c.getAsync()&&c.getError().call(c.getScope(),null)});e.setRequest(a);return e};
McxFsDriver.prototype.exportMapData=function(a,b,c,d,e,f,g){b=a+"/rest/json//createToken?credentials="+encodeURIComponent(b).toString();b=McxAjaxServiceCall.getAjaxCall(b,[],[],"json",!1,null,!1,null,null);b=b.responseText;b=b.slice(1,b.length-1);a+="/Rest/Json/";var h=new McxResult;h.setArgs(g.getArgs());for(var k=function(){g.getAsync()&&g.getError().call(g.getScope(),h)},m=[],n=0;n<e.length;n++)null!=e[n]&&m.push(e[n].toString());e={};for(var n=[],p=0;p<d.length;p++){var q={},r=d[p];q.AttributeFilter=
r.getAttributeFilter();q.Name=r.getName();n.push(q)}e.Token=b;e.LayerParams=n;e.Geometries=m;e.Relation=f;e.DriverId=c;b=McxAjaxServiceCall.postAjaxCall(a+"PrepareExportMap",!0,JSON.stringify(e),"application/json",g.getArgs(),"json",!1,null,g.getAsync(),function(b){"null"==b?k():(a=a+"ExportMap?guid="+b.toString(),window.open(a,"ExportMap","width=200,height=100"),g.getAsync()&&g.getSuccess().call(g.getScope(),h))},k);h.setRequest(b);return h};
McxFsDriver.prototype.getLayerInfo=function(a,b,c,d,e){a+="/rest/json/";var f=a+"/createToken?credentials="+encodeURIComponent(c),f=McxAjaxServiceCall.getAjaxCall(f,[],[],"json",!1,null,!1,null,null).responseText,f=encodeURIComponent(f.slice(1,f.length-1)),g=new McxGetLayerInfoResult;if(null==d)return e=McxLocalizationManager.getLocaleValue("McxFsDriver-NullErrorMessage"),e=String.format(e,"Ajax Parameter").toString(),McxMessageBox.show("",e,McxMessageBoxType.Error),null;g.setArgs(d.getArgs());var h=
"";""!=c&&(h="token="+f);b=a+"/GetLayerInfo?"+h+"&dataSourceNames="+b;e&&(b+="&isVirtual=true");e=McxAjaxServiceCall.getAjaxCall(b,null,null,"json",!1,null,d.getAsync(),function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].Name);g.setLayerNames(b);d.getAsync()&&d.getSuccess().call(d.getScope(),g)},function(){d.getAsync()&&d.getError().call(d.getScope(),g)});g.setRequest(e);return g};js.framework.driver.McxFsDriver.McxFsEdit={};function McxFsEdit(a){this._vectorLayer=a}McxFsEdit.prototype.insert=function(a,b){return this.insertRange([a],b)};McxFsEdit.prototype.insertRange=function(a,b){return this._vectorLayer.insertFeatures(a,b)};McxFsEdit.prototype.update=function(a,b){return this.updateRange([a],b)};McxFsEdit.prototype.updateRange=function(a,b){return this._vectorLayer.updateFeatures(a,b)};McxFsEdit.prototype.delete=function(a,b){return this.deleteRange([a],b)};
McxFsEdit.prototype.deleteRange=function(a,b){return this._vectorLayer.deleteFeatures(a,b)};McxFsEdit.prototype.deleteFeature=function(a,b){return this.deleteFeatureRange([a],b)};McxFsEdit.prototype.deleteFeatureRange=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(a[d].getFeatureID());return this.deleteRange(c,b)};js.framework.driver.McxFsDriver.McxFsFeatureReader={};
function McxFsFeatureReader(a,b,c,d,e){this.transformationEnabled=!0;this.featureString=a;this.coordinateSystem=b.getCoordinateSystem();this.world=d;this.display=e;this.closed=!1;this._schema=c;this.stringCursor=0;this.currentFeature=new McxMemFeature(b,c);this.numberOfFeature=0;""!=this.featureString&&(this.numberOfFeature=this.readInteger(";"));this.numberOfFields=0;0!=this.numberOfFeature&&""!=this.featureString&&(this.numberOfFields=this.readInteger(";"));this.passedFeatures=0;this._geometryField=
b.getGeometryField();this._symbolizerField=b.getSymbolizerField();this._labelSymbolizerField=b.getLabelSymbolizerField();this._keyField=b.getKeyField();this._guidField=b.getGlobalIdField()}McxFsFeatureReader.prototype.isClosed=function(){return this.closed};McxFsFeatureReader.prototype.read=function(){if(0==this.numberOfFeature||this.passedFeatures>=this.numberOfFeature)return!1;this.readFeature();return!0};
McxFsFeatureReader.prototype.readFeature=function(){for(var a=0;this.stringCursor<this.featureString.length;){var b=this._schema.getField(a);if(null==b)return;a++;var c=b.getFieldName();switch(c){case this._geometryField:this.currentFeature.setGeometry(this.parseGeometry());break;case this._symbolizerField:this.currentFeature.setValue(b.getFieldName(),this.parseSymbolizer());break;case this._labelSymbolizerField:this.currentFeature.setValue(b.getFieldName(),this.parseLabelSymbolizer());break;case this._keyField:this.currentFeature.setFeatureID(this.parseKeyField());
break;case this._guidField:this.currentFeature.setGlobalID(this.parseGuidField());break;default:var d=this.parseDefault(),e=b.getFieldType();if(McxDataType.Double==e||McxDataType.Float==e||McxDataType.Int64==e||McxDataType.Int16==e)d=parseFloat(d);McxDataType.Int32==e&&(d=parseInt(d,10));McxDataType.DateTime==e&&(d=(new McxDateTime).setDate(d&&d.toString()||"","MM/DD/YYYY HH:mm:ss"));"0"==d.toString()?this.currentFeature.setValue(b.getFieldName(),d):d?this.currentFeature.setValue(b.getFieldName(),
d):this.currentFeature.setValue(b.getFieldName(),"")}this.currentFeature.unsetField(c);b.getFieldName()==this._geometryField&&this.stringCursor++;if(this.numberOfFields==a)break}this.passedFeatures++};McxFsFeatureReader.prototype.parseKeyField=function(){return this.readInteger(";")};
McxFsFeatureReader.prototype.parseSymbolizer=function(){var a=this.readNext(";"),b=null;this.currentFeature.getGeometry();if(""!=a)if(a=a.replace(/[\\]/gi,"").replace("<?xml version=1.0 encoding=utf-16?>",""),a=new McxXmlNode(a),null!=a.findNodes("objsymbolizer")&&1<=a.findNodes("objsymbolizer").length&&(b=McxSldReader.readObjSymbolizer(a)),null!=this.currentFeature.getGeometry())if(this.currentFeature.getGeometry().isInstanceOf(McxGeometryType.Polygon)||this.currentFeature.getGeometry().isInstanceOf(McxGeometryType.MultiPolygon))b=
McxSldReader.readPolygonSymbolizer(a);else if(this.currentFeature.getGeometry().isInstanceOf(McxGeometryType.Point)||this.currentFeature.getGeometry().isInstanceOf(McxGeometryType.MultiPoint))b=McxSldReader.readPointSymbolizer(a);else{if(this.currentFeature.getGeometry().isInstanceOf(McxGeometryType.LinearRing)||this.currentFeature.getGeometry().isInstanceOf(McxGeometryType.LineSegment)||this.currentFeature.getGeometry().isInstanceOf(McxGeometryType.LineString))b=McxSldReader.readLineSymbolizer(a)}else null!=
a.findNodes("pointsymbolizer")&&1<=a.findNodes("pointsymbolizer").length?b=McxSldReader.readPointSymbolizer(a):null!=a.findNodes("linesymbolizer")&&1<=a.findNodes("linesymbolizer").length?b=McxSldReader.readLineSymbolizer(a):null!=a.findNodes("polygonsymbolizer")&&1<=a.findNodes("polygonsymbolizer").length&&(b=McxSldReader.readPolygonSymbolizer(a));return b};McxFsFeatureReader.prototype.parseLabelSymbolizer=function(){return this.readNext(";")};McxFsFeatureReader.prototype.parseGuidField=function(){return this.readNext(";")};
McxFsFeatureReader.prototype.parseDefault=function(){return this.readNext(";")};
McxFsFeatureReader.prototype.parseGeometry=function(){if(";"==this.featureString[this.stringCursor])return null;var a=this.readInteger(" ");this.readInteger(" ");var b=null;switch(a){case McxGeometryType.Point:b=this.parsePoint();break;case McxGeometryType.LineString:b=this.parseLineString();break;case McxGeometryType.Polygon:b=this.parsePolygon();break;case McxGeometryType.MultiPoint:b=this.parseMultiPoint();break;case McxGeometryType.MultiLineString:b=this.parseMultiLineString();break;case McxGeometryType.MultiPolygon:b=
this.parseMultiPolygon()}return b};McxFsFeatureReader.prototype.parsePoint=function(){var a=this.readInteger(" "),b=this.readInteger(" ");return this.transformationEnabled?this.transformToWorld(a,b):new McxPoint(a,b,this.coordinateSystem)};McxFsFeatureReader.prototype.parseLineString=function(){for(var a=this.readInteger(" "),b=Array(a),c=0;c<a;c++)b[c]=this.parsePoint();return new McxLineString(b,this.coordinateSystem)};
McxFsFeatureReader.prototype.parseLinearRing=function(){for(var a=this.readInteger(" "),b=Array(a),c=0;c<a;c++)b[c]=this.parsePoint();return new McxLinearRing(b,this.coordinateSystem)};McxFsFeatureReader.prototype.parsePolygon=function(){var a=this.readInteger(" "),b=this.parseLinearRing(),c=null;if(1<a)for(var c=Array(a-1),d=0;d<a-1;d++)c[d]=this.parseLinearRing();return new McxPolygon(b,c,this.coordinateSystem)};
McxFsFeatureReader.prototype.parseMultiPoint=function(){for(var a=this.readInteger(" "),b=Array(a),c=0;c<a;c++)b[c]=this.parsePoint();return new McxMultiPoint(b,this.coordinateSystem)};McxFsFeatureReader.prototype.parseMultiLineString=function(){for(var a=this.readInteger(" "),b=Array(a),c=0;c<a;c++)b[c]=this.parseLineString();return new McxMultiLineString(b,this.coordinateSystem)};
McxFsFeatureReader.prototype.parseMultiPolygon=function(){for(var a=this.readInteger(" "),b=[],c=[],d=null,e=0;e<a;e++)if("-"==this.featureString[this.stringCursor]){this.stringCursor++;var f=this.parseLinearRing();c.push(f)}else null!=d&&(d=1<c.length?new McxPolygon(d,c,this.coordinateSystem):new McxPolygon(d,null,this.coordinateSystem),c=[],b.push(d)),d=this.parseLinearRing();null!=d&&(d=1<c.length?new McxPolygon(d,c,this.coordinateSystem):new McxPolygon(d,null,this.coordinateSystem),b.push(d));
return new McxMultiPolygon(b,this.coordinateSystem)};McxFsFeatureReader.prototype.getCurrent=function(){return this.currentFeature};McxFsFeatureReader.prototype.close=function(){this.closed=!0};McxFsFeatureReader.prototype.addFeature=function(a){};McxFsFeatureReader.prototype.count=function(){return this.numberOfFeature};
McxFsFeatureReader.prototype.transformToWorld=function(a,b){if(null==this.world||null==this.display)return new McxPoint(a,b,this.coordinateSystem);var c=this.world.right-this.world.left,d=this.world.top-this.world.bottom;if(0==c||0==d)return null;var e=this.display.top-this.display.bottom;return new McxPoint(c/(this.display.right-this.display.left)*(this.display.left+a)+this.world.left,d/e*(this.display.bottom+(e-b))+this.world.bottom,this.coordinateSystem)};
McxFsFeatureReader.prototype.readNext=function(a){for(var b="";this.stringCursor<this.featureString.length;)if(this.featureString[this.stringCursor]==a){this.stringCursor++;break}else b+=this.featureString[this.stringCursor],this.stringCursor++;return b};McxFsFeatureReader.prototype.readInteger=function(a){return parseFloat(this.readNext(a))};McxFsFeatureReader.prototype.setTransformation=function(a){this.transformationEnabled=a};
McxFsFeatureReader.prototype.toArray=function(){for(var a=Array(this.count()),b=0;this.read();){var c=this.getCurrent(),d=new McxMemFeature(c.getLayer(),null);d.createFromFeature(c);d.getGeometry()&&d.getGeometry().setCoordinateSystem(this.coordinateSystem);a[b]=d;b++}return a};js.framework.driver.McxFsDriver.McxFsLabelReader={};function McxFsLabelReader(a){this.labelString=a;this.stringCursor=1;this.currentAngle=this.currentY=this.currentX=0;this.currentValue=""}McxFsLabelReader.prototype.read=function(){if(this.stringCursor>=this.labelString.length-1)return!1;this.currentX=parseInt(this.readNext(" "),10);this.currentY=parseInt(this.readNext(" "),10);var a=360-parseInt(this.readNext(" "),10);a&&null!=a&&(this.currentAngle=a);this.currentValue=this.readNext(";");return!0};
McxFsLabelReader.prototype.getCurrent=function(){return new McxLabel(this.currentX,this.currentY,this.currentValue,this.currentAngle)};McxFsLabelReader.prototype.readNext=function(a){for(var b="";this.stringCursor<this.labelString.length;)if(this.labelString[this.stringCursor]==a){this.stringCursor++;break}else b+=this.labelString[this.stringCursor],this.stringCursor++;return b};js.framework.driver.McxFsDriver.McxFsLayer={};function McxFsLayer(a,b,c,d){mcx.base(this,b);this.base=this;this._layerFsName="";this._credentials=decodeURIComponent(a);this.base.fullName=c;this._layerDescription="";this._tileImageFormat="png";this._dataSourceName="";this.initialize(d)}mcx.inherits(McxFsLayer,McxAbstractLayer);
McxFsLayer.prototype.initialize=function(a){this.base.alias=a.Alias;this.base.coordinateSystem=this.parseCoordinateSystem(a.AuthorityCode);this.base.classId=a.ClassId;this._dataSourceName=a.DataSourceName;this.base.deleteSupported=a.DeleteSupported;this.base.description=a.Description;this.base.schema=this.parseSchema(a.FieldDefinitions);this.base.fieldGeomertyArea=a.GeometryAreaField;this.base.fieldGeometry=a.GeometryField;this.base.fieldGeometryLength=a.GeometryLengthField;this.base.geometryType=
a.GeometryType;this.base.fieldGeometryX=a.GeometryX;this.base.fieldGeometryY=a.GeometryY;this.base.fieldGeometryZ=a.GeometryZ;this.base.groupName=a.Group;this.base.fieldGuid=a.GuidField;this.base.hasParameter=a.HasParameter;this.base.insertSupported=a.InsertSupported;this.base.isGroup=a.IsGroup;null!=a.KeyField&&""!=a.KeyField&&(this.base.fieldKey=a.KeyField);this.base.fieldLabelSymbolizer=a.LabelSymbolizerField;this._layerFsName=a.Name;this.base.fieldSymbolizer=a.SymbolizerField;this.base.updateSupported=
a.UpdateSupported;this.base.layerName=this._layerFsName.split(":")[1];this._layerDescription=a.Description;a=this.getName().split(":");0<a.length&&(this.base.dataSourceName=a[0]);this.base.subtypes=new McxSubtypeCollection(this);for(a=0;a<this.base.getSchema().getFieldCount();a++){var b=this.base.getSchema().getField(a);if(b.getFieldType()==McxDataType.String){this.base.labelFormat="["+b.getFieldName()+"]";break}}""==this.base.labelFormat&&0<this.base.getSchema().getFieldCount()&&(b=this.base.getSchema().getField(0),
this.base.labelFormat="["+b.getFieldName()+"]")};McxFsLayer.prototype.parseCoordinateSystem=function(a){var b=null;null!=a&&""!=a&&(a=parseInt(a,10),b=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(a));return b};
McxFsLayer.prototype.parseSchema=function(a){for(var b=new McxSchema,c=0;c<a.length;c++){var d=a[c],e=new McxFieldDefinition;e.setAlias(d.Alias);e.setDomainName(d.DomainName);e.setDescription(d.Description);e.setFieldName(d.FieldName);e.setFieldType(d.FieldType);e.setIsEditable(d.IsEditable);e.setIsIgnored(d.IsIgnored);e.setIsRequired(d.IsRequired);e.setIsPrimaryKey(d.IsPrimaryKey);e.setPrecision(d.Precision);e.setSize(d.Size);e.setDefaultValue(d.DefaultValue);b.addField(e)}return b};
McxFsLayer.prototype.getEnvelope=function(a){var b=new McxGetEnvelopeResult;b.setArgs(a.getArgs());var c="layerName="+this._layerFsName,d="token="+encodeURIComponent(this._credentials),c=McxAjaxServiceCall.getAjaxCall(this.base.fullName+"GetLayerEnvelope?"+d+"&"+c,null,[this],"json",this.base.cacheable,null,a.getAsync(),function(c){var d=this.qty_input[0];c=new McxBounds(c.MinX,c.MinY,c.MaxX,c.MaxY,d.getCoordinateSystem());d.envelope=c;b.setEnvelope(c);a.getAsync()&&a.getSuccess().call(a.getScope(),
b)},function(){a.getAsync()&&a.getError().call(a.getScope(),b)});b.setRequest(c);return b};
McxFsLayer.prototype.getFeatureCount=function(a){var b=new McxGetFeatureCountResult;b.setArgs(a.getArgs());var c="layerName="+this._layerFsName,d="token="+encodeURIComponent(this._credentials),c=McxAjaxServiceCall.getAjaxCall(this.base.fullName+"GetFeatureCount?"+d+"&"+c,null,[this,a],"json",this.base.cacheable,null,a.getAsync(),function(a){var c=this.qty_input[0],d=this.qty_input[1];a=parseInt(a,10);c.featureCount=a;b.setFeatureCount(a);d.getAsync()&&d.getSuccess().call(d.getScope(),b)},function(){a.getAsync()&&
a.getError().call(a.getScope(),b)});b.setRequest(c);return b};
McxFsLayer.prototype.findFeature=function(a){var b=null,c=this.getSchema().clone(),d=new McxAjaxParameter;d.setAsync(!1);var e="token="+encodeURIComponent(this._credentials),f="layerName="+this._layerFsName,g="filters="+this.getFilterCollection().toString(),h="",k="";isNaN(a)?(k=this.base.fullName+"FindFeaturesByGlobalIds?",h="globalIds="+a.toString()):(k=this.base.fullName+"FindFeatures?",h="featureIds="+a.toString());McxAjaxServiceCall.getAjaxCall(k+e+"&"+f+"&"+g+"&"+h,{},[this,d],"json",this.base.cacheable,
null,d.getAsync(),function(a){var d=this.qty_input[0];a=new McxFsFeatureReader(a,d,c,null,null);if(a.read())for(a=a.getCurrent(),b=new McxMemFeature(d,null),b.createFromFeature(a),d=b.getFieldCount(),a=0;a<d;a++)b.unsetField(a)},function(){});return b};
McxFsLayer.prototype.search=function(a,b,c,d,e){var f=new McxSearchResult;f.setArgs(e.getArgs());""==b?b=null:b.replace(/"/g,"'");for(var g=a.split(","),h=new McxSchema,k=0;k<g.length;k++){var m=g[k];""==m||"*"==m||"1=1"==m?h=this.base.getSchema().clone():(m=this.getSchema().getField(m).clone(),h.addField(m))}var n=this,g="";null!=c&&(c=c.transformTo(this.base.coordinateSystem),g+=c.toString());c=this.base.fullName+"search?";a={AttributeFilter:b,Envelope:"",Fields:a,Filters:this.base.getFilterCollection().toString(),
Geometry:g,LayerName:this._layerFsName,Token:this._credentials,Relation:d,Min:e.getMin().toString(),Max:e.getMax().toString()};this.qty_input=[];this.qty_input[0]=this;this.qty_input[1]=e;a=McxAjaxServiceCall.postAjaxCall(c,!0,JSON.stringify(a),"application/json",this.qty_input,"json",this.base.cacheable,null,e.getAsync(),function(a){var b=this.qty_input[1];a=new McxFsFeatureReader(a,this.qty_input[0],h,null,null);f.setFeatureReader(a);f.setLayer(n);b.getAsync()&&b.getSuccess().call(b.getScope(),
f)},function(){e.getAsync()&&e.getError().call(e.getScope(),f)});f.setRequest(a);return f};
McxFsLayer.prototype.query=function(a,b,c){var d=new McxSearchResult;d.setArgs(c.getArgs());null==a&&(a="");for(var e=a.split(","),f=new McxSchema,g=0;g<e.length;g++){var h=e[g];""==h||"*"==h||"1=1"==h?f=this.base.getSchema().clone():(h=this.getSchema().getField(h).clone(),f.addField(h))}var k=this,e="token="+encodeURIComponent(this._credentials),g="layerName="+this._layerFsName;a="fields="+a;var h="filters="+this.getFilterCollection().toString(),m="attributeFilter=",m=null!=b?m+b:""==b?m+"":m+"1=1";
b="min="+c.getMin().toString();var n="max="+c.getMax().toString();b=McxAjaxServiceCall.getAjaxCall(this.base.fullName+"query?"+e+"&"+g+"&"+a+"&"+h+"&"+m+"&"+b+"&"+n,{},[this,c],"json",this.base.cacheable,null,c.getAsync(),function(a){a=new McxFsFeatureReader(a,this.qty_input[0],f,null,null);d.setFeatureReader(a);d.setLayer(k);c.getAsync()&&c.getSuccess().call(c.getScope(),d)},function(){c.getAsync()&&c.getError().call(c.getScope(),d)});d.setRequest(b);return d};McxFsLayer.prototype.createEdit=function(){return new McxFsEdit(this)};
McxFsLayer.prototype.searchByEnvelope=function(a,b,c,d,e){var f=new McxSearchResult;f.setArgs(e.getArgs());""==b&&(b=null);for(var g=a.split(","),h=new McxSchema,k=0;k<g.length;k++){var m=g[k],m=this.getSchema().getField(m).clone();h.addField(m)}g="layerName="+this._layerFsName;k="token="+encodeURIComponent(this._credentials);a="fields="+a;b="whereClause="+b;m="envelope=";null!=c&&(c=c.transformTo(this.base.coordinateSystem),m+=c.getLeft()+" "+c.getBottom()+" "+c.getRight()+" "+c.getTop());d="relation="+
d;c="min="+e.getMin().toString();var n="max="+e.getMax().toString();d=McxAjaxServiceCall.getAjaxCall(this.base.fullName+"searchByEnvelope?"+k+"&"+g+"&"+a+"&"+b+"&"+m+"&"+d+"&"+c+"&"+n,{},[this],"text",this.base.cacheable,null,e.getAsync(),function(a){var b=this.qty_input[0];a=new McxFsFeatureReader(a,b,h,null,null);f.setFeatureReader(a);f.setLayer(b);e.getAsync()&&e.getSuccess().call(e.getScope(),f)},function(){e.getAsync()&&e.getError().call(e.getScope(),f)});f.setRequest(d);return f};
McxFsLayer.prototype.searchByAttributeWithDistinct=function(a,b,c){var d=new McxSearchResult;d.setArgs(c.getArgs());""==b&&(b=null);null==a&&(a="");for(var e=a.split(","),f=new McxSchema,g=0;g<e.length;g++){var h=e[g],h=this.getSchema().getField(h).clone();f.addField(h)}var k=this,e="layerName="+this._layerFsName,g="token="+encodeURIComponent(this._credentials);a="fields="+a;h="whereClause=";h=null!=b?h+b:h+"1=1";b="min="+c.getMin().toString();var m="max="+c.getMax().toString();b=McxAjaxServiceCall.getAjaxCall(this.base.fullName+
"SearchByAttributeWithDistinct?"+g+"&"+e+"&"+a+"&"+h+"&"+b+"&"+m,{},[this,c],"json",this.base.cacheable,null,c.getAsync(),function(a){a=new McxFsFeatureReader("/"+a,this.qty_input[0],f,null,null);d.setFeatureReader(a);d.setLayer(k);c.getAsync()&&c.getSuccess().call(c.getScope(),d)},function(){c.getAsync()&&c.getError().call(c.getScope(),d)});d.setRequest(b);return d};
McxFsLayer.prototype.searchByPost=function(a,b,c,d,e){var f=new McxSearchResult;f.setArgs(e.getArgs());""==b&&(b=null);for(var g=a.split(","),h=new McxSchema,k=0;k<g.length;k++){var m=g[k],m=this.getSchema().getField(m).clone();h.addField(m)}var n=this,g="",k=c;null!=this.base.coordinateSystem&&(k=c.transformTo(this.base.coordinateSystem));g+=k.toString();c="";null!=b&&(c=b);b=this._layerFsName;k={};k.Token=this._credentials;k.LayerName=mcx.urlDecode(b);k.Fields=a;k.WhereClause=c;k.Geometry=g;k.Relation=
d;k.Min=e.getMin().toString();k.Max=e.getMax().toString();a=McxAjaxServiceCall.postAjaxCall(this.base.fullName+"searchByParam",!0,JSON.stringify(k),"application/json",e.getArgs(),"json",!1,null,e.getAsync(),function(a){a=new McxFsFeatureReader("'"+a+"'",n,h,null,null);f.setFeatureReader(a);f.setLayer(n);e.getAsync()&&e.getSuccess().call(e.getScope(),f)},function(){var a=new McxFsFeatureReader("",this,h,null,null);f.setFeatureReader(a);f.setLayer(this);e.getAsync()&&e.getError().call(e.getScope(),
f)});f.setRequest(a);return f};
McxFsLayer.prototype.getMap=function(a,b,c,d,e,f){e=f.getArgs()[5];var g=f.getArgs()[6],h=f.getArgs()[7];d=[];e.getWorld();var k=b;null!=this.base.coordinateSystem&&(k=b.transformTo(this.base.coordinateSystem),e.getWorld().transformTo(this.base.coordinateSystem));c=new McxSearchResult;c.setArgs(f.getArgs());var m=k,k=new McxPoint(m.getLeft(),m.getTop(),m.getCoordinateSystem());b=new McxPoint(m.getRight(),m.getBottom(),m.getCoordinateSystem());var m=Math.min(k.getX(),b.getX()),n=Math.min(k.getY(),
b.getY()),p=Math.max(k.getX(),b.getX()),k=Math.max(k.getY(),b.getY()),q=new McxBounds(m,n,p,k,this.base.coordinateSystem),m=q;m.setCoordinateSystem(this.base.coordinateSystem);if(0>=m.getWidth()||0>=m.getHeight())return d=new McxFsTileFeatureReader(this,d),c.setFeatureReader(d),f.getAsync()&&f.getSuccess().call(f.getScope(),c),c;q=m;k=new Image;n="envelope="+q.toString()+"&";p="&format=image/"+this._tileImageFormat;b=e.getWorld().transformTo(this.base.getCoordinateSystem());var r=e.getDisplay(),t=
this.worldToView(b,r,q.getLeft(),q.getBottom()),u=this.worldToView(b,r,q.getRight(),q.getTop());b=Math.min(t.getX(),u.getX());q=Math.min(t.getY(),u.getY());r=Math.max(t.getX(),u.getX());t=Math.max(t.getY(),u.getY());b=new McxBounds(b,q,r,t,null);g="&width="+(g+1).toString()+"&height="+(h+1).toString();h="";t=this.base.getFilterCollection();if(null!=t&&0<t.getCount())for(q=0;q<t.getCount();q++)r=t.getFilter(q).getAttributeFilter(),null!=r&&""!=r&&""!=h&&(h=h+" AND "+r);h="&whereClause="+encodeURIComponent(h);
a=this.base.fullName+"/GetMap?token="+encodeURIComponent(this._credentials)+"&layerNames="+mcx.urlEncode(a)+"&"+n+g+p+h;m.setCoordinateSystem(this.base.coordinateSystem);h=m.transformTo(e.getCoordinateSystem());g=e.worldToView(h.getPoints()[0].getX(),h.getPoints()[0].getY());n=e.worldToView(h.getPoints()[2].getX(),h.getPoints()[2].getY());e=Math.min(g.getX(),n.getX());h=Math.min(g.getY(),n.getY());m=Math.max(g.getX(),n.getX());g=Math.max(g.getY(),n.getY());new McxBounds(e,h,m,g,null);e=McxFactoryFinder.GeometryFactory(null).createPolygon(b,
null);a=new McxFsTileFeature(this,e,k,null,a);d.push(a);a=new McxFsTileFeatureReader(this,d);c.setFeatureReader(a);c.setLayer(this);for(a=0;a<d.length;a++)c.addImage(d[a].getImage());f.getAsync()&&f.getSuccess().call(f.getScope(),c);return c};
McxFsLayer.prototype.fastSearch=function(a,b,c,d,e,f,g){var h=new McxSearchResult;h.setArgs(g.getArgs());var k=new McxSchema;if(""==a)k=this.base.getSchema();else{var m=a.split(",");for(b=0;b<m.length;b++){var n=m[b],n=this.getSchema().getField(n).clone();k.addField(n)}}e=null!=e?e:g.getArgs()[0];f=null!=f?f:g.getArgs()[1];d="searchEnvelope="+d.getLeft().toString()+" "+d.getBottom().toString()+" "+d.getRight().toString()+" "+d.getTop().toString();e="worldEnvelope="+e.getLeft().toString()+" "+e.getBottom().toString()+
" "+e.getRight().toString()+" "+e.getTop().toString();f="viewEnvelope="+Math.ceil(f.getLeft())+" "+Math.ceil(f.getBottom())+" "+Math.floor(f.getWidth()).toString()+" "+Math.floor(f.getHeight()).toString();m=this.base.getFilterCollection();n=[];for(b=0;b<m.getCount();b++){var p=[],q=m.getFilter(b);p.push(q.getAttributeFilter());p.push("");p.push("");p.push("");n.push(p.join(";"))}b="filters="+n.join("~").replace(/"/g,"'");a="fields="+a;var m="layerName="+this._layerFsName,n="token="+encodeURIComponent(this._credentials),
p="labelScript="+(null==c?"":encodeURIComponent(c+"")),r="max=",q="min="+g.getMin().toString(),r=r+g.getMax().toString();a=McxAjaxServiceCall.getAjaxCall(this.base.fullName+"fastSearch?"+n+"&"+m+"&"+a+"&"+p+"&"+b+"&"+d+"&"+e+"&"+f+"&"+q+"&"+r,{},[this,g],"json",this.base.cacheable,null,g.getAsync(),function(a){var b=this.qty_input[0],d=this.qty_input[1],e=d.getArgs();null==c?(a=new McxFsFeatureReader(a,b,k,e[0],e[1]),h.setFeatureReader(a),h.setLayer(b)):h.setLabelString(a);d.getAsync()&&d.getSuccess().call(d.getScope(),
h)},function(){g.getAsync()&&g.getError().call(g.getScope(),h)});h.setRequest(a);return h};
McxFsLayer.prototype.spatialOperation=function(a,b,c,d){var e=new McxResult;e.setArgs(c.getArgs());var f=this.getSchema().clone();b="token="+encodeURIComponent(this._credentials);var g="inputLayerName="+this._layerFsName;a="methodLayerName="+a.getDataSource().getName()+":"+this._layerFsName;d=McxAjaxServiceCall.getAjaxCall(this.base.fullName+"SpatialOperation?"+b+"&"+g+"&"+a+"&"+("operationName="+d),{},[this],"json",this.base.cacheable,null,c.getAsync(),$.proxy(function(a){var b=this.qty_input[0],
d=new McxFsLayer(b._credentials,b.dataSource,b.dataSource.getSource(),a),g=new McxFsFeatureReader("/"+a.Features,d,f,null,null);a=new McxMemDriver;b=new McxAjaxParameter;b.setAsync(c.getAsync());b.setParameters(this,function(a){a=a.getDataSource();var b=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(4326),f=a.createLayer(d.getName(),b,McxGeometryType.Unknown,[]);a=f.createEdit();for(b=[];g.read();){var h=g.getCurrent(),k=f.createFeatureBuffer();k.setGeometry(h.getGeometry());b.push(k)}h=
new McxAjaxParameter;h.setAsync(c.getAsync());h.setParameters(this,function(){c.getAsync()&&c.getSuccess().call(f,e)},null);a.insertRange(b,h)},null);a.openDataSource("")},this),function(){c.getAsync()&&c.getError().call(c.getScope(),e)});e.setRequest(d);return e};McxFsLayer.prototype.isInstanceOf=function(a){return"IMcxLabeledLayer"==a||"McxFsLayer"==a||"IMcxSelectableLayer"==a||"IMcxSnappableLayer"==a||"IMcxQueryLayer"==a||"IMcxMediaManager"==a||"IMcxSubtypedLayer"==a};
McxFsLayer.prototype.getFeatures=function(a,b){var c=new McxSearchResult;c.setArgs(b.getArgs());null==a?a="":a instanceof Array&&(a=a.join(","));for(var d=a.split(","),e=new McxSchema,f=0;f<d.length;f++){var g=d[f],g=this.getSchema().getField(g).clone();e.addField(g)}var d="layerName="+this._layerFsName,f="token="+encodeURIComponent(this._credentials),g="fields="+a,h="min="+b.getMin().toString(),k="max="+b.getMax().toString(),d=McxAjaxServiceCall.getAjaxCall(this.base.fullName+"searchByAttribute?"+
f+"&"+d+"&"+g+"&whereClause=1=1&"+h+"&"+k,{},[this,b],"json",this.base.cacheable,null,b.getAsync(),function(a){a=new McxFsFeatureReader("/"+a,this.qty_input[0],e,null,null);c.setFeatureReader(a);c.setLayer(this);b.getAsync()&&b.getSuccess().call(b.getScope(),c)},function(){b.getAsync()&&b.getError().call(b.getScope(),c)});c.setRequest(d);return c};McxFsLayer.prototype.createFeatureBuffer=function(){return new McxMemFeature(this,null)};
McxFsLayer.prototype.getSelection=function(){var a=[],b;for(b in this.base.selectedFeatures)a.push(this.base.selectedFeatures[b]);return new McxMemFeatureReader(a)};
McxFsLayer.prototype.labelOf=function(a){var b=this.getLabelFormat(),c=!0;if(null==b)return b;for(;1==c;){var d=b.match(/\{(.*?)\}/);if(null==d)c=!1;else{var e="",f=d[1],g=a.getValue(f);g||(g=new McxAjaxParameter,g.setAsync(!1),a.setAttribute(g,f),g=a.getValue(f));if(g){f=a.getField(f).getDomainName();if(!g)return"---";if(f){var h=new McxAjaxParameter;h.setAsync(!1);var k=this.getDataSourceName();if(f=this.getDataSource().getDomain(k,f,h).getDomain()){var f=f.getCodedValues(),m;for(m in f)if(f[m].getCode()==
g){e=f[m].getValue();break}else e=g.toString()}else e=g.toString()}else e=g.toString()}e=e&&"null"!=e?e:"";b=b.replace(d[0],e)}}return b};McxFsLayer.prototype.getDescription=function(){return this._layerDescription};McxFsLayer.prototype.getFsLayerName=function(){return this._layerFsName};
McxFsLayer.prototype.worldToView=function(a,b,c,d){if(0>=a.getWidth()||0>=a.getHeight())return null;var e=-1*a.getLeft(),f=-1*a.getBottom(),g=b.getWidth()/a.getWidth();a=b.getHeight()/a.getHeight();c=b.getLeft()+(c+e)*g;b=b.getBottom()+(b.getHeight()-(d+f)*a);return new McxPoint(c,b,null)};
McxFsLayer.prototype.deleteMedia=function(a,b){var c=new McxResult;c.setArgs(b.getArgs());var d="layerName="+this._layerFsName,e="token="+encodeURIComponent(this._credentials),d=McxAjaxServiceCall.getAjaxCall(this.base.fullName+"deleteMedia?"+e+"&"+d+"&"+("mediaId="+a),{},[this,b],"json",this.base.cacheable,null,b.getAsync(),function(){b.getAsync()&&b.getSuccess().call(b.getScope(),c)},function(){b.getAsync()&&b.getError().call(b.getScope(),c)});c.setRequest(d);return c};
McxFsLayer.prototype.deleteMediaByFeatureId=function(a,b){var c=new McxResult;c.setArgs(b.getArgs());var d="layerName="+this._layerFsName,e="token="+encodeURIComponent(this._credentials),d=McxAjaxServiceCall.getAjaxCall(this.base.fullName+"deleteMediaByFeatureId?"+e+"&"+d+"&"+("featureId="+a),{},[this,b],"json",this.base.cacheable,null,b.getAsync(),function(){b.getAsync()&&b.getSuccess().call(b.getScope(),c)},function(){b.getAsync()&&b.getError().call(b.getScope(),c)});c.setRequest(d);return c};
McxFsLayer.prototype.deleteMediaByGlobalId=function(a,b){var c=new McxResult;c.setArgs(b.getArgs());var d="layerName="+this._layerFsName,e="token="+encodeURIComponent(this._credentials),d=McxAjaxServiceCall.getAjaxCall(this.base.fullName+"deleteMediaByGlobalId?"+e+"&"+d+"&"+("globalId="+a),{},[this,b],"json",this.base.cacheable,null,b.getAsync(),function(){b.getAsync()&&b.getSuccess().call(b.getScope(),c)},function(){b.getAsync()&&b.getError().call(b.getScope(),c)});c.setRequest(d);return c};
McxFsLayer.prototype.getMediaCategories=function(a){var b=new McxMediaCategoryResult;b.setArgs(a.getArgs());var c="layerName="+this._layerFsName,d="token="+encodeURIComponent(this._credentials),c=McxAjaxServiceCall.getAjaxCall(this.base.fullName+"getMediaCategories?"+d+"&"+c,{},[this,a],"json",this.base.cacheable,null,a.getAsync(),function(c){for(var d=[],g=0;g<c.length;g++){var h=c[g],k=h.CategoryId,m=h.CategoryName,n=h.MediaType,p=h.StorageType,h=h.Uri,q=new McxMediaCategory;q.setCategoryId(k);
q.setCategoryName(m);q.setMediaType(n);q.setStorageType(p);q.setUri(h);d.push(q)}b.setMediaCategories(d);a.getAsync()&&a.getSuccess().call(a.getScope(),b)},function(){a.getAsync()&&a.getError().call(a.getScope(),b)});b.setRequest(c);return b};
McxFsLayer.prototype.getMediaCategory=function(a,b){var c=new McxMediaCategoryResult;c.setArgs(b.getArgs());var d="layerName="+this._layerFsName,e="token="+encodeURIComponent(this._credentials),d=McxAjaxServiceCall.getAjaxCall(this.base.fullName+"getMediaCategory?"+e+"&"+d+"&"+("categoryId="+a),{},[this,b],"json",this.base.cacheable,null,b.getAsync(),function(a){var d=[],e=a.CategoryId,k=a.CategoryName,m=a.MediaType,n=a.StorageType;a=a.Uri;var p=new McxMediaCategory;p.setCategoryId(e);p.setCategoryName(k);
p.setMediaType(m);p.setStorageType(n);p.setUri(a);d.push(p);c.setMediaCategories(d);b.getAsync()&&b.getSuccess().call(b.getScope(),c)},function(){b.getAsync()&&b.getError().call(b.getScope(),c)});c.setRequest(d);return c};
McxFsLayer.prototype.getMediaData=function(a,b){var c=new McxMediaDataResult;c.setArgs(b.getArgs());var d="layerName="+this._layerFsName,e="token="+encodeURIComponent(this._credentials);c.setMediaData(this.base.fullName+"getMediaData?"+e+"&"+d+"&"+("mediaId="+a));b.getAsync()&&b.getSuccess().call(b.getScope(),c);return c};
McxFsLayer.prototype.getMediaInfo=function(a,b){var c=new McxMediaInfoResult;c.setArgs(b.getArgs());var d="layerName="+this._layerFsName,e="token="+encodeURIComponent(this._credentials),d=McxAjaxServiceCall.getAjaxCall(this.base.fullName+"GetMediaInfo?"+e+"&"+d+"&"+("mediaId="+a),{},[this,b],"json",this.base.cacheable,null,b.getAsync(),function(a){for(var d=[],e=0;e<a.length;e++){var k=a[e],m=k.CategoryId,n=k.ContentType,p=k.DateCreated,q=k.FileName,r=k.FileSize,t=k.MediaId,k=k.OriginalFileName,u=
new McxMediaInfo;u.setCategoryId(m);u.setContentType(n);u.setDateCreated(p);u.setFileName(q);u.setFileSize(r);u.setMediaId(t);u.setOriginalFileName(k);d.push(u)}c.setMediaInfo(d);b.getAsync()&&b.getSuccess().call(b.getScope(),c)},function(){b.getAsync()&&b.getError().call(b.getScope(),c)});c.setRequest(d);return c};
McxFsLayer.prototype.getMediaInfoByMediaGlobalId=function(a,b){var c=new McxMediaInfoResult;c.setArgs(b.getArgs());var d="layerName="+this._layerFsName,e="token="+encodeURIComponent(this._credentials),d=McxAjaxServiceCall.getAjaxCall(this.base.fullName+"GetMediaInfo?"+e+"&"+d+"&"+("mediaGlobalId="+a),{},[this,b],"json",this.base.cacheable,null,b.getAsync(),function(a){for(var d=[],e=0;e<a.length;e++){var k=a[e],m=k.CategoryId,n=k.ContentType,p=k.DateCreated,q=k.FileName,r=k.FileSize,t=k.MediaId,k=
k.OriginalFileName,u=new McxMediaInfo;u.setCategoryId(m);u.setContentType(n);u.setDateCreated(p);u.setFileName(q);u.setFileSize(r);u.setMediaId(t);u.setOriginalFileName(k);d.push(u)}c.setMediaInfo(d);b.getAsync()&&b.getSuccess().call(b.getScope(),c)},function(){b.getAsync()&&b.getError().call(b.getScope(),c)});c.setRequest(d);return c};
McxFsLayer.prototype.getMediaInfoByFeatureId=function(a,b,c){var d=new McxMediaInfoResult;d.setArgs(c.getArgs());var e="layerName="+this._layerFsName,f="token="+encodeURIComponent(this._credentials);a=McxAjaxServiceCall.postAjaxCall(this.base.fullName+"GetMediaInfosByFeatureId?"+f+"&"+e+"&"+("featureId="+a),!0,JSON.stringify(b),"application/json",[this,c],"json",!1,null,c.getAsync(),function(a){for(var b=[],e=0;e<a.length;e++){var f=a[e],n=f.CategoryId,p=f.ContentType,q=f.DateCreated,r=f.FileName,
t=f.FileSize,u=f.MediaId,f=f.OriginalFileName,v=new McxMediaInfo;v.setCategoryId(n);v.setContentType(p);v.setDateCreated(q);v.setFileName(r);v.setFileSize(t);v.setMediaId(u);v.setOriginalFileName(f);b.push(v)}d.setMediaInfo(b);c.getAsync()&&c.getSuccess().call(c.getScope(),d)},function(){c.getAsync()&&c.getError().call(c.getScope(),d)});d.setRequest(a);return d};
McxFsLayer.prototype.getMediaInfosByFeatureIds=function(a,b,c){var d=new McxMediaInfoResult;d.setArgs(c.getArgs());var e="layerName="+this._layerFsName,f="token="+encodeURIComponent(this._credentials),g="min="+c.getMin().toString(),h="max="+c.getMax().toString(),e=this.base.fullName+"GetMediaInfosByFeatureId?"+f+"&"+e+"&"+g+"&"+h,f={};f.categoryId=b;f.featureIds=a;a=McxAjaxServiceCall.postAjaxCall(e,!0,JSON.stringify(f),"application/json",[this,c],"json",!1,null,c.getAsync(),function(a){for(var b=
[],e=0;e<a.length;e++){var f=a[e],g=f.CategoryId,h=f.ContentType,t=f.DateCreated,u=f.FileName,v=f.FileSize,w=f.MediaId,f=f.OriginalFileName,x=new McxMediaInfo;x.setCategoryId(g);x.setContentType(h);x.setDateCreated(t);x.setFileName(u);x.setFileSize(v);x.setMediaId(w);x.setOriginalFileName(f);b.push(x)}d.setMediaInfo(b);c.getAsync()&&c.getSuccess().call(c.getScope(),d)},function(){c.getAsync()&&c.getError().call(c.getScope(),d)});d.setRequest(a);return d};
McxFsLayer.prototype.getMediaInfoByGlobalId=function(a,b,c){var d=new McxMediaInfoResult;d.setArgs(c.getArgs());var e="layerName="+this._layerFsName,f="token="+encodeURIComponent(this._credentials);a="globalId="+a;var g="min="+c.getMin().toString(),h="max="+c.getMax().toString();b=McxAjaxServiceCall.postAjaxCall(this.base.fullName+"GetMediaInfosByGlobalIds?"+f+"&"+e+"&"+a+"&"+g+"&"+h,!0,b,"application/json",[this,c],"json",!1,null,c.getAsync(),function(a){for(var b=[],e=0;e<a.length;e++){var f=a[e],
g=f.CategoryId,h=f.ContentType,t=f.DateCreated,u=f.FileName,v=f.FileSize,w=f.MediaId,f=f.OriginalFileName,x=new McxMediaInfo;x.setCategoryId(g);x.setContentType(h);x.setDateCreated(t);x.setFileName(u);x.setFileSize(v);x.setMediaId(w);x.setOriginalFileName(f);b.push(x)}d.setMediaInfo(b);c.getAsync()&&c.getSuccess().call(c.getScope(),d)},function(){c.getAsync()&&c.getError().call(c.getScope(),d)});d.setRequest(b);return d};
McxFsLayer.prototype.getMediaInfosByGlobalIds=function(a,b,c){var d=new McxMediaInfoResult;d.setArgs(c.getArgs());var e="layerName="+this._layerFsName,f="token="+encodeURIComponent(this._credentials),g="min="+c.getMin().toString(),h="max="+c.getMax().toString(),e=this.base.fullName+"GetMediaInfosByFeatureId?"+f+"&"+e+"&"+g+"&"+h,f={};f.categoryId=b;f.globalIds=a;a=McxAjaxServiceCall.postAjaxCall(e,!0,JSON.stringify(f),"application/json",[this,c],"json",!1,null,c.getAsync(),function(a){for(var b=[],
e=0;e<a.length;e++){var f=a[e],g=f.CategoryId,h=f.ContentType,t=f.DateCreated,u=f.FileName,v=f.FileSize,w=f.MediaId,f=f.OriginalFileName,x=new McxMediaInfo;x.setCategoryId(g);x.setContentType(h);x.setDateCreated(t);x.setFileName(u);x.setFileSize(v);x.setMediaId(w);x.setOriginalFileName(f);b.push(x)}d.setMediaInfo(b);c.getAsync()&&c.getSuccess().call(c.getScope(),d)},function(){c.getAsync()&&c.getError().call(c.getScope(),d)});d.setRequest(a);return d};
McxFsLayer.prototype.addMediaContent=function(a,b,c,d,e,f){var g=e.name;g.substring(g.lastIndexOf(".")+1).toLowerCase();var h=new McxMediaContentResult;h.setArgs(f.getArgs());var g="layerName="+this._layerFsName,k="token="+encodeURIComponent(this._credentials);a="categoryId="+a;c="featureId="+c;b="globalId="+b;d="userId="+d;var m="fileName="+e.name,g=this.base.fullName.toLowerCase().replace("mcxfeatureservice.svc/rest/json/","")+"Upload/AddMedia?"+k+"&"+g+"&"+a+"&"+c+"&"+b+"&"+d+"&"+m+"&contentType=null";
e=McxAjaxServiceCall.PostAjaxStreamCall(g,e,null,function(a){var b=a.currentTarget.responseText,b=""!=b?JSON.parse(b):[],c=Array(b.length);if(void 0!=b.ExceptionMessage)return h.setExceptionMessage(new McxExceptionMessage(a.currentTarget)),f.getAsync()&&f.getError().call(f.getScope(),h),h;h.setMediaContents(c);f.getAsync()&&f.getSuccess().call(f.getScope(),h)},function(a){f.getError().call(f.getScope(),h)});h.setRequest(e);return h};
McxFsLayer.prototype.getMediaUri=function(a){var b="layerName="+this._layerFsName,c="token="+encodeURIComponent(this._credentials);return this.base.fullName+"getMediaData?"+c+"&"+b+"&"+("mediaId="+a)};
McxFsLayer.prototype.insertFeatures=function(a,b){1>a.length&&b.getError().call(b.getScope(),null);var c=this.getFsLayerName(),d=this.getFilterCollection().toString(),c={FeatureIds:"",Features:McxFsConverter.featuresToString(a,null),Filters:d,LayerName:c,Token:this._credentials},e=new McxCommitResult;e.setFeatures(a);c=McxAjaxServiceCall.postAjaxCall(this.base.fullName+"InsertFeatures",!0,JSON.stringify(c),"application/json",null,"json",!1,null,!1,function(a){for(var c=e.getFeatures(),d=0;d<c.length;d++)c[d].setFeatureID(parseInt(a,
10));b.getSuccess().call(b.getScope(),e)},function(){b.getError().call(b.getScope(),null)});e.setRequest(c);return e};
McxFsLayer.prototype.deleteFeatures=function(a,b){var c=this.getFsLayerName(),d=this.getFilterCollection().toString(),d={FeatureIds:a.join(","),Features:"",Filters:d,LayerName:c,Token:this._credentials},c=new McxCommitResult,d=McxAjaxServiceCall.postAjaxCall(this.base.fullName+"DeleteFeatures",!0,JSON.stringify(d),"application/json",null,"json",!1,null,!1,function(){b.getSuccess().call(b.getScope(),null)},function(){b.getError().call(b.getScope(),null)});c.setRequest(d);return c};
McxFsLayer.prototype.updateFeatures=function(a,b){1>a.length&&b.getError().call(b.getScope(),null);var c=this.getFsLayerName(),d=this.getFilterCollection().toString(),c={FeatureIds:"",Features:McxFsConverter.featuresToString(a,null),Filters:d,LayerName:c,Token:this._credentials},e=new McxCommitResult,c=McxAjaxServiceCall.postAjaxCall(this.base.fullName+"UpdateFeatures",!0,JSON.stringify(c),"application/json",null,"json",!1,null,!1,function(c){e.setFeatures(a);b.getSuccess().call(b.getScope(),e)},
function(){b.getError().call(b.getScope(),null)});e.setRequest(c);return e};js.framework.driver.McxFsDriver.McxFsReportResult={};function McxFsReportResult(){mcx.base(this);this.contents=[]}mcx.inherits(McxFsReportResult,McxResult);McxFsReportResult.prototype.getReports=function(){return this.contents};McxFsReportResult.prototype.setReports=function(a){this.contents=a};var McxReportType={FPX:0,PDF:1,XLSX:2,DOCX:3,PPTX:4,ODS:5,ODT:6,MHT:7,CSV:8,DBF:9,XML:10,TXT:11,RTF:12,XPS:13};js.framework.driver.McxFsDriver.McxFsTileFeature={};function McxFsTileFeature(a,b,c,d,e){this.layer=a;this.polygon=b;this.image=c;this.src=e;this.guid="";this.symbolizer=null;this.values=[];this._schema=d}McxFsTileFeature.prototype.getSymbolizer=function(){return this.symbolizer};McxFsTileFeature.prototype.setSymbolizer=function(a){this.symbolizer=a};McxFsTileFeature.prototype.getField=function(a){};McxFsTileFeature.prototype.getFieldName=function(a){};McxFsTileFeature.prototype.getFieldOrdinal=function(a){};
McxFsTileFeature.prototype.getValue=function(a){};McxFsTileFeature.prototype.setValue=function(a,b){};McxFsTileFeature.prototype.getGeometry=function(){return this.polygon};McxFsTileFeature.prototype.setGeometry=function(a){this.polygon=a};McxFsTileFeature.prototype.getFieldCount=function(){return 0};McxFsTileFeature.prototype.getValueWithName=function(a){return this.values[a]};McxFsTileFeature.prototype.getName=function(a){return this.values.keys[a]};McxFsTileFeature.prototype.getGlobalID=function(){return this.guid};
McxFsTileFeature.prototype.setGlobalID=function(a){this.guid=a};McxFsTileFeature.prototype.getOrdinal=function(a){a=this.values[a];var b=0,c;for(c in this.values){if(c==a)return b;b++}return 0};McxFsTileFeature.prototype.getLayer=function(){return this.layer};McxFsTileFeature.prototype.getFeatureID=function(){return 0};McxFsTileFeature.prototype.setFeatureID=function(a){this.values[this.layer.getKeyField().toString()]=a};McxFsTileFeature.prototype.getFieldType=function(a){return this.layer.getSchema().getField(a).getFieldType()};
McxFsTileFeature.prototype.unChangeField=function(a){};McxFsTileFeature.prototype.isFieldChange=function(a){return!1};McxFsTileFeature.prototype.isInstanceOf=function(a){return"McxFsTileFeature"==a};McxFsTileFeature.prototype.convertToString=function(a){};McxFsTileFeature.prototype.getImage=function(){return this.image};McxFsTileFeature.prototype.getQueryString=function(){return this.src};McxFsTileFeature.prototype.getSchema=function(){return this._schema};js.framework.driver.McxFsDriver.McxFsTileFeatureReader={};function McxFsTileFeatureReader(a,b){this.features=b;this.layer=a;this.closed=!1;this.cursor=-1;this.drawnFeatures=0}McxFsTileFeatureReader.prototype.isClosed=function(){return this.closed};McxFsTileFeatureReader.prototype.read=function(){return++this.cursor<this.features.length};McxFsTileFeatureReader.prototype.getCurrent=function(){return this.features[this.cursor]};McxFsTileFeatureReader.prototype.close=function(){this.closed=!0};
McxFsTileFeatureReader.prototype.addFeature=function(a){this.features.push(a)};McxFsTileFeatureReader.prototype.count=function(){return this.features.length};McxFsTileFeatureReader.prototype.getDrawnCountFeatures=function(){return this.drawnFeatures};McxFsTileFeatureReader.prototype.increaseDrawnFeaturesCount=function(a){this.drawnFeatures+=a};McxFsTileFeatureReader.prototype.getFeatureCount=function(){return this.features.length};McxFsTileFeatureReader.prototype.toArray=function(){return this.features};js.framework.driver.McxFsDriver.McxLayerParam={};function McxLayerParam(a,b){this._name=a;this._attributeFilter=b}McxLayerParam.prototype.getName=function(){return this._name};McxLayerParam.prototype.getAttributeFilter=function(){return this._attributeFilter};js.framework.driver.McxFsDriver.McxMediaCatalog={};function McxMediaCatalog(a,b,c,d){this._catagoryName=b;this._fieldName=c;this._mediaType=d;this._categoryId=a}McxMediaCatalog.prototype.getMediaType=function(){return this._mediaType};McxMediaCatalog.prototype.getFieldName=function(){return this._fieldName};McxMediaCatalog.prototype.getCategoryName=function(){return this._catagoryName};McxMediaCatalog.prototype.getCategoryId=function(){return this._categoryId};js.framework.driver.McxFsDriver.McxMediaCatalogResult={};function McxMediaCatalogResult(){mcx.base(this);this.catalogs=[]}mcx.inherits(McxMediaCatalogResult,McxResult);McxMediaCatalogResult.prototype.getMediaCatalogs=function(){return this.catalogs};McxMediaCatalogResult.prototype.setMediaCatalogs=function(a){this.catalogs=a};js.framework.driver.McxFsDriver.McxMediaContentResult={};function McxMediaContentResult(){mcx.base(this);this.contents=[]}mcx.inherits(McxMediaContentResult,McxResult);McxMediaContentResult.prototype.getMediaContents=function(){return this.contents};McxMediaContentResult.prototype.setMediaContents=function(a){this.contents=a};
js.framework.driver.McxTileDriver={};js.framework.driver.McxTileDriver.IMcxTileLayer={};function IMcxTileLayer(){}IMcxTileLayer.prototype.getTileParameter=function(a,b,c){};js.framework.driver.McxTileDriver.McxCacheLayer={};function McxCacheLayer(a,b,c,d){mcx.base(this,b);this.base=this;this.credentials=a;this.base.fullName=c;this.scaleArray=[];this.pixelScaleArray=[];this.orientation=this.size=null;this.topLeft=!0;this.tileCacheScale=null;this.initialize(d)}mcx.inherits(McxCacheLayer,McxAbstractLayer);
McxCacheLayer.prototype.initialize=function(a){this.base.serviceLayerName=a.Name;this.base.layerName=a.Name.split(":")[1];this.base.description=a.Description;var b=a.Envelope.MinX,c=a.Envelope.MinY,d=a.Envelope.MaxX,e=a.Envelope.MaxY,f=a.OrientationX,g=a.OrientationY;this.orientation=McxFactoryFinder.GeometryFactory(this.coordinateSystem).createPoint(f,g);this.base.envelope=new McxBounds(b,c,d,e,this.base.coordinateSystem);b=a.TileScaleLevels;for(c=0;c<b.length;c++)d=b[c],d=new McxTileScaleLevel(d.LevelID,
d.Resolution,d.Scale),this.scaleArray.push(d);this.size=McxFactoryFinder.GeometryFactory(null).createSize(a.ImageSize.width,a.ImageSize.height);this.tileCacheScale=new McxTileScaleCollection(this.scaleArray)};
McxCacheLayer.prototype.searchByEnvelope=function(a,b,c,d,e){b=e.getArgs()[5];a=[];c=this.getTileParameter(b,c,0);for(b=0;b<c.length;b++){d=c[b];var f=new Image,g=McxFactoryFinder.GeometryFactory(null).createPolygon(d.getDisplay(),null);d=new McxTileFeature(this,g,f,null,d.getImageUrl());a.push(d)}c=new McxSearchResult;c.setArgs(e.getArgs());b=new McxTileFeatureReader(this,a);c.setFeatureReader(b);c.setLayer(this);for(b=0;b<a.length;b++)c.addImage(a[b].getImage());e.getAsync()&&e.getSuccess().call(e.getScope(),
c);return c};McxCacheLayer.prototype.isInstanceOf=function(a){return"IMcxTileLayer"==a||"McxCacheLayer"==a};McxCacheLayer.prototype.getAppropriateTileScale=function(a){for(var b=Number.MAX_VALUE,c=-1,d=0;d<this.tileCacheScale.getScaleLength();d++){var e=Math.abs(1/this.tileCacheScale.getAt(d).getScale()-a);e<b&&(b=e,c=d)}return c};
McxCacheLayer.prototype.getTileParameter=function(a,b,c){c=[];var d=a.getWorld().transformTo(this.base.coordinateSystem);Math.sqrt(d.getWidth()*d.getWidth()+d.getHeight()*d.getHeight());Math.sqrt(a.getDisplay().getWidth()*a.getDisplay().getWidth()+a.getDisplay().getHeight()*a.getDisplay().getHeight());var d=a.getScale(),e=this.size,d=this.getAppropriateTileScale(d),f=this.tileCacheScale.getAt(d).getResolution(),g=1;null!=this.base.getCoordinateSystem()&&(g=this.base.getCoordinateSystem().getDistancePerUnit());
var h=f*e.getWidth()/g,e=f*e.getHeight()/g,g=b.transformTo(this.base.coordinateSystem);if(this.topLeft){var k=Math.ceil((g.getLeft()-this.orientation.getX())/h)-1;b=Math.floor((g.getRight()-this.orientation.getX())/h);f=-Math.floor((g.getTop()-this.orientation.getY())/e)-1;g=-Math.ceil((g.getBottom()-this.orientation.getY())/e)}else k=Math.ceil((g.getLeft()-this.orientation.getX())/h)-1,f=Math.ceil((g.getBottom()-this.orientation.getY())/e)-1,b=Math.floor((g.getRight()-this.orientation.getX())/h),
g=Math.floor((g.getTop()-this.orientation.getY())/e);0>k&&(k=0);0>b&&(b=0);0>f&&(f=0);0>g&&(g=0);for(var m=this.base.fullName+"/getTile?token="+encodeURIComponent(this.credentials)+"&layerName="+this.serviceLayerName;k<=b;k++)for(var n=this.orientation.getX()+k*h,p=this.orientation.getX()+(k+1)*e,q=f;q<=g;q++){if(this.topLeft)var r=this.orientation.getY()-q*e,t=this.orientation.getY()-(q+1)*e;else r=this.orientation.getY()+q*e,t=this.orientation.getY()+(q+1)*e;var r=(new McxPoint(n,r,this.base.coordinateSystem)).transformTo(a.getCoordinateSystem()),
r=a.worldToView(r.getX(),r.getY()),t=(new McxPoint(p,t,this.base.coordinateSystem)).transformTo(a.getCoordinateSystem()),u=a.worldToView(t.getX(),t.getY()),t=Math.min(r.x,u.x),v=Math.min(r.y,u.y),w=Math.max(r.x,u.x),r=Math.max(r.y,u.y),r=new McxBounds(t,v,Math.ceil(w),Math.ceil(r),null),r=new McxTileParameter(m+"&x="+k.toString()+"&y="+q.toString()+"&z="+d.toString(),r);c.push(r)}return c};McxCacheLayer.prototype.createFeatureBuffer=function(){return null};
McxCacheLayer.prototype.getPixelScale=function(a){return this.pixelScaleArray.length<=a?-1:this.pixelScaleArray[a]};js.framework.driver.McxTileDriver.McxOrthophotoLayer={};function McxOrthophotoLayer(a,b,c,d){mcx.base(this,a);this.base=this;this.credentials=c;this.base.fullName=b;this.size=McxFactoryFinder.GeometryFactory(null).createSize(256,256);this.format="png";this.initialize(d)}mcx.inherits(McxOrthophotoLayer,McxAbstractLayer);
McxOrthophotoLayer.prototype.initialize=function(a){var b=a.Name;this.base.serviceLayerName=b;this.base.description=a.Description;(a=a.AuthorityCode)&&""!=a&&null!=a&&0!=a&&(this.base.coordinateSystem=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(a));this.base.layerName=b.split(":")[1];b=new McxAjaxParameter;b.setAsync(!1);this.getEnvelope(b)};
McxOrthophotoLayer.prototype.getEnvelope=function(a){var b=new McxGetEnvelopeResult;b.setArgs(a.getArgs());if(null!=this.base.envelope)return b.setEnvelope(this.base.envelope),a.getAsync()&&a.getSuccess().call(a.getScope(),b),b;var c="layerName="+this.base.serviceLayerName,d="token="+encodeURIComponent(this.credentials),c=McxAjaxServiceCall.getAjaxCall(this.base.fullName+"GetLayerEnvelope?"+d+"&"+c,null,[this],"json",this.base.cacheable,null,a.getAsync(),function(c){var d=this.qty_input[0];c=new McxBounds(c.MinX,
c.MinY,c.MaxX,c.MaxY,d.getCoordinateSystem());d.envelope=c;b.setEnvelope(c);a.getAsync()&&a.getSuccess().call(a.getScope(),b)},function(){a.getAsync()&&a.getError().call(a.getScope(),b)});b.setRequest(c);return b};
McxOrthophotoLayer.prototype.searchByEnvelope=function(a,b,c,d,e){d=e.getArgs()[5];e.getArgs();e.getArgs();b=[];d.getWorld();var f=c;null!=this.base.coordinateSystem&&(f=c.transformTo(this.base.coordinateSystem),d.getWorld().transformTo(this.base.coordinateSystem));a=new McxSearchResult;a.setArgs(e.getArgs());var g=f,f=new McxPoint(g.getLeft(),g.getTop(),g.getCoordinateSystem()),h=new McxPoint(g.getRight(),g.getBottom(),g.getCoordinateSystem()),g=Math.min(f.getX(),h.getX()),k=Math.min(f.getY(),h.getY()),
m=Math.max(f.getX(),h.getX()),f=Math.max(f.getY(),h.getY()),n=new McxBounds(g,k,m,f,this.base.coordinateSystem),g=this.base.envelope.intersectedArea(n);g.setCoordinateSystem(this.base.coordinateSystem);if(0>=g.getWidth()||0>=g.getHeight())return b=new McxTileFeatureReader(this,b),a.setFeatureReader(b),e.getAsync()&&e.getSuccess().call(e.getScope(),a),a;n=g;f=new Image;k="envelope="+n.toString()+"&";m="srs=";null!=this.base.coordinateSystem&&(h=this.base.coordinateSystem.getCode().toLowerCase().split("epsg:"),
m+=h[1]);h="&format=image/"+this.format;c=d.getWorld().transformTo(this.base.getCoordinateSystem());var p=d.getDisplay(),q=this.worldToView(c,p,n.getLeft(),n.getBottom()),r=this.worldToView(c,p,n.getRight(),n.getTop());c=Math.min(q.getX(),r.getX());n=Math.min(q.getY(),r.getY());p=Math.max(q.getX(),r.getX());q=Math.max(q.getY(),r.getY());c=new McxBounds(c,n,p,q,null);q="&width="+(Math.round(c.getWidth())+1).toString()+"&height="+(Math.round(c.getHeight())+1).toString();n="";null!=this.base.filter&&
""!=this.base.filter.getAttributeFilter()&&(n="&whereClause="+this.base.filter.getAttributeFilter());k=this.base.fullName+"/GetMap?token="+this.credentials+"&layerNames="+this.base.serviceLayerName+"&"+k+m+q+h+n;g.setCoordinateSystem(this.base.coordinateSystem);m=g.transformTo(d.getCoordinateSystem());g=d.worldToView(m.getPoints()[0].getX(),m.getPoints()[0].getY());q=d.worldToView(m.getPoints()[2].getX(),m.getPoints()[2].getY());d=Math.min(g.getX(),q.getX());m=Math.min(g.getY(),q.getY());h=Math.max(g.getX(),
q.getX());g=Math.max(g.getY(),q.getY());new McxBounds(d,m,h,g,null);d=McxFactoryFinder.GeometryFactory(null).createPolygon(c,null);d=new McxTileFeature(this,d,f,null,k);b.push(d);d=new McxTileFeatureReader(this,b);a.setFeatureReader(d);a.setLayer(this);for(d=0;d<b.length;d++)a.addImage(b[d].getImage());e.getAsync()&&e.getSuccess().call(e.getScope(),a);return a};McxOrthophotoLayer.prototype.isInstanceOf=function(a){return"McxOrthophotoLayer"==a};McxOrthophotoLayer.prototype.createFeatureBuffer=function(){return null};
McxOrthophotoLayer.prototype.setImageFormat=function(a){this.format=a};McxOrthophotoLayer.prototype.worldToView=function(a,b,c,d){if(0>=a.getWidth()||0>=a.getHeight())return null;var e=-1*a.getLeft(),f=-1*a.getBottom(),g=b.getWidth()/a.getWidth();a=b.getHeight()/a.getHeight();c=b.getLeft()+(c+e)*g;b=b.getBottom()+(b.getHeight()-(d+f)*a);return new McxPoint(c,b,null)};js.framework.driver.McxTileDriver.McxTileDataSource={};function McxTileDataSource(a,b,c){mcx.base(this,a,b);this.base=this;this.serviceUri=this.base.createServiceUri(b);this.token=c}mcx.inherits(McxTileDataSource,McxAbstractDataSource);McxTileDataSource.prototype.testCapability=function(a){};
McxTileDataSource.prototype.getLayer=function(a,b,c){var d=new McxGetLayerResult;d.setArgs(b.getArgs());c=a.split(";");var e=this;a="";for(var f=0;f<c.length;f++){var g=c[f];if(null!=g&&""!=g){var h=g.split(":");2!=h.length&&""!=h[1]&&(g=this.getName()+":"+c[f]);a+=g+";"}}c=this.serviceUri+"/GetLayer?";null!=this.base.credentials&""!=this.base.credentials&&(c+="token="+encodeURIComponent(this.token)+"&");a=McxAjaxServiceCall.getAjaxCall(c+("layers="+a),{},[this,b],"json",!0,null,b.getAsync(),function(a){a instanceof
Array||(a=[a]);for(var c=[],f=0;f<a.length;f++){var g=a[f].AuthorityCode,h=null;g&&""!=g&&null!=g&&(h=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(g));g=new McxCacheLayer(e.token,e,e.serviceUri,a[f]);g.setCoordinateSystem(h);c.push(g)}d.setLayers(c);b.getAsync()&&b.getSuccess().call(b.getScope(),d)},function(){});d.setRequest(a);return d};js.framework.driver.McxTileDriver.McxRasterDataSource={};function McxRasterDataSource(a,b,c){mcx.base(this,a,b,c);this.base=this}mcx.inherits(McxRasterDataSource,McxTileDataSource);
McxRasterDataSource.prototype.getLayer=function(a,b,c){var d=new McxGetLayerResult;d.setArgs(b.getArgs());c=a.split(";");var e=this;a="";for(var f=0;f<c.length;f++){var g=c[f],h=c[f].split(":");2>h.length&&""!=h[0]&&(g=this.getName()+":"+c[f]);a+=g+";"}c=this.serviceUri+"/GetLayer?";null!=this.base.credentials&&""!=this.base.credentials&&(c+="token="+encodeURIComponent(this.base.token)+"&");a=McxAjaxServiceCall.getAjaxCall(c+("layers="+a),{},[this,b],"json",!0,null,b.getAsync(),function(a){a instanceof
Array||(a=[a]);for(var c=[],f=0;f<a.length;f++){var g=new McxOrthophotoLayer(e,e.base.serviceUri,e.token,a[f]);c.push(g)}d.setLayers(c);b.getAsync()&&b.getSuccess().call(b.getScope(),d)},function(){});d.setRequest(a);return d};js.framework.driver.McxTileDriver.McxTileDriver={};function McxTileDriver(){this.openDataSourceEventHandler=new McxEventHandler}
McxTileDriver.prototype.openDataSource=function(a){var b=a.split("@")[0].toUpperCase();if("MTS"!=b&&"MMS"!=b&&"MOM"!=b)return null;var c=null;if("MOM"==b)c=new McxOnlineMapDataSource(this,a);else{c=a.split("@");c=c[4]+"/rest/json/createToken?credentials="+encodeURIComponent(c[2]);c=McxAjaxServiceCall.getAjaxCall(c,[],[],"json",!1,null,!1,null,null).responseText;if(void 0==c)return null;c=c.slice(1,c.length-1);c="MMS"==b?new McxRasterDataSource(this,a,c):new McxTileDataSource(this,a,c)}a=new McxOpenDataSourceResult;
a.setDataSource(c);return a};McxTileDriver.prototype.getDriverID=function(){return"{DCD4B53D-3909-4B4E-B657-0ADA3871297E}"};McxTileDriver.prototype.getName=function(){return"MapCodex Tile Raster Driver"};McxTileDriver.prototype.testCapability=function(a){return!1};McxTileDriver.prototype.callService=function(a,b,c,d,e){$.ajax({type:"GET",url:a,data:{},qty_input:$([d,e]),dataType:"json",success:b,error:c})};McxTileDriver.prototype.isInstanceOf=function(a){return"IMcxDriver"==a};
McxTileDriver.prototype.getOpenDataSourceEventHandler=function(){return this.openDataSourceEventHandler};
McxTileDriver.prototype.getDataSourceInfo=function(a,b,c){var d=new McxGetDataSourceInfoResult,e=[],f=a+"/createToken?credentials="+encodeURIComponent(b),f=McxAjaxServiceCall.getAjaxCall(f,[],[],"json",!1,null,!1,null,null).responseText,f=encodeURIComponent(f.slice(1,f.length-1)),g="";""!=b&&(g="token="+f);a=McxAjaxServiceCall.getAjaxCall(a+"/GetDataSourceInfo?"+g,null,null,"json",!1,null,!1,function(a){for(var b=0;b<a.length;b++)e.push(a[b].DataSourceName.toString());d.setDataSourceNames(e);c.getAsync()&&
c.getSuccess().call(c.getScope(),d)},function(){c.getAsync()&&c.getError().call(c.getScope(),d)});d.setRequest(a);return d};
McxTileDriver.prototype.getLayerInfo=function(a,b,c,d,e){a+="/rest/json/";var f=new McxGetLayerInfoResult;c=a+"/createToken?credentials="+encodeURIComponent(c);c=McxAjaxServiceCall.getAjaxCall(c,[],[],"json",!1,null,!1,null,null).responseText;c=encodeURIComponent(c.slice(1,c.length-1));e="";""!=c&&(e="token="+c);b=McxAjaxServiceCall.getAjaxCall(a+"/GetLayerInfo?"+e+"&dataSourceNames="+b,{},[this,d],"json",!1,null,d.getAsync(),function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c].Name);f.setLayerNames(b);
d.getAsync()&&d.getSuccess().call(d.getScope(),f)},function(){d.getAsync()&&d.getError().call(d.getScope(),f)});f.setRequest(b);return f};js.framework.driver.McxTileDriver.McxTileFeature={};function McxTileFeature(a,b,c,d,e){this.layer=a;this.polygon=b;this.image=c;this.src=e;this.guid="";this.symbolizer=null;this.values=[];this._schema=d}McxTileFeature.prototype.getSymbolizer=function(){return this.symbolizer};McxTileFeature.prototype.setSymbolizer=function(a){this.symbolizer=a};McxTileFeature.prototype.getField=function(a){};McxTileFeature.prototype.getFieldName=function(a){};McxTileFeature.prototype.getFieldOrdinal=function(a){};
McxTileFeature.prototype.getValue=function(a){};McxTileFeature.prototype.setValue=function(a,b){};McxTileFeature.prototype.getGeometry=function(){return this.polygon};McxTileFeature.prototype.setGeometry=function(a){this.polygon=a};McxTileFeature.prototype.setValueWithName=function(a,b){this.values[a]=b};McxTileFeature.prototype.getFieldCount=function(){return 0};McxTileFeature.prototype.setValueWithOrdinal=function(a,b){this.values[a.toString()]=b};McxTileFeature.prototype.getName=function(a){return this.values.keys[a]};
McxTileFeature.prototype.getGlobalID=function(){return this.guid};McxTileFeature.prototype.setGlobalID=function(a){this.guid=a};McxTileFeature.prototype.getOrdinal=function(a){a=this.values[a];var b=0,c;for(c in this.values){if(c==a)return b;b++}return 0};McxTileFeature.prototype.getLayer=function(){return this.layer};McxTileFeature.prototype.getFeatureID=function(){return 0};McxTileFeature.prototype.setFeatureID=function(a){this.values[this.layer.getKeyField()]=a};
McxTileFeature.prototype.getFieldType=function(a){return this.layer.getSchema().getField(a).getFieldType()};McxTileFeature.prototype.unChangeField=function(a){};McxTileFeature.prototype.isFieldChange=function(a){return!1};McxTileFeature.prototype.isInstanceOf=function(a){return"McxTileFeature"==a};McxTileFeature.prototype.convertToString=function(a){};McxTileFeature.prototype.getImage=function(){return this.image};McxTileFeature.prototype.getQueryString=function(){return this.src};
McxTileFeature.prototype.getSchema=function(){return this._schema};js.framework.driver.McxTileDriver.McxTileFeatureReader={};function McxTileFeatureReader(a,b){this.features=b;this.layer=a;this.closed=!1;this.cursor=-1;this.drawnFeatures=0}McxTileFeatureReader.prototype.isClosed=function(){return this.closed};McxTileFeatureReader.prototype.read=function(){return++this.cursor<this.features.length};McxTileFeatureReader.prototype.getCurrent=function(){return this.features[this.cursor]};McxTileFeatureReader.prototype.close=function(){this.closed=!0};
McxTileFeatureReader.prototype.addFeature=function(a){this.features.push(a)};McxTileFeatureReader.prototype.count=function(){return this.features.length};McxTileFeatureReader.prototype.getDrawnCountFeatures=function(){return this.drawnFeatures};McxTileFeatureReader.prototype.increaseDrawnFeaturesCount=function(a){this.drawnFeatures+=a};McxTileFeatureReader.prototype.getFeatureCount=function(){return this.features.length};McxTileFeatureReader.prototype.toArray=function(){return this.features};js.framework.driver.McxTileDriver.McxTileLayer={};function McxTileLayer(a,b){mcx.base(this,a);this.base=this;this.scaleArray=[];this.initialize();this.tileScale=new McxTileScale(this.scaleArray);this.base.coordinateSystem=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(4326);this.layerName=b;this.size=McxFactoryFinder.GeometryFactory(null).createSize(256,256);this.base.envelope=new McxBounds(-180,-85,180,85,null);this.projection=new McxMercatorProjection}
mcx.inherits(McxTileLayer,McxAbstractLayer);McxTileLayer.prototype.initialize=function(){this.scaleArray=[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,6.866455078125E-4,3.4332275390625E-4,1.71661376953125E-4,8.58306884765625E-5,4.291534423828125E-5,2.145767211914062E-5,1.072883605957031E-5,5.36441802978515E-6,2.68220901489257E-6,1.341104507446289E-6]};
McxTileLayer.prototype.searchByEnvelope=function(a,b,c,d,e){d=e.getArgs()[5];a=[];var f=c.transformTo(this.base.coordinateSystem);b=this.getTileParameter(d,f,0);null!=d.getCoordinateSystem()&&d.getCoordinateSystem()!=this.base.coordinateSystem&&(f=c.clone().transformTo(d.getCoordinateSystem()));if(null==b){c=new Image;b=d.worldToView(f.getPoints()[0].getX(),f.getPoints()[0].getY());var g=d.worldToView(f.getPoints()[2].getX(),f.getPoints()[2].getY());d=Math.min(b.getX(),g.getX());var f=Math.min(b.getY(),
g.getY()),h=Math.max(b.getX(),g.getX());b=Math.max(b.getY(),g.getY());b=new McxBounds(d,f,h,b,null);b=McxFactoryFinder.GeometryFactory(null).createPolygon(b,null);c=new McxTileFeature(this,b,c,null,"");a.push(c)}else for(d=0;d<b.length;d++)f=b[d],c=new Image,h=McxFactoryFinder.GeometryFactory(null).createPolygon(f.getDisplay(),null),c=new McxTileFeature(this,h,c,null,f.getImageUrl()),a.push(c);c=new McxSearchResult;c.setArgs(e.getArgs());b=new McxTileFeatureReader(this,a);c.setFeatureReader(b);c.setLayer(this);
for(b=0;b<a.length;b++)c.addImage(a[b].getImage());e.getAsync()&&e.getSuccess().call(e.getScope(),c);return c};McxTileLayer.prototype.getAppropriateZoomLevel=function(a){for(var b=Number.MAX_VALUE,c=null,d=0;d<this.tileScale.getScaleLength();d++){var e=this.tileScale.getScaleValue(d)-a;e<b&&0<e&&(b=e,c=this.tileScale.getScaleValue(d),c=this.tileScale.getZoomLevel(c))}return c};
McxTileLayer.prototype.getAppropriateTileScale=function(a){for(var b=Number.MAX_VALUE,c=null,d=0;d<this.tileScale.getScaleLength();d++){var e=Math.abs(this.tileScale.getScaleValue(d)-a);e<b&&(b=e,c=this.tileScale.getScaleValue(d))}return c};
McxTileLayer.prototype.getTileParameter=function(a,b,c){var d=[],e=a.getWorld();null!=a.getCoordinateSystem()&&(e=a.getWorld().transformTo(this.base.coordinateSystem));var f=this.getPixelScale(e,a.getDisplay()),f=this.getAppropriateZoomLevel(f);if(null==f)return null;b=this.projection.getAreaTileList(b,f-c,0);for(var g=0;g<b.length;g++){var h=b[g],k=[],m=this.fromTileXYToPixel_UL(h),m=this.projection.fromPixelToLatLng(m.getX(),m.getY(),f-c),m=this.worldToView(m.getY(),m.getX(),e,a.getDisplay());k.push(new McxPoint(m.getX(),
m.getY(),null));m=new McxPoint(h.getX()+1,h.getY(),null);m=this.fromTileXYToPixel_UL(m);m=this.projection.fromPixelToLatLng(m.getX(),m.getY(),f-c);m=this.worldToView(m.getY(),m.getX(),e,a.getDisplay());k.push(new McxPoint(m.getX(),m.getY(),null));m=new McxPoint(h.getX(),h.getY()+1,null);m=this.fromTileXYToPixel_UL(m);m=this.projection.fromPixelToLatLng(m.getX(),m.getY(),f-c);m=this.worldToView(m.getY(),m.getX(),e,a.getDisplay());k.push(new McxPoint(m.getX(),m.getY(),null));m=new McxPoint(h.getX()+
1,h.getY()+1,null);m=this.fromTileXYToPixel_UL(m);m=this.projection.fromPixelToLatLng(m.getX(),m.getY(),f-c);m=this.worldToView(m.getY(),m.getX(),e,a.getDisplay());k.push(new McxPoint(m.getX(),m.getY(),null));var m=k[1].getX()-k[0].getX(),n=k[1].getY()-k[2].getY();0>m&&(m*=-1);0>n&&(n*=-1);m=McxFactoryFinder.GeometryFactory(null).createSize(m+1,n+1);n=new McxPoint(k[0].getX(),k[0].getY(),null);k=Math.round(h.getX());h=Math.round(h.getY());m=new McxBounds(Math.ceil(n.getX()),Math.ceil(n.getY()),Math.ceil(n.getX()+
m.getWidth()),Math.ceil(n.getY()+m.getHeight()),null);m.getLeft()>a.getDisplay().getRight()+a.getDisplay().getWidth()||m.getBottom()>a.getDisplay().getTop()+a.getDisplay().getHeight()||(h=this.getTileImageUrl(k,h,f-c),h=new McxTileParameter(h,m),d.push(h))}return d};McxTileLayer.prototype.fromTileXYToPixel_UL=function(a){var b=this.projection.getTileSize().getWidth(),c=this.projection.getTileSize().getHeight();return new McxPoint(a.getX()*b,(a.getY()-1)*c+c,null)};
McxTileLayer.prototype.getTileImageUrl=function(a,b,c){};McxTileLayer.prototype.isInstanceOf=function(a){return"McxTileLayer"==a||"IMcxTileLayer"==a};McxTileLayer.prototype.createFeatureBuffer=function(){return null};McxTileLayer.prototype.getPixelScale=function(a,b){var c=Math.sqrt(a.getWidth()*a.getWidth()+a.getHeight()*a.getHeight()),d=Math.sqrt(b.getWidth()*b.getWidth()+b.getHeight()*b.getHeight());return c/d};
McxTileLayer.prototype.worldToView=function(a,b,c,d){if(0>=c.getWidth()||0>=c.getHeight())return null;var e=-1*c.getLeft(),f=-1*c.getBottom(),g=d.getWidth()/c.getWidth();c=d.getHeight()/c.getHeight();a=d.getLeft()+(a+e)*g;b=d.getBottom()+(d.getHeight()-(b+f)*c);return new McxPoint(a,b,null)};
McxTileLayer.prototype.viewToWorld=function(a,b,c,d){if(0==c.getWidth()||0==c.getHeight())return null;var e=c.getLeft(),f=c.getBottom(),g=c.getWidth()/d.getWidth();c=c.getHeight()/d.getHeight();b=d.getHeight()-b;a=(d.getLeft()+a)*g+e;d=(d.getBottom()+b)*c+f;return new McxPoint(a,d,null)};js.framework.driver.McxTileDriver.McxTileLayerType={};
var McxTileLayerType={Google:"GoogleMap",GoogleSatellite:"GoogleSatelliteMap",GoogleHybrid:"GoogleHybridMap",GoogleTerrain:"GoogleTerrainMap",Bing:"BingMap",BingSatellite:"BingSatelliteMap",BingHybrid:"BingHybridMap",OpenStreetMap4U:"OpenStreetMap4U",OpenCycleLandscape:"OpenCycleLandscapeMap",OpenCycle:"OpenCycleMap",OpenCycleTransport:"OpenCycleTransportMap",OpenSeaHybrid:"OpenSeaMapHybrid",OpenStreet:"OpenStreetMap",OpenStreetQuest:"OpenStreetMapQuest",OpenStreetQuestHybrid:"OpenStreetMapQuestHybrid",
OpenStreetQuestSatellite:"OpenStreetMapQuestSatellite",Humanitarian:"OpenStreetMapHumanitarian",Ovi:"OviMap",OviHybrid:"OviHybridMap",OviTerrain:"OviTerrainMap",OviSatellite:"OviSatelliteMap",YandexMap:"YandexMap",YandexSatelliteMap:"YandexSatelliteMap",YandexHybridMap:"YandexHybridMap"};js.framework.driver.McxTileDriver.McxTileParameter={};function McxTileParameter(a,b){this.imageUrl=a;this.display=b}McxTileParameter.prototype.getImageUrl=function(){return this.imageUrl};McxTileParameter.prototype.getDisplay=function(){return this.display};js.framework.driver.McxTileDriver.McxTileScale={};function McxTileScale(a){this.scaleArray=a;this.scaleHash={};this.initialize()}McxTileScale.prototype.initialize=function(){for(var a=0;a<this.scaleArray.length;a++)this.scaleHash[this.scaleArray[a]]=a};McxTileScale.prototype.getZoomLevel=function(a){return this.scaleHash[a]};McxTileScale.prototype.getScaleLength=function(){return this.scaleArray.length};McxTileScale.prototype.getScaleValue=function(a){return this.scaleArray[a]};js.framework.driver.McxTileDriver.McxTileScaleCollection={};function McxTileScaleCollection(a){this.scaleArray=a}McxTileScaleCollection.prototype.getScaleLength=function(){return this.scaleArray.length};McxTileScaleCollection.prototype.getAt=function(a){return this.scaleArray[a]};js.framework.driver.McxTileDriver.ArcGis={};js.framework.driver.McxTileDriver.ArcGis.McxArcGisDataSource={};function McxArcGisDataSource(a,b){mcx.base(this,a,b);this.base=this;this.base.dataSourceName="ARCGIS";this.serviceUri=this.createServiceUri(b);this.token=""}mcx.inherits(McxArcGisDataSource,McxAbstractDataSource);McxArcGisDataSource.prototype.testCapability=function(a){};McxArcGisDataSource.prototype.getLayerCount=function(){return this.base.layerArray.length};
McxArcGisDataSource.prototype.getLayer=function(a,b,c){var d=new McxGetLayerResult;d.setArgs(b.getArgs());var e=a.split(";");a=[];for(c=0;c<e.length;c++)if(""!=e[c]){var f=e[c].split(":");2<=f.length?a.push(f[1]):a.push(e[c])}var e=a,g=this;a=this.serviceUri;c="";null!=this.token&&""!=this.token&&(c="&token="+this.token);a=McxAjaxServiceCall.getAjaxCall(a+("0?f=json"+c),{},[this,b],"json",!0,null,b.getAsync(),function(a){var c=a.layers,f=a.description,n=a.fullExtent,p=parseFloat(n.xmin),q=parseFloat(n.ymin),
r=parseFloat(n.xmax),n=parseFloat(n.ymax),p=new McxBounds(p,q,r,n,null),q=a.spatialReference;a=null;q.wkid?a=new McxCoordinateSystem(parseInt(q.wkid,10)):q.wkt&&(a=new McxCoordinateSystem(q.wkt));for(var r=[],q=[],n=Number.MAX_VALUE,t=Number.MIN_VALUE,u=0;u<c.length;u++)for(var v=c[u],w=v.name,x=0;x<e.length;x++){var y=e[x];y==u.toString()&&(y=w);if(y==w){var A=parseFloat(v.minScale),B=parseFloat(v.maxScale);B<n&&(n=B);A>t&&(t=A);r.push(u.toString());q.push(y)}}c=new McxArcGisLayer(g,r.join(";"),
g.connectionString,"",f,p);c.setAlias("ARCGIS:"+q.join(";"));c.setCoordinateSystem(a);c.setToken(g.token);d.setLayers([c]);b.getAsync()&&b.getSuccess().call(b.getScope(),d)},function(){});d.setRequest(a);return d};McxArcGisDataSource.prototype.setToken=function(a){this.token=a};js.framework.driver.McxTileDriver.ArcGis.McxArcGisDriver={};function McxArcGisDriver(){this.openDataSourceEventHandler=new McxEventHandler;this.token=""}McxArcGisDriver.prototype.openDataSource=function(a){var b=a.split("@");if("AGS"!=b[0].toUpperCase())return null;var c=b[2];c&&""!=c&&(b=b[b.length-1].split("/rest/")[0],this.initToken(b,c));a=new McxArcGisDataSource(this,a);a.setToken(this.token);c=new McxOpenDataSourceResult;c.setDataSource(a);return c};McxArcGisDriver.prototype.getDriverID=function(){return"{DCD4B53D-3909-4B4E-B657-0ADA3871297E}"};
McxArcGisDriver.prototype.getName=function(){return"MapCodex Tile Raster Driver"};McxArcGisDriver.prototype.testCapability=function(a){};McxArcGisDriver.prototype.callService=function(a,b,c,d,e){$.ajax({type:"GET",url:a,data:{},qty_input:$([d,e]),dataType:"json",success:b,error:c})};McxArcGisDriver.prototype.isInstanceOf=function(a){return"IMcxDriver"==a};McxArcGisDriver.prototype.getOpenDataSourceEventHandler=function(){return this.openDataSourceEventHandler};
McxArcGisDriver.prototype.getDataSourceInfo=function(a,b,c){a=new McxGetDataSourceInfoResult;a.setDataSourceNames(["ARGIS"]);c.getAsync()&&c.getSuccess().call(c.getScope(),a);return a};
McxArcGisDriver.prototype.getLayerInfo=function(a,b,c,d,e){var f=new McxGetLayerInfoResult;b=a.split("/rest/")[0];this.initToken(b,c);c="";null!=this.token&&""!=this.token&&(c="&token="+this.token);a=McxAjaxServiceCall.getAjaxCall(a+"/?f=json"+c,{},[this,d],"json",!1,null,d.getAsync(),function(a){a=a.layers;for(var b=[],c=0;c<a.length;c++)b.push("ARCGIS:"+a[c].name);f.setLayerNames(b);d.getAsync()&&d.getSuccess().call(d.getScope(),f)},function(){d.getAsync()&&d.getError().call(d.getScope(),f)});f.setRequest(a);
return f};McxArcGisDriver.prototype.initToken=function(a,b){function c(){}if(-1<b.indexOf("token="))this.token=b.split("token=")[1];else if(""!=b&&"credentials="!=b){var d=1<b.split("credentials=").length?b[1].split(";"):b.split(";");this.token=McxAjaxServiceCall.getAjaxCall(a+"/tokens/?request=gettoken&username="+d[0]+"&password="+d[1],[],[],"text",!1,null,!1,c,c).responseText}};js.framework.driver.McxTileDriver.ArcGis.McxArcGisLayer={};function McxArcGisLayer(a,b,c,d,e,f){mcx.base(this,a);this.base=this;this.base.envelope=f;this.base.layerName=b;this.credentials=d;this.base.fullName=c;this.base.description=e;this.size=McxFactoryFinder.GeometryFactory(null).createSize(256,256);this.projection=new McxMercatorProjection;this.format="jpeg";this.token="";this.requestUri=this.base.fullName.split("@")[this.base.fullName.split("@").length-1]}mcx.inherits(McxArcGisLayer,McxAbstractLayer);
McxArcGisLayer.prototype.searchByEnvelope=function(a,b,c,d,e){d=e.getArgs()[5];a=[];null!=d.getCoordinateSystem()&&d.getCoordinateSystem()!=this.base.coordinateSystem&&c.transformTo(this.base.coordinateSystem);b=c;null!=d.getCoordinateSystem()&&d.getCoordinateSystem()!=this.base.coordinateSystem&&(b=c.transformTo(d.getCoordinateSystem()));c=new Image;var f=d.worldToView(b.getPoints()[0].getX(),b.getPoints()[0].getY()),g=d.worldToView(b.getPoints()[2].getX(),b.getPoints()[2].getY()),h=Math.min(f.getX(),
g.getX()),k=Math.min(f.getY(),g.getY()),m=Math.max(f.getX(),g.getX()),f=Math.max(f.getY(),g.getY()),k=new McxBounds(h,k,m,f,null),h=McxFactoryFinder.GeometryFactory(null).createPolygon(k,null),m={};m.wkt=d.getCoordinateSystem().toWkt();d=JSON.stringify(m);m=this.base.layerName.replace(";",",");f="";null!=this.token&&""!=this.token&&(f="&token="+this.token);b=this.requestUri+"/export?dpi=96&transparent=true&format=png32&bbox="+b.getLeft().toString()+","+b.getBottom().toString()+","+b.getRight().toString()+
","+b.getTop().toString()+"&bboxSR="+d+"&imageSR="+d+"&size="+k.getWidth().toString()+","+k.getHeight().toString()+"&layers=show:"+m+"&f=image"+f;b=new McxTileFeature(this,h,c,null,b);a.push(b);b=new McxSearchResult;b.setArgs(e.getArgs());c=new McxTileFeatureReader(this,a);b.setFeatureReader(c);b.setLayer(this);for(c=0;c<a.length;c++)b.addImage(a[c].getImage());e.getAsync()&&e.getSuccess().call(e.getScope(),b);return b};McxArcGisLayer.prototype.isInstanceOf=function(a){return"McxArcGisLayer"==a};
McxArcGisLayer.prototype.createFeatureBuffer=function(){return null};McxArcGisLayer.prototype.worldToView=function(a,b,c,d){if(0>=c.getWidth()||0>=c.getHeight())return null;var e=-1*c.getLeft(),f=-1*c.getBottom(),g=d.getWidth()/c.getWidth();c=d.getHeight()/c.getHeight();a=d.getLeft()+(a+e)*g;b=d.getBottom()+(d.getHeight()-(b+f)*c);return new McxPoint(a,b,null)};McxArcGisLayer.prototype.setImageFormat=function(a){this.format=a};McxArcGisLayer.prototype.setToken=function(a){this.token=a};js.framework.driver.McxTileDriver.ArcGis.McxArcGisTileCacheDataSource={};function McxArcGisTileCacheDataSource(a,b){this.token="";this.tileLayerArray=[];this.driver=a;this.tileDataSource=b;this.connectionString=b.split("@")[3];this.dataSourceName="ARCGIS";this.proxyUrl="";this.init()}
McxArcGisTileCacheDataSource.prototype.init=function(){var a=this;$.ajax({url:$("mcxconfigurationpath").attr("src")||"src/appdata/McxConfiguration.xml",dataType:"xml",type:"GET",cache:!0,async:!0,success:function(b){b=$(b).find("services").find("proxyService");a.proxyUrl=b.find("uri").text()+"?proxyUrl="}})};McxArcGisTileCacheDataSource.prototype.getDriver=function(){return this.driver};McxArcGisTileCacheDataSource.prototype.fullTextSearch=function(a,b,c,d){};
McxArcGisTileCacheDataSource.prototype.testCapability=function(a){};McxArcGisTileCacheDataSource.prototype.deleteLayer=function(a){};McxArcGisTileCacheDataSource.prototype.getName=function(){return this.dataSourceName};McxArcGisTileCacheDataSource.prototype.getLayerCount=function(){return this.tileLayerArray.length};
McxArcGisTileCacheDataSource.prototype.getLayer=function(a,b,c){function d(c){c=McxXMLReader.createXmlDocument(c);var d=c.findSingleNode("TileCacheInfo");parseFloat(d.findSingleNode("TileCols").getValue());parseFloat(d.findSingleNode("TileRows").getValue());d.findSingleNode("LODInfos");for(var d=d.getNodes("LODInfo"),e=[],n=[],p=[],w=0;w<d.length;w++){var x=d[w],y=parseInt(x.findSingleNode("LevelID").getValue(),10);e.push(y);y=parseFloat(x.findSingleNode("Scale").getValue());n.push(y);x=parseFloat(x.findSingleNode("Resolution").getValue());
p.push(x)}c.findSingleNode("TileImageInfo").findSingleNode("CacheTileFormat").getValue();c=new McxArcGisTileCacheLayer("",a,g,g.connectionString,k,h,n,p);m=new McxCoordinateSystem(3857);c.setCoordinateSystem(m);f.setLayers([c]);b.getAsync()&&b.getSuccess().call(b.getScope(),f)}function e(){}var f=new McxGetLayerResult;f.setArgs(b.getArgs());var g=this,h=new McxBounds(3037504.972522293,4888381.401049468,3440326.5022051167,5158772.17578423,null),k=new McxBounds(0,0,0,0,null),m=null,n=this.connectionString.split("/layers/")[0]+
"/layers";c=n+"/conf.cdi";var p="",p=null!=this.proxyUrl&&""!=this.proxyUrl?this.proxyUrl+c:c;c=McxAjaxServiceCall.getAjaxCall(p,{},[],"xml",!0,null,b.getAsync(),function(a){a=McxXMLReader.createXmlDocument(a);var c=a.findSingleNode("EnvelopeN");parseFloat(c.getSingleNode("XMin").getValue());parseFloat(c.getSingleNode("YMin").getValue());parseFloat(c.getSingleNode("XMax").getValue());parseFloat(c.getSingleNode("YMax").getValue());k=new McxBounds(-2.0037508342787E7,4975E3,333E4,2.0037508342787E7,null);
a=a.findSingleNode("SpatialReference").findSingleNode("WKT").getValue();m=new McxCoordinateSystem(a);a=n+"/conf.xml";c="";c=null!=g.proxyUrl&&""!=g.proxyUrl?g.proxyUrl+a:a;McxAjaxServiceCall.getAjaxCall(c,{},[],"xml",!0,null,b.getAsync(),d,e)},e);f.setRequest(c);return f};McxArcGisTileCacheDataSource.prototype.getSource=function(){return this.tileDataSource};McxArcGisTileCacheDataSource.prototype.createLayer=function(a,b,c,d){};McxArcGisTileCacheDataSource.prototype.copyLayer=function(a,b,c){};
McxArcGisTileCacheDataSource.prototype.add=function(a){this.tileLayerArray.push(a)};McxArcGisTileCacheDataSource.prototype.createServiceUri=function(a){a=a.split("@");a=a[a.length-1];return a+"/Rest/Json/"};McxArcGisTileCacheDataSource.prototype.setToken=function(a){this.token=a};js.framework.driver.McxTileDriver.ArcGis.McxArcGisTileCacheDriver={};function McxArcGisTileCacheDriver(){this.openDataSourceEventHandler=new McxEventHandler}McxArcGisTileCacheDriver.prototype.openDataSource=function(a){if("ATCS"!=a.split("@")[0].toUpperCase())return null;a=new McxArcGisTileCacheDataSource(this,a);var b=new McxOpenDataSourceResult;b.setDataSource(a);return b};McxArcGisTileCacheDriver.prototype.getDriverID=function(){return"{DCD4B53D-3909-4B4E-B657-0ADA3871297E}"};
McxArcGisTileCacheDriver.prototype.getName=function(){return"MapCodex Tile Raster Driver"};McxArcGisTileCacheDriver.prototype.testCapability=function(a){return!1};McxArcGisTileCacheDriver.prototype.callService=function(a,b,c,d,e){$.ajax({type:"GET",url:a,data:{},qty_input:$([d,e]),dataType:"json",success:b,error:c})};McxArcGisTileCacheDriver.prototype.isInstanceOf=function(a){return"IMcxDriver"==a};McxArcGisTileCacheDriver.prototype.getOpenDataSourceEventHandler=function(){return this.openDataSourceEventHandler};
McxArcGisTileCacheDriver.prototype.getDataSourceInfo=function(a,b,c){a=new McxGetDataSourceInfoResult;a.setDataSourceNames(["ARCGIS"]);c.getAsync()&&c.getSuccess().call(c.getScope(),a);return a};McxArcGisTileCacheDriver.prototype.getLayerInfo=function(a,b,c,d,e){a=a.split("/layers/");b=new McxGetLayerInfoResult;b.setLayerNames([a[1]]);d.getAsync()&&d.getSuccess().call(d.getScope(),b);return b};js.framework.driver.McxTileDriver.ArcGis.McxArcGisTileCacheLayer={};function McxArcGisTileCacheLayer(a,b,c,d,e,f,g,h){mcx.base(this,c);this.base=this;this.base.envelope=f;this.credentials=a;this.base.fullName=d;this.scaleArray=g;this.resolutions=h;this.base.layerName=b;this.size=new McxSize(256,256);this.fullEnvelope=e;this.tileCacheScale=new McxTileScale(this.scaleArray)}mcx.inherits(McxArcGisTileCacheLayer,McxAbstractLayer);
McxArcGisTileCacheLayer.prototype.searchByEnvelope=function(a,b,c,d,e){b=e.getArgs()[5];a=[];c=this.getTileParameter(b,c,0);for(b=0;b<c.length;b++){d=c[b];var f=new Image,g=McxFactoryFinder.GeometryFactory(null).createPolygon(d.getDisplay(),null);d=new McxTileFeature(this,g,f,null,d.getImageUrl());a.push(d)}c=new McxSearchResult;c.setArgs(e.getArgs());b=new McxTileFeatureReader(this,a);c.setFeatureReader(b);c.setLayer(this);for(b=0;b<a.length;b++)c.addImage(a[b].getImage());e.getAsync()&&e.getSuccess().call(e.getScope(),
c);return c};McxArcGisTileCacheLayer.prototype.isInstanceOf=function(a){return"IMcxTileLayer"==a||"McxArcGisTileCacheLayer"==a};McxArcGisTileCacheLayer.prototype.getAppropriateTileScale=function(a){for(var b=Number.MAX_VALUE,c=0,d=0;d<this.resolutions.length;d++){var e=Math.abs(this.resolutions[d]-a);e<b&&(b=e,c=d)}return c};
McxArcGisTileCacheLayer.prototype.getTileParameter=function(a,b,c){c=[];for(var d=a.getWorld().transformTo(this.base.coordinateSystem),e=Math.sqrt(d.getWidth()*d.getWidth()+d.getHeight()*d.getHeight()),f=Math.sqrt(a.getDisplay().getWidth()*a.getDisplay().getWidth()+a.getDisplay().getHeight()*a.getDisplay().getHeight()),d=this.fullEnvelope,g=this.size,f=this.getAppropriateTileScale(e/f),h=this.resolutions[f],e=h*g.getWidth(),g=h*g.getHeight(),k=f.toString(),m=2-k.length,h=0;h<m;h++)k="0"+k;var n=b.transformTo(this.base.coordinateSystem),
h=Math.ceil((n.getLeft()-d.left)/e)-1;b=Math.floor((d.top-n.getBottom())/g);f=Math.floor((n.getRight()-d.left)/e);n=Math.ceil((d.top-n.getTop())/g)-1;0>h&&(h=0);0>f&&(f=0);0>n&&(n=0);0>b&&(b=0);for(k=this.base.fullName+"/L"+k;h<=f;h++)for(var p=d.left+h*e,q=d.left+(h+1)*g,r=n;r<=b;r++){for(var t=d.top-(r+1)*g,m=(new McxPoint(p,d.top-r*g,this.base.coordinateSystem)).transformTo(a.getCoordinateSystem()),m=a.worldToView(m.getX(),m.getY()),t=(new McxPoint(q,t,this.base.coordinateSystem)).transformTo(a.getCoordinateSystem()),
u=a.worldToView(t.getX(),t.getY()),t=Math.min(m.x,u.x),v=Math.min(m.y,u.y),w=Math.max(m.x,u.x),m=Math.max(m.y,u.y),t=new McxBounds(t,v,Math.ceil(w),Math.ceil(m),null),v=h.toString(),m=8-v.length,w=0;w<m;w++)v="0"+v;u=r.toString();m=8-u.length;for(w=0;w<m;w++)u="0"+u;m=new McxTileParameter(k+"/R"+u+"/C"+v+".jpg",t);c.push(m)}return c};McxArcGisTileCacheLayer.prototype.createFeatureBuffer=function(){return null};js.framework.driver.McxTileDriver.ArcGis.McxEsriSpatialRelation={};
var McxEsriSpatialRelation={esriSpatialRelIntersects:"esriSpatialRelIntersects",esriSpatialRelContains:"esriSpatialRelContains",esriSpatialRelCrosses:"esriSpatialRelCrosses",esriSpatialRelEnvelopeIntersects:"esriSpatialRelEnvelopeIntersects",esriSpatialRelIndexIntersects:"esriSpatialRelIndexIntersects",esriSpatialRelOverlaps:"esriSpatialRelOverlaps",esriSpatialRelTouches:"esriSpatialRelTouches",esriSpatialRelWithin:"esriSpatialRelWithin",esriSpatialRelRelation:"esriSpatialRelRelation"};js.framework.driver.McxTileDriver.Ogc={};js.framework.driver.McxTileDriver.Ogc.McxInfoFeature={};function McxInfoFeature(a,b,c,d){this.layer=a;this.guid="";this.dataType=b;this.infoObj=d;this._schema=c}McxInfoFeature.prototype.getSymbolizer=function(){};McxInfoFeature.prototype.setSymbolizer=function(a){};McxInfoFeature.prototype.getField=function(a){};McxInfoFeature.prototype.getFieldName=function(a){};McxInfoFeature.prototype.getFieldOrdinal=function(a){};McxInfoFeature.prototype.getValue=function(a){};
McxInfoFeature.prototype.setValue=function(a,b){};McxInfoFeature.prototype.getGeometry=function(){return null};McxInfoFeature.prototype.setGeometry=function(a){};McxInfoFeature.prototype.setValueWithName=function(a,b){};McxInfoFeature.prototype.getFieldCount=function(){return 0};McxInfoFeature.prototype.setValueWithOrdinal=function(a,b){};McxInfoFeature.prototype.getName=function(a){};McxInfoFeature.prototype.getGlobalID=function(){return this.guid};
McxInfoFeature.prototype.setGlobalID=function(a){this.guid=a};McxInfoFeature.prototype.getOrdinal=function(a){return-1};McxInfoFeature.prototype.getLayer=function(){return this.layer};McxInfoFeature.prototype.getFeatureID=function(){return 0};McxInfoFeature.prototype.setFeatureID=function(a){};McxInfoFeature.prototype.getFieldType=function(a){};McxInfoFeature.prototype.unChangeField=function(a){};McxInfoFeature.prototype.isFieldChange=function(a){return!1};
McxInfoFeature.prototype.isInstanceOf=function(a){return"McxInfoFeature"==a};McxInfoFeature.prototype.convertToString=function(a){};McxInfoFeature.prototype.getDataType=function(){return this.dataType};McxInfoFeature.prototype.getFeatureInfo=function(){return this.infoObj};McxInfoFeature.prototype.getSchema=function(){return this._schema};js.framework.driver.McxTileDriver.Ogc.McxInfoFeatureReader={};function McxInfoFeatureReader(a,b){this.features=b;this.layer=a;this.closed=!1;this.cursor=-1;this.drawnFeatures=0}McxInfoFeatureReader.prototype.isClosed=function(){return this.closed};McxInfoFeatureReader.prototype.read=function(){return++this.cursor<this.features.length};McxInfoFeatureReader.prototype.getCurrent=function(){return this.features[this.cursor]};McxInfoFeatureReader.prototype.close=function(){this.closed=!0};
McxInfoFeatureReader.prototype.addFeature=function(a){this.features.push(a)};McxInfoFeatureReader.prototype.count=function(){return this.features.length};McxInfoFeatureReader.prototype.getDrawnCountFeatures=function(){return this.drawnFeatures};McxInfoFeatureReader.prototype.increaseDrawnFeaturesCount=function(a){this.drawnFeatures+=a};McxInfoFeatureReader.prototype.getFeatureCount=function(){return this.features.length};McxInfoFeatureReader.prototype.toArray=function(){return this.features};js.framework.driver.McxTileDriver.Ogc.McxOgcDriver={};function McxOgcDriver(){this._proxyUrl="";this._version="1.3.0";this._tileOption=!1;this._dataSource=null;this.openDataSourceEventHandler=new McxEventHandler;this.init()}
McxOgcDriver.prototype.openDataSource=function(a){var b=a.split("@")[0].toUpperCase();return"WMS"==b?(this._dataSource=new McxWmsDataSource(this,a),this._dataSource.setProxyUrl(this._proxyUrl),a=new McxOpenDataSourceResult,a.setDataSource(this._dataSource),a):"WMTS"==b?(this._dataSource=new McxWmtsDataSource(this,a),this._dataSource.setProxyUrl(this._proxyUrl),a=new McxOpenDataSourceResult,a.setDataSource(this._dataSource),a):null};McxOgcDriver.prototype.getDriverID=function(){return"{DCD4B53D-3909-4B4E-B657-0ADA3871297E}"};
McxOgcDriver.prototype.getName=function(){return"MapCodex OGC Driver"};McxOgcDriver.prototype.testCapability=function(a){return!1};McxOgcDriver.prototype.isInstanceOf=function(a){return"IMcxDriver"==a};McxOgcDriver.prototype.getOpenDataSourceEventHandler=function(){return this.openDataSourceEventHandler};McxOgcDriver.prototype.getDataSourceInfo=function(a,b,c){a=new McxGetDataSourceInfoResult;a.setDataSourceNames(["WMS"]);c.getAsync()&&c.getSuccess().call(this,a);return a};
McxOgcDriver.prototype.getLayerInfo=function(a,b,c,d,e){var f=new McxGetLayerInfoResult;f.setArgs(d.getArgs());c="";c=null!=this._proxyUrl&&""!=this._proxyUrl?this._proxyUrl+a:a;c+=-1<c.indexOf("?")?"&REQUEST=GetCapabilities&SERVICE=":"?REQUEST=GetCapabilities&SERVICE=";c=c+b+"&Version="+this._version;a=McxAjaxServiceCall.getAjaxCall(c,null,[this,d],"xml",!0,null,d.getAsync(),function(a){var c=McxXMLReader.createXmlDocument(a);a="";a="WMS"==b?c.findSingleNode("Layer").findNodes("Layer"):c.findSingleNode("Layer").findNodes("TileMatrixSet");
for(var c=[],e=0;e<a.length;e++){var m=a[e],n="",n="WMS"==b?m.findSingleNode("Title").getValue():m.getValue();null!=n&&""!=n&&c.push(n)}f.setLayerNames(c);d.getAsync()&&d.getSuccess().call(d.getScope(),f)},function(){d.getAsync()&&d.getError().call(d.getScope(),f)});f.setRequest(a);return f};McxOgcDriver.prototype.setWmsversion=function(a){this._version=a};McxOgcDriver.prototype.setTileOption=function(a){this._tileOption=a};
McxOgcDriver.prototype.init=function(){var a=this;$.ajax({url:$("mcxconfigurationpath").attr("src")||"src/appdata/McxConfiguration.xml",dataType:"xml",type:"GET",cache:!0,async:!1,success:function(b){(b=$(b).find("services").find("proxyService").find("uri").text())&&null!=b&&""!=b&&(a._proxyUrl=b+"?proxyUrl=")}})};js.framework.driver.McxTileDriver.Ogc.McxWmsDataSource={};function McxWmsDataSource(a,b){this.tileLayerArray=[];this.driver=a;this.tileDataSource=b;this.credentials=b.split("@")[2];this.dataSourceName=b.split("@")[3];this.serviceUri=this.createServiceUri(b);this._proxyUrl="";this._version=b.split("@")[5];this._tileOption="Tiled"==b.split("@")[6]}McxWmsDataSource.prototype.createServiceUri=function(a){a=a.split("@");return a[a.length-3]};McxWmsDataSource.prototype.getDriver=function(){return this.driver};
McxWmsDataSource.prototype.fullTextSearch=function(a,b,c,d){};McxWmsDataSource.prototype.testCapability=function(a){};McxWmsDataSource.prototype.deleteLayer=function(a){};McxWmsDataSource.prototype.getName=function(){return this.dataSourceName};McxWmsDataSource.prototype.getLayerCount=function(){return this.tileLayerArray.length};
McxWmsDataSource.prototype.getLayer=function(a,b,c){var d=new McxGetLayerResult;d.setArgs(b.getArgs());var e=a.split(";"),f=this,g="",g=null!=this._proxyUrl&&""!=this._proxyUrl?this._proxyUrl+this.serviceUri:this.serviceUri;a=-1<g.indexOf("?")?g+"&REQUEST=GetCapabilities&SERVICE=WMS":g+"?REQUEST=GetCapabilities&SERVICE=WMS";a=a+"&Version="+this._version;a=McxAjaxServiceCall.getAjaxCall(a,{},[this,b],"xml",!0,null,b.getAsync(),function(a){if("1.1.1"==f._version.toLowerCase()){var c=[],m=McxXMLReader.createXmlDocument(a);
a=m.findSingleNode("Layer").findNodes("SRS")[0].getValue();for(var m=m.findSingleNode("Layer").findNodes("Layer"),n=0;n<e.length;n++)if(null!=e[n]&&""!=e[n])for(var p=0;p<m.length;p++){var q=m[p],r=q.findSingleNode("Title").getValue(),t=q.findSingleNode("Name").getValue();if(""!=r&&r==e[n]||""!=t&&t==e[n]){p=new McxWmsLayerParams;p.setVersion("1.1.1");p.setImageFormat("image/png");p.setSingleTile(f._tileOption);for(var t=q.findNodes("BoundingBox"),r=null,u=0;u<t.length;u++){var r=t[u],v=r.getAttributeValue("SRS");
if(v==a)break}u=parseInt(a.split(":")[1],10);if(0==u)for(v=0;v<t.length;v++)if(a=t[v].getAttributeValue("SRS"),u=parseInt(a.split(":")[1],10),84==u){r=t[v];break}var t=null,w,x,t=84==u&&"CRS"==a.split(":")[0]?McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(4326):McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(u);4326==u&&"EPSG"==a.split(":")[0]?(v=parseFloat(r.getAttributeValue("minx")),u=parseFloat(r.getAttributeValue("miny")),x=parseFloat(r.getAttributeValue("maxx")),
w=parseFloat(r.getAttributeValue("maxy"))):(u=parseFloat(r.getAttributeValue("minx")),v=parseFloat(r.getAttributeValue("miny")),w=parseFloat(r.getAttributeValue("maxx")),x=parseFloat(r.getAttributeValue("maxy")));r=McxFactoryFinder.GeometryFactory(t).createBounds(u,v,w,x);u=q.findSingleNode("Name").getValue();p=new McxWmsLayer(f,g,u,r,p);p.setCoordinateSystem(t);q=q.findSingleNode("Title").getValue();null!=q&&""!=q&&p.setAlias(q);f.add(p);c.push(p);break}}}else if("1.3.0"==f._version.toLowerCase())for(c=
[],m=McxXMLReader.createXmlDocument(a),m=m.findSingleNode("Layer").findNodes("Layer"),n=0;n<e.length;n++){if(null!=e[n]&&""!=e[n])for(p=0;p<m.length;p++)if(q=m[p],r=q.findSingleNode("Title").getValue(),t=q.findSingleNode("Name").getValue(),""!=r&&r==e[n]||""!=t&&t==e[n]){p=new McxWmsLayerParams;a=q.findNodes("CRS")[1].getValue();t=q.findNodes("BoundingBox");r=null;for(u=0;u<t.length&&(r=t[u],v=r.getAttributeValue("CRS"),v!=a);u++);p.setVersion("1.3.0");p.setImageFormat("image/png");p.setSingleTile(f._tileOption);
u=parseInt(a.split(":")[1],10);if(0==u)for(v=0;v<t.length;v++)if(a=t[v].getAttributeValue("CRS"),u=parseInt(a.split(":")[1],10),84==u){r=t[v];break}t=84==u&&"CRS"==a.split(":")[0]?McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(4326):McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(u);4326==u&&"EPSG"==a.split(":")[0]?(v=parseFloat(r.getAttributeValue("minx")),u=parseFloat(r.getAttributeValue("miny")),x=parseFloat(r.getAttributeValue("maxx")),w=parseFloat(r.getAttributeValue("maxy"))):
(u=parseFloat(r.getAttributeValue("minx")),v=parseFloat(r.getAttributeValue("miny")),w=parseFloat(r.getAttributeValue("maxx")),x=parseFloat(r.getAttributeValue("maxy")));r=McxFactoryFinder.GeometryFactory(t).createBounds(u,v,w,x);u=q.findSingleNode("Name").getValue();p=new McxWmsLayer(f,g,u,r,p);p.setCoordinateSystem(t);q=q.findSingleNode("Title").getValue();null!=q&&""!=q&&p.setAlias(q);f.add(p);c.push(p);break}}else return alert("not supported"),!1;d.setLayers(c);b.getAsync()&&b.getSuccess().call(this,
d)},function(){});d.setRequest(a);return d};McxWmsDataSource.prototype.getSource=function(){return this.tileDataSource};McxWmsDataSource.prototype.createLayer=function(a,b,c,d){};McxWmsDataSource.prototype.copyLayer=function(a,b,c){};McxWmsDataSource.prototype.add=function(a){this.tileLayerArray.push(a)};McxWmsDataSource.prototype.setProxyUrl=function(a){this._proxyUrl=a};js.framework.driver.McxTileDriver.Ogc.McxWmsLayer={};function McxWmsLayer(a,b,c,d,e){mcx.base(this,a);this.base=this;this.base.layerName=c;this.base.fullName=b;this.size=McxFactoryFinder.GeometryFactory(null).createSize(e.getWidth(),e.getHeight());this._version=e.getVersion();this._methodName="GetMap";this._styles="";this._format=e.getImageFormat();this._exception="XML";this._transparent="TRUE";this._serviceType="WMS";this.base.envelope=d;this.base.singleTile=e.getSingleTile()}
mcx.inherits(McxWmsLayer,McxAbstractLayer);
McxWmsLayer.prototype.searchByEnvelope=function(a,b,c,d,e){b=e.getArgs()[5];a=[];var f=d=c.transformTo(this.base.coordinateSystem);null!=b.getCoordinateSystem()&&b.getCoordinateSystem()!=this.base.coordinateSystem&&(f=c.clone().transformTo(b.getCoordinateSystem()));c=new Image;var g=b.worldToView(f.getPoints()[0].getX(),f.getPoints()[0].getY()),h=b.worldToView(f.getPoints()[2].getX(),f.getPoints()[2].getY()),f=Math.min(g.getX(),h.getX()),k=Math.min(g.getY(),h.getY()),m=Math.max(g.getX(),h.getX()),
g=Math.max(g.getY(),h.getY()),g=new McxBounds(f,k,m,g,null),f=McxFactoryFinder.GeometryFactory(null).createPolygon(g,null);b=new McxTileFeature(this,f,c,null,this.getWmsTileUri(d,b,g));a.push(b);b=new McxSearchResult;b.setArgs(e.getArgs());d=new McxTileFeatureReader(this,a);b.setFeatureReader(d);b.setLayer(this);for(d=0;d<a.length;d++)b.addImage(a[d].getImage());e.getAsync()&&e.getSuccess().call(e.getScope(),b);return b};
McxWmsLayer.prototype.search=function(a,b,c,d,e){a=e.getArgs().getValue("map");b=new McxFeatureInfoParams;c=c.transformTo(a.getCoordinateSystem());c=a.worldToView(c.getBounds().getCentroid().getX(),c.getBounds().getCentroid().getY());b.setX(c.getX());b.setY(c.getY());b.setBbox(a.getWorld());b.setFeatureCount(5);b.setCoordinateSystem(a.getCoordinateSystem());b.setWidth(a.getDisplay().getWidth());b.setHeight(a.getDisplay().getHeight());b.setInfoFormat("text/xml");return this.getFeatureInfo(b,e)};
McxWmsLayer.prototype.setCoordinateSystem=function(a){null!=this.coordinateSystem?(this.base.coordinateSystem=a,this.base.envelope=this.base.envelope.transformTo(this.coordinateSystem)):this.base.coordinateSystem=a};
McxWmsLayer.prototype.getWmsTileUri=function(a,b,c){b=this.base.fullName;b+=1<b.indexOf("?")?"&":"?";b+="REQUEST="+this._methodName+"&";b+="LAYERS="+this.base.getName()+"&";b+="STYLES="+this._styles+"&";if("1.1.1"==this._version){var d=this.base.coordinateSystem.getCode(),e=this.base.coordinateSystem.getCode().split(":")[1];if("4326"==e||"0"==e)d="EPSG:4326";b=b+("SRS="+d+"&")+("BBOX="+a.getLeft()+","+a.getBottom()+","+a.getRight()+","+a.getTop()+"&")}else if("1.3.0"==this._version){d=this.base.coordinateSystem.getCode();
e=this.base.coordinateSystem.getCode().split(":")[1];if("4326"==e||"0"==e)d="EPSG:4326";b+="CRS="+d+"&";b+="BBOX="+a.getBottom()+","+a.getLeft()+","+a.getTop()+","+a.getRight()+"&";b+="TILED=TRUE&"}b+="WIDTH="+c.getWidth()+"&";b+="HEIGHT="+c.getHeight()+"&";b+="FORMAT="+this._format+"&";b+="TRANSPARENT="+this._transparent.toString().toUpperCase()+"&";b+="EXCEPTIONS="+this._exception+"&";return b+="VERSION="+this._version};
McxWmsLayer.prototype.isInstanceOf=function(a){return"McxWmsLayer"==a||"IMcxSelectableLayer"==a};McxWmsLayer.prototype.createFeatureBuffer=function(){return null};
McxWmsLayer.prototype.getFeatureInfo=function(a,b){var c=new McxSearchResult;c.setArgs(b.getArgs());var d=this,e=this.getFeatureInfoUrl(a),e=McxAjaxServiceCall.getAjaxCall(e,{},[this,b],"text",this.base.cacheable,null,b.getAsync(),function(a){a=new McxInfoFeature(d,McxFeatureInfoDataType.HTML,null,a);a=new McxInfoFeatureReader(d,[a]);c.setFeatureReader(a);b.getAsync()&&b.getSuccess().call(b.getScope(),c)},function(){});c.setRequest(e);return c};
McxWmsLayer.prototype.getFeatureInfoUrl=function(a){var b=this.base.fullName,b=b+"?Service =WMS&REQUEST=GetFeatureInfo&",b=b+("LAYERS="+this.base.getName()+"&"),b=b+("STYLES="+a.getStyles()+"&"),c=a.getBbox();"1.1.1"==this._version?(b+="CRS="+a.getCoordinateSystem().getCode()+"&",b+="BBOX="+c.getBottom()+","+c.getLeft()+","+c.getTop()+","+c.getRight()+"&"):"1.3.0"==this._version?(b+="CRS="+a.getCoordinateSystem().getCode()+"&",b+="BBOX="+c.getBottom()+","+c.getLeft()+","+c.getTop()+","+c.getRight()+
"&"):(b+="SRS="+a.getCoordinateSystem().getCode()+"&",b+="BBOX="+c.getLeft()+","+c.getBottom()+","+c.getRight()+","+c.getTop()+"&");b+="version="+this._version+"&";b+="WIDTH="+a.getWidth()+"&";b+="HEIGHT="+a.getHeight()+"&";b+="INFO_FORMAT="+a.getInfoFormat()+"&";b+="X="+a.getX()+"&";b+="Y="+a.getY()+"&";b+="FEATURE_COUNT="+a.getFeatureCount()+"&";return b=""==a.getQueryLayers()?b+("QUERY_LAYERS="+this.base.getName()):b+("QUERY_LAYERS="+a.getQueryLayers())};js.framework.driver.McxTileDriver.Ogc.McxWmsLayerParams={};function McxWmsLayerParams(){this._version="1.1.1";this._imageFormat="image/png";this._height=this._width=256;this._singleTile=!1}McxWmsLayerParams.prototype.setVersion=function(a){this._version=a};McxWmsLayerParams.prototype.setImageFormat=function(a){this._imageFormat=a};McxWmsLayerParams.prototype.setWidth=function(a){this._width=a};McxWmsLayerParams.prototype.setSingleTile=function(a){this._singleTile=a};
McxWmsLayerParams.prototype.getSingleTile=function(){return this._singleTile};McxWmsLayerParams.prototype.setHeight=function(a){this._height=a};McxWmsLayerParams.prototype.getVersion=function(){return this._version};McxWmsLayerParams.prototype.getImageFormat=function(){return this._imageFormat};McxWmsLayerParams.prototype.getWidth=function(){return this._width};McxWmsLayerParams.prototype.getHeight=function(){return this._height};js.framework.driver.McxTileDriver.Ogc.McxWmtsDataSource={};function McxWmtsDataSource(a,b){this.tileLayerArray=[];this.driver=a;this.tileDataSource=b;this.credentials=b.split("@")[2];this.dataSourceName=b.split("@")[3];this.serviceUri=this.createServiceUri(b);this._proxyUrl="";this._version=b.split("@")[5]||"1.0.0";this._tileOption="Tiled"==b.split("@")[6]}McxWmtsDataSource.prototype.createServiceUri=function(a){a=a.split("@");return a[a.length-3]};McxWmtsDataSource.prototype.getDriver=function(){return this.driver};
McxWmtsDataSource.prototype.fullTextSearch=function(a,b,c,d){};McxWmtsDataSource.prototype.testCapability=function(a){};McxWmtsDataSource.prototype.deleteLayer=function(a){};McxWmtsDataSource.prototype.getName=function(){return this.dataSourceName};McxWmtsDataSource.prototype.getLayerCount=function(){return this.tileLayerArray.length};
McxWmtsDataSource.prototype.getLayer=function(a,b,c){var d=new McxGetLayerResult;d.setArgs(b.getArgs());a.split(";");var e=this;a="";a=null!=this._proxyUrl&&""!=this._proxyUrl?this._proxyUrl+this.serviceUri:this.serviceUri;a+="?&REQUEST=GetCapabilities&SERVICE=WMTS&Version="+this._version;a=McxAjaxServiceCall.getAjaxCall(a,{},[this,b],"xml",!0,null,b.getAsync(),function(a){var c=[],h=McxXMLReader.createXmlDocument(a);a=h.findSingleNode("ows:Get").getAttributeValue("xlink:href");for(var k=h.findSingleNode("ows:WGS84BoundingBox").findSingleNode("ows:LowerCorner").getValue().split(" "),
m=h.findSingleNode("ows:WGS84BoundingBox").findSingleNode("ows:UpperCorner").getValue().split(" "),n=parseFloat(k[0]),p=parseFloat(k[1]),q=parseFloat(m[0]),r=parseFloat(m[1]),m=Math.min(n,q),k=Math.min(p,r),n=Math.max(n,q),p=Math.max(p,r),t=h.findNodes("Layer"),q=[],r=[],u=0;u<t.length;u++){var v=t[u].findNodes("ows:Identifier");1>v.length||(v=v[0].getValue(),null!=v&&""!=v&&-1==r.indexOf(v)&&(r.push(v),q.push(t[u])))}u=h.findNodes("TileMatrixSet");h=[];for(t=0;t<u.length;t++)u[t].hasChildNode("ows:Identifier")&&
h.push(u[t]);for(u=0;u<q.length;u++){var w=h[u];if(""!=w.getSingleNode("ows:Identifier").getValue()){t=[];w.getSingleNode("ows:Identifier").getValue();for(var v=w.getSingleNode("ows:SupportedCRS").getValue().split(":"),v=parseInt(v[v.length-1],10),v=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(v),x=McxFactoryFinder.GeometryFactory(v).createBounds(m,k,n,p),y=w.findNodes("TileMatrix"),A=0;A<y.length;A++){var w=y[A],B=parseInt(w.findSingleNode("ows:Identifier").getValue(),10),z=
parseFloat(w.findSingleNode("ScaleDenominator").getValue()),C=w.findSingleNode("TopLeftCorner").getValue().split(" "),C=McxFactoryFinder.GeometryFactory(null).createPoint(parseFloat(C[1]),parseFloat(C[0])),D=parseInt(w.findSingleNode("TileWidth").getValue(),10),F=parseInt(w.findSingleNode("TileHeight").getValue(),10),E=parseInt(w.findSingleNode("MatrixWidth").getValue(),10),w=parseInt(w.findSingleNode("MatrixHeight").getValue(),10),w=new McxWmtsTileMatrix(B,z,C,D,F,E,w);t.push(w)}w=new McxWmtsLayerParams;
w.setResourceUrl(a);w.setTileMatrixes(t);w.setCoordinateSystem(v);w.setBounds(x);t=new McxWmtsLayer(e,a,r[u],w);c.push(t)}}d.setLayers(c);b.getAsync()&&b.getSuccess().call(this,d)},function(){});d.setRequest(a);return d};McxWmtsDataSource.prototype.getSource=function(){return this.tileDataSource};McxWmtsDataSource.prototype.createLayer=function(a,b,c,d){};McxWmtsDataSource.prototype.copyLayer=function(a,b,c){};McxWmtsDataSource.prototype.add=function(a){this.tileLayerArray.push(a)};
McxWmtsDataSource.prototype.setProxyUrl=function(a){this._proxyUrl=a};js.framework.driver.McxTileDriver.Ogc.McxWmtsLayer={};function McxWmtsLayer(a,b,c,d){mcx.base(this,a);this.base=this;this.base.layerName=c;this.base.fullName=b;this._styles="";this._wmsLayerParams=d;this._exception="XML";this._transparent="TRUE";this._serviceType="WMTS";this.base.envelope=d.getBounds();this.base.coordinateSystem=d.getCoordinateSystem()}mcx.inherits(McxWmtsLayer,McxAbstractLayer);
McxWmtsLayer.prototype.searchByEnvelope=function(a,b,c,d,e){b=e.getArgs()[5];a=[];c=this.getTileParameter(b,c,0);for(b=0;b<c.length;b++){d=c[b];var f=new Image,g=McxFactoryFinder.GeometryFactory(null).createPolygon(d.getDisplay(),null);d=new McxTileFeature(this,g,f,null,d.getImageUrl());a.push(d)}c=new McxSearchResult;c.setArgs(e.getArgs());b=new McxTileFeatureReader(this,a);c.setFeatureReader(b);c.setLayer(this);for(b=0;b<a.length;b++)c.addImage(a[b].getImage());e.getAsync()&&e.getSuccess().call(e.getScope(),
c);return c};
McxWmtsLayer.prototype.getTileParameter=function(a,b,c){var d=1;c=a.getCoordinateSystem();null!=c&&(d=c.getDistancePerUnit());c=a.getPixelScale()*d;c=this.getAppropriateTileMatrix(c);var e=.28*c.getScaleDenominator()*.001,f=c.getTileWidth(),g=c.getTileHeight(),f=e*f/d,d=e*g/d,e=c.getTopLeft(),h=b.transformTo(this.base.coordinateSystem),k=Math.floor((h.getLeft()-e.x)/f);b=Math.ceil((e.y-h.getTop())/d)-1;g=Math.ceil((h.getRight()-e.x)/f)-1;h=Math.floor((e.y-h.getBottom())/d);0>k&&(k=0);0>g&&(g=0);0>
b&&(b=0);0>h&&(h=0);g>c.getMatrixWidth()&&(g=c.getMatrixWidth());h>c.getMatrixHeight()&&(h=c.getMatrixHeight());for(var m=[];k<=g;k++)for(var n=e.x+k*f,p=e.x+(k+1)*d,q=b;q<=h;q++){var r=e.y-(q+1)*d,t=(new McxPoint(n,e.y-q*d,this.base.coordinateSystem)).transformTo(a.getCoordinateSystem()),t=a.worldToView(t.getX(),t.getY()),r=(new McxPoint(p,r,this.base.coordinateSystem)).transformTo(a.getCoordinateSystem()),u=a.worldToView(r.getX(),r.getY()),r=Math.min(t.x,u.x),v=Math.min(t.y,u.y),w=Math.max(t.x,
u.x),t=Math.max(t.y,u.y),t=new McxBounds(r,v,Math.ceil(w),Math.ceil(t),null),r=this._wmsLayerParams.getResourceUrl(),r=r+"style={Style}&layer={layer}&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix={TileMatrix}&TileCol={TileCol}&TileRow={TileRow}",r=r.replace("{layer}",this.base.layerName),r=r.replace("{Style}","Default"),r=r.replace("{TileMatrix}",c.getIdentifier().toString()),r=r.replace("{TileRow}",q.toString()),r=r.replace("{TileCol}",k.toString()),t=new McxTileParameter(r,
t);m.push(t)}return m};McxWmtsLayer.prototype.getAppropriateTileMatrix=function(a){for(var b=this._wmsLayerParams.getTileMatrixes(),c=Number.MAX_VALUE,d=null,e=0;e<b.length;e++){var f=b[e],g=.28*.001*f.getScaleDenominator(),g=Math.abs(g-a);g<c&&(c=g,d=f)}return d};McxWmtsLayer.prototype.isInstanceOf=function(a){return"McxWmtsLayer"==a};McxWmtsLayer.prototype.createFeatureBuffer=function(){return null};js.framework.driver.McxTileDriver.Ogc.McxWmtsLayerParams={};function McxWmtsLayerParams(){this._version="1.0.0";this._imageFormat="image/png";this._tileMatrix=[];this._resourceUrl="";this._bounds=this._coordinateSystem=null}McxWmtsLayerParams.prototype.getTileMatrixes=function(){return this._tileMatrix};McxWmtsLayerParams.prototype.setTileMatrixes=function(a){this._tileMatrix=a};McxWmtsLayerParams.prototype.getBounds=function(){return this._bounds};
McxWmtsLayerParams.prototype.setBounds=function(a){this._bounds=a};McxWmtsLayerParams.prototype.getResourceUrl=function(){return this._resourceUrl};McxWmtsLayerParams.prototype.setResourceUrl=function(a){this._resourceUrl=a};McxWmtsLayerParams.prototype.getCoordinateSystem=function(){return this._coordinateSystem};McxWmtsLayerParams.prototype.setCoordinateSystem=function(a){this._coordinateSystem=a};McxWmtsLayerParams.prototype.setImageFormat=function(a){this._imageFormat=a};js.framework.driver.McxTileDriver.Ogc.McxWmtsTileMatrix={};function McxWmtsTileMatrix(a,b,c,d,e,f,g){this._identifier=a;this._scaleDenominator=b;this._topLeftCorner=c;this._tileHeight=e;this._tileWidth=d;this._matrixWidth=f;this._matrixHeight=g}McxWmtsTileMatrix.prototype.getIdentifier=function(){return this._identifier};McxWmtsTileMatrix.prototype.getScaleDenominator=function(){return this._scaleDenominator};McxWmtsTileMatrix.prototype.getTopLeft=function(){return this._topLeftCorner};
McxWmtsTileMatrix.prototype.getMatrixWidth=function(){return this._matrixWidth};McxWmtsTileMatrix.prototype.getMatrixHeight=function(){return this._matrixHeight};McxWmtsTileMatrix.prototype.getTileHeight=function(){return this._tileHeight};McxWmtsTileMatrix.prototype.getTileWidth=function(){return this._tileWidth};js.framework.driver.McxTileDriver.OnlineMap={};js.framework.driver.McxTileDriver.OnlineMap.McxBingLayer={};function McxBingLayer(a,b){mcx.base(this,a,b);this.base=this}mcx.inherits(McxBingLayer,McxTileLayer);
McxBingLayer.prototype.getTileImageUrl=function(a,b,c){c=this.tileXYToQuadKey(a,b,c);a=new McxPoint(a,b,null);a=this.getServerNum(a,4);switch(this.base.layerName){case McxTileLayerType.Bing:return"http://ecn.t"+a+".tiles.virtualearth.net/tiles/h"+c+".jpeg?g=1173&mkt=en&n=z";case McxTileLayerType.BingHybrid:return"http://ecn.t"+a+".tiles.virtualearth.net/tiles/r"+c+"?g=1173&mkt=en&lbl=l1&stl=h&shading=hill&n=z";case McxTileLayerType.BingSatellite:return"http://ecn.t"+a+".tiles.virtualearth.net/tiles/a"+
c+".jpeg?g=1173&mkt=en&n=z"}return""};McxBingLayer.prototype.getServerNum=function(a,b){return Math.round((a.getX()+2*a.getY())%b)};McxBingLayer.prototype.tileXYToQuadKey=function(a,b,c){for(var d="";0<c;c--){var e="0",f=1<<c-1;0!=(a&f)&&e++;0!=(b&f)&&(e++,e++);d+=e}return d};js.framework.driver.McxTileDriver.OnlineMap.McxGoogleLayer={};function McxGoogleLayer(a,b){mcx.base(this,a,b);this.googleMap="http://mts1.google.com/vt/lyrs=m@210119155&hl=en&src=app&";this.googleHybridMap="http://mts1.google.com/vt/lyrs=h@210119155&hl=en&src=app&";this.googleSatelliteMap="http://mts1.google.com/vt/lyrs=s@210119155&hl=en&src=app&";this.googleTerrainMap="http://mts1.google.com/vt/lyrs=t@210119155&hl=en&src=app&";this.base=this}mcx.inherits(McxGoogleLayer,McxTileLayer);
McxGoogleLayer.prototype.getTileImageUrl=function(a,b,c){switch(this.base.layerName){case McxTileLayerType.Google:return this.googleMap+"x="+a+"&y="+b+"&z="+c;case McxTileLayerType.GoogleHybrid:return this.googleHybridMap+"x="+a+"&y="+b+"&z="+c;case McxTileLayerType.GoogleSatellite:return this.googleSatelliteMap+"x="+a+"&y="+b+"&z="+c;case McxTileLayerType.GoogleTerrain:return this.googleTerrainMap+"x="+a+"&y="+b+"&z="+c}return""};js.framework.driver.McxTileDriver.OnlineMap.McxOnlineMapDataSource={};function McxOnlineMapDataSource(a,b){mcx.base(this,a,b);this.base=this;this.base.dataSourceName="OnlineMap"}mcx.inherits(McxOnlineMapDataSource,McxAbstractDataSource);McxOnlineMapDataSource.prototype.testCapability=function(a){};
McxOnlineMapDataSource.prototype.getLayer=function(a,b,c){c=new McxGetLayerResult;c.setArgs(b.getArgs());a=a.split(";");for(var d=[],e=0;e<a.length;e++){var f=null;switch(a[e]){case McxTileLayerType.GoogleHybrid:f=new McxGoogleLayer(this,McxTileLayerType.GoogleHybrid);break;case McxTileLayerType.Google:f=new McxGoogleLayer(this,McxTileLayerType.Google);break;case McxTileLayerType.GoogleSatellite:f=new McxGoogleLayer(this,McxTileLayerType.GoogleSatellite);break;case McxTileLayerType.GoogleTerrain:f=
new McxGoogleLayer(this,McxTileLayerType.GoogleTerrain);break;case McxTileLayerType.Bing:f=new McxBingLayer(this,McxTileLayerType.Bing);break;case McxTileLayerType.BingHybrid:f=new McxBingLayer(this,McxTileLayerType.BingHybrid);break;case McxTileLayerType.BingSatellite:f=new McxBingLayer(this,McxTileLayerType.BingSatellite);break;case McxTileLayerType.OpenStreet:f=new McxOpenStreetLayer(this,McxTileLayerType.OpenStreet);break;case McxTileLayerType.OpenCycle:f=new McxOpenStreetLayer(this,McxTileLayerType.OpenCycle);
break;case McxTileLayerType.OpenCycleLandscape:f=new McxOpenStreetLayer(this,McxTileLayerType.OpenCycleLandscape);break;case McxTileLayerType.OpenCycleTransport:f=new McxOpenStreetLayer(this,McxTileLayerType.OpenCycleTransport);break;case McxTileLayerType.OpenSeaHybrid:f=new McxOpenStreetLayer(this,McxTileLayerType.OpenSeaHybrid);break;case McxTileLayerType.OpenStreetMap4U:f=new McxOpenStreetLayer(this,McxTileLayerType.OpenStreetMap4U);break;case McxTileLayerType.OpenStreetQuest:f=new McxOpenStreetLayer(this,
McxTileLayerType.OpenStreetQuest);break;case McxTileLayerType.OpenStreetQuestHybrid:f=new McxOpenStreetLayer(this,McxTileLayerType.OpenStreetQuestHybrid);break;case McxTileLayerType.OpenStreetQuestSatellite:f=new McxOpenStreetLayer(this,McxTileLayerType.OpenStreetQuestSatellite);break;case McxTileLayerType.Humanitarian:f=new McxOpenStreetLayer(this,McxTileLayerType.Humanitarian);break;case McxTileLayerType.Ovi:f=new McxOviLayer(this,McxTileLayerType.Ovi);break;case McxTileLayerType.OviHybrid:f=new McxOviLayer(this,
McxTileLayerType.OviHybrid);break;case McxTileLayerType.OviSatellite:f=new McxOviLayer(this,McxTileLayerType.OviSatellite);break;case McxTileLayerType.OviTerrain:f=new McxOviLayer(this,McxTileLayerType.OviTerrain);break;case McxTileLayerType.YandexMap:f=new McxYandexLayer(this,McxTileLayerType.YandexMap);break;case McxTileLayerType.YandexSatelliteMap:f=new McxYandexLayer(this,McxTileLayerType.YandexSatelliteMap);break;case McxTileLayerType.YandexHybridMap:f=new McxYandexLayer(this,McxTileLayerType.YandexHybridMap)}null==
f||d.push(f)}c.setLayers(d);b.getAsync()&&b.getSuccess().call(b.getScope(),c);return c};js.framework.driver.McxTileDriver.OnlineMap.McxOpenStreetLayer={};function McxOpenStreetLayer(a,b){mcx.base(this,a,b);this.layerType=b}mcx.inherits(McxOpenStreetLayer,McxTileLayer);var serverLetters="abc";
McxOpenStreetLayer.prototype.getTileImageUrl=function(a,b,c){var d=new McxPoint(a,b,null),d=this.getServerNum(d,3),e=serverLetters[d];switch(this.layerType){case McxTileLayerType.OpenStreet:return"http://"+e+".tile.openstreetmap.org/"+c+"/"+a+"/"+b+".png";case McxTileLayerType.OpenStreetMap4U:return"http://4umaps.eu/"+c+"/"+a+"/"+b+".png";case McxTileLayerType.OpenCycleLandscape:return"http://"+e+".tile3.opencyclemap.org/landscape/"+c+"/"+a+"/"+b+".png";case McxTileLayerType.OpenCycle:return"http://"+
e+".tile.opencyclemap.org/cycle/"+c+"/"+a+"/"+b+".png";case McxTileLayerType.OpenCycleTransport:return"http://"+e+".tile2.opencyclemap.org/transport/"+c+"/"+a+"/"+b+".png";case McxTileLayerType.OpenSeaHybrid:return"http://tiles.openseamap.org/seamark/"+c+"/"+a+"/"+b+".png";case McxTileLayerType.Humanitarian:return"http://c.tile.openstreetmap.fr/hot/"+c+"/"+a+"/"+b+".png";case McxTileLayerType.OpenStreetQuest:return"http://otile"+d+".mqcdn.com/tiles/1.0.0/osm/"+c+"/"+a+"/"+b+".png";case McxTileLayerType.OpenStreetQuestHybrid:return"http://otile4.mqcdn.com/tiles/1.0.0/osm/"+
c+"/"+a+"/"+b+".png";case McxTileLayerType.OpenStreetQuestSatellite:return"http://otile"+d+".mqcdn.com/tiles/1.0.0/sat/"+c+"/"+a+"/"+b+".png"}return""};McxOpenStreetLayer.prototype.getServerNum=function(a,b){return Math.round((a.getX()+2*a.getY())%b)};js.framework.driver.McxTileDriver.OnlineMap.McxOviLayer={};function McxOviLayer(a,b){mcx.base(this,a,b);this.layerType=b}mcx.inherits(McxOviLayer,McxTileLayer);
McxOviLayer.prototype.getTileImageUrl=function(a,b,c){var d=new McxPoint(a,b,null);this.getServerNum(d,4);this.getServerNum(d,4);switch(this.layerType){case McxTileLayerType.Ovi:return"http://2.maps.nlp.nokia.com/maptile/2.1/maptile/b6d442adca/normal.day/"+c+"/"+a+"/"+b+"/256/png8?lg=ENG&token=TrLJuXVK62IQk0vuXFzaig%3D%3D&requestid=yahoo.prod&app_id=eAdkWGYRoc4RfxVo0Z4B.png";case McxTileLayerType.OviHybrid:return"http://2.maps.nlp.nokia.com/maptile/2.1/maptile/b6d442adca/hybrid.day/"+c+"/"+a+"/"+
b+"/256/png8?lg=ENG&token=TrLJuXVK62IQk0vuXFzaig%3D%3D&requestid=yahoo.prod&app_id=eAdkWGYRoc4RfxVo0Z4B.png";case McxTileLayerType.OviSatellite:return"http://2.maps.nlp.nokia.com/maptile/2.1/maptile/b6d442adca/satellite.day/"+c+"/"+a+"/"+b+"/256/png8?lg=ENG&token=TrLJuXVK62IQk0vuXFzaig%3D%3D&requestid=yahoo.prod&app_id=eAdkWGYRoc4RfxVo0Z4B.png";case McxTileLayerType.OviTerrain:return"http://2.maps.nlp.nokia.com/maptile/2.1/maptile/b6d442adca/terrain.day/"+c+"/"+a+"/"+b+"/256/png8?lg=ENG&token=TrLJuXVK62IQk0vuXFzaig%3D%3D&requestid=yahoo.prod&app_id=eAdkWGYRoc4RfxVo0Z4B.png"}return""};
McxOviLayer.prototype.getServerNum=function(a,b){return Math.round((a.getX()+2*a.getY())%b)};js.framework.driver.McxTileDriver.OnlineMap.McxPureProjection={};function McxPureProjection(){}
McxPureProjection.prototype.getAreaTileList=function(a,b,c){var d=[],e=new McxPoint(a.getTop(),a.getLeft(),null),f=new McxPoint(a.getBottom(),a.getRight(),null),e=this.fromPixelToTileXY(this.fromLatLngToPixel(e.getX(),e.getY(),b));b=this.fromPixelToTileXY(this.fromLatLngToPixel(f.getX(),f.getY(),b));for(f=e.getX()-c;f<=b.getX()+c;f++)for(var g=e.getY()-c;g<=b.getY()+c;g++){var h=new McxPoint(f,g,null);!this.contains(a,h)&&0<=h.getX()&&0<=h.getY()&&d.push(h)}return d};
McxPureProjection.prototype.fromLatLngToPixel=function(a,b,c){};McxPureProjection.prototype.clip=function(a,b,c){return Math.min(Math.max(a,b),c)};McxPureProjection.prototype.getTileMatrixSizePixel=function(a){a=this.getTileMatrixSizeXY(a);return new McxPoint(a.getWidth()*this.getTileSize().getWidth(),a.getHeight()*this.getTileSize().getHeight(),null)};
McxPureProjection.prototype.getTileMatrixSizeXY=function(a){var b=this.getTileMatrixMinXY(a);a=this.getTileMatrixMaxXY(a);return new McxSize(a.getWidth()-b.getWidth()+1,a.getHeight()-b.getHeight()+1)};McxPureProjection.prototype.getTileMatrixMinXY=function(a){return new McxSize(0,0)};McxPureProjection.prototype.getTileMatrixMaxXY=function(a){a=1<<a;return new McxSize(a-1,a-1)};
McxPureProjection.prototype.fromPixelToTileXY=function(a){return new McxPoint(Math.floor(a.getX()/this.getTileSize().getWidth()),Math.floor(a.getY()/this.getTileSize().getHeight()),null)};McxPureProjection.prototype.getTileSize=function(){};McxPureProjection.prototype.fromPixelToLatLng=function(a,b,c){};McxPureProjection.prototype.contains=function(a,b){return a.getLeft()<=b.getX()&&a.getRight()>=b.getX()&&a.getBottom()>=b.getY()&&a.getTop()<=b.getY()};js.framework.driver.McxTileDriver.OnlineMap.McxMercatorProjection={};function McxMercatorProjection(){mcx.base(this);this.minLatitude=-85.05112878;this.maxLatitude=85.05112878;this.minLongitude=-180;this.maxLongitude=180;this.size=McxFactoryFinder.GeometryFactory(null).createSize(256,256)}mcx.inherits(McxMercatorProjection,McxPureProjection);McxMercatorProjection.prototype.getTileSize=function(){return this.size};
McxMercatorProjection.prototype.getAreaTileList=function(a,b,c){return McxMercatorProjection.superClass_.getAreaTileList.call(this,a,b,c)};McxMercatorProjection.prototype.clip=function(a,b,c){return McxMercatorProjection.superClass_.clip.call(this,a,b,c)};
McxMercatorProjection.prototype.fromLatLngToPixel=function(a,b,c){a=this.clip(a,this.minLatitude,this.maxLatitude);b=this.clip(b,this.minLongitude,this.maxLongitude);b=(b+180)/360;a=Math.sin(a*Math.PI/180);a=.5-Math.log((1+a)/(1-a))/(4*Math.PI);var d=this.getTileMatrixSizePixel(c);c=d.getX();d=d.getY();b=Math.floor(this.clip(b*c+.5,0,c-1));a=Math.floor(this.clip(a*d+.5,0,d-1));return new McxPoint(b,a,null)};
McxMercatorProjection.prototype.fromPixelToLatLng=function(a,b,c){var d=this.getTileMatrixSizePixel(c);c=d.getX();d=d.getY();a=this.clip(a,0,c-1)/c-.5;b=.5-this.clip(b,0,d-1)/d;b=90-360*Math.atan(Math.exp(2*-b*Math.PI))/Math.PI;return new McxPoint(b,360*a,null)};js.framework.driver.McxTileDriver.OnlineMap.McxYandexLayer={};function McxYandexLayer(a,b){mcx.base(this,a,b);this.yandexLayer="http://vec01.maps.yandex.net/tiles?l=map&";this.yandexHybridMap="http://vec04.maps.yandex.net/tiles?l=skl&";this.yandexSatelliteMap="http://sat04.maps.yandex.net/tiles?l=sat&";this.base=this}mcx.inherits(McxYandexLayer,McxTileLayer);
McxYandexLayer.prototype.getTileImageUrl=function(a,b,c){switch(this.base.layerName){case McxTileLayerType.YandexMap:return this.yandexLayer+"x="+a+"&y="+b+"&z="+c+"&lang=tr_TR";case McxTileLayerType.YandexHybridMap:return this.yandexHybridMap+"x="+a+"&y="+b+"&z="+c+"&lang=tr_TR";case McxTileLayerType.YandexSatelliteMap:return this.yandexSatelliteMap+"x="+a+"&y="+b+"&z="+c+"&lang=tr_TR"}return""};
js.framework.mapping={};js.framework.mapping.McxCanvas={};js.framework.mapping.McxCanvas.McxCanvasProvider={};function McxCanvasProvider(){}
McxCanvasProvider.prototype.createCanvas=function(a,b){var c=null;if(a.isInstanceOf("McxMemLayer"))c=new McxMemCanvas(a,b);else if(a.isInstanceOf("McxFsLayer"))c=new McxFsCollectionCanvas(a,b);else if(a.isInstanceOf("McxTileLayer")||a.isInstanceOf("McxOrthophotoLayer")||a.isInstanceOf("McxCacheLayer")||a.isInstanceOf("McxArcGisLayer"))c=new McxImageCanvas(a,b),a.getName()!=McxTileLayerType.Humanitarian&&c.setCrossOrigin("anonymous"),(a.getName()==McxTileLayerType.GoogleHybrid||a.getName()==McxTileLayerType.BingHybrid||
a.getName()==McxTileLayerType.OpenSeaHybrid||a.getName()==McxTileLayerType.YandexHybridMap||a.isInstanceOf("McxArcGisLayer"))&&c.backBufferEnabled(!1),a.isInstanceOf("McxCacheLayer")&&c.backBufferEnabled(!1);else if(a.isInstanceOf("McxWmsLayer")||a.isInstanceOf("McxWmtsLayer")||a.isInstanceOf("McxArcGisTileCacheLayer"))c=new McxWMSCanvas(a,b),c.backBufferEnabled(!1);return c};js.framework.mapping.McxCanvas.McxCluster={};function McxCluster(a,b,c,d){this._id=a;this._point=b;this._offset=c;this._map=d;this._count=1;this._y=this._x=0;this._types=[];this._ids=[];this.initialize()}McxCluster.prototype.initialize=function(){var a=this._map.worldToView(this._point.getX(),this._point.getY());this._x=a.getX();this._y=a.getY()};
McxCluster.prototype.isContains=function(a){a=this._map.worldToView(a.getX(),a.getY());var b=this._x-this._offset<a.getX()&&this._x+this._offset>a.getX();a=this._y-this._offset<a.getY()&&this._y+this._offset>a.getY();return b&&a};McxCluster.prototype.add=function(a,b){this._ids.push(a);this._types.push(b);this._count++};McxCluster.prototype.getFeatureID=function(){return this._id};McxCluster.prototype.getGeometry=function(){return this._point};McxCluster.prototype.getCount=function(){return this._count};js.framework.mapping.McxCanvas.McxGrid={};function McxGrid(a,b){this.map=a;this.tileSize=this.map.getTileSize();this.display=this.world=null;this.cells=[];this.initialize(b)}
McxGrid.prototype.initialize=function(a){if(null==a)this.display=this.map.getDisplay(),this.world=this.map.getWorld();else{this.world=a;var b=this.map.worldToView(a.getLeft(),a.getTop()),c=this.map.worldToView(a.getRight(),a.getBottom());a=Math.floor(Math.min(b.x,c.x));var d=Math.ceil(Math.max(b.x,c.x)),e=Math.floor(Math.min(b.y,c.y)),b=Math.ceil(Math.max(b.y,c.y));this.display=new McxBounds(a,e,d+1,b+1,null)}};
McxGrid.prototype.calculate=function(){var a=this.map.getPixelScale(),b=a*this.tileSize.getWidth(),a=a*this.tileSize.getHeight(),c=Math.floor(this.world.left/b),d=c*b,c=Math.floor(this.world.bottom/a),e=c*a,c=Math.ceil(this.world.right/b),f=c*b,c=Math.ceil(this.world.top/a);this.world=new McxBounds(d,e,f,c*a,this.world.getCoordinateSystem());var c=Math.round(this.world.getWidth()/b),d=Math.round(this.world.getHeight()/a),e=Math.round(this.world.left/b),f=Math.round(this.world.top/a),g=new McxPoint(this.world.left,
this.world.top,this.world.getCoordinateSystem());this.cells=[];for(var h=0;h<c;h++)for(var k=0;k<d;k++){var m=g.x+h*b,n=g.x+(h+1)*b,p=g.y-(k+1)*a,q=g.y-k*a,r=Math.min(m,n),t=Math.min(p,q),m=Math.max(m,n),q=Math.max(p,q),p=new McxBounds(r,t,m,q,this.world.getCoordinateSystem()),r=this.map.worldToView(r,q),n=this.map.worldToView(m,t),t=Math.min(r.x,n.x),m=Math.min(r.y,n.y),q=Math.max(r.x,n.x),r=Math.max(r.y,n.y),t=new McxBounds(t,m,q,r,this.map.getCoordinateSystem()),p=new McxCell(h+e,f-k-1,p,t);this.cells.push(p)}};
McxGrid.prototype.findCell=function(a,b){if(a<this.display.left||a>this.display.right||b<this.display.bottom||b>this.display.top)return null;for(var c=b-this.display.bottom,d=Math.ceil((a-this.display.left)/this.tileSize.getWidth())-1,c=Math.ceil(c/this.tileSize.getHeight())-1,e=0;e<this.cells.length;e++)if(this.cells[e].getIndexX()==d&&this.cells[e].getIndexY()==c)return this.cells[e];return null};McxGrid.prototype.getCells=function(){return this.cells};js.framework.mapping.McxCanvas.McxImageCanvas={};
function McxImageCanvas(a,b){this.layer=a;this.canvasId=McxGuid.createGuid();this.layerId=a.getUniqueId();this.height=this.width=0;this.isDirty=!1;this.map=b;this.paintedFeatures=new McxPaintedFeatures(15E3);this.requestName=0;this.requests=[];this.requestsCanceled=!1;this.rendererEventHandler=new McxEventHandler;this.labelRendererEventHandler=new McxEventHandler;this.zIndex=this.map.getLayers().getCount()+1;this.backBuffered=!0;this.totalProgress=this.translateY=this.translateX=0;this.drawContextToAnotherTarget=
null;this.initialize();this.setOpacity(this.layer.getOpacity());this.crossOrigin=""}
McxImageCanvas.prototype.initialize=function(){this.layer.isInstanceOf("McxOrthophotoLayer")&&(this.backBuffered=!1);var a=$("<div/>").css("position","absolute").css("zIndex",this.zIndex).attr("id",this.layerId).attr("for",this.layer.getAlias()).addClass(""),b=$("<div/>").css("position","absolute").css("zIndex",this.zIndex).attr("id",this.layerId+"_divContainer").attr("for",this.layer.getAlias()).addClass(""),c=$("<div/>").css("position","absolute").css("zIndex",this.zIndex-1).attr("id",this.layerId+
"_backBuffer").attr("for",this.layer.getAlias()).addClass(""),d=$("<div/>").css("position","absolute").css("zIndex",this.zIndex-1).attr("id",this.layerId+"_zoom").addClass(this.map.getRenderer().getZoomAnimationClass()),e=this.map.getContent().find("#"+this.map.getName()+"_layerContainer").eq(0);$(e).append(a);$(a).append(b);$(a).append(c);$(a).append(d);this.map.getResizeEventHandler().addListener(this.onDisplayChanged,null,this)};
McxImageCanvas.prototype.onSearchSuccess=function(a){var b=a.getFeatureReader(),c=a.getArgs()[2];c.getDisplay();var d=a.getArgs()[3],e=d.getMap().getPixelScale();a=a.getArgs()[4];if(0!=Math.abs(e-a))this.totalProgress--,0==this.totalProgress&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,b));else{c.getWorld();c=d.getMap().getWorld();e=this.layer.getCoordinateSystem();null==c.getCoordinateSystem()||c.getCoordinateSystem().equals(e)||c.transformTo(e);
c={count:b.getFeatureCount()};if(0==b.getFeatureCount()&&(this.totalProgress--,0==this.totalProgress)){b=new McxRendererEventArgs(McxRendererStatus.End);this.rendererEventHandler.dispatchOnSuccess(self,b);return}for(;b.read();){if(d.requestsCanceled){this.totalProgress=0;b=new McxRendererEventArgs(McxRendererStatus.Canceled);this.rendererEventHandler.dispatchOnSuccess(this,b);break}(e=b.getCurrent())&&e.getGeometry()&&this.paint(e,c,a)}}};
McxImageCanvas.prototype.setCrossOrigin=function(a){this.crossOrigin=a};
McxImageCanvas.prototype.paint=function(a,b,c){var d=this.map.getContent().find("#"+this.layerId+"_divContainer").eq(0).find("[src='"+a.getQueryString()+"']");if(0<d.length){a.image=null;var e=a.getGeometry().getBounds(),f=d[0],d="width:"+e.getWidth().toString()+"px; height:"+e.getHeight().toString()+"px; position: absolute; left:"+(e.getLeft()-this.translateX).toString()+"px;top:"+(e.getBottom()-this.translateY).toString()+"px; ";f.setAttribute("style",d)}else{var g=this;""!=this.crossOrigin&&(a.getImage().crossOrigin=
this.crossOrigin);e=a.getGeometry().getBounds();f=a.getImage();f.setAttribute("draggable","false");f.setAttribute("ondragstart","return false;");d="width:"+e.getWidth().toString()+"px; height:"+e.getHeight().toString()+"px; position: absolute; left:"+(e.getLeft()-this.translateX).toString()+"px;top:"+(e.getBottom()-this.translateY).toString()+"px; ";null==this.drawContextToAnotherTarget&&f.setAttribute("style",d);a.getImage().onload=function(){if(null!=g.drawContextToAnotherTarget){if(g.drawContextToAnotherTarget.getGeodeticGraphics().drawImage(a.getImage(),
e.getLeft(),e.getBottom(),e.getWidth()+1,e.getHeight()+1),b.count--,0==b.count&&(g.totalProgress--,0==g.totalProgress)){var d=new McxRendererEventArgs(McxRendererStatus.End);g.rendererEventHandler.dispatchOnSuccess(g,d)}}else 0<g.map.getContent().find("#"+g.layerId+"_divContainer").eq(0).find("[src='"+a.getQueryString()+"']").length||(d=g.map.getPixelScale(),0==Math.abs(d-c)&&g.map.getContent().find("#"+g.layerId+"_divContainer").eq(0).append(f))};a.getImage().onerror=function(){b.count--;if(0==b.count&&
(g.totalProgress--,0==g.totalProgress)){var a=new McxRendererEventArgs(McxRendererStatus.End);g.rendererEventHandler.dispatchOnSuccess(g,a)}};a.getImage().src=a.getQueryString()}};
McxImageCanvas.prototype.paintLayer=function(a){(!this.backBuffered||null!=this.lastScale&&this.map.getScale()<this.lastScale)&&$("#"+this.layerId+"_backBuffer").children("*").fadeTo(300,0);var b=function(){this.totalProgress--;if(0==this.totalProgress){var a=new McxRendererEventArgs(McxRendererStatus.End);this.rendererEventHandler.dispatchOnSuccess(this,a)}};if(this.map.inVisibleRange(this.layer.getMinScale(),this.layer.getMaxScale()))if(this.requestsCanceled=!1,this.isDirty&&(this.clearCanvas(),
this.isDirty=!1),this.layer.getVisible()){var c=this.layer.getKeyField()+","+this.layer.getGeometryField(),d=this.map.getPixelScale();this.lastScale=this.map.getScale();var e,f=e=this.map.getWorld();null==this.map.getCoordinateSystem()||f.getCoordinateSystem().equals(this.layer.getCoordinateSystem())||(e=f.transformTo(this.layer.getCoordinateSystem()));var f=this.map.getTileSize().getWidth(),g=this.map.getTileSize().getHeight();a=this.map.getWorld().transformTo(this.layer.getCoordinateSystem());var h=
this.map.getDisplay();a=new McxLayerGrid(a,h,this.map.getTileSize(),null);a.calculate();a=a.getCells();this.layer.isSingleTile()&&(a=[new McxCell(0,0,e,this.map.getDisplay())],f=this.map.getDisplay().getWidth(),g=this.map.getDisplay().getHeight());this.totalProgress=a.length;for(e=0;e<a.length;e++){var h=null,h=this.transformCellToTarget(a[e],this.layer.getCoordinateSystem()),k=[];k.push(this.map.getWorld());k.push(this.map.getDisplay());k.push(h);k.push(this);k.push(d);k.push(this.map);k.push(f);
k.push(g);var m=new McxAjaxParameter;m.setParameters(this,this.onSearchSuccess,b);m.setArgs(k);h=this.layer.searchByEnvelope(c,"",h.getWorld(),"Intersects",m);this.requests.push(h)}}else this.clearCanvas(),this.clearBackBuffer();else this.clearCanvas(),this.rendererEventHandler.dispatchOnSuccess(this,null)};
McxImageCanvas.prototype.getValueWithPoint=function(a,b){var c=this.map.worldToView(a.getX(),a.getY()),d=this.getIntersect(c);if(!d||null==d)return Number.MIN_VALUE;var e=$("<canvas/>")[0];e.width=d.width;e.height=d.height;e.getContext("2d").drawImage(d,0,0,d.width,d.height);var e=e.getContext("2d"),d=this.getTransform(d,!1),f=e.getImageData(c.getX()-d.getLeft(),c.getY()-d.getBottom(),1,1).data,c=f[0],d=f[1],e=f[2],f=f[3];return 0==c&&0==d&&0==e&&0==f?Number.MIN_VALUE:b.getValueOfColor(c,d,e)};
McxImageCanvas.prototype.getColorWithPoint=function(a){a=this.map.worldToView(a.getX(),a.getY());var b=this.getIntersect(a);if(!b||null==b)return"";var c=$("<canvas/>")[0];c.width=b.width;c.height=b.height;c.getContext("2d").drawImage(b,0,0,b.width,b.height);var c=c.getContext("2d"),b=this.getTransform(b,!1),d=c.getImageData(a.getX()-b.getLeft(),a.getY()-b.getBottom(),1,1).data;a=d[0];b=d[1];c=d[2];d=d[3];return 0==a&&0==b&&0==c&&0==d?"Deger Yok":a};
McxImageCanvas.prototype.getIntersect=function(a){for(var b=$("#"+this.layerId+"_divContainer").children("*"),c=0;c<b.length;c++)if(this.getTransform(b[c],!0).contains(a.getX(),a.getY()))return b[c];return null};McxImageCanvas.prototype.getTransform=function(a,b){var c=0,d=0,c=$(a).position().left,d=$(a).position().top;return new McxBounds(c,d,$(a).width()+c,$(a).height()+d,null)};McxImageCanvas.prototype.draw=function(a,b){this.drawContextToAnotherTarget=a;this.paintLayer(b)};
McxImageCanvas.prototype.drawLabels=function(a,b){this.labelRendererEventHandler.dispatchOnSuccess(this,null)};McxImageCanvas.prototype.paintLabels=function(a){};McxImageCanvas.prototype.transformCellToTarget=function(a,b){if(null==this.map.getCoordinateSystem()||null==b||this.map.getCoordinateSystem().equals(b))return a;var c=a.getWorld().transformTo(b);return new McxCell(a.getIndexX(),a.getIndexY(),c,a.getDisplay())};
McxImageCanvas.prototype.abortRender=function(){this.requestsCanceled=!0;for(var a=0;a<this.requests.length;a++)this.requests[a].abort(),a==this.requests.length-1&&(this.requests=[]);this.requests=[]};McxImageCanvas.prototype.getRendererEventHandler=function(){return this.rendererEventHandler};McxImageCanvas.prototype.getLabelRendererEventHandler=function(){return this.labelRendererEventHandler};McxImageCanvas.prototype.onDisplayChanged=function(a,b){this.isDirty=!0;this.width=a;this.height=b};
McxImageCanvas.prototype.setDisplay=function(a,b){this.isDirty=!0;this.width=a;this.height=b};McxImageCanvas.prototype.getPaintedFeatures=function(){return this.paintedFeatures};McxImageCanvas.prototype.clearCache=function(){this.paintedFeatures.clear()};McxImageCanvas.prototype.getLayers=function(){return[this.layer]};McxImageCanvas.prototype.getMap=function(){return this.map};McxImageCanvas.prototype.paintSelection=function(){};
McxImageCanvas.prototype.isInstanceOf=function(a){return"McxImageCanvas"==a};McxImageCanvas.prototype.clearCanvas=function(){$("#"+this.layerId+"_divContainer").empty()};
McxImageCanvas.prototype.zoomTo=function(a,b,c){var d=$("#"+this.layerId+"_zoom");d[0].style.transition="0ms";d.css("-webkit-transform-origin",a+"px "+b+"px").css("-moz-transform-origin",a+"px "+b+"px").css("-ms-transform-origin",a+"px "+b+"px").css("-o-transform-origin",a+"px "+b+"px").css("transform-origin",a+"px "+b+"px");setTimeout(function(){d[0].style.transition="500ms ease-out";d.css("-webkit-transform","scale("+c+")").css("-moz-transform","scale("+c+")").css("-ms-transform","scale("+c+")").css("-o-transform",
"scale("+c+")").css("transform","scale("+c+")")},10)};McxImageCanvas.prototype.remove=function(a){$("#"+this.layerId).remove()};McxImageCanvas.prototype.dispose=function(){$("#"+this.layerId).remove()};McxImageCanvas.prototype.translate=function(a,b){0!=this.map.getPixelScale()&&(this.translateX+=-1*a/this.map.getPixelScale(),this.translateY+=b/this.map.getPixelScale())};McxImageCanvas.prototype.resetTranslation=function(){this.translateY=this.translateX=0};
McxImageCanvas.prototype.clearBackBuffer=function(){$("#"+this.layerId+"_zoom").empty();$("#"+this.layerId+"_backBuffer").empty()};McxImageCanvas.prototype.paintBackBuffer=function(){$("#"+this.layerId+"_divContainer").children("*").appendTo("#"+this.layerId+"_zoom")};McxImageCanvas.prototype.setZoomAnimationClass=function(a){var b=$("#"+this.layerId+"_zoom");b.removeClass();b.addClass(a)};
McxImageCanvas.prototype.resetZoomAnimationClass=function(){var a=$("#"+this.layerId+"_zoom");a.children("*").appendTo("#"+this.layerId+"_backBuffer");var b=$("#"+this.layerId+"_backBuffer");b.css("-webkit-transform-origin",a.css("-webkit-transform-origin")).css("-moz-transform-origin",a.css("-moz-transform-origin")).css("-o-transform-origin",a.css("-o-transform-origin")).css("-ms-transform-origin",a.css("-ms-transform-origin")).css("transform-origin",a.css("transform-origin"));b.css("-webkit-transform",
a.css("-webkit-transform")).css("-moz-transform",a.css("-moz-transform")).css("-o-transform",a.css("-o-transform")).css("-ms-transform",a.css("-ms-transform")).css("transform",a.css("transform"));a.css("-webkit-transform","scale(1)").css("-moz-transform","scale(1)").css("-ms-transform","scale(1)").css("-o-transform","scale(1)").css("transform","scale(1)")};
McxImageCanvas.prototype.setOrder=function(a){$("#"+this.layerId).css("zIndex",a);$("#"+this.layerId+"_divContainer").css("zIndex",a);$("#"+this.layerId+"_backBuffer").css("zIndex",a-1);$("#"+this.layerId+"_zoom").css("zIndex",a-1)};McxImageCanvas.prototype.setOpacity=function(a){this.layer.setOpacity(a);$("#"+this.layerId).css("opacity",a)};McxImageCanvas.prototype.backBufferEnabled=function(a){this.backBuffered=a};McxImageCanvas.prototype.canAddLayer=function(a){return!1};
McxImageCanvas.prototype.addLayer=function(a){};js.framework.mapping.McxCanvas.McxLabelCanvas={};function McxLabelCanvas(a){this.id=McxGuid.createGuid();this.map=a;this.labelSymbolizer=new McxTextSymbolizer;this.zIndex=999;this.animationClass="back-buffer-animation-off";this.translateY=this.translateX=0;this.lastId="";this.initialize()}
McxLabelCanvas.prototype.initialize=function(){var a=$("<div/>").css("position","absolute").css("zIndex",this.zIndex).attr("id",this.id).addClass(""),b=$("<div/>").css("position","absolute").css("zIndex",this.zIndex).css("opacity",1).attr("id",this.id+"_divContainer").addClass(""),c=$("<div/>").css("position","absolute").css("zIndex",this.zIndex+1).attr("id",this.id+"_zoom").addClass(this.animationClass),d=this.map.getContent().find("#"+this.map.getName()+"_layerContainer")[0];$(d).append(a);$(a).append(b);
$(a).append(c)};McxLabelCanvas.prototype.clear=function(){this.map.getContent().find("#"+this.id+"_divContainer").empty()};McxLabelCanvas.prototype.setDisplay=function(a,b){var c=this.map.getContent().find("#"+this.id)[0];null!=c&&($(c).attr("width",a),$(c).attr("height",b))};McxLabelCanvas.prototype.clearCanvas=function(){$("#"+this.id+"_divContainer").empty()};
McxLabelCanvas.prototype.zoomTo=function(a,b,c){var d=$("#"+this.id+"_zoom");d.css("-webkit-transform-origin",a+"px "+b+"px").css("-moz-transform-origin",a+"px "+b+"px").css("-ms-transform-origin",a+"px "+b+"px").css("-o-transform-origin",a+"px "+b+"px").css("transform-origin",a+"px "+b+"px");d.css("-webkit-transform","scale("+c+")").css("-moz-transform","scale("+c+")").css("-ms-transform","scale("+c+")").css("-o-transform","scale("+c+")").css("transform","scale("+c+")");setTimeout(function(){d.children("*").fadeTo(1500,
0)},1E3)};McxLabelCanvas.prototype.translate=function(a,b){if(0!=this.map.getPixelScale()){var c=-1*a/this.map.getPixelScale(),d=b/this.map.getPixelScale();this.translateX+=c;this.translateY+=d}};McxLabelCanvas.prototype.paintBackBuffer=function(){$("#"+this.id+"_divContainer").children("*").appendTo("#"+this.id+"_zoom")};McxLabelCanvas.prototype.setZoomAnimationClass=function(a){this.animationClass=a;var b=$("#"+this.id+"_zoom");b.removeClass();b.addClass(a)};
McxLabelCanvas.prototype.resetZoomAnimationClass=function(){var a=$("#"+this.id+"_zoom");setTimeout(function(){a.empty();a.css("-webkit-transform","scale(1)").css("-moz-transform","scale(1)").css("-ms-transform","scale(1)").css("-o-transform","scale(1)").css("transform","scale(1)")},1E3)};McxLabelCanvas.prototype.setOrder=function(a){this.zIndex=a;this.map.getContent().find("#"+this.id)[0].style.zIndex=a};McxLabelCanvas.prototype.setOpacity=function(a){$("#"+this.id).css("opacity",a)};
McxLabelCanvas.prototype.drawLabels=function(a,b,c,d){var e="label_"+b.toString();c.isSingleTile()&&""!=this.lastId&&this.lastId!=e&&(b=document.getElementById(this.lastId),$(b).remove());this.lastId=e;b=this.map.getContent().find("#"+e)[0];var f=!1;b&&null!=b||(f=!0,b=document.createElement("canvas"),$(b).data("data-name",e),b.id=e,b.style.position="absolute",b.setAttribute("height",(Math.floor(a.getHeight())+2).toString()+"px"),b.setAttribute("width",(Math.floor(a.getWidth())+2).toString()+"px"),
b.setAttribute("opacity","1"));var e=this.map.getContent().find("#"+this.id+"_divContainer").eq(0),g=(a.getLeft()-this.translateX).toString()+"px",h=(a.getBottom()-this.translateY).toString()+"px";f&&$(b).css("-webkit-transform","translate("+g+", "+h+")").css("-moz-transform","translate("+g+", "+h+")").css("-ms-transform","translate("+g+", "+h+")").css("-o-transform","translate("+g+", "+h+")").css("transform","translate("+g+", "+h+")");f=b.getContext("2d");f.clearRect(0,0,b.width,b.height);f=new McxDrawContext(this.map,
f);g=this.map.getPixelScale();null!=this.map.getCoordinateSystem()&&(g*=this.map.getCoordinateSystem().getDistancePerUnit());g=c.isScaledLabels()?1/g:1;f.getGeodeticGraphics().useTransform(!1);for(h=0;h<d.length;h++){var k=new McxPoint(d[h].getX(),d[h].getY(),null),m=d[h].getAngle();m&&0!=m&&c.getLabelSymbolizer().setRotation(m);f.getGeodeticGraphics().drawText(d[h].getValue(),k,c.getLabelSymbolizer(),g,a.getLeft(),a.getBottom())}f.getGeodeticGraphics().useTransform(!0);e.append(b);$(b).fadeTo(1E3,
1)};
McxLabelCanvas.prototype.getDrawContext=function(a,b){var c="label_"+b.toString(),d=this.map.getContent().find("#"+c)[0],e=!1;d&&null!=d||(e=!0,d=document.createElement("canvas"),$(d).data("data-name",c),d.style.position="absolute",d.setAttribute("height",(Math.floor(a.getHeight())+2).toString()+"px"),d.setAttribute("width",(Math.floor(a.getWidth())+2).toString()+"px"),d.setAttribute("opacity","1"));var c=this.map.getContent().find("#"+this.id+"_divContainer").eq(0),f=(a.getLeft()-this.translateX).toString()+"px",
g=(a.getBottom()-this.translateY).toString()+"px";e&&$(d).css("-webkit-transform","translate("+f+", "+g+")").css("-moz-transform","translate("+f+", "+g+")").css("-ms-transform","translate("+f+", "+g+")").css("-o-transform","translate("+f+", "+g+")").css("transform","translate("+f+", "+g+")");c.append(d);$(d).fadeTo(1E3,1);return new McxDrawContext(this.map,d.getContext("2d"))};js.framework.mapping.McxCanvas.McxLayerGrid={};function McxLayerGrid(a,b,c,d){this.tileSize=c;this.world=a;this.display=b;this.cells=[];this.initialize(d)}
McxLayerGrid.prototype.initialize=function(a){if(null==a)this.display=this.display,this.world=this.world;else{this.world=a;var b=this.worldToView(a.getLeft(),a.getTop()),c=this.worldToView(a.getRight(),a.getBottom());a=Math.floor(Math.min(b.x,c.x));var d=Math.ceil(Math.max(b.x,c.x)),e=Math.floor(Math.min(b.y,c.y)),b=Math.ceil(Math.max(b.y,c.y));this.display=new McxBounds(a,e,d+1,b+1,null)}};
McxLayerGrid.prototype.calculate=function(){var a=this.getPixelScale(),b=a*this.tileSize.getWidth(),a=a*this.tileSize.getHeight(),c=Math.floor(this.world.left/b),d=c*b,c=Math.floor(this.world.bottom/a),e=c*a,c=Math.ceil(this.world.right/b),f=c*b,c=Math.ceil(this.world.top/a);this.world=new McxBounds(d,e,f,c*a,this.world.getCoordinateSystem());var c=Math.round(this.world.getWidth()/b),d=Math.round(this.world.getHeight()/a),e=Math.round(this.world.left/b),f=Math.round(this.world.top/a),g=new McxPoint(this.world.left,
this.world.top,this.world.getCoordinateSystem());this.cells=[];for(var h=0;h<c;h++)for(var k=0;k<d;k++){var m=g.x+h*b,n=g.x+(h+1)*b,p=g.y-(k+1)*a,q=g.y-k*a,r=Math.min(m,n),t=Math.min(p,q),m=Math.max(m,n),q=Math.max(p,q),p=new McxBounds(r,t,m,q,this.world.getCoordinateSystem()),r=this.worldToView(r,q),n=this.worldToView(m,t),t=Math.min(r.x,n.x),m=Math.min(r.y,n.y),q=Math.max(r.x,n.x),r=Math.max(r.y,n.y),t=new McxBounds(t,m,q,r,this.world.getCoordinateSystem()),p=new McxCell(h+e,f-k-1,p,t);this.cells.push(p)}};
McxLayerGrid.prototype.findCell=function(a,b){if(a<this.display.left||a>this.display.right||b<this.display.bottom||b>this.display.top)return null;for(var c=b-this.display.bottom,d=Math.ceil((a-this.display.left)/this.tileSize.getWidth())-1,c=Math.ceil(c/this.tileSize.getHeight())-1,e=0;e<this.cells.length;e++)if(this.cells[e].getIndexX()==d&&this.cells[e].getIndexY()==c)return this.cells[e];return null};McxLayerGrid.prototype.getCells=function(){return this.cells};
McxLayerGrid.prototype.worldToView=function(a,b){var c=this.world.right-this.world.left,d=this.world.top-this.world.bottom;if(0>=c||0>=d)return null;var e=this.display.top-this.display.bottom,d=this.display.bottom+(e-e/d*(b+-this.world.bottom));return new McxPoint(Math.round(this.display.left+(this.display.right-this.display.left)/c*(a+-this.world.left)),Math.round(d),null)};
McxLayerGrid.prototype.getPixelScale=function(){var a=Math.sqrt(this.world.getWidth()*this.world.getWidth()+this.world.getHeight()*this.world.getHeight()),b=Math.sqrt(this.display.getWidth()*this.display.getWidth()+this.display.getHeight()*this.display.getHeight());return a/b};js.framework.mapping.McxCanvas.McxMemCanvas={};
function McxMemCanvas(a,b){this.layer=a;this.map=b;this.paintedFeatures=new McxPaintedFeatures(15E3);this.paintedCells=[];this.isDirty=!1;this.selectionSymbolizer=new McxCompositeSymbolizer;this.layerId=a.getUniqueId();this.canvasId=McxGuid.createGuid();this.height=this.width=0;this.labelCanvas=null;this.zIndex=this.map.getLayers().getCount()+1;this.translateY=this.translateX=0;this.drawContextToAnotherTarget=null;this.requests=[];this.requestsCanceled=!1;this.totalLabelRequestCount=this.totalRequestCount=
0;this.painterMode=McxPainterMode.ByLayer;this.rendererEventHandler=new McxEventHandler;this.labelRendererEventHandler=new McxEventHandler;this.backBuffered=!0;this.base=this;this.contentDiv=$("<div/>");this.initialize()}McxMemCanvas.prototype.initialize=function(){this.setUpHtmlElements();this.setUpSymbolizers();this.setOpacity(this.layer.getOpacity());this.map.getResizeEventHandler().removeListener(this.onDisplayChanged);this.map.getResizeEventHandler().addListener(this.onDisplayChanged,null,this)};
McxMemCanvas.prototype.setUpSymbolizers=function(){var a=new McxFill;a.setColor("blue");a.setOpacity(.2);var b=new McxStroke;b.setColor("blue");b.setWidth(3);var c=new McxPointSymbolizer,d=new McxCircleMark,a=new McxFill;a.setColor("blue");a.setOpacity(.2);var e=a.clone();e.setOpacity(1);d.setFill(e);d.setStroke(b);c.setSymbols([d]);this.selectionSymbolizer.setPointSymbolizer(c);c=new McxLineSymbolizer;c.setStroke(b);this.selectionSymbolizer.setLineSymbolizer(c);c=new McxPolygonSymbolizer;c.setStroke(b);
c.setFill(a);this.selectionSymbolizer.setPolygonSymbolizer(c)};
McxMemCanvas.prototype.setUpHtmlElements=function(){var a=$("<div/>").css("position","absolute").css("zIndex",this.zIndex).attr("id",this.layerId).attr("for",this.layer.getAlias()).addClass(""),b=$("<div/>").css("position","absolute").css("zIndex",this.zIndex).css("opacity",1).attr("for",this.layer.getAlias()).attr("id",this.layerId+"_divContainer").addClass(""),c=$("<div/>").css("position","absolute").css("zIndex",this.zIndex+1).attr("id",this.layerId+"_zoom").addClass(this.map.getRenderer().getZoomAnimationClass()),
d=this.layerId+"_contentContainer";this.contentDiv=$("#"+d);0==this.contentDiv.length&&(this.contentDiv=$("<div/>").attr("id",d).attr("for",this.layer.getAlias()).css("position","relative").css("width","100%").css("z-index",1001).css("height","100%").addClass(""));d=this.map.getContent().find("#"+this.map.getName()+"_layerContainer");$(d).append(a);$(a).append(b);$(a).append(c);$(a).append(this.contentDiv)};
McxMemCanvas.prototype.onSearchSuccess=function(a){if(null!=this.drawContextToAnotherTarget)this.drawModeOnSearchSuccess(a);else{var b=a.getFeatureReader(),c=a.getArgs()[2],d=c.getDisplay(),e=a.getArgs()[3],f=e.getMap().getPixelScale();a=a.getArgs()[4];if(0!=Math.abs(f-a))this.totalRequestCount--,0==this.totalRequestCount&&this.rendererEventHandler.dispatchOnSuccess(this,null);else{var f=c.getWorld(),g=a=e.getMap().getWorld(),g=this.layer.getCoordinateSystem(),g=null==a.getCoordinateSystem()||a.getCoordinateSystem().equals(g)?
a:a.transformTo(g);if(g.intersectsBounds(f)){if(f=this.canvasId+"-"+c.getIndexX()+"-"+c.getIndexY(),(a=this.map.getContent().find("#"+f))&&null!=a&&$(a).remove(),a=document.createElement("canvas"),a.id=f,a.style.position="absolute",a.setAttribute("height",(Math.floor(d.getHeight())+2).toString()+"px"),a.setAttribute("width",(Math.floor(d.getWidth())+2).toString()+"px"),a.globalCompositeOperation="source-over",f=this.map.getContent().find("#"+this.layerId+"_divContainer")[0],null!=f){var g=(d.getLeft()-
this.translateX).toString(),h=(d.getBottom()-this.translateY).toString();$(a).css("-webkit-transform","translate3d("+g+"px, "+h+"px,0px)").css("-moz-transform","translate3d("+g+"px, "+h+"px,0px)").css("-ms-transform","translate3d("+g+"px, "+h+"px,0px)").css("-o-transform","translate3d("+g+"px, "+h+"px,0px)").css("transform","translate3d("+g+"px, "+h+"px,0px)");f.appendChild(a);f=!1;g=new McxDrawContext(this.map,a.getContext("2d"));a=[];h=!0;this.layer.isShowLabels()?this.map.inVisibleRange(this.layer.getMinLabelScale(),
this.layer.getMaxLabelScale())||(h=!1):h=!1;for(g.getGeodeticGraphics().setContentDiv(this.contentDiv);b.read();){if(e.requestsCanceled){this.totalRequestCount=0;return}var k=b.getCurrent();if(k&&k.getGeometry()){e.getPaintedFeatures().addFeature(k.getFeatureID(),k.getGeometry());var m=this.getAppropriatePainter(k);null!=m&&(m.paint(g,k,d.getLeft(),d.getBottom()),f=!0,h&&(m=this.layer.labelOf(k),k=k.getGeometry().getBounds().getCentroid(),k.setCoordinateSystem(this.layer.getCoordinateSystem()),k=
k.transformTo(this.map.getCoordinateSystem()),k=this.map.worldToView(k.x,k.y),m=new McxLabel(k.x,k.y,m,0),a.push(m)))}}this.totalRequestCount--;0==this.totalRequestCount&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,b));f&&(b=c.getIndexX().toString()+" "+c.getIndexY().toString(),this.paintedCells.push(b));this.labelCanvas.drawLabels(c.getDisplay(),c.getWorld(),this.layer,a)}}else this.totalRequestCount--,0==this.totalRequestCount&&(b=new McxRendererEventArgs(McxRendererStatus.End),
this.rendererEventHandler.dispatchOnSuccess(this,b))}}};McxMemCanvas.prototype.canAddLayer=function(a){return!1};McxMemCanvas.prototype.addLayer=function(a){};McxMemCanvas.prototype.getLayers=function(){return[this.layer]};
McxMemCanvas.prototype.drawModeOnSearchSuccess=function(a){var b=a.getFeatureReader(),c=a.getArgs()[2];a=a.getArgs()[3];var c=c.getWorld(),d=a.getMap().getWorld(),e=d,e=this.layer.getCoordinateSystem(),e=null==d.getCoordinateSystem()||d.getCoordinateSystem().equals(e)?d:d.transformTo(e);if(e.intersectsBounds(c))for(;b.read();)(c=b.getCurrent())&&c.getGeometry()&&(a.getPaintedFeatures().addFeature(c.getFeatureID(),c.getGeometry()),d=this.getAppropriatePainter(c),null!=d&&d.paint(this.drawContextToAnotherTarget,
c,0,0));this.totalRequestCount--;0==this.totalRequestCount&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,b))};
McxMemCanvas.prototype.paintLayer=function(a,b){this.animateFadeEffect();var c=function(a){this.totalRequestCount--;0==this.totalRequestCount&&(a=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,a))};if(null!=this.drawContextToAnotherTarget||this.map.inVisibleRange(this.layer.getMinScale(),this.layer.getMaxScale()))if(this.abortRender(),this.requestsCanceled=!1,this.isDirty&&(this.clearCanvas(),this.isDirty=!1),this.layer.getVisible()){var d=this.layer.getKeyField()+
","+this.layer.getGeometryField(),e=this.map.getPixelScale(),f,g=f=this.map.getWorld();null==this.map.getCoordinateSystem()||g.getCoordinateSystem().equals(this.layer.getCoordinateSystem())||(f=g.transformTo(this.layer.getCoordinateSystem()));if(this.layer.isSingleTile())this.totalRequestCount=1,g=new McxCell(0,0,f,this.map.getDisplay()),f=[],f.push(this.map.getWorld()),f.push(this.map.getDisplay()),f.push(g),f.push(this),f.push(e),e=new McxAjaxParameter,e.setParameters(this,this.onSearchSuccess,
c),e.setArgs(f),this.totalRequestCount=1,f=this.layer.searchByEnvelope(d,"",g.getWorld(),"Intersects",e),this.requests.push(f);else for(this.totalRequestCount=a.length,g=0;g<a.length;g++){f=null;var h=this.transformCellToTarget(a[g],this.layer.getCoordinateSystem());f=a[g].getIndexX().toString()+" "+a[g].getIndexY().toString();if(!(!this.layer.isSingleTile()&&-1<this.paintedCells.indexOf(f)&&b)){this.paintedCells.push(f);f=[];f.push(this.map.getWorld());f.push(this.map.getDisplay());f.push(h);f.push(this);
f.push(e);var k=new McxAjaxParameter;k.setParameters(this,this.onSearchSuccess,c);k.setArgs(f);f=this.layer.searchByEnvelope(d,"",h.getWorld(),"Intersects",k);this.requests.push(f)}}}else this.clearCanvas(),this.clearBackBuffer();else this.clearCanvas(),c=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,c)};McxMemCanvas.prototype.draw=function(a,b){this.drawContextToAnotherTarget=a;this.paintLayer(b)};
McxMemCanvas.prototype.drawLabels=function(a,b){var c,d=c=this.map.getWorld();null==this.map.getCoordinateSystem()||d.getCoordinateSystem().equals(this.layer.getCoordinateSystem())||(c=d.transformTo(this.layer.getCoordinateSystem()));this.totalLabelRequestCount=b.length;for(d=0;d<b.length;d++){var e=this.transformCellToTarget(b[d],this.layer.getCoordinateSystem());this.drawLabelsOfCellOnContext(a,e.getWorld(),c,this.map.getDisplay(),e.getDisplay())}};
McxMemCanvas.prototype.onLabelSearchSuccess=function(a){var b=a.getArgs()[0],c=a.getArgs()[1];a=a.getLabelReader();for(var d=[];a.read();){var e=a.getCurrent();d.push(e)}0>=d.length||this.labelCanvas.drawLabels(b,c,this.base.layer,d)};
McxMemCanvas.prototype.onLabelSearchSuccessOnContext=function(a){a.getArgs();a.getArgs();var b=a.getArgs()[2],c=a.getLabelReader();for(a=[];c.read();){var d=c.getCurrent();a.push(d)}if(!(0>=a.length)){c=this.map.getPixelScale();null!=this.map.getCoordinateSystem()&&(c*=this.map.getCoordinateSystem().getDistancePerUnit());c=this.layer.isScaledLabels()?1/c:1;b.getGeodeticGraphics().useTransform(!1);for(d=0;d<a.length;d++){var e=new McxPoint(a[d].getX(),a[d].getY(),null),f=a[d].getAngle();f&&0!=f&&this.layer.getLabelSymbolizer().setRotation(f);
b.getGeodeticGraphics().drawText(a[d].getValue(),e,this.layer.getLabelSymbolizer(),c,0,0)}b.getGeodeticGraphics().useTransform(!0)}this.totalLabelRequestCount--;0==this.totalLabelRequestCount&&this.labelRendererEventHandler.dispatchOnSuccess(this,null)};
McxMemCanvas.prototype.onMemLabelSearchSuccessOnContext=function(a){a.getArgs();a.getArgs();var b=a.getArgs()[2],c=a.getFeatureReader();for(a=[];c.read();){var d=c.getCurrent(),e=this.layer.labelOf(d),d=d.getGeometry().getBounds().getCentroid();d.setCoordinateSystem(this.layer.getCoordinateSystem());d=d.transformTo(this.map.getCoordinateSystem());d=this.map.worldToView(d.x,d.y);e=new McxLabel(d.x,d.y,e,0);a.push(e)}if(!(0>=a.length)){c=this.map.getPixelScale();null!=this.map.getCoordinateSystem()&&
(c*=this.map.getCoordinateSystem().getDistancePerUnit());c=this.layer.isScaledLabels()?1/c:1;b.getGeodeticGraphics().useTransform(!1);for(e=0;e<a.length;e++){var d=new McxPoint(a[e].getX(),a[e].getY(),null),f=a[e].getAngle();f&&0!=f&&this.layer.getLabelSymbolizer().setRotation(f);b.getGeodeticGraphics().drawText(a[e].getValue(),d,this.layer.getLabelSymbolizer(),c,0,0)}b.getGeodeticGraphics().useTransform(!0)}this.totalLabelRequestCount--;0==this.totalLabelRequestCount&&this.labelRendererEventHandler.dispatchOnSuccess(this,
null)};McxMemCanvas.prototype.drawLabelsOfCell=function(a,b,c,d){if(this.layer.isShowLabels()&&this.map.inVisibleRange(this.layer.getMinLabelScale(),this.layer.getMaxLabelScale())){d=new McxAjaxParameter;d.setParameters(this,this.onLabelSearchSuccess,null);d.setArgs([c,b]);var e=this.layer.getFilterCollection().toString();a=this.layer.fastSearch("",e,this.layer.getLabelFormat(),a,b,c,d);this.requests.push(a)}};
McxMemCanvas.prototype.drawLabelsOfCellOnContext=function(a,b,c,d,e){if(this.layer.isShowLabels())if(null==this.drawContextToAnotherTarget||this.map.inVisibleRange(this.base.layer.getMinLabelScale(),this.base.layer.getMaxLabelScale())){var f=new McxAjaxParameter;f.setParameters(this,this.onLabelSearchSuccessOnContext,null);f.setArgs([e,c,a]);a=this.layer.getFilterCollection().toString();this.layer.isInstanceOf("McxMemLayer")?(f.setParameters(this,this.onMemLabelSearchSuccessOnContext,null),b=this.layer.searchByEnvelope(a,
"",b,"Intersects",f)):b=this.layer.fastSearch(a,"",this.layer.getLabelFormat(),b,c,d,f);this.requests.push(b)}else this.totalLabelRequestCount--,0==this.totalLabelRequestCount&&this.labelRendererEventHandler.dispatchOnSuccess(this,null);else this.totalLabelRequestCount--,0==this.totalLabelRequestCount&&this.labelRendererEventHandler.dispatchOnSuccess(this,null)};
McxMemCanvas.prototype.paintLabels=function(a){var b=this.map.getWorld();null==this.map.getCoordinateSystem()||b.getCoordinateSystem().equals(this.layer.getCoordinateSystem())||b.transformTo(this.layer.getCoordinateSystem());this.paintLayer(a)};McxMemCanvas.prototype.transformCellToTarget=function(a,b){if(null==this.map.getCoordinateSystem()||null==b||this.map.getCoordinateSystem().equals(b))return a;var c=a.getWorld().transformTo(b);return new McxCell(a.getIndexX(),a.getIndexY(),c,a.getDisplay())};
McxMemCanvas.prototype.abortRender=function(){this.requestsCanceled=!0;for(var a=0;a<this.requests.length;a++)this.requests[a].abort(),a==this.requests.length-1&&(this.requests=[]);this.requests=[]};McxMemCanvas.prototype.onDisplayChanged=function(){this.isDirty=!0;this.width=this.map.getDisplay().getWidth();this.height=this.map.getDisplay().getHeight()};McxMemCanvas.prototype.setDisplay=function(a,b){this.isDirty=!0;this.width=a;this.height=b};McxMemCanvas.prototype.getPaintedFeatures=function(){return this.paintedFeatures};
McxMemCanvas.prototype.clearCache=function(){this.paintedFeatures.clear();this.paintedCells=[]};McxMemCanvas.prototype.getMap=function(){return this.map};
McxMemCanvas.prototype.getAppropriatePainter=function(a){var b=null,c=a.getSymbolizer();if(null==c)var d=a.getLayer().getSymbolizer();var e=a.getGeometry();if(!e)return null;e.isInstanceOf(McxGeometryType.Point)?(b=new McxPointPainter,null==c?b.setSymbolizer(d.getPointSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.LineString)?(b=new McxLineStringPainter,null==c?b.setSymbolizer(d.getLineSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.Polygon)?(b=new McxPolygonPainter,
null==c?b.setSymbolizer(d.getPolygonSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiPoint)?(b=new McxMultiPointPainter,null==c?b.setSymbolizer(d.getPointSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiLineString)?(b=new McxMultiLinePainter,null==c?b.setSymbolizer(d.getLineSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiPolygon)&&(b=new McxMultiPolygonPainter,null==c?b.setSymbolizer(d.getPolygonSymbolizer()):b.setSymbolizer(c));if(null!=
b){c=null;d=a.getLayer().getSubtypes();for(e=0;e<d.length;e++){var f=d[e];if(!f.isVisible())return null;f.run(a)&&(c=f.getSymbolizer())}d=a.getSymbolizer();if(b.isInstanceOf("McxPointPainter")||b.isInstanceOf("McxMultiPointPainter"))null!=d&&d.isInstanceOf("IMcxPointSymbolizer")&&this.layer.getPainterMode()==McxPainterMode.ByFeature?b.setSymbolizer(d):null!=d&&d.isInstanceOf("IMcxTextSymbolizer")&&this.layer.getPainterMode()==McxPainterMode.ByFeature?b.setSymbolizer(d):null!=c&&null!=c.getPointSymbolizer()?
b.setSymbolizer(c.getPointSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getPointSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getPointSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultPointSymbolizer());else if(b.isInstanceOf("McxLineStringPainter")||b.isInstanceOf("McxMultiLinePainter"))null!=d&&d.isInstanceOf("IMcxLineSymbolizer")&&this.layer.getPainterMode()==McxPainterMode.ByFeature?b.setSymbolizer(a.getSymbolizer()):null!=
c&&null!=c.getLineSymbolizer()?b.setSymbolizer(c.getLineSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getLineSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getLineSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultLineSymbolizer());else if(b.isInstanceOf("McxPolygonPainter")||b.isInstanceOf("McxMultiPolygonPainter"))null!=d&&d.isInstanceOf("IMcxPolygonSymbolizer")&&this.layer.getPainterMode()==McxPainterMode.ByFeature?b.setSymbolizer(d):
null!=c&&null!=c.getPolygonSymbolizer()?b.setSymbolizer(c.getPolygonSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getPolygonSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getPolygonSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultPolygonSymbolizer())}return b};
McxMemCanvas.prototype.paintSelection=function(a){if(this.layer.isInstanceOf("IMcxSelectableLayer")&&this.layer.getVisible()&&this.map.inVisibleRange(this.layer.getMinScale(),this.layer.getMaxScale())&&0!=this.layer.getSelectionCount())for(var b=this.layer.getSelection();b.read();){var c=b.getCurrent(),d=this.getAppropriatePainter(c);(c.getGeometry().isInstanceOf(McxGeometryType.Polygon)||c.getGeometry().isInstanceOf(McxGeometryType.MultiPolygon))&&d.setSymbolizer(this.selectionSymbolizer.getPolygonSymbolizer());
(c.getGeometry().isInstanceOf(McxGeometryType.LineString)||c.getGeometry().isInstanceOf(McxGeometryType.MultiLineString))&&d.setSymbolizer(this.selectionSymbolizer.getLineSymbolizer());(c.getGeometry().isInstanceOf(McxGeometryType.Point)||c.getGeometry().isInstanceOf(McxGeometryType.MultiPoint))&&d.setSymbolizer(this.selectionSymbolizer.getPointSymbolizer());null!=d&&d.paint(a,c,0,0)}};McxMemCanvas.prototype.setLabelCanvas=function(a){this.labelCanvas=a};
McxMemCanvas.prototype.isInstanceOf=function(a){return"McxMemCanvas"==a};McxMemCanvas.prototype.clearCanvas=function(){$("#"+this.layerId+"_divContainer").empty();this.contentDiv.empty()};
McxMemCanvas.prototype.zoomTo=function(a,b,c){var d=$("#"+this.layerId+"_zoom");d.css("-webkit-transform-origin",a+"px "+b+"px").css("-moz-transform-origin",a+"px "+b+"px").css("-ms-transform-origin",a+"px "+b+"px").css("-o-transform-origin",a+"px "+b+"px").css("transform-origin",a+"px "+b+"px");d[0].style.transition="all 200ms cubic-bezier(0,1.12,.3,.11) 0";d.css("-webkit-transform","scale("+c+")").css("-moz-transform","scale("+c+")").css("-ms-transform","scale("+c+")").css("-o-transform","scale("+
c+")").css("transform","scale("+c+")");d[0].style.transition=""};McxMemCanvas.prototype.dispose=function(){$("#"+this.layerId).remove()};McxMemCanvas.prototype.remove=function(a){$("#"+this.layerId).remove()};McxMemCanvas.prototype.translate=function(a,b){0!=this.map.getPixelScale()&&(this.translateX+=-1*a/this.map.getPixelScale(),this.translateY+=b/this.map.getPixelScale())};McxMemCanvas.prototype.resetTranslation=function(){this.translateY=this.translateX=0};
McxMemCanvas.prototype.clearBackBuffer=function(){$("#"+this.layerId+"_zoom").empty();$("#"+this.layerId+"_backBuffer").empty();console.log(this.layerId+" clear backbuffer")};McxMemCanvas.prototype.paintBackBuffer=function(){$("#"+this.layerId+"_divContainer").children("*").appendTo("#"+this.layerId+"_zoom")};McxMemCanvas.prototype.setZoomAnimationClass=function(a){var b=$("#"+this.layerId+"_zoom");b.removeClass();b.addClass(a)};
McxMemCanvas.prototype.resetZoomAnimationClass=function(){if(this.base.layer.getPainterMode()!=McxPainterMode.ByImage){var a=$("#"+this.layerId+"_zoom");setTimeout(function(){a.empty();a.css("-webkit-transform","scale(1)").css("-moz-transform","scale(1)").css("-ms-transform","scale(1)").css("-o-transform","scale(1)").css("transform","scale(1)")},1E3)}};
McxMemCanvas.prototype.setOrder=function(a){$("#"+this.layerId).css("zIndex",a);$("#"+this.layerId+"_divContainer").css("zIndex",a);$("#"+this.layerId+"_zoom").css("zIndex",a+1)};McxMemCanvas.prototype.setOpacity=function(a){this.layer.setOpacity(a);$("#"+this.layerId).css("opacity",a)};McxMemCanvas.prototype.getRendererEventHandler=function(){return this.rendererEventHandler};McxMemCanvas.prototype.getLabelRendererEventHandler=function(){return this.labelRendererEventHandler};
McxMemCanvas.prototype.backBufferEnabled=function(a){this.backBuffered=a};McxMemCanvas.prototype.animateFadeEffect=function(){$("#"+this.layerId+"_zoom").children("*").fadeTo(500,0)};js.framework.mapping.McxCanvas.McxFsCanvas={};function McxFsCanvas(a,b){mcx.base(this,a,b);this.additiveFields="";this.requests=[];this.base=this;this.lastPaintMode=this.base.layer.getPainterMode();this.backBuffered=!1}mcx.inherits(McxFsCanvas,McxMemCanvas);
McxFsCanvas.prototype.paintLayer=function(a,b){var c=this.base.layer.getPainterMode();this.base.lastPaintMode=c;if(c==McxPainterMode.ByImage)this.paintLayerImage(a),this.paintLabels(a);else if(this.animateFadeEffect(),this.base.totalRequestCount=a.length,c=function(a){this.base.totalRequestCount--;0==this.base.totalRequestCount&&(a=new McxRendererEventArgs(McxRendererStatus.End),this.base.rendererEventHandler.dispatchOnSuccess(this,a))},null!=this.base.drawContextToAnotherTarget||this.base.map.inVisibleRange(this.base.layer.getMinScale(),
this.base.layer.getMaxScale()))if(this.abortRender(),this.requestsCanceled=!1,this.base.isDirty&&(this.clearCanvas(),this.base.isDirty=!1),this.base.layer.getVisible()){var d=this.getAdditiveFieldsString(),e=this.base.map.getPixelScale(),f,g=f=this.base.map.getWorld();null==this.base.map.getCoordinateSystem()||g.getCoordinateSystem().equals(this.base.layer.getCoordinateSystem())||(f=g.transformTo(this.base.layer.getCoordinateSystem()));g=this.base.layer;this.base.layer.isSingleTile()&&(a=[new McxCell(0,
0,f,this.base.map.getDisplay())]);this.base.totalRequestCount=a.length;for(var h=0;h<a.length;h++){var k=this.transformCellToTarget(a[h],this.base.layer.getCoordinateSystem()),m=k.getIndexX().toString()+" "+k.getIndexY().toString();if(!(!this.base.layer.isSingleTile()&&-1<this.base.paintedCells.indexOf(m)&&b)){var n=[];n.push(f);n.push(this.base.map.getDisplay());n.push(k);n.push(this);n.push(e);m=new McxAjaxParameter;m.setParameters(this,this.onSearchSuccess,c);m.setArgs(n);n=this.base.layer.getFilterCollection();
k=g.fastSearch(d,n?n.toString():"",null,k.getWorld(),null,null,m);this.requests.push(k)}}}else this.clearCanvas(),this.clearBackBuffer(),this.base.totalRequestCount=0,c=new McxRendererEventArgs(McxRendererStatus.End),this.base.rendererEventHandler.dispatchOnSuccess(this,c);else this.clearCanvas(),this.base.totalRequestCount=0,0==this.base.totalRequestCount&&(c=new McxRendererEventArgs(McxRendererStatus.End),this.base.rendererEventHandler.dispatchOnSuccess(this,c))};
McxFsCanvas.prototype.paintLayerImage=function(a){this.backBuffered||$("#"+this.base.layerId+"_zoom").children("*").fadeTo(2E3,0);var b=function(){this.base.totalRequestCount--;if(0==this.base.totalRequestCount){var a=new McxRendererEventArgs(McxRendererStatus.End);this.base.rendererEventHandler.dispatchOnSuccess(this,a)}};if(this.base.map.inVisibleRange(this.base.layer.getMinScale(),this.base.layer.getMaxScale()))if(this.requestsCanceled=!1,this.base.isDirty&&(this.clearCanvas(),this.base.isDirty=
!1),this.base.layer.getVisible()){var c=this.base.layer.getKeyField()+","+this.base.layer.getGeometryField(),d=this.base.map.getPixelScale(),e,f=e=this.base.map.getWorld();null==this.base.map.getCoordinateSystem()||f.getCoordinateSystem().equals(this.base.layer.getCoordinateSystem())||(e=f.transformTo(this.base.layer.getCoordinateSystem()));var f=this.base.map.getTileSize().getWidth(),g=this.base.map.getTileSize().getHeight();a=this.base.map.getWorld().transformTo(this.base.layer.getCoordinateSystem());
var h=this.base.map.getDisplay();a=new McxLayerGrid(a,h,this.base.map.getTileSize(),null);a.calculate();a=a.getCells();this.base.layer.isSingleTile()&&(a=[new McxCell(0,0,e,this.base.map.getDisplay())],f=this.base.map.getDisplay().getWidth(),g=this.base.map.getDisplay().getHeight());this.base.totalRequestCount=a.length;e=this.base.layer;for(h=0;h<a.length;h++){var k=null,k=this.transformCellToTarget(a[h],this.base.layer.getCoordinateSystem()),m=[];m.push(this.base.map.getWorld());m.push(this.base.map.getDisplay());
m.push(k);m.push(this);m.push(d);m.push(this.base.map);m.push(f);m.push(g);var n=new McxAjaxParameter;n.setParameters(this,this.onSearchImageSuccess,b);n.setArgs(m);k=e.getMap(this.base.layer.getName(),k.getWorld(),k.getDisplay().getWidth(),k.getDisplay().getHeight(),c,n);this.requests.push(k)}}else this.clearCanvas(),this.clearBackBuffer();else this.clearCanvas()};
McxFsCanvas.prototype.getAdditiveFieldsString=function(){var a=this.base.layer.getGeometryField(),b=this.base.layer.getKeyField();b&&null!=b&&(a=b+","+a);if(0<this.base.layer.getSubtypes().getCount())for(var b=this.base.layer.getSubtypes().getFields(),c=0;c<b.length;c++)b[c]!=this.base.layer.getGeometryField()&&b[c]!=this.base.layer.getKeyField()&&(a+=","+b[c]);this.base.layer.getPainterMode()==McxPainterMode.ByFeature&&this.base.layer.getSymbolizerField()&&""!=this.base.layer.getSymbolizerField()&&
(a+=","+this.base.layer.getSymbolizerField());this.additiveFields&&""!=this.additiveFields&&(a+=","+this.additiveFields);return a};
McxFsCanvas.prototype.onSearchImageSuccess=function(a){var b=a.getFeatureReader();a.getArgs()[2].getDisplay();var c=a.getArgs()[3],d=c.getMap().getPixelScale();a=a.getArgs()[4];if(0!=Math.abs(d-a))this.base.totalRequestCount--,0==this.base.totalRequestCount&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.base.rendererEventHandler.dispatchOnSuccess(this,b));else{d={count:b.getFeatureCount()};if(0==b.getFeatureCount()&&(this.base.totalRequestCount--,0==this.base.totalRequestCount)){b=new McxRendererEventArgs(McxRendererStatus.End);
this.base.rendererEventHandler.dispatchOnSuccess(self,b);return}for(;b.read();){if(c.requestsCanceled){this.base.totalRequestCount=0;b=new McxRendererEventArgs(McxRendererStatus.Canceled);this.base.rendererEventHandler.dispatchOnSuccess(this,b);return}(a=b.getCurrent())&&a.getGeometry()&&this.paintFeature(a,d)}null==this.base.drawContextToAnotherTarget&&(this.base.totalRequestCount--,0==this.base.totalRequestCount&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.base.rendererEventHandler.dispatchOnSuccess(this,
b)))}};
McxFsCanvas.prototype.paintFeature=function(a,b){var c=this.base.map.getContent().find("#"+this.base.layerId+"_divContainer").eq(0).find("[src='"+a.getQueryString()+"']");if(0<c.length){a.image=null;var d=a.getGeometry().getBounds(),e=c[0],c="width:"+(d.getWidth()+1).toString()+"px; height:"+(d.getHeight()+1).toString()+"px; position: absolute; left:"+(d.getLeft()-this.base.translateX).toString()+"px;top:"+(d.getBottom()-this.base.translateY).toString()+"px; ";e.setAttribute("style",c)}else{var f=this;
""!=this.base.crossOrigin&&(a.getImage().crossOrigin=this.crossOrigin);d=a.getGeometry().getBounds();e=a.getImage();e.setAttribute("draggable","false");e.setAttribute("ondragstart","return false;");c="width:"+(d.getWidth()+1).toString()+"px; height:"+(d.getHeight()+1).toString()+"px; position: absolute; left:"+(d.getLeft()-this.base.translateX).toString()+"px;top:"+(d.getBottom()-this.base.translateY).toString()+"px; ";null==this.base.drawContextToAnotherTarget&&e.setAttribute("style",c);a.getImage().onload=
function(){if(null!=f.drawContextToAnotherTarget){if(f.drawContextToAnotherTarget.getGeodeticGraphics().drawImage(a.getImage(),d.getLeft(),d.getBottom(),d.getWidth()+1,d.getHeight()+1),b.count--,0==b.count&&(f.totalRequestCount--,0==f.totalRequestCount)){var c=new McxRendererEventArgs(McxRendererStatus.End);f.rendererEventHandler.dispatchOnSuccess(f,c)}}else 0<f.map.getContent().find("#"+f.layerId+"_divContainer").eq(0).find("[src='"+a.getQueryString()+"']").length||f.map.getContent().find("#"+f.layerId+
"_divContainer").eq(0).append(e)};a.getImage().onerror=function(){if(null!=f.drawContextToAnotherTarget&&(b.count--,0==b.count&&(f.totalRequestCount--,0==f.totalRequestCount))){var a=new McxRendererEventArgs(McxRendererStatus.End);f.rendererEventHandler.dispatchOnSuccess(f,a)}};a.getImage().src=a.getQueryString()}};
McxFsCanvas.prototype.onSearchSuccess=function(a){if(null!=this.base.drawContextToAnotherTarget)this.base.drawModeOnSearchSuccess(a);else{var b=a.getFeatureReader(),c=a.getArgs()[2],d=c.getDisplay(),e=a.getArgs()[3],f=e.getMap().getPixelScale(),g=a.getArgs()[4];if(0!=Math.abs(f-g))this.base.totalRequestCount--,0==this.base.totalRequestCount&&this.base.rendererEventHandler.dispatchOnSuccess(this,null);else{var f=c.getWorld(),h=g=e.getMap().getWorld(),h=this.base.layer.getCoordinateSystem(),h=null==
g.getCoordinateSystem()||g.getCoordinateSystem().equals(h)?g:g.transformTo(h);if(h.intersectsBounds(f)){g=this.canvasId+"-"+c.getIndexX()+"-"+c.getIndexY();(f=this.base.map.getContent().find("#"+g).eq(0))&&null!=f&&$(f).remove();f=document.createElement("canvas");f.id=g;f.style.position="absolute";f.setAttribute("height",Math.floor(d.getHeight()).toString()+"px");f.setAttribute("width",Math.floor(d.getWidth()).toString()+"px");f.globalCompositeOperation="source-over";var g=this.base.map.getContent().find("#"+
this.base.layerId+"_divContainer").eq(0),h=(d.getLeft()-this.translateX).toString(),k=(d.getBottom()-this.translateY).toString();$(f).css("-webkit-transform","translate3d("+h+"px, "+k+"px,0px)").css("-moz-transform","translate3d("+h+"px, "+k+"px,0px)").css("-ms-transform","translate3d("+h+"px, "+k+"px,0px)").css("-o-transform","translate3d("+h+"px, "+k+"px,0px)").css("transform","translate3d("+h+"px, "+k+"px,0px)");f.style.display="none";$(f).fadeIn(250);g.append(f);for(f=new McxDrawContext(this.base.map,
f.getContext("2d"));b.read();){if(e.requestsCanceled){this.base.totalRequestCount=0;return}(g=b.getCurrent())&&g.getGeometry()&&((h=this.base.layer.getKeyField())&&null!=h&&e.getPaintedFeatures().addFeature(g.getFeatureID(),g.getGeometry()),h=this.getAppropriatePainter(g),null!=h&&h.paint(f,g,d.getLeft(),d.getBottom()))}this.base.totalRequestCount--;0==this.base.totalRequestCount&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.base.rendererEventHandler.dispatchOnSuccess(this,b));b=c.getIndexX().toString()+
" "+c.getIndexY().toString();this.base.paintedCells.push(b);this.base.drawLabelsOfCell(c.getWorld(),a.getArgs()[0],a.getArgs()[1],c.getDisplay())}else this.base.totalRequestCount--,0==this.base.totalRequestCount&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.base.rendererEventHandler.dispatchOnSuccess(this,b))}}};
McxFsCanvas.prototype.paintLabels=function(a){var b,c=b=this.base.map.getWorld();null==this.base.map.getCoordinateSystem()||c.getCoordinateSystem().equals(this.base.layer.getCoordinateSystem())||(b=c.transformTo(this.base.layer.getCoordinateSystem()));for(c=0;c<a.length;c++){var d=this.transformCellToTarget(a[c],this.base.layer.getCoordinateSystem());this.base.drawLabelsOfCell(d.getWorld(),b,this.base.map.getDisplay(),d.getDisplay())}};
McxFsCanvas.prototype.abortRender=function(){this.requestsCanceled=!0;for(var a=0;a<this.requests.length;a++)this.requests[a].abort(),a==this.requests.length-1&&(this.requests=[]);this.requests=[]};
McxFsCanvas.prototype.getAppropriatePainter=function(a){var b=null,c=a.getSymbolizer();if(null==c)var d=a.getLayer().getSymbolizer();var e=a.getGeometry();if(!e)return null;e.isInstanceOf(McxGeometryType.Point)?(b=new McxPointPainter,null==c?b.setSymbolizer(d.getPointSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.LineString)?(b=new McxLineStringPainter,null==c?b.setSymbolizer(d.getLineSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.Polygon)?(b=new McxPolygonPainter,
null==c?b.setSymbolizer(d.getPolygonSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiPoint)?(b=new McxMultiPointPainter,null==c?b.setSymbolizer(d.getPointSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiLineString)?(b=new McxMultiLinePainter,null==c?b.setSymbolizer(d.getLineSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiPolygon)&&(b=new McxMultiPolygonPainter,null==c?b.setSymbolizer(d.getPolygonSymbolizer()):b.setSymbolizer(c));if(null!=
b){c=null;d=a.getLayer().getSubtypes();if(0<d.getCount())for(e=0;e<d.getCount();e++){var f=d.getAt(e);if(this.base._map.inVisibleRange(f.getMinScale(),f.getMaxScale())&&f.getScript().run(a)){c=f.getSymbolizer();break}}d=a.getSymbolizer();if(b.isInstanceOf("McxPointPainter")||b.isInstanceOf("McxMultiPointPainter"))null!=d&&d.isInstanceOf("IMcxPointSymbolizer")&&this.base.layer.getPainterMode()==McxPainterMode.ByFeature?b.setSymbolizer(d):null!=d&&d.isInstanceOf("IMcxTextSymbolizer")&&this.base.layer.getPainterMode()==
McxPainterMode.ByFeature?b.setSymbolizer(d):null!=c&&null!=c.getPointSymbolizer()?b.setSymbolizer(c.getPointSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getPointSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getPointSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultPointSymbolizer());else if(b.isInstanceOf("McxLineStringPainter")||b.isInstanceOf("McxMultiLinePainter"))null!=d&&d.isInstanceOf("IMcxLineSymbolizer")&&this.base.layer.getPainterMode()==
McxPainterMode.ByFeature?b.setSymbolizer(a.getSymbolizer()):null!=c&&null!=c.getLineSymbolizer()?b.setSymbolizer(c.getLineSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getLineSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getLineSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultLineSymbolizer());else if(b.isInstanceOf("McxPolygonPainter")||b.isInstanceOf("McxMultiPolygonPainter"))null!=d&&d.isInstanceOf("IMcxPolygonSymbolizer")&&
this.base.layer.getPainterMode()==McxPainterMode.ByFeature?b.setSymbolizer(d):null!=c&&null!=c.getPolygonSymbolizer()?b.setSymbolizer(c.getPolygonSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getPolygonSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getPolygonSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultPolygonSymbolizer())}return b};
McxFsCanvas.prototype.paintSelection=function(a){if(this.base.layer.isInstanceOf("IMcxSelectableLayer")&&this.base.layer.getVisible()&&this.base.map.inVisibleRange(this.base.layer.getMinScale(),this.base.layer.getMaxScale())&&0!=this.base.layer.getSelectionCount())for(var b=this.base.layer.getSelection();b.read();){var c=b.getCurrent();if(c.getGeometry()&&null!=c.getGeometry()){var d=this.getAppropriatePainter(c);(c.getGeometry().isInstanceOf(McxGeometryType.Polygon)||c.getGeometry().isInstanceOf(McxGeometryType.MultiPolygon))&&
d.setSymbolizer(this.base.selectionSymbolizer.getPolygonSymbolizer());(c.getGeometry().isInstanceOf(McxGeometryType.LineString)||c.getGeometry().isInstanceOf(McxGeometryType.MultiLineString))&&d.setSymbolizer(this.base.selectionSymbolizer.getLineSymbolizer());(c.getGeometry().isInstanceOf(McxGeometryType.Point)||c.getGeometry().isInstanceOf(McxGeometryType.MultiPoint))&&d.setSymbolizer(this.base.selectionSymbolizer.getPointSymbolizer());null!=d&&d.paint(a,c,0,0)}}};
McxFsCanvas.prototype.clearCanvas=function(){$("#"+this.base.layerId+"_divContainer").empty();this.base.contentDiv.empty()};McxFsCanvas.prototype.isInstanceOf=function(a){return"McxFsCanvas"==a};McxFsCanvas.prototype.canAddLayer=function(a){return!1};McxFsCanvas.prototype.addLayer=function(a){};McxFsCanvas.prototype.setAdditiveFields=function(a){if(""==a)this.additiveFields="";else{a instanceof Array||(a=[a]);for(var b=0;b<a.length;b++)0!=b&&(this.additiveFields+=","),this.additiveFields+=a[b]}};js.framework.mapping.McxCanvas.McxClusterMapCanvas={};function McxClusterMapCanvas(a,b){mcx.base(this,a,b);this.base=this;this._layer=a;a.setPainterMode(McxPainterMode.ByFeature);this._map=b;this._radius=100;this._clusters=[];this._timerId=0;this.singleTile=!1}mcx.inherits(McxClusterMapCanvas,McxFsCanvas);
McxClusterMapCanvas.prototype.onSearchSuccess=function(a){this._clusters=[];if(null!=this.base.drawContextToAnotherTarget)this.base.drawModeOnSearchSuccess(a);else{var b=a.getFeatureReader(),c=a.getArgs()[2],d=c.getDisplay(),e=a.getArgs()[3],f=e.getMap().getPixelScale(),g=a.getArgs()[4];if(0!=Math.abs(f-g))this.base.totalRequestCount--,0==this.base.totalRequestCount&&this.base.rendererEventHandler.dispatchOnSuccess(this,null);else{var f=c.getWorld(),h=g=e.getMap().getWorld(),h=e.getLayers()[0].getCoordinateSystem(),
h=null==g.getCoordinateSystem()||g.getCoordinateSystem().equals(h)?g:g.transformTo(h);if(h.intersectsBounds(f)){g=this.canvasId+"-"+c.getIndexX()+"-"+c.getIndexY();(f=this.base.map.getContent().find("#"+g).eq(0))&&null!=f&&$(f).remove();f=document.createElement("canvas");f.id=g;f.style.position="absolute";f.setAttribute("height",(Math.floor(d.getHeight())+2).toString()+"px");f.setAttribute("width",(Math.floor(d.getWidth())+2).toString()+"px");f.globalCompositeOperation="source-over";var g=this.base.map.getContent().find("#"+
this.base.layerId+"_divContainer").eq(0),h=(d.getLeft()-this.translateX).toString(),k=(d.getBottom()-this.translateY).toString();$(f).css("-webkit-transform","translate3d("+h+"px, "+k+"px,0px)").css("-moz-transform","translate3d("+h+"px, "+k+"px,0px)").css("-ms-transform","translate3d("+h+"px, "+k+"px,0px)").css("-o-transform","translate3d("+h+"px, "+k+"px,0px)").css("transform","translate3d("+h+"px, "+k+"px,0px)");g.append(f);f=new McxDrawContext(this.base.map,f.getContext("2d"));for(f.getGeodeticGraphics().setContentDiv(this.base.contentDiv);b.read();){if(e.requestsCanceled){this.base.totalRequestCount=
0;return}if((g=b.getCurrent())&&g.getGeometry()){for(var h=g.getGeometry(),k=g.getFeatureID(),m=!1,g=0;g<this._clusters.length;g++)if(this._clusters[g].isContains(h)){this._clusters[g].add(k);m=!0;break}m||(h=new McxCluster(k,h,this._radius,this._map),this._clusters.push(h))}}for(g=0;g<this._clusters.length;g++)h=this._clusters[g],b=new McxMemFeature(this._layer,null),b.setFeatureID(h.getFeatureID()),b.setGeometry(h.getGeometry()),(k=this._layer.getKeyField())&&null!=k&&e.getPaintedFeatures().addFeature(h.getFeatureID(),
h.getGeometry()),h=this.getPainter(h),null!=h&&h.paint(f,b,d.getLeft(),d.getBottom());this.base.totalRequestCount--;0==this.base.totalRequestCount&&(d=new McxRendererEventArgs(McxRendererStatus.End),this.base.rendererEventHandler.dispatchOnSuccess(this,d));d=c.getIndexX().toString()+" "+c.getIndexY().toString();this.base.paintedCells.push(d);this.base.drawLabelsOfCell(c.getWorld(),a.getArgs()[0],a.getArgs()[1],c.getDisplay())}else this.base.totalRequestCount--,0==this.base.totalRequestCount&&(d=new McxRendererEventArgs(McxRendererStatus.End),
this.base.rendererEventHandler.dispatchOnSuccess(this,d))}}};
McxClusterMapCanvas.prototype.getPainter=function(a){var b=new McxPointPainter,c=a.getCount();a=new McxPointSymbolizer;var d=document.createElement("div"),e=$(d);e.click($.proxy(this.clusterClicked,this));1==c?e.addClass("clusterDefault"):10>c?e.addClass("clusterLevel1"):100>c?e.addClass("clusterLevel2"):1E3>c?e.addClass("clusterLevel3"):1E4>c?e.addClass("clusterLevel4"):e.addClass("clusterLevel5");1!=c&&e.text(c+"");c=new McxContentSymbol(d);a.setSymbols([c]);b.setSymbolizer(a);return b};
McxClusterMapCanvas.prototype.clusterClicked=function(){console.log("clusterClicked")};McxClusterMapCanvas.prototype.findPaintedGeometry=function(a){return null};
McxClusterMapCanvas.prototype.getFilter=function(a){var b=McxFactoryFinder.GeometryFactory(this.base.getMap().getCoordinateSystem()).createPoint(a.clientX,a.clientY);a=this.base.getMap().viewToWorld(b.getX()-45,b.getY()-45);var c=this.base.getMap().viewToWorld(b.getX()+45,b.getY()+45),b=Math.min(a.getX(),c.getX()),d=Math.min(a.getY(),c.getY()),e=Math.max(a.getX(),c.getX());a=Math.max(a.getY(),c.getY());a=new McxBounds(b,d,e,a,this.base.getMap().getCoordinateSystem());a=McxFactoryFinder.GeometryFactory(this.base.getMap().getCoordinateSystem()).createPolygon(a,
null);b=new McxSelectFilter;b.setGeometry(a);return b};McxClusterMapCanvas.prototype.isInstanceOf=function(a){return"McxClusterMapCanvas"==a};McxClusterMapCanvas.prototype.setSingleTile=function(a){this.singleTile=a};McxClusterMapCanvas.prototype.getRadius=function(){return this._radius};McxClusterMapCanvas.prototype.setRadius=function(a){this._radius=a};js.framework.mapping.McxCanvas.McxFsCollectionCanvas={};
function McxFsCollectionCanvas(a,b){this._dataSourceString="";this.fsCollectionItems=[];this.drawTarget=null;this.map=b;this.isDirty=!1;this.height=this.width=this.translateY=this.translateX=0;this.rendererEventHandler=new McxEventHandler;this.backBuffered=!1;this._imageLayerId=McxGuid.createGuid();this._imageLayerRequests=[];this.totalRequestCount=this._imageLayerRequestCount=0;this.requestsCanceled=!1;this.crossOrigin=this.additiveFields="";this.selectionSymbolizer=new McxCompositeSymbolizer;this.labelRendererEventHandler=
new McxEventHandler;this.requests=[];this.totalLabelRequestCount=0;this.drawContextToAnotherTarget=this.labelCanvas=null;this.contentDiv=$("<div/>");this.initialize(a)}McxFsCollectionCanvas.prototype.initialize=function(a){a.constructor!=Array&&(a=[a]);for(var b=0;b<a.length;b++){this._dataSourceString=a[b].getDataSource().getSource();var c=McxGuid.createGuid(),d=McxGuid.createGuid(),c=new McxFsLayerCollectionItem(a[b],c,d);this.fsCollectionItems.push(c);this.setUpHtmlElements(c)}};
McxFsCollectionCanvas.prototype.dispose=function(){this.map.getContent().find("#"+this._imageLayerId).remove()};McxFsCollectionCanvas.prototype.setOpacity=function(a,b){b.getPainterMode()==McxPainterMode.ByImage&&this.map.getContent().find("#"+this._imageLayerId).css("opacity",a);for(var c=b.getUniqueId(),d=0;d<this.fsCollectionItems.length;d++)if(c===this.fsCollectionItems[d].getLayer().getUniqueId()){c=this.fsCollectionItems[d].getLayerId();$("#"+c+"_divContainer").css("opacity",a);break}};
McxFsCollectionCanvas.prototype.resetTranslation=function(){this.translateY=this.translateX=0};McxFsCollectionCanvas.prototype.getLabelRendererEventHandler=function(){return this.labelRendererEventHandler};McxFsCollectionCanvas.prototype.getPaintedFeatures=function(a){for(var b=0;b<this.fsCollectionItems.length;b++)if(this.fsCollectionItems[b].getLayer().getClassId()==a.getClassId())return this.fsCollectionItems[b].getPaintedFeatures();return null};
McxFsCollectionCanvas.prototype.drawLabels=function(a,b){for(var c,d=c=this.map.getWorld(),e=0,f=0;f<this.fsCollectionItems.length;f++){var g=this.fsCollectionItems[f].getLayer();g.isShowLabels()&&this.map.inVisibleRange(g.getMinLabelScale(),g.getMaxLabelScale())&&e++}if(0==e)this.labelRendererEventHandler.dispatchOnSuccess(this,null);else for(this.totalLabelRequestCount=b.length*e,f=0;f<this.fsCollectionItems.length;f++)if(g=this.fsCollectionItems[f].getLayer(),g.isShowLabels()&&this.map.inVisibleRange(g.getMinLabelScale(),
g.getMaxLabelScale()))for(null==this.map.getCoordinateSystem()||d.getCoordinateSystem().equals(g.getCoordinateSystem())||(c=d.transformTo(g.getCoordinateSystem())),e=0;e<b.length;e++){var h=this.transformCellToTarget(b[e],g.getCoordinateSystem());this.drawLabelsOfCellOnContext(a,h.getWorld(),c,this.map.getDisplay(),h.getDisplay(),g)}};McxFsCollectionCanvas.prototype.draw=function(a,b){this.drawTarget=a;this.paintLayer(b)};
McxFsCollectionCanvas.prototype.onSearchFail=function(a){this.totalRequestCount--;0==this.totalRequestCount&&(a=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,a))};McxFsCollectionCanvas.prototype.setZoomAnimationClass=function(a){};
McxFsCollectionCanvas.prototype.paintLayer=function(a,b){for(var c=[],d=[],e=0;e<this.fsCollectionItems.length;e++)this.fsCollectionItems[e].getLayer().getPainterMode()==McxPainterMode.ByImage?c.push(this.fsCollectionItems[e]):d.push(this.fsCollectionItems[e]);this.paintByImage(a,c,b);this.paintByLayer(a,d,b)};
McxFsCollectionCanvas.prototype.paintByLayer=function(a,b,c){for(var d=0;d<b.length;d++){var e=b[d].getLayer(),f=b[d].getLayerId(),g=b[d].getPaintedCells(),h=b[d].getRequests();this.animateFadeEffect(f);b[d].setTotalRequestCount(a.length);if(this.map.inVisibleRange(e.getMinScale(),e.getMaxScale()))if(this.abortRenderByLayerItem(b[d]),e.getVisible()){var f=this.getAdditiveFieldsString(b[d]),k=this.map.getPixelScale(),m,n=m=this.map.getWorld();null==this.map.getCoordinateSystem()||n.getCoordinateSystem().equals(e.getCoordinateSystem())||
(m=n.transformTo(e.getCoordinateSystem()));n=e;e.isSingleTile()&&(a=[new McxCell(0,0,m,this.map.getDisplay())]);for(var p=0;p<a.length;p++){var q=this.transformCellToTarget(a[p],e.getCoordinateSystem()),r=q.getIndexX().toString()+" "+q.getIndexY().toString();if(!(!e.isSingleTile()&&-1<g.indexOf(r)&&c)){var t=[];t.push(m);t.push(this.map.getDisplay());t.push(q);t.push(this);t.push(k);t.push(b[d]);r=new McxAjaxParameter;r.setParameters(this,this.onSearchSuccess,this.onSearchFail);r.setArgs(t);t=e.getFilterCollection();
q=n.fastSearch(f,t?t.toString():"",null,q.getWorld(),null,null,r);h.push(q)}}b[d].setRequests(h)}else{if(this.clearCanvasWithLayerId(f),b[d].setTotalRequestCount(0),this.checkForRenderEnd(this.fsCollectionItems)){a=new McxRendererEventArgs(McxRendererStatus.End);this.rendererEventHandler.dispatchOnSuccess(this,a);break}}else if(this.clearCanvasWithLayerId(f),b[d].setTotalRequestCount(0),this.checkForRenderEnd(this.fsCollectionItems)){a=new McxRendererEventArgs(McxRendererStatus.End);this.rendererEventHandler.dispatchOnSuccess(this,
a);break}}};
McxFsCollectionCanvas.prototype.paintByImage=function(a,b,c){if(null!=b&&0!=b.length){this.backBuffered||$("#"+this._imageLayerId+"_zoom").children("*").fadeTo(2E3,0);c=function(){this._imageLayerRequestCount--;if(this.checkForRenderEnd(this.fsCollectionItems)){var a=new McxRendererEventArgs(McxRendererStatus.End);this.rendererEventHandler.dispatchOnSuccess(this,a)}};for(var d=null,e=[],f=!1,g=null,h=0;h<b.length;h++){var k=b[h].getLayer();this.map.inVisibleRange(k.getMinScale(),k.getMaxScale())&&k.getVisible()&&
(null==d&&(d=k.getCoordinateSystem()),k.isSingleTile()&&(f=!0),null==g&&(g=k),e.push(k.getDataSource().getName()+":"+k.getName()))}this.requestsCanceled=!1;if(0!=e.length){var k=this.map.getPixelScale(),m=this.map.getWorld().transformTo(d),n=this.map.getTileSize().getWidth(),p=this.map.getTileSize().getHeight();a=this.map.getWorld().transformTo(d);var q=this.map.getDisplay();a=new McxLayerGrid(a,q,this.map.getTileSize(),null);a.calculate();a=a.getCells();f&&(a=[new McxCell(0,0,m,this.map.getDisplay())],
n=this.map.getDisplay().getWidth(),p=this.map.getDisplay().getHeight());this._imageLayerRequestCount=a.length;for(f=0;f<a.length;f++){m=null;m=this.transformCellToTarget(a[f],d);q=[];q.push(this.map.getWorld());q.push(this.map.getDisplay());q.push(m);q.push(this);q.push(k);q.push(this.map);q.push(n);q.push(p);q.push(b[h]);var r=new McxAjaxParameter;r.setParameters(this,this.onSearchImageSuccess,c);r.setArgs(q);m=g.getMap(e.join(";"),m.getWorld(),m.getDisplay().getWidth(),m.getDisplay().getHeight(),
"",r);this._imageLayerRequests.push(m)}}}};
McxFsCollectionCanvas.prototype.getAdditiveFieldsString=function(a){a=a.getLayer();var b=a.getGeometryField(),c=a.getKeyField();c&&null!=c&&(b=c+","+b);if(0<a.getSubtypes().getCount())for(var c=a.getSubtypes().getFields(),d=0;d<c.length;d++)c[d]!=a.getGeometryField()&&c[d]!=a.getKeyField()&&(b+=","+c[d]);a.getPainterMode()==McxPainterMode.ByFeature&&a.getSymbolizerField()&&""!=a.getSymbolizerField()&&(b+=","+a.getSymbolizerField());this.additiveFields&&""!=this.additiveFields&&(b+=","+this.additiveFields);
return b};
McxFsCollectionCanvas.prototype.onSearchImageSuccess=function(a){var b=a.getFeatureReader();a.getArgs()[2].getDisplay();var c=a.getArgs()[3],d=this.map.getPixelScale();a=a.getArgs()[4];if(0!=Math.abs(d-a))this._imageLayerRequests--,this.checkForRenderEnd(this.fsCollectionItems)&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,b));else{d={count:b.getFeatureCount()};if(0==b.getFeatureCount()&&(this._imageLayerRequestCount--,this.checkForRenderEnd(this.fsCollectionItems))){b=new McxRendererEventArgs(McxRendererStatus.End);
this.rendererEventHandler.dispatchOnSuccess(this,b);return}for(;b.read();){if(c.requestsCanceled){this.totalRequestCount=0;b=new McxRendererEventArgs(McxRendererStatus.Canceled);this.rendererEventHandler.dispatchOnSuccess(this,b);break}(a=b.getCurrent())&&a.getGeometry()&&this.paintFeature(a,d)}}};
McxFsCollectionCanvas.prototype.paintFeature=function(a,b){var c=this.map.getContent().find("#"+this._imageLayerId+"_divContainer").eq(0).find("[src='"+a.getQueryString()+"']");if(0<c.length){a.image=null;var d=a.getGeometry().getBounds(),e=c[0],c="width:"+(d.getWidth()+1).toString()+"px; height:"+(d.getHeight()+1).toString()+"px; position: absolute; left:"+(d.getLeft()-this.translateX).toString()+"px;top:"+(d.getBottom()-this.translateY).toString()+"px; ";e.setAttribute("style",c)}else{var f=this;
""!=this.crossOrigin&&(a.getImage().crossOrigin=this.crossOrigin);d=a.getGeometry().getBounds();e=a.getImage();e.setAttribute("draggable","false");e.setAttribute("ondragstart","return false;");c="width:"+(d.getWidth()+1).toString()+"px; height:"+(d.getHeight()+1).toString()+"px; position: absolute; left:"+(d.getLeft()-this.translateX).toString()+"px;top:"+(d.getBottom()-this.translateY).toString()+"px; ";null==this.drawTarget&&e.setAttribute("style",c);a.getImage().onload=function(){if(null!=f.drawTarget){if(f.drawTarget.getGeodeticGraphics().drawImage(a.getImage(),
d.getLeft(),d.getBottom(),d.getWidth()+1,d.getHeight()+1),b.count--,0==b.count&&(f._imageLayerRequestCount--,f.checkForRenderEnd(f.fsCollectionItems))){var c=new McxRendererEventArgs(McxRendererStatus.End);f.rendererEventHandler.dispatchOnSuccess(f,c)}}else 0<f.map.getContent().find("#"+f._imageLayerId+"_divContainer").eq(0).find("[src='"+a.getQueryString()+"']").length||f.map.getContent().find("#"+f._imageLayerId+"_divContainer").eq(0).append(e)};a.getImage().onerror=function(){if(null!=f.drawTarget&&
(b.count--,0==b.count&&(f._imageLayerRequestCount--,f.checkForRenderEnd(f.fsCollectionItems)))){var a=new McxRendererEventArgs(McxRendererStatus.End);f.rendererEventHandler.dispatchOnSuccess(f,a)}};a.getImage().src=a.getQueryString()}};
McxFsCollectionCanvas.prototype.onSearchSuccess=function(a){if(null!=this.drawTarget)this.drawModeOnSearchSuccess(a);else{var b=a.getFeatureReader(),c=a.getArgs()[2],d=c.getDisplay();a.getArgs();var e=this.map.getPixelScale(),f=a.getArgs()[4],g=a.getArgs()[5],h=g.getCanvasId(),k=g.getLayerId(),m=g.getLayer();if(0!=Math.abs(e-f))this.clearCanvasWithLayerId(k),g.setTotalRequestCount(0),this.checkForRenderEnd(this.fsCollectionItems)&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,
b));else{var e=c.getWorld(),n=f=this.map.getWorld(),n=m.getCoordinateSystem(),n=null==f.getCoordinateSystem()||f.getCoordinateSystem().equals(n)?f:f.transformTo(n);if(n.intersectsBounds(e)){e=h+"-"+c.getIndexX()+"-"+c.getIndexY();(h=this.map.getContent().find("#"+e).eq(0))&&null!=h&&$(h).remove();h=document.createElement("canvas");h.id=e;h.style.position="absolute";h.setAttribute("height",Math.floor(d.getHeight()).toString()+"px");h.setAttribute("width",Math.floor(d.getWidth()).toString()+"px");h.globalCompositeOperation=
"source-over";k=this.map.getContent().find("#"+k+"_divContainer").eq(0);e=(d.getLeft()-this.translateX).toString();f=(d.getBottom()-this.translateY).toString();$(h).css("-webkit-transform","translate3d("+e+"px, "+f+"px,0px)").css("-moz-transform","translate3d("+e+"px, "+f+"px,0px)").css("-ms-transform","translate3d("+e+"px, "+f+"px,0px)").css("-o-transform","translate3d("+e+"px, "+f+"px,0px)").css("transform","translate3d("+e+"px, "+f+"px,0px)");h.style.display="none";$(h).fadeIn(250);k.append(h);
k=new McxDrawContext(this.map,h.getContext("2d"));for(k.getGeodeticGraphics().setContentDiv(this.contentDiv);b.read();)(h=b.getCurrent())&&h.getGeometry()&&((e=m.getKeyField())&&null!=e&&g.getPaintedFeatures().addFeature(h.getFeatureID(),h.getGeometry()),e=this.getAppropriatePainter(h),null!=e&&e.paint(k,h,d.getLeft(),d.getBottom()));g.setTotalRequestCount(g.getTotalRequestCount()-1);this.checkForRenderEnd(this.fsCollectionItems)&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,
b));b=c.getIndexX().toString()+" "+c.getIndexY().toString();g.getPaintedCells().push(b);this.drawLabelsOfCell(c.getWorld(),a.getArgs()[0],a.getArgs()[1],c.getDisplay(),g.getLayer())}else this.clearCanvasWithLayerId(k),g.setTotalRequestCount(g.getTotalRequestCount()-1),this.checkForRenderEnd(this.fsCollectionItems)&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,b))}}};
McxFsCollectionCanvas.prototype.paintLabels=function(a){for(var b,c=b=this.map.getWorld(),d=0;d<this.fsCollectionItems.length;d++){var e=this.fsCollectionItems[d].getLayer();null==this.map.getCoordinateSystem()||c.getCoordinateSystem().equals(e.getCoordinateSystem())||(b=c.transformTo(e.getCoordinateSystem()));for(var f=0;f<a.length;f++){var g=this.transformCellToTarget(a[f],e.getCoordinateSystem());this.drawLabelsOfCell(g.getWorld(),b,this.map.getDisplay(),g.getDisplay(),e)}}};
McxFsCollectionCanvas.prototype.drawLabelsOfCell=function(a,b,c,d,e){if(e.isShowLabels()&&this.map.inVisibleRange(e.getMinLabelScale(),e.getMaxLabelScale())){d=new McxAjaxParameter;d.setParameters(this,this.onLabelSearchSuccess,null);d.setArgs([c,b,e]);var f=e.getFilterCollection().toString();a=e.fastSearch("",f,e.getLabelFormat(),a,b,c,d);this.requests.push(a)}};
McxFsCollectionCanvas.prototype.drawLabelsOfCellOnContext=function(a,b,c,d,e,f){var g=new McxAjaxParameter;g.setParameters(this,this.onLabelSearchSuccessOnContext,null);g.setArgs([e,c,a,f]);a=f.getFilterCollection().toString();b=f.fastSearch(a,"",f.getLabelFormat(),b,c,d,g);this.requests.push(b)};
McxFsCollectionCanvas.prototype.onLabelSearchSuccessOnContext=function(a){a.getArgs();a.getArgs();var b=a.getArgs()[2],c=a.getArgs()[3],d=a.getLabelReader();for(a=[];d.read();){var e=d.getCurrent();a.push(e)}if(!(0>=a.length)){d=this.map.getPixelScale();null!=this.map.getCoordinateSystem()&&(d*=this.map.getCoordinateSystem().getDistancePerUnit());d=c.isScaledLabels()?1/d:1;b.getGeodeticGraphics().useTransform(!1);for(e=0;e<a.length;e++){var f=new McxPoint(a[e].getX(),a[e].getY(),null),g=a[e].getAngle();
g&&0!=g&&c.getLabelSymbolizer().setRotation(g);b.getGeodeticGraphics().drawText(a[e].getValue(),f,c.getLabelSymbolizer(),d,0,0)}b.getGeodeticGraphics().useTransform(!0)}this.totalLabelRequestCount--;0==this.totalLabelRequestCount&&this.labelRendererEventHandler.dispatchOnSuccess(this,null)};
McxFsCollectionCanvas.prototype.onLabelSearchSuccess=function(a){var b=a.getArgs()[0],c=a.getArgs()[1],d=a.getArgs()[2];a=a.getLabelReader();for(var e=[];a.read();){var f=a.getCurrent();e.push(f)}0>=e.length||this.labelCanvas.drawLabels(b,c,d,e)};
McxFsCollectionCanvas.prototype.abortRender=function(){for(var a=0;a<this.fsCollectionItems.length;a++){var b=this.fsCollectionItems[a],c=b.getRequests();this.requestsCanceled=!0;for(var d=0;d<c.length;d++)c[d].abort(),d==c.length-1&&(c=[]);b.setRequests([])}c=this._imageLayerRequests;for(d=0;d<c.length;d++)c[d].abort(),d==c.length-1&&(c=[]);this._imageLayerRequests=[]};
McxFsCollectionCanvas.prototype.abortRenderByLayerItem=function(a){if(null!=a){var b=a.getRequests();this.requestsCanceled=!0;for(var c=0;c<b.length;c++)b[c].abort(),c==b.length-1&&(b=[]);a.setRequests([])}};
McxFsCollectionCanvas.prototype.getAppropriatePainter=function(a){var b=null,c=a.getSymbolizer();if(null==c)var d=a.getLayer().getSymbolizer();var e=a.getGeometry();if(!e)return null;e.isInstanceOf(McxGeometryType.Point)?(b=new McxPointPainter,null==c?b.setSymbolizer(d.getPointSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.LineString)?(b=new McxLineStringPainter,null==c?b.setSymbolizer(d.getLineSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.Polygon)?(b=new McxPolygonPainter,
null==c?b.setSymbolizer(d.getPolygonSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiPoint)?(b=new McxMultiPointPainter,null==c?b.setSymbolizer(d.getPointSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiLineString)?(b=new McxMultiLinePainter,null==c?b.setSymbolizer(d.getLineSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiPolygon)&&(b=new McxMultiPolygonPainter,null==c?b.setSymbolizer(d.getPolygonSymbolizer()):b.setSymbolizer(c));if(null!=
b){c=null;d=a.getLayer().getSubtypes();if(0<d.getCount())for(e=0;e<d.getCount();e++){var f=d.getAt(e);if(f.isVisible()&&!(!isNaN(f.getMinScale())&&1/this.map.getScale()<1/f.getMinScale()||!isNaN(f.getMaxScale())&&1/this.map.getScale()>1/f.getMaxScale())&&f.getScript().run(a)){c=f.getSymbolizer();break}}d=a.getSymbolizer();if(b.isInstanceOf("McxPointPainter")||b.isInstanceOf("McxMultiPointPainter"))null!=d&&d.isInstanceOf("IMcxPointSymbolizer")&&a.getLayer().getPainterMode()==McxPainterMode.ByFeature?
b.setSymbolizer(d):null!=d&&d.isInstanceOf("IMcxTextSymbolizer")&&a.getLayer().getPainterMode()==McxPainterMode.ByFeature?b.setSymbolizer(d):null!=c&&null!=c.getPointSymbolizer()?b.setSymbolizer(c.getPointSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getPointSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getPointSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultPointSymbolizer());else if(b.isInstanceOf("McxLineStringPainter")||
b.isInstanceOf("McxMultiLinePainter"))null!=d&&d.isInstanceOf("IMcxLineSymbolizer")&&a.getLayer().getPainterMode()==McxPainterMode.ByFeature?b.setSymbolizer(a.getSymbolizer()):null!=c&&null!=c.getLineSymbolizer()?b.setSymbolizer(c.getLineSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getLineSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getLineSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultLineSymbolizer());else if(b.isInstanceOf("McxPolygonPainter")||
b.isInstanceOf("McxMultiPolygonPainter"))null!=d&&d.isInstanceOf("IMcxPolygonSymbolizer")&&a.getLayer().getPainterMode()==McxPainterMode.ByFeature?b.setSymbolizer(d):null!=c&&null!=c.getPolygonSymbolizer()?b.setSymbolizer(c.getPolygonSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getPolygonSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getPolygonSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultPolygonSymbolizer())}return b};
McxFsCollectionCanvas.prototype.paintSelection=function(a){for(var b=0;b<this.fsCollectionItems.length;b++){var c=this.fsCollectionItems[b].getLayer();if(!c.isInstanceOf("IMcxSelectableLayer"))break;if(c.getVisible()){if(!this.map.inVisibleRange(c.getMinScale(),c.getMaxScale()))break;if(0==c.getSelectionCount())break;for(c=c.getSelection();c.read();){var d=c.getCurrent();if(d.getGeometry()&&null!=d.getGeometry()){var e=this.getAppropriatePainter(d);(d.getGeometry().isInstanceOf(McxGeometryType.Polygon)||
d.getGeometry().isInstanceOf(McxGeometryType.MultiPolygon))&&e.setSymbolizer(this.selectionSymbolizer.getPolygonSymbolizer());(d.getGeometry().isInstanceOf(McxGeometryType.LineString)||d.getGeometry().isInstanceOf(McxGeometryType.MultiLineString))&&e.setSymbolizer(this.selectionSymbolizer.getLineSymbolizer());(d.getGeometry().isInstanceOf(McxGeometryType.Point)||d.getGeometry().isInstanceOf(McxGeometryType.MultiPoint))&&e.setSymbolizer(this.selectionSymbolizer.getPointSymbolizer());null!=e&&e.paint(a,
d,0,0)}}}}};McxFsCollectionCanvas.prototype.clearCanvasWithLayerId=function(a){$("#"+a+"_divContainer").empty()};McxFsCollectionCanvas.prototype.clearCanvas=function(){for(var a=0;a<this.fsCollectionItems.length;a++){var b=this.fsCollectionItems[a].getLayerId();$("#"+b+"_divContainer").empty()}};McxFsCollectionCanvas.prototype.isInstanceOf=function(a){return"McxFsCollectionCanvas"==a};
McxFsCollectionCanvas.prototype.setAdditiveFields=function(a){if(""==a)this.additiveFields="";else{a instanceof Array||(a=[a]);for(var b=0;b<a.length;b++)0!=b&&(this.additiveFields+=","),this.additiveFields+=a[b]}};McxFsCollectionCanvas.prototype.animateFadeEffect=function(a){$("#"+a+"_zoom").children("*").fadeTo(500,0);this.contentDiv.children("*").fadeTo(500,0)};
McxFsCollectionCanvas.prototype.checkForRenderEnd=function(a){for(var b=0;b<a.length;b++)if(0!=a[b].getTotalRequestCount())return!1;return 0!=this._imageLayerRequests?!1:!0};
McxFsCollectionCanvas.prototype.clearBackBuffer=function(){for(var a=0;a<this.fsCollectionItems.length;a++){var b=this.fsCollectionItems[a].getLayer(),c=this.fsCollectionItems[a].getLayerId();b.getPainterMode()==McxPainterMode.ByImage?($("#"+this._imageLayerId+"_zoom").empty(),$("#"+this._imageLayerId+"_backBuffer").empty()):($("#"+c+"_zoom").empty(),$("#"+c+"_backBuffer").empty())}};McxFsCollectionCanvas.prototype.clearBackBufferWithLayerId=function(a){$("#"+a+"_zoom").empty();$("#"+a+"_backBuffer").empty()};
McxFsCollectionCanvas.prototype.transformCellToTarget=function(a,b){if(null==this.map.getCoordinateSystem()||null==b||this.map.getCoordinateSystem().equals(b))return a;var c=a.getWorld().transformTo(b);return new McxCell(a.getIndexX(),a.getIndexY(),c,a.getDisplay())};McxFsCollectionCanvas.prototype.canAddLayer=function(a){return null==this._dataSourceString||""==this._dataSourceString?!0:this._dataSourceString==a.getDataSource().getSource()};McxFsCollectionCanvas.prototype.addLayer=function(a){this.initialize([a])};
McxFsCollectionCanvas.prototype.translate=function(a,b){0!=this.map.getPixelScale()&&(this.translateX+=-1*a/this.map.getPixelScale(),this.translateY+=b/this.map.getPixelScale())};McxFsCollectionCanvas.prototype.setDisplay=function(a,b){this.isDirty=!0;this.width=a;this.height=b};McxFsCollectionCanvas.prototype.getLayers=function(){for(var a=[],b=0;b<this.fsCollectionItems.length;b++)a.push(this.fsCollectionItems[b].getLayer());return a};
McxFsCollectionCanvas.prototype.remove=function(a){for(var b=0;b<this.fsCollectionItems.length;b++)this.fsCollectionItems[b].getLayer().getClassId()==a.getClassId()&&(this.map.getContent().find("#"+this.map.getName()+"_layerContainer").find("#"+this.fsCollectionItems[b].getLayerId()).remove(),this.fsCollectionItems.splice(b,1))};McxFsCollectionCanvas.prototype.clearCache=function(){for(var a=0;a<this.fsCollectionItems.length;a++)this.fsCollectionItems[a].setPaintedCells([]),this.fsCollectionItems[a].getPaintedFeatures().clear()};
McxFsCollectionCanvas.prototype.getRendererEventHandler=function(){return this.rendererEventHandler};McxFsCollectionCanvas.prototype.setLayerOrder=function(a,b){for(var c=0;c<this.fsCollectionItems.length;c++)if(this.fsCollectionItems[c].getLayer().getClassId()==b.getClassId()){var d=this.fsCollectionItems[c];this.fsCollectionItems.splice(c,1);var e=this.fsCollectionItems.slice(0,a),f=this.fsCollectionItems.slice(a);e.push(d);this.fsCollectionItems=$.merge(e,f)}};
McxFsCollectionCanvas.prototype.setOrder=function(a,b){for(var c=0;c<this.fsCollectionItems.length;c++)this.fsCollectionItems[c].getLayer().getUniqueId()==b.getUniqueId()&&$("#"+this.fsCollectionItems[c].getLayerId()).css("z-index",a);$("#"+this._imageLayerId).css("zIndex",a);$("#"+this._imageLayerId+"_divContainer").css("zIndex",a);$("#"+this._imageLayerId+"_backBuffer").css("zIndex",a-1);$("#"+this._imageLayerId+"_zoom").css("zIndex",a-1)};
McxFsCollectionCanvas.prototype.paintBackBuffer=function(){for(var a=0;a<this.fsCollectionItems.length;a++){var b=this.fsCollectionItems[a].getLayerId();$("#"+b+"_divContainer").children("*").appendTo("#"+b+"_zoom")}$("#"+this._imageLayerId+"_divContainer").children("*").appendTo("#"+this._imageLayerId+"_zoom")};
McxFsCollectionCanvas.prototype.zoomTo=function(a,b,c){for(var d=0;d<this.fsCollectionItems.length;d++){var e=this.fsCollectionItems[d].getLayerId(),f=$("#"+e+"_zoom").eq(0);f[0].style.transition="0ms";f.css("-webkit-transform-origin",a+"px "+b+"px").css("-moz-transform-origin",a+"px "+b+"px").css("-ms-transform-origin",a+"px "+b+"px").css("-o-transform-origin",a+"px "+b+"px").css("transform-origin",a+"px "+b+"px")}var g=this;setTimeout(function(){for(var a=0;a<g.fsCollectionItems.length;a++){var b=
g.fsCollectionItems[a].getLayerId(),b=$("#"+b+"_zoom").eq(0);b[0].style.transition="500ms ease-out";b.css("-webkit-transform","scale("+c+")").css("-moz-transform","scale("+c+")").css("-ms-transform","scale("+c+")").css("-o-transform","scale("+c+")").css("transform","scale("+c+")")}},10);f=$("#"+this._imageLayerId+"_zoom").eq(0);f[0].style.transition="0ms";f.css("-webkit-transform-origin",a+"px "+b+"px").css("-moz-transform-origin",a+"px "+b+"px").css("-ms-transform-origin",a+"px "+b+"px").css("-o-transform-origin",
a+"px "+b+"px").css("transform-origin",a+"px "+b+"px");setTimeout(function(){f[0].style.transition="500ms ease-out";f.css("-webkit-transform","scale("+c+")").css("-moz-transform","scale("+c+")").css("-ms-transform","scale("+c+")").css("-o-transform","scale("+c+")").css("transform","scale("+c+")")},10)};
McxFsCollectionCanvas.prototype.setUpHtmlElements=function(a){var b=a.getLayerId(),c=a.getZIndex(),d=$("<div/>").css("position","absolute").css("zIndex",c).attr("id",b).attr("for",a.getLayer().getAlias()).addClass(""),e=$("<div/>").css("position","absolute").css("zIndex",c).css("opacity",1).attr("for",a.getLayer().getAlias()).attr("id",b+"_divContainer").addClass("");a=$("<div/>").css("position","absolute").css("zIndex",c+1).attr("for",a.getLayer().getAlias()).attr("id",b+"_zoom").addClass(this.map.getRenderer().getZoomAnimationClass());
var f=this.map.getContent().find("#"+this.map.getName()+"_layerContainer");$(f).append(d);$(d).append(e);$(d).append(a);0==$("#"+this._imageLayerId).eq(0).length&&(d=$("<div/>").css("position","absolute").css("zIndex",c).attr("id",this._imageLayerId).addClass(""),e=$("<div/>").css("position","absolute").css("zIndex",c).css("opacity",1).attr("id",this._imageLayerId+"_divContainer").addClass(""),a=$("<div/>").css("position","absolute").css("zIndex",c+1).attr("id",this._imageLayerId+"_zoom").addClass(this.map.getRenderer().getZoomAnimationClass()),
b+="_contentContainer",this.contentDiv=$("#"+b),0==this.contentDiv.length&&(this.contentDiv=$("<div/>").attr("id",b).css("position","relative").css("width","100%").css("z-index",1001).css("height","100%").addClass("")),f=this.map.getContent().find("#"+this.map.getName()+"_layerContainer"),$(f).append(d),$(d).append(e),$(d).append(a),$(d).append(this.contentDiv))};
McxFsCollectionCanvas.prototype.resetZoomAnimationClass=function(){for(var a=0;a<this.fsCollectionItems.length;a++){var b=this.fsCollectionItems[a].getLayerId(),c=$("#"+b+"_zoom");setTimeout(function(){c.empty();c.css("-webkit-transform","scale(1)").css("-moz-transform","scale(1)").css("-ms-transform","scale(1)").css("-o-transform","scale(1)").css("transform","scale(1)")},1E3)}c=$("#"+this._imageLayerId+"_zoom");setTimeout(function(){c.empty();c.css("-webkit-transform","scale(1)").css("-moz-transform",
"scale(1)").css("-ms-transform","scale(1)").css("-o-transform","scale(1)").css("transform","scale(1)")},1E3)};McxFsCollectionCanvas.prototype.backBufferEnabled=function(a){this.backBuffered=a};
McxFsCollectionCanvas.prototype.drawModeOnSearchSuccess=function(a){var b=a.getFeatureReader(),c=a.getArgs()[2],d=c.getDisplay();a.getArgs();var e=this.map.getPixelScale(),f=a.getArgs()[4];a=a.getArgs()[5];var g=a.getCanvasId(),h=a.getLayerId(),k=a.getLayer();if(0!=Math.abs(e-f))this.clearCanvasWithLayerId(h),a.setTotalRequestCount(0),this.checkForRenderEnd(this.fsCollectionItems)&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,b));else{var e=c.getWorld(),
m=f=this.map.getWorld(),m=k.getCoordinateSystem(),m=null==f.getCoordinateSystem()||f.getCoordinateSystem().equals(m)?f:f.transformTo(m);if(m.intersectsBounds(e)){e=g+"-"+c.getIndexX()+"-"+c.getIndexY();(g=this.map.getContent().find("#"+e).eq(0))&&null!=g&&$(g).remove();g=document.createElement("canvas");g.id=e;g.style.position="absolute";g.setAttribute("height",Math.floor(d.getHeight()).toString()+"px");g.setAttribute("width",Math.floor(d.getWidth()).toString()+"px");g.globalCompositeOperation="source-over";
h=this.map.getContent().find("#"+h+"_divContainer").eq(0);e=(d.getLeft()-this.translateX).toString();d=(d.getBottom()-this.translateY).toString();$(g).css("-webkit-transform","translate3d("+e+"px, "+d+"px,0px)").css("-moz-transform","translate3d("+e+"px, "+d+"px,0px)").css("-ms-transform","translate3d("+e+"px, "+d+"px,0px)").css("-o-transform","translate3d("+e+"px, "+d+"px,0px)").css("transform","translate3d("+e+"px, "+d+"px,0px)");g.style.display="none";$(g).fadeIn(250);h.append(g);for((new McxDrawContext(this.map,
g.getContext("2d"))).getGeodeticGraphics().setContentDiv(this.contentDiv);b.read();)(d=b.getCurrent())&&d.getGeometry()&&((h=k.getKeyField())&&null!=h&&a.getPaintedFeatures().addFeature(d.getFeatureID(),d.getGeometry()),h=this.getAppropriatePainter(d),null!=h&&h.paint(this.drawTarget,d,0,0));a.setTotalRequestCount(a.getTotalRequestCount()-1);this.checkForRenderEnd(this.fsCollectionItems)&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,b));c=c.getIndexX().toString()+
" "+c.getIndexY().toString();a.getPaintedCells().push(c)}else this.clearCanvasWithLayerId(h),a.setTotalRequestCount(0),this.checkForRenderEnd(this.fsCollectionItems)&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,b))}};McxFsCollectionCanvas.prototype.setLabelCanvas=function(a){this.labelCanvas=a};js.framework.mapping.McxCanvas.McxFsLayerCollectionItem={};function McxFsLayerCollectionItem(a,b,c){this._layer=a;this._layerId=b;this._requests=[];this._totalRequestCount=0;this._paintedCells=[];this._paintedFeatures=new McxPaintedFeatures(15E3);this._canvasId=c;this._order=this._zIndex=0}McxFsLayerCollectionItem.prototype.getLayerId=function(){return this._layerId};McxFsLayerCollectionItem.prototype.getLayer=function(){return this._layer};
McxFsLayerCollectionItem.prototype.setOrder=function(a){this._order=a};McxFsLayerCollectionItem.prototype.getOrder=function(){return this._order};McxFsLayerCollectionItem.prototype.getRequests=function(){return this._requests};McxFsLayerCollectionItem.prototype.setRequests=function(a){this._requests=a};McxFsLayerCollectionItem.prototype.getTotalRequestCount=function(){return this._totalRequestCount};McxFsLayerCollectionItem.prototype.setTotalRequestCount=function(a){this._totalRequestCount=a};
McxFsLayerCollectionItem.prototype.getPaintedCells=function(){return this._paintedCells};McxFsLayerCollectionItem.prototype.setPaintedCells=function(a){this._paintedCells=a};McxFsLayerCollectionItem.prototype.setPaintedFeatures=function(a){this._paintedFeatures=a};McxFsLayerCollectionItem.prototype.getPaintedFeatures=function(){return this._paintedFeatures};McxFsLayerCollectionItem.prototype.getCanvasId=function(){return this._canvasId};
McxFsLayerCollectionItem.prototype.setCanvasId=function(a){this._canvasId=a};McxFsLayerCollectionItem.prototype.setZIndex=function(a){this._zIndex=a};McxFsLayerCollectionItem.prototype.getZIndex=function(){return this._zIndex};js.framework.mapping.McxCanvas.McxHeatMapCanvas={};function McxHeatMapCanvas(a,b){mcx.base(this,a,b);this.radius=10;this.heatMapOpacity=100;this.gradient=new McxGradient;this.base=this;this.heatMap=null;this.initialCellCount=this.totalCellCount=0;this.displayCoordinates=[];this.dy=this.dx=0;this.heatMapContainer=null;this.singleTile=!0;this.filter=null;this.timerId=this.timeOutInterval=0;this.init()}mcx.inherits(McxHeatMapCanvas,McxFsCanvas);
McxHeatMapCanvas.prototype.redraw=function(){var a=this.base.map.getWorld(),a=new McxGrid(this.base.map,a);a.calculate();this.paintLayer(a.cells)};McxHeatMapCanvas.prototype.init=function(){var a=new McxStroke;a.setWidth(2);a.setColor("red");(new McxFill).setColor("transparent");a=function(){this.initializeHeatMap()};this.base.map.getResizeEventHandler().addListener(a,a,this);0<this.timeOutInterval&&(this.timerId=setInterval(this.redraw,this.timeOutInterval));this.initializeHeatMap()};
McxHeatMapCanvas.prototype.initializeHeatMap=function(){this.heatMapContainer=$("<div/>").css("position","absolute").attr("id","heatmapArea");var a={"0.8":"rgb(0,0,255)","0.1":"rgb(0,255,255)","0.3":"rgb(0,255,0)","0.4":"yellow","0.44":"rgb(255,0,0)"},b=this.gradient.getStops();if(0<b.length)for(var a={},c=0;c<b.length;c++){var d=b[c].getStop();1<d&&(d/=100);a[d]=b[c].getColor().getRgbStyleString()}a={element:this.heatMapContainer[0],radius:this.radius,width:this.base.map.getDisplay().getWidth(),
height:this.base.map.getDisplay().getHeight(),opacity:this.heatMapOpacity,gradient:a};this.heatMap=window.h337.create(a);this.heatMap.store.setDataSet({max:2E7,data:[]})};
McxHeatMapCanvas.prototype.onSearchMemHeatMapSuccess=function(a){var b=a.getArgs()[1],c=a.getFeatureReader();if(!this.base.requestsCanceled){for(;c.read();){if(this.base.requestsCanceled)return;var d=c.getCurrent(),e=d.getGeometry().getBounds().getCentroid().transformTo(this.base.map.getCoordinateSystem()),e=this.base.map.worldToView(e.getX(),e.getY()),f=1;""!=this.base.additiveFields&&(f=this.base.additiveFields.split(",")[0],f=parseFloat(d.getValue(f)));this.displayCoordinates.push({x:e.x,y:e.y,
count:f})}a=a.getArgs()[2];a=a.getIndexX().toString()+" "+a.getIndexY().toString();this.singleTile||this.base.paintedCells.push(a);this.initialCellCount++;this.totalCellCount==this.initialCellCount&&(a={max:this.displayCoordinates.length,data:this.displayCoordinates},this.base.requestsCanceled||(this.heatMap.store.setDataSet(a),a=this.heatMap.getImage(),this.paintCanvas(a,b)))}};
McxHeatMapCanvas.prototype.onSearchHeatMapSuccess=function(a){var b=a.getArgs()[1],c=a.getLabelReader();if(!this.base.requestsCanceled){for(;c.read();){if(this.base.requestsCanceled)return;var d=c.getCurrent(),e=new McxPoint(d.getX(),d.getY(),null),d=parseFloat(d.getValue());this.displayCoordinates.push({x:e.x,y:e.y,count:d})}a=a.getArgs()[2];a=a.getIndexX().toString()+" "+a.getIndexY().toString();this.singleTile||this.base.paintedCells.push(a);this.initialCellCount++;this.totalCellCount==this.initialCellCount&&
(a={max:this.displayCoordinates.length,data:this.displayCoordinates},this.base.requestsCanceled||(this.heatMap.store.setDataSet(a),a=this.heatMap.getImage(),this.paintCanvas(a,b)))}};
McxHeatMapCanvas.prototype.paintLayer=function(a){$("#"+this.base.layerId+"_zoom").empty();var b=this,c=function(a){b.initialCellCount++;b.totalCellCount==b.initialCellCount&&(a=b.heatMap.getImageData(0,0,b.base.map.getDisplay().getWidth(),b.base.map.getDisplay().getHeight()),b.paint(a,b.base.map.getDisplay()))};if(this.base.map.inVisibleRange(this.base.layer.getMinScale(),this.base.layer.getMaxScale()))if(this.abortRender(),this.base.initialCount=0,this.base.isDirty&&(this.clearCanvas(),this.base.isDirty=
!1),this.base.layer.getVisible()){this.displayCoordinates=[];this.singleTile||(a=new McxGrid(this.base.map,this.base.map.getWorld()),a.calculate(),a=a.cells);var d=this.base.map.getPixelScale(),e,f=e=this.base.map.getWorld();null==this.base.map.getCoordinateSystem()||f.getCoordinateSystem().equals(this.base.layer.getCoordinateSystem())||(e=f.transformTo(this.base.layer.getCoordinateSystem()));this.singleTile&&(a=[new McxCell(0,0,e,this.base.map.getDisplay())]);this.initialCellCount=0;this.totalCellCount=
this.base.totalRequestCount=a.length;f="";null!=this.base.additiveFields&&""!=this.base.additiveFields&&(f="["+this.base.additiveFields+"]");this.base.requestsCanceled=!1;var g=this.base.layer.getKeyField()+","+this.base.layer.getGeometryField();this.base.additiveFields&&""!=this.base.additiveFields&&(g+=this.base.additiveFields);for(var h=0;h<a.length;h++){var k=this.transformCellToTarget(a[h],this.base.layer.getCoordinateSystem());k.getIndexX();k.getIndexY();var m=[];m.push(e);m.push(this.base.map.getDisplay());
m.push(k);m.push(this);m.push(d);var n=new McxAjaxParameter;n.setParameters(this,this.onSearchHeatMapSuccess,c);n.setArgs(m);m="";null!=this.filter&&(m=this.filter.getAttributeFilter());this.base.layer.isInstanceOf("McxFsLayer")?k=this.base.layer.fastSearch("",m,f,a[h].getWorld(),this.base.map.getWorld(),this.base.map.getDisplay(),n):(n.setParameters(this,this.onSearchMemHeatMapSuccess,c),k=this.base.layer.searchByEnvelope(g,"",k.getWorld(),"Intersects",n));this.base.requests.push(k)}}else this.clearCanvas(),
this.clearBackBuffer();else this.clearCanvas()};McxHeatMapCanvas.prototype.clearCanvas=function(){$("#"+this.base.layerId+"_divContainer").empty();this.dy=this.dx=0};McxHeatMapCanvas.prototype.getCount=function(a){var b=this.base.additiveFields;return b&&null!=b&&""!=b?(a=a.getValue(b))&&null!=a&&0!=a?a:1:1};
McxHeatMapCanvas.prototype.paintCanvas=function(a,b){if(!this.base.requestsCanceled){a.style.position="absolute";a.globalCompositeOperation="source-over";var c=document.getElementById(this.base.layerId+"_divContainer"),d=(-this.translateX).toString(),e=(-this.translateY).toString();$(a).css("-webkit-transform","translate3d("+d+"px, "+e+"px,0px)").css("-moz-transform","translate3d("+d+"px, "+e+"px,0px)").css("-ms-transform","translate3d("+d+"px, "+e+"px,0px)").css("-o-transform","translate3d("+d+"px, "+
e+"px,0px)").css("transform","translate3d("+d+"px, "+e+"px,0px)");c.appendChild(a)}};
McxHeatMapCanvas.prototype.paint=function(a,b){if(!this.base.requestsCanceled){var c=this;$("#"+this.base.layerId+"_divContainer").empty();var d=new Image;d.setAttribute("draggable","false");var e="width:"+(b.getWidth()+2).toString()+"px; height:"+(b.getHeight()+2).toString()+"px; position: absolute;left:"+(-1*this.base.translateX).toString()+"px;top:"+(-1*this.base.translateY).toString()+"px; ";d.setAttribute("style",e);d.onload=function(){document.getElementById(c.layerId+"_divContainer").appendChild(d)};
d.src=a}};McxHeatMapCanvas.prototype.setParameters=function(a,b,c){this.radius=a;this.heatMapOpacity=b;this.gradient=c;this.init()};McxHeatMapCanvas.prototype.setSingleTile=function(a){this.singleTile=a};McxHeatMapCanvas.prototype.setFilter=function(a){this.filter=a};McxHeatMapCanvas.prototype.setRenderInterval=function(a){clearInterval(this.timerId);this.timeOutInterval=a;0<this.timeOutInterval&&(this.timerId=setInterval(this.redraw,this.timeOutInterval))};McxHeatMapCanvas.prototype.getRadius=function(){return this.radius};
McxHeatMapCanvas.prototype.getOpacity=function(){return this.opacity};McxHeatMapCanvas.prototype.getGradient=function(){return this.gradient};McxHeatMapCanvas.prototype.getAdditiveFields=function(){return this.base.additiveFields};js.framework.mapping.McxCanvas.McxNonLayerCanvas={};function McxNonLayerCanvas(a,b){this.id=McxGuid.createGuid();this.map=a;this.sketchCanvas=null;this.initialize(b)}
McxNonLayerCanvas.prototype.initialize=function(a){var b=document.createElement("canvas");b.id=this.id;b.style.position="absolute";b.style.left=0;b.style.top=0;b.style.backgroundColor="transparent";b.style.zIndex=a;b.globalCompositeOperation="source-over";mcx.isInstanceOf(this.map,McxUserControl)?this.map.getContent().append(b):(a=document.getElementById(this.map.getName()),$(a).append(b))};
McxNonLayerCanvas.prototype.getNonLayerDrawContext=function(){var a=this.map.getContent().find("#"+this.id)[0];return new McxDrawContext(this.map,a.getContext("2d"))};McxNonLayerCanvas.prototype.clear=function(){null==this.sketchCanvas&&(this.sketchCanvas=this.map.getContent().find("#"+this.id)[0]);null!=this.sketchCanvas&&(this.sketchCanvas.width=this.sketchCanvas.width)};
McxNonLayerCanvas.prototype.onDisplayChanged=function(){var a=this.map.getContent().find("#"+this.id)[0];null!=a&&(a.width=this.map.getDisplay().getWidth(),a.height=this.map.getDisplay().getHeight())};McxNonLayerCanvas.prototype.setDisplay=function(a,b){var c=this.map.getContent().find("#"+this.id)[0];null!=c&&(c.width=a,c.height=b)};McxNonLayerCanvas.prototype.paintLayer=function(a){};McxNonLayerCanvas.prototype.isInstanceOf=function(a){return"McxNonLayerCanvas"==a};
McxNonLayerCanvas.prototype.setOrder=function(a){this.map.getContent().find("#"+this.id)[0].style.zIndex=a};js.framework.mapping.McxCanvas.McxRenderer={};
function McxRenderer(a){this.animationActive=!0;this.animationClass="back-buffer-animation-on";this.panAnimationClass="back-buffer-animation-off";this.canvases=[];this.map=a;this.mapLastScale=0;this.layerAdded=new McxEventHandler;this.layerRemoved=new McxEventHandler;this.onLayerOrderChangeHandler=new McxEventHandler;this.activeLayerChanged=new McxEventHandler;this.selectionCanvas=this.labelCanvas=this.sketchCanvas=this.activeLayer=null;this.alertTimerId=0;this.scaleLevel=1;this.totalProgress=this.screenYCoord=
this.screenXCoord=this.activeScale=0;this.rendererStartEventHandler=new McxEventHandler;this.rendererEndEventHandler=new McxEventHandler;this.canvasProviders=[];this.firstPass=!0;this.translateY=this.translateX=0;this.durationChanged=!1;this.setPanAnimationClass("back-buffer-ease-in-out");this._onScale=!1;this.deviceScale=0;this.initialize()}
McxRenderer.prototype.initialize=function(){var a=function(){var a=this.map.getDisplay();null!=this.sketchCanvas&&this.sketchCanvas.setDisplay(a.getWidth(),a.getHeight());null!=this.labelCanvas&&this.labelCanvas.setDisplay(a.getWidth(),a.getHeight());null!=this.selectionCanvas&&this.selectionCanvas.setDisplay(a.getWidth(),a.getHeight())};if(null==this.sketchCanvas){var b=this.map.getDisplay(),c=this.map.getName()+"_markerContainer",d=$("#"+c);0==d.length&&(d=$("<div/>").attr("id",c).css("position",
"relative").css("width","100%").css("z-index",1001).css("height","100%"));this.map.getContent().append(d);this.sketchCanvas=new McxNonLayerCanvas(this.map,1E3);this.sketchCanvas.setDisplay(b.getWidth(),b.getHeight())}this.map.getResizeEventHandler().addListener(a,a,this)};
McxRenderer.prototype.paintLayer=function(a,b,c){this.rendererStartEventHandler.dispatchOnSuccess(this,null);var d=!1;null==b&&(d=!0,null!=this.map.getLayers().getLabelCanvas()&&this.map.getLayers().getLabelCanvas().clear(),this.firstPass=!0);null==a&&(a=this.toLayerArray());a instanceof Array||(a=[a]);this.totalProgress=a.length;var e=[];b instanceof Array||(b=[b]);for(var f=0;f<b.length;f++){null!=b[f]&&(b[f]=b[f].transformTo(this.map.getCoordinateSystem()));var g=new McxGrid(this.map,b[f]);g.calculate();
for(var h=0;h<g.cells.length;h++){for(var k=!1,m=0;m<e.length;m++)if(g.cells[h].getIndexX()==e[m].getIndexX()&&g.cells[h].getIndexY()==e[m].getIndexY()){k=!0;break}k||e.push(g.cells[h])}}for(h=0;h<this.canvases.length;h++)for(f=0;f<a.length;f++){b=this.canvases[h].getLayers();g=!1;for(k=0;k<b.length;k++)if(b[k].getUniqueId()==a[f].getUniqueId()){g=!0;break}if(g){d&&!c&&(this.canvases[h].clearCache(),this.canvases[h].clearCanvas());this.canvases[h].getRendererEventHandler().removeListener(this.onRenderFinish);
this.canvases[h].getRendererEventHandler().addListener(this.onRenderFinish,this.onRenderFinish,this);this.canvases[h].paintLayer(e,c);break}}a=this.getSketchCanvas();null!=a&&(a.clear(),c=this.map.getContent().find("#"+this.map.getName()+"_markerContainer")[0],$(c).find(".ContentSymbol").remove(),a=a.getNonLayerDrawContext(),this.drawControllers(a),this.drawMarkers(a));this.paintSelections()};
McxRenderer.prototype.draw=function(a,b,c){function d(){p++;if(p>=2*k.length){for(var a=0;a<q.length;a++)t.drawImage(q[a],0,0);a=new McxRendererEventArgs(McxRendererStatus.End);r.rendererEndEventHandler.dispatchOnSuccess(r,a)}}var e=!1;null==c&&(e=!0,null!=this.map.getLayers().getLabelCanvas()&&this.map.getLayers().getLabelCanvas().clear());null==b&&(b=this.toLayerArray());b instanceof Array||(b=[b]);this.totalProgress=b.length;var f=[];c instanceof Array||(c=[c]);for(var g=0;g<c.length;g++){var h=
new McxGrid(this.map,c[g]);h.calculate();f=f.concat(h.getCells())}for(var k=[],g=0;g<b.length;g++)if(b[g].getVisible())for(c=0;c<this.canvases.length;c++){for(var h=this.canvases[c].getLayers(),m=!1,n=0;n<h.length;n++)if(b[g].getUniqueId()==h[n].getUniqueId()){k.push(this.canvases[c]);m=!0;break}if(m)break}if(0>=k.length)e=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEndEventHandler.dispatchOnSuccess(this,e);else{var p=0,q=[],r=this,t=a.getGeodeticGraphics().getContext();for(c=0;c<
k.length;c++)a=document.createElement("canvas"),q.push(a),b=a.getContext("2d"),b.canvas.width=this.map.getDisplay().getWidth(),b.canvas.height=this.map.getDisplay().getHeight(),a.style.width=b.canvas.width+"px",a.style.height=b.canvas.height+"px",a=a.getContext("2d"),a=new McxDrawContext(this.map,a),k[c].clearCache(),e&&k[c].clearCanvas(),k[c].getRendererEventHandler().addListener(d,d,this),k[c].draw(a,f);for(c=0;c<k.length;c++)a=document.createElement("canvas"),q.push(a),b=a.getContext("2d"),b.canvas.width=
this.map.getDisplay().getWidth(),b.canvas.height=this.map.getDisplay().getHeight(),a.style.width=b.canvas.width+"px",a.style.height=b.canvas.height+"px",a=a.getContext("2d"),a=new McxDrawContext(this.map,a),k[c].clearCache(),e&&k[c].clearCanvas(),k[c].getLabelRendererEventHandler().addListener(d,d,this),k[c].drawLabels(a,f)}};
McxRenderer.prototype.onRenderFinish=function(){this.totalProgress--;if(0==this.totalProgress){var a=new McxRendererEventArgs(McxRendererStatus.End);this.rendererEndEventHandler.dispatchOnSuccess(this,a)}};McxRenderer.prototype.paintLabels=function(){var a=new McxGrid(this.map,null);a.calculate();this.map.getLayers().getLabelCanvas().clear();for(var b=this.map.getLayers(),c=0;c<b.getCount();c++){var d=b.getAt(c);d.getVisible()&&d.isShowLabels()&&d.isSelectable()&&b.getCanvasByIndex(c).paintLabels(a.cells)}};
McxRenderer.prototype.paintSelections=function(){if(null!=this.map.getLayers().getSelectionCanvas()){this.map.getLayers().getSelectionCanvas().clear();for(var a=this.map.getLayers().getSelectionCanvas().getNonLayerDrawContext(),b=0;b<this.canvases.length;b++)this.canvases[b].paintSelection(a)}};
McxRenderer.prototype.paintNonLayer=function(){var a=this.getSketchCanvas();null!=a&&(a.clear(),this.map.getContent().find("#"+this.map.getName()+"_markerContainer"),a=a.getNonLayerDrawContext(),this.drawControllers(a),this.drawMarkers(a))};McxRenderer.prototype.drawMarkers=function(a){this.map.getContent().find("#"+this.map.getName()+"_markerContainer").children().detach();var b=this.map.getMarkerCollection();if(!(0>b.getCount()))for(var c=0;c<b.getCount();c++)b.getMarker(c).paint(a)};
McxRenderer.prototype.drawControllers=function(a){null!=this.map.getInputHandler().getController()&&this.map.getInputHandler().getController().paint(a)};
McxRenderer.prototype.zoomTo=function(a,b,c){var d=this.map.getRestrictedExtend();if(null!=this.map.getScaleSet()&&0!=this.map.getScaleSet().getScaleLength()){if(this._onScale)return;this._onScale=!0;var e=this.mapLastScale;0==e&&(e=this.map.getScale());var f=0,g=this.map.getScaleSet().getSelectedIndex();1<a?(-1==g&&(g=this.getAppropriateZoomLevel(e,!1)),g++):(-1==g&&(g=this.getAppropriateZoomLevel(e,!0)),g--);f=this.map.getScaleSet().getZoomLevelAt(g);a=this.getScale(this.map.getDisplay(),d,this.map.getCoordinateSystem());
null!=this.map.getScaleSet()&&0!=this.map.getScaleSet().getScaleLength()&&(a=this.getAppropriateZoomLevel(a,!0),a<g&&(g=a,f=this.map.getScaleSet().getZoomLevelAt(g)));if(f)this.map.getScaleSet().setSelectedIndex(g),this.mapLastScale=f,a=e/f,clearTimeout(this.alertTimerId);else{this._onScale=!1;return}}if(McxMobile.isMobile.any())this.zoomToMobile(a,b,c);else{var g=this.map.worldToView(b,c),h=this;this.scaleLevel*=a;var e=1/this.scaleLevel,k=this.scaleLevel,f=g.x-this.translateX,g=g.y-this.translateY;
a=new McxPoint(b,c,this.map.getCoordinateSystem());var m=this.map.getWorld().scale(k,a);if(null!=d){var n=a.getX(),p=a.getY();d.getLeft()>m.getLeft()&&(k=(d.getLeft()-n)/(a.left-n),e=1/k);d.getRight()<m.getRight()&&(k=(d.getRight()-n)/(a.right-n),e=1/k);d.getBottom()>m.getBottom()&&(k=(d.getBottom()-p)/(a.bottom-p),e=1/k);d.getTop()<m.getTop()&&(k=(d.getTop()-p)/(a.top-p),e=1/k)}for(d=0;d<this.canvases.length;d++)this.firstPass&&this.canvases[d].clearBackBuffer(),this.canvases[d].paintBackBuffer(),
this.canvases[d].zoomTo(f,g,e);this.labelCanvas.paintBackBuffer();this.labelCanvas.zoomTo(f,g,e);this.firstPass=!1;this.abortRender();this.alertTimerId=setTimeout(function(){h.scaleLevel=1;h.screenXCoord=0;for(var a=h.screenYCoord=0;a<h.canvases.length;a++)h.canvases[a].resetZoomAnimationClass();h.labelCanvas.resetZoomAnimationClass();a=new McxPoint(b,c,h.map.getCoordinateSystem());h.map.getWorld();a=h.map.getWorld().scale(k,a);h.map.setWorld(a.left,a.bottom,a.right,a.top);h.abortRender();for(a=0;a<
h.canvases.length;a++)h.canvases[a].clearCanvas();h._onScale=!1;h.paintLayer(null,null);h.firstPass=!0},500)}};
McxRenderer.prototype.getDeviceScale=function(){if(0!=this.deviceScale)return this.deviceScale;var a=document.getElementsByTagName("body")[0],b=document.createElement("div");b.id="temp";a.appendChild(b);$("#temp").css("width","1in").css("position","fixed");var c=document.defaultView.getComputedStyle(b,null).getPropertyValue("width");a.removeChild(b);return this.deviceScale=1/(parseInt(c,10)/.0254)};
McxRenderer.prototype.getScale=function(a,b,c){var d=this.getDeviceScale();b=a=a.getWidth()*d/b.getWidth();null!=c&&(b=a/c.getDistancePerUnit());return b};McxRenderer.prototype.getAppropriateZoomLevel=function(a,b){for(var c=Number.MAX_VALUE,d=-1,e=this.map.getScaleSet(),f=0;f<e.getScaleLength();f++){var g=e.getZoomLevelAt(f)-a;if(g<c&&0<g&&b||g<c&&0>g&&!b)c=g,d=f}return d};
McxRenderer.prototype.zoomToMobile=function(a,b,c){clearTimeout(this.alertTimerId);var d=this.map.worldToView(b,c),e=this;this.scaleLevel*=a;a=1/this.scaleLevel;var f=this.scaleLevel,g=d.x-this.translateX,d=d.y-this.translateY,h=new McxPoint(b,c,this.map.getCoordinateSystem()),k=this.map.getWorld().scale(f,h),m=this.map.getRestrictedExtend();if(null!=m){var n=h.getX(),p=h.getY();m.getLeft()>k.getLeft()&&(f=(m.getLeft()-n)/(h.left-n),a=1/f);m.getRight()<k.getRight()&&(f=(m.getRight()-n)/(h.right-n),
a=1/f);m.getBottom()>k.getBottom()&&(f=(m.getBottom()-p)/(h.bottom-p),a=1/f);m.getTop()<k.getTop()&&(f=(m.getTop()-p)/(h.top-p),a=1/f)}for(h=0;h<this.canvases.length;h++)this.canvases[h].clearBackBuffer(),this.canvases[h].paintBackBuffer(),this.canvases[h].zoomTo(g,d,a);this.labelCanvas.paintBackBuffer();this.labelCanvas.zoomTo(g,d,a);this.firstPass=!1;this.alertTimerId=setTimeout(function(){var a=new McxPoint(b,c,e.map.getCoordinateSystem());e.map.getWorld();a=e.map.getWorld().scale(f,a);e.map.setWorld(a.left,
a.bottom,a.right,a.top);for(var d=0;d<e.canvases.length;d++)e.canvases[d].clearCanvas();e.map.setWorld(a.left,a.bottom,a.right,a.top);e.map.getRenderer().paintLayer(null,null);e.paintLayer(null,null);e.firstPass=!0;e.scaleLevel=1},500)};
McxRenderer.prototype.zoomBackBufferToMobile=function(a,b,c){c=this.map.worldToView(b,c);this.scaleLevel=a;a=1/this.scaleLevel;b=c.x-this.translateX;c=c.y-this.translateY;for(var d=0;d<this.canvases.length;d++)this.canvases[d].clearBackBuffer(),this.canvases[d].paintBackBuffer(),this.canvases[d].zoomTo(b,c,a);this.labelCanvas.paintBackBuffer();this.labelCanvas.zoomTo(b,c,a);this.firstPass=!1};McxRenderer.prototype.getCount=function(){return this.canvases.length};McxRenderer.prototype.getAt=function(a){return this.canvases[a].getLayers()[0]};
McxRenderer.prototype.add=function(a){this.insert(this.canvases.length,a);if(null==this.activeLayer||a.isInstanceOf("McxMemLayer"))this.activeLayer=a,this.activeLayerChanged.dispatchOnSuccess(this,new McxEventArgs(null))};McxRenderer.prototype.getActiveLayer=function(){return this.activeLayer};McxRenderer.prototype.setActiveLayer=function(a){this.activeLayer=a;this.activeLayerChanged.dispatchOnSuccess(this,new McxEventArgs(null))};
McxRenderer.prototype.insert=function(a,b){var c=this.map.getDisplay().getWidth(),d=this.map.getDisplay().getHeight(),e=this.map.getWorld().getWidth(),f=this.map.getWorld().getHeight(),g=!1;0>=this.canvases.length&&0==e&&0==f&&(g=!0);null==this.map.getCoordinateSystem()&&0==this.canvases.length&&this.map.setCoordinateSystem(b.getCoordinateSystem());null==this.sketchCanvas&&(e=this.map.getName()+"_markerContainer",f=this.map.getContent().find("#"+e),0==f.length&&(f=$("<div/>").attr("id",e).css("position",
"relative").css("width","100%").css("z-index",1001).css("height","100%")),this.map.getContent().append(f),this.sketchCanvas=new McxNonLayerCanvas(this.map,1E3),this.sketchCanvas.setDisplay(c,d));null==this.labelCanvas&&(this.labelCanvas=new McxLabelCanvas(this.map),this.labelCanvas.setDisplay(c,d));null==this.selectionCanvas&&(this.selectionCanvas=new McxNonLayerCanvas(this.map,998),this.selectionCanvas.setDisplay(c,d));if(a>this.canvases.length){for(f=e=0;f<this.canvases.length;f++)e+=this.canvases[f].getLayers().length;
a=e}e=null;for(f=0;f<this.canvases.length;f++)if(this.canvases[f].canAddLayer(b)){this.canvases[f].addLayer(b);if(g){c=new McxAjaxParameter;c.setAsync(!1);c=b.getEnvelope(c);c=c.getEnvelope();if(null==c){this.layerAdded.dispatchOnSuccess(this,new McxLayerEventArgs(b));return}c=c.transformTo(this.map.getCoordinateSystem());this.map.setWorld(c.getLeft(),c.getBottom(),c.getRight(),c.getTop())}this.layerAdded.dispatchOnSuccess(this,new McxLayerEventArgs(b));return}for(f=0;f<this.canvasProviders.length&&
(e=this.canvasProviders[f].createCanvas(b,this.map),null==e||(e.isInstanceOf("McxFsCanvas")?e.setLabelCanvas(this.labelCanvas):e.isInstanceOf("McxMemCanvas")?e.setLabelCanvas(this.labelCanvas):e.isInstanceOf("McxFsCollectionCanvas")?e.setLabelCanvas(this.labelCanvas):e.isInstanceOf("McxClusterCanvas")&&e.setLabelCanvas(this.labelCanvas),null==e));f++);if(null!=e){e.translate(-1*this.translateX*this.map.getPixelScale(),this.translateY*this.map.getPixelScale());e.setDisplay(c,d);a>=this.canvases.length?
this.canvases.push(e):this.canvases.splice(a,0,e);if(g){c=new McxAjaxParameter;c.setAsync(!1);c=b.getEnvelope(c);c=c.getEnvelope();if(null==c){this.layerAdded.dispatchOnSuccess(this,new McxLayerEventArgs(b));return}c=c.transformTo(this.map.getCoordinateSystem());this.map.setWorld(c.getLeft(),c.getBottom(),c.getRight(),c.getTop())}this.layerAdded.dispatchOnSuccess(this,new McxLayerEventArgs(b))}};
McxRenderer.prototype.removeAt=function(a){this.canvases[a].dispose();var b=this.canvases[a].getLayer();this.canvases.splice(a,1);b.getUniqueId()==this.activeLayer.getUniqueId()&&(this.activeLayer=0==this.canvases.length?null:this.canvases[0].getLayer(),this.activeLayerChanged.dispatchOnSuccess(this,new McxEventArgs(null)));this.layerRemoved.dispatchOnSuccess(this,new McxLayerEventArgs(b))};
McxRenderer.prototype.remove=function(a){for(var b=0;b<this.canvases.length;b++)for(var c=this.canvases[b].getLayers(),d=0;d<c.length;d++)if(c[d].getUniqueId()==a.getUniqueId())return this.canvases[b].remove(a),mcx.isInstanceOf(this.canvases[b],McxFsCollectionCanvas)?0==this.canvases[b].getLayers().length&&(this.canvases[b].dispose(),this.canvases.splice(b,1)):this.canvases.splice(b,1),a.getUniqueId()==this.activeLayer.getUniqueId()&&(this.activeLayer=0==this.canvases.length?null:this.canvases[0].getLayers()[0],
this.activeLayerChanged.dispatchOnSuccess(this,new McxEventArgs(null))),this.layerRemoved.dispatchOnSuccess(this,new McxLayerEventArgs(a)),!0;return!0};McxRenderer.prototype.indexOf=function(a){for(var b=0,c=0;c<this.canvases.length;c++)for(var d=this.canvases[c].getLayers(),e=0;e<d.length;e++){if(d[e].getUniqueId()==a.getUniqueId())return b;b++}return-1};McxRenderer.prototype.onLayerAdded=function(){return this.layerAdded};McxRenderer.prototype.onLayerRemoved=function(){return this.layerRemoved};
McxRenderer.prototype.onActiveLayerChanged=function(){return this.activeLayerChanged};McxRenderer.prototype.changeOrder=function(a,b){var c=a.getOrder(),d,e=this.map.getLayers().toLayerArray();b!=c&&(a.setOrder(b),e.splice(c,1),c=e.slice(0,b),e=e.slice(b),c.push(a),d=$.merge(c,e));this.adjustOrder(d);this.getLayerOrderChangeHandler().dispatchOnSuccess(this,null)};McxRenderer.prototype.getCanvasByIndex=function(a){return this.canvases[a]};McxRenderer.prototype.getSketchCanvas=function(){return this.sketchCanvas};
McxRenderer.prototype.getLabelCanvas=function(){return this.labelCanvas};McxRenderer.prototype.getSelectionCanvas=function(){return this.selectionCanvas};McxRenderer.prototype.getCanvasByLayer=function(a){for(var b=0;b<this.canvases.length;b++){for(var c=this.canvases[b].getLayers(),d=!1,e=0;e<c.length;e++)if(c[e].getUniqueId()==a.getUniqueId()){d=!0;break}if(d)return this.canvases[b]}return null};McxRenderer.prototype.removeCanvas=function(a){a=document.getElementById(a);a.parentNode.removeChild(a)};
McxRenderer.prototype.adjustOrder=function(a){a||(a=this.map.getLayers().toLayerArray());for(var b=0;b<a.length;b++){var c=this.getCanvasByLayer(a[b]);mcx.isInstanceOf(c,McxFsCollectionCanvas)?c.setOrder(a[b].getOrder(),a[b]):c.setOrder(a[b].getOrder())}};McxRenderer.prototype.toLayerArray=function(){for(var a=[],b=0;b<this.canvases.length;b++)a=a.concat(this.canvases[b].getLayers());return a=a.sort(function(a,b){return a.getOrder()-b.getOrder()})};
McxRenderer.prototype.abortRender=function(){for(var a=0;a<this.canvases.length;a++)this.canvases[a].abortRender();this.totalProgress=0;a=new McxRendererEventArgs(McxRendererStatus.Canceled);this.rendererEndEventHandler.dispatchOnSuccess(this,a)};McxRenderer.prototype.getRendererStartEventHandler=function(){return this.rendererStartEventHandler};McxRenderer.prototype.getRendererEndEventHandler=function(){return this.rendererEndEventHandler};
McxRenderer.prototype.addCanvasProvider=function(a){var b=[];b.push(a);this.canvasProviders=b=b.concat(this.canvasProviders);return!0};McxRenderer.prototype.removeCanvasProvider=function(a){for(var b=0;b<this.canvasProviders.length;b++)if(this.canvasProviders[b]==a){this.canvasProviders.splice(b,1);break}};
McxRenderer.prototype.setZoomAnimationClass=function(a){if(this.animationClass!=a){this.animationClass=a;for(var b=0;b<this.canvases.length;b++)this.canvases[b].setZoomAnimationClass(this.animationClass);this.labelCanvas.setZoomAnimationClass(this.animationClass);this.setPanAnimationClass(a)}};McxRenderer.prototype.setPanAnimationClass=function(a){var b=$("#"+this.map.getName()+"_layerContainer");b.removeClass();this.panAnimationClass=a;b.addClass(a)};McxRenderer.prototype.getZoomAnimationClass=function(){return this.animationClass};
McxRenderer.prototype.getPanAnimationClass=function(){return this.panAnimationClass};
McxRenderer.prototype.translate=function(a,b,c){if(!isNaN(a)&&!isNaN(b)){var d=this.map.getRestrictedExtend();null!=d&&(d.getLeft()>this.map.getWorld().left+a&&(a=d.getLeft()-this.map.getWorld().left),d.getRight()<this.map.getWorld().right+a&&(a=d.getRight()-this.map.getWorld().right),d.getBottom()>this.map.getWorld().bottom+b&&(b=d.getBottom()-this.map.getWorld().bottom),d.getTop()<this.map.getWorld().top+b&&(b=d.getTop()-this.map.getWorld().top));for(var e=this.map.getPixelScale(),d=a/e*-1,e=b/
e,f=0;f<this.canvases.length;f++)this.canvases[f].translate(a,b);null!=this.labelCanvas&&this.labelCanvas.translate(a,b);this.map.setWorld(this.map.getWorld().left+a,this.map.getWorld().bottom+b,this.map.getWorld().right+a,this.map.getWorld().top+b);this.translateX+=d;this.translateY+=e;a=$("#"+this.map.getName()+"_layerContainer");!this.animationActive||!McxMobile.isMobile.iOS()&&McxMobile.isMobile.any()||(c?(c="0.5s",a.css("transition-duration",c).css("-webkit-transition-duration",c).css("-moz-transition-duration",
c).css("-ms-transition-duration",c).css("-o-transition-duration",c),this.durationChanged=!0):this.durationChanged&&(c="0s",a.css("transition-duration",c).css("-webkit-transition-duration",c).css("-moz-transition-duration",c).css("-ms-transition-duration",c).css("-o-transition-duration",c),this.durationChanged=!1));a.css("-webkit-transform","translate3d("+this.translateX+"px, "+this.translateY+"px, 0)").css("-moz-transform","translate3d("+this.translateX+"px, "+this.translateY+"px,0)").css("-ms-transform",
"translate3d("+this.translateX+"px, "+this.translateY+"px,0)").css("-o-transform","translate3d("+this.translateX+"px, "+this.translateY+"px,0)").css("transform","translate3d("+this.translateX+"px, "+this.translateY+"px,0)")}};McxRenderer.prototype.setLayerOpacity=function(a,b){this.getCanvasByLayer(a).setOpacity(b,a)};McxRenderer.prototype.clearBackBuffer=function(){for(var a=0;a<this.canvases.length;a++)this.canvases[a].clearBackBuffer()};McxRenderer.prototype.getLayerOrderChangeHandler=function(){return this.onLayerOrderChangeHandler};
McxRenderer.prototype.addCanvas=function(a){a.translate(-1*this.translateX*this.map.getPixelScale(),this.translateY*this.map.getPixelScale());var b=this.map.getDisplay().getWidth(),c=this.map.getDisplay().getHeight(),d=this.map.getWorld().getWidth(),e=this.map.getWorld().getHeight(),f=!1,g=a.getLayers();if(0==g.length)console.log("canvas layer length zero");else{0>=this.canvases.length&&0==d&&0==e&&(f=!0);null!=g&&null==this.map.getCoordinateSystem()&&0==this.canvases.length&&this.map.setCoordinateSystem(g[0].getCoordinateSystem());
null==this.sketchCanvas&&(d=this.map.getName()+"_markerContainer",e=$("#"+d),0==e.length&&(e=$("<div/>").attr("id",d).css("position","relative").css("width","100%").css("z-index",1001).css("height","100%")),this.map.getContent().append(e),this.sketchCanvas=new McxNonLayerCanvas(this.map,1E3),this.sketchCanvas.setDisplay(b,c));null==this.labelCanvas&&(this.labelCanvas=new McxLabelCanvas(this.map),this.labelCanvas.setDisplay(b,c));null==this.selectionCanvas&&(this.selectionCanvas=new McxNonLayerCanvas(this.map,
998),this.selectionCanvas.setDisplay(b,c));d=this.canvases.length;a.setDisplay(b,c);d>=this.canvases.length?this.canvases.push(a):this.canvases.splice(d,0,a);if(f){a=new McxAjaxParameter;a.setAsync(!1);a=g[0].getEnvelope(a).getEnvelope();if(null==a){this.layerAdded.dispatchOnSuccess(this,new McxLayerEventArgs(g[0]));return}this.map.setWorld(a.getLeft(),a.getBottom(),a.getRight(),a.getTop())}null!=g[0]&&this.layerAdded.dispatchOnSuccess(this,new McxLayerEventArgs(g[0]));this.adjustOrder(null)}};
McxRenderer.prototype.isAnimationActive=function(){return this.animationActive};McxRenderer.prototype.setAnimationActive=function(a){$("#"+this.map.getName()+"_layerContainer").css("transition-duration","0s").css("-webkit-transition-duration","0s").css("-moz-transition-duration","0s").css("-ms-transition-duration","0s").css("-o-transition-duration","0s");this.animationActive=a};js.framework.mapping.McxCanvas.McxVectorMemCanvas={};
function McxVectorMemCanvas(a,b){this.layer=a;this.map=b;this.paintedFeatures=new McxPaintedFeatures(15E3);this.paintedCells=[];this.isDirty=!1;this.selectionSymbolizer=new McxCompositeSymbolizer;this.layerId=McxGuid.createGuid();this.canvasId=McxGuid.createGuid();this.height=this.width=0;this.labelCanvas=null;this.zIndex=this.map.getLayers().getCount()+1;this.translateY=this.translateX=0;this.drawContextToAnotherTarget=null;this.requests=[];this.requestsCanceled=!1;this.totalLabelRequestCount=this.totalRequestCount=
0;this.painterMode=McxPainterMode.ByLayer;this.rendererEventHandler=new McxEventHandler;this.labelRendererEventHandler=new McxEventHandler;this.backBuffered=!0;this.base=this;this.initialize()}McxVectorMemCanvas.prototype.initialize=function(){this.setUpHtmlElements();this.setUpSymbolizers();this.setOpacity(this.layer.getOpacity());this.map.getResizeEventHandler().removeListener(this.onDisplayChanged);this.map.getResizeEventHandler().addListener(this.onDisplayChanged,null,this)};
McxVectorMemCanvas.prototype.setUpSymbolizers=function(){var a=new McxFill;a.setColor("blue");a.setOpacity(.2);var b=new McxStroke;b.setColor("blue");b.setWidth(3);var c=new McxPointSymbolizer,d=new McxCircleMark,a=new McxFill;a.setColor("blue");a.setOpacity(.2);var e=a.clone();e.setOpacity(1);d.setFill(e);d.setStroke(b);c.setSymbols([d]);this.selectionSymbolizer.setPointSymbolizer(c);c=new McxLineSymbolizer;c.setStroke(b);this.selectionSymbolizer.setLineSymbolizer(c);c=new McxPolygonSymbolizer;c.setStroke(b);
c.setFill(a);this.selectionSymbolizer.setPolygonSymbolizer(c)};
McxVectorMemCanvas.prototype.setUpHtmlElements=function(){var a=$("<div/>").css("position","absolute").css("zIndex",this.zIndex).attr("id",this.layerId).addClass(""),b=$("<div/>").css("position","absolute").css("zIndex",this.zIndex).css("opacity",1).attr("id",this.layerId+"_divContainer").addClass(""),c=$("<div/>").css("position","absolute").css("zIndex",this.zIndex+1).attr("id",this.layerId+"_zoom").addClass(this.map.getRenderer().getZoomAnimationClass()),d=this.map.getContent().find("#"+this.map.getName()+
"_layerContainer");$(d).append(a);$(a).append(b);$(a).append(c)};McxVectorMemCanvas.prototype.canAddLayer=function(a){return!0};McxVectorMemCanvas.prototype.addLayer=function(a){};McxVectorMemCanvas.prototype.getLayers=function(){return[this.layer]};
McxVectorMemCanvas.prototype.onSearchSuccess=function(a){if(null!=this.drawContextToAnotherTarget)this.drawModeOnSearchSuccess(a);else{var b=a.getFeatureReader(),c=a.getArgs()[2],d=c.getDisplay(),e=a.getArgs()[3],f=e.getMap().getPixelScale();a=a.getArgs()[4];if(0!=Math.abs(f-a))this.totalRequestCount--,0==this.totalRequestCount&&this.rendererEventHandler.dispatchOnSuccess(this,null);else{var f=c.getWorld(),g=a=e.getMap().getWorld(),g=e.getLayers()[0].getCoordinateSystem(),g=null==a.getCoordinateSystem()||
a.getCoordinateSystem().equals(g)?a:a.transformTo(g);if(g.intersectsBounds(f)){if(f=this.canvasId+"-"+c.getIndexX()+"-"+c.getIndexY(),(a=this.map.getContent().find("#"+f))&&null!=a&&$(a).remove(),a=document.createElement("canvas"),a.id=f,a.style.position="absolute",a.setAttribute("height",(Math.floor(d.getHeight())+2).toString()+"px"),a.setAttribute("width",(Math.floor(d.getWidth())+2).toString()+"px"),a.globalCompositeOperation="source-over",f=this.map.getContent().find("#"+this.layerId+"_divContainer")[0],
null!=f){var g=(d.getLeft()-this.translateX).toString(),h=(d.getBottom()-this.translateY).toString();$(a).css("-webkit-transform","translate3d("+g+"px, "+h+"px,0px)").css("-moz-transform","translate3d("+g+"px, "+h+"px,0px)").css("-ms-transform","translate3d("+g+"px, "+h+"px,0px)").css("-o-transform","translate3d("+g+"px, "+h+"px,0px)").css("transform","translate3d("+g+"px, "+h+"px,0px)");f.appendChild(a);f=!1;g=new McxDrawContext(this.map,a.getContext("2d"));a=[];h=!0;this.layer.isShowLabels()?this.map.inVisibleRange(this.layer.getMinLabelScale(),
this.layer.getMaxLabelScale())||(h=!1):h=!1;for(g.getGeodeticGraphics().setContentDiv(this.base.contentDiv);b.read();){if(e.requestsCanceled){this.totalRequestCount=0;return}var k=b.getCurrent();if(k&&k.getGeometry()){e.getPaintedFeatures().addFeature(k.getFeatureID(),k.getGeometry());var m=this.getAppropriatePainter(k);null!=m&&(m.paint(g,k,d.getLeft(),d.getBottom()),f=!0,h&&(m=this.layer.labelOf(k),k=k.getGeometry().getBounds().getCentroid(),k.setCoordinateSystem(this.layer.getCoordinateSystem()),
k=k.transformTo(this.map.getCoordinateSystem()),k=this.map.worldToView(k.x,k.y),m=new McxLabel(k.x,k.y,m,0),a.push(m)))}}this.totalRequestCount--;0==this.totalRequestCount&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,b));f&&(b=c.getIndexX().toString()+" "+c.getIndexY().toString(),this.paintedCells.push(b));this.labelCanvas.drawLabels(c.getDisplay(),c.getWorld(),this.layer,a)}}else this.totalRequestCount--,0==this.totalRequestCount&&(b=new McxRendererEventArgs(McxRendererStatus.End),
this.rendererEventHandler.dispatchOnSuccess(this,b))}}};
McxVectorMemCanvas.prototype.drawModeOnSearchSuccess=function(a){var b=a.getFeatureReader(),c=a.getArgs()[2];a=a.getArgs()[3];var c=c.getWorld(),d=a.getMap().getWorld(),e=d,e=a.getLayers()[0].getCoordinateSystem(),e=null==d.getCoordinateSystem()||d.getCoordinateSystem().equals(e)?d:d.transformTo(e);if(e.intersectsBounds(c))for(;b.read();)(c=b.getCurrent())&&c.getGeometry()&&(a.getPaintedFeatures().addFeature(c.getFeatureID(),c.getGeometry()),d=this.getAppropriatePainter(c),null!=d&&d.paint(this.drawContextToAnotherTarget,
c,0,0));this.totalRequestCount--;0==this.totalRequestCount&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,b))};
McxVectorMemCanvas.prototype.paintLayer=function(a,b){this.animateFadeEffect();var c=function(a){this.totalRequestCount--;0==this.totalRequestCount&&(a=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,a))};if(null!=this.drawContextToAnotherTarget||this.map.inVisibleRange(this.layer.getMinScale(),this.layer.getMaxScale()))if(this.abortRender(),this.requestsCanceled=!1,this.isDirty&&(this.clearCanvas(),this.isDirty=!1),this.layer.getVisible()){var d=this.layer.getKeyField()+
","+this.layer.getGeometryField(),e=this.map.getPixelScale(),f,g=f=this.map.getWorld();null==this.map.getCoordinateSystem()||g.getCoordinateSystem().equals(this.layer.getCoordinateSystem())||(f=g.transformTo(this.layer.getCoordinateSystem()));if(this.layer.isSingleTile())this.totalRequestCount=1,g=new McxCell(0,0,f,this.map.getDisplay()),f=[],f.push(this.map.getWorld()),f.push(this.map.getDisplay()),f.push(g),f.push(this),f.push(e),e=new McxAjaxParameter,e.setParameters(this,this.onSearchSuccess,
c),e.setArgs(f),this.totalRequestCount=1,f=this.layer.searchByEnvelope(d,"",g.getWorld(),"Intersects",e),this.requests.push(f);else for(this.totalRequestCount=a.length,g=0;g<a.length;g++){f=null;var h=this.transformCellToTarget(a[g],this.layer.getCoordinateSystem());f=a[g].getIndexX().toString()+" "+a[g].getIndexY().toString();if(!(!this.layer.isSingleTile()&&-1<this.paintedCells.indexOf(f)&&b)){this.paintedCells.push(f);f=[];f.push(this.map.getWorld());f.push(this.map.getDisplay());f.push(h);f.push(this);
f.push(e);var k=new McxAjaxParameter;k.setParameters(this,this.onSearchSuccess,c);k.setArgs(f);f=this.layer.searchByEnvelope(d,"",h.getWorld(),"Intersects",k);this.requests.push(f)}}}else this.clearCanvas(),this.clearBackBuffer();else this.clearCanvas(),c=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,c)};McxVectorMemCanvas.prototype.draw=function(a,b){this.drawContextToAnotherTarget=a;this.paintLayer(b)};
McxVectorMemCanvas.prototype.drawLabels=function(a,b){var c,d=c=this.map.getWorld();null==this.map.getCoordinateSystem()||d.getCoordinateSystem().equals(this.layer.getCoordinateSystem())||(c=d.transformTo(this.layer.getCoordinateSystem()));this.totalLabelRequestCount=b.length;for(d=0;d<b.length;d++){var e=this.transformCellToTarget(b[d],this.layer.getCoordinateSystem());this.drawLabelsOfCellOnContext(a,e.getWorld(),c,this.map.getDisplay(),e.getDisplay())}};
McxVectorMemCanvas.prototype.onLabelSearchSuccess=function(a){var b=a.getArgs()[0],c=a.getArgs()[1];a=a.getLabelReader();for(var d=[];a.read();){var e=a.getCurrent();d.push(e)}0>=d.length||this.labelCanvas.drawLabels(b,c,this.base.layer,d)};
McxVectorMemCanvas.prototype.onLabelSearchSuccessOnContext=function(a){a.getArgs();a.getArgs();var b=a.getArgs()[2],c=a.getLabelReader();for(a=[];c.read();){var d=c.getCurrent();a.push(d)}if(!(0>=a.length)){c=this.map.getPixelScale();null!=this.map.getCoordinateSystem()&&(c*=this.map.getCoordinateSystem().getDistancePerUnit());c=this.layer.isScaledLabels()?1/c:1;b.getGeodeticGraphics().useTransform(!1);for(d=0;d<a.length;d++){var e=new McxPoint(a[d].getX(),a[d].getY(),null),f=a[d].getAngle();f&&0!=
f&&this.layer.getLabelSymbolizer().setRotation(f);b.getGeodeticGraphics().drawText(a[d].getValue(),e,this.layer.getLabelSymbolizer(),c,0,0)}b.getGeodeticGraphics().useTransform(!0)}this.totalLabelRequestCount--;0==this.totalLabelRequestCount&&this.labelRendererEventHandler.dispatchOnSuccess(this,null)};
McxVectorMemCanvas.prototype.onMemLabelSearchSuccessOnContext=function(a){a.getArgs();a.getArgs();var b=a.getArgs()[2],c=a.getFeatureReader();for(a=[];c.read();){var d=c.getCurrent(),e=this.layer.labelOf(d),d=d.getGeometry().getBounds().getCentroid();d.setCoordinateSystem(this.layer.getCoordinateSystem());d=d.transformTo(this.map.getCoordinateSystem());d=this.map.worldToView(d.x,d.y);e=new McxLabel(d.x,d.y,e,0);a.push(e)}if(!(0>=a.length)){c=this.map.getPixelScale();null!=this.map.getCoordinateSystem()&&
(c*=this.map.getCoordinateSystem().getDistancePerUnit());c=this.layer.isScaledLabels()?1/c:1;b.getGeodeticGraphics().useTransform(!1);for(e=0;e<a.length;e++){var d=new McxPoint(a[e].getX(),a[e].getY(),null),f=a[e].getAngle();f&&0!=f&&this.layer.getLabelSymbolizer().setRotation(f);b.getGeodeticGraphics().drawText(a[e].getValue(),d,this.layer.getLabelSymbolizer(),c,0,0)}b.getGeodeticGraphics().useTransform(!0)}this.totalLabelRequestCount--;0==this.totalLabelRequestCount&&this.labelRendererEventHandler.dispatchOnSuccess(this,
null)};McxVectorMemCanvas.prototype.drawLabelsOfCell=function(a,b,c,d){if(this.layer.isShowLabels()&&this.map.inVisibleRange(this.layer.getMinLabelScale(),this.layer.getMaxLabelScale())){d=new McxAjaxParameter;d.setParameters(this,this.onLabelSearchSuccess,null);d.setArgs([c,b]);var e=this.layer.getFilterCollection().toString();a=this.layer.fastSearch("",e,this.layer.getLabelFormat(),a,b,c,d);this.requests.push(a)}};
McxVectorMemCanvas.prototype.drawLabelsOfCellOnContext=function(a,b,c,d,e){if(this.layer.isShowLabels())if(null==this.drawContextToAnotherTarget||this.map.inVisibleRange(this.base.layer.getMinLabelScale(),this.base.layer.getMaxLabelScale())){var f=new McxAjaxParameter;f.setParameters(this,this.onLabelSearchSuccessOnContext,null);f.setArgs([e,c,a]);a=this.layer.getFilterCollection().toString();this.layer.isInstanceOf("McxMemLayer")?(f.setParameters(this,this.onMemLabelSearchSuccessOnContext,null),
b=this.layer.searchByEnvelope(a,"",b,"Intersects",f)):b=this.layer.fastSearch(a,"",this.layer.getLabelFormat(),b,c,d,f);this.requests.push(b)}else this.totalLabelRequestCount--,0==this.totalLabelRequestCount&&this.labelRendererEventHandler.dispatchOnSuccess(this,null);else this.totalLabelRequestCount--,0==this.totalLabelRequestCount&&this.labelRendererEventHandler.dispatchOnSuccess(this,null)};
McxVectorMemCanvas.prototype.paintLabels=function(a){var b=this.map.getWorld();null==this.map.getCoordinateSystem()||b.getCoordinateSystem().equals(this.layer.getCoordinateSystem())||b.transformTo(this.layer.getCoordinateSystem());this.paintLayer(a)};McxVectorMemCanvas.prototype.transformCellToTarget=function(a,b){if(null==this.map.getCoordinateSystem()||null==b||this.map.getCoordinateSystem().equals(b))return a;var c=a.getWorld().transformTo(b);return new McxCell(a.getIndexX(),a.getIndexY(),c,a.getDisplay())};
McxVectorMemCanvas.prototype.abortRender=function(){this.requestsCanceled=!0;for(var a=0;a<this.requests.length;a++)this.requests[a].abort(),a==this.requests.length-1&&(this.requests=[]);this.requests=[]};McxVectorMemCanvas.prototype.onDisplayChanged=function(){this.isDirty=!0;this.width=this.map.getDisplay().getWidth();this.height=this.map.getDisplay().getHeight()};McxVectorMemCanvas.prototype.setDisplay=function(a,b){this.isDirty=!0;this.width=a;this.height=b};
McxVectorMemCanvas.prototype.getPaintedFeatures=function(){return this.paintedFeatures};McxVectorMemCanvas.prototype.clearCache=function(){this.paintedFeatures.clear();this.paintedCells=[]};McxVectorMemCanvas.prototype.getMap=function(){return this.map};
McxVectorMemCanvas.prototype.getAppropriatePainter=function(a){var b=null,c=a.getSymbolizer();if(null==c)var d=a.getLayer().getSymbolizer();var e=a.getGeometry();if(!e)return null;e.isInstanceOf(McxGeometryType.Point)?(b=new McxPointPainter,null==c?b.setSymbolizer(d.getPointSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.LineString)?(b=new McxLineStringPainter,null==c?b.setSymbolizer(d.getLineSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.Polygon)?(b=new McxPolygonPainter,
null==c?b.setSymbolizer(d.getPolygonSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiPoint)?(b=new McxMultiPointPainter,null==c?b.setSymbolizer(d.getPointSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiLineString)?(b=new McxMultiLinePainter,null==c?b.setSymbolizer(d.getLineSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiPolygon)&&(b=new McxMultiPolygonPainter,null==c?b.setSymbolizer(d.getPolygonSymbolizer()):b.setSymbolizer(c));if(null!=
b){c=null;d=a.getLayer().getSubtypes();for(e=0;e<d.length;e++){var f=d[e];if(!f.isVisible())return null;f.run(a)&&(c=f.getSymbolizer())}d=a.getSymbolizer();if(b.isInstanceOf("McxPointPainter")||b.isInstanceOf("McxMultiPointPainter"))null!=d&&d.isInstanceOf("IMcxPointSymbolizer")&&this.layer.getPainterMode()==McxPainterMode.ByFeature?b.setSymbolizer(d):null!=d&&d.isInstanceOf("IMcxTextSymbolizer")&&this.layer.getPainterMode()==McxPainterMode.ByFeature?b.setSymbolizer(d):null!=c&&null!=c.getPointSymbolizer()?
b.setSymbolizer(c.getPointSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getPointSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getPointSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultPointSymbolizer());else if(b.isInstanceOf("McxLineStringPainter")||b.isInstanceOf("McxMultiLinePainter"))null!=d&&d.isInstanceOf("IMcxLineSymbolizer")&&this.layer.getPainterMode()==McxPainterMode.ByFeature?b.setSymbolizer(a.getSymbolizer()):null!=
c&&null!=c.getLineSymbolizer()?b.setSymbolizer(c.getLineSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getLineSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getLineSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultLineSymbolizer());else if(b.isInstanceOf("McxPolygonPainter")||b.isInstanceOf("McxMultiPolygonPainter"))null!=d&&d.isInstanceOf("IMcxPolygonSymbolizer")&&this.layer.getPainterMode()==McxPainterMode.ByFeature?b.setSymbolizer(d):
null!=c&&null!=c.getPolygonSymbolizer()?b.setSymbolizer(c.getPolygonSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getPolygonSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getPolygonSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultPolygonSymbolizer())}return b};
McxVectorMemCanvas.prototype.paintSelection=function(a){if(this.layer.isInstanceOf("IMcxSelectableLayer")&&this.layer.getVisible()&&this.map.inVisibleRange(this.layer.getMinScale(),this.layer.getMaxScale())&&0!=this.layer.getSelectionCount())for(var b=this.layer.getSelection();b.read();){var c=b.getCurrent(),d=this.getAppropriatePainter(c);(c.getGeometry().isInstanceOf(McxGeometryType.Polygon)||c.getGeometry().isInstanceOf(McxGeometryType.MultiPolygon))&&d.setSymbolizer(this.selectionSymbolizer.getPolygonSymbolizer());
(c.getGeometry().isInstanceOf(McxGeometryType.LineString)||c.getGeometry().isInstanceOf(McxGeometryType.MultiLineString))&&d.setSymbolizer(this.selectionSymbolizer.getLineSymbolizer());(c.getGeometry().isInstanceOf(McxGeometryType.Point)||c.getGeometry().isInstanceOf(McxGeometryType.MultiPoint))&&d.setSymbolizer(this.selectionSymbolizer.getPointSymbolizer());null!=d&&d.paint(a,c,0,0)}};McxVectorMemCanvas.prototype.setLabelCanvas=function(a){this.labelCanvas=a};
McxVectorMemCanvas.prototype.isInstanceOf=function(a){return"McxVectorMemCanvas"==a};McxVectorMemCanvas.prototype.clearCanvas=function(){$("#"+this.layerId+"_divContainer").empty()};
McxVectorMemCanvas.prototype.zoomTo=function(a,b,c){var d=$("#"+this.layerId+"_zoom");d.css("-webkit-transform-origin",a+"px "+b+"px").css("-moz-transform-origin",a+"px "+b+"px").css("-ms-transform-origin",a+"px "+b+"px").css("-o-transform-origin",a+"px "+b+"px").css("transform-origin",a+"px "+b+"px");d[0].style.transition="all 200ms cubic-bezier(0,1.12,.3,.11) 0";d.css("-webkit-transform","scale("+c+")").css("-moz-transform","scale("+c+")").css("-ms-transform","scale("+c+")").css("-o-transform",
"scale("+c+")").css("transform","scale("+c+")");d[0].style.transition=""};McxVectorMemCanvas.prototype.dispose=function(){$("#"+this.layerId).remove()};McxVectorMemCanvas.prototype.translate=function(a,b){0!=this.map.getPixelScale()&&(this.translateX+=-1*a/this.map.getPixelScale(),this.translateY+=b/this.map.getPixelScale())};McxVectorMemCanvas.prototype.resetTranslation=function(){this.translateY=this.translateX=0};
McxVectorMemCanvas.prototype.clearBackBuffer=function(){$("#"+this.layerId+"_zoom").empty();$("#"+this.layerId+"_backBuffer").empty();console.log(this.layerId+" clear backbuffer")};McxVectorMemCanvas.prototype.paintBackBuffer=function(){$("#"+this.layerId+"_divContainer").children("*").appendTo("#"+this.layerId+"_zoom")};McxVectorMemCanvas.prototype.setZoomAnimationClass=function(a){var b=$("#"+this.layerId+"_zoom");b.removeClass();b.addClass(a)};
McxVectorMemCanvas.prototype.resetZoomAnimationClass=function(){if(this.base.layer.getPainterMode()!=McxPainterMode.ByImage){var a=$("#"+this.layerId+"_zoom");setTimeout(function(){a.empty();a.css("-webkit-transform","scale(1)").css("-moz-transform","scale(1)").css("-ms-transform","scale(1)").css("-o-transform","scale(1)").css("transform","scale(1)")},1E3)}};
McxVectorMemCanvas.prototype.setOrder=function(a){$("#"+this.layerId).css("zIndex",a);$("#"+this.layerId+"_divContainer").css("zIndex",a);$("#"+this.layerId+"_zoom").css("zIndex",a+1)};McxVectorMemCanvas.prototype.setOpacity=function(a){this.layer.setOpacity(a);$("#"+this.layerId).css("opacity",a)};McxVectorMemCanvas.prototype.getRendererEventHandler=function(){return this.rendererEventHandler};McxVectorMemCanvas.prototype.getLabelRendererEventHandler=function(){return this.labelRendererEventHandler};
McxVectorMemCanvas.prototype.backBufferEnabled=function(a){this.backBuffered=a};McxVectorMemCanvas.prototype.animateFadeEffect=function(){$("#"+this.layerId+"_zoom").children("*").fadeTo(500,0)};js.framework.mapping.McxCanvas.McxVectorServerCanvas={};function McxVectorServerCanvas(a,b){mcx.base(this,a,b);this.additiveFields="";this.requests=[];this.base=this;this.lastPaintMode=this.base.layer.getPainterMode();this.backBuffered=!1}mcx.inherits(McxVectorServerCanvas,McxVectorMemCanvas);
McxVectorServerCanvas.prototype.paintLayer=function(a,b){var c=this.base.layer.getPainterMode();this.base.lastPaintMode=c;if(c==McxPainterMode.ByImage)this.paintLayerImage(a),this.paintLabels(a);else if(this.animateFadeEffect(),this.base.totalRequestCount=a.length,c=function(a){this.base.totalRequestCount--;0==this.base.totalRequestCount&&(a=new McxRendererEventArgs(McxRendererStatus.End),this.base.rendererEventHandler.dispatchOnSuccess(this,a))},null!=this.base.drawContextToAnotherTarget||this.base.map.inVisibleRange(this.base.layer.getMinScale(),
this.base.layer.getMaxScale()))if(this.abortRender(),this.requestsCanceled=!1,this.base.isDirty&&(this.clearCanvas(),this.base.isDirty=!1),this.base.layer.getVisible()){var d=this.getAdditiveFieldsString(),e=this.base.map.getPixelScale(),f,g=f=this.base.map.getWorld();null==this.base.map.getCoordinateSystem()||g.getCoordinateSystem().equals(this.base.layer.getCoordinateSystem())||(f=g.transformTo(this.base.layer.getCoordinateSystem()));g=this.base.layer;this.base.layer.isSingleTile()&&(a=[new McxCell(0,
0,f,this.base.map.getDisplay())]);this.base.totalRequestCount=a.length;for(var h=0;h<a.length;h++){var k=this.transformCellToTarget(a[h],this.base.layer.getCoordinateSystem()),m=k.getIndexX().toString()+" "+k.getIndexY().toString();if(!(!this.base.layer.isSingleTile()&&-1<this.base.paintedCells.indexOf(m)&&b)){var n=[];n.push(f);n.push(this.base.map.getDisplay());n.push(k);n.push(this);n.push(e);m=new McxAjaxParameter;m.setParameters(this,this.onSearchSuccess,c);m.setArgs(n);n=this.base.layer.getFilterCollection();
k=g.fastSearch(d,n.toString(),null,k.getWorld(),null,null,m);this.requests.push(k)}}}else this.clearCanvas(),this.clearBackBuffer(),this.base.totalRequestCount=0,c=new McxRendererEventArgs(McxRendererStatus.End),this.base.rendererEventHandler.dispatchOnSuccess(this,c);else this.clearCanvas(),this.base.totalRequestCount=0,0==this.base.totalRequestCount&&(c=new McxRendererEventArgs(McxRendererStatus.End),this.base.rendererEventHandler.dispatchOnSuccess(this,c))};
McxVectorServerCanvas.prototype.paintLayerImage=function(a){this.backBuffered||$("#"+this.base.layerId+"_zoom").children("*").fadeTo(2E3,0);var b=function(){this.base.totalRequestCount--;if(0==this.base.totalRequestCount){var a=new McxRendererEventArgs(McxRendererStatus.End);this.base.rendererEventHandler.dispatchOnSuccess(this,a)}};if(this.base.map.inVisibleRange(this.base.layer.getMinScale(),this.base.layer.getMaxScale()))if(this.requestsCanceled=!1,this.base.isDirty&&(this.clearCanvas(),this.base.isDirty=
!1),this.base.layer.getVisible()){var c=this.base.layer.getKeyField()+","+this.base.layer.getGeometryField(),d=this.base.map.getPixelScale(),e,f=e=this.base.map.getWorld();null==this.base.map.getCoordinateSystem()||f.getCoordinateSystem().equals(this.base.layer.getCoordinateSystem())||(e=f.transformTo(this.base.layer.getCoordinateSystem()));var f=this.base.map.getTileSize().getWidth(),g=this.base.map.getTileSize().getHeight();a=this.base.map.getWorld().transformTo(this.base.layer.getCoordinateSystem());
var h=this.base.map.getDisplay();a=new McxLayerGrid(a,h,this.base.map.getTileSize(),null);a.calculate();a=a.getCells();this.base.layer.isSingleTile()&&(a=[new McxCell(0,0,e,this.base.map.getDisplay())],f=this.base.map.getDisplay().getWidth(),g=this.base.map.getDisplay().getHeight());this.base.totalRequestCount=a.length;e=this.base.layer;for(h=0;h<a.length;h++){var k=null,k=this.transformCellToTarget(a[h],this.base.layer.getCoordinateSystem()),m=[];m.push(this.base.map.getWorld());m.push(this.base.map.getDisplay());
m.push(k);m.push(this);m.push(d);m.push(this.base.map);m.push(f);m.push(g);var n=new McxAjaxParameter;n.setParameters(this,this.onSearchImageSuccess,b);n.setArgs(m);k=e.getMap(this.base.layer.getName(),k.getWorld(),k.getDisplay().getWidth(),k.getDisplay().getHeight(),c,n);this.requests.push(k)}}else this.clearCanvas(),this.clearBackBuffer();else this.clearCanvas()};
McxVectorServerCanvas.prototype.getAdditiveFieldsString=function(){var a=this.base.layer.getGeometryField(),b=this.base.layer.getKeyField();b&&null!=b&&(a=b+","+a);if(0<this.base.layer.getSubtypes().getCount())for(var b=this.base.layer.getSubtypes().getFields(),c=0;c<b.length;c++)b[c]!=this.base.layer.getGeometryField()&&b[c]!=this.base.layer.getKeyField()&&(a+=","+b[c]);this.base.layer.getPainterMode()==McxPainterMode.ByFeature&&this.base.layer.getSymbolizerField()&&""!=this.base.layer.getSymbolizerField()&&
(a+=","+this.base.layer.getSymbolizerField());this.additiveFields&&""!=this.additiveFields&&(a+=","+this.additiveFields);return a};
McxVectorServerCanvas.prototype.onSearchImageSuccess=function(a){var b=a.getFeatureReader();a.getArgs()[2].getDisplay();var c=a.getArgs()[3],d=c.getMap().getPixelScale();a=a.getArgs()[4];if(0!=Math.abs(d-a))this.base.totalRequestCount--,0==this.base.totalRequestCount&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.base.rendererEventHandler.dispatchOnSuccess(this,b));else{d={count:b.getFeatureCount()};if(0==b.getFeatureCount()&&(this.base.totalRequestCount--,0==this.base.totalRequestCount)){b=
new McxRendererEventArgs(McxRendererStatus.End);this.base.rendererEventHandler.dispatchOnSuccess(self,b);return}for(;b.read();){if(c.requestsCanceled){this.base.totalRequestCount=0;b=new McxRendererEventArgs(McxRendererStatus.Canceled);this.base.rendererEventHandler.dispatchOnSuccess(this,b);return}(a=b.getCurrent())&&a.getGeometry()&&this.paintFeature(a,d)}null==this.base.drawContextToAnotherTarget&&(this.base.totalRequestCount--,0==this.base.totalRequestCount&&(b=new McxRendererEventArgs(McxRendererStatus.End),
this.base.rendererEventHandler.dispatchOnSuccess(this,b)))}};
McxVectorServerCanvas.prototype.paintFeature=function(a,b){var c=this.base.map.getContent().find("#"+this.base.layerId+"_divContainer").eq(0).find("[src='"+a.getQueryString()+"']");if(0<c.length){a.image=null;var d=a.getGeometry().getBounds(),e=c[0],c="width:"+(d.getWidth()+1).toString()+"px; height:"+(d.getHeight()+1).toString()+"px; position: absolute; left:"+(d.getLeft()-this.base.translateX).toString()+"px;top:"+(d.getBottom()-this.base.translateY).toString()+"px; ";e.setAttribute("style",c)}else{var f=
this;""!=this.base.crossOrigin&&(a.getImage().crossOrigin=this.crossOrigin);d=a.getGeometry().getBounds();e=a.getImage();e.setAttribute("draggable","false");e.setAttribute("ondragstart","return false;");c="width:"+(d.getWidth()+1).toString()+"px; height:"+(d.getHeight()+1).toString()+"px; position: absolute; left:"+(d.getLeft()-this.base.translateX).toString()+"px;top:"+(d.getBottom()-this.base.translateY).toString()+"px; ";null==this.base.drawContextToAnotherTarget&&e.setAttribute("style",c);a.getImage().onload=
function(){if(null!=f.drawContextToAnotherTarget){if(f.drawContextToAnotherTarget.getGeodeticGraphics().drawImage(a.getImage(),d.getLeft(),d.getBottom(),d.getWidth()+1,d.getHeight()+1),b.count--,0==b.count&&(f.totalRequestCount--,0==f.totalRequestCount)){var c=new McxRendererEventArgs(McxRendererStatus.End);f.rendererEventHandler.dispatchOnSuccess(f,c)}}else 0<f.map.getContent().find("#"+f.layerId+"_divContainer").eq(0).find("[src='"+a.getQueryString()+"']").length||f.map.getContent().find("#"+f.layerId+
"_divContainer").eq(0).append(e)};a.getImage().onerror=function(){if(null!=f.drawContextToAnotherTarget&&(b.count--,0==b.count&&(f.totalRequestCount--,0==f.totalRequestCount))){var a=new McxRendererEventArgs(McxRendererStatus.End);f.rendererEventHandler.dispatchOnSuccess(f,a)}};a.getImage().src=a.getQueryString()}};
McxVectorServerCanvas.prototype.onSearchSuccess=function(a){if(null!=this.base.drawContextToAnotherTarget)this.base.drawModeOnSearchSuccess(a);else{var b=a.getFeatureReader(),c=a.getArgs()[2],d=c.getDisplay(),e=a.getArgs()[3],f=e.getMap().getPixelScale(),g=a.getArgs()[4];if(0!=Math.abs(f-g))this.base.totalRequestCount--,0==this.base.totalRequestCount&&this.base.rendererEventHandler.dispatchOnSuccess(this,null);else{var f=c.getWorld(),h=g=e.getMap().getWorld(),h=e.getLayers()[0].getCoordinateSystem(),
h=null==g.getCoordinateSystem()||g.getCoordinateSystem().equals(h)?g:g.transformTo(h);if(h.intersectsBounds(f)){g=this.canvasId+"-"+c.getIndexX()+"-"+c.getIndexY();(f=this.base.map.getContent().find("#"+g).eq(0))&&null!=f&&$(f).remove();f=document.createElement("canvas");f.id=g;f.style.position="absolute";f.setAttribute("height",Math.floor(d.getHeight()).toString()+"px");f.setAttribute("width",Math.floor(d.getWidth()).toString()+"px");f.globalCompositeOperation="source-over";var g=this.base.map.getContent().find("#"+
this.base.layerId+"_divContainer").eq(0),h=(d.getLeft()-this.translateX).toString(),k=(d.getBottom()-this.translateY).toString();$(f).css("-webkit-transform","translate3d("+h+"px, "+k+"px,0px)").css("-moz-transform","translate3d("+h+"px, "+k+"px,0px)").css("-ms-transform","translate3d("+h+"px, "+k+"px,0px)").css("-o-transform","translate3d("+h+"px, "+k+"px,0px)").css("transform","translate3d("+h+"px, "+k+"px,0px)");f.style.display="none";$(f).fadeIn(250);g.append(f);for(f=new McxDrawContext(this.base.map,
f.getContext("2d"));b.read();){if(e.requestsCanceled){this.base.totalRequestCount=0;return}(g=b.getCurrent())&&g.getGeometry()&&((h=this.base.layer.getKeyField())&&null!=h&&e.getPaintedFeatures().addFeature(g.getFeatureID(),g.getGeometry()),h=this.getAppropriatePainter(g),null!=h&&h.paint(f,g,d.getLeft(),d.getBottom()))}this.base.totalRequestCount--;0==this.base.totalRequestCount&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.base.rendererEventHandler.dispatchOnSuccess(this,b));b=c.getIndexX().toString()+
" "+c.getIndexY().toString();this.base.paintedCells.push(b);this.base.drawLabelsOfCell(c.getWorld(),a.getArgs()[0],a.getArgs()[1],c.getDisplay())}else this.base.totalRequestCount--,0==this.base.totalRequestCount&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.base.rendererEventHandler.dispatchOnSuccess(this,b))}}};
McxVectorServerCanvas.prototype.paintLabels=function(a){var b,c=b=this.base.map.getWorld();null==this.base.map.getCoordinateSystem()||c.getCoordinateSystem().equals(this.base.layer.getCoordinateSystem())||(b=c.transformTo(this.base.layer.getCoordinateSystem()));for(c=0;c<a.length;c++){var d=this.transformCellToTarget(a[c],this.base.layer.getCoordinateSystem());this.base.drawLabelsOfCell(d.getWorld(),b,this.base.map.getDisplay(),d.getDisplay())}};
McxVectorServerCanvas.prototype.abortRender=function(){this.requestsCanceled=!0;for(var a=0;a<this.requests.length;a++)this.requests[a].abort(),a==this.requests.length-1&&(this.requests=[]);this.requests=[]};
McxVectorServerCanvas.prototype.getAppropriatePainter=function(a){var b=null,c=a.getSymbolizer();if(null==c)var d=a.getLayer().getSymbolizer();var e=a.getGeometry();if(!e)return null;e.isInstanceOf(McxGeometryType.Point)?(b=new McxPointPainter,null==c?b.setSymbolizer(d.getPointSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.LineString)?(b=new McxLineStringPainter,null==c?b.setSymbolizer(d.getLineSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.Polygon)?(b=new McxPolygonPainter,
null==c?b.setSymbolizer(d.getPolygonSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiPoint)?(b=new McxMultiPointPainter,null==c?b.setSymbolizer(d.getPointSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiLineString)?(b=new McxMultiLinePainter,null==c?b.setSymbolizer(d.getLineSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiPolygon)&&(b=new McxMultiPolygonPainter,null==c?b.setSymbolizer(d.getPolygonSymbolizer()):b.setSymbolizer(c));if(null!=
b){c=null;d=a.getLayer().getSubtypes();if(0<d.getCount())for(e=0;e<d.getCount();e++){var f=d.getAt(e);if(!f.isVisible())return null;if(f.getScript().run(a)){c=f.getSymbolizer();break}}d=a.getSymbolizer();if(b.isInstanceOf("McxPointPainter")||b.isInstanceOf("McxMultiPointPainter"))null!=d&&d.isInstanceOf("IMcxPointSymbolizer")&&this.base.layer.getPainterMode()==McxPainterMode.ByFeature?b.setSymbolizer(d):null!=d&&d.isInstanceOf("IMcxTextSymbolizer")&&this.base.layer.getPainterMode()==McxPainterMode.ByFeature?
b.setSymbolizer(d):null!=c&&null!=c.getPointSymbolizer()?b.setSymbolizer(c.getPointSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getPointSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getPointSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultPointSymbolizer());else if(b.isInstanceOf("McxLineStringPainter")||b.isInstanceOf("McxMultiLinePainter"))null!=d&&d.isInstanceOf("IMcxLineSymbolizer")&&this.base.layer.getPainterMode()==McxPainterMode.ByFeature?
b.setSymbolizer(a.getSymbolizer()):null!=c&&null!=c.getLineSymbolizer()?b.setSymbolizer(c.getLineSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getLineSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getLineSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultLineSymbolizer());else if(b.isInstanceOf("McxPolygonPainter")||b.isInstanceOf("McxMultiPolygonPainter"))null!=d&&d.isInstanceOf("IMcxPolygonSymbolizer")&&this.base.layer.getPainterMode()==
McxPainterMode.ByFeature?b.setSymbolizer(d):null!=c&&null!=c.getPolygonSymbolizer()?b.setSymbolizer(c.getPolygonSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getPolygonSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getPolygonSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultPolygonSymbolizer())}return b};
McxVectorServerCanvas.prototype.paintSelection=function(a){if(this.base.layer.isInstanceOf("IMcxSelectableLayer")&&this.base.layer.getVisible()&&this.base.map.inVisibleRange(this.base.layer.getMinScale(),this.base.layer.getMaxScale())&&0!=this.base.layer.getSelectionCount())for(var b=this.base.layer.getSelection();b.read();){var c=b.getCurrent();if(c.getGeometry()&&null!=c.getGeometry()){var d=this.getAppropriatePainter(c);(c.getGeometry().isInstanceOf(McxGeometryType.Polygon)||c.getGeometry().isInstanceOf(McxGeometryType.MultiPolygon))&&
d.setSymbolizer(this.base.selectionSymbolizer.getPolygonSymbolizer());(c.getGeometry().isInstanceOf(McxGeometryType.LineString)||c.getGeometry().isInstanceOf(McxGeometryType.MultiLineString))&&d.setSymbolizer(this.base.selectionSymbolizer.getLineSymbolizer());(c.getGeometry().isInstanceOf(McxGeometryType.Point)||c.getGeometry().isInstanceOf(McxGeometryType.MultiPoint))&&d.setSymbolizer(this.base.selectionSymbolizer.getPointSymbolizer());null!=d&&d.paint(a,c,0,0)}}};
McxVectorServerCanvas.prototype.clearCanvas=function(){$("#"+this.base.layerId+"_divContainer").empty()};McxVectorServerCanvas.prototype.isInstanceOf=function(a){return"McxVectorServerCanvas"==a};McxVectorServerCanvas.prototype.setAdditiveFields=function(a){if(""==a)this.additiveFields="";else{a instanceof Array||(a=[a]);for(var b=0;b<a.length;b++)0!=b&&(this.additiveFields+=","),this.additiveFields+=a[b]}};js.framework.mapping.McxCanvas.McxWMSCanvas={};function McxWMSCanvas(a,b){mcx.base(this,a,b);this.base=this;b.getCRSChangedEventHandler().addListener(this.onCrsChangedHandler,null,this)}mcx.inherits(McxWMSCanvas,McxImageCanvas);McxWMSCanvas.prototype.onCrsChangedHandler=function(){};
js.framework.mapping.McxMap={};js.framework.mapping.McxMap.McxDefaultInputHandler={};function McxDefaultInputHandler(a){this.map=a;this.controller=null;this.undoStack=[];this.undoStateChanhedEventHandler=new McxEventHandler;this.undoStackLimit=16;this.redoStack=[];this.redoStackLimit=16}McxDefaultInputHandler.prototype.execute=function(a){(a.isInstanceOf("IMcxUndoableAction")||a.isInstanceOf("IMcxSketchUndoableAction"))&&this.addUndoable(a);a.execute(this.map)};
McxDefaultInputHandler.prototype.getController=function(){return this.controller};McxDefaultInputHandler.prototype.setController=function(a){this.controller=a;this.controller.startInteraction(this.map)};McxDefaultInputHandler.prototype.onMouseClick=function(a){if(null!=this.controller)this.controller.onMouseClick(a)};McxDefaultInputHandler.prototype.onMouseWheel=function(a){if(null!=this.controller)this.controller.onMouseWheel(a)};
McxDefaultInputHandler.prototype.onMouseMove=function(a){if(null!=this.controller)this.controller.onMouseMove(a)};McxDefaultInputHandler.prototype.onMouseUp=function(a){if(null!=this.controller)this.controller.onMouseUp(a)};McxDefaultInputHandler.prototype.onMouseDown=function(a){if(null!=this.controller)this.controller.onMouseDown(a)};McxDefaultInputHandler.prototype.onKeyUp=function(a){if(null!=this.controller)this.controller.onKeyUp(a)};
McxDefaultInputHandler.prototype.onKeyDown=function(a){if(null!=this.controller)this.controller.onKeyDown(a)};McxDefaultInputHandler.prototype.onKeyPress=function(a){if(null!=this.controller)this.controller.onKeyPress(a)};McxDefaultInputHandler.prototype.onTap=function(a){if(null!=this.controller)this.controller.onTap(a)};McxDefaultInputHandler.prototype.onHold=function(a){if(null!=this.controller)this.controller.onHold(a)};McxDefaultInputHandler.prototype.onDoubleTap=function(a){if(null!=this.controller)this.controller.onDoubleTap(a)};
McxDefaultInputHandler.prototype.onPinch=function(a){if(null!=this.controller)this.controller.onPinch(a)};McxDefaultInputHandler.prototype.onSwipe=function(a){if(null!=this.controller)this.controller.onSwipe(a)};McxDefaultInputHandler.prototype.onSwipeLeft=function(a){if(null!=this.controller)this.controller.onSwipeLeft(a)};McxDefaultInputHandler.prototype.onSwipeRight=function(a){if(null!=this.controller)this.controller.onSwipeRight(a)};
McxDefaultInputHandler.prototype.onSwipeUp=function(a){if(null!=this.controller)this.controller.onSwipeUp(a)};McxDefaultInputHandler.prototype.onSwipeDown=function(a){if(null!=this.controller)this.controller.onSwipeDown(a)};McxDefaultInputHandler.prototype.onRotate=function(a){if(null!=this.controller)this.controller.onRotate(a)};McxDefaultInputHandler.prototype.onDragStart=function(a){if(null!=this.controller)this.controller.onDragStart(a)};
McxDefaultInputHandler.prototype.onDragEnd=function(a){if(null!=this.controller)this.controller.onDragEnd(a)};McxDefaultInputHandler.prototype.onDrag=function(a){if(null!=this.controller)this.controller.onDrag(a)};McxDefaultInputHandler.prototype.onRelease=function(a){};McxDefaultInputHandler.prototype.getUndoLimit=function(){return this.undoStackLimit};McxDefaultInputHandler.prototype.setUndoLimit=function(a){this.undoStateChanhedEventHandler.dispatchOnSuccess(this,null);this.undoStackLimit=a};
McxDefaultInputHandler.prototype.canUndo=function(){return 0<Object.keys(this.undoStack).length};McxDefaultInputHandler.prototype.canRedo=function(){return 0<Object.keys(this.redoStack).length};McxDefaultInputHandler.prototype.addUndoable=function(a){Object.keys(this.undoStack).length>=this.undoStackLimit||(this.undoStack.push(a),this.redoStack=[],this.undoStateChanhedEventHandler.dispatchOnSuccess(this,null))};
McxDefaultInputHandler.prototype.finishSketch=function(){for(var a=0;a<this.undoStack.length;a++)this.undoStack[a].isInstanceOf("IMcxSketchUndoableAction")&&(this.undoStack.splice(a,1),a--);for(a=0;a<this.redoStack.length;a++)this.redoStack[a].isInstanceOf("IMcxSketchUndoableAction")&&(this.redoStack.splice(a,1),a--)};
McxDefaultInputHandler.prototype.undo=function(){var a=this.map.getLayers().getActiveLayer().getSelection().toArray();if(0<a.length)for(var b=0;b<a.length;b++)McxSelectionHelper.instance.removeSelection(this.map,a[b]);(a=this.undoStack.pop())&&null!=a&&(a.undo(),this.redoStack.push(a),this.undoStateChanhedEventHandler.dispatchOnSuccess(this,null))};McxDefaultInputHandler.prototype.getUndo=function(){return this.undoStack[this.undoStack.length-1]};
McxDefaultInputHandler.prototype.getRedo=function(){return this.redoStack[this.redoStack.length-1]};McxDefaultInputHandler.prototype.redo=function(){var a=this.redoStack.pop();a&&null!=a&&(a.redo(),this.undoStack.push(a),this.undoStateChanhedEventHandler.dispatchOnSuccess(this,null))};McxDefaultInputHandler.prototype.getUndoStateChangeEventHandler=function(){return this.undoStateChanhedEventHandler};McxDefaultInputHandler.prototype.getInspectorStatus=function(){};
McxDefaultInputHandler.prototype.setInspectorStatus=function(a){};js.framework.mapping.McxMap.McxGetScreenShotResult={};function McxGetScreenShotResult(a){mcx.base(this,null);this.image=a}mcx.inherits(McxGetScreenShotResult,McxResult);McxGetScreenShotResult.prototype.getImage=function(){return this.image};js.framework.mapping.McxMap.McxMap={};
function McxMap(a){mcx.base(this);this.rootElement=null;this.mapName=a||McxGuid.createGuid();this._openingBounds=this.restrictedExtend=null;this.markerCollection=new McxMarkerCollection;this.display=new McxBounds(0,0,0,0,null);this.world=new McxBounds(0,0,0,0,null);this.tileSize=McxFactoryFinder.GeometryFactory(null).createSize(256,256);this.renderer=null;this.layerCollection=new McxLayerCollection;this.inputHandler=new McxDefaultInputHandler(this);this.snapEngines=[];this.coordinateSystem=null;this.scaleChangedEventHandler=
new McxEventHandler;this.crsChangedEventHandler=new McxEventHandler;this.resizeEventHandler=new McxEventHandler;this.worldChangedEventHandler=new McxEventHandler;this.worldChangingEventHandler=new McxEventHandler;this.deviceScale=0;this.draggable=!0;this.scaleSet=null;this._viewUndoBuffer=new McxViewUndoBuffer(this);this.backColor=new McxColor;this.backColor.setColorFromHex("#eeeeee");this.rootElement=$("#"+this.mapName);0==this.rootElement.length&&(this.rootElement=$("<div/>").prop("id",this.mapName).css("width",
"100%").css("height","100%").css("position","relative"));this.rootElement.addClass("mcx-map-root");this.rootElement.append($("<input/>").attr("type","text").css({opacity:0,position:"absolute"}).addClass("mcx-map-focus-fix"));a=this.rootElement[0];this.initializeMap();var b=McxMobile.isMobile.any();b&&"Microsoft Internet Explorer"!=navigator.appName&&this.initializeTouchListeners(a);McxMobile.isMobile.Windows()&&this.initializeTouchListeners(a);b||(this.initializeMouseListeners(a),this.initializeKeyListeners());
this._lastWheelTime=this._wheelTimer=0}mcx.inherits(McxMap,McxUserControl);
McxMap.prototype.initializeMap=function(){var a=$("<div/>").attr("id",this.mapName+"_layerContainer").attr("draggable","false").css("position","absolute");a.css("backface-visibility","hidden").css("perspective","1000").css("-webkit-tap-highlight-color","rgba(0, 0, 0, 0.1)").css("-webkit-transform","translateZ(0)").css("-webkit-font-smoothing","antialiased").css("-webkit-backface-visibility","hidden").css("-moz-transition","all 0ms").css("-moz-font-smoothing","antialiased").css("-moz-backface-visibility",
"hidden").css("-webkit-user-select","none").css("-khtml-user-select","none").css("-moz-user-select","none").css("-o-user-select","none").css("user-select","none");this.rootElement.append(a)};
McxMap.prototype.initializeMouseListeners=function(a){function b(a){f=!0;setTimeout(function(){f=!1},200);var b=new McxMouseEventArgs(a);e.inputHandler.onMouseWheel(b);a.stopPropagation();a.preventDefault()}function c(a){var b=new McxMouseEventArgs(a);e.inputHandler.onMouseUp(b);a.stopPropagation();return!1}function d(a){var b=new McxMouseEventArgs(a);e.inputHandler.onMouseClick(b);a.stopPropagation();return!1}var e=this,f=!1;$("#"+this.getName()).mouseleave(function(a){c(a)});a.addEventListener("contextmenu",
function(a){a.preventDefault();a.stopPropagation();return!1},!1);a.addEventListener("mousewheel",function(a){a.preventDefault();f||b(a)},!1);a.addEventListener("DOMMouseScroll",b,!1);a.addEventListener("mousedown",function(a){e.rootElement.find(".mcx-map-focus-fix").focus();var b=new McxMouseEventArgs(a);e.inputHandler.onMouseDown(b);a.stopPropagation();return!1},!1);a.addEventListener("mousemove",function(a){var b=new McxMouseEventArgs(a);e.inputHandler.onMouseMove(b);a.stopPropagation();return!1},
!1);a.addEventListener("mouseup",c,!1);$(a).dblclick(function(a){var b=new McxMouseEventArgs(a);b.setWheelDelta(.5);e.inputHandler.onMouseWheel(b);a.stopPropagation();return!1});"Microsoft Internet Explorer"==navigator.appName&&a.addEventListener("onmouseclick",d,!0)};
McxMap.prototype.initializeKeyListeners=function(){var a=this;$("html").get(0).addEventListener("keydown",function(b){b=new McxKeyEventArgs(b);a.inputHandler.onKeyDown(b)},!0);$("html").get(0).addEventListener("keypress",function(b){b=new McxKeyEventArgs(b);a.inputHandler.onKeyPress(b)},!0);$("html").get(0).addEventListener("keyup",function(b){b=new McxKeyEventArgs(b);a.inputHandler.onKeyUp(b)},!0)};
McxMap.prototype.initializeTouchListeners=function(a){var b=this,c={prevent_default:!0,scale_threshold:1,drag_min_distance:2,css_hacks:!1,stop_browser_behavior:!0,transform_always_block:!0};Hammer(a,c).on(McxGestureEventType.tap,function(a){"mouse"==a.gesture.pointerType?(a=new McxMouseEventArgs(a),b.inputHandler.onMouseClick(a)):(a=new McxTouchEventArgs(a),b.inputHandler.onTap(a))});Hammer(a,c).on(McxGestureEventType.doubletap,function(a){"mouse"!=a.gesture.pointerType&&(a=new McxTouchEventArgs(a),
b.inputHandler.onDoubleTap(a))});Hammer(a,c).on(McxGestureEventType.pinch,function(a){a=new McxTouchEventArgs(a);b.inputHandler.onPinch(a);return b.draggable=!1});Hammer(a,c).on(McxGestureEventType.dragstart,function(a){"mouse"==a.gesture.pointerType||1<a.gesture.touches.length||!b.draggable||(a=new McxTouchEventArgs(a),b.inputHandler.onDragStart(a))});Hammer(a,c).on(McxGestureEventType.dragend,function(a){"mouse"==a.gesture.pointerType||1<a.gesture.touches.length||!b.draggable||(a=new McxTouchEventArgs(a),
b.inputHandler.onDragEnd(a))});Hammer(a,c).on(McxGestureEventType.drag,function(a){if("mouse"==a.gesture.pointerType)return!0;1<a.gesture.touches.length||!b.draggable||(a=new McxTouchEventArgs(a),b.inputHandler.onDrag(a))});Hammer(a,c).on("hold",function(a){if("mouse"==a.gesture.pointerType)return!0;1<a.gesture.touches.length||!b.draggable||(a=new McxTouchEventArgs(a),b.inputHandler.onHold(a))});Hammer(a,c).on(McxGestureEventType.release,function(a){if("mouse"==a.gesture.pointerType)return!0;a=new McxTouchEventArgs(a);
b.inputHandler.onRelease(a);setTimeout(function(){b.draggable=!0},300)})};
McxMap.prototype.geometryToView=function(a){var b=a.transformTo(this.coordinateSystem);if(a.isInstanceOf(McxGeometryType.Point))return this.transformPointToView(b);if(a.isInstanceOf(McxGeometryType.LineString))return this.transformLineStringToView(b);if(a.isInstanceOf(McxGeometryType.Polygon))return this.transformPolygonToView(b);if(a.isInstanceOf(McxGeometryType.MultiPoint)){var c=Array(b.getPoints().length);for(a=0;a<b.getPoints().length;a++)c[a]=this.transformPointToView(b.getPoints()[a]);return new McxMultiPoint(c,
null)}if(a.isInstanceOf(McxGeometryType.MultiLineString)){c=Array(b.getLines().length);for(a=0;a<b.getLines().length;a++)c[a]=this.transformLineStringToView(b.getLines()[a]);return new McxMultiLineString(c,null)}if(a.isInstanceOf(McxGeometryType.MultiPolygon)){c=Array(b.getPolygons().length);for(a=0;a<b.getPolygons().length;a++)c[a]=this.transformPolygonToView(b.getPolygons()[a]);return new McxMultiPolygon(c,null)}return null};
McxMap.prototype.transformPointToView=function(a){return this.worldToView(a.getX(),a.getY())};McxMap.prototype.transformPointsToView=function(a){for(var b=Array(a.length),c=0;c<a.length;c++)b[c]=this.transformPointToView(a[c]);return b};McxMap.prototype.transformLineStringToView=function(a){a=this.transformPointsToView(a.getPoints());return new McxLineString(a,null)};
McxMap.prototype.transformPolygonToView=function(a){var b=a.getShell(),b=this.transformPointsToView(b.getPoints()),b=new McxLinearRing(b,null);a=a.getHoles();var c=[];0>=a.length&&(c=null);for(var d=0;d<a.length;d++){var e=this.transformPointsToView(a[d].getPoints()),e=new McxLinearRing(e,null);c.push(e)}return new McxPolygon(b,c,null)};
McxMap.prototype.worldToView=function(a,b){var c=this.world.right-this.world.left,d=this.world.top-this.world.bottom;if(0>=c||0>=d)return null;var e=this.display.top-this.display.bottom,d=this.display.bottom+(e-e/d*(b+-this.world.bottom));return new McxPoint(Math.round(this.display.left+(this.display.right-this.display.left)/c*(a+-this.world.left)),Math.round(d),null)};
McxMap.prototype.viewToWorld=function(a,b){var c=this.world.right-this.world.left,d=this.world.top-this.world.bottom;if(0==c||0==d)return null;var e=this.display.top-this.display.bottom;return new McxPoint(c/(this.display.right-this.display.left)*(this.display.left+a)+this.world.left,d/e*(this.display.bottom+(e-b))+this.world.bottom,this.coordinateSystem)};McxMap.prototype.getName=function(){return this.mapName};McxMap.prototype.getLayers=function(){return this.layerCollection};
McxMap.prototype.getMarkerCollection=function(){return this.markerCollection};McxMap.prototype.getDisplay=function(){return this.display};
McxMap.prototype.setDisplay=function(a,b){var c=this.getScale(),d=this.display.getWidth(),e=this.display.getHeight();this.display=new McxBounds(0,0,a,b,null);this.adjustAspectRatio();this.display.getWidth()==d&&this.display.getHeight()==e||this.resizeEventHandler.dispatchOnSuccess(this,null);this.getScale()!=c&&this.scaleChangedEventHandler.dispatchOnSuccess(this,null)};McxMap.prototype.getTileSize=function(){return this.tileSize};McxMap.prototype.addSnapEngine=function(a){this.snapEngines.push(a)};
McxMap.prototype.setTileSize=function(a){this.tileSize=a};McxMap.prototype.setWorld=function(a,b,c,d){this.worldChangingEventHandler.dispatchOnSuccess(this,null);var e=this.getScale();a=new McxBounds(a,b,c,d,this.coordinateSystem);null!=this.restrictedExtend&&(b=a.getCentroid(),this.restrictedExtend.contains(b.getX(),b.getY())||(a=this.restrictedExtend.clone()));this.world=a;this.adjustAspectRatio();a=this.getScale();e!=a&&this.scaleChangedEventHandler.dispatchOnSuccess(this,null)};
McxMap.prototype.setWorldWithoutTrigger=function(a,b,c,d){var e=this.getScale();a=new McxBounds(a,b,c,d,this.coordinateSystem);null!=this.restrictedExtend&&(b=a.getCentroid(),this.restrictedExtend.contains(b.getX(),b.getY())||(a=this.restrictedExtend.clone()));this.world=a;this.adjustAspectRatio();a=this.getScale();e!=a&&this.scaleChangedEventHandler.dispatchOnSuccess(this,null)};McxMap.prototype.getWorld=function(){this.world.setCoordinateSystem(this.coordinateSystem);return this.world};
McxMap.prototype.setScale=function(a){if(a!=this.getScale()){var b,c,d=this.getDeviceScale();c=b=d;null!=this.coordinateSystem&&(b/=this.coordinateSystem.getDistancePerUnit(),c/=this.coordinateSystem.getDistancePerUnit());d=(new McxBounds(this.world.getLeft(),this.world.getBottom(),this.world.getRight(),this.world.getTop(),this.coordinateSystem)).getCentroid();b*=this.display.getWidth()/a;a=this.display.getHeight()/a*c;null!=this.restrictedExtend&&(this.restrictedExtend.getLeft()>d.getX()-b/2&&(b=
2*(d.getX()-this.restrictedExtend.getLeft())),this.restrictedExtend.getRight()<d.getX()+b/2&&(b=2*(this.restrictedExtend.getRight()-d.getX())),this.restrictedExtend.getBottom()>d.getY()-a/2&&(a=2*(d.getY()-this.restrictedExtend.getBottom())),this.restrictedExtend.getTop()<d.getY()+a/2&&(a=2*(this.restrictedExtend.getTop()-d.getY())));this.setWorld(d.getX()-b/2,d.getY()-a/2,d.getX()+b/2,d.getY()+a/2);this.scaleChangedEventHandler.dispatchOnSuccess(this,null)}};
McxMap.prototype.getDeviceScale=function(){if(0!=this.deviceScale)return this.deviceScale;var a=document.getElementsByTagName("body")[0],b=document.createElement("div");b.id="temp";a.appendChild(b);$("#temp").css("width","1in").css("position","fixed");var c=document.defaultView.getComputedStyle(b,null).getPropertyValue("width");a.removeChild(b);return this.deviceScale=1/(parseInt(c,10)/.0254)};
McxMap.prototype.getScale=function(){var a=this.getDeviceScale(),b=a=this.display.getWidth()*a/this.world.getWidth();null!=this.coordinateSystem&&(b=a/this.coordinateSystem.getDistancePerUnit());return b};McxMap.prototype.setInputHandler=function(a){this.inputHandler=a};McxMap.prototype.getInputHandler=function(){return this.inputHandler};
McxMap.prototype.getPixelScale=function(){var a=Math.sqrt(this.world.getWidth()*this.world.getWidth()+this.world.getHeight()*this.world.getHeight()),b=Math.sqrt(this.display.getWidth()*this.display.getWidth()+this.display.getHeight()*this.display.getHeight());return a/b};
McxMap.prototype.setCoordinateSystem=function(a){var b=this.getScale();this.coordinateSystem&&a&&(this.world=this.world.transformTo(a),null!=this.restrictedExtend&&(this.restrictedExtend=this.restrictedExtend.transformTo(a)),this.getRenderer().paintLayer(null,null));null==this.coordinateSystem&&null!=a?(this.coordinateSystem=a,this.crsChangedEventHandler.dispatchOnSuccess(this,null)):null!=this.coordinateSystem&&null==a?(this.coordinateSystem=a,this.crsChangedEventHandler.dispatchOnSuccess(this,null)):
null!=this.coordinateSystem&&(this.coordinateSystem=a,this.crsChangedEventHandler.dispatchOnSuccess(this,null));a=this.getScale();b!=a&&this.scaleChangedEventHandler.dispatchOnSuccess(this,null)};McxMap.prototype.getCoordinateSystem=function(){return this.coordinateSystem};McxMap.prototype.createDrawContext=function(){return this.renderer.getSketchCanvas().getNonLayerDrawContext()};
McxMap.prototype.getPaintedFeatures=function(a){for(var b=0;b<this.renderer.getCount();b++){var c=this.renderer.getCanvasByIndex(b);if(mcx.isInstanceOf(c,McxFsCollectionCanvas)){if(c=c.getPaintedFeatures(a),null!=c)return c}else if(c.getLayers()[0]==a)return c.getPaintedFeatures()}return null};McxMap.prototype.getSnapEngines=function(){return this.snapEngines};McxMap.prototype.getScaleChangedEventHandler=function(){return this.scaleChangedEventHandler};McxMap.prototype.getCRSChangedEventHandler=function(){return this.crsChangedEventHandler};
McxMap.prototype.getResizeEventHandler=function(){return this.resizeEventHandler};McxMap.prototype.inVisibleRange=function(a,b){var c=this.getScale();return-1==c||b!=Number.NaN&&c<b||a!=Number.NaN&&c>a?!1:!0};
McxMap.prototype.adjustAspectRatio=function(){if(null!=this.display.getWidth()&&null!=this.display.getHeight()&&null!=this.world.getWidth()&&null!=this.world.getHeight()&&0!=this.display.getWidth()&&0!=this.display.getHeight()&&0!=this.world.getWidth()&&0!=this.world.getHeight()){this.worldChangingEventHandler.dispatchOnSuccess(this,null);var a=this.display.getWidth()/this.display.getHeight();if(1<a){var b=this.world.getHeight()*a;b<this.world.getWidth()?(b=this.world.getWidth()*(1/a),a=Math.abs(b-
this.world.getHeight())/2,this.world.bottom-=a,this.world.top+=a):(a=(b-this.world.getWidth())/2,0>a&&(a*=-1),this.world.left-=a,this.world.right+=a);this.worldChangedEventHandler.dispatchOnSuccess(this,null)}else 1>a&&(b=this.world.getWidth()*(1/a),b<this.world.getHeight()?(b=this.world.getHeight()*a,a=(b-this.world.getWidth())/2,0>a&&(a*=-1),this.world.left-=a,this.world.right+=a):(a=(b-this.world.getHeight())/2,0>a&&(a*=-1),this.world.bottom-=a,this.world.top+=a),this.worldChangedEventHandler.dispatchOnSuccess(this,
null))}};McxMap.prototype.getRenderer=function(){return null==this.renderer?null:this.renderer};McxMap.prototype.setLayerCollection=function(a){this.layerCollection=a};McxMap.prototype.setRenderer=function(a){this.renderer=a};McxMap.prototype.setRestrictedExtend=function(a){null==a?this.restrictedExtend=null:(this.restrictedExtend=a.transformTo(this.coordinateSystem),this.setWorld(a.getLeft(),a.getBottom(),a.getRight(),a.getTop()),this.getRenderer().paintLayer(null,null))};
McxMap.prototype.getRestrictedExtend=function(){return this.restrictedExtend};McxMap.prototype.getContent=function(){return this.rootElement};McxMap.prototype.getScaleSet=function(){return this.scaleSet};McxMap.prototype.setScaleSet=function(a){this.scaleSet=a};McxMap.prototype.getViewUndoBuffer=function(){return this._viewUndoBuffer};McxMap.prototype.getWorldChangedEventHandler=function(){return this.worldChangedEventHandler};McxMap.prototype.getWorldChangingEventHandler=function(){return this.worldChangingEventHandler};
McxMap.prototype.setBackColor=function(a){this.backColor=a;$(this.rootElement)[0].style.backgroundColor=a.getHex()};McxMap.prototype.getBackColor=function(){return this.backColor};McxMap.prototype.setOpeningBounds=function(a){this._openingBounds=a};McxMap.prototype.getOpeningBounds=function(a){return null==this._openingBounds?this.world:this._openingBounds};js.framework.mapping.McxMap.McxMapPrinter={};function McxMapPrinter(){}McxMapPrinter.prototype.getScreenShot=function(a){var b=a.getWidth(),c=a.getHeight(),d=a.getAjaxParameter();window.html2canvas($("#"+a.getMap().getName()),{onrendered:function(a){var f=document.createElement("canvas");f.width=b;f.height=c;f.style.width=b;f.style.height=c;f.getContext("2d").drawImage(a,0,0,b,c);a=new McxGetScreenShotResult(f);d.getSuccess().call(d.getScope(),a)},useCORS:!0})};
McxMapPrinter.prototype.print=function(a){var b=a.getLayers(),c=a.getMap(),d=a.getWidth(),e=a.getHeight(),f=a.getAjaxParameter(),g=a.getContext(),h=a.getFillStyle();g.imageSmoothingEnabled=a.getImageSmoothingEnabled();g.webkitImageSmoothingEnabled=a.getImageSmoothingEnabled();g.mozImageSmoothingEnabled=a.getImageSmoothingEnabled();var k=c.getWorld();(a=a.getBounds())&&null!=a&&(k=a);var m=McxGuid.createGuid();a=$("<div/>").css("position","relative").css("width",d.toString()+"px").css("height",e.toString()+
"px").attr("id",m).addClass("");a.hide();var n=$("<div/>").css("width","100%").css("height","100%").css("position","relative");n.append(a);$("body").append(n);n.hide();a=new McxMap(m);m=document.getElementById(m);$(m).hide();m=new McxRenderer(a);a.setRenderer(m);a.setLayerCollection(m);a.setCoordinateSystem(c.getCoordinateSystem());m=new McxCanvasProvider;a.getRenderer().addCanvasProvider(m);a.setDisplay(d,e);a.setWorld(k.getLeft(),k.getBottom(),k.getRight(),k.getTop());if(null==b)for(b=c.getLayers().toLayerArray(),
d=0;d<b.length;d++)b[d].getVisible()&&a.getLayers().add(b[d]);a.setWorld(k.getLeft(),k.getBottom(),k.getRight(),k.getTop());var p=function(){c.getRenderer().getRendererEndEventHandler().removeListener(p);f.getAsync()&&f.getSuccess().call(f.getScope());n.remove()},g=new McxDrawContext(a,g);""!=h&&g.getGeodeticGraphics().clearWithColor(h);a.getRenderer().getRendererEndEventHandler().addListener(p,function(){c.getRenderer().getRendererEndEventHandler().removeListener(p);f.getAsync()&&f.getError().call(f.getScope());
n.remove()},null);a.getRenderer().draw(g,b,null)};js.framework.mapping.McxMap.McxMarkerCollection={};function McxMarkerCollection(){this._markers=[];this._markerAddedEventHandler=new McxEventHandler;this.markerRemovedEventHandler=new McxEventHandler;this.resetEventHandler=new McxEventHandler}McxMarkerCollection.prototype.getMarker=function(a){return a>=this._markers.length?null:this._markers[a]};McxMarkerCollection.prototype.indexOf=function(a){for(var b=0;b<this._markers.length;b++)if(this._markers[b]==a)return b;return-1};
McxMarkerCollection.prototype.add=function(a){this._markers.push(a)};McxMarkerCollection.prototype.addRange=function(a){for(var b=0;b<a.length;b++)this._markers.push(a[b])};McxMarkerCollection.prototype.insert=function(a,b){};McxMarkerCollection.prototype.clear=function(){this._markers=[]};McxMarkerCollection.prototype.containsGuid=function(a){for(var b=0;b<this._markers.length;b++)if(this._markers[b].getMarkerId()==a)return!0;return!1};
McxMarkerCollection.prototype.containsMarker=function(a){for(var b=0;b<this._markers.length;b++)if(this._markers[b].getMarkerId()==a.getMarkerId())return!0;return!1};McxMarkerCollection.prototype.find=function(a){for(var b=[],c=0;c<this._markers.length;c++)this._markers[c].getMarkerId()==a&&b.push(this._markers[c]);return b};McxMarkerCollection.prototype.removeWithGuid=function(a){for(var b=!1,c=0;c<this._markers.length;c++)this._markers[c].getMarkerId()==a&&(b=!0,this._markers.splice(c,1),c--);return b};
McxMarkerCollection.prototype.removeMarker=function(a){for(var b=!1,c=0;c<this._markers.length;c++)this._markers[c]==a&&(b=!0,this._markers.splice(c,1),c--);return b};McxMarkerCollection.prototype.removeAt=function(a){this._markers.splice(a,1)};McxMarkerCollection.prototype.removeRange=function(a){for(var b=0;b<a.length;b++)for(var c=0;c<this._markers.length;c++)this._markers[c]==a[b]&&this.removeAt(c)};McxMarkerCollection.prototype.getCount=function(){return this._markers.length};
McxMarkerCollection.prototype.getMarkerAddedEventHandler=function(){return this._markerAddedEventHandler};McxMarkerCollection.prototype.getMarkerRemovedEventHandler=function(){return this.markerRemovedEventHandler};McxMarkerCollection.prototype.getResetEventHandler=function(){return this.resetEventHandler};js.framework.mapping.McxMap.McxViewUndoBuffer={};function McxViewUndoBuffer(a){this.map=a;this.undoStack=[];this.redoStack=[];this.ignoreSetWorld=!1;this.initialize()}McxViewUndoBuffer.prototype.initialize=function(){var a=0;this.map.getWorldChangedEventHandler().addListener(function(){this.ignoreSetWorld?this.ignoreSetWorld=!1:(0!==a%45&&0!=a||this.undoStack.push(this.map.getWorld()),a++)},function(){},this)};McxViewUndoBuffer.prototype.canUndo=function(){return!0};
McxViewUndoBuffer.prototype.canRedo=function(){return!0};McxViewUndoBuffer.prototype.undo=function(){var a=this.undoStack.pop();this.redoStack.push(a);a=a.transformTo(this.map.getCoordinateSystem());this.ignoreSetWorld=!0;this.map.setWorld(a.getLeft(),a.getBottom(),a.getRight(),a.getTop());this.map.getRenderer().paintLayer(null,null)};
McxViewUndoBuffer.prototype.redo=function(){var a=this.redoStack.pop();this.undoStack.push(a);a=a.transformTo(this.map.getCoordinateSystem());this.ignoreSetWorld=!0;this.map.setWorld(a.getLeft(),a.getBottom(),a.getRight(),a.getTop());this.map.getRenderer().paintLayer(null,null)};
js.framework.mapping.Mcx3D={};js.framework.mapping.Mcx3D.Mcx3DCanvas={};
function Mcx3DCanvas(a,b,c){this.additiveFields="";this.mapExtend=null;this.layer=a;this.id=McxGuid.createGuid();this.map=b;this.rendererEventHandler=new McxEventHandler;this.labelRendererEventHandler=new McxEventHandler;this.frontColor=16777215*Math.random();this.sideColor=16777215*Math.random();this.sideColor2=16777215*Math.random();this.ambientColor=16777215*Math.random();this.emissive=16777215*Math.random();this.manager=new THREE.LoadingManager;this.paintedCells=[];this.requests=[];this.isDirty=
!1;this.totalRequestCount=0;this.heightField="";this.canSetHeight=!1;this.scene=c;this.threeLib=McxLib.THREE();this.base=this}Mcx3DCanvas.prototype.initialize=function(){};Mcx3DCanvas.prototype.canAddLayer=function(a){return!0};Mcx3DCanvas.prototype.addLayer=function(a){};Mcx3DCanvas.prototype.getLayers=function(){return[this.layer]};Mcx3DCanvas.prototype.getLayer=function(){return this.layer};
Mcx3DCanvas.prototype.onSearchSuccess=function(a){var b=a.getFeatureReader();b.setTransformation(!1);a=a.getArgs()[2];var c=new this.threeLib.Object3D;this.scene.add(c);for(var d=this.map.getPixelScale(),e=this.map.getCoordinateSystem().getDistancePerUnit(),f={size:.02,bevelEnabled:!1},g=new THREE.LineBasicMaterial({color:this.frontColor,opacity:1,linewidth:150}),h=new this.threeLib.Geometry,k=[];b.read();){var m=b.getCurrent();if(m){var n=m.getGeometry();if(n){var p=new THREE.MeshLambertMaterial({color:this.frontColor,
ambient:1184274,emissive:1184274,side:THREE.BackSide}),q=-2;if(this.canSetHeight){if(q=-1*m.getValue(this.heightField),!q||null==q||0==q)continue}else q=-.5;var r=this.getAppropriatePainter(m),t=m.getLayer().getSymbolizer(),u=m.getSymbolizer();if(t.isInstanceOf("IMcxObjSymbolizer"))n=t,p=m.getGeometry().getBounds().getCentroid(),this.drawObject(n,p.getX(),p.getY(),0);else if(null!=u&&u.isInstanceOf("IMcxObjSymbolizer"))n=u,p=m.getGeometry().getBounds().getCentroid(),this.drawObject(n,p.getX(),p.getY(),
0);else{n.isInstanceOf(McxGeometryType.MultiPolygon)?(m=r.getSymbolizer(),m=m.getFill().getColor(),(m=this.getThreeColor(m))&&null!=m&&(p.color=m),h=this.drawMultiPolygon(c,n,f,q/(e*d),p,h,p.length)):n.isInstanceOf(McxGeometryType.Polygon)&&(m=r.getSymbolizer(),null!=m.getFill()&&(m=m.getFill().getColor(),(m=this.getThreeColor(m))&&null!=m&&(p.color=m)),this.drawPolygon(c,n,f,q/(e*d),p,h,k.length));n.isInstanceOf(McxGeometryType.MultiLineString)&&(m=r.getSymbolizer(),m=m.getStroke().getColor(),(m=
this.getThreeColor(m))&&null!=m&&(p.color=m),this.drawMultiLine(c,n,f,q/(e*d),p));if(n.isInstanceOf(McxGeometryType.LineString)||n.isInstanceOf(McxGeometryType.LineSegment)||n.isInstanceOf(McxGeometryType.LinearRing))m=r.getSymbolizer(),m=m.getStroke().getColor(),(m=this.getThreeColor(m))&&null!=m&&(p.color=m),this.drawLine(c,n,f,q/(e*d),g);k.push(p)}}}}b=new THREE.Mesh(h,new THREE.MeshFaceMaterial(k));c.add(b);b=a.getIndexX().toString()+" "+a.getIndexY().toString();this.paintedCells.push(b);this.map.getRenderer().refreshScene()};
Mcx3DCanvas.prototype.paintLayer=function(a){function b(){for(var a=0;25>a;a++){if(q.requestsCanceled||k>=h.length)return;var c=h[k],c=q.layer.fastSearch(c.attributeFilter,c.whereClause,null,c.world,null,null,c.ajaxParameter);q.requests.push(c);k++}k<h.length&&(setTimeout(b,p),p+=50)}this.totalRequestCount=a.length;var c=function(a){this.totalRequestCount--;0==this.totalRequestCount&&(a=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,a))};if(this.map.inVisibleRange(this.layer.getMinScale(),
this.layer.getMaxScale()))if(this.abortRender(),this.requestsCanceled=!1,this.isDirty&&(this.clearCanvas(),this.isDirty=!1),this.layer.getVisible()){var d=this.layer.getKeyField()+","+this.layer.getGeometryField();if(0<this.base.layer.getSubtypes().getCount())for(var e=this.base.layer.getSubtypes().getFields(),f=0;f<e.length;f++)e[f]!=this.base.layer.getGeometryField()&&e[f]!=this.base.layer.getKeyField()&&(d+=","+e[f]);this.layer.getPainterMode()==McxPainterMode.ByFeature&&this.layer.getSymbolizerField()&&
null!=this.layer.getSymbolizerField()&&(d+=","+this.layer.getSymbolizerField());e=this.additiveFields;""!=this.heightField&&null!=this.layer.getSchema().getField(this.heightField)&&(e+=","+this.heightField,this.canSetHeight=!0);e&&""!=e&&(d+=e);var e=this.map.getPixelScale(),g=f=this.map.getWorld();null==this.map.getCoordinateSystem()||g.getCoordinateSystem().equals(this.layer.getCoordinateSystem())||(f=g.transformTo(this.layer.getCoordinateSystem()));var h=[];this.layer.isSingleTile()&&(a=[new McxCell(0,
0,f,this.map.getDisplay())]);this.totalRequestCount=a.length;f=0;a=this.sortCells(a);for(var k=0;k<a.length;k++){g=a[k];g.getIndexX();g.getIndexY();f++;var m=[];m.push(this.mapExtend);m.push(this.map.getDisplay());m.push(g);m.push(this);m.push(e);var n=new McxAjaxParameter;n.setParameters(this,this.onSearchSuccess,c);n.setArgs(m);this.totalRequestCount=1;m=this.layer.getFilterCollection().toString();g={attributeFilter:d,whereClause:m?m:"",world:g.getWorld(),ajaxParameter:n};h.push(g);if(250<=f)break}var p=
2E3,q=this,k=0;b()}else this.clearCanvas(),this.clearBackBuffer(),this.totalRequestCount=0,c=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,c);else this.clearCanvas(),this.totalRequestCount=0,0==this.totalRequestCount&&(c=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,c))};Mcx3DCanvas.prototype.draw=function(a,b){};Mcx3DCanvas.prototype.drawLabels=function(a,b){};Mcx3DCanvas.prototype.paintLabels=function(a){};
Mcx3DCanvas.prototype.paintSelection=function(a){};Mcx3DCanvas.prototype.isInstanceOf=function(a){};Mcx3DCanvas.prototype.clearCanvas=function(){};Mcx3DCanvas.prototype.zoomTo=function(a,b,c){};Mcx3DCanvas.prototype.translate=function(a,b){};Mcx3DCanvas.prototype.resetTranslation=function(){};Mcx3DCanvas.prototype.dispose=function(){};Mcx3DCanvas.prototype.clearBackBuffer=function(){};Mcx3DCanvas.prototype.paintBackBuffer=function(){};Mcx3DCanvas.prototype.setZoomAnimationClass=function(a){};
Mcx3DCanvas.prototype.resetZoomAnimationClass=function(){};Mcx3DCanvas.prototype.setOrder=function(a){};Mcx3DCanvas.prototype.setOpacity=function(a){};Mcx3DCanvas.prototype.setDisplay=function(a,b){};Mcx3DCanvas.prototype.clearCache=function(){};Mcx3DCanvas.prototype.abortRender=function(){this.requestsCanceled=!0;for(var a=0;a<this.requests.length;a++)this.requests[a].abort(),a==this.requests.length-1&&(this.requests=[]);this.requests=[]};Mcx3DCanvas.prototype.getRendererEventHandler=function(){return this.rendererEventHandler};
Mcx3DCanvas.prototype.getLabelRendererEventHandler=function(){return this.labelRendererEventHandler};Mcx3DCanvas.prototype.backBufferEnabled=function(a){};Mcx3DCanvas.prototype.transformCellToTarget=function(a,b){if(null==this.map.getCoordinateSystem()||null==b||this.map.getCoordinateSystem().getCode()==b.getCode())return a;var c=a.getWorld().transformTo(b);return new McxCell(a.getIndexX(),a.getIndexY(),c,a.getDisplay())};
Mcx3DCanvas.prototype.removeDuplicate=function(a){for(var b={},c=0;c<a.length;c++){var d=a[c].getX().toString()+"-"+a[c].getY().toString();b[d]=a[c]}a=[];for(c in b)a.push(b[c]);for(c in b){a.push(b[c]);break}return a};Mcx3DCanvas.prototype.setHeightFieldName=function(a){this.heightField=a};Mcx3DCanvas.prototype.setAdditiveFields=function(a){if(""==a)this.additiveFields="";else{a instanceof Array||(a=[a]);for(var b=0;b<a.length;b++)0!=b&&(this.additiveFields+=","),this.additiveFields+=a[b]}};
Mcx3DCanvas.prototype.drawMultiPolygon=function(a,b,c,d,e,f,g){b=b.getPolygons();for(var h=0;h<b.length;h++)this.drawPolygon(a,b[h],c,d,e,f,g);return f};Mcx3DCanvas.prototype.drawMultiLine=function(a,b,c,d,e){b=b.getLines();for(var f=0;f<b.length;f++)this.drawLine(a,b[f],c,d,e)};
Mcx3DCanvas.prototype.drawPolygon=function(a,b,c,d,e,f,g){a=this.removeDuplicate(b.getShell().getPoints());b=[];for(e=0;e<a.length;e++)b.push(new this.threeLib.Vector2(Math.round(a[e].getX()),Math.round(a[e].getY())));c.amount=d;d=new THREE.Shape(b);c=new THREE.ExtrudeGeometry(d,c);THREE.GeometryUtils.merge(f,c)};
Mcx3DCanvas.prototype.drawLine=function(a,b,c,d,e){b=b.getPoints();c=new this.threeLib.Geometry;for(d=0;d<b.length;d++)c.vertices.push(new this.threeLib.Vector3(Math.round(b[d].getX()),Math.round(b[d].getY()),0));e=new THREE.Line(c,e);a.add(e)};
Mcx3DCanvas.prototype.getAppropriatePainter=function(a){var b=null,c=a.getSymbolizer();if(null==c)var d=a.getLayer().getSymbolizer();var e=a.getGeometry();if(!e)return null;e.isInstanceOf(McxGeometryType.Point)?(b=new McxPointPainter,null==c?b.setSymbolizer(d.getPointSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.LineString)?(b=new McxLineStringPainter,null==c?b.setSymbolizer(d.getLineSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.Polygon)?(b=new McxPolygonPainter,
null==c?b.setSymbolizer(d.getPolygonSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiPoint)?(b=new McxMultiPointPainter,null==c?b.setSymbolizer(d.getPointSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiLineString)?(b=new McxMultiLinePainter,null==c?b.setSymbolizer(d.getLineSymbolizer()):b.setSymbolizer(c)):e.isInstanceOf(McxGeometryType.MultiPolygon)&&(b=new McxMultiPolygonPainter,null==c?b.setSymbolizer(d.getPolygonSymbolizer()):b.setSymbolizer(c));if(null!=
b){c=null;d=a.getLayer().getSubtypes();if(0<d.getCount())for(e=0;e<d.getCount();e++){var f=d.getAt(e);if(!f.isVisible())return null;if(f.getScript().run(a)){c=f.getSymbolizer();break}}d=a.getSymbolizer();if(b.isInstanceOf("McxPointPainter")||b.isInstanceOf("McxMultiPointPainter"))null!=d&&d.isInstanceOf("IMcxPointSymbolizer")&&this.base.layer.getPainterMode()==McxPainterMode.ByFeature?b.setSymbolizer(d):null!=d&&d.isInstanceOf("IMcxTextSymbolizer")&&this.base.layer.getPainterMode()==McxPainterMode.ByFeature?
b.setSymbolizer(d):null!=c&&null!=c.getPointSymbolizer()?b.setSymbolizer(c.getPointSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getPointSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getPointSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultPointSymbolizer());else if(b.isInstanceOf("McxLineStringPainter")||b.isInstanceOf("McxMultiLinePainter"))null!=d&&d.isInstanceOf("IMcxLineSymbolizer")&&this.base.layer.getPainterMode()==McxPainterMode.ByFeature?
b.setSymbolizer(a.getSymbolizer()):null!=c&&null!=c.getLineSymbolizer()?b.setSymbolizer(c.getLineSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getLineSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getLineSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultLineSymbolizer());else if(b.isInstanceOf("McxPolygonPainter")||b.isInstanceOf("McxMultiPolygonPainter"))null!=d&&d.isInstanceOf("IMcxPolygonSymbolizer")&&this.base.layer.getPainterMode()==
McxPainterMode.ByFeature?b.setSymbolizer(d):null!=c&&null!=c.getPolygonSymbolizer()?b.setSymbolizer(c.getPolygonSymbolizer()):null!=a.getLayer().getSymbolizer()&&null!=a.getLayer().getSymbolizer().getPolygonSymbolizer()?b.setSymbolizer(a.getLayer().getSymbolizer().getPolygonSymbolizer()):b.setSymbolizer(McxFactoryFinder.StyleFactory().getDefaultPolygonSymbolizer())}return b};
Mcx3DCanvas.prototype.getThreeColor=function(a){var b=McxColor.extractColorAndAlpha(a);a=new McxColor;a.setColorFromHex(b.color);b={};b.r=a.getRed()/255;b.g=a.getGreen()/255;b.b=a.getBlue()/255;return b};Mcx3DCanvas.prototype.setMapExtend=function(a){this.mapExtend=a};
Mcx3DCanvas.prototype.sortCells=function(a){for(var b=[],c=[],d=[],e=0;e<a.length;e++){var f=this.transformCellToTarget(a[e],this.layer.getCoordinateSystem()),g=f.getIndexX().toString()+" "+f.getIndexY().toString();-1<this.paintedCells.indexOf(g)||(c.push(a[e]),f=this.getDistance(f),d.push(f))}a=this.bubbleSort(d);for(d=0;d<a.length;d++)b.push(c[a[d]]);return b};Mcx3DCanvas.prototype.getDistance=function(a){a=a.getDisplay().getCentroid();a=new THREE.Vector3(a.x,a.y,0);return this.map.getRenderer().getCamera().position.distanceTo(a)};
Mcx3DCanvas.prototype.bubbleSort=function(a){var b,c,d,e=[];for(b=0;b<a.length;b++)e.push(b);for(b=0;b<a.length-1;++b)for(c=0;c<a.length-1-b;++c)a[c]>a[c+1]&&(d=a[c+1],a[c+1]=a[c],a[c]=d,d=e[c+1],e[c+1]=e[c],e[c]=d);return e};
Mcx3DCanvas.prototype.drawObject=function(a,b,c,d){var e=this;(new THREE.OBJLoader(this.manager)).load(a.getObjFilePath(),function(f){f.traverse(function(g){f.rotation.x=a.getRotateX();f.rotation.y=a.getRotateY();f.rotation.z=a.getRotateZ();f.position.x=b;f.position.y=c;f.position.z=d;f.scale.set(a.getScaleX(),a.getScaleY(),a.getScaleZ());e.scene.add(f)})})};js.framework.mapping.Mcx3D.Mcx3DCanvasProvider={};function Mcx3DCanvasProvider(a){this.scene=a}
Mcx3DCanvasProvider.prototype.createCanvas=function(a,b){var c=null;a.getDataSourceName();if(!a.isInstanceOf("McxMemLayer"))if(a.isInstanceOf("McxFsLayer")){for(var c=new Mcx3DCanvas(a,b,this.scene),d=a.getSchema().getFieldCount(),e="",f=0;f<d;f++){var g=a.getSchema().getField(f).getFieldName();if("geometry_z"==g.toLowerCase()||"z"==g.toLowerCase())e=g}""!=e&&c.setHeightFieldName(e)}else a.isInstanceOf("McxTileLayer")||a.isInstanceOf("McxOrthophotoLayer")||a.isInstanceOf("McxCacheLayer")||a.isInstanceOf("McxWmsLayer");
return c};js.framework.mapping.Mcx3D.Mcx3DGrid={};function Mcx3DGrid(a,b,c,d){this.map=a;this.baseWorld=c;this.baseDisplay=d;this.tileSize=this.map.getTileSize();this.display=this.world=null;this.cells=[];this.baseCells=[];this.initialize(b)}
Mcx3DGrid.prototype.initialize=function(a){if(null==a)this.display=this.map.getDisplay(),this.world=this.map.getWorld();else{this.world=a;var b=this.worldToView(a.getLeft(),a.getTop()),c=this.worldToView(a.getRight(),a.getBottom());a=Math.floor(Math.min(b.x,c.x));var d=Math.ceil(Math.max(b.x,c.x)),e=Math.floor(Math.min(b.y,c.y)),b=Math.ceil(Math.max(b.y,c.y));this.display=new McxBounds(a,e,d+1,b+1,null)}};
Mcx3DGrid.prototype.calculate=function(){var a=this.getPixelScale(),b=a*this.tileSize.getWidth(),a=a*this.tileSize.getHeight(),c=Math.floor(this.world.left/b),d=c*b,c=Math.floor(this.world.bottom/a),e=c*a,c=Math.ceil(this.world.right/b),f=c*b,c=Math.ceil(this.world.top/a);this.world=new McxBounds(d,e,f,c*a,this.world.getCoordinateSystem());var c=Math.round(this.world.getWidth()/b),d=Math.round(this.world.getHeight()/a),e=Math.round(this.world.left/b),f=Math.round(this.world.top/a),g=new McxPoint(this.world.left,
this.world.top,this.world.getCoordinateSystem());this.cells=[];for(var h=0;h<c;h++)for(var k=0;k<d;k++){var m=g.x+h*b,n=g.x+(h+1)*b,p=g.y-(k+1)*a,q=g.y-k*a,r=Math.min(m,n),t=Math.min(p,q),m=Math.max(m,n),q=Math.max(p,q),p=new McxBounds(r,t,m,q,this.world.getCoordinateSystem()),r=this.map.worldToView(r,q),n=this.map.worldToView(m,t),t=Math.min(r.x,n.x),m=Math.min(r.y,n.y),q=Math.max(r.x,n.x),r=Math.max(r.y,n.y),t=new McxBounds(t,m,q,r,this.map.getCoordinateSystem()),p=new McxCell(h+e,f-k-1,p,t);this.cells.push(p)}};
Mcx3DGrid.prototype.getCellsOnBaseWorld=function(){return this.baseCells};Mcx3DGrid.prototype.findCell=function(a,b){if(a<this.display.left||a>this.display.right||b<this.display.bottom||b>this.display.top)return null;for(var c=b-this.display.bottom,d=Math.ceil((a-this.display.left)/this.tileSize.getWidth())-1,c=Math.ceil(c/this.tileSize.getHeight())-1,e=0;e<this.cells.length;e++)if(this.cells[e].getIndexX()==d&&this.cells[e].getIndexY()==c)return this.cells[e];return null};
Mcx3DGrid.prototype.getCells=function(){return this.cells};Mcx3DGrid.prototype.getPixelScale=function(){var a=Math.sqrt(this.baseWorld.getWidth()*this.baseWorld.getWidth()+this.baseWorld.getHeight()*this.baseWorld.getHeight()),b=Math.sqrt(this.baseDisplay.getWidth()*this.baseDisplay.getWidth()+this.baseDisplay.getHeight()*this.baseDisplay.getHeight());return a/b};
Mcx3DGrid.prototype.worldToView=function(a,b){var c=this.baseWorld.right-this.baseWorld.left,d=this.baseWorld.top-this.baseWorld.bottom;if(0>=c||0>=d)return null;var e=this.baseDisplay.top-this.baseDisplay.bottom,d=this.baseDisplay.bottom+(e-e/d*(b+-this.baseWorld.bottom));return new McxPoint(Math.round(this.baseDisplay.left+(this.baseDisplay.right-this.baseDisplay.left)/c*(a+-this.baseWorld.left)),Math.round(d),null)};js.framework.mapping.Mcx3D.Mcx3DImageCanvas={};
function Mcx3DImageCanvas(a,b,c,d){this.world=d;this.display=b.getDisplay();this.scene=c;this.layer=a;this.canvasId=McxGuid.createGuid();this.layerId=McxGuid.createGuid();this.height=this.width=0;this.isDirty=!1;this.map=b;this.paintedFeatures=new McxPaintedFeatures(15E3);this.requestName=0;this.requests=[];this.requestsCanceled=!1;this.rendererEventHandler=new McxEventHandler;this.labelRendererEventHandler=new McxEventHandler;this.zIndex=this.map.getLayers().getCount()+1;this.backBuffered=!0;this.totalProgress=
this.translateY=this.translateX=0;this.setOpacity(this.layer.getOpacity());this.crossOrigin=""}Mcx3DImageCanvas.prototype.canAddLayer=function(a){return!0};Mcx3DImageCanvas.prototype.addLayer=function(a){};Mcx3DImageCanvas.prototype.getLayers=function(){return[this.layer]};
Mcx3DImageCanvas.prototype.onSearchSuccess=function(a){var b=a.getFeatureReader(),c=a.getArgs()[2];c.getDisplay();var d=a.getArgs()[3],e=d.getMap().getPixelScale();a=a.getArgs()[4];if(0==Math.abs(e-a)&&(c=c.getWorld(),a=e=d.getMap().getWorld(),a=d.getLayer().getCoordinateSystem(),a=null==e.getCoordinateSystem()||e.getCoordinateSystem().equals(a)?e:e.transformTo(a),a.intersectsBounds(c)))for(;b.read();){if(d.requestsCanceled){this.totalProgress=0;b=new McxRendererEventArgs(McxRendererStatus.Canceled);
this.rendererEventHandler.dispatchOnSuccess(this,b);return}(c=b.getCurrent())&&c.getGeometry()&&this.paint(c)}this.totalProgress--;0==this.totalProgress&&(b=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,b))};Mcx3DImageCanvas.prototype.setCrossOrigin=function(a){this.crossOrigin=a};Mcx3DImageCanvas.prototype.paint=function(a){};
Mcx3DImageCanvas.prototype.paintLayer=function(a){this.backBuffered||$("#"+this.layerId+"_backBuffer").children("*").fadeTo(2E3,0);var b=function(){this.totalProgress--;if(0==this.totalProgress){var a=new McxRendererEventArgs(McxRendererStatus.End);this.rendererEventHandler.dispatchOnSuccess(this,a)}};if(this.map.inVisibleRange(this.layer.getMinScale(),this.layer.getMaxScale()))if(this.requestsCanceled=!1,this.isDirty&&(this.clearCanvas(),this.isDirty=!1),this.layer.getVisible()){var c=this.layer.getKeyField()+
","+this.layer.getGeometryField(),d=this.map.getPixelScale(),e,f=e=this.map.getWorld();null==this.map.getCoordinateSystem()||f.getCoordinateSystem().equals(this.layer.getCoordinateSystem())||(e=f.transformTo(this.layer.getCoordinateSystem()));this.layer.isSingleTile()&&(a=[new McxCell(0,0,e,this.map.getDisplay())]);this.totalProgress=a.length;for(e=0;e<a.length;e++){var f=null,f=this.transformCellToTarget(a[e],this.layer.getCoordinateSystem()),g=[];g.push(this.map.getWorld());g.push(this.map.getDisplay());
g.push(f);g.push(this);g.push(d);g.push(this.map);var h=new McxAjaxParameter;h.setParameters(this,this.onSearchSuccess,b);h.setArgs(g);f=this.layer.searchByEnvelope(c,"",f.getWorld(),"Intersects",h);this.requests.push(f)}}else this.clearCanvas(),this.clearBackBuffer();else this.clearCanvas()};Mcx3DImageCanvas.prototype.draw=function(a,b){};Mcx3DImageCanvas.prototype.drawLabels=function(a,b){};Mcx3DImageCanvas.prototype.paintLabels=function(a){};
Mcx3DImageCanvas.prototype.transformCellToTarget=function(a,b){if(null==this.map.getCoordinateSystem()||null==b||this.map.getCoordinateSystem().getCode()==b.getCode())return a;var c=a.getWorld().transformTo(b);return new McxCell(a.getIndexX(),a.getIndexY(),c,a.getDisplay())};Mcx3DImageCanvas.prototype.abortRender=function(){this.requestsCanceled=!0;for(var a=0;a<this.requests.length;a++)this.requests[a].abort(),a==this.requests.length-1&&(this.requests=[]);this.requests=[]};
Mcx3DImageCanvas.prototype.getRendererEventHandler=function(){return this.rendererEventHandler};Mcx3DImageCanvas.prototype.getLabelRendererEventHandler=function(){return this.labelRendererEventHandler};Mcx3DImageCanvas.prototype.onDisplayChanged=function(a,b){this.isDirty=!0;this.width=a;this.height=b};Mcx3DImageCanvas.prototype.setDisplay=function(a,b){this.isDirty=!0;this.width=a;this.height=b};Mcx3DImageCanvas.prototype.getPaintedFeatures=function(){return this.paintedFeatures};
Mcx3DImageCanvas.prototype.clearCache=function(){this.paintedFeatures.clear()};Mcx3DImageCanvas.prototype.getLayer=function(){return this.layer};Mcx3DImageCanvas.prototype.getMap=function(){return this.map};Mcx3DImageCanvas.prototype.paintSelection=function(){};Mcx3DImageCanvas.prototype.isInstanceOf=function(a){return"Mcx3DImageCanvas"==a};Mcx3DImageCanvas.prototype.clearCanvas=function(){$("#"+this.layerId+"_divContainer").empty()};
Mcx3DImageCanvas.prototype.zoomTo=function(a,b,c){var d=$("#"+this.layerId+"_zoom");d.css("-webkit-transform-origin",a+"px "+b+"px").css("-moz-transform-origin",a+"px "+b+"px").css("-ms-transform-origin",a+"px "+b+"px").css("-o-transform-origin",a+"px "+b+"px").css("transform-origin",a+"px "+b+"px");d.css("-webkit-transform","scale("+c+")").css("-moz-transform","scale("+c+")").css("-ms-transform","scale("+c+")").css("-o-transform","scale("+c+")").css("transform","scale("+c+")")};
Mcx3DImageCanvas.prototype.dispose=function(){$("#"+this.layerId).remove()};Mcx3DImageCanvas.prototype.translate=function(a,b){0!=this.map.getPixelScale()&&(this.translateX+=-1*a/this.map.getPixelScale(),this.translateY+=b/this.map.getPixelScale())};Mcx3DImageCanvas.prototype.resetTranslation=function(){this.translateY=this.translateX=0};Mcx3DImageCanvas.prototype.clearBackBuffer=function(){$("#"+this.layerId+"_zoom").empty();$("#"+this.layerId+"_backBuffer").empty()};
Mcx3DImageCanvas.prototype.paintBackBuffer=function(){$("#"+this.layerId+"_divContainer").children("*").appendTo("#"+this.layerId+"_zoom")};Mcx3DImageCanvas.prototype.setZoomAnimationClass=function(a){var b=$("#"+this.layerId+"_zoom");b.removeClass();b.addClass(a)};
Mcx3DImageCanvas.prototype.resetZoomAnimationClass=function(){var a=$("#"+this.layerId+"_zoom");a.children("*").appendTo("#"+this.layerId+"_backBuffer");var b=$("#"+this.layerId+"_backBuffer");b.css("-webkit-transform-origin",a.css("-webkit-transform-origin")).css("-moz-transform-origin",a.css("-moz-transform-origin")).css("-o-transform-origin",a.css("-o-transform-origin")).css("-ms-transform-origin",a.css("-ms-transform-origin")).css("transform-origin",a.css("transform-origin"));b.css("-webkit-transform",
a.css("-webkit-transform")).css("-moz-transform",a.css("-moz-transform")).css("-o-transform",a.css("-o-transform")).css("-ms-transform",a.css("-ms-transform")).css("transform",a.css("transform"));a.css("-webkit-transform","scale(1)").css("-moz-transform","scale(1)").css("-ms-transform","scale(1)").css("-o-transform","scale(1)").css("transform","scale(1)")};
Mcx3DImageCanvas.prototype.setOrder=function(a){$("#"+this.layerId).css("zIndex",a);$("#"+this.layerId+"_divContainer").css("zIndex",a);$("#"+this.layerId+"_backBuffer").css("zIndex",a-1);$("#"+this.layerId+"_zoom").css("zIndex",a-1)};Mcx3DImageCanvas.prototype.setOpacity=function(a){this.layer.setOpacity(a);$("#"+this.layerId).css("opacity",a)};Mcx3DImageCanvas.prototype.backBufferEnabled=function(a){this.backBuffered=a};
Mcx3DImageCanvas.prototype.worldToView=function(a,b){var c=this.world.right-this.world.left,d=this.world.top-this.world.bottom;if(0>=c||0>=d)return null;var e=this.display.top-this.display.bottom,d=this.display.bottom+(e-e/d*(b+-this.world.bottom));return new McxPoint(Math.round(this.display.left+(this.display.right-this.display.left)/c*(a+-this.world.left)),Math.round(d),null)};Mcx3DImageCanvas.prototype.setMapExtend=function(a){this.world=a};js.framework.mapping.Mcx3D.Mcx3DRenderer={};
function Mcx3DRenderer(a,b,c){this.heightField="";this.threeLib=McxLib.THREE();this.baseWorld=b;this.baseDisplay=c;this.canReset=!1;this.lastWorld=new McxBounds(0,0,0,0,null);this.base=this;this.camera=null;this.farDistance=1E4;this.nearDistance=5;this.cameraPosition=new this.threeLib.Vector3(a.getDisplay().getWidth()/2,a.getDisplay().getHeight()/2,-1200);this.scene=null;this.alertTimerId=0;this.animationActive=!0;this.panAnimationClass=this.animationClass="back-buffer-animation-off";this.canvases=
[];this.map=a;this.mapInitialExtend=null;this.layerAdded=new McxEventHandler;this.layerRemoved=new McxEventHandler;this.onLayerOrderChangeHandler=new McxEventHandler;this.activeLayerChanged=new McxEventHandler;this.selectionCanvas=this.labelCanvas=this.sketchCanvas=this.activeLayer=null;this.scaleLevel=1;this.totalProgress=this.screenYCoord=this.screenXCoord=0;this.rendererStartEventHandler=new McxEventHandler;this.rendererEndEventHandler=new McxEventHandler;this.canvasProviders=[];this.firstPass=
!0;this.translateY=this.translateX=0;this.durationChanged=!1;this.renderer=null;this.setPanAnimationClass("back-buffer-ease-in-out");this.initialize()}Mcx3DRenderer.prototype.initialize=function(){this.initialize3DEnvironment();var a=new THREE.LoadingManager;a.onProgress=function(a,c,d){console.log(a,c,d)};new THREE.OBJLoader(a)};
Mcx3DRenderer.prototype.initialize3DEnvironment=function(){function a(){clearTimeout(c.alertTimerId);c.map.getRenderer().abortRender();c.alertTimerId=setTimeout(function(){var a=c.calculateVisibleArea();null==a||a.equals(c.lastWorld)||c.map.getRenderer().paintLayer(null,a)},1500)}var b=document.getElementById(this.base.map.getName());$(b).css("backface-visibility","hidden").css("-webkit-backface-visibility","hidden").css("-moz-backface-visibility","hidden");var c=this;this.renderer=new this.threeLib.WebGLRenderer({antialias:!0,
clearAlpha:1,alpha:!0});this.renderer.setSize(window.innerWidth,window.innerHeight);this.renderer.setClearColorHex(11193548,1);b.addEventListener("mouseup",a,!1);b.addEventListener("mousewheel",a,!1);b.addEventListener("DOMMouseScroll",a,!1);this.renderer.domElement.id="gizem";this.renderer.style="position: absolute; left: 0px; top: 0px; z-index: 1000;";b.appendChild(this.renderer.domElement);$(this.renderer.domElement).css({position:"absolute",top:0});this.camera=new this.threeLib.PerspectiveCamera(45,
window.innerWidth/window.innerHeight,this.nearDistance,this.farDistance);this.camera.position.z=this.cameraPosition.z;this.camera.position.x=this.cameraPosition.x;this.camera.position.y=this.cameraPosition.y;this.camera.up=new THREE.Vector3(0,-1,0);b=new THREE.AmbientLight(1118481);this.camera.lookAt(new THREE.Vector3(this.map.getDisplay().getWidth()/2,this.map.getDisplay().getHeight()/2,0));this.scene=new this.threeLib.Scene;this.scene.add(b);b=new THREE.PointLight(15658734);b.position.set(this.cameraPosition.x,
this.cameraPosition.y,this.cameraPosition.z);this.scene.add(b);b=new THREE.AmbientLight(7829367);this.scene.add(b);b=new THREE.DirectionalLight(16777215,.7);b.position.set(1,1,1).normalize();this.scene.add(b);this.refreshScene()};
Mcx3DRenderer.prototype.paintLayer=function(a,b,c){var d=this.map.getWorld();null==this.mapInitialExtend&&0<d.getWidth()&&0<d.getHeight()&&(this.mapInitialExtend=d);d=!1;null==b&&(this.firstPass=d=!0);null==a&&(a=this.toLayerArray());a instanceof Array||(a=[a]);this.totalProgress=a.length;var e=[];b instanceof Array||(b=[b]);for(var f=0;f<b.length;f++){var g=new Mcx3DGrid(this.map,b[f],this.baseWorld,this.baseDisplay);g.calculate();for(var h=0;h<g.cells.length;h++){for(var k=!1,m=0;m<e.length;m++)if(g.cells[h].getIndexX()==
e[m].getIndexX()&&g.cells[h].getIndexY()==e[m].getIndexY()){k=!0;break}k||e.push(g.cells[h])}}for(h=0;h<this.canvases.length;h++)for(f=0;f<a.length;f++)if(a[f].getClassId()==this.canvases[h].getLayer().getClassId()){d&&(this.canvases[h].clearCache(),this.canvases[h].clearCanvas());this.canvases[h].getRendererEventHandler().removeListener(this.onRenderFinish);this.canvases[h].getRendererEventHandler().addListener(this.onRenderFinish,this.onRenderFinish,this);this.canvases[h].setMapExtend(this.mapInitialExtend);
this.canvases[h].paintLayer(e,c);break}this.paintNonLayer();this.paintSelections()};
Mcx3DRenderer.prototype.draw=function(a,b,c){var d=!1;null==c&&(d=!0,null!=this.map.getLayers().getLabelCanvas()&&this.map.getLayers().getLabelCanvas().clear());null==b&&(b=this.toLayerArray());b instanceof Array||(b=[b]);this.totalProgress=b.length;var e=[];c instanceof Array||(c=[c]);for(var f=0;f<c.length;f++){var g=new Mcx3DGrid(this.map,c[f],this.baseWorld,this.baseDisplay);g.calculate();e=e.concat(g.getCells())}for(c=0;c<this.canvases.length;c++)for(f=0;f<b.length;f++)if(b[f].getClassId()==
this.canvases[c].getLayer().getClassId()){if(this.canvases[c].isInstanceOf("McxImageCanvas")){this.totalProgress--;0==this.totalProgress&&(f=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEndEventHandler.dispatchOnSuccess(this,f));break}this.canvases[c].clearCache();d&&this.canvases[c].clearCanvas();this.canvases[c].getRendererEventHandler().removeListener(this.onRenderFinish);this.canvases[c].getRendererEventHandler().addListener(this.onRenderFinish,this.onRenderFinish,this);this.canvases[c].draw(a,
e);break}this.paintNonLayer();this.paintSelections()};Mcx3DRenderer.prototype.onRenderFinish=function(){this.totalProgress--;if(0==this.totalProgress){var a=new McxRendererEventArgs(McxRendererStatus.End);this.rendererEndEventHandler.dispatchOnSuccess(this,a)}};
Mcx3DRenderer.prototype.paintLabels=function(){var a=new McxGrid(this.map,null);a.calculate();this.map.getLayers().getLabelCanvas().clear();for(var b=this.map.getLayers(),c=0;c<b.getCount();c++){var d=b.getAt(c);d.getVisible()&&d.isShowLabels()&&d.isSelectable()&&b.getCanvasByIndex(c).paintLabels(a.cells)}};Mcx3DRenderer.prototype.drawGrips=function(a){};Mcx3DRenderer.prototype.paintSelections=function(){};Mcx3DRenderer.prototype.paintNonLayer=function(){};
Mcx3DRenderer.prototype.drawMarkers=function(a){$("#"+this.map.getName()+"_markerContainer").empty();var b=this.map.getMarkerCollection();if(!(0>b.getCount()))for(var c=0;c<b.getCount();c++)b.getMarker(c).paint(a)};Mcx3DRenderer.prototype.drawControllers=function(a){null!=this.map.getInputHandler().getController()&&this.map.getInputHandler().getController().paint(a)};
Mcx3DRenderer.prototype.zoomTo=function(a,b,c){clearTimeout(this.alertTimerId);if(McxMobile.isMobile.any())this.zoomToMobile(a,b,c);else{var d=this.map.worldToView(b,c),e=this;this.scaleLevel*=a;a=1/this.scaleLevel;for(var f=this.scaleLevel,g=d.x-this.translateX,d=d.y-this.translateY,h=0;h<this.canvases.length;h++)this.firstPass&&this.canvases[h].clearBackBuffer(),this.canvases[h].paintBackBuffer(),this.canvases[h].zoomTo(g,d,a);this.labelCanvas.paintBackBuffer();this.labelCanvas.zoomTo(g,d,a);this.firstPass=
!1;this.alertTimerId=setTimeout(function(){e.scaleLevel=1;e.screenXCoord=0;for(var a=e.screenYCoord=0;a<e.canvases.length;a++)e.canvases[a].resetZoomAnimationClass();e.labelCanvas.resetZoomAnimationClass();a=new McxPoint(b,c,e.map.getCoordinateSystem());a=e.map.getWorld().scale(f,a);e.map.setWorld(a.left,a.bottom,a.right,a.top);for(a=0;a<e.canvases.length;a++)e.canvases[a].clearCanvas();e.labelCanvas.clearCanvas();e.paintLayer(null,null);e.firstPass=!0},300)}};
Mcx3DRenderer.prototype.zoomToMobile=function(a,b,c){c=this.map.worldToView(b,c);b=c.x-this.translateX;c=c.y-this.translateY;for(var d=0;d<this.canvases.length;d++)this.firstPass&&this.canvases[d].clearBackBuffer(),this.canvases[d].paintBackBuffer(),this.canvases[d].zoomTo(b,c,a);this.firstPass=!1;this.labelCanvas.paintBackBuffer();this.labelCanvas.zoomTo(b,c,a)};Mcx3DRenderer.prototype.getCount=function(){return this.canvases.length};Mcx3DRenderer.prototype.getAt=function(a){return this.canvases[a].getLayer()};
Mcx3DRenderer.prototype.add=function(a){this.insert(this.canvases.length,a);this.adjustOrder();if(null==this.activeLayer||a.isInstanceOf("McxMemLayer"))this.activeLayer=a,this.activeLayerChanged.dispatchOnSuccess(this,new McxEventArgs(null))};Mcx3DRenderer.prototype.getActiveLayer=function(){return this.activeLayer};Mcx3DRenderer.prototype.setActiveLayer=function(a){this.activeLayer=a;this.activeLayerChanged.dispatchOnSuccess(this,new McxEventArgs(null))};
Mcx3DRenderer.prototype.insert=function(a,b){var c=this.map.getDisplay().getWidth(),d=this.map.getDisplay().getHeight(),e=this.map.getWorld().getWidth(),f=this.map.getWorld().getHeight(),g=!1;0>=this.canvases.length&&0==e&&0==f&&(g=!0);null==this.map.getCoordinateSystem()&&0==this.canvases.length&&this.map.setCoordinateSystem(b.getCoordinateSystem());a>this.canvases.length&&(a=this.canvases.length);e=null;for(f=0;f<this.canvasProviders.length;f++){e=this.canvasProviders[f].createCanvas(b,this.map);
if(null==e)break;e.setHeightFieldName(this.heightField)}if(null!=e){e.setDisplay(c,d);a>=this.canvases.length?this.canvases.push(e):this.canvases.splice(a,0,e);if(g){c=new McxAjaxParameter;c.setAsync(!1);c=b.getEnvelope(c).getEnvelope();if(null==c){this.layerAdded.dispatchOnSuccess(this,new McxLayerEventArgs(b));return}c=c.transformTo(this.map.getCoordinateSystem());this.map.setWorld(c.getLeft(),c.getBottom(),c.getRight(),c.getTop())}this.layerAdded.dispatchOnSuccess(this,new McxLayerEventArgs(b))}};
Mcx3DRenderer.prototype.removeAt=function(a){this.canvases[a].dispose();var b=this.canvases[a].getLayer();this.canvases.splice(a,1);b.getClassId()==this.activeLayer.getClassId()&&(this.activeLayer=0==this.canvases.length?null:this.canvases[0].getLayer(),this.activeLayerChanged.dispatchOnSuccess(this,new McxEventArgs(null)));this.layerRemoved.dispatchOnSuccess(this,new McxLayerEventArgs(b))};Mcx3DRenderer.prototype.remove=function(a){a=this.indexOf(a);if(0>a)return!1;this.removeAt(a);return!0};
Mcx3DRenderer.prototype.indexOf=function(a){for(var b=0;b<this.canvases.length;b++)if(this.canvases[b].getLayer()==a)return b;return-1};Mcx3DRenderer.prototype.onLayerAdded=function(){return this.layerAdded};Mcx3DRenderer.prototype.onLayerRemoved=function(){return this.layerRemoved};Mcx3DRenderer.prototype.onActiveLayerChanged=function(){return this.activeLayerChanged};
Mcx3DRenderer.prototype.changeOrder=function(a,b){var c=this.getCanvasByLayer(a),d=this.indexOf(a);this.canvases.splice(d,1);this.canvases.splice(b,0,c);this.adjustOrder();this.getLayerOrderChangeHandler().dispatchOnSuccess(this,null)};Mcx3DRenderer.prototype.getCanvasByIndex=function(a){return this.canvases[a]};Mcx3DRenderer.prototype.getCanvasByLayer=function(a){for(var b=0;b<this.canvases.length;b++)if(this.canvases[b].getLayer()==a)return this.canvases[b];return null};
Mcx3DRenderer.prototype.removeCanvas=function(a){a=document.getElementById(a);a.parentNode.removeChild(a)};Mcx3DRenderer.prototype.adjustOrder=function(){for(var a=0;a<this.canvases.length;a++)this.canvases[a].setOrder(a)};Mcx3DRenderer.prototype.toLayerArray=function(){for(var a=[],b=0;b<this.canvases.length;b++)a.push(this.canvases[b].getLayer());return a};
Mcx3DRenderer.prototype.abortRender=function(){for(var a=0;a<this.getCount();a++)this.getCanvasByIndex(a).abortRender();this.totalProgress=0;a=new McxRendererEventArgs(McxRendererStatus.Canceled);this.rendererEndEventHandler.dispatchOnSuccess(this,a)};Mcx3DRenderer.prototype.getRendererStartEventHandler=function(){return this.rendererStartEventHandler};Mcx3DRenderer.prototype.getRendererEndEventHandler=function(){return this.rendererEndEventHandler};
Mcx3DRenderer.prototype.addCanvasProvider=function(a){var b=[];b.push(a);this.canvasProviders=b=b.concat(this.canvasProviders);return!0};Mcx3DRenderer.prototype.removeCanvasProvider=function(a){for(var b=0;b<this.canvasProviders.length;b++)if(this.canvasProviders[b]==a){this.canvasProviders.splice(b,1);break}};
Mcx3DRenderer.prototype.setZoomAnimationClass=function(a){if(this.animationClass!=a){this.animationClass=a;for(var b=0;b<this.canvases.length;b++)this.canvases[b].setZoomAnimationClass(this.animationClass);this.labelCanvas.setZoomAnimationClass(this.animationClass);this.setPanAnimationClass(a)}};Mcx3DRenderer.prototype.setPanAnimationClass=function(a){var b=$("#"+this.map.getName()+"_layerContainer");b.removeClass();this.panAnimationClass=a;b.addClass(a)};
Mcx3DRenderer.prototype.getZoomAnimationClass=function(){return this.animationClass};Mcx3DRenderer.prototype.getPanAnimationClass=function(){return this.panAnimationClass};
Mcx3DRenderer.prototype.translate=function(a,b,c){if(!isNaN(a)&&!isNaN(b)){for(var d=this.map.getPixelScale(),e=a/d*-1,d=b/d,f=0;f<this.canvases.length;f++)this.canvases[f].translate(a,b);this.labelCanvas.translate(a,b);this.map.setWorld(this.map.getWorld().left+a,this.map.getWorld().bottom+b,this.map.getWorld().right+a,this.map.getWorld().top+b);this.translateX+=e;this.translateY+=d;a=$("#"+this.map.getName()+"_layerContainer");!this.animationActive||!McxMobile.isMobile.iOS()&&McxMobile.isMobile.any()||
(c?(c="0.5s",a.css("transition-duration",c).css("-webkit-transition-duration",c).css("-moz-transition-duration",c).css("-ms-transition-duration",c).css("-o-transition-duration",c),this.durationChanged=!0):this.durationChanged&&(c="0s",a.css("transition-duration",c).css("-webkit-transition-duration",c).css("-moz-transition-duration",c).css("-ms-transition-duration",c).css("-o-transition-duration",c),this.durationChanged=!1));a.css("-webkit-transform","translate3d("+this.translateX+"px, "+this.translateY+
"px, 0)").css("-moz-transform","translate3d("+this.translateX+"px, "+this.translateY+"px,0)").css("-ms-transform","translate3d("+this.translateX+"px, "+this.translateY+"px,0)").css("-o-transform","translate3d("+this.translateX+"px, "+this.translateY+"px,0)").css("transform","translate3d("+this.translateX+"px, "+this.translateY+"px,0)")}};Mcx3DRenderer.prototype.setLayerOpacity=function(a,b){this.getCanvasByLayer(a).setOpacity(b)};Mcx3DRenderer.prototype.clearBackBuffer=function(){for(var a=0;a<this.canvases.length;a++)this.canvases[a].clearBackBuffer()};
Mcx3DRenderer.prototype.getLayerOrderChangeHandler=function(){return this.onLayerOrderChangeHandler};
Mcx3DRenderer.prototype.addCanvas=function(a){a.translate(-1*this.translateX*this.map.getPixelScale(),this.translateY*this.map.getPixelScale());var b=this.map.getDisplay().getWidth(),c=this.map.getDisplay().getHeight(),d=!1,e=a.getLayer();0>=this.canvases.length&&0==b&&0==c&&(d=!0);null!=a.getLayer()&&null==this.map.getCoordinateSystem()&&0==this.canvases.length&&this.map.setCoordinateSystem(a.getLayer().getCoordinateSystem());if(null==this.sketchCanvas){var f=this.map.getName()+"_markerContainer",
g=$("#"+f);0==g.length&&(g=$("<div/>").attr("id",f).css("position","relative").css("width","100%").css("z-index",9999999).css("height","100%"));$("#"+this.map.getName()).append(g);this.sketchCanvas=new McxNonLayerCanvas(this.map,1E3);this.sketchCanvas.setDisplay(b,c)}null==this.labelCanvas&&(this.labelCanvas=new McxLabelCanvas(this.map),this.labelCanvas.setDisplay(b,c));null==this.selectionCanvas&&(this.selectionCanvas=new McxNonLayerCanvas(this.map,998),this.selectionCanvas.setDisplay(b,c));f=this.canvases.length;
a.setDisplay(b,c);f>=this.canvases.length?this.canvases.push(a):this.canvases.splice(f,0,a);if(d&&null!=e){a=new McxAjaxParameter;a.setAsync(!1);a=e.getEnvelope(a).getEnvelope();if(null==a){this.layerAdded.dispatchOnSuccess(this,new McxLayerEventArgs(e));return}this.map.setWorld(a.getLeft(),a.getBottom(),a.getRight(),a.getTop())}null!=e&&this.layerAdded.dispatchOnSuccess(this,new McxLayerEventArgs(e));this.adjustOrder()};Mcx3DRenderer.prototype.isAnimationActive=function(){};
Mcx3DRenderer.prototype.setAnimationActive=function(a){};Mcx3DRenderer.prototype.getScene=function(){return this.scene};Mcx3DRenderer.prototype.getCamera=function(){return this.camera};Mcx3DRenderer.prototype.getCurrentTarget=function(){var a=new THREE.Vector3(0,0,-100);this.camera.updateMatrixWorld();this.camera.matrixWorld.multiplyVector3(a);return a};
Mcx3DRenderer.prototype.calculateVisibleArea=function(){var a=new THREE.Projector,b=new THREE.Vector3(0/window.innerWidth*2-1,2*-(0/window.innerHeight)+1,.5);a.unprojectVector(b,this.camera);var b=b.sub(this.camera.position).normalize(),c=-this.camera.position.z/b.z,b=this.camera.position.clone().add(b.multiplyScalar(c)),c=new THREE.Vector3(window.innerWidth/window.innerWidth*2-1,2*-(window.innerHeight/window.innerHeight)+1,.5);a.unprojectVector(c,this.camera);var a=c.sub(this.camera.position).normalize(),
c=-this.camera.position.z/a.z,a=this.camera.position.clone().add(a.multiplyScalar(c)),d=this.getCurrentTarget(),c=(new THREE.Vector3(d.x,d.y,0)).distanceTo(this.camera.position),e=Math.abs(c),c=2*Math.tan(this.camera.fov/2)*e,f=c*this.camera.aspect,g=this.camera.position.clone(),h=new THREE.Vector3(0,1,0),k=new THREE.Vector3;k.subVectors(d,g);k.normalize();d=new THREE.Vector3;d.crossVectors(h,k);d.normalize();var m=k.clone(),k=new THREE.Vector3;k.addVectors(g,m.multiplyScalar(e));e=h.clone();g=d.clone();
m=new THREE.Vector3;m.addVectors(k,e.multiplyScalar(c/2));m.sub(g.multiplyScalar(f/2));e.copy(h);g.copy(d);e.y=-e.y;h=new THREE.Vector3;h.addVectors(k,e.multiplyScalar(c/2));h.add(g.multiplyScalar(f/2));if(0>=this.base.map.getWorld().getWidth()||0>=this.base.map.getWorld().getHeight())return null;b=this.map.viewToWorld(b.x,b.y);h=this.map.viewToWorld(a.x,a.y);a=Math.min(b.x,h.x);c=Math.max(b.x,h.x);f=Math.min(b.y,h.y);b=Math.max(b.y,h.y);return new McxBounds(a,f,c,b,null)};
Mcx3DRenderer.prototype.setCameraPosition=function(a,b,c){this.cameraPosition.x=a;this.cameraPosition.y=b;this.cameraPosition.z=c;this.camera.position.z=this.cameraPosition[2];this.camera.position.x=this.cameraPosition[0];this.camera.position.y=this.cameraPosition[1]};Mcx3DRenderer.prototype.refreshScene=function(){this.renderer.render(this.scene,this.camera);var a=this.map.getInputHandler().getController();a.update&&a.update(!1)};
Mcx3DRenderer.prototype.setHeightField=function(a){this.heightField=a};
js.framework.ui={};js.framework.ui.McxCommonControl={};js.framework.ui.McxCommonControl.IMcxMapInteractionFactory={};function IMcxMapInteractionFactory(){}IMcxMapInteractionFactory.prototype.createZoomLayerAction=function(a,b){};IMcxMapInteractionFactory.prototype.createZoomFeatureAction=function(a,b){};IMcxMapInteractionFactory.prototype.createBlinkAction=function(a,b){};IMcxMapInteractionFactory.prototype.createPanFeatureAction=function(a){};
IMcxMapInteractionFactory.prototype.createPanController=function(){};IMcxMapInteractionFactory.prototype.createIdentifyController=function(){};IMcxMapInteractionFactory.prototype.createSelectController=function(){};IMcxMapInteractionFactory.prototype.createMeasureController=function(){};IMcxMapInteractionFactory.prototype.createSelectOnActiveLayerController=function(a){};IMcxMapInteractionFactory.prototype.createZoomWindowController=function(){};
IMcxMapInteractionFactory.prototype.createCoordinateSystemSetterAction=function(){};IMcxMapInteractionFactory.prototype.quickSearchAction=function(a){};IMcxMapInteractionFactory.prototype.zoomLayersAction=function(a,b){};IMcxMapInteractionFactory.prototype.showCoordinateController=function(){};IMcxMapInteractionFactory.prototype.createZoomToBoundsAction=function(a,b){};IMcxMapInteractionFactory.prototype.createHighlightAction=function(a,b){};
IMcxMapInteractionFactory.prototype.createFeatureGridAction=function(a){};IMcxMapInteractionFactory.prototype.createPrintOptionsAction=function(){};IMcxMapInteractionFactory.prototype.createPrintRectangleController=function(a){};IMcxMapInteractionFactory.prototype.createBlinkGeometryAction=function(a,b){};IMcxMapInteractionFactory.prototype.createZoomGeometryAction=function(a,b){};js.framework.ui.McxCommonControl.McxButtonAuthorityHelper={};function McxButtonAuthorityHelper(){}var McxButtonAuthorityType={FeatureExplorerSaveAndDeleteButton:{key:"App.Main.FeatureExplorer.SaveButton",show:!0,state:0},FeatureExplorerMediaSaveAndDeleteButton:{key:"App.Main.FeatureExplorer.MediaPage.Buttons",show:!0,state:0},FeatureGridSaveAndDeleteButton:{key:"App.Main.FeatureGrid.Buttons",show:!0,state:0},WorkspaceViewTypeButton:{key:"App.Main.WorkspaceViewType.Button",show:!0,state:0}};
McxButtonAuthorityHelper.prototype.getButtonVisibility=function(a){if(!McxSettingsManager.isAvailable()||0!=a.state)return a.show;var b=new McxAjaxParameter;b.setAsync(!1);b=McxSettingsManager.read(a.key,b);a.state=1;a.show=!(b.getSettings()[0]&&"FALSE"==b.getSettings()[0]);return a.show};McxButtonAuthorityHelper.prototype.setButtonVisibility=function(a,b){a.show=b};McxButtonAuthorityHelper.instance=new McxButtonAuthorityHelper;js.framework.ui.McxCommonControl.McxHighLightMode={};var McxHighLightMode={AddToList:0,AddNew:1,ClearList:2};js.framework.ui.McxCommonControl.McxValidatorFunctions={};function McxValidatorFunctions(){}McxValidatorFunctions.emailRegex=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;McxValidatorFunctions.createRegexValidator=function(a){return function(a){return function(c){return a.test(c)}}(a)};McxValidatorFunctions.emailValidator=McxValidatorFunctions.createRegexValidator(McxValidatorFunctions.emailRegex);
McxValidatorFunctions.integerValidator=function(a){return a===parseInt(a,10)};js.framework.ui.McxCommonControl.AccordionContentDisplayer={};js.framework.ui.McxCommonControl.AccordionContentDisplayer.McxAccordionContentDisplayer={};
function McxAccordionContentDisplayer(a){mcx.base(this);this.base=this;this._rootElement=null;this._isToggleable=!0;this._text=a;this._contentContainer=this._toggleButton=null;this._contentSpan=new McxLayoutSpan(12);this._buttonsRow=new McxLayoutRow;this._isEnabeld=!1;this._isFloating=!0;this._cancelButton=this._okButton=null;this._beforeViewOpenHandler=new McxEventHandler;this._afterViewOpenHandler=new McxEventHandler;this._beforeViewCloseHandler=new McxEventHandler;this._afterViewCloseHandler=new McxEventHandler;
this.initialize();this.bindEvents()}mcx.inherits(McxAccordionContentDisplayer,McxUserControl);
McxAccordionContentDisplayer.prototype.initialize=function(){this._rootElement=$("<div/>").css("position","relative").addClass("mcx-content-displayer-root");this._toggleButton=new McxButton;this._toggleButton.setButtonSize(McxButtonSize.small);this._toggleButton.setButtonState(McxButtonState.active);this._toggleButton.setFontSize(McxButtonFontSize.large);this._toggleButton.setIsFullWidth(!0);this._toggleButton.setText(this._text);this.base.addChild(this._rootElement,this._toggleButton);this._contentContainer=
$("<div/>").addClass("mcx-floating-content-displayer");this._okButton=new McxButton;this._cancelButton=new McxButton;this._okButton.setButtonSize(McxButtonSize.small);this._cancelButton.setButtonSize(McxButtonSize.small);this._okButton.setButtonState(McxButtonState.active);this._cancelButton.setButtonState(McxButtonState.active);this._okButton.setText("OK");this._okButton.setLocalizationKey("McxCommonControl-OKButton");this._cancelButton.setText("Cancel");this._cancelButton.setLocalizationKey("McxCommonControl-CancelButton");
this._okButton.setIsFullWidth(!0);this._cancelButton.setIsFullWidth(!0);this._buttonsRow.createAndAddSpan(3,this._okButton).setOffset(3);this._buttonsRow.createAndAddSpan(3,this._cancelButton);this._okButton.getContent().css("margin","5px 10px 0 10px");this._cancelButton.getContent().css("margin","5px 10px 0 10px");this._okButton.getClickHandler().addListener(this.onResultButtonClick,null,this);this._cancelButton.getClickHandler().addListener(this.onResultButtonClick,null,this);var a=new McxLayoutRow;
a.addSpan(this._contentSpan);this.base.addChild(this._contentContainer,a);this.base.addChild(this._contentContainer,this._buttonsRow);this.setIsFloating(!0);this._rootElement.append(this._contentContainer)};McxAccordionContentDisplayer.prototype.bindEvents=function(){this._toggleButton.getClickHandler().addListener(function(){this._isToggleable&&(this._contentContainer.is(":visible")?this.hideContent():this.showContent())},null,this)};
McxAccordionContentDisplayer.prototype.showContent=function(){this.getBeforeViewOpenHandler().dispatchOnSuccess(this,null);this._contentContainer.css("display","block");this._toggleButton.setButtonState(McxButtonState.active);this.getAfterViewOpenHandler().dispatchOnSuccess(this,null)};McxAccordionContentDisplayer.prototype.hideButtons=function(){this._buttonsRow.hide()};McxAccordionContentDisplayer.prototype.showButtons=function(){this._buttonsRow.show()};
McxAccordionContentDisplayer.prototype.hideContent=function(){this.getBeforeViewCloseHandler().dispatchOnSuccess(this,null);this._contentContainer.css("display","none");this._toggleButton.setButtonState(McxButtonState.predefined);this.getAfterViewCloseHandler().dispatchOnSuccess(this,null)};McxAccordionContentDisplayer.prototype.onResultButtonClick=function(){this.hideContent()};
McxAccordionContentDisplayer.prototype.setEnabled=function(a){this._isEnabeld=a;this._toggleButton.setButtonState(a?McxButtonState.predefined:McxButtonState.disabled);a||this.hideContent()};McxAccordionContentDisplayer.prototype.setContent=function(a){this._contentSpan.setContent(a)};McxAccordionContentDisplayer.prototype.addContent=function(a){this._contentSpan.addContent(a)};McxAccordionContentDisplayer.prototype.getOkButtonClick=function(){return this._okButton.getClickHandler()};
McxAccordionContentDisplayer.prototype.getCancelButtonClick=function(){return this._cancelButton.getClickHandler()};McxAccordionContentDisplayer.prototype.setIsFloating=function(a){(this._isFloating=a)?this._contentContainer.addClass("state-floating"):this._contentContainer.removeClass("state-floating")};McxAccordionContentDisplayer.prototype.setIsToggleable=function(a){this._isToggleable=a};McxAccordionContentDisplayer.prototype.getBeforeViewOpenHandler=function(){return this._beforeViewOpenHandler};
McxAccordionContentDisplayer.prototype.getAfterViewOpenHandler=function(){return this._afterViewOpenHandler};McxAccordionContentDisplayer.prototype.getBeforeViewCloseHandler=function(){return this._beforeViewCloseHandler};McxAccordionContentDisplayer.prototype.getAfterViewCloseHandler=function(){return this._afterViewCloseHandler};McxAccordionContentDisplayer.prototype.setButtonLocalizationKey=function(a){this._toggleButton.setLocalizationKey(a)};
McxAccordionContentDisplayer.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.AnchorPointSelector={};js.framework.ui.McxCommonControl.AnchorPointSelector.McxAnchorPointEditor={};
function McxAnchorPointEditor(){mcx.base(this);this.base=this;this._rootElement=null;this._displacementXNumberBox=new McxNumberBox(Number.MIN_VALUE,Number.MAX_VALUE);this._displacementYNumberBox=new McxNumberBox(Number.MIN_VALUE,Number.MAX_VALUE);this._displacement=this._anchorPoint=this._seAnchorButton=this._sAnchorButton=this._swAnchorButton=this._eAnchorButton=this._cAnchorButton=this._wAnchorButton=this._neAnchorButton=this._nAnchorButton=this._nwAnchorButton=null;this._anchorButtons=[];this._anchorPointY=
this._anchorPointX=0;this.initContent();this.initialize();this.bindEvents()}mcx.inherits(McxAnchorPointEditor,McxUserControl);
McxAnchorPointEditor.prototype.initContent=function(){var a=$("<div/>"),b=$("<div/>").addClass("mcx-row-fluid");$("<div/>").addClass("mcx-span6");var c=$("<div/>").addClass("mcx-span4"),d=$("<div/>").addClass("mcx-span4"),e=$("<div/>").addClass("mcx-span4"),f=$("<div/>").addClass("mcx-span4"),g=$("<div/>").addClass("mcx-span4"),h=$("<div/>").addClass("mcx-span4"),k=$("<div/>").addClass("mcx-span4"),m=$("<div/>").addClass("mcx-span4"),n=$("<div/>").addClass("mcx-span4"),p=new McxButton;this.base.addChild(c,
p);p.setImage("anchor-point-nw-32");var q=new McxButton;this.base.addChild(e,q);q.setImage("anchor-point-ne-32");var r=new McxButton;this.base.addChild(d,r);r.setImage("anchor-point-n-32");var t=new McxButton;this.base.addChild(f,t);t.setImage("anchor-point-w-32");var u=new McxButton;this.base.addChild(g,u);u.setImage("anchor-point-c-32");var v=new McxButton;this.base.addChild(h,v);v.setImage("anchor-point-e-32");var w=new McxButton;this.base.addChild(k,w);w.setImage("anchor-point-sw-32");var x=new McxButton;
this.base.addChild(m,x);x.setImage("anchor-point-s-32");var y=new McxButton;this.base.addChild(n,y);y.setImage("anchor-point-se-32");this._nwAnchorButton=p;this._nAnchorButton=r;this._neAnchorButton=q;this._wAnchorButton=t;this._cAnchorButton=u;this._eAnchorButton=v;this._swAnchorButton=w;this._sAnchorButton=x;this._seAnchorButton=y;this._cAnchorButton._anchorPointX=.5;this._cAnchorButton._anchorPointY=.5;this._wAnchorButton._anchorPointX=0;this._wAnchorButton._anchorPointY=.5;this._eAnchorButton._anchorPointX=
1;this._eAnchorButton._anchorPointY=.5;this._nAnchorButton._anchorPointX=.5;this._nAnchorButton._anchorPointY=0;this._sAnchorButton._anchorPointX=.5;this._sAnchorButton._anchorPointY=1;this._nwAnchorButton._anchorPointX=0;this._nwAnchorButton._anchorPointY=0;this._seAnchorButton._anchorPointX=1;this._seAnchorButton._anchorPointY=1;this._swAnchorButton._anchorPointX=0;this._swAnchorButton._anchorPointY=1;this._neAnchorButton._anchorPointX=1;this._neAnchorButton._anchorPointY=0;this._anchorButtons.push(this._nwAnchorButton);
this._anchorButtons.push(this._nAnchorButton);this._anchorButtons.push(this._neAnchorButton);this._anchorButtons.push(this._wAnchorButton);this._anchorButtons.push(this._cAnchorButton);this._anchorButtons.push(this._eAnchorButton);this._anchorButtons.push(this._swAnchorButton);this._anchorButtons.push(this._sAnchorButton);this._anchorButtons.push(this._seAnchorButton);a.append(b.clone().append(c.css("text-align","right")).append(d.css("text-align","center")).append(e)).append(b.clone().append(f.css("text-align",
"right")).append(g.css("text-align","center")).append(h)).append(b.clone().append(k.css("text-align","right")).append(m.css("text-align","center")).append(n));this._rootElement=a};
McxAnchorPointEditor.prototype.initialize=function(){for(var a=0;a<this._anchorButtons.length;a++){var b=this._anchorButtons[a];b.setButtonState(McxButtonState.predefined);b.setButtonSize(McxButtonSize.small);b.setIsFullWidth(!0)}this._displacementXNumberBox.setValue(this._displacement?this._displacement.getDisplacementX():0);this._displacementYNumberBox.setValue(this._displacement?this._displacement.getDisplacementY():0);a=(new McxLayoutRow).createAndAddSpanFluent(6,new McxLabeledEditor("x",this._displacementXNumberBox,
"",4)).createAndAddSpanFluent(6,new McxLabeledEditor("y",this._displacementYNumberBox,"",4));this.base.addChild(this._rootElement,a)};McxAnchorPointEditor.prototype.bindEvents=function(){for(var a=this,b=0;b<this._anchorButtons.length;b++){var c=this._anchorButtons[b];c.getClickHandler().addListener(function(){a.setSelectedButton(this)},null,c)}};
McxAnchorPointEditor.prototype.setSelectedButton=function(a){for(var b=0;b<this._anchorButtons.length;b++)this._anchorButtons[b].setButtonState(McxButtonState.predefined);a.setButtonState(McxButtonState.active);this._anchorPointX=a._anchorPointX;this._anchorPointY=a._anchorPointY};McxAnchorPointEditor.prototype.setAnchorPoint=function(a){this._anchorPoint=a;this._anchorPointX=a.getAnchorPointX();this._anchorPointY=a.getAnchorPointY()};
McxAnchorPointEditor.prototype.setDisplacement=function(a){this._displacement=a;this._displacementXNumberBox.setValue(this._displacement.getDisplacementX());this._displacementYNumberBox.setValue(this._displacement.getDisplacementY())};
McxAnchorPointEditor.prototype.applyAnchor=function(){this._anchorPoint&&(this._anchorPoint.setAnchorPointX(this._anchorPointX),this._anchorPoint.setAnchorPointY(this._anchorPointY));this._displacement&&(this._displacement.setDisplacementX(this._displacementXNumberBox.getValue()),this._displacement.setDisplacementY(this._displacementYNumberBox.getValue()))};McxAnchorPointEditor.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.AttributeQueryGenerator={};js.framework.ui.McxCommonControl.AttributeQueryGenerator.McxAttributeQueryGenerator={};
function McxAttributeQueryGenerator(a){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._queryTextArea=null;this._selectFromWhereButtonActive=a||!1;this._goToValueInput=this._getValueButton=this._layerFieldValuesSelectBox=this._layerFieldsSelectBox=this._wheretButton=this._fromButton=null;this._isAdvencedMode=!1;this._defaultQueryLabel=this._selectButton=this._layer=null;this._onGettingValuesHanlder=new McxEventHandler;this._onGetValuesCompletedHanlder=new McxEventHandler;this._onGetValuesSucceedHanlder=
new McxEventHandler;this._onGetValuesFailedHanlder=new McxEventHandler;this.init();this.bindEvents()}mcx.inherits(McxAttributeQueryGenerator,McxUserControl);
McxAttributeQueryGenerator.prototype.init=function(){var a=this,b=$("<textarea/>").attr("rows","3").css("width","98%").css("resize","vertical");this._defaultQueryLabel=new McxLabelControl;this._queryTextArea=b;var c=$("<select/>").attr("size",8).css("width","100%").css("height","165px"),d=new McxLayoutRow,e=new McxGroupBox("McxCommonControl-attributeGeneratorFields");e.setLocalizationKeyForTitle("McxCommonControl-attributeGeneratorFields");e.addContent(c);d.createAndAddSpan(4,e);var f=this.createQueryButton("="),
g=this.createQueryButton("<>"),h=this.createQueryButton("Like"),k=this.createQueryButton(">"),m=this.createQueryButton(">="),n=this.createQueryButton("And"),e=this.createQueryButton("Select",this._selectFromWhereButtonActive);e.css("padding","5px !important");var p=this.createQueryButton("From",this._selectFromWhereButtonActive);p.css("padding","5px !important");var q=this.createQueryButton("Where",this._selectFromWhereButtonActive);q.css("padding","5px !important");var r=this.createQueryButton("<"),
t=this.createQueryButton("<="),u=this.createQueryButton("Or"),v=this.createQueryButton("?"),w=this.createQueryButton("*"),x=this.createQueryButton("Not"),y=this.createQueryButton("( )"),A=this.createQueryButton("Is"),B=this.createQueryButton("Null"),z=new McxGroupBox("Operator");z.setLocalizationKeyForTitle("McxCommonControl-attributeGeneratorOperator");var C=new McxLayoutRow;C.createAndAddSpan(3,f);C.createAndAddSpan(3,g);C.createAndAddSpan(3,h);C.createAndAddSpan(3,e);z.addContent(C);f=new McxLayoutRow;
f.createAndAddSpan(3,k);f.createAndAddSpan(3,m);f.createAndAddSpan(3,n);f.createAndAddSpan(3,p);z.addContent(f);k=new McxLayoutRow;k.createAndAddSpan(3,r);k.createAndAddSpan(3,t);k.createAndAddSpan(3,u);k.createAndAddSpan(3,q);z.addContent(k);r=new McxLayoutRow;r.createAndAddSpan(3,v);r.createAndAddSpan(3,w);r.createAndAddSpan(3,x);z.addContent(r);v=new McxLayoutRow;v.createAndAddSpan(3,y);v.createAndAddSpan(3,A);v.createAndAddSpan(3,B);z.addContent(v);y=$("<select/>").attr("size",8).css("width",
"100%");A=$("<button/>").addClass("mcx-input").addClass("fit").html("<span data-localize='McxCommonControl-attributeGeneratorGetValues'>"+this.base.getLocaleValue("McxCommonControl-attributeGeneratorGetValues")+"</span>").click(function(){a.appendToQuery($(this).text())}).unbind("click");B=$("<input/>").attr("type","text").addClass("mcx-input").addClass("fit");v=new McxLabeledEditor("McxCommonControl-attributeGeneratorGo",B,"McxCommonControl-attributeGeneratorGo",3);v.getContent().css("margin","0");
d.createAndAddSpan(4,z);z=new McxLayoutRow;z.createAndAddSpan(12,y);w=new McxLayoutRow;w.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center);w.createAndAddSpan(4,A);w.createAndAddSpan(8,v);v=$("<div/>").css("margin-top","5px").addClass("");this.base.addChild(v,z);this.base.addChild(v,w);z=new McxGroupBox("McxCommonControl-attributeGeneratorValue");z.setLocalizationKeyForTitle("McxCommonControl-attributeGeneratorValue");z.addContent(v);d.createAndAddSpan(4,z);z=$("<p/>");z=$("<div/>").append(z).css("display",
"none");this.base.addChild(this._rootElement,d);this._rootElement.append(z);d=new McxLayoutRow;d.createAndAddSpan(12,this._defaultQueryLabel);this.base.addChild(this._rootElement,d);d=new McxLayoutRow;d.createAndAddSpan(12,b);this.base.addChild(this._rootElement,d);this._selectButton=e;this._fromButton=p;this._wheretButton=q;this._layerFieldsSelectBox=c;this._layerFieldValuesSelectBox=y;this._getValueButton=A;this._goToValueInput=B;e.addClass("mcx-compact");p.addClass("mcx-compact");q.addClass("mcx-compact")};
McxAttributeQueryGenerator.prototype.createQueryButton=function(a,b){var c=this,d=$("<button/>").addClass("mcx-input").addClass("mcx-query-button").html(a).attr("data-localize",a).click(function(){c.appendToQuery($(this).text())});mcx.isDefAndNotNull(b)&&1==b?d.prop("disabled",!1):mcx.isDefAndNotNull(b)&&0==b&&d.prop("disabled",!0);return d};
McxAttributeQueryGenerator.prototype.bindEvents=function(){var a=this;this._queryTextArea.bind("click keypress",function(){var b=a.getCaret(this);$(this).data("caretPosition",b)});this._getValueButton.bind("click",function(){var b=a._layerFieldsSelectBox.find("option:selected");if(1>b.length)McxMessageBox.show("",a.base.getLocaleValue("McxCommonControl-pleaseSelectAField"),McxMessageBoxType.Information,McxDialogButtons.ok);else{var c=b.html().toString(),d=a.getLayer().getSchema().getField(c),e=new McxAjaxParameter;
e.setAsync(!1);var b=a.getLayer(),f=b.getDataSource().getDomain(d.getDomainName(),e).getDomain(),d=new McxAjaxParameter;d.setParameters(a,function(b){var d=[];for(b=b.getFeatureReader();b.read();){var e=b.getCurrent().getFieldType(c),m=b.getCurrent().getValueWithName(c),n=m;f&&(m=f.lookup(n)||n);e==McxDataType.String&&(n="'"+n+"'");d.push({text:m,fieldType:e,value:n})}a.setLayerFieldValues(d);a._onGetValuesSucceedHanlder.dispatchOnSuccess(a,null);a._onGetValuesCompletedHanlder.dispatchOnSuccess(a,
null)},function(){a._onGetValuesCompletedHanlder.dispatchOnSuccess(a,null);a._onGetValuesFailedHanlder.dispatchOnSuccess(a,null)});b.query(c,"1=1 group by "+c+" order by "+c,d);a._onGettingValuesHanlder.dispatchOnSuccess(this,null)}});this._goToValueInput.keyup(function(){var b=$(this).val(),c=!1,d=$(a._layerFieldValuesSelectBox.find("option").get().reverse());d.each(function(a,d){var g=$(d);g.html().toString().toUpperCase()===b.toString().toUpperCase()&&(g.attr("selected","selected"),c=!0)});c||
d.each(function(a,c){var d=$(c);-1!==d.html().toUpperCase().indexOf(b.toString().toUpperCase())&&d.attr("selected","selected")})})};McxAttributeQueryGenerator.prototype.enableAdvencedQueryMode=function(){this._isAdvencedMode=!0;this._selectButton.removeAttr("disabled");this._fromButton.removeAttr("disabled");this._wheretButton.removeAttr("disabled")};
McxAttributeQueryGenerator.prototype.disableAdvencedQueryMode=function(){this._isAdvencedMode=!1;this._selectButton.attr("disabled","disabled");this._fromButton.attr("disabled","disabled");this._wheretButton.attr("disabled","disabled")};
McxAttributeQueryGenerator.prototype.setLayer=function(a){if(mcx.isDefAndNotNull(a)){this._layer=a;var b=this,c=a.getSchema().getFieldCount();this._layerFieldsSelectBox.html("");this._layerFieldsSelectBox.unbind("dblclick");this._layerFieldsSelectBox.dblclick(function(){$(this).find(":selected").each(function(){b.appendToQuery($(this).html())})});this._defaultQueryLabel.setText("Select * from "+this._layer.getAlias()+" Where");for(var d=0;d<c;d++){var e=a.getSchema().getField(d);e.isIgnored()||this._layerFieldsSelectBox.append($("<option/>").html(e.getFieldName()))}(a=
this._layer.getFilterCollection().toString()?this._layer.getFilterCollection().toString():null)&&this._queryTextArea.val(a)}};McxAttributeQueryGenerator.prototype.getLayer=function(){return this._layer};McxAttributeQueryGenerator.prototype.appendToQuery=function(a){var b=this._queryTextArea.data("caretPosition")||0,c=this._queryTextArea.val(),c=c.substr(0,b)+a+" "+c.substr(b);this._queryTextArea.val(c);this._queryTextArea.data("caretPosition",c.length)};
McxAttributeQueryGenerator.prototype.getSql=function(){return this._queryTextArea.val().toString().trim().replace(/(\r\n|\n|\r)/gm,"")};McxAttributeQueryGenerator.prototype.getCaret=function(a){var b=0;if(document.selection)a.focus(),b=document.selection.createRange(),b.moveStart("character",-a.value.length),b=b.text.length;else if(a.selectionStart||"0"==a.selectionStart)b=a.selectionStart;return b};
McxAttributeQueryGenerator.prototype.setLayerFieldValues=function(a){var b=this;this._layerFieldValuesSelectBox.html("");this._layerFieldValuesSelectBox.dblclick(function(){$(this).find(":selected").each(function(){b.appendToQuery($(this).data().data.value)})});this._layerFieldValuesSelectBox.data("data",a);for(var c in a)this._layerFieldValuesSelectBox.append($("<option/>").html(a[c].text).data("data",a[c]))};McxAttributeQueryGenerator.prototype.onGettingValues=function(){return this._onGettingValuesHanlder};
McxAttributeQueryGenerator.prototype.onGetValuesCompleted=function(){return this._onGetValuesCompletedHanlder};McxAttributeQueryGenerator.prototype.onGetValuesSucceed=function(){return this._onGetValuesSucceedHanlder};McxAttributeQueryGenerator.prototype.onGetValuesFailed=function(){return this._onGetValuesFailedHanlder};McxAttributeQueryGenerator.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};McxAttributeQueryGenerator.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.AttributeValueSelectEditor={};js.framework.ui.McxCommonControl.AttributeValueSelectEditor.McxAttributeValueSelectEditor={};
function McxAttributeValueSelectEditor(){mcx.base(this);this.base=this;this._container=$("<div/>");this._listBox=this._field=this._layer=null;this._listItemArray=[];this._findTextBox=null;this._fillButtonVisibility=!1;this._fillButtonClickHandler=this._fillButton=null;this.onAbortButtonClick=new McxEventHandler;this.searchTimer=0;this._maximumListCount=400;this.initialize()}mcx.inherits(McxAttributeValueSelectEditor,McxUserControl);
McxAttributeValueSelectEditor.prototype.initialize=function(){this._listBox=new McxListBox;var a=new McxLayoutRow;a.createAndAddSpan(12,this._listBox);this.base.addChild(this._container,a);var a=new McxLayoutRow,b=a.createAndAddSpan(6,"");1==this._fillButtonVisibility&&(this._fillButton=new McxButton,this._fillButton.setText("McxCommonControl-attributeValueSelectEditorGetValues"),this._fillButton.setLocalizationKey("McxCommonControl-attributeValueSelectEditorGetValues"),this._fillButton.getClickHandler().addListener(this.fillButtonClicked,
null,this),b.setContent(this._fillButton));this._findTextBox=new McxTextBox(McxTextBoxType.Text);this._findTextBox.getKeyPressHandler().addListener(function(){0<this.searchTimer&&clearTimeout(this.searchTimer);this.searchTimer=setTimeout($.proxy(this.findTextChanged,this),1E3)},null,this);b=a.createAndAddSpan(1,"McxCommonControl-attributeValueSelectEditorGo");b.getContent().attr("data-localize","McxCommonControl-attributeValueSelectEditorGo");b.getContent().css("line-height","30px");a.createAndAddSpan(5,
this._findTextBox);this.base.addChild(this._container,a)};
McxAttributeValueSelectEditor.prototype.findTextChanged=function(){McxLoadingIndicator.setAsBusy(this._container,!0).getCancelEventHandler().addListener(function(){this._listBox.clear()},null,this);var a=this._findTextBox.getValue().toUpperCase(),b=[];if(0<a.length){for(var c=0;c<this._listItemArray.length;c++){var d=this._listItemArray[c].text.toString().toUpperCase();-1<d.indexOf(a)&&b.length<this._maximumListCount&&b.push(this._listItemArray[c]);d.slice(0,a.toString().length)==a.toString()&&this._listBox.setSelectedItems([this._listItemArray[c]])}this._listBox.clear();
this._listBox.addItemRange(b)}else this._listBox.clear();McxLoadingIndicator.setAsIdle(this._container)};McxAttributeValueSelectEditor.prototype.setLayerField=function(a,b){this._layer=a;this._field=b;this.getFieldValues()};
McxAttributeValueSelectEditor.prototype.getFieldValues=function(){var a=new McxAjaxParameter;a.setParameters(this,this.getFieldValuesSuccess,this.getFieldValuesFail);McxLoadingIndicator.setAsBusy(this._container,!0).getCancelEventHandler().addListener(function(){},null,this);this._layer.query(this._field.getFieldName(),"1=1 group by "+this._field.getFieldName()+" order by "+this._field.getFieldName(),a)};
McxAttributeValueSelectEditor.prototype.getFieldValuesSuccess=function(a){this._listItemArray=[];var b=null;if(null!=this._field.getDomainName()){b=new McxAjaxParameter;b.setAsync(!1);var c=this._layer.getDataSourceName(),b=this._layer.getDataSource().getDomain(c,this._field.getDomainName(),b).getDomain()}c=a.getFeatureReader();if(a&&c){var d=0;for(a=c.count();c.read()&&!(d>=this._maximumListCount);){var e=this._field.getFieldType();if(e!=McxDataType.IMcxGeometry){var f=c.getCurrent().getValueWithName(this._field.getFieldName()),
g=f;b&&(f=b.lookup(g)||g);this._listItemArray.push({text:f,fieldType:e,value:g});d++}}this._listBox.setTextGetter("text");this._listBox.setValueGetter("value");b=McxLocalizationManager.getLocaleValue("McxCommonControl-TooMuchRecordMessage");b=String.format(b,this._maximumListCount).toString();a>this._maximumListCount&&McxMessageBox.show("",b,McxMessageBoxType.Information,McxDialogButtons.ok);this._listBox.addItemRange(this._listItemArray)}McxLoadingIndicator.setAsIdle(this._container)};
McxAttributeValueSelectEditor.prototype.getFieldValuesFail=function(){McxLoadingIndicator.setAsIdle(this._container)};McxAttributeValueSelectEditor.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};McxAttributeValueSelectEditor.prototype.getValue=function(){var a=this._listBox.getSelectedItems();return 0==a.length?"":a[0].value};McxAttributeValueSelectEditor.prototype.getContent=function(){return this._container};
McxAttributeValueSelectEditor.prototype.setHeight=function(a){this._listBox.setHeight(a-40)};McxAttributeValueSelectEditor.prototype.getFillButtonClickHandler=function(){return this._fillButtonClickHandler};McxAttributeValueSelectEditor.prototype.fillButtonClicked=function(){this._fillButtonClickHandler.dispatchOnSuccess(this,null)};McxAttributeValueSelectEditor.prototype.getOnAbortButtonClick=function(){return this.onAbortButtonClick};
McxAttributeValueSelectEditor.prototype.setMaximumListCount=function(a){!a&&0<a&&(this._maximumListCount=a)};js.framework.ui.McxCommonControl.ChartControl={};js.framework.ui.McxCommonControl.ChartControl.McxChartControl={};function McxChartControl(){mcx.base(this);this._rootElement=$('<div style="width: 100%; text-align: center"/>');this.base=this;this._chart=this._canvas=null;this.initialize()}mcx.inherits(McxChartControl,McxUserControl);
McxChartControl.prototype.initialize=function(){this._canvas=$("<canvas/>").attr("width",200).attr("height",200).css("width","200px").css("height","200px").addClass("");this._canvas.get(0).id="muhammed";this._rootElement.append(this._canvas)};McxChartControl.prototype.setWidth=function(a){this._canvas.attr("width",a);this._canvas.css("width",a+"px")};McxChartControl.prototype.setHeight=function(a){this._canvas.attr("height",a);this._canvas.css("height",a+"px")};
McxChartControl.prototype.createPie=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=this.createColor();c.push({value:a[d],color:"rgba("+e[0]+","+e[1]+","+e[2]+",1)",highlight:"rgba("+e[0]+","+e[1]+","+(e[2]-2)+",0.8)",label:b[d]})}d=this._canvas.get(0).getContext("2d");this._chart=(new window.Chart(d)).Pie(c)};
McxChartControl.prototype.createBar=function(a,b){var c=this.createColor(),c={labels:b,datasets:[{fillColor:"rgba("+c[0]+","+c[1]+","+c[2]+",0.5)",strokeColor:"rgba("+c[0]+","+c[1]+","+c[2]+",0.8)",highlightFill:"rgba("+c[0]+","+c[1]+","+c[2]+",0.75)",highlightStroke:"rgba("+c[0]+","+c[1]+","+c[2]+",1)",data:a}]},d=this._canvas.get(0).getContext("2d");this._chart=(new window.Chart(d)).Bar(c)};
McxChartControl.prototype.createPolar=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=this.createColor();c.push({value:a[d],color:"rgba("+e[0]+","+e[1]+","+e[2]+",1)",highlight:"rgba("+e[0]+","+e[1]+","+(e[2]-5)+",0.8)",label:b[d]})}d=this._canvas.get(0).getContext("2d");this._chart=(new window.Chart(d)).PolarArea(c)};
McxChartControl.prototype.createLine=function(a,b){var c=this.createColor(),c={labels:b,datasets:[{label:"",fillColor:"rgba("+c[0]+","+c[1]+","+c[2]+",0.2)",strokeColor:"rgba("+c[0]+","+c[1]+","+c[2]+",1)",pointColor:"rgba("+c[0]+","+c[1]+","+c[2]+",1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba("+c[0]+","+c[1]+","+c[2]+",1)",data:a}]},d=this._canvas.get(0).getContext("2d");this._chart=(new window.Chart(d)).Line(c)};
McxChartControl.prototype.createLineAdvance=function(a,b){this.createColor();var c=this._canvas.get(0).getContext("2d");this._chart=(new window.Chart(c)).Line(a,b)};McxChartControl.prototype.createColor=function(){var a=Math.floor(255*Math.random()+1),b=Math.floor(255*Math.random()+1),c=Math.floor(255*Math.random()+1);return[a,b,c]};McxChartControl.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.CheckBox={};js.framework.ui.McxCommonControl.CheckBox.McxCheckBox={};function McxCheckBox(){mcx.base(this);this.base=this;this._container=$("<div/>");this._checkbox=null;this._isEnabled=!1;this._label=null;this._onChangeHandler=new McxEventHandler;this.init()}mcx.inherits(McxCheckBox,McxValidatableControl);
McxCheckBox.prototype.init=function(){this._checkbox=$("<input/>").attr({type:"checkbox",id:"chk"}).change($.proxy(this.onChange,this));this._label=$("<label/>").append(this._checkbox);$(this._container).addClass("mcx-checkbox").append(this._label)};McxCheckBox.prototype.setText=function(a,b){b=b||a;var c=$("<span/>").text(a).attr("data-localize",b);this._label.append(c)};McxCheckBox.prototype.isChecked=function(){return this._checkbox.is(":checked")};
McxCheckBox.prototype.checked=function(a){this._checkbox.prop("checked",a)};McxCheckBox.prototype.onChange=function(){this.onChangeHandler().dispatchOnSuccess(this,null)};McxCheckBox.prototype.onChangeHandler=function(){return this._onChangeHandler};McxCheckBox.prototype.getContent=function(){return this._container};McxCheckBox.prototype.setEnabled=function(a){a?this._checkbox.removeAttr("disabled"):this._checkbox.attr("disabled","disabled")};McxCheckBox.prototype.getValue=McxCheckBox.prototype.isChecked;
McxCheckBox.prototype.setValue=McxCheckBox.prototype.checked;js.framework.ui.McxCommonControl.ColorPicker={};js.framework.ui.McxCommonControl.ColorPicker.McxColorPicker={};function McxColorPicker(){mcx.base(this);this._rootElement=$("<div/>");this._color="#fff";this._opacity=1;this._colorSelector=null;this.base=this;this.init();this.bindEvents()}mcx.inherits(McxColorPicker,McxUserControl);
McxColorPicker.prototype.init=function(){this._colorSelector=new McxColorSelector;this._colorSelector.getContent().css({position:"absolute",top:"21px","z-index":"2147483647"});var a=$("<div/>").height(20).css("position","relative").css("margin","auto").css("margin-top","4px").css("border","1px solid #4f4f4f").addClass("mcx-color-preview-box"),b=$("<div/>"),c=new McxLayoutRow;c.createAndAddSpan(2,a);this.base.addChild(a,this._colorSelector);c.createAndAddSpan(10,b);this.base.addChild(this._rootElement,
c);c=new McxNumberSlider(!1,McxNumberSliderMode.Horizontal,0,100,1);c.setValue(100);this.base.addChild(b,c);this._colorPreviewBox=a;this._opacitySlider=c;c.getContent().css("margin-top",4);this._colorSelector.hide()};
McxColorPicker.prototype.bindEvents=function(){var a=this;this._colorPreviewBox.click(function(){1==a._colorSelector.getContent().is(":visible")?a._colorSelector.hide():(a._colorSelector.show(),a._colorSelector.getContent().appendTo("body").css("left",a._colorPreviewBox.offset().left).css("top",a._colorPreviewBox.offset().top+a._colorPreviewBox.height()),a._colorSelector.getContent().offset().top+a._colorSelector.getContent().height()>$(window).height()&&a._colorSelector.getContent().css("top",a._colorPreviewBox.offset().top-
a._colorSelector.getContent().outerHeight(!0)))});$(document).mouseup($.proxy(function(a){a=$(a.target);if(a.hasClass("mcx-color-preview-box")||0<a.parents(".mcx-color-preview-box").length||!(a.hasClass("colpick_color ")||0<a.parents(".colpick_color ").length)&&(a.hasClass("colpick ")||0<a.parents(".colpick ").length))return!0;this._colorSelector.hide()},this));this._opacitySlider.onChange().addListener(function(){var a=this._opacitySlider.getValue()/100;this._opacity=a;this._colorPreviewBox.css("opacity",
a)},null,this);this._colorSelector.getOnChangeHandler().addListener(function(){var a="#"+this._colorSelector.getColor();this._color=a;this._colorPreviewBox.css("background",a)},null,this)};McxColorPicker.prototype.setColor=function(a){this._color=a;this._colorPreviewBox.css("background",a);this._colorSelector.setColor(this.colorToHex(a).replace("#",""))};McxColorPicker.prototype.setOpacity=function(a){this._opacity=a;this._colorPreviewBox.css("opacity",a);this._opacitySlider.setValue(a?100*a:100)};
McxColorPicker.prototype.getColor=function(){return this._color};McxColorPicker.prototype.getOpacity=function(){return this._opacity};McxColorPicker.prototype.getOnChangeHandler=function(){return this._colorSelector.getOnChangeHandler()};McxColorPicker.prototype.colorToHex=function(a){return"#"===a.substr(0,1)?a:-1<a.indexOf("rgb")?this.rgbToHex(a):-1<a.indexOf("hsl")?this.hslToHex(a):"#000"};
McxColorPicker.prototype.rgbToHex=function(a){var b=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(a),b=b||/(.*?)rgb\((\d+),(\d+),(\d+)\)/.exec(a);a=parseFloat(b[2]);var c=parseFloat(b[3]);a=parseFloat(b[4])|c<<8|a<<16;return b[1]+"#"+a.toString(16)};McxColorPicker.prototype.hslToHex=function(a){a=this.hslToRgb(a);return this.rgbToHex(a)};
McxColorPicker.prototype.hslToRgb=function(a){var b=/(.*?)hsl\((\d+), (\d+), (\d+)\)/.exec(a),b=b||/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(a);a=parseFloat(b[1]);var c=parseFloat(b[2]),b=parseFloat(b[3]),d,e;isFinite(a)||(a=0);isFinite(c)||(c=0);isFinite(b)||(b=0);a/=60;0>a&&(a=6- -a%6);a%=6;c=Math.max(0,Math.min(1,c/100));b=Math.max(0,Math.min(1,b/100));e=(1-Math.abs(2*b-1))*c;d=e*(1-Math.abs(a%2-1));1>a?(a=e,c=d,d=0):2>a?(a=d,c=e,d=0):3>a?(a=0,c=e):4>a?(a=0,c=d,d=e):5>a?(a=d,c=0,d=e):(a=e,
c=0);b-=e/2;a=Math.round(255*(a+b));c=Math.round(255*(c+b));d=Math.round(255*(d+b));return"rgb("+a+","+c+","+d+")"};McxColorPicker.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.ColorSelector={};js.framework.ui.McxCommonControl.ColorSelector.McxColorSelector={};function McxColorSelector(){mcx.base(this);this.base=this;this._rootElement=null;this._onColorChangeHandler=new McxEventHandler;this._color="fff";this.initialize()}mcx.inherits(McxColorSelector,McxUserControl);
McxColorSelector.prototype.initialize=function(){var a=this;this._rootElement=$("<div/>");this._rootElement.colpick({flat:!0,mcxlayout:"hex",submit:!1,onChange:function(b,c,d){a.onColorChange(c);a.getOnChangeHandler().dispatchOnSuccess(this,null)}})};McxColorSelector.prototype.onColorChange=function(a){this._color=a};McxColorSelector.prototype.setColor=function(a){this._color=a;this._rootElement.colpickSetColor(a,!0)};McxColorSelector.prototype.getColor=function(){return this._color};
McxColorSelector.prototype.show=function(){this._rootElement.show(0)};McxColorSelector.prototype.hide=function(){this._rootElement.css("display","none").hide(0)};McxColorSelector.prototype.getContent=function(){return this._rootElement};McxColorSelector.prototype.getOnChangeHandler=function(){return this._onColorChangeHandler};js.framework.ui.McxCommonControl.ComboBox={};js.framework.ui.McxCommonControl.ComboBox.McxSelectedEventArgs={};function McxSelectedEventArgs(a,b,c){mcx.base(this,null);this.selectedObj=a;this.textField=b;this.valueField=c}mcx.inherits(McxSelectedEventArgs,McxEventArgs);McxSelectedEventArgs.prototype.getValue=function(){return this.selectedObj[this.valueField]};McxSelectedEventArgs.prototype.getText=function(){return this.selectedObj[this.textField]};
McxSelectedEventArgs.prototype.getSelectedObject=function(){return this.selectedObj};js.framework.ui.McxCommonControl.CommonToolBar={};js.framework.ui.McxCommonControl.CommonToolBar.IMcxMenuItem={};function IMcxMenuItem(){}IMcxMenuItem.prototype.setText=function(a){};IMcxMenuItem.prototype.setLocalizationKey=function(a){};IMcxMenuItem.prototype.setImageClass=function(a){};IMcxMenuItem.prototype.setIsActive=function(a){};IMcxMenuItem.prototype.getIsActive=function(){};js.framework.ui.McxCommonControl.CommonToolBar.McxCommonToolBar={};function McxCommonToolBar(){mcx.base(this);this.base=this;this._rootElement=null;this._toolBarItemContainer=$("<div/>");this._items=[];this.initialize()}mcx.inherits(McxCommonToolBar,McxUserControl);McxCommonToolBar.prototype.initialize=function(){this._rootElement=$("<div/>").addClass("mcx-common-toolbar");this._toolBarItemContainer=$("<div/>").addClass("mcx-common-toolbar-container");this._rootElement.append(this._toolBarItemContainer)};
McxCommonToolBar.prototype.addToolBarItem=function(a){mcx.isInstanceOf(a,McxUserControl)&&(this._items.push(a),this.base.addChild(this._toolBarItemContainer,a))};McxCommonToolBar.prototype.createAndAddToolBarItem=function(a,b){var c=new McxCommonToolBarItem;c.setImageClass(b);c.setText(a);null!=a&&c.setLocalizationKey(a.toString());this.addToolBarItem(c);return c};McxCommonToolBar.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.CommonToolBar.McxCommonToolBarGroupItem={};function McxCommonToolBarGroupItem(){mcx.base(this);this.base=this;this._textElement=this._imgElement=this._rootElement=null;this._itemContainer=$("<div/>").addClass("mcx-menu-item-container");this.initialize()}mcx.inherits(McxCommonToolBarGroupItem,McxUserControl);
McxCommonToolBarGroupItem.prototype.initialize=function(){this._rootElement=$("<div/>").addClass("mcx-common-toolbar-item").addClass("mcx-common-toolbar-group-item");this._imgElement=$("<div/>").addClass("mcx-common-toolbar-item-img");this._textElement=$("<div/>").addClass("mcx-common-toolbar-item-text");this._rootElement.append(this._imgElement);this._rootElement.append(this._textElement);this._imgElement.hide();this._rootElement.click($.proxy(function(){this._rootElement.hasClass("type-hold-state")&&
this._rootElement.toggleClass("state-active");var a=this._rootElement.offset();0<this._itemContainer.parents("body").length?this._itemContainer.detach():this._itemContainer.appendTo("body");0==this._rootElement.parents(".mcx-menu-item-container").length?this._itemContainer.offset({top:a.top+40,left:a.left}):this._itemContainer.offset({top:a.top,left:a.left+this._rootElement.closest(".mcx-menu-item-container").width()+10})},this));$(window).get(0).addEventListener("click",$.proxy(function(a){a=$(a.target);
a.hasClass("mcx-common-toolbar-group-item")||0<a.parents(".mcx-common-toolbar-group-item").length||$(".mcx-menu-item-container").detach()},this))};McxCommonToolBarGroupItem.prototype.setText=function(a){var b=$("<div/>"),c=$("<span>"+a+"</span>");c.attr("data-localize",a.toString());b.append(c);this._textElement.html(b.html().toString()||"");mcx.isDefAndNotNull(a)&&""!=a?this._textElement.appendTo(this._rootElement):this._textElement.detach()};
McxCommonToolBarGroupItem.prototype.setLocalizationKey=function(a){this._textElement.attr("data-localize",a)};McxCommonToolBarGroupItem.prototype.setImageClass=function(a){this._imgElement.css("display","inline-block").removeClass().addClass(a||"").addClass("mcx-common-toolbar-item-img");mcx.isDefAndNotNull(a)&&""!=a?this._imgElement.prependTo(this._rootElement):this._imgElement.detach()};McxCommonToolBarGroupItem.prototype.getContent=function(){return this._rootElement};
McxCommonToolBarGroupItem.prototype.setVisibility=function(a){a?this._rootElement.css("display","inline-block"):this._rootElement.css("display","none")};McxCommonToolBarGroupItem.prototype.isHoldState=function(a){a?this._rootElement.addClass("type-hold-state"):this._rootElement.removeClass("type-hold-state")};McxCommonToolBarGroupItem.prototype.setIsActive=function(a){0!=this._rootElement.hasClass("type-hold-state")&&(a?this._rootElement.addClass("state-active"):this._rootElement.removeClass("state-active"))};
McxCommonToolBarGroupItem.prototype.getIsActive=function(){return this._rootElement.hasClass("state-active")};McxCommonToolBarGroupItem.prototype.addItem=function(a){mcx.isInstanceOf(a,McxUserControl)&&this.base.addChild(this._itemContainer,a)};js.framework.ui.McxCommonControl.CommonToolBar.McxCommonToolBarItem={};function McxCommonToolBarItem(){mcx.base(this);this.base=this;this._rootElement=null;this._onClickHandler=new McxEventHandler;this._textElement=this._imgElement=null;this.initialize()}mcx.inherits(McxCommonToolBarItem,McxUserControl);
McxCommonToolBarItem.prototype.initialize=function(){this._rootElement=$("<div/>").addClass("mcx-common-toolbar-item");this._imgElement=$("<div/>").addClass("mcx-common-toolbar-item-img");this._textElement=$("<div/>").addClass("mcx-common-toolbar-item-text");this._rootElement.append(this._imgElement);this._rootElement.append(this._textElement);this._imgElement.hide();this._rootElement.click($.proxy(function(){this.getOnClickHandler().dispatchOnSuccess(this,null);this._rootElement.hasClass("type-hold-state")&&
this._rootElement.toggleClass("state-active")},this))};McxCommonToolBarItem.prototype.setText=function(a){var b=$("<div/>"),c=$("<span>"+a+"</span>");c.attr("data-localize",a.toString());b.append(c);this._textElement.html(b.html().toString()||"");mcx.isDefAndNotNull(a)&&""!=a?this._textElement.appendTo(this._rootElement):this._textElement.detach()};McxCommonToolBarItem.prototype.setLocalizationKey=function(a){this._textElement.attr("data-localize",a)};
McxCommonToolBarItem.prototype.setImageClass=function(a){this._imgElement.css("display","inline-block").removeClass().addClass(a||"").addClass("mcx-common-toolbar-item-img");mcx.isDefAndNotNull(a)&&""!=a?this._imgElement.prependTo(this._rootElement):this._imgElement.detach()};McxCommonToolBarItem.prototype.getContent=function(){return this._rootElement};McxCommonToolBarItem.prototype.getOnClickHandler=function(){return this._onClickHandler};
McxCommonToolBarItem.prototype.setVisibility=function(a){a?this._rootElement.css("display","inline-block"):this._rootElement.css("display","none")};McxCommonToolBarItem.prototype.isHoldState=function(a){a?this._rootElement.addClass("type-hold-state"):this._rootElement.removeClass("type-hold-state")};McxCommonToolBarItem.prototype.setIsActive=function(a){0!=this._rootElement.hasClass("type-hold-state")&&(a?this._rootElement.addClass("state-active"):this._rootElement.removeClass("state-active"))};
McxCommonToolBarItem.prototype.getIsActive=function(){return this._rootElement.hasClass("state-active")};js.framework.ui.McxCommonControl.ContextMenu={};js.framework.ui.McxCommonControl.ContextMenu.IMcxContextMenu={};function IMcxContextMenu(){}IMcxContextMenu.prototype.initialize=function(){};IMcxContextMenu.prototype.setLeftPosition=function(a){};IMcxContextMenu.prototype.setTopPosition=function(a){};IMcxContextMenu.prototype.setEnabled=function(a){};IMcxContextMenu.prototype.show=function(){};IMcxContextMenu.prototype.hide=function(){};js.framework.ui.McxCommonControl.ControllerMessage={};js.framework.ui.McxCommonControl.ControllerMessage.McxControllerMessage={};function McxControllerMessage(){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._message="";this._left=this._top=this._hideMessageHandle=0}mcx.inherits(McxControllerMessage,McxUserControl);McxControllerMessage.prototype.getContent=function(){return this._rootElement};McxControllerMessage.prototype.getMessage=function(){return this._message};
McxControllerMessage.prototype.setMessage=function(a){this._message=a};McxControllerMessage.prototype.setPosition=function(a,b){this._left=a;this._top=b};McxControllerMessage.prototype.getX=function(){return this._left};McxControllerMessage.prototype.getY=function(){return this._top};
McxControllerMessage.prototype.showMessage=function(){var a=this;$(".mcx-controller-ui-message-container").remove();this._rootElement.addClass("mcx-controller-ui-message-container");$("#documentArea").append(this._rootElement);this._rootElement.html(McxLocalizationManager.getLocaleValue(this._message));this._rootElement.attr("data-localize",this._message);McxLocalizationManager.localizeContent(this._rootElement);this._rootElement.slideDown(200);clearTimeout(this._hideMessageHandle);this._hideMessageHandle=
setTimeout(function(){a._rootElement.slideUp(200)},200*this._message.length)};js.framework.ui.McxCommonControl.ControllerUI={};js.framework.ui.McxCommonControl.ControllerUI.McxControllerUI={};
function McxControllerUI(){mcx.base(this);this._rootElement=$("<div/>").addClass("mcx-controller-ui anim-slide-right");this._messageContainer=null;this._headerElement=$("<div/>").addClass("mcx-controller-ui-header");this._modalElement=$("<div/>").addClass("mcx-controllerui-modal");this._bodyElement=$("<div/>").addClass("mcx-controller-ui-container");this._footerElement=$("<div/>").addClass("mcx-controller-ui-footer");this.base=this;this._localPath="";this._cancelButton=this.createAndAddFooterButton("Close",
"McxCommonControl-close");this._okButton=this.createAndAddFooterButton("Apply","McxCommonControl-done");this._hideMessageHandle=0;this._startUpStatus=this._isModal=this._uiStatus=!1;this._onShowEventHandler=new McxEventHandler;this._onHideEventHandler=new McxEventHandler;this.initialize()}mcx.inherits(McxControllerUI,McxUserControl);
McxControllerUI.prototype.initialize=function(){this._rootElement.css("z-index","9999");this._rootElement.append(this._modalElement).append($('<div class="content-area-container" />').append(this._headerElement).append(this._bodyElement).append(this._footerElement));this._isModal&&this._modalElement.css("display","block")};
McxControllerUI.prototype.showUI=function(){"none"==this._rootElement.css("display")&&(this._onShowEventHandler.dispatchOnSuccess(this,null),this._rootElement.removeClass("slide-right"),this._rootElement.removeClass("anim-slide-left"),this._rootElement.addClass("anim-slide-right slide-left"),this.setUIStatus(!0),this._rootElement.show(),this._isModal&&this._modalElement.css("display","block"))};
McxControllerUI.prototype.hideUI=function(){"none"!=this._rootElement.css("display")&&(this._onHideEventHandler.dispatchOnSuccess(this,null),this._rootElement.removeClass("slide-left"),this._rootElement.removeClass("anim-slide-right"),this._rootElement.addClass("anim-slide-left slide-right"),this.setUIStatus(!1),setTimeout($.proxy(function(){this._rootElement.hide()},this),300))};McxControllerUI.prototype.onShowEventHandler=function(){return this._onShowEventHandler};
McxControllerUI.prototype.onHideEventHandler=function(){return this._onHideEventHandler};McxControllerUI.prototype.getContent=function(){return this._rootElement};McxControllerUI.prototype.getLocalizationPath=function(){return this._localPath};McxControllerUI.prototype.setLocalizationPath=function(a){this._localPath=a};McxControllerUI.prototype.setTitle=function(a,b){this._headerElement.html(a);b&&this._headerElement.html(McxLocalizationManager.getLocaleValue(b)).attr("data-localize",b)};
McxControllerUI.prototype.setWidth=function(a){this._rootElement.width(a)};McxControllerUI.prototype.addControl=function(a){this.base.addChild(this._bodyElement,a)};McxControllerUI.prototype.addFooterButton=function(a,b){a.setButtonSize(McxButtonSize.small);a.setButtonState(McxButtonState.active);a.setButtonVisualType(McxButtonVisualType.linkButton);b=b||McxUserControlAddMethod.prepend;this.base.addChild(this._footerElement,a,b)};
McxControllerUI.prototype.createAndAddFooterButton=function(a,b){var c=new McxButton;c.setText(a);b&&c.setLocalizationKey(b);this.addFooterButton(c);return c};McxControllerUI.prototype.setDefaultButtonsVisibility=function(a,b){a?this._okButton.show():this._okButton.hide();b?this._cancelButton.show():this._cancelButton.hide()};McxControllerUI.prototype.getSubmitHandler=function(){return this._okButton.getClickHandler()};McxControllerUI.prototype.onCancel=function(){return this._cancelButton.getClickHandler()};
McxControllerUI.prototype.displayMessage=function(a,b,c,d){};McxControllerUI.prototype.getUIStatus=function(){return this._uiStatus};McxControllerUI.prototype.setUIStatus=function(a){this._uiStatus=a};McxControllerUI.prototype.setIsModal=function(a){(this._isModal=a)&&this._modalElement.css("display","block")};McxControllerUI.prototype.getIsModal=function(){return this._isModal};McxControllerUI.prototype.setAsStartUp=function(a){this._startUpStatus=a};McxControllerUI.prototype.getStartStatus=function(){return this._startUpStatus};
McxControllerUI.prototype.setOkButtonState=function(a){this._okButton.setButtonState(a)};McxControllerUI.prototype.setCancelButtonState=function(a){this._cancelButton.setButtonState(a)};js.framework.ui.McxCommonControl.CoordinateCreator={};js.framework.ui.McxCommonControl.CoordinateCreator.McxCoordinateCreator={};
function McxCoordinateCreator(a,b){mcx.base(this);this._map=a;this._lineString=b;this.base=this;this._rootElement=$("<div/>");this._coordinateCreatedHandler=new McxEventHandler;this._coordinateXNumberBox=new McxNumberBox(-1E18,Number.MAX_VALUE,5);this._coordinateYNumberBox=new McxNumberBox(-1E18,Number.MAX_VALUE,5);this._dxNumberBox=new McxNumberBox(-1E18,Number.MAX_VALUE,5);this._dyNumberBox=new McxNumberBox(-1E18,Number.MAX_VALUE,5);this._distanceNumberBox=new McxNumberBox(-1E18,Number.MAX_VALUE,
5);this._angDistAngleNumberBox=new McxNumberBox(-1E18,Number.MAX_VALUE,5);this._angDistDistanceNumberBox=new McxNumberBox(-1E18,Number.MAX_VALUE,5);this._coordinateTab=new McxTabPage;this._dxDyTab=new McxTabPage;this._distanceTab=new McxTabPage;this._angDistTab=new McxTabPage;this._tabControl=new McxTabControl;this.initialize()}mcx.inherits(McxCoordinateCreator,McxUserControl);
McxCoordinateCreator.prototype.initialize=function(){var a=new McxPanel;a.addControl(new McxLabeledEditor("x",this._coordinateXNumberBox));a.addControl(new McxLabeledEditor("y",this._coordinateYNumberBox));this._coordinateTab.setControl(a);a=new McxPanel;a.addControl(new McxLabeledEditor("dx",this._dxNumberBox));a.addControl(new McxLabeledEditor("dy",this._dyNumberBox));this._dxDyTab.setControl(a);a=new McxPanel;a.addControl(new McxLabeledEditor("Distance",this._distanceNumberBox,"McxCommonControl-Distance"));
McxLocalizationManager.localizeContent(a.getContent());this._distanceTab.setControl(a);a=new McxPanel;a.addControl(new McxLabeledEditor("Distance",this._angDistDistanceNumberBox,"McxCommonControl-Distance"));a.addControl(new McxLabeledEditor("Angle",this._angDistAngleNumberBox,"McxCommonControl-Angle"));McxLocalizationManager.localizeContent(a.getContent());this._angDistTab.setControl(a);this._coordinateTab.setTitle("x , y");this._dxDyTab.setTitle("dx / dy");this._distanceTab.setTitle("Distance",
"McxCommonControl-Distance");this._angDistTab.setTitle("Angle - Dist.","McxCommonControl-AngleDistance");this._tabControl.addTabPage(this._coordinateTab);this._tabControl.addTabPage(this._dxDyTab);this._tabControl.addTabPage(this._distanceTab);this._tabControl.addTabPage(this._angDistTab);this._tabControl.showTab(this._coordinateTab);this.base.addChild(this._rootElement,this._tabControl);this.setInitialValues();this.bindEvents()};
McxCoordinateCreator.prototype.bindEvents=function(){this._tabControl.getTabChangeHandler().addListener(this.onCoordinateChange,null,this);this._coordinateXNumberBox.getOnChangeHandler().addListener(this.onCoordinateChange,null,this);this._coordinateYNumberBox.getOnChangeHandler().addListener(this.onCoordinateChange,null,this);this._dxNumberBox.getOnChangeHandler().addListener(this.onCoordinateChange,null,this);this._dyNumberBox.getOnChangeHandler().addListener(this.onCoordinateChange,null,this);
this._distanceNumberBox.getOnChangeHandler().addListener(this.onCoordinateChange,null,this);this._angDistAngleNumberBox.getOnChangeHandler().addListener(this.onCoordinateChange,null,this);this._angDistDistanceNumberBox.getOnChangeHandler().addListener(this.onCoordinateChange,null,this)};McxCoordinateCreator.prototype.onCoordinateChange=function(){this.getCoordinateCreateHandler().dispatchOnSuccess(this,null)};
McxCoordinateCreator.prototype.setInitialValues=function(){var a=this._lineString.getPoints();a&&(1>=a.length?(this._dxDyTab.getControl().disable(),this._angDistTab.getControl().disable(),this._distanceTab.getControl().disable(),this.fillCoordinateEditors()):1<a.length&&(this._dxDyTab.getControl().enable(),this._angDistTab.getControl().enable(),this._distanceTab.getControl().enable(),this.fillCoordinateEditors(),this.fillDxDyEditors(),this.fillDistanceEditor(),this.fillAngleDistanceEditors()))};
McxCoordinateCreator.prototype.fillCoordinateEditors=function(){var a=this._lineString.getPoints();a&&0!=a.length&&(a=a[a.length-1],this._coordinateXNumberBox.setValue(a.getX()),this._coordinateYNumberBox.setValue(a.getY()))};
McxCoordinateCreator.prototype.fillDxDyEditors=function(){var a=this._lineString.getPoints();if(a&&!(1>=a.length)){var b=this._lineString.getCoordinateSystem(),c=1;null!=b&&(c=b.getDistancePerUnit());b=a[a.length-1];a=a[a.length-2];this._dxNumberBox.setValue((b.getX()-a.getX())*c);this._dyNumberBox.setValue((b.getY()-a.getY())*c)}};
McxCoordinateCreator.prototype.fillDistanceEditor=function(){var a=this._lineString.getPoints();if(a&&!(1>=a.length)){var b=this._lineString.getCoordinateSystem(),c=1;null!=b&&(c=b.getDistancePerUnit());var b=a[a.length-1],d=a[a.length-2],a=(b.getX()-d.getX())*c,c=(b.getY()-d.getY())*c;this._distanceNumberBox.setValue(Math.sqrt(Math.pow(a,2)+Math.pow(c,2)))}};
McxCoordinateCreator.prototype.fillAngleDistanceEditors=function(){var a=this._lineString.getPoints();if(a&&!(1>=a.length)){var b=this._lineString.getCoordinateSystem(),c=1;null!=b&&(c=b.getDistancePerUnit());var b=a[a.length-1],d=a[a.length-2],a=(b.getX()-d.getX())*c,c=(b.getY()-d.getY())*c,b=McxMath.radianToDegree(Math.atan2(c,a));360>b&&(b+=360);this._angDistAngleNumberBox.setValue(b);this._angDistDistanceNumberBox.setValue(Math.sqrt(Math.pow(a,2)+Math.pow(c,2)))}};
McxCoordinateCreator.prototype.getCoordinateCreateHandler=function(){return this._coordinateCreatedHandler};
McxCoordinateCreator.prototype.getCoordinate=function(){var a=this._tabControl.getActiveTabPage();return a==this._coordinateTab?new McxPoint(this._coordinateXNumberBox.getValue(),this._coordinateYNumberBox.getValue(),this._map.getCoordinateSystem()):a==this._dxDyTab?this.createPointByDxDy():a==this._distanceTab?this.createPointByDistance():a==this._angDistTab?this.createPointByAngleDistance():null};
McxCoordinateCreator.prototype.createPointByDxDy=function(){var a=this._lineString.getPoints();if(!a||1>=a.length)return null;var a=a[a.length-2],b=this._dxNumberBox.getValue(),c=this._dyNumberBox.getValue(),d=this._lineString.getCoordinateSystem(),e=1;null!=d&&(e=d.getDistancePerUnit());return McxFactoryFinder.GeometryFactory(this._map.getCoordinateSystem()).createPoint(a.getX()+b/e,a.getY()+c/e)};
McxCoordinateCreator.prototype.createPointByDistance=function(){var a=this._lineString.getPoints();if(!a||1>=a.length)return null;var b=a[a.length-1],a=a[a.length-2],c=b.getX()-a.getX(),b=b.getY()-a.getY(),c=Math.atan2(b,c),d=this._distanceNumberBox.getValue(),b=Math.cos(c)*d,c=Math.sin(c)*d,d=this._lineString.getCoordinateSystem(),e=1;null!=d&&(e=d.getDistancePerUnit());return McxFactoryFinder.GeometryFactory(this._map.getCoordinateSystem()).createPoint(a.getX()+b/e,a.getY()+c/e)};
McxCoordinateCreator.prototype.createPointByAngleDistance=function(){var a=this._lineString.getPoints();if(!a||1>=a.length)return null;var a=a[a.length-2],b=McxMath.degreeToRadian(this._angDistAngleNumberBox.getValue()),c=this._angDistDistanceNumberBox.getValue(),d=Math.cos(b)*c,b=Math.sin(b)*c,c=this._lineString.getCoordinateSystem(),e=1;null!=c&&(e=c.getDistancePerUnit());return McxFactoryFinder.GeometryFactory(this._map.getCoordinateSystem()).createPoint(a.getX()+d/e,a.getY()+b/e)};
McxCoordinateCreator.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.CoordinateEditor={};js.framework.ui.McxCommonControl.CoordinateEditor.McxCoordinateEditor={};function McxCoordinateEditor(a,b){mcx.base(this);this.base=this;this.map=a;this.mapInteractionFactory=b;this.markers=[];this.stateChangedEventHandler=new McxEventHandler;this.dataGrid=new McxDataGrid;this._rootElement=$("<div/>");this._uploadDiv=$("<div/>");this._toolbar=null}mcx.inherits(McxCoordinateEditor,McxUserControl);
McxCoordinateEditor.prototype.initializeComponent=function(){var a=new McxLayoutRow;a.createAndAddSpan(12,this._uploadDiv);this._rootElement.append(a.getContent());this.ImportFile();this._toolbar=new McxCommonToolBar;this._toolbar.createAndAddToolBarItem(this.base.getLocaleValue("Noktalar\u0131 Getir"),"icon-add-row").getOnClickHandler().addListener(function(){var a=new McxGetCoordinatesAction;this.map.getInputHandler().execute(a);var a=a.getCoordinates(),b;for(b in a)this.dataGrid.addItem(a[b]).refresh()},
null,this);this._toolbar.createAndAddToolBarItem(this.base.getLocaleValue("McxCartographyAddon-GridAddRow"),"icon-add-row").getOnClickHandler().addListener(function(){this.dataGrid.addEmptyRow()},null,this);this._toolbar.createAndAddToolBarItem(this.base.getLocaleValue("McxCartographyAddon-GridDelRow"),"icon-remove-row").getOnClickHandler().addListener(function(){this.dataGrid.removeRow(this.dataGrid.getSelectedRow())},null,this);this._toolbar.createAndAddToolBarItem(this.base.getLocaleValue("McxCartographyAddon-GridInsertRow"),
"icon-insert-row").getOnClickHandler().addListener(function(){this.dataGrid.addEmptyRow(this.dataGrid.getSelectedRowIndex())},null,this);a=new McxLayoutRow;a.createAndAddSpan(12,this._toolbar);var b=new McxLayoutRow;b.createAndAddSpan(12,this.dataGrid);this.base.addChild(this._rootElement,a);this.base.addChild(this._rootElement,b);this.dataGrid.setIsEditable(!0);this.dataGrid.addColumn((new McxStringColumn("Name","McxCommonControl-coordinateEditorName")).bindField("pointName").isEditable(!0));this.dataGrid.addColumn((new McxNumberColumn("Y")).bindField("x").isEditable(!0));
this.dataGrid.addColumn((new McxNumberColumn("X")).bindField("y").isEditable(!0));this.dataGrid.getRowSelectHandler().addListener(this.onSelect,null,this);this.dataGrid.getRowChangeHandler().addListener(this.onAfterEdit,null,this);this.dataGrid.getRowRemoveHandler().addListener(this.onBeforeRemoveRow,null,this);this.dataGrid.getRowRemoveHandler().addListener(this.onCoordinateRemoved,null,this);this.dataGrid.fitColumns();this.dataGrid.stretch();var c=this;this.dataGrid.getContent().on("mouseover",
function(){$(document).bind("keydown",function(a){if(13==a.keyCode){a=c.dataGrid.addEmptyRow();var b=c.dataGrid.getRows().length,b=c.dataGrid.getRows()[b-2].getItem();null!=b&&(b=b.pointName,-1<b.indexOf(".")?(b=b.split("."),"number"==typeof parseInt(b[1],10)&&a.setItem({pointName:b[0]+"."+(parseInt(b[1],10)+1)})):"number"!=typeof parseInt(b,10)||isNaN(parseInt(b,10))||a.setItem({pointName:parseInt(b,10)+1}),a.refresh(),a.startEditing())}})}).on("mouseout",function(){$(document).unbind("keydown")});
McxLocalizationManager.localizeContent(this.dataGrid.getContent())};McxCoordinateEditor.prototype.getStateChangedEventHandler=function(){return this.stateChangedEventHandler};McxCoordinateEditor.prototype.getCoordinates=function(a){for(var b=[],c=this.dataGrid.getRows(),d=0;d<c.length;d++){var e=c[d].getItem(),f=parseFloat(e.x),g=parseFloat(e.y),e=e.pointName;isNaN(f)&&isNaN(g)||(f=McxFactoryFinder.GeometryFactory(this.map.getCoordinateSystem()).createPoint(f,g),a?b.push({points:f,name:e}):b.push(f))}return b};
McxCoordinateEditor.prototype.onSelect=function(a){var b=this.dataGrid.getIndexOfRow(a.getRow());a=a.getRow().getItem();var c=a.marker;if(c){var d=c.getSymbolizer(),e=new McxFill;e.setColor("red");d.symbols[0].setFill(e);for(var f=this.dataGrid.getData(),g=0;g<f.length;g++)g!=b&&(c=f[g].marker)&&(e.setColor("#42A1CC"),d.symbols[0].setFill(e));this.map.getRenderer().paintNonLayer()}b=a.x;a=a.y;null!=b&&null!=a&&(b=parseFloat(b),a=parseFloat(a),a=McxFactoryFinder.GeometryFactory(this.map.getCoordinateSystem()).createPoint(b,
a),b=this.mapInteractionFactory.createZoomGeometryAction([a]),a=this.mapInteractionFactory.createBlinkGeometryAction([a],2E3),this.map.getInputHandler().execute(b),this.map.getInputHandler().execute(a))};
McxCoordinateEditor.prototype.onAfterEdit=function(a){this.dataGrid.getIndexOfRow(a.getRow());a=a.getRow().getItem();var b=parseFloat(a.x),c=parseFloat(a.y),c=McxFactoryFinder.GeometryFactory(null).createPoint(b,c);if(b=a.marker)b.setGeometry(c);else{var b=new McxPointMarker(c,McxGuid.createGuid()),c=new McxCrossMark,d=new McxPointSymbolizer,e=new McxFill;e.setColor("red");c.setFill(e);d.setSymbols([c]);b.setSymbolizer(d);this.markers.push(b);a.marker=b;this.map.getMarkerCollection().add(b)}this.map.getRenderer().paintNonLayer();
this.stateChangedEventHandler.dispatchOnSuccess(this,null)};McxCoordinateEditor.prototype.onBeforeRemoveRow=function(a){if(a=a.getRow().getItem().marker)this.map.getMarkerCollection().removeWithGuid(a.getMarkerId()),a=this.markers.indexOf(a),this.markers.splice(a,1);this.map.getRenderer().paintNonLayer()};McxCoordinateEditor.prototype.close=function(){this.map.getMarkerCollection().removeRange(this.markers);this.map.getRenderer().paintNonLayer()};
McxCoordinateEditor.prototype.isValid=function(){for(var a=this.dataGrid.getData(),b=0;b<a.length;b++){var c=a[b].x,d=a[b].y;if(!(c&&d||!c&&!d))return!1}return!0};McxCoordinateEditor.prototype.onCoordinateRemoved=function(){this.stateChangedEventHandler.dispatchOnSuccess(this,null)};McxCoordinateEditor.prototype.getContent=function(){return this._rootElement};
McxCoordinateEditor.prototype.ImportFile=function(){this._uploadDiv.empty();var a=new McxFileUploader;this._uploadDiv.append(a.getContent());a.onUploadButtonClick().addListener(function(){var b=a.getUploadFile(),c=new FileReader;c.readAsText(b);c.onload=$.proxy(function(a){a=a.target.result.split(/[\r\n]+/g);for(var b=[],c=0;c<a.length;c++){var g=1<a[c].split("\t").length?a[c].split("\t"):a[c].replace(/(\s)+/g,"$1").split(" ");1<g.length&&b.push({x:g[1],y:g[2],pointName:g[0]})}this.dataGrid.setDataSource(new McxDataGridArrayDataSource(b))},
this)},null,this)};McxCoordinateEditor.prototype.affine=function(){var a=new McxAfinDialog;a.setCoordinates(this.getCoordinates(!0));a.getCalculateFinishedEventHandler().addListener(function(a){a=new McxDataGridArrayDataSource(a.getArgs());this.dataGrid.setDataSource(a)},null,this);a.showDialog()};
McxCoordinateEditor.prototype.helmert=function(){var a=new McxHelmertDialog;a.setCoordinates(this.getCoordinates(!0));a.getCalculateFinishedEventHandler().addListener(function(a){a=new McxDataGridArrayDataSource(a.getArgs());this.dataGrid.setDataSource(a)},null,this);a.showDialog()};
McxCoordinateEditor.prototype.exportFile=function(){for(var a="",b=this.dataGrid.getRows(),c=0;c<b.length;c++)a+=b[c].getItem().pointName+"\t"+parseFloat(b[c].getItem().x).toFixed(6)+"\t"+parseFloat(b[c].getItem().y).toFixed(6)+"\r\n";b=new Blob([a],{type:"text/plain"});c=document.createElement("a");c.download="koordinat_ozet-"+McxGuid.createGuid().substr(0,7)+".txt";c.innerHTML="Download File";""!=a&&(null!=window.webkitURL?c.href=window.webkitURL.createObjectURL(b):(c.href=window.URL.createObjectURL(b),
c.onclick=function(a){document.body.removeChild(a.target)},c.style.display="none",document.body.appendChild(c)),c.click())};js.framework.ui.McxCommonControl.CoordinateEditor.McxGetCoordinatesAction={};function McxGetCoordinatesAction(){this._coordinates=[]}
McxGetCoordinatesAction.prototype.execute=function(a){var b=null;a=a.getLayers().toLayerArray();for(var c in a)"nokta"==a[c].getName()&&(b=a[c]);if(null!=b)for(c=new McxAjaxParameter,c.setAsync(!1),b=b.query(null,"1=1",c).getFeatureReader();b.read();){c=b.getCurrent();a=c.getGeometry();if(null==a)break;if(a.isInstanceOf(McxGeometryType.Point))this._coordinates.push({x:a.getX(),y:a.getY(),pointName:"N."+c.getFeatureID()});else if(a.isInstanceOf(McxGeometryType.Polygon)){a=a.getBounds().getPoints();
for(var d in a)this._coordinates.push({x:a[d].getX(),y:a[d].getY(),pointName:"K."+c.getFeatureID()+"."+(parseInt(d,10)+1)})}else if(a.isInstanceOf(McxGeometryType.LineString)){a=a.getPoints();for(var e in a)this._coordinates.push({x:a[e].getX(),y:a[e].getY(),pointName:"C."+c.getFeatureID()+"."+(parseInt(e,10)+1)})}}};McxGetCoordinatesAction.prototype.getCoordinates=function(){return this._coordinates};McxGetCoordinatesAction.prototype.isInstanceOf=function(a){return"McxGetCoordinatesAction"==a};js.framework.ui.McxCommonControl.CoordinateEditor.CoordinateTransformationDialog={};js.framework.ui.McxCommonControl.CoordinateEditor.CoordinateTransformationDialog.McxAfinDialog={};
function McxAfinDialog(){mcx.base(this);this.base=this;this._donusumGroupBox=null;this._groupVisibilityEventHandler=new McxEventHandler;this._kaydetButton=this._fNumberBox=this._eNumberBox=this._dNumberBox=this._yukleButton=this._cNumberBox=this._bNumberBox=this._aNumberBox=null;this._dataGrid=new McxDataGrid;this._ortakDonusumGroupBox=this._featureGrid=null;this._rmsTextBox=new McxNumberBox;this._kapatButton=this._secimiDonusturButton=this._katmanDonusturButton=null;this._rootElement=$("<div/>");
this._coordinates=[];this._calculateFinishEventHandler=new McxEventHandler}mcx.inherits(McxAfinDialog,McxDialogBase);McxAfinDialog.prototype.initialize=function(){this.initializeUiControls()};
McxAfinDialog.prototype.initializeUiControls=function(){this._donusumGroupBox=new McxGroupBox("D\u00f6n\u00fc\u015f\u00fcm Parametreleri");this._donusumGroupBox.getEnabledChangeHandler().addListener(function(){var a=this._donusumGroupBox.getIsEnabled(),a=new McxEventArgs(a.toString());this._groupVisibilityEventHandler.dispatchOnSuccess(this,a)},null,this);this._aNumberBox=new McxNumberBox(-999999999999,999999999999,10);this._aNumberBox.setValue(1);var a=new McxLabeledEditor("A : ",this._aNumberBox,
"",2);this._bNumberBox=new McxNumberBox(-999999999999,999999999999,10);this._bNumberBox.setValue(0);var b=new McxLabeledEditor("B : ",this._bNumberBox,"",4);this._cNumberBox=new McxNumberBox(-999999999999,999999999999,10);this._cNumberBox.setValue(0);var c=new McxLabeledEditor("C : ",this._cNumberBox,"",4);this._yukleButton=new McxButton;this._yukleButton.setText("Y\u00fckle");this._yukleButton.setIsFullWidth(!0);this._yukleButton.setButtonState(McxButtonState.active);this._yukleButton.getClickHandler().addListener(this.uploadFile,
null,this);var d=new McxLayoutRow;d.createAndAddSpan(3,a);d.createAndAddSpan(3,b);d.createAndAddSpan(3,c);d.createAndAddSpan(2,this._yukleButton);this._donusumGroupBox.addContent(d);a=new McxLayoutRow;this._dNumberBox=new McxNumberBox(-999999999999,999999999999,10);this._dNumberBox.setValue(0);b=new McxLabeledEditor("D : ",this._dNumberBox,"",2);this._eNumberBox=new McxNumberBox(-999999999999,999999999999,10);this._eNumberBox.setValue(1);c=new McxLabeledEditor("E : ",this._eNumberBox,"",4);this._fNumberBox=
new McxNumberBox(-999999999999,999999999999,10);this._fNumberBox.setValue(0);var e=new McxLabeledEditor("F : ",this._fNumberBox,"",4);this._kaydetButton=new McxButton;this._kaydetButton.setText("D\u00f6n\u00fc\u015ft\u00fcr");this._kaydetButton.setIsFullWidth(!0);this._kaydetButton.setButtonState(McxButtonState.active);this._kaydetButton.getClickHandler().addListener(this.calculate,null,this);a.createAndAddSpan(3,b);a.createAndAddSpan(3,c);a.createAndAddSpan(3,e);a.createAndAddSpan(2,this._kaydetButton);
this._donusumGroupBox.addContent(d);this._donusumGroupBox.addContent(a);d=new McxLayoutRow;d.createAndAddSpan(12,this._donusumGroupBox);this.base.addChild(this._rootElement,d)};McxAfinDialog.prototype.getDialogTitle=function(){return"Afin D\u00f6n\u00fc\u015f\u00fcm\u00fc"};McxAfinDialog.prototype.getContent=function(){return this._rootElement};McxAfinDialog.prototype.getDialogSize=function(){return McxDialogSize.large};McxAfinDialog.prototype.getDialogButtons=function(){return McxDialogButtons.none};
McxAfinDialog.prototype.setCoordinates=function(a){this._coordinates=a};
McxAfinDialog.prototype.calculate=function(){if(1>this._coordinates.length)return[];var a=parseFloat(this._aNumberBox.getValue()),b=parseFloat(this._bNumberBox.getValue()),c=parseFloat(this._cNumberBox.getValue()),d=parseFloat(this._dNumberBox.getValue()),e=parseFloat(this._eNumberBox.getValue()),f=parseFloat(this._fNumberBox.getValue()),g=[],h;for(h in this._coordinates)g.push({x:a*parseFloat(this._coordinates[h].points.getX())+b*parseFloat(this._coordinates[h].points.getY())+c,y:d*parseFloat(this._coordinates[h].points.getX())+
e*parseFloat(this._coordinates[h].points.getY())+f,pointName:this._coordinates[h].name});this._calculateFinishEventHandler.dispatchOnSuccess(this,new McxEventArgs(g))};McxAfinDialog.prototype.getCalculateFinishedEventHandler=function(){return this._calculateFinishEventHandler};
McxAfinDialog.prototype.uploadFile=function(){var a=new McxFileUploader;a.setAutoUpload(!0);a.onFileUploadClick();a.onUploadButtonClick().addListener(function(){var b=a.getUploadFile(),c=new FileReader;c.readAsText(b);c.onload=$.proxy(function(b){var c=a.getFileName()[1].toString();b=b.target.result;var f="",f=[];if("dns"==c.toLowerCase()){f=-1!=b.indexOf("$NOK")?b.substring(b.lastIndexOf("$AMAT")+5,b.lastIndexOf("$NOK")).trim():b.substring(b.lastIndexOf("$AMAT")+5).trim();if(1>f.length)return;f=
f.replace(/(\s)+/g,"$1").split(" ")}else if("mcd"==c.toLowerCase()){if(-1!=b.indexOf("A")&&-1!=b.indexOf("B")&&-1!=b.indexOf("C")&&-1!=b.indexOf("D")&&-1!=b.indexOf("E")&&-1!=b.indexOf("F"))b=b.replace("A=",""),b=b.replace("B=",""),b=b.replace("C=",""),b=b.replace("D=",""),b=b.replace("E=",""),b=b.replace("F=","");else{McxMessageBox.show("Uyar\u0131","MapCodeX D\u00f6n\u00fc\u015f\u00fcm Dosyas\u0131 Okunamad\u0131.");return}f=b.replace(/(\s)+/g,"$1").split("\n")}this._aNumberBox.setValue(parseFloat(f[0]));
this._bNumberBox.setValue(parseFloat(f[1]));this._cNumberBox.setValue(parseFloat(f[2]));this._dNumberBox.setValue(parseFloat(f[3]));this._eNumberBox.setValue(parseFloat(f[4]));this._fNumberBox.setValue(parseFloat(f[5]))},this)},null,this)};js.framework.ui.McxCommonControl.CoordinateEditor.CoordinateTransformationDialog.McxHelmertDialog={};
function McxHelmertDialog(){mcx.base(this);this.base=this;this._donusumGroupBox=null;this._groupVisibilityEventHandler=new McxEventHandler;this._kaydetButton=this._yNumberBox=this._bNumberBox=this._yukleButton=this._xNumberBox=this._aNumberBox=null;this._dataGrid=new McxDataGrid;this._ortakDonusumGroupBox=this._featureGrid=null;this._rmsTextBox=new McxNumberBox;this._kapatButton=this._secimiDonusturButton=this._katmanDonusturButton=null;this._rootElement=$("<div/>");this._coordinates=[];this._calculateFinishEventHandler=
new McxEventHandler}mcx.inherits(McxHelmertDialog,McxDialogBase);McxHelmertDialog.prototype.initialize=function(){this.initializeUiControls()};
McxHelmertDialog.prototype.initializeUiControls=function(){this._donusumGroupBox=new McxGroupBox("D\u00f6n\u00fc\u015f\u00fcm Parametreleri");this._donusumGroupBox.getEnabledChangeHandler().addListener(function(){var a=this._donusumGroupBox.getIsEnabled(),a=new McxEventArgs(a.toString());this._groupVisibilityEventHandler.dispatchOnSuccess(this,a)},null,this);this._aNumberBox=new McxNumberBox(-999999999999,999999999999,10);this._aNumberBox.setValue(1);var a=new McxLabeledEditor("A : ",this._aNumberBox,
"",2);this._xNumberBox=new McxNumberBox(-999999999999,999999999999,10);this._xNumberBox.setValue(0);var b=new McxLabeledEditor("X0 : ",this._xNumberBox,"",4);this._yukleButton=new McxButton;this._yukleButton.setText("Y\u00fckle");this._yukleButton.setIsFullWidth(!0);this._yukleButton.setButtonState(McxButtonState.active);this._yukleButton.getClickHandler().addListener(this.uploadFile,null,this);var c=new McxLayoutRow;c.createAndAddSpan(5,a);c.createAndAddSpan(5,b);c.createAndAddSpan(2,this._yukleButton);
this._donusumGroupBox.addContent(c);a=new McxLayoutRow;this._bNumberBox=new McxNumberBox(-999999999999,999999999999,10);this._bNumberBox.setValue(0);b=new McxLabeledEditor("B : ",this._bNumberBox,"",2);this._yNumberBox=new McxNumberBox(-999999999999,999999999999,10);this._yNumberBox.setValue(0);var d=new McxLabeledEditor("Y0 : ",this._yNumberBox,"",4);this._kaydetButton=new McxButton;this._kaydetButton.setText("D\u00f6n\u00fc\u015ft\u00fcr");this._kaydetButton.setIsFullWidth(!0);this._kaydetButton.setButtonState(McxButtonState.active);
this._kaydetButton.getClickHandler().addListener(this.calculate,null,this);a.createAndAddSpan(5,b);a.createAndAddSpan(5,d);a.createAndAddSpan(2,this._kaydetButton);this._donusumGroupBox.addContent(c);this._donusumGroupBox.addContent(a);c=new McxLayoutRow;c.createAndAddSpan(12,this._donusumGroupBox);this.base.addChild(this._rootElement,c)};McxHelmertDialog.prototype.getDialogTitle=function(){return"Helmert D\u00f6n\u00fc\u015f\u00fcm\u00fc"};McxHelmertDialog.prototype.getContent=function(){return this._rootElement};
McxHelmertDialog.prototype.getDialogSize=function(){return McxDialogSize.large};McxHelmertDialog.prototype.getDialogButtons=function(){return McxDialogButtons.none};McxHelmertDialog.prototype.setCoordinates=function(a){this._coordinates=a};
McxHelmertDialog.prototype.calculate=function(){if(1>this._coordinates.length)return[];var a=parseFloat(this._aNumberBox.getValue()),b=parseFloat(this._bNumberBox.getValue()),c=parseFloat(this._xNumberBox.getValue()),d=parseFloat(this._yNumberBox.getValue()),e=[],f;for(f in this._coordinates)e.push({x:c+a*parseFloat(this._coordinates[f].points.getX())-b*parseFloat(this._coordinates[f].points.getY()),y:d+b*parseFloat(this._coordinates[f].points.getX())+a*parseFloat(this._coordinates[f].points.getY()),
pointName:this._coordinates[f].name});this._calculateFinishEventHandler.dispatchOnSuccess(this,new McxEventArgs(e))};McxHelmertDialog.prototype.getCalculateFinishedEventHandler=function(){return this._calculateFinishEventHandler};
McxHelmertDialog.prototype.uploadFile=function(){var a=new McxFileUploader;a.setAutoUpload(!0);a.onFileUploadClick();a.onUploadButtonClick().addListener(function(){var b=a.getUploadFile(),c=new FileReader;c.readAsText(b);c.onload=$.proxy(function(b){var c=a.getFileName()[1].toString();b=b.target.result;var f="",f=[];if("dns"==c.toLowerCase()){f=-1!=b.indexOf("$NOK")?b.substring(b.lastIndexOf("$AMAT")+5,b.lastIndexOf("$NOK")).trim():b.substring(b.lastIndexOf("$AMAT")+5).trim();if(1>f.length)return;
f=f.replace(/(\s)+/g,"$1").split(" ")}else if("mcd"==c.toLowerCase()){if(-1!=b.indexOf("A")&&-1!=b.indexOf("B")&&-1!=b.indexOf("X0")&&-1!=b.indexOf("Y0"))b=b.replace("A=",""),b=b.replace("B=",""),b=b.replace("X0=",""),b=b.replace("Y0=","");else{McxMessageBox.show("Uyar\u0131","MapCodeX D\u00f6n\u00fc\u015f\u00fcm Dosyas\u0131 Okunamad\u0131.");return}f=b.replace(/(\s)+/g,"$1").split("\n")}this._aNumberBox.setValue(parseFloat(f[0]));this._bNumberBox.setValue(parseFloat(f[1]));this._xNumberBox.setValue(parseFloat(f[2]));
this._yNumberBox.setValue(parseFloat(f[3]))},this)},null,this)};js.framework.ui.McxCommonControl.DataGrid={};js.framework.ui.McxCommonControl.DataGrid.McxDataGridAfterEditEventArgs={};function McxDataGridAfterEditEventArgs(a,b,c,d){mcx.base(this,d);this.rowIndex_=a;this.rowData_=b;this.changes_=c}mcx.inherits(McxDataGridAfterEditEventArgs,McxEventArgs);McxDataGridAfterEditEventArgs.prototype.getRowIndex=function(){return this.rowIndex_};McxDataGridAfterEditEventArgs.prototype.getRowData=function(){return this.rowData_};
McxDataGridAfterEditEventArgs.prototype.getChanges=function(){return this.changes_};js.framework.ui.McxCommonControl.DataGrid.McxDataGridBeforeRemoveRowEventArgs={};function McxDataGridBeforeRemoveRowEventArgs(a,b,c){mcx.base(this,c);this.rowIndex_=a;this.rowData_=b}mcx.inherits(McxDataGridBeforeRemoveRowEventArgs,McxEventArgs);McxDataGridBeforeRemoveRowEventArgs.prototype.getRowIndex=function(){return this.rowIndex_};McxDataGridBeforeRemoveRowEventArgs.prototype.getRowData=function(){return this.rowData_};js.framework.ui.McxCommonControl.DataGrid.McxDataGridCancelEditEventArgs={};function McxDataGridCancelEditEventArgs(a,b,c){mcx.base(this,c);this.rowIndex_=a;this.rowData_=b}mcx.inherits(McxDataGridCancelEditEventArgs,McxEventArgs);McxDataGridCancelEditEventArgs.prototype.getRowIndex=function(){return this.rowIndex_};McxDataGridCancelEditEventArgs.prototype.getRowData=function(){return this.rowData_};js.framework.ui.McxCommonControl.DataGrid.McxDataGridClickRowEventArgs={};function McxDataGridClickRowEventArgs(a,b,c){mcx.base(this,c);this.rowIndex_=a;this.rowData_=b}mcx.inherits(McxDataGridClickRowEventArgs,McxEventArgs);McxDataGridClickRowEventArgs.prototype.getRowIndex=function(){return this.rowIndex_};McxDataGridClickRowEventArgs.prototype.getRowData=function(){return this.rowData_};js.framework.ui.McxCommonControl.DataGrid.McxDataGridSelectEventArgs={};function McxDataGridSelectEventArgs(a,b,c){mcx.base(this,c);this.rowIndex_=a;this.rowData_=b;this.sender=null}mcx.inherits(McxDataGridSelectEventArgs,McxEventArgs);McxDataGridSelectEventArgs.prototype.getRowIndex=function(){return this.rowIndex_};McxDataGridSelectEventArgs.prototype.getRowData=function(){return this.rowData_};McxDataGridSelectEventArgs.prototype.setSender=function(a){this.sender=a};
McxDataGridSelectEventArgs.prototype.getSender=function(){return this.sender};js.framework.ui.McxCommonControl.DataGrid.DataGrid={};js.framework.ui.McxCommonControl.DataGrid.DataGrid.IMcxDataColumn={};function IMcxDataColumn(){}IMcxDataColumn.prototype.getTitle=function(){};IMcxDataColumn.prototype.getTitleLocalizationKey=function(){};IMcxDataColumn.prototype.getIsEditable=function(){};IMcxDataColumn.prototype.createEditor=function(){};IMcxDataColumn.prototype.bindField=function(a){};IMcxDataColumn.prototype.bindProperty=function(a,b,c){};
IMcxDataColumn.prototype.setCustomTextGetter=function(a){};IMcxDataColumn.prototype.getValue=function(a){};IMcxDataColumn.prototype.setValue=function(a,b){};IMcxDataColumn.prototype.getText=function(a){};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxDataGridColumnFilter={};function McxDataGridColumnFilter(a,b){this._column=a;this._value=b}McxDataGridColumnFilter.prototype.getColumn=function(){return this._column};McxDataGridColumnFilter.prototype.getValue=function(){return this._value};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxDataGridColumnOrder={};var McxDataGridColumnOrder={None:1,ASC:2,DESC:3};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxDataGridFieldBinding={};function McxDataGridFieldBinding(a){this._fieldName=a}McxDataGridFieldBinding.prototype.getFieldName=function(){return this._fieldName};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxDataGridFilterBuilder={};function McxDataGridFilterBuilder(){this._filterList=[]}McxDataGridFilterBuilder.prototype.merge=function(a){a=a.getFilters();for(var b=0;b<a.length;b++)this.addFilter(a[b])};McxDataGridFilterBuilder.prototype.addFilter=function(a){this._filterList.push(a)};McxDataGridFilterBuilder.prototype.getFilters=function(){return this._filterList};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxDataGridPropertyBinding={};function McxDataGridPropertyBinding(a,b,c){this._getterName=a;this._setterName=b;this._params=c}McxDataGridPropertyBinding.prototype.getGetterName=function(){return this._getterName};McxDataGridPropertyBinding.prototype.getSetterName=function(){return this._setterName};McxDataGridPropertyBinding.prototype.getParams=function(){return this._params};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxDataRowSelectMode={};var McxDataRowSelectMode={None:1,SingleSelect:2,MultiSelect:3};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxDateColumnPickerType={};var McxDateColumnPickerType={date:1,time:2,dateAndTime:3};js.framework.ui.McxCommonControl.DataGrid.DataGrid.DataSource={};js.framework.ui.McxCommonControl.DataGrid.DataGrid.DataSource.McxDataGridAbstractDataSource={};function McxDataGridAbstractDataSource(){this._dataCompleteEventHandler=new McxEventHandler;this._dataStartEventHandler=new McxEventHandler;this._searchDataCompleteEventHandler=new McxEventHandler;this._lastOffset=0;this._lastLimit=20}McxDataGridAbstractDataSource.prototype.getData=function(a,b){this._lastLimit=b;this._lastOffset=a};
McxDataGridAbstractDataSource.prototype.onGetDataComplete=function(a){this.getDataCompleteEventHandler().dispatchOnSuccess(this,new McxDataGridSourceEventArgs(a))};McxDataGridAbstractDataSource.prototype.onGetDataStart=function(){this.getDataStartEventHandler().dispatchOnSuccess(this,null)};McxDataGridAbstractDataSource.prototype.onSearchDataComplete=function(a){this.getSearchDataCompleteEventHandler().dispatchOnSuccess(this,new McxDataGridSourceEventArgs(a))};
McxDataGridAbstractDataSource.prototype.getDataCompleteEventHandler=function(){return this._dataCompleteEventHandler};McxDataGridAbstractDataSource.prototype.getDataStartEventHandler=function(){return this._dataStartEventHandler};McxDataGridAbstractDataSource.prototype.getSearchDataCompleteEventHandler=function(){return this._searchDataCompleteEventHandler};
McxDataGridAbstractDataSource.prototype.search=function(a){this.getDataCompleteEventHandler().removeListener(this.getSearchData);this.getDataCompleteEventHandler().addListener(this.getSearchData,null,{scope:this,item:a});this.getData(0,this.getTotalCount())};
McxDataGridAbstractDataSource.prototype.getSearchData=function(a){var b=this.scope,c=this.item;b.getDataCompleteEventHandler().removeListener(b.getSearchData);a=a.getData();for(var d=[],e=0;e<a.length;e++){var f=!0,g=a[e],h;for(h in c)if(f=g[h]==c[h],!f)break;f&&d.push(g)}b.onSearchDataComplete(d)};McxDataGridAbstractDataSource.prototype.getTotalCount=mcx.abstractMethod;McxDataGridAbstractDataSource.prototype.setFilter=function(a){mcx.abstractMethod()};
McxDataGridAbstractDataSource.prototype.getFilter=function(){mcx.abstractMethod();return null};McxDataGridAbstractDataSource.prototype.orderBy=function(a,b){mcx.abstractMethod()};McxDataGridAbstractDataSource.prototype.getLastOffset=function(){return this._lastOffset};McxDataGridAbstractDataSource.prototype.getLastLimit=function(){return this._lastLimit};js.framework.ui.McxCommonControl.DataGrid.DataGrid.DataSource.McxDataGridArrayDataSource={};function McxDataGridArrayDataSource(a){mcx.base(this);this._actualData=this._data=a;this._filterBuilder=new McxDataGridFilterBuilder;this.base=this}mcx.inherits(McxDataGridArrayDataSource,McxDataGridAbstractDataSource);McxDataGridArrayDataSource.prototype.getData=function(a,b){McxDataGridArrayDataSource.superClass_.getData.call(this,a,b);var c=this._data.slice(a,b);this.base.onGetDataComplete(c)};
McxDataGridArrayDataSource.prototype.getTotalCount=function(){return this._data.length};McxDataGridArrayDataSource.prototype.search=function(a,b){var c=!0,d;for(d in a)c=c&&!a[d]&&!1!==a[d]&&0!==a[d];c&&this.base.getData(0,this.base._lastLimit);c=[];for(d=0;d<this._data.length;d++){var e=!0,f=this._data[d];if(b)e=b(a,this._data[d]);else for(var g in a)if((e=f[g]==a[g])||f[g].toString().toLowerCase().indexOf(a[g].toString().toLowerCase()),!e)break;e&&c.push(f)}this.base.onSearchDataComplete(c)};
McxDataGridArrayDataSource.prototype.setFilter=function(a){if(a&&a.getFilters()&&0!=a.getFilters().length){for(var b=a.getFilters(),c=[],d=0;d<this._actualData.length;d++)for(var e=this._actualData[d],f=0;f<b.length;f++){var g=b[f];-1!=g.getColumn().getValue(e).toString().indexOf(g.getValue().toString())&&c.push(e)}this._filterBuilder=a;this._data=c}else this._data=this._actualData,this._filterBuilder=new McxDataGridFilterBuilder;this.getData(0,this._lastLimit||20)};
McxDataGridArrayDataSource.prototype.getFilter=function(){return this._filterBuilder};McxDataGridArrayDataSource.prototype.orderBy=function(a,b){function c(c,d){return b==McxDataGridColumnOrder.ASC?a.getValue(c)>a.getValue(d):b==McxDataGridColumnOrder.DESC?a.getValue(c)<a.getValue(d):!1}var d=this._data;b!=McxDataGridColumnOrder.None&&d.sort(c);this._data=d;this.getData(0,this._lastLimit||20)};js.framework.ui.McxCommonControl.DataGrid.DataGrid.EventArgs={};js.framework.ui.McxCommonControl.DataGrid.DataGrid.EventArgs.McxDataGridOrderEventArgs={};function McxDataGridOrderEventArgs(a,b){mcx.base(this,b);this._orderType=b;this._column=a}mcx.inherits(McxDataGridOrderEventArgs,McxEventArgs);McxDataGridOrderEventArgs.prototype.getOrderType=function(){return this._orderType};McxDataGridOrderEventArgs.prototype.getColumn=function(){return this._column};js.framework.ui.McxCommonControl.DataGrid.DataGrid.EventArgs.McxDataGridSourceEventArgs={};function McxDataGridSourceEventArgs(a){mcx.base(this,a);this._data=a}mcx.inherits(McxDataGridSourceEventArgs,McxEventArgs);McxDataGridSourceEventArgs.prototype.getData=function(){return this._data};js.framework.ui.McxCommonControl.DataGrid.DataGrid.EventArgs.McxDataRowEventArgs={};function McxDataRowEventArgs(a){mcx.base(this,a);this._row=a}mcx.inherits(McxDataRowEventArgs,McxEventArgs);McxDataRowEventArgs.prototype.getRow=function(){return this._row};js.framework.ui.McxCommonControl.DataSourceListControl={};js.framework.ui.McxCommonControl.DataSourceListControl.McxDataSourceListControl={};
function McxDataSourceListControl(){mcx.base(this);this._rootElement=$("<div/>").addClass("mcx-datasource-list-control");this._sourceContainer=$("<div/>").addClass("mcx-datasource-source-container");this._layerContainer=$("<div/>").addClass("mcx-datasource-layer-container");this._chosenLayerContainer=$("<div/>").addClass("mcx-datasource-chosen-layer");this.initialize()}mcx.inherits(McxDataSourceListControl,McxUserControl);
McxDataSourceListControl.prototype.initialize=function(){this._rootElement.append(this._sourceContainer);this._rootElement.append(this._layerContainer);this._rootElement.append(this._chosenLayerContainer)};
McxDataSourceListControl.prototype.addDataSourceItem=function(a,b){var c=$("<div/>").addClass("mcx-datasource-source-item").text(a).data("dataSource",b).addClass(a);c.on("click",$.proxy(this.onDataSourceChange,this));this._sourceContainer.append(c);1==this._sourceContainer.find(".mcx-datasource-source-item").length&&(this._sourceContainer.find(".mcx-datasource-source-item").eq(0).addClass("selected"),this.getLayers(b.driver,a,b.source))};
McxDataSourceListControl.prototype.onDataSourceChange=function(a){var b=$(a.target).data("dataSource");this._sourceContainer.find(".selected").removeClass("selected");$(a.target).addClass("selected");this._layerContainer.empty();this.getLayers(b.driver,b.dataSourceName,b.source)};McxDataSourceListControl.prototype.onLayerSelected=function(a){a=$(a.target).addClass("chosen");a.unbind("click");a.on("click",$.proxy(this.layerNotSelected,this));this._chosenLayerContainer.append(a)};
McxDataSourceListControl.prototype.layerNotSelected=function(a){var b=$(a.target).removeClass("chosen");a=$(a.target).data("dataSource");b.unbind("click");b.on("click",$.proxy(this.onLayerSelected,this));this._sourceContainer.find(".selected").eq(0).hasClass(a+"")?this._layerContainer.prepend(b):b.remove()};
McxDataSourceListControl.prototype.getSelectedLayers=function(){for(var a=[],b=this._chosenLayerContainer.find(".chosen"),c=0;c<b.length;c++){var d=!1;a.forEach(function(a){a.source==$(b[c]).data("source")&&(d=!0)});d?a.forEach(function(a){a.source==$(b[c]).data("source")&&a.layers.push($(b[c]).text())}):a.push({source:$(b[c]).data("source"),driver:$(b[c]).data("driver"),layers:[$(b[c]).text()]})}return a};
McxDataSourceListControl.prototype.getLayers=function(a,b,c){var d=c.split("@"),e=d[d.length-1],f=new McxAjaxParameter;f.setAsync(!1);b=a.getLayerInfo(e,b,d[2],f).getLayerNames();for(d=0;d<b.length;d++)e=b[d],f=e.split(":")[0],e=$("<div/>").addClass("mcx-datasource-layer-item").text(e).data("driver",a).data("source",c).data("dataSource",f),e.on("click",$.proxy(this.onLayerSelected,this)),this._layerContainer.append(e)};
McxDataSourceListControl.prototype.clear=function(){this._chosenLayerContainer.empty();this._layerContainer.empty();this._sourceContainer.empty()};McxDataSourceListControl.prototype.getContent=function(){return this._rootElement};var s={framework:{}};s.framework.ui={};s.framework.ui.McxCommonControl={};s.framework.ui.McxCommonControl.DateTimePicker={};s.framework.ui.McxCommonControl.DateTimePicker.McxDateTimePicker={};function McxDateTimePicker(a,b){mcx.base(this);this._dateElem=this._rootElement=null;this._timePicker=null!=b?b:!0;this._datePicker=null!=a?a:!0;this._format="DD/MM/YYYY";this.base=this;this.initialize()}mcx.inherits(McxDateTimePicker,McxValidatableControl);
McxDateTimePicker.prototype.initialize=function(){this._rootElement=$("<div style='padding: 0 0 0 5px; position: relative' />");var a=$("<div class='calendar-icon'/>");this._rootElement.append(a);this._dateElem=$("<input type='text' class='mcx-input fit'/>");var b="",c="";this._datePicker&&(b+="DD/MM/YYYY");this._timePicker&&(c+=" HH:mm");var d="";this._datePicker&&(d+="39/19/9999");this._timePicker&&(d+=" 29:59");this._format=b+c;this._dateElem.datetimepicker({format:this._format,formatTime:c,formatDate:b,
lang:"tr",step:5,mask:d,dayOfWeekStart:1,timepicker:this._timePicker,datepicker:this._datePicker,startDate:new Date,className:"mcx-datetime-picker",allowBlank:!0,validateOnBlur:!1,onShow:$.proxy(function(){this._dateElem.datetimepicker({lang:McxLocalizationManager.getLanguage().split("-")[0]})},this)});this._rootElement.append(this._dateElem);this._rootElement.focusout($.proxy(function(){this._dateElem.datetimepicker("hide")},this));this._dateElem.blur($.proxy(function(){this._dateElem.datetimepicker("hide")},
this));a.click($.proxy(function(){this._dateElem.datetimepicker("show")},this))};McxDateTimePicker.prototype.setValue=function(a){this._dateElem.datetimepicker({value:a?a.toString(this._format):""})};McxDateTimePicker.prototype.getValue=function(){var a=this._dateElem.val();return(new McxDateTime).setDate(a&&a.toString()||"",this._format)};McxDateTimePicker.prototype.getValueAsIsoString=function(){var a=this._dateElem.val();return""!=a?Date.parseDate(a.toString(),this._format).toISOString():""};
McxDateTimePicker.prototype.getContent=function(){return this._rootElement};McxDateTimePicker.prototype.setFormat=function(a){this._format=a};McxDateTimePicker.prototype.clear=function(){this._dateElem.val("")};js.framework.ui.McxCommonControl.DisplayItemView={};js.framework.ui.McxCommonControl.DisplayItemView.McxDisplayItemView={};function McxDisplayItemView(){mcx.base(this);this.base=this;this._item=null;this._rootElement=$("<div/>").addClass("mcx-display-item");this._buttonContainer=$("<div/>").addClass("mcx-display-item-buttons");this._itemTitleElem=$("<div/>").addClass("mcx-display-item-title");this.initialize()}mcx.inherits(McxDisplayItemView,McxUserControl);McxDisplayItemView.prototype.setTitle=function(a){this._itemTitleElem.text(a)};
McxDisplayItemView.prototype.setItem=function(a){this._item=a};McxDisplayItemView.prototype.getItem=function(){return this._item};McxDisplayItemView.prototype.addToolButton=function(a){a.setButtonSize(McxButtonSize.small);a.setButtonVisualType(McxButtonVisualType.linkButton);a.css("padding","4px");this.base.addChild(this._buttonContainer,a)};McxDisplayItemView.prototype.initialize=function(){this._rootElement.append(this._itemTitleElem);this._rootElement.append(this._buttonContainer)};
McxDisplayItemView.prototype.getLocalizationPath=function(){return""};McxDisplayItemView.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.FeatureBalloon={};js.framework.ui.McxCommonControl.FeatureBalloon.McxFeatureBalloon={};
function McxFeatureBalloon(){mcx.base(this);this.base=this;this._rootElement=$("<div/>").addClass("mcx-feature-balloon");this._headerElement=$("<div/>").addClass("mcx-feature-balloon-header");this._titleElement=$("<div/>").hide().addClass("mcx-feature-balloon-title");this._closeButton=$("<div/>").addClass("mcx-feature-balloon-close-button");this._contentElement=$("<div/>").hide().addClass("mcx-feature-balloon-content-holder");this._footerElement=$("<div/>").addClass("mcx-feature-balloon-footer");
this._arrowDownElement=$("<span/>").addClass("mcx-feature-balloon-arrow-down");this._closeButtonClickHandler=new McxEventHandler;this._onMouseEnterHandler=new McxEventHandler;this.initialize();this.bindEvents()}mcx.inherits(McxFeatureBalloon,McxUserControl);
McxFeatureBalloon.prototype.bindEvents=function(){this.base.setIsMovable(!0,this._headerElement,this._rootElement);this.base.getMoveStartEventHandler().addListener(function(){this._footerElement.hide()},null,this);this.base.getMoveEndEventHandler().addListener(function(){var a=this._footerElement.offset(),b=this._rootElement.offset(),c=a.top-b.top,b=a.left-b.left,a=Math.pow(Math.pow(c,2)+Math.pow(b,2),.5),c=Math.atan2(b,c),c=-180/Math.PI*c;this._footerElement.css({transform:"rotate("+c+"deg)","transform-origin":"0 0 0"});
this._footerElement.height(a);this._footerElement.show()},null,this);this._closeButton.click($.proxy(this.onCloseButtonClick,this));this._rootElement.bind("mouseenter",$.proxy(function(){this.onMouseEnter().dispatchOnSuccess(this,null)},this));this._rootElement.bind("click mousemose mouseleave mouseenter mousedown mouseup",function(a){a.stopPropagation()})};
McxFeatureBalloon.prototype.initialize=function(){this._headerElement.append(this._titleElement);this._footerElement.append(this._arrowDownElement);this._rootElement.append(this._headerElement);this._rootElement.append(this._contentElement);this._rootElement.append(this._footerElement);this._rootElement.append(this._closeButton)};McxFeatureBalloon.prototype.onMouseEnter=function(){return this._onMouseEnterHandler};
McxFeatureBalloon.prototype.onCloseButtonClick=function(){var a=new McxEventArgs(this._rootElement[0].id);this.getCloseButtonClickHandler().dispatchOnSuccess(this,a)};McxFeatureBalloon.prototype.getCloseButtonClickHandler=function(){return this._closeButtonClickHandler};McxFeatureBalloon.prototype.getContent=function(){return this._rootElement};McxFeatureBalloon.prototype.setContent=function(a){a.addClass("mcx-feature-balloon-content");this._contentElement.empty().append(a).show()};
McxFeatureBalloon.prototype.setTitle=function(a){a&&""!=a&&this._titleElement.html(a).show()};js.framework.ui.McxCommonControl.FeatureClassifyView={};js.framework.ui.McxCommonControl.FeatureClassifyView.IMcxFeatureClassifyView={};function IMcxFeatureClassifyView(){}IMcxFeatureClassifyView.prototype.setColoringItemRange=function(a){};IMcxFeatureClassifyView.prototype.setSelectedColoringItems=function(a){};IMcxFeatureClassifyView.prototype.getSelectedColoringItems=function(){};IMcxFeatureClassifyView.prototype.getContent=function(){};IMcxFeatureClassifyView.prototype.setGradient=function(a){};
IMcxFeatureClassifyView.prototype.applyGradient=function(){};js.framework.ui.McxCommonControl.FeatureClassifyView.McxFeatureClassifyView={};function McxFeatureClassifyView(){mcx.base(this);this.base=this;this._coloringItemRange=this._deselectAllButton=this._selectAllButton=this._rootElement=null;this._selectedColoringItems=[];this._coloringItemSelectBox=this._layer=this._gradient=null;this.initialize()}mcx.inherits(McxFeatureClassifyView,McxUserControl);
McxFeatureClassifyView.prototype.initialize=function(){this._rootElement=$("<div/>");var a=new McxPanel,b=new McxLayoutRow,c=new McxLayoutRow;c.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center);this._deselectAllButton=new McxButton;this._selectAllButton=new McxButton;this._deselectAllButton.setText("Deselect All");this._deselectAllButton.setLocalizationKey("McxCommonControl-deselectAll");this._selectAllButton.setText("Select All");this._selectAllButton.setLocalizationKey("McxCommonControl-selectAll");
this._deselectAllButton.setButtonSize(McxButtonSize.small);this._selectAllButton.setButtonSize(McxButtonSize.small);this._deselectAllButton.setIsFullWidth(!0);this._selectAllButton.setIsFullWidth(!0);this._deselectAllButton.setButtonState(McxButtonState.predefined);this._selectAllButton.setButtonState(McxButtonState.predefined);c.createAndAddSpan(6,this._selectAllButton);c.createAndAddSpan(6,this._deselectAllButton);this._coloringItemSelectBox=new McxListBox;this._coloringItemSelectBox.setVisibleItemCount(16);
this._coloringItemSelectBox.getContent().css("height","420px !important");this._coloringItemSelectBox.setTextGetter("getText");this._coloringItemSelectBox.setMultiSelect(!0);b.createAndAddSpan(12,this._coloringItemSelectBox);a.addControl(b);a.addControl(c);this.base.addChild(this._rootElement,a);this._selectAllButton.getClickHandler().addListener(function(){this._coloringItemSelectBox.selectAll()},null,this);this._deselectAllButton.getClickHandler().addListener(function(){this._coloringItemSelectBox.deselectAll()},
null,this)};McxFeatureClassifyView.prototype.setColoringItemRange=function(a){this._coloringItemRange=a;this._coloringItemSelectBox.clear();0<a.length&&(a[0].getValue()instanceof McxCodedValue?this._coloringItemSelectBox.setValueGetter("getText"):this._coloringItemSelectBox.setValueGetter("getValue"),this._coloringItemSelectBox.addItemRange(a))};McxFeatureClassifyView.prototype.setSelectedColoringItems=function(a){this._coloringItemSelectBox.setSelectedItems(a);this._selectedColoringItems=a};
McxFeatureClassifyView.prototype.getSelectedColoringItems=function(){for(var a=this._coloringItemSelectBox.getSelectedItems(),b=0;b<a.length;b++){var c=a[b];0==mcx.isDefAndNotNull(c.getLabelSymbolizer())&&c.setLabelSymbolizer(new McxTextSymbolizer)}return a};McxFeatureClassifyView.prototype.getContent=function(){return this._rootElement};McxFeatureClassifyView.prototype.setGradient=function(a){this._gradient=a;this.applyGradient()};
McxFeatureClassifyView.prototype.applyGradient=function(){if(0!=mcx.isDefAndNotNull(this._selectedColoringItems)&&0!=mcx.isDefAndNotNull(this._gradient))for(var a=0;a<this._selectedColoringItems.length;a++){var b=this._selectedColoringItems[a],c=this._gradient.getColorAtStop(a/this._selectedColoringItems.length*100),b=b.getSymbolizer(),c=c.getRgbStyleString();if(b.isInstanceOf("IMcxCompositeSymbolizer")){var d=b.getPointSymbolizer();this.applyGradientToPointSymbolizer(d,c);(d=b.getPolygonSymbolizer().getFill())&&
d.setColor(c);(d=b.getPolygonSymbolizer().getStroke())&&d.setColor(c);(d=b.getLineSymbolizer().getStroke())&&d.setColor(c)}b.isInstanceOf("IMcxPolygonSymbolizer")&&b.getFill().setColor(c);b.isInstanceOf("IMcxLineSymbolizer")&&b.getStroke().setColor(c);b.isInstanceOf("IMcxPointSymbolizer")&&this.applyGradientToPointSymbolizer(b,c)}};
McxFeatureClassifyView.prototype.applyGradientToPointSymbolizer=function(a,b){if(a)for(var c=a.getSymbols(),d=0;d<c.length;d++){var e=c[d];e.isInstanceOf("IMcxMark")&&(e.getFill().setColor(b),e.getStroke().setColor(b))}};McxFeatureClassifyView.prototype.getMaxItemCount=function(){return this._coloringItemSelectBox.getMaxItemCount()};js.framework.ui.McxCommonControl.FeatureClassifyView.McxRangedValueFeatureClassifyView={};function McxRangedValueFeatureClassifyView(){mcx.base(this);this.base=this;this._selectedColoringItems=this._coloringItemRange=this._rootElement=null;this._minValueNumberBox=new McxNumberBox(0,Number.MAX_VALUE,5);this._maxValueNumberBox=new McxNumberBox(0,Number.MAX_VALUE,5);this._gradient=null;this.initialize()}mcx.inherits(McxRangedValueFeatureClassifyView,McxUserControl);
McxRangedValueFeatureClassifyView.prototype.initialize=function(){this._rootElement=$("<div/>");var a=new McxGroupBox("Range");a.setLocalizationKeyForTitle("McxCommonControl-mcxLayerPropertiesRange");this._minValueNumberBox=new McxNumberBox(0,Number.MAX_VALUE,5);this._maxValueNumberBox=new McxNumberBox(0,Number.MAX_VALUE,5);this._minValueNumberBox.setValue(NaN);this._maxValueNumberBox.setValue(NaN);var b=new McxLabeledEditor("Minimum",this._minValueNumberBox);b.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesMinimum");
a.addContent(b);b=new McxLabeledEditor("Maximum",this._maxValueNumberBox);b.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesMaximum");a.addContent(b);this.base.addChild(this._rootElement,a)};
McxRangedValueFeatureClassifyView.prototype.setColoringItemRange=function(a){if((this._coloringItemRange=a)&&0!=a.length){for(var b=Number.MAX_VALUE,c=Number.MIN_VALUE,d=0;d<a.length;d++)b=Math.min(a[d].getValue(),b),c=Math.max(a[d].getValue(),c);this._minValueNumberBox.setValue(b);this._maxValueNumberBox.setValue(c)}else this._minValueNumberBox.setValue(NaN),this._maxValueNumberBox.setValue(NaN)};
McxRangedValueFeatureClassifyView.prototype.setSelectedColoringItems=function(a){this._selectedColoringItems=a};McxRangedValueFeatureClassifyView.prototype.setGradient=function(a){this._gradient=a;this.applyGradient()};
McxRangedValueFeatureClassifyView.prototype.getSelectedColoringItems=function(){for(var a=this._minValueNumberBox.getValue(),b=this._maxValueNumberBox.getValue(),c=[],d=0;d<this._coloringItemRange.length;d++){var e=this._coloringItemRange[d];parseFloat(e.getValue())>a&&parseFloat(e.getValue())<b&&c.push(e)}this._selectedColoringItems=c;this.applyGradient();return c};McxRangedValueFeatureClassifyView.prototype.getContent=function(){return this._rootElement};
McxRangedValueFeatureClassifyView.prototype.applyGradientToPointSymbolizer=function(a,b){if(a)for(var c=a.getSymbols(),d=0;d<c.length;d++){var e=c[d];e.isInstanceOf("IMcxMark")&&(e.getFill().setColor(b),e.getStroke().setColor(b))}};
McxRangedValueFeatureClassifyView.prototype.applyGradient=function(){if(0!=mcx.isDefAndNotNull(this._selectedColoringItems)&&0!=mcx.isDefAndNotNull(this._gradient)){for(var a=Number.MAX_VALUE,b=Number.MIN_VALUE,c=0;c<this._selectedColoringItems.length;c++){var d=this._selectedColoringItems[c].getValue();d&&!isNaN(d)&&(a=Math.min(parseFloat(d),a),b=Math.max(parseFloat(d),b))}for(c=0;c<this._coloringItemRange.length;c++){var d=this._coloringItemRange[c],e=d.getValue();e&&(e=this._gradient.getColorAtStop((parseFloat(e)-
a)/(b-a)*100),d=d.getSymbolizer(),e=e.getRgbStyleString(),d.isInstanceOf("IMcxCompositeSymbolizer")&&(this.applyGradientToPointSymbolizer(d.getPointSymbolizer(),e),d.getPolygonSymbolizer().getFill().setColor(e),d.getPolygonSymbolizer().getStroke().setColor(e),d.getLineSymbolizer().getStroke().setColor(e)),d.isInstanceOf("IMcxPolygonSymbolizer")&&d.getFill().setColor(e),d.isInstanceOf("IMcxLineSymbolizer")&&d.getStroke().setColor(e),d.isInstanceOf("IMcxPointSymbolizer")&&this.applyGradientToPointSymbolizer(d,
e))}}};js.framework.ui.McxCommonControl.FeatureExplorer={};js.framework.ui.McxCommonControl.FeatureExplorer.IMcxFeatureExplorer={};function IMcxFeatureExplorer(){}IMcxFeatureExplorer.prototype.initialize=function(){};IMcxFeatureExplorer.prototype.addPage=function(a){};IMcxFeatureExplorer.prototype.removePage=function(a){};IMcxFeatureExplorer.prototype.getActivePage=function(){};IMcxFeatureExplorer.prototype.setActivePage=function(a){};IMcxFeatureExplorer.prototype.addFeature=function(a){};
IMcxFeatureExplorer.prototype.addFeatures=function(a){};IMcxFeatureExplorer.prototype.removeFeature=function(a){};IMcxFeatureExplorer.prototype.removeFeatures=function(a){};IMcxFeatureExplorer.prototype.getSelectedFeatures=function(){};IMcxFeatureExplorer.prototype.clear=function(){};IMcxFeatureExplorer.prototype.getFeatures=function(){};IMcxFeatureExplorer.prototype.setFeatures=function(a){};IMcxFeatureExplorer.prototype.getFeatureCountLimit=function(){};
IMcxFeatureExplorer.prototype.setFeatureCountLimit=function(a){};IMcxFeatureExplorer.prototype.onFeatureSelectionChange=function(){};IMcxFeatureExplorer.prototype.setMapInteractionFactory=function(a){};js.framework.ui.McxCommonControl.FeatureExplorer.IMcxFeaturePage={};function IMcxFeaturePage(){}IMcxFeaturePage.prototype.getId=function(){};IMcxFeaturePage.prototype.initialize=function(a){};IMcxFeaturePage.prototype.getTitle=function(){};IMcxFeaturePage.prototype.canOpenFeatures=function(a){};IMcxFeaturePage.prototype.openFeatures=function(a){};IMcxFeaturePage.prototype.isVisible=function(){};IMcxFeaturePage.prototype.setVisible=function(a){};IMcxFeaturePage.prototype.clearPage=function(){};
IMcxFeaturePage.prototype.isInstanceOf=function(a){};IMcxFeaturePage.prototype.getLocalizationPath=function(){};IMcxFeaturePage.prototype.setLocaleFolderPath=function(a){};IMcxFeaturePage.prototype.setMap=function(a){};IMcxFeaturePage.prototype.onFeaturesUpdated=function(){};IMcxFeaturePage.prototype.setMapInteractionFactory=function(a){};js.framework.ui.McxCommonControl.FeatureExplorer.McxFeatureAttributePage={};
function McxFeatureAttributePage(){mcx.base(this);this._onFeaturesUpdated=new McxEventHandler;this.base=this;this.id="featureAttributePage";this._propGridElem=$("<div/>").addClass("mcx-attribute-page-grid");this._rootElement=$("<div/>").css("height","100%").addClass("mcx-attribute-page-root");this.title="McxCommonControl-featureExplorerAttributePageTitle";this.visible=!1;this._localeFolderPathUri="$McxCommonControl/assets/locale/mcxCommonControl";this.memFeature=this.features=null;this._counter=0;
this._lastRequests=[];this._propertyGrid=new McxPropertyGrid;this._toolbarVisiblty=!0}mcx.inherits(McxFeatureAttributePage,McxUserControl);McxFeatureAttributePage.prototype.getId=function(){return this.id};McxFeatureAttributePage.prototype.getTitle=function(){return this.title};
McxFeatureAttributePage.prototype.initialize=function(a){this.base.addChild(this._rootElement,this._propertyGrid);a=this._propertyGrid.getToolBar().createAndAddToolBarItem("Kaydet",null);a.setLocalizationKey("McxCommonControl-featureAttributePageSave");a.getOnClickHandler().addListener(this.saveFeatures,null,this);a=this._propertyGrid.getToolBar().createAndAddToolBarItem("T\u00fcm\u00fcn\u00fc Geri Al",null);a.setLocalizationKey("McxCommonControl-featureAttributePageRevert");a.getOnClickHandler().addListener(this.revertFeatures,
null,this);this.setToolbarVisibility();this._propertyGrid.fit()};
McxFeatureAttributePage.prototype.saveFeatures=function(){var a=this._propertyGrid.getItem(),b=a.getLayer().createEdit(),c=this._propertyGrid.getChangedColumns(),d=new McxAjaxParameter;d.setAsync(!1);for(var e=null,f=0;f<c.length;f++)for(var g=c[f],h=g.getValue(a),k=0;k<this.features.length;k++)e=this.features[k],g.setValue(e,h),e=e.getFeatureID()&&0<e.getFeatureID()?b.update(a,d):b.insert(a,d);a=e.getExceptionMessage();null!=a&&""!=a&&(a=McxLocalizationManager.getLocaleValue("McxCommonDialog-UpdateFeatures"),
McxMessageBox.show("",a,McxMessageBoxType.Error))};McxFeatureAttributePage.prototype.setToolbarVisibility=function(){this._toolbarVisiblty?McxButtonAuthorityHelper.instance.getButtonVisibility(McxButtonAuthorityType.FeatureExplorerSaveAndDeleteButton)||this._propertyGrid.hideToolBar():this._propertyGrid.hideToolBar()};McxFeatureAttributePage.prototype.revertFeatures=function(){this._propertyGrid.revert()};McxFeatureAttributePage.prototype.getContent=function(){return this._rootElement};
McxFeatureAttributePage.prototype.canOpenFeatures=function(a){for(var b=!0,c=0;c<a.length;c++)if(!a[c].isInstanceOf("McxMemFeature")){b=!1;break}return b&&null!=a&&0<a.length};
McxFeatureAttributePage.prototype.openFeatures=function(a){for(var b=0;b<this._lastRequests.length;b++)this._lastRequests[b].abort();this._lastRequests=[];for(var c={},b=0;b<a.length;b++)c[a[b].getLayer().getName()]=a[b].getLayer().getName();if(1==Object.keys(c).length)if(this.features=a,this.bindFeatures(a),1==a.length){this._propertyGrid.setAsBusy();c=new McxAjaxParameter;c.setAsync(!1);if((a=this.features[0].getFeatureID())&&0<a){var b=this.features[0].getLayer(),d=b.getKeyField();this.features[this._counter]=
b.query("",d+"="+a,c).getFeatureReader().toArray()[0]}this.missingFieldComplete()}else if(1<a.length)for(this._propertyGrid.setAsBusy(),c=new McxAjaxParameter,c.setParameters(this,this.getMissingFieldSuccess,this.getMissingFieldFailed),b=0;b<a.length;b++)this._lastRequests[this._lastRequests.length]=this.getMissingField(a[b],c)};
McxFeatureAttributePage.prototype.missingFieldComplete=function(){this._counter++;if(this.features.length==this._counter){var a=this.findSameValueFields(this.features);this._propertyGrid.setItem(a);this._propertyGrid.setAsIdle()}};McxFeatureAttributePage.prototype.getMissingFieldSuccess=function(a){this.features[this._counter]=a.getFeature();this.missingFieldComplete()};McxFeatureAttributePage.prototype.getMissingFieldFailed=function(){this.missingFieldComplete()};
McxFeatureAttributePage.prototype.onSuccess=function(a){a=a.getFeature();this._propertyGrid.setItem(a);this._propertyGrid.setAsIdle()};
McxFeatureAttributePage.prototype.findSameValueFields=function(a){for(var b=[],c=0,d=null,e=0;1>e;e++)for(var f=a[e],d=f.getLayer(),c=d.getSchema().getFieldCount(),g=0;g<c;g++){var h=!0,k=d.getSchema().getField(g);if(""!==f.getValue(g)){for(var m=0;m<a.length;m++){var n=a[m];if(0==h)break;for(var p=0;p<c;p++){var q=n.getLayer().getSchema().getField(p);if(k.getFieldName()==q.getFieldName()&&f.getValue(g)!=n.getValue(p)){h=!1;break}}}1==h&&(h={},h.FieldName=f.getField(g).getFieldName(),h.value=f.getValue(g),
b.push(h))}}a=new McxMemFeature(d,null);for(e=0;e<b.length;e++)h=b[e],a.setValue(h.FieldName,h.value);return a};McxFeatureAttributePage.prototype.isVisible=function(){return this.visible};McxFeatureAttributePage.prototype.setVisible=function(a){this.visible=a};
McxFeatureAttributePage.prototype.bindFeatures=function(a){this._propertyGrid.clear();if(a&&0!=a.length){var b=a[0].getLayer();a=b.getSchema().getFieldCount();for(var c=0;c<a;c++){var d=b.getSchema().getField(c),e=d.getDomainName(),f=d.getFieldName();if(!d.isIgnored()){var g=d.getAlias()||f,h=d.getFieldType(),k=new McxStringColumn(g);this.getIsRelationField(b,f)?(k=b.getDataSource(),e=k.getName(),b.getName().split(":"),k=(new McxFeatureRelationColumn(g)).setParams(k,e,b.getName(),f),k.setCustomTextGetter($.proxy(function(a,
c){var d=this.column.getValue(a),e=this.fieldName;McxFeatureGridHelper.getRelationLabelAsync($.proxy(function(a){c.setText(a)},this),e,d,b.getName(),b.getDataSource());return"Y\u00fckleniyor..."},{column:k,self:this,fieldName:f}))):e?(k=new McxSelectBoxColumn(g),g=new McxAjaxParameter,g.setAsync(!1),g=b.getDataSource().getDomain(d.getDomainName(),g).getDomain(),k.setSelectBoxParams(g?g.getCodedValues():[],"getCode","getValue"),k.setCustomTextGetter(function(a,b){return function(c){c=c.getValue(b);
for(var d=a.getCodedValues(),e=0;e<d.length;e++)if(d[e].getCode()==c)return d[e].getValue()}}(g,f))):h==McxDataType.Boolean?k=(new McxCheckBoxColumn(g)).setValueConverters(this.stringToBoolean,this.booleanToString):h==McxDataType.Byte||h==McxDataType.Decimal||h==McxDataType.Double||h==McxDataType.Float||h==McxDataType.Int16||h==McxDataType.Int32||h==McxDataType.Int64?k=new McxNumberColumn(g):h==McxDataType.DateTime&&(k=(new McxDateColumn(g)).setPickerType(McxDateColumnPickerType.dateAndTime).setFormat("DD/MM/YYYY"));
k.isEditable(d.isEditable()&&!d.isPrimaryKey()&&b.getGeometryField()!=f);k.isRequired(d.isRequired());k.bindProperty("getValue","setValue",[f]);this._propertyGrid.addHorizontalColumn(k)}}}};McxFeatureAttributePage.prototype.clearPage=function(){this.features=[];this._counter=0;this._propertyGrid.clear(!0)};McxFeatureAttributePage.prototype.isInstanceOf=function(a){return"McxFeatureAttributePage"==a};McxFeatureAttributePage.prototype.getLocalizationPath=function(){return this._localeFolderPathUri};
McxFeatureAttributePage.prototype.setLocaleFolderPath=function(a){this._localeFolderPathUri=a};McxFeatureAttributePage.prototype.getMissingField=function(a,b){return!a.getFeatureID()||0>a.getFeatureID()?(0<this.features.length&&this.missingFieldComplete(),new McxSetFieldResult):a.setAllAttributes(b)};
McxFeatureAttributePage.prototype.getIsRelationField=function(a,b){var c=a.getDataSource();c.getName();var d=a.getName().split(":"),d=d[d.length-1],c=c.getRelation(d,b,McxRelationDirection.up);return 0==!(c&&c.getRelation())};McxFeatureAttributePage.prototype.onFeaturesUpdated=function(){return this._onFeaturesUpdated};McxFeatureAttributePage.prototype.groupFormatter=function(a){var b=$("<span>"+a+"</span>");b.attr("data-localize",a);return $("<div/>").append(b).html()};
McxFeatureAttributePage.prototype.setMap=function(a){};McxFeatureAttributePage.prototype.setMapInteractionFactory=function(a){};
McxFeatureAttributePage.prototype.getRelationLabel=function(a,b,c,d,e){c=this.getRelations(a,b,c,d);if(!c||0==c.length)return e;d=[];for(var f=0;f<c.length;f++){var g=c[f],h=g.getDestForeignKey(),k=new McxAjaxParameter;k.setAsync(!1);var m=a.getLayer(b+":"+g.getDestTable(),k);if(!m)return e;var m=m.getLayers()[0],n=h?h+",":"",n=n+g.getDestValueKey(),k=m.query(n,g.getDestPrimaryKey()+"="+e,k).getFeatureReader();if(!k)break;k.read();k=k.getCurrent();if(!k)break;d.push(k.getValue(g.getDestValueKey()));
h&&(e=k.getValue(h));if(!e)break}return d.join(" - ")};McxFeatureAttributePage.prototype.getRelations=function(a,b,c,d){b=c;c=[];for(var e=!0;e;){var f=a.getRelation(b,d,McxRelationDirection.up).getRelation();f?(b=f.getDestTable(),d=f.getDestForeignKey(),c[c.length]=f,d||(e=!1)):e=!1}1<c.length&&(c[c.length-1].setFilterValue(c[0].getFilterValue()),c[0].setFilterValue(null));return c};
McxFeatureAttributePage.prototype.stringToBoolean=function(a){return a?"false"!=a.toString().toLowerCase()&&"true"==a.toString().toLowerCase()?!0:!1:!1};McxFeatureAttributePage.prototype.booleanToString=function(a){return!0===a?"True":0==a?"False":"Null"};McxFeatureAttributePage.prototype.getPropertyGridElement=function(){return this._propertyGrid};McxFeatureAttributePage.prototype.hideToolBar=function(a){this._toolbarVisiblty=!a};McxFeatureAttributePage._isReletionEditModeActive=!0;js.framework.ui.McxCommonControl.FeatureExplorer.McxFeatureExplorer={};
function McxFeatureExplorer(){mcx.base(this);this.base=this;this._rootElement=$("<div/>").css("height","100%").addClass("");this._mainLayout=$("<div/>").css("height","100%").addClass("");this.pages=[];this.contextMenu=this.activePage=null;this.limit=100;this.limitExceeded=!1;this._featureTabs=new McxTabControl;this._multipleCheckProgress=!1;this._onFeatureSelectionChangeHandler=new McxEventHandler;this.mcxtabs=null;this._setAsBusyEventHandler=new McxEventHandler;this._setAsIdleEventHandler=new McxEventHandler;
this._feature=[];this._isTabsInitialized=this._isInitialized=!1;this._lastSelectedFeature=this._defaultActivePage=null;this._featureLength=0;this._basePagesInserted=!1;this._selectedFeatures=[];this._map=null;this._identifySelectBox=new McxSelectBox;this._identifyOption=null;this._removeSelectionFlag=!1;this._featureAddMethod=McxFeatureExplorerAddMethod.newSelection;this._lastSettedFeaturesToPages=new McxDictionary;this._mapInetractionFactory=null}mcx.inherits(McxFeatureExplorer,McxUserControl);
McxFeatureExplorer.prototype.createAddMethodSelectBox=function(){var a=$("#addMethodSelectContainer"),b=new McxSelectBox;b.setIsLocalizable(!0);var c=new McxKeyValuePair("McxCommonControl-addToSelection",McxFeatureExplorerAddMethod.addToSelection),d=new McxKeyValuePair("McxCommonControl-newSelection",McxFeatureExplorerAddMethod.newSelection);b.setTextGetter("getKey");b.setValueGetter("getValue");b.addItemRange([c,d]);b.setSelectedValue(this._featureAddMethod);b.getContent().find("select").css("padding",
"3px 5px");b.css("margin-bottom","5px");b.getOnSelectHandler().addListener(function(){this._featureAddMethod=b.getSelectedItem().getValue()},null,this);this.base.addChild(a,b)};
McxFeatureExplorer.prototype.fillIdentifyCombo=function(){this._identifySelectBox.getOnSelectHandler().removeListener(this.identifyComboChanged);this._identifySelectBox.clear();this._identifySelectBox.setIsLocalizable(!0);this._identifySelectBox.addCustomItem("McxCommonControl-activeLayer",0);this._identifySelectBox.addCustomItem("McxCommonControl-topMostLayer",1);this._identifySelectBox.addCustomItem("McxCommonControl-selectableLayers",2);this._identifySelectBox.addCustomItem("McxCommonControl-visibleLayers",
3);this._identifySelectBox.addCustomItem("McxCommonControl-allLayers",4);this._identifySelectBox.getOnSelectHandler().addListener(this.identifyComboChanged,null,this)};McxFeatureExplorer.prototype.creteIdentifyCombo=function(){this.fillIdentifyCombo();this._identifySelectBox.getContent().find("select").css("padding","3px 5px");this.base.addChild($("#addMethodSelectContainer"),this._identifySelectBox)};
McxFeatureExplorer.prototype.addToolButton=function(a,b,c,d){var e=new McxButton;e.setText(a);d&&e.setLocalizationKey(d);e.setButtonSize(McxButtonSize.small);c&&e.setImage(c.toString());e.setButtonVisualType(McxButtonVisualType.linkButton);e.getClickHandler().addListener(b,null,null);e.setIsFullWidth(!0);this.base.addChild($("#featureListButtonsContainer"),e);1==$("#featureListButtonsContainer").find(".mcx-button").length&&e.getContent().click(function(a){a.stopPropagation()})};
McxFeatureExplorer.prototype.enableContextMenu=function(){$("#featureListContainer").bind("contextmenu",function(a){a=a.clientY||a.pageY||a.screenY;var b=$("#featureListButtonsContainer");b.addClass("state-open");var c=b.height(),d=$("#featureExplorerLeftPanel");a+c>d.offset().top+d.height()?b.offset({top:a-c}):b.offset({top:a})});$(document).bind("click",function(){$("#featureListButtonsContainer").removeClass("state-open")});this._rootElement.bind("click",function(){$("#featureListButtonsContainer").removeClass("state-open")})};
McxFeatureExplorer.prototype.setFeaturesToActivePage=function(a){var b=this.getActivePage();if(b){var c=this._lastSettedFeaturesToPages.getValue(b),d=!0;c&&c.length==a.length&&(d=!a.every(function(a){return a?c.some(function(b){return b.getFeatureID()==a.getFeatureID()}):!1}));d&&(b.clearPage(),b.openFeatures(a),this._lastSettedFeaturesToPages.setValue(b,a),this.applyLocalePath(b))}};
McxFeatureExplorer.prototype.initialize=function(){this.onSetAsBusy();this._rootElement.children().remove();var a=this;this.createBasePages();this._rootElement.append(this._mainLayout);this._mainLayout.append("<div id='featureExplorerLeftPanel' style=\"vertical-align: top; border-right: 1px solid #aaa; box-sizing: border-box; display: inline-block; height: 100%; padding-right: 5px; width: 20%;\" data-options=\"region:'west', border:true, split:true, width:180\"><div id='addMethodSelectContainer' style='padding: 5px; border-bottom:1px solid #333'></div><div id='identifyComboDiv' style='display: none'></div><div id='featureListContainer'></div><div id='featureListButtonsContainer'></div></div><div id='featureExplorerRightPanel' style=\"vertical-align: top; display: inline-block;height: 100%; overflow: auto; position: relative; width: 79%;\" data-options=\"region:'center', border:'true', split:true\"><div id='featureExplorerTabs' style='height: 100%'></div> </div>");
this.enableContextMenu();this.addToolButton("Se\u00e7enekler",function(){$("#featureListButtonsContainer").toggleClass("state-open")});this.createAddMethodSelectBox();this.creteIdentifyCombo();this.mcxtabs=$("#featureExplorerTabs");this.base.addChild(this.mcxtabs,this._featureTabs);this._featureTabs.getTabChangeHandler().addListener(function(){this.activePage=this._featureTabs.getActiveTabPage().getControl();var b=a.getSelectedFeatures();0!=b.length&&(a.setFeaturesToActivePage(b),a.updateLayout())},
null,this);this._isInitialized=!0;this.onSetAsIdle()};McxFeatureExplorer.prototype.missingAttributesSuccess=function(a){a.getFeature();this.onSetAsIdle()};McxFeatureExplorer.prototype.getMissingField=function(a,b){return a.setAllAttributes(b)};McxFeatureExplorer.prototype.identifyComboChanged=function(){this._identifyOption=this._identifySelectBox.getSelectedItem()};McxFeatureExplorer.prototype.getIdentifyOption=function(){return this._identifyOption};
McxFeatureExplorer.prototype.setMap=function(a){this._map=a;for(var b=0;b<this.pages.length;b++)this.pages[b].setMap(a)};
McxFeatureExplorer.prototype.createBasePages=function(){if(1!=this._basePagesInserted){this._basePagesInserted=!0;var a=[],b=new McxFeatureAttributePage;b.setTag("infoPage",!0);a.push(b);var c=new McxFeatureGeometryPage;a.push(c);var d=new McxFeatureInfoPage;d.setTag("infoPage",!0);a.push(d);d=new McxFeatureRelationPage;d.setMaximumSelectionCount(this.limit);d.setMapInteractionFactory(this._mapInetractionFactory);a.push(d);var e=new McxFeatureMediaPage;e.setMapInteractionFactory(this._mapInetractionFactory);
a.push(e);if(this._map)for(var f=0;f<a.length;f++)a[f].setMap(this._map);this.bindPageEvents(b);this.bindPageEvents(c);this.bindPageEvents(d);this.bindPageEvents(e);for(f=0;f<this.pages.length;f++)a.push(this.pages[f]);this.pages=a}};
McxFeatureExplorer.prototype.initPages=function(a){this._featureTabs.addClass("fit");for(var b=0;b<a.length;b++){var c=new McxTabPage;c.setTitle(McxLocalizationManager.getLocaleValue(a[b].getTitle()));c.setTitleLocalizationKey(a[b].getTitle());c.setControl(a[b]);this._featureTabs.addTabPage(c);a[b].setTag("tab",c)}for(b=0;b<a.length;b++)a[b].initialize(this._map)};
McxFeatureExplorer.prototype.setMissingGeometry=function(a){this.onSetAsBusy();var b=new McxAjaxParameter;b.setParameters(this,function(a){a=a.getFeature();var b=new McxMemFeature(a.getLayer(),null);b.createFromFeature(a);this._selectedFeatures[0]=b;this.onSetAsIdle()},null);a[0].isInstanceOf("McxMemFeature")?a[0].setGeometryField(b):(this._selectedFeatures[0]=a[0],this.onSetAsIdle())};
McxFeatureExplorer.prototype.checkBoxChecked=function(a,b){for(var c=0;c<this.pages.length;c++)this.pages[c].clearPage();b.checkCanOpenFeatures(a);b.arrangeActivePage(a,b.activePage)};McxFeatureExplorer.prototype.applyLocalePath=function(a){McxLocalizationManager.applyPath(a.getLocalizationPath())};
McxFeatureExplorer.prototype.bindPageEvents=function(a){a.onFeaturesUpdated().addListener(function(a){a=a.getUpdatedFeatures();for(var c=[],d=0;d<a.length;d++){for(var e=a[d],f=this._feature[e.getFeatureID()],g=f.getFieldCount(),d=0;d<g;d++){var h=f.getFieldName(d),k=f.getValue(h),m=e.getValue(h);m&&(k!=m&&f.setValue(h,m),c[c.length]=f)}this.updateFeatureNodeText(c);this._map.getRenderer().paintLabels()}},null,this)};McxFeatureExplorer.prototype.addPage=function(a){this.pages.push(a);this.bindPageEvents(a)};
McxFeatureExplorer.prototype.removePage=function(a){for(var b=0;b<this.pages.length;b++)if(this.pages[b].getId()==a){this.pages.splice(b,1);break}};McxFeatureExplorer.prototype.getActivePage=function(){return this.activePage||this._defaultActivePage};McxFeatureExplorer.prototype.setActivePage=function(a){this._defaultActivePage=a};McxFeatureExplorer.prototype.arrangeActivePage=function(a,b){b&&(b.canOpenFeatures(a)&&(this.setActivePage(b),this._featureTabs.showTab(b.getTagValue("tab"))),McxLocalizationManager.localizeContent($("#featureExplorerTabs")))};
McxFeatureExplorer.prototype.addFeatures=function(a){if(a){var b=!1;this._featureAddMethod==McxFeatureExplorerAddMethod.newSelection&&this.clear();for(var b=null==Object.keys(this._feature)||0==Object.keys(this._feature).length,c=this._featureLength=0;c<a.length;c++){if(Object.keys(this._feature).length==this.limit){McxMessageBox.show(null,this.base.getLocaleValue("McxCommonControl-maxSelectionCountExceeded")+" ("+this.limit+")",McxMessageBoxType.Error);break}this._featureLength++;this._feature[a[c].getFeatureID().toString()]=
a[c]}this._isInitialized&&this.createFeatureLists();b&&(a=a[0])&&(b=this._featureListByLayer.getValue(a.getLayer()))&&b.selectValue(a.getFeatureID())}};McxFeatureExplorer.prototype.clearFeatureLists=function(){this._featureListByLayer||(this._featureListByLayer=new McxDictionary);var a=this._featureListByLayer.getItems(),b;for(b in a){var c=a[b].getValue().getParent();c&&c.detach()}this._featureListByLayer=new McxDictionary};
McxFeatureExplorer.prototype.createFeatureLists=function(){for(var a in this._feature){var b=this._feature[a],c=b.getLayer(),d=this._featureListByLayer.getValue(c);d||(d=new McxListBox,d.setValueGetter("getKey"),d.setTextGetter("getValue"),d.setMultiSelect(!0),this._featureListByLayer.setValue(c,d));0==d.containsValue(b.getFeatureID())&&d.addItem(new McxKeyValuePair(b.getFeatureID(),this.getLabelForFeature(b)))}b=this._featureListByLayer.getItems();for(a=0;a<b.length;a++){d=b[a];c=d.getKey();d=d.getValue();
d.fitHeightToOptionsLength();var e=d.getParent();e&&mcx.isInstanceOf(e,McxGroupBox)&&e.getParent()||(d.getContent().find("select").removeClass("mcx-input").removeClass("fit"),c=new McxGroupBox(c.getName()),c.addContent(d),e=new McxButton,e.setImage("feature-explorer-tree-collapse"),e.setData("listBox",d),c.addToolButton(e),e.getClickHandler().addListener(function(){var a=this.getData("listBox");a.getContent().is(":visible")?(this.setImage("feature-explorer-tree-expand"),a.hide()):(this.setImage("feature-explorer-tree-collapse"),
a.show())},null,e),d.deselectAll(),this.base.addChild($("#featureListContainer"),c),d.getOnSelectHandler().addListener(this.onFeatureSelect,null,this))}a=this.getSelectedFeatures();this.checkCanOpenFeatures(a);this.getContent().find("option").on("mousedown",this.onOptionMouseDown);this.getContent().find("select").on("scrollback",this.onScrollBack)};
McxFeatureExplorer.prototype.onScrollBack=function(a){$(this).parents().filter(function(){return 0===($(this).data("saveScroll")||~~$(this).data("saveScroll"))}).each(function(a,c){$(c).scrollTop(parseFloat($(c).data("saveScroll")));$(c).removeData("saveScroll")})};
McxFeatureExplorer.prototype.onOptionMouseDown=function(a){a.stopImmediatePropagation();$(this).parents().filter(function(){return $(this)[0].scrollHeight>$(this)[0].clientHeight}).each(function(a,c){$(c).data("saveScroll",$(c).scrollTop())});$(this).parent("select").trigger("focus").trigger("scrollback");$("body").scrollTop(0);a=$("#mapArea").detach();$("body").scrollTop(0);a.prependTo($("#mainContainer"));$("body").scrollTop(0)};
McxFeatureExplorer.prototype.onFeatureSelect=function(a){var b=a.getSelectedItems();a=a.getSelectBox();for(var c=[],d=0;d<b.length;d++){var e=b[d].getKey(),e=this._feature[e];null==e.getGeometry()&&this.setMissingGeometry([e]);c[c.length]=e}b=this._featureListByLayer.getItems();for(d in b)e=b[d].getValue(),e!=a&&(e.getOnSelectHandler().removeListener(this.onFeatureSelect),e.deselectAll(),e.getParent().setCheckBoxState(!1),e.getOnSelectHandler().addListener(this.onFeatureSelect,null,this));this.checkCanOpenFeatures(c);
this._lastSettedFeaturesToPages=new McxDictionary;this.arrangeActivePage(c,this.getActivePage());this.setFeaturesToActivePage(c);this.updateLayout();this.onFeatureSelectionChange().dispatchOnSuccess(this,null)};McxFeatureExplorer.prototype.onFeatureSelectionChange=function(){return this._onFeatureSelectionChangeHandler};
McxFeatureExplorer.prototype.addFeature=function(a){a&&(this._featureAddMethod==McxFeatureExplorerAddMethod.newSelection&&this.clear(),this._feature[a.getFeatureID().toString()]=a,this._isInitialized&&this.createFeatureLists())};McxFeatureExplorer.prototype.getFeatureCount=function(){var a=0,b;for(b in this._feature)a++;return a};
McxFeatureExplorer.prototype.updateFeatureNodeText=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=this._featureListByLayer.getValue(c.getLayer());d&&d.updateTextOfValue(c.getFeatureID(),this.getLabelForFeature(c))}};
McxFeatureExplorer.prototype.selectAllFeatures=function(){var a=this.getSelectedFeatures();if(a&&0<a.length){if(a=a[0].getLayer())a=this._featureListByLayer.getValue(a),a.selectAll()}else 0<this._featureListByLayer.getItems().length&&(a=this._featureListByLayer.getItems()[0].getValue(),a.selectAll())};
McxFeatureExplorer.prototype.deselectAllFeatures=function(){var a=this.getSelectedFeatures();if(a&&0<a.length){if(a=a[0].getLayer())a=this._featureListByLayer.getValue(a),a.deselectAll()}else 0<this._featureListByLayer.getItems().length&&(a=this._featureListByLayer.getItems()[0].getValue(),a.deselectAll())};
McxFeatureExplorer.prototype.getLabelForFeature=function(a){var b=a.getLayer(),c="",c=b.getLabelFormat(),d=!0;if(null==c)return c;for(;1==d;){var e=c.match(/\[(.*?)\]/);if(null==e)d=!1;else{var f="",g=e[1],h=a.getValue(g);if(!h){var k=new McxAjaxParameter;k.setAsync(!1);(k=a.setAttribute(k,g).getFeature())&&(h=k.getValue(g))}if(h)if(g=a.getField(g).getDomainName())if(k=new McxAjaxParameter,k.setAsync(!1),b.getDataSourceName(),g=b.getDataSource().getDomain(g,k).getDomain()){var g=g.getCodedValues(),
m;for(m in g)if(g[m].getCode()==h){f=g[m].getValue();break}else f=h.toString()}else f=h.toString();else f=h.toString();f=f&&"null"!=f?f:"";c=c.replace(e[0],f)}}return c||a.getFeatureID().toString()};
McxFeatureExplorer.prototype.getSelectedFeatures=function(){this._featureListByLayer||(this._featureListByLayer=new McxDictionary);var a=this._featureListByLayer.getItems(),b=[],c;for(c in a)for(var d=a[c].getValue().getSelectedItems(),e=0;e<d.length;e++){var f=this._feature[d[e].getKey()];f&&(b[b.length]=f)}return b};
McxFeatureExplorer.prototype.removeFeature=function(a){var b=this._featureListByLayer.getValue(a.getLayer());b&&b.removeItemByValue(a.getFeatureID());b.fitHeightToOptionsLength();b.isEmpty()&&b.getParent().detach();delete this._feature[a.getFeatureID().toString()];this._lastSettedFeaturesToPages=new McxDictionary};
McxFeatureExplorer.prototype.removeFeatures=function(a){this._removeSelectionFlag=!0;for(var b=0;b<a.length;b++)this.removeFeature(a[b]);this.getActivePage().clearPage();this._removeSelectionFlag=!1;0==Object.keys(this._feature).length&&this.hideFeatureTabs()};
McxFeatureExplorer.prototype.paintUpdatedFeatures=function(a){var b=a[0],c=b.getLayer(),d=this._map.getCoordinateSystem();if(b=b.getGeometry()){for(var b=b.getBounds().transformTo(d),e=1;e<a.length;e++)var f=a[e].getGeometry().getBounds().transformTo(d),b=b.merge(f);this._map.getRenderer().paintLayer(c,b);this._map.getRenderer().paintNonLayer()}else this._map.getRenderer().paintLayer(null,null)};
McxFeatureExplorer.prototype.deleteSelectedFeatures=function(){function a(a){if(a.getResult()==McxMessageBoxResult.Ok){McxLoadingIndicator.setAsBusy(this.getContent());a=McxFeatureHelper.instance.groupByLayer(b);for(var c=Object.keys({}).length,f=0,g=0;g<a.length;g++){var h=mcx.proxy(function(){this.getActivePage().clearPage();0==Object.keys(this._feature).length&&this.hideFeatureTabs();McxLoadingIndicator.setAsIdle(this.getContent());this._lastSettedFeaturesToPages=new McxDictionary},this),k=a[g].getLayer().createEdit(),
m=a[g].getFeatures(),n=new McxAjaxParameter;n.setParameters(this,function(a){a=a.getFeatures();this.removeFeatures(a);0<a.length&&this.paintUpdatedFeatures(a);this._map.getRenderer().paintSelections();f++;f==c&&h()},function(a){McxMessageBox.show(null,a.getExceptionMessage().getException(),McxMessageBoxType.Error);f++;f==c&&h()});k.deleteFeatureRange(m,n)}}}var b=this.getSelectedFeatures();if(0!=b.length){var c=this.base.getLocaleValue("McxCommonControl-confirmDeleteNumberOfFeature"),c=String.format(c,
b.length);McxMessageBox.show("",c,McxMessageBoxType.Confirm,McxDialogButtons.okCancel).getMessageResultHandler().addListener(a,null,this)}};
McxFeatureExplorer.prototype.clear=function(){this._feature=[];Object.keys(this._feature).length=0;if(this._isTabsInitialized)for(var a=0;a<this.pages.length;a++)this.pages[a].clearPage();if(a=this.pages[0])this.setActivePage(a),(a=a.getTagValue("tab"))&&this._featureTabs.showTab(a);this._lastSelectedFeature=null;this._selectedFeatures=[];this.clearFeatureLists();this._lastSettedFeaturesToPages=new McxDictionary};McxFeatureExplorer.prototype.getSetAsBusyEventHandler=function(){return this._setAsBusyEventHandler};
McxFeatureExplorer.prototype.onSetAsBusy=function(){return this._setAsBusyEventHandler.dispatchOnSuccess(this,null)};McxFeatureExplorer.prototype.getSetAsIdleEventHandler=function(){return this._setAsIdleEventHandler};McxFeatureExplorer.prototype.onSetAsIdle=function(){return this._setAsIdleEventHandler.dispatchOnSuccess(this,null)};McxFeatureExplorer.prototype.getFeatures=function(){return this._feature};McxFeatureExplorer.prototype.setFeatures=function(a){this.clear();this.addFeatures(a)};
McxFeatureExplorer.prototype.getFeatureCountLimit=function(){return this.limit};McxFeatureExplorer.prototype.setFeatureCountLimit=function(a){this.limit=a};
McxFeatureExplorer.prototype.checkCanOpenFeatures=function(a){if(null!=a){this._isTabsInitialized||this.initPages(this.pages);this.hideFeatureTabs();for(var b=this._featureTabs.getPages(),c=[],d=0;d<b.length;d++)b[d].getControl().canOpenFeatures(a)&&(this._featureTabs.setTabVisibility(b[d],!0),c.push(b[d]));for(a=0;a<c.length&&null!=this._featureTabs.getActiveTabPage();a++)if(c[a].getControl().getTagValue("infoPage")&&this._featureTabs.getActiveTabPage()!=c[a]){this._featureTabs.setActiveTabPage(c[a]);
this._featureTabs.showTab(c[a]);break}this._isTabsInitialized=!0}};McxFeatureExplorer.prototype.hideFeatureTabs=function(){for(var a=this._featureTabs.getPages(),b=0;b<a.length;b++)a[b].getControl(),this._featureTabs.setTabVisibility(a[b],!1)};McxFeatureExplorer.prototype.clearPages=function(){this.clear();this.pages=[]};McxFeatureExplorer.prototype.getContent=function(){return this._rootElement};McxFeatureExplorer.prototype.setMapInteractionFactory=function(a){this._mapInetractionFactory=a};
McxFeatureExplorer.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};McxFeatureExplorer.prototype.setFeatureAddMethod=function(a){this._featureAddMethod=a};McxFeatureExplorer.prototype.updateLayout=function(){mcx.isInstanceOf(this.activePage,McxUserControl)&&this.activePage.localize();this.getContent().find("div.mcxpanel:visible,div.mcxaccordion:visible,div.mcxlayout:visible,div.mcxtabs-container:visible").trigger("_resize",[!0])};js.framework.ui.McxCommonControl.FeatureExplorer.McxFeatureExplorerAddMethod={};var McxFeatureExplorerAddMethod={addToSelection:0,newSelection:1};js.framework.ui.McxCommonControl.FeatureExplorer.McxFeatureGeometryPage={};
function McxFeatureGeometryPage(){mcx.base(this);this._onFeaturesUpdated=new McxEventHandler;this.base=this;this.id="geometryPage";this.tabsId="geometryTabs";this._geometryTabsElem=$("<div/>").css("height","100%").css("width","100%").addClass("mcx-geometry-tabs-elem");this._rootElement=$("<div/>").css("height","100%").css("position","relative").addClass("mcx-geometry-tabs-root");this._groupContainer=$("<div/>");this._coordinatesTreeElem=$("<ul/>").addClass("mcx-geometry-tabs-coordinate-tree-elem");
this._coordinatesGridElem=$("<table/>").addClass("mcx-geometry-tabs-coordinate-elem");this.coordinatesTreeId="geometryTree";this.coordinatesGridId="geometryGrid";this._geometryLayoutElem=$("<div/>").addClass("mcx-geometry-tabs-geometry-layout-elem");this._infoGrid=new McxPropertyGrid;this.infoGridId="infoGrid";this.visible=!1;this._localeFolderPathUri="$McxCommonControl/assets/locale/mcxCommonControl";this._vertexSymbolizer=this._vertexMarker=this._feature=this._map=null;this._tabControl=new McxTabControl;
this._geometryGrid=new McxDataGrid}mcx.inherits(McxFeatureGeometryPage,McxUserControl);McxFeatureGeometryPage.prototype.getId=function(){return this.id};
McxFeatureGeometryPage.prototype.initialize=function(a){this.base.addChild(this._rootElement,this._tabControl);this._map=a;this._vertexSymbolizer=new McxPolygonSymbolizer;a=new McxFill;a.setColor("transparent");var b=new McxStroke;b.setColor("#323292");b.setWidth(2);this._vertexSymbolizer.setFill(a);this._vertexSymbolizer.setStroke(b);a=new McxPanel;a.fit();a.addElement(this._groupContainer.css({display:"inline-block",width:"30%",height:"100%","padding-right":"15px","box-sizing":"border-box","vertical-align":"top"}).addClass(""));
a.addControl(this._geometryGrid);this._geometryGrid.getContent().css({display:"inline-block",width:"69%",height:"100%","vertical-align":"top"});this._geometryGrid.fitColumns();this._geometryGrid.stretch();this._geometryGrid.addColumn((new McxNumberColumn("Y")).bindField("x").isEditable(!0));this._geometryGrid.addColumn((new McxNumberColumn("X")).bindField("y").isEditable(!0));this._infoGrid.hideToolBar();this._infoGrid.addHorizontalColumn((new McxNumberColumn(this.base.getLocaleValue("McxCommonControl-featureExplorerGeometryPageArea"))).bindField("getGeometryArea"));
this._infoGrid.addHorizontalColumn((new McxNumberColumn(this.base.getLocaleValue("McxCommonControl-featureExplorerGeometryPageLength"))).bindField("getGeometryLenght"));this._infoGrid.addHorizontalColumn((new McxNumberColumn(this.base.getLocaleValue("McxCommonControl-featureExplorerGeometryPageCenter"))).bindField("geometryCenter"));this._infoGrid.addHorizontalColumn((new McxNumberColumn(this.base.getLocaleValue("McxCommonControl-featureExplorerGeometryPageLeftBottom"))).bindField("geometryPageLeftBottom"));
this._infoGrid.addHorizontalColumn((new McxNumberColumn(this.base.getLocaleValue("McxCommonControl-featureExplorerGeometryPageRightUp"))).bindField("geometryPageRightUp"));b=new McxTabPage;b.setTitle(this.base.getLocaleValue("McxApplication-Coordinate"));b.setTitleLocalizationKey("McxApplication-Coordinate");b.setControl(a);this._tabControl.addTabPage(b);a=new McxTabPage;a.setTitle(this.base.getLocaleValue("McxApplication-Information"));a.setTitleLocalizationKey("McxApplication-Information");a.setControl(this._infoGrid);
this._tabControl.addTabPage(a)};
McxFeatureGeometryPage.prototype.updateFeatureGeometry=function(a,b){for(var c=Array(a.length),d=McxFactoryFinder.GeometryFactory(b.getLayer().getCoordinateSystem()),e=0;e<a.length;e++)c[e]=d.createPoint(parseFloat(a[e].y),parseFloat(a[e].x));e=this._feature.getGeometry();e.isInstanceOf(McxGeometryType.Point)?this.updateEdit(c[0],this._feature):e.isInstanceOf(McxGeometryType.LineString)?(d=d.createLineString(c),this.updateEdit(d,this._feature)):e.isInstanceOf(McxGeometryType.Polygon)&&(c=d.createLinearRing(c),
d=d.createPolygon(c,null),this.updateEdit(d,this._feature))};McxFeatureGeometryPage.prototype.updateEdit=function(a,b){var c=b.getLayer().createEdit(),d=new McxMemFeature(b.getLayer(),null);d.setFeatureID(b.getFeatureID());var e=b.getLayer().getGeometryField();d.setValue(e,a);e=new McxAjaxParameter;e.setParameters(this,this.updateFeatureSuccess,this.updateFeatureFail);c.update(d,e)};
McxFeatureGeometryPage.prototype.updateFeatureSuccess=function(a){var b=a.getFeatures();a=this._feature.getLayer().getGeometryField();b=b[0].getValue(a);this._feature.setValue(a,b);this._map.getRenderer().paintLayer(this._feature.getLayer(),this._feature.getGeometry().getBounds());McxMessageBox.show(null,this.base.getLocaleValue("McxCommonControl-updateSuccessfull"))};McxFeatureGeometryPage.prototype.updateFeatureFail=function(a){McxMessageBox.show(null,a.getExceptionMessage().getException(),McxMessageBoxType.Error)};
McxFeatureGeometryPage.prototype.createVertexMarker=function(a,b,c){null!=this._vertexMarker&&c.getMarkerCollection().removeWithGuid(this._vertexMarker.getMarkerId());var d=c.worldToView(a.getY(),a.getX());a=McxFactoryFinder.GeometryFactory(null).createPoint(d.x-5,d.y-5);var e=McxFactoryFinder.GeometryFactory(null).createPoint(d.x+5,d.y-5),f=McxFactoryFinder.GeometryFactory(null).createPoint(d.x-5,d.y+5),d=McxFactoryFinder.GeometryFactory(null).createPoint(d.x+5,d.y+5),e=McxFactoryFinder.GeometryFactory(c.getCoordinateSystem()).createLinearRing([a,
e,d,f,a]);a=[];e=McxFactoryFinder.GeometryFactory(null).createPolygon(e,null).getShell().getPoints();for(f=0;f<e.length;f++)a.push(c.viewToWorld(e[f].x,e[f].y));a=McxFactoryFinder.GeometryFactory(c.getCoordinateSystem()).createLinearRing(a);a.closeRing();a=McxFactoryFinder.GeometryFactory(c.getCoordinateSystem()).createPolygon(a,null);a=new McxPolygonMarker(a,McxGuid.createGuid());a.setSymbolizer(b);this._vertexMarker=a;c.getMarkerCollection().add(this._vertexMarker);c.getRenderer().paintNonLayer()};
McxFeatureGeometryPage.prototype.getTitle=function(){return"McxCommonControl-featureExplorerGeometryPageTitle"};McxFeatureGeometryPage.prototype.getContent=function(){return this._rootElement};McxFeatureGeometryPage.prototype.canOpenFeatures=function(a){for(var b=!0,c=0;c<a.length;c++)if(!a[c].isInstanceOf("McxMemFeature")){b=!1;break}return b&&null!=a&&0<a.length};
McxFeatureGeometryPage.prototype.openFeatures=function(a){var b=this,c=new McxAjaxParameter;c.setParameters(this,function(a){a=a.getFeature();var c=new McxMemFeature(a.getLayer(),null);c.createFromFeature(a);b.clearPage();b._feature=c;b.assignToCoordinatesTree(c.getGeometry());a=b.getInfoGridData(c.getGeometry());b._infoGrid.setItem(a)},null);a[0].setGeometryField(c)};McxFeatureGeometryPage.prototype.isVisible=function(){return this.visible};
McxFeatureGeometryPage.prototype.setVisible=function(a){this.visible=a};
McxFeatureGeometryPage.prototype.getCoordinatesGridRows=function(a){var b=function(a,b){return{index:b,x:a.getY(),y:a.getX()}},c=[];if(a.isInstanceOf(McxGeometryType.Point))c.push(b(a,1));else if(a.isInstanceOf(McxGeometryType.LineString)){a.getPoints();for(var d=0;d<a.getPoints().length;d++){var e=b(a.getPoints()[d],d+1);c.push(e)}}else if(a.isInstanceOf(McxGeometryType.LinearRing))for(a.getPoints(),d=0;d<a.getPoints().length;d++)e=b(a.getPoints()[d],d+1),c.push(e);return c};
McxFeatureGeometryPage.prototype.getInfoGridData=function(a){var b=a.getBounds(),c={},d=0;if(a.isInstanceOf(McxGeometryType.Polygon)&&a.getLenght)d=a.getLength();else if(a.isInstanceOf(McxGeometryType.MultiPolygon)){var e=a.getPolygons(),f;for(f in e)d+=100}else if(a.isInstanceOf(McxGeometryType.LineSegment)||a.isInstanceOf(McxGeometryType.LineString))d=a.getLength();else if(a.isInstanceOf(McxGeometryType.MultiLineString))for(e=a.getLines(),f=0;f<e.length;f++)d+=e[f].getLength();else d=a.isInstanceOf(McxGeometryType.Point)||
a.isInstanceOf(McxGeometryType.MultiPoint)?0:a.getShell().getLength();f=0;a.getArea()&&(f=a.getArea());c.getGeometryArea=f;c.getGeometryLenght=d;c.geometryCenter=b.getCentroid().getX()+", "+b.getCentroid().getY();c.geometryPageLeftBottom=b.getLeft()+", "+b.getBottom();c.geometryPageRightUp=b.getRight()+", "+b.getTop();return c};
McxFeatureGeometryPage.prototype.createGroupForGeometryType=function(a,b){var c=new McxGroupBox(this.base.getLocaleValue(a));c.setLocalizationKeyForTitle(a);var d=new McxListBox;d.setIsLocalizable(!0);d.setValueGetter("getValue");d.setTextGetter("getKey");d.setVisibleItemCount(3);for(var e=0;e<b.length;e++)d.addItem(b[e]);1==b.length?this._geometryGrid.setDataSource(new McxDataGridArrayDataSource(this.getCoordinatesGridRows(b[0].getValue()))):d.getOnSelectHandler().addListener(function(a){a=a.getSelectBox().getValue();
this._geometryGrid.setDataSource(new McxDataGridArrayDataSource(this.getCoordinatesGridRows(a)))},null,this);c.addContent(d);return c};
McxFeatureGeometryPage.prototype.assignToCoordinatesTree=function(a){var b=[];if(a.isInstanceOf(McxGeometryType.Point))b.push(this.createGroupForGeometryType("McxCommonControl-featureExplorerGeometryPagePoint",[new McxKeyValuePair("McxCommonControl-featureExplorerGeometryPagePoint",a)]));else if(a.isInstanceOf(McxGeometryType.LineString))b.push(this.createGroupForGeometryType("McxCommonControl-featureExplorerGeometryPageLine",[new McxKeyValuePair("McxCommonControl-featureExplorerGeometryPageLine",
a)]));else{if(a.isInstanceOf(McxGeometryType.Polygon)){var c=new McxGroupBox(this.base.getLocaleValue("McxCommonControl-featureExplorerGeometryPagePolygon"));c.setLocalizationKeyForTitle("McxCommonControl-featureExplorerGeometryPagePolygon");b.push(c);var d=a.getShell();d&&c.addContent(this.createGroupForGeometryType("McxCommonControl-featureExplorerGeometryPageOuterRing",[new McxKeyValuePair("McxCommonControl-featureExplorerGeometryPageLine",d)]));if(d=a.getHoles()){var e=[];for(a=0;a<d.length-1;a++)e.push(new McxKeyValuePair(a.toString(),
d[a]));c.addContent(this.createGroupForGeometryType("McxCommonControl-featureExplorerGeometryPageInnerRing",e))}}else if(a.isInstanceOf(McxGeometryType.MultiPoint)){c=new McxGroupBox(this.base.getLocaleValue("McxCommonControl-featureExplorerGeometryPageMultiPoint"));c.setLocalizationKeyForTitle("McxCommonControl-featureExplorerGeometryPageMultiPoint");b.push(c);var f=[],d=a.getPoints();for(a=0;a<d.length;a++)f.push(new McxKeyValuePair(a.toString(),d[a]));c.addContent(this.createGroupForGeometryType("McxCommonControl-featureExplorerGeometryPagePoint",
f))}else if(a.isInstanceOf(McxGeometryType.MultiLineString)){c=new McxGroupBox(this.base.getLocaleValue("McxCommonControl-featureExplorerGeometryPageMultiPoint"));c.setLocalizationKeyForTitle("McxCommonControl-featureExplorerGeometryPageMultiPoint");b.push(c);f=[];d=a.getLines();for(a=0;a<d.length;a++)f.push(new McxKeyValuePair(a.toString(),d[a]));c.addContent(this.createGroupForGeometryType("McxCommonControl-featureExplorerGeometryPageLineString",f))}else if(a.isInstanceOf(McxGeometryType.MultiPolygon))for(c=
new McxGroupBox(this.base.getLocaleValue("McxCommonControl-featureExplorerGeometryPagePolygon")),c.setLocalizationKeyForTitle("McxCommonControl-featureExplorerGeometryPagePolygon"),b.push(c),f=a.getPolygons(),a=0;a<f.length;a++)if((d=f[a].getShell())&&c.addContent(this.createGroupForGeometryType("McxCommonControl-featureExplorerGeometryPageOuterRing",[new McxKeyValuePair(0,d)])),(d=f[a].getHoles())&&d.length){e=[];for(a=0;a<d.length-1;a++)e.push(new McxKeyValuePair(a,d[a]));c.addContent(this.createGroupForGeometryType("McxCommonControl-featureExplorerGeometryPageInnerRing",
e))}for(a=0;a<b.length;a++)this.base.addChild(this._groupContainer,b[a])}};McxFeatureGeometryPage.prototype.clearPage=function(){this._geometryGrid.setDataSource(new McxDataGridArrayDataSource([]));this._groupContainer.empty();null!=this._vertexMarker&&this._map.getMarkerCollection().removeWithGuid(this._vertexMarker.getMarkerId())};McxFeatureGeometryPage.prototype.isInstanceOf=function(a){return"McxFeatureGeometryPage"==a};McxFeatureGeometryPage.prototype.getLocalizationPath=function(){return this._localeFolderPathUri};
McxFeatureGeometryPage.prototype.setLocaleFolderPath=function(a){this._localeFolderPathUri=a};McxFeatureGeometryPage.prototype.onFeaturesUpdated=function(){return this._onFeaturesUpdated};McxFeatureGeometryPage.prototype.setMap=function(a){};McxFeatureGeometryPage.prototype.setMapInteractionFactory=function(a){};js.framework.ui.McxCommonControl.FeatureExplorer.McxFeatureInfoPage={};function McxFeatureInfoPage(){mcx.base(this);this.id="featureInfoPage";this._rootElement=$("<div/>").css("height","100%").addClass("mcx-attribute-page-root").css("overflow","hidden");this.title="McxCommonControl-featureExplorerInfoPageTitle";this._localeFolderPathUri="$McxCommonControl/assets/locale/mcxCommonControl";this.visible=!1;this.map=null;this._tabControl=new McxTabControl;this.base=this}
mcx.inherits(McxFeatureInfoPage,McxUserControl);McxFeatureInfoPage.prototype.initialize=function(a){this._rootElement.css("height","100%")};McxFeatureInfoPage.prototype.getTitle=function(){return this.title};McxFeatureInfoPage.prototype.isInstanceOf=function(a){return"McxFeatureInfoPage"==a};McxFeatureInfoPage.prototype.clearPage=function(){};McxFeatureInfoPage.prototype.setMap=function(a){this.map=a};McxFeatureInfoPage.prototype.onFeaturesUpdated=function(){};
McxFeatureInfoPage.prototype.setMapInteractionFactory=function(a){};McxFeatureInfoPage.prototype.setLocaleFolderPath=function(a){this._localeFolderPathUri=a};
McxFeatureInfoPage.prototype.openFeatures=function(a){this._rootElement.html("");for(var b=new McxTabControl,c=0;c<a.length;c++)for(var d=(new McxXmlNode(a[c].getFeatureInfo())).findNodes("FIELDS"),e=0;e<d.length;e++){var f={},g=new McxPropertyGrid,h=$(d[e].toString());$.each(h[0].attributes,function(a,b){g.addHorizontalColumn((new McxNumberColumn(b.name)).bindField(b.name));f[b.name]=b.value});g.setItem(f);g.hideToolBar();h=new McxTabPage;h.setTitle(""+(e+1));h.setControl(g);b.addTabPage(h)}b.setActiveTabPage(b.getPages()[0]);
this.base.addChild(this._rootElement,b)};McxFeatureInfoPage.prototype.getId=function(){return this.id};McxFeatureInfoPage.prototype.canOpenFeatures=function(a){for(var b=!0,c=0;c<a.length;c++)if(!a[c].isInstanceOf("McxInfoFeature")){b=!1;break}return b&&null!=a&&0<a.length};McxFeatureInfoPage.prototype.getContent=function(){return this._rootElement};McxFeatureInfoPage.prototype.setVisible=function(a){this.visible=a};McxFeatureInfoPage.prototype.isVisible=function(){return this.visible};js.framework.ui.McxCommonControl.FeatureExplorer.McxFeatureMediaPage={};function McxFeatureMediaPage(){mcx.base(this);this.base=this;this.id="68e7c728-9f47-4450-a928-3abc2c8d8041";this._rootElement=$("<div/>");this._localeFolderPathUri="$McxCommonControl/assets/locale/mcxCommonControl";this.visible=!0;this._mediaContainer=this._featureRelationViewer=this._factory=this._map=null}mcx.inherits(McxFeatureMediaPage,McxUserControl);McxFeatureMediaPage.prototype.getId=function(){return this.id};
McxFeatureMediaPage.prototype.initialize=function(a){this._rootElement.css("height","100%")};McxFeatureMediaPage.prototype.getTitle=function(){return"McxCommonControl-featureExplorerMediaPageTitle"};McxFeatureMediaPage.prototype.getContent=function(){return this._rootElement};McxFeatureMediaPage.prototype.canOpenFeatures=function(a){for(var b=!0,c=0;c<a.length;c++)if(!a[c].isInstanceOf("McxMemFeature")){b=!1;break}return b&&null!=a&&0<a.length};
McxFeatureMediaPage.prototype.openFeatures=function(a){this._rootElement.html("");this._mediaContainer=new McxMediaContainer(a[0],this._rootElement);this._mediaContainer.localize()};McxFeatureMediaPage.prototype.isVisible=function(){return this.visible};McxFeatureMediaPage.prototype.setVisible=function(a){this.visible=a};McxFeatureMediaPage.prototype.clearPage=function(){this._rootElement.empty()};McxFeatureMediaPage.prototype.isInstanceOf=function(a){return"McxFeatureMediaPage"==a};
McxFeatureMediaPage.prototype.getLocalizationPath=function(){return this.base._localeFolderPathUri};McxFeatureMediaPage.prototype.setLocaleFolderPath=function(a){this.base._localeFolderPathUri=a};McxFeatureMediaPage.prototype.onFeaturesUpdated=function(){return new McxEventHandler};McxFeatureMediaPage.prototype.setMap=function(a){};McxFeatureMediaPage.prototype.setMapInteractionFactory=function(a){this._factory=a};js.framework.ui.McxCommonControl.FeatureExplorer.McxFeatureRelationPage={};function McxFeatureRelationPage(){mcx.base(this);this.base=this;this.id="featureRelationPage";this._rootElement=$('<div id="relationContent"/>');this._localeFolderPathUri="$McxCommonControl/assets/locale/mcxCommonControl";this.visible=!0;this._factory=this._map=null;this._maxCount=400;this._featureRelationViewer=null}mcx.inherits(McxFeatureRelationPage,McxUserControl);McxFeatureRelationPage.prototype.getId=function(){return this.id};
McxFeatureRelationPage.prototype.initialize=function(a){this._rootElement.css("height","100%")};McxFeatureRelationPage.prototype.getTitle=function(){return"McxCommonControl-featureExplorerRelationPageTitle"};McxFeatureRelationPage.prototype.getContent=function(){return this._rootElement};McxFeatureRelationPage.prototype.canOpenFeatures=function(a){for(var b=!0,c=0;c<a.length;c++)if(!a[c].isInstanceOf("McxMemFeature")){b=!1;break}return b&&null!=a&&0<a.length};
McxFeatureRelationPage.prototype.openFeatures=function(a){this.clearPage();this._featureRelationViewer=new McxFeatureRelationViewer(this._factory);this._featureRelationViewer.setMaximumSelectionCount(this._maxCount);this._featureRelationViewer.setFeature(a[0]);this._map&&this._featureRelationViewer.setMap(this._map);this._rootElement.append(this._featureRelationViewer.getContent())};McxFeatureRelationPage.prototype.isVisible=function(){return this.visible};
McxFeatureRelationPage.prototype.setVisible=function(a){this.visible=a};McxFeatureRelationPage.prototype.clearPage=function(){this._rootElement.empty()};McxFeatureRelationPage.prototype.isInstanceOf=function(a){return"McxFeatureRelationPage"==a};McxFeatureRelationPage.prototype.getLocalizationPath=function(){return this._localeFolderPathUri};McxFeatureRelationPage.prototype.setLocaleFolderPath=function(a){this._localeFolderPathUri=a};McxFeatureRelationPage.prototype.onFeaturesUpdated=function(){return new McxEventHandler};
McxFeatureRelationPage.prototype.setMap=function(a){this._map=a;this._featureRelationViewer&&this._featureRelationViewer.setMap(a)};McxFeatureRelationPage.prototype.setMaximumSelectionCount=function(a){this._maxCount=a};McxFeatureRelationPage.prototype.setMapInteractionFactory=function(a){this._factory=a};js.framework.ui.McxCommonControl.FeatureExplorer.McxFeatureUpdateEventArgs={};function McxFeatureUpdateEventArgs(a){mcx.base(this);this._updatedFeatures=a}mcx.inherits(McxFeatureUpdateEventArgs,McxEventArgs);McxFeatureUpdateEventArgs.prototype.getUpdatedFeatures=function(){return this._updatedFeatures};js.framework.ui.McxCommonControl.FeatureGrid={};js.framework.ui.McxCommonControl.FeatureGrid.McxDataGridFeatureDataSource={};function McxDataGridFeatureDataSource(a,b){mcx.base(this);this._sourceLayer=a;this._layer=null;this._filterBuilder=new McxDataGridFilterBuilder;this._isCopyLayer=b||!1;this.base=this;this._orderColumn=this._queryAjax=null;this._orderType=McxDataGridColumnOrder.None;this._filterGuid=McxGuid.createGuid();this.initialize()}mcx.inherits(McxDataGridFeatureDataSource,McxDataGridAbstractDataSource);
McxDataGridFeatureDataSource.prototype.initialize=function(){if(this._isCopyLayer){var a=this._sourceLayer.getDataSource(),b=new McxAjaxParameter;b.setAsync(!1);(a=a.getLayer(this._sourceLayer.getName(),b,!0))&&a.getLayers()&&a.getLayers().length&&(b=this._sourceLayer.getFilterCollection(),this._layer=a.getLayers()[0],this._layer.setFilterCollection(b))}else this._layer=this._sourceLayer};
McxDataGridFeatureDataSource.prototype.getData=function(a,b){McxDataGridFeatureDataSource.superClass_.getData.call(this,a,b);this.base.onGetDataStart();var c=new McxAjaxParameter;c.setParameters(this,function(a){if(a=a.getFeatureReader())this.base.onGetDataComplete(a.toArray())},function(){this.base.onGetDataComplete([])});c.setRange(a+1,b);for(var d=[],e=this._layer.getSchema().getFieldCount(),f=0;f<e;f++)d.push(this._layer.getSchema().getField(f).getFieldName());e="";""==e&&(e="1=1");this._orderColumn&&
this._orderType!=McxDataGridColumnOrder.None&&(e+=" ORDER BY "+this._orderColumn.getBinding().getParams()[0]+(this._orderType==McxDataGridColumnOrder.ASC?" ASC":" DESC"));this._queryAjax=this._layer.query(d.join(","),e,c)};McxDataGridFeatureDataSource.prototype.abortRequest=function(){this._queryAjax.abort()};McxDataGridFeatureDataSource.prototype.getTotalCount=function(){var a=new McxAjaxParameter;a.setAsync(!1);return this._layer.getFeatureCount(a).getFeatureCount()};
McxDataGridFeatureDataSource.prototype.search=function(a){for(var b=a.getLayer().getSchema().getFieldCount(),c="",d=0;d<b;d++){var e=a.getLayer().getSchema().getField(d),f=a.getValue(e.getFieldName());f&&(c+=(c?" AND ":"")+e.getFieldName()+" = "+f)}a=new McxAjaxParameter;a.setParameters(this,this.onSearchSuccess,this.onSearchFail);a.setRange(0,this.base._lastOffset);c?this._layer.query("",c,a):this._layer.query("","1=1",a)};
McxDataGridFeatureDataSource.prototype.onSearchSuccess=function(a){a=a.getFeatureReader();if(!a)this.base.onSearchDataComplete([]);this.base.onSearchDataComplete(a.toArray())};McxDataGridFeatureDataSource.prototype.onSearchFail=function(a){this.base.onSearchDataComplete([])};
McxDataGridFeatureDataSource.prototype.setFilter=function(a){for(var b=a.getFilters(),c="",d={},e=0;e<b.length;e++){var f=b[e],g=f.getColumn().getBinding().getParams()[0],h="{0} = "+f.getValue();mcx.isInstanceOf(f.getColumn(),McxStringColumn)&&(h="{0} = '"+f.getValue()+"'");mcx.isInstanceOf(f.getColumn(),McxDateColumn)&&(f=f.getValue(),h="{0} >= '"+f.toString("DD/MM/YYYY")+"' AND {0} <= '"+f.addDays(1).toString("DD/MM/YYYY")+"'");d[g]=d[g]||[];d[g].push(h)}for(var k in d){b=d[k];g=[];for(e in b)g.push(" "+
String.format(b[e],k));c+=(c?" AND ":"")+" ( "+g.join(" OR ")+" ) "}this._layer.getFilterCollection().removeWithGuid(this._filterGuid);f=new McxFilter;f.setFilterId(this._filterGuid);f.setAttributeFilter(c);this._layer.getFilterCollection().add(f);this._filterBuilder=a;this.getData(0,this._lastLimit||20)};McxDataGridFeatureDataSource.prototype.getFilter=function(){return this._filterBuilder};
McxDataGridFeatureDataSource.prototype.orderBy=function(a,b){if(this._orderColumn!=a||this._orderType!=b)this._orderColumn=a,this._orderType=b,this.getData(0,this.base._lastLimit)};js.framework.ui.McxCommonControl.FeatureGrid.McxFeatureGridHelper={};function McxFeatureGridHelper(){}
McxFeatureGridHelper.getRelationLabelAsync=function(a,b,c,d,e){function f(){a.call(this,"Se\u00e7iniz...")}var g=new McxAjaxParameter;g.setParameters({self:this,callback:a,selectedValue:c,dataSource:e},function(a){var b=this.dataSource,c=this.selectedValue;a=a.getRelations()[0];var d=new McxAjaxParameter;d.setParameters($.extend(this,{foreignValue:c,relation:a}),function(a){var b=a.getLayers();if(b&&0!=b.length){a=this.relation;var c=this.foreignValue,b=b[0],d=new McxAjaxParameter;d.setParameters(this,
function(a){var b=a.getFeatureReader();if(b&&0!=b.count()){a=this.self;var c=this.callback,d=this.relation,b=b.toArray()[0];c.call(a,b.getValue(d.getDestValueKey()))}},f);var e="",e=b.getSchema().getField(a.getDestPrimaryKey()).getFieldType()==McxDataType.Guid?a.getDestPrimaryKey()+" = '"+c.replace(/-/g,"").toUpperCase()+"'":a.getDestPrimaryKey()+" = "+c;b.query(a.getDestValueKey(),e,d)}},f);b.getLayer(a.getDestTable(),d)},f);e.getRelation(d,b,McxRelationDirection.up,g)};js.framework.ui.McxCommonControl.FeatureGridWrapper={};js.framework.ui.McxCommonControl.FeatureGridWrapper.McxFeatureGridWrapper={};
function McxFeatureGridWrapper(a,b,c,d,e){mcx.base(this);this.base=this;this._interval=0;this._layer=b;this._map=a;this._featureGrid=new McxFeatureGrid(this._layer,e);this._featureGridEditEnabled=!0;this._gridCount=d||20;this._mapInteractionFactory=c;this._rootElement=$("<div/>").css("height","100%").addClass("");this._dataGridSize=200;this._multiSelectEnabled=!1;this._showFieldNamesArray=[];this._addButtonClickedEventHandler=new McxEventHandler;this._beforeGridInitializeHandler=new McxEventHandler}
mcx.inherits(McxFeatureGridWrapper,McxUserControl);
McxFeatureGridWrapper.prototype.initialize=function(){this._featureGrid.showFieldNames(this._showFieldNamesArray);this._featureGrid.setDataGridSize(this._dataGridSize);this._featureGrid.setGridCount(this._gridCount);this._featureGrid.enableMultiSelection(this._multiSelectEnabled);this._featureGrid.setEditable(this._featureGridEditEnabled);this.getBeforeGridInitializeHandler().dispatchOnSuccess(this,null);this._featureGrid.initialize();this.base.addChild(this._rootElement,this._featureGrid)};
McxFeatureGridWrapper.prototype.getFeatureGrid=function(){return this._featureGrid};McxFeatureGridWrapper.prototype.getBeforeGridInitializeHandler=function(){return this._beforeGridInitializeHandler};McxFeatureGridWrapper.prototype.setMapInteractionFactory=function(a){this._mapInteractionFactory=a};McxFeatureGridWrapper.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};
McxFeatureGridWrapper.prototype.blinkSelectedFeature=function(){var a=this._featureGrid.getSelectedFeature();mcx.isDefAndNotNull(a&&a.getGeometry())&&(a=this._mapInteractionFactory.createBlinkAction([a],6E3),this._map.getInputHandler().execute(a))};McxFeatureGridWrapper.prototype.zoomSelectedFeature=function(){var a=this._featureGrid.getSelectedFeature();mcx.isDefAndNotNull(a&&a.getGeometry())&&(a=this._mapInteractionFactory.createZoomFeatureAction([a],.5),this._map.getInputHandler().execute(a))};
McxFeatureGridWrapper.prototype.insertFeature=function(){var a=this._featureGrid.insertFeature();this._addButtonClickedEventHandler.dispatchOnSuccess(this,new McxEventArgs(a))};McxFeatureGridWrapper.prototype.getAddButtonClickHandler=function(){return this._addButtonClickedEventHandler};
McxFeatureGridWrapper.prototype.deleteSelectedFeature=function(){var a=McxLocalizationManager.getLocaleValue("McxCommonControl-featureGridDeleteConfirmationMessageLabel");McxMessageBox.show("",a,McxMessageBoxType.Confirm,McxDialogButtons.okCancel).getMessageResultHandler().addListener(function(a){a.getResult()==McxMessageBoxResult.Ok&&this._featureGrid.deleteFeature()},null,this)};
McxFeatureGridWrapper.prototype.setToolbar=function(a,b,c,d,e){c=McxLocalizationManager.getLocaleValue("McxCommonControl-featureGridZoomLabel");var f=McxLocalizationManager.getLocaleValue("McxCommonControl-featureGridBlinkLabel"),g=McxLocalizationManager.getLocaleValue("McxCommonControl-featureGridDeleteLabel"),h=McxLocalizationManager.getLocaleValue("McxCommonControl-featureGridInsertLabel"),k=new McxCommonToolBar;a&&this._layer.getGeometryField()&&k.createAndAddToolBarItem(c,"mcxfeaturegrid-zoom").getOnClickHandler().addListener(this.zoomSelectedFeature,
null,this);b&&this._layer.getGeometryField()&&k.createAndAddToolBarItem(f,"mcxfeaturegrid-blink").getOnClickHandler().addListener(this.blinkSelectedFeature,null,this);d&&k.createAndAddToolBarItem(g,"mcxfeaturegrid-delete").getOnClickHandler().addListener(this.deleteSelectedFeature,null,this);e&&k.createAndAddToolBarItem(h,"mcxfeaturegrid-insert").getOnClickHandler().addListener(this.insertFeature,null,this);this.base.addChild(this._rootElement,k)};
McxFeatureGridWrapper.prototype.setMap=function(a){this._map=a};McxFeatureGridWrapper.prototype.getMap=function(){return this._map};McxFeatureGridWrapper.prototype.setLayer=function(a){this._layer=a};McxFeatureGridWrapper.prototype.getLayer=function(){return this._layer};McxFeatureGridWrapper.prototype.getContent=function(){return this._rootElement};McxFeatureGridWrapper.prototype.getSelectedFeatureEventHandler=function(){return this._featureGrid.getSelectedFeatureEventHandler()};
McxFeatureGridWrapper.prototype.setEditable=function(a){this._featureGridEditEnabled=a};McxFeatureGridWrapper.prototype.getSelectedFeature=function(){return this._featureGrid.getSelectedFeature()};McxFeatureGridWrapper.prototype.getSelectedFeatures=function(){return this._featureGrid.getSelectedFeatures()};McxFeatureGridWrapper.prototype.setDataGridSize=function(a){this._dataGridSize=a;this._featureGrid.setDataGridSize(a)};
McxFeatureGridWrapper.prototype.showFieldNames=function(a){this._showFieldNamesArray=a};McxFeatureGridWrapper.prototype.enableMultiSelection=function(a){this._multiSelectEnabled=a};McxFeatureGridWrapper.prototype.addImageButtonColumn=function(a,b){return this._featureGrid.addImageButtonColumn(a,b)};McxFeatureGridWrapper.prototype.setAlias=function(a,b){this._featureGrid.setAlias(a,b)};McxFeatureGridWrapper.prototype.stretch=function(){this._featureGrid.stretch()};
McxFeatureGridWrapper.prototype.fitColumns=function(){this._featureGrid.fitColumns()};McxFeatureGridWrapper.prototype.setRefreshInterval=function(a){a&&(this._interval||clearInterval(this._interval),this._interval=setInterval($.proxy(function(){this._featureGrid.getDataGrid().loadMore()},this),a))};js.framework.ui.McxCommonControl.FeatureRelationViewer={};js.framework.ui.McxCommonControl.FeatureRelationViewer.McxFeatureRelationViewer={};
function McxFeatureRelationViewer(a){mcx.base(this);this.base=this;this._datasource=this._tabControl=this._feature=this._rootElement=null;this._datasourceName="";this._relations=[];this._dataGridArray=[];this._map=null;this._mapInteractionFactory=a;this._maxCount=400;this._relationEventHandler=new McxEventHandler;this._mcxFeatureGridWrapper=null;this.init()}mcx.inherits(McxFeatureRelationViewer,McxUserControl);
McxFeatureRelationViewer.prototype.init=function(){this._rootElement=$("<div/>").css("height","100%").css("position","relative").addClass("");this._tabControl=new McxTabControl;this._tabControl.getTabChangeHandler().removeListener(this.onTabChanged);this._tabControl.getTabChangeHandler().addListener(this.onTabChanged,null,this);this.base.addChild(this._rootElement,this._tabControl)};
McxFeatureRelationViewer.prototype.initializeComponents=function(){null==this._datasource&&(this._datasource=this._feature.getLayer().getDataSource(),this._datasourceName=this._datasource.getName());var a=this._feature.getLayer().getName(),b=new McxAjaxParameter;b.setAsync(!1);this._relations=this._datasource.getRelations(a,McxRelationDirection.down,b).getRelations();for(a=0;a<this._relations.length;a++)this.createTabPage(this._relations[a])};McxFeatureRelationViewer.prototype.failed=function(){};
McxFeatureRelationViewer.prototype.setFeature=function(a){this._feature=a;null!=this._feature&&this.initializeComponents()};
McxFeatureRelationViewer.prototype.createTabPage=function(a){var b=new McxLazyTabPage;b.setTitle(a.getOriginTable());b.setTitleLocalizationKey(a.getOriginTable());var c=this;b.setControlInitializer(function(a){var b=new McxLayoutRow,f=new McxAjaxParameter;f.setParameters(this,function(f){var h=a.getOriginForeignKey()+" = "+c._feature.getValue(a.getDestPrimaryKey()),k=new McxFilter;k.setAttributeFilter(h);f=f.getLayers()[0];f.getFilterCollection().addFilter(k);k=this.createDataGrid(f,a);b.createAndAddSpan(12,
k);this.base.updateLayout()},this.failed);this._datasource.getLayer(this._datasourceName+":"+a.getOriginTable(),f);return b},this,a);0==this._tabControl.getPages().length?this._tabControl.showTab(b):this._tabControl.addTabPage(b)};
McxFeatureRelationViewer.prototype.onDataGridRowSelected=function(a){var b=this.scope,c=this.relation,d=a.getRow().getItem(),e=b._datasource.getRelation(c.getOriginTable(),c.getOriginForeignKey(),McxRelationDirection.down).getRelation();null!=e&&(a=new McxAjaxParameter,a.setParameters(b,function(a){var c=b.getInnerChildrenOfType(McxLayoutSpan),h;for(h in c)c[h].getTagValue("relation")&&c[h].getTagValue("relation").getRelationName()==e.getRelationName()&&c[h].remove();a=a.getLayers()[0];c=e.getOriginForeignKey()+
" = "+d.getValue(e.getDestPrimaryKey());h=new McxFilter;h.setAttributeFilter(c);a.getFilterCollection().addFilter(h);a=b.createDataGrid(a,e);c=new McxLayoutSpan(12);c.setTag("relation",e);c.addContent(a);c.getContent().css("margin-left","0");b._tabControl.getActiveTabPage().getControl().addSpan(c)},b.failed),b._datasource.getLayer(e.getOriginTable(),a))};McxFeatureRelationViewer.prototype.setMaximumSelectionCount=function(a){this._maxCount=a};McxFeatureRelationViewer.prototype.getContent=function(){return this._rootElement};
McxFeatureRelationViewer.prototype.createDataGrid=function(a,b){this._mcxFeatureGridWrapper=new McxFeatureGridWrapper(this._map,a,this._mapInteractionFactory);this._mcxFeatureGridWrapper.setDataGridSize(150);this._mcxFeatureGridWrapper.setToolbar(!0,!0,!0,!0,!0);this._mcxFeatureGridWrapper.initialize();this._mcxFeatureGridWrapper.getSelectedFeatureEventHandler().removeListener(this.onDataGridRowSelected);this._mcxFeatureGridWrapper.getSelectedFeatureEventHandler().addListener(this.onDataGridRowSelected,
null,{scope:this,relation:b});var c=new McxGroupBox(b.getRelationName());c.addContent(this._mcxFeatureGridWrapper.getContent());c.localize();return c};McxFeatureRelationViewer.prototype.onTabChanged=function(){for(var a=0;a<this._relations.length;a++)this._relations[a].getOriginTable()==this._tabControl.getActiveTabPage().getTitle()&&(this._activeRelation=this._relations[a])};McxFeatureRelationViewer.prototype.setMap=function(a){this._map=a;this._mcxFeatureGridWrapper&&this._mcxFeatureGridWrapper.setMap(a)};
McxFeatureRelationViewer.prototype.createColumns=function(a,b){for(var c=0;c<a.length;c++){var d=a[c];b.addColumn((new McxStringColumn(d)).bindField(d).isEditable(!0))}return b};McxFeatureRelationViewer.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};js.framework.ui.McxCommonControl.FieldRelationEditor={};js.framework.ui.McxCommonControl.FieldRelationEditor.McxFieldRelationEditor={};
function McxFieldRelationEditor(){mcx.base(this);this._rootElement=$("<div/>").addClass("mcx-field-relation-editor");this._dataSource=null;this._counter=0;this._selectedValue=this._fieldName=this._layerName=this._dataSourceName="";this._selectBoxList=[];this._valueSetModeCounter=0;this._showLabels=!0;this.base=this;this._labelCallbacks=[];this._beforeSearchLayerHandler=new McxEventHandler}mcx.inherits(McxFieldRelationEditor,McxValidatableControl);
McxFieldRelationEditor.prototype.setParameters=function(a,b,c,d,e,f){this._dataSource=a;this._dataSourceName=b;this._layerName=c;this._fieldName=d;this._selectedValue=e?e.toString():"";this._showLabels=!f;this.generateSelectBoxes()};
McxFieldRelationEditor.prototype.getRelations=function(a){a=this._layerName;for(var b=this._fieldName,c=[],d=!0;d;){var e=this._dataSource.getRelation(a,b,McxRelationDirection.up).getRelation();e?(a=e.getDestTable(),b=e.getDestForeignKey(),c[c.length]=e,b||(d=!1)):d=!1}1<c.length&&(c[c.length-1].setFilterValue(c[0].getFilterValue()),c[0].setFilterValue(null));return c};
McxFieldRelationEditor.prototype.checkForValueSetMode=function(){0<this._valueSetModeCounter&&(this._valueSetModeCounter--,0==this._valueSetModeCounter&&McxLoadingIndicator.setAsIdle(this._rootElement))};McxFieldRelationEditor.prototype.increaseValueSetCounter=function(){0==this._valueSetModeCounter&&McxLoadingIndicator.setAsBusy(this._rootElement);this._valueSetModeCounter++};
McxFieldRelationEditor.prototype.fillSelectBox=function(a,b,c,d,e){var f=new McxAjaxParameter;this.increaseValueSetCounter();f.setParameters({self:this,targetSelectBox:a,targetRelation:b,callback:c,foreignValue:d,selectedValue:e},function(a){var b=this.self,c=this.targetSelectBox,d=this.targetRelation,e=this.foreignValue,f=new McxAjaxParameter;f.setParameters(this,function(a){var b=this.self,c=this.targetSelectBox,d=this.targetRelation,e=this.callback;for(a=a.getFeatureReader();a.read();){var f=a.getCurrent().getValue(d.getDestPrimaryKey()),
g=a.getCurrent().getValue(d.getDestValueKey());c.addItem(new McxKeyValuePair(f,g))}c.clearSelection();e&&e.apply(this);b.checkForValueSetMode()},null);a=a.getLayers()[0];var q=d.getDestPrimaryKey()+","+d.getDestValueKey(),r="";d.getFilterValue()?r+=d.getDestPrimaryKey()+"="+d.getFilterValue().toString():e&&0<b._selectBoxList.indexOf(c)&&(r+=d.getDestForeignKey()+"="+e.toString());c=new McxFieldRelationEditorLayerFilterArgs(a.getName());b.getBeforeSearchLayerHandler().dispatchOnSuccess(b,c);b=c.getAttributeFilter();
r&&b?r+=" AND "+b:b&&(r=b);a.query(q,r,f)},null);this._dataSource.getLayer(this._dataSourceName+":"+b.getDestTable(),f);a.setTag("layerName",b.getDestTable())};McxFieldRelationEditor.prototype.getBeforeSearchLayerHandler=function(){return this._beforeSearchLayerHandler};
McxFieldRelationEditor.prototype.generateSelectBoxes=function(){var a=this.getRelations();if(a&&0!=a.length){a.reverse();for(var b=0;b<a.length;b++){var c=a[b],d=new McxSelectBox;this._selectBoxList[b]=d;if(this._showLabels){var e=new McxLabeledEditor(c.getDestLabel(),d);this._selectBoxList[b]=d;this.base.addChild(this._rootElement,e)}else this.base.addChild(this._rootElement,d);var f=!1;0!=b||this._selectedValue?0<b&&(e=this._selectBoxList[b-1],e.getOnSelectHandler().addListener(function(){var a=
this.self;if(!(0<a._valueSetModeCounter||f)){var b=this.targetSelectBox,c=this.targetRelation,d=this.prevSelectBox;f=!0;for(var e=a._selectBoxList.indexOf(b);e<a._selectBoxList.length;e++)a._selectBoxList[e].clear();d=d.getSelectedValue();a.fillSelectBox(b,c,function(){f=!1},d?d.toString():"")}},null,{self:this,targetSelectBox:d,targetRelation:c,prevSelectBox:e})):this.fillSelectBox(d,c)}var g=this._selectBoxList[0];g.getChangeEventHandler().addListener(function(){var a=this._selectBoxList[this._selectBoxList.length-
1];if(1==this._valueSetModeCounter&&a.getValue()&&g.getValue())for(var b in this._labelCallbacks)this._labelCallbacks[b].call(this,this.getDetailedLabel())},null,this);this._selectedValue&&this.updateSelectBoxesWithSelectedValue()}};McxFieldRelationEditor.prototype.getValue=function(){var a=this._selectBoxList[this._selectBoxList.length-1];return((a=a&&a.getSelectedValue())?a.toString():"")||this._selectedValue};McxFieldRelationEditor.prototype.getLabel=function(){return this._selectedValue};
McxFieldRelationEditor.prototype.getFieldName=function(){return this._fieldName};McxFieldRelationEditor.prototype.getDetailedLabel=function(){for(var a="",b=0;b<this._selectBoxList.length;b++)a=this._selectBoxList[b].getText()+" / ";return a.substring(0,a.length-2)};McxFieldRelationEditor.prototype.setValue=function(a){(this._selectedValue=a&&a.toString())&&this.updateSelectBoxesWithSelectedValue()};
McxFieldRelationEditor.prototype.extractForeignValue=function(a,b){if(!a.getDestForeignKey())return"";var c=new McxAjaxParameter;c.setAsync(!1);var d=this._dataSource.getLayer(a.getDestTable(),c);if(!d||!d.getLayers())return"";d=d.getLayers()[0];if(!d)return"";var c=d.query(a.getDestForeignKey(),a.getDestPrimaryKey()+"="+b,c).getFeatureReader(),e;if(!c||!c.read())return"";(c=c.getCurrent())&&(e=c.getValue(a.getDestForeignKey()));return e?e.toString():""};
McxFieldRelationEditor.prototype.extractForeignValueAsync=function(a,b,c){if(a.getDestForeignKey()){var d=new McxAjaxParameter;d.setParameters({relation:a,selectedValue:b,callback:c},function(a){if(a&&a.getLayers()&&(a=a.getLayers()[0])){var b=this.relation,c=this.selectedValue,d=this.callback,k=new McxAjaxParameter;k.setParameters({relation:b,selectedValue:c,callback:d,layer:a},function(a){var b=this.relation,c=this.callback;a=a.getFeatureReader();var d;if(!a||!a.read())return"";(a=a.getCurrent())&&
(d=a.getValue(b.getDestForeignKey()));c.call(this,d?d.toString():"")},null);a.query(b.getDestForeignKey(),b.getDestPrimaryKey()+"="+c,k)}},null);this._dataSource.getLayer(a.getDestTable(),d)}else c.call(this,"")};
McxFieldRelationEditor.prototype.updateSelectBoxesWithSelectedValue=function(){function a(b){this.self.fillSelectBox(this.selectBox,this.relations[e],$.proxy(function(){var c=this.self,d=this.relations,f=this.selectBox,n=this.selectedValue;f.setValue(n);n=b;e++;e!=d.length&&(f=c._selectBoxList[c._selectBoxList.length-e-1],c.extractForeignValueAsync(d[e],n,$.proxy(a,{self:c,selectBox:f,relations:d,selectedValue:n})))},this),b,c)}for(var b=this.getRelations(),c=this._selectedValue,d=this._valueSetModeCounter=
0;d<this._selectBoxList.length;d++)this._selectBoxList[d].clear();var e=0,d=b[e],f=this._selectBoxList[this._selectBoxList.length-e-1];McxLoadingIndicator.setAsBusy(this._rootElement);this.extractForeignValueAsync(d,c,$.proxy(a,{self:this,selectBox:f,relations:b,selectedValue:c}))};
McxFieldRelationEditor.prototype.getSelectedValue=function(a){if(a)for(var b=0;b<this._selectBoxList.length;b++){var c=this._selectBoxList[b];if(c.getTagValue("layerName")==a)return((a=c&&c.getSelectedValue())?a.toString():"")||this._selectedValue}else return this.getValue()};McxFieldRelationEditor.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.FieldRelationEditor.McxFieldRelationEditorLayerFilterArgs={};function McxFieldRelationEditorLayerFilterArgs(a){mcx.base(this,a);this._layerName=a;this._filterString=""}mcx.inherits(McxFieldRelationEditorLayerFilterArgs,McxEventArgs);McxFieldRelationEditorLayerFilterArgs.prototype.setAttributeFilter=function(a){this._filterString=a};McxFieldRelationEditorLayerFilterArgs.prototype.getAttributeFilter=function(){return this._filterString};
McxFieldRelationEditorLayerFilterArgs.prototype.getLayerName=function(){return this._layerName};js.framework.ui.McxCommonControl.FileUploader={};js.framework.ui.McxCommonControl.FileUploader.McxFileUploader={};function McxFileUploader(){mcx.base(this);this.base=this;this._clearButton=this._fileNameContent=this._uploadFile=this._fileUploader=this._hiddenIfame=this._uploadForm=this._rootElement=null;this._knownTypeList=[];this._chooseButton=null;this._formatExceptionMessage="";this._uploadButtonClickEventHandler=new McxEventHandler;this._autoUpload=!1;this.initialize()}
mcx.inherits(McxFileUploader,McxUserControl);
McxFileUploader.prototype.initialize=function(){this._rootElement=$("<div/>");this._uploadForm=$('<form action="" method="POST" id="myForm" enctype="multipart/form-data" target="hidden_iframe"/>');this._hiddenIfame=$('<iframe id="hidden_iframe" class="hidden" name="hidden_iframe" src="inc/temp.html"/>');var a=$('<div id="openFileDialogInner" class="mcx-fileupload-container"/>');this._fileNameContent=$("<div />").addClass("mcx-fileupload-filename-container");this._fileUploader=$('<input type="file" />').addClass("hidden");
this._clearButton=$('<input type="submit" value="" />').addClass("mcx-fileupload-clear-button hidden");this._chooseButton=$('<input type="submit" value=""  />').addClass("mcx-fileupload-choose-button");var b=$("<div/>").addClass("mcx-fileupload-choose-button-container").append(this._chooseButton);this._fileNameContent.click($.proxy(this.onFileUploadClick,this));this._fileUploader.change($.proxy(this.onFileSelect,this));this._clearButton.click($.proxy(this.onClearButtonClick,this));this._chooseButton.click($.proxy(this.onFileUploadClick,
this));a.append(this._fileNameContent);a.append(this._clearButton);this._uploadForm.append(a);this._uploadForm.append(b);this._rootElement.append(this._uploadForm);this._rootElement.append(this._hiddenIfame);McxLocalizationManager.localizeContent(this._rootElement)};McxFileUploader.prototype.onFileUploadClick=function(){this._fileUploader.trigger("click")};
McxFileUploader.prototype.onFileSelect=function(){var a=this._fileUploader.get(0).files[0],b=!1,c=a.type;if(""==c)for(var d=a.name.split("."),e=0;e<d.length;e++)e==d.length-1&&(c=d[e]);for(d=0;d<this._knownTypeList.length;d++)-1<c.indexOf(this._knownTypeList[d])&&(b=!0);0<this._knownTypeList.length&&!b?McxMessageBox.show("",this._formatExceptionMessage,McxMessageBoxType.Error):(this._fileNameContent.text(this._fileUploader.val().toString()),this._fileNameContent.css("width","80%"),this._clearButton.removeClass("hidden"),
this._uploadFile=a,this._chooseButton.removeClass("mcx-fileupload-choose-button"),this._chooseButton.addClass("mcx-fileupload-upload-button"),this._chooseButton.val(""),this._chooseButton.unbind("click"),this._chooseButton.bind("click",$.proxy(this.uploadFile,this)));this._autoUpload&&this._uploadButtonClickEventHandler.dispatchOnSuccess(this,null)};
McxFileUploader.prototype.onClearButtonClick=function(){this._uploadFile=null;this._fileUploader.get(0).files[0]=null;this._fileNameContent.text("");this._fileNameContent.css("width","100%");this._clearButton.addClass("hidden");this._chooseButton.addClass("mcx-fileupload-choose-button");this._chooseButton.removeClass("mcx-fileupload-upload-button");this._chooseButton.unbind("click");this._chooseButton.click($.proxy(this.onFileUploadClick,this))};
McxFileUploader.prototype.setFileTypeList=function(a){this._knownTypeList=a};McxFileUploader.prototype.uploadFile=function(){this._uploadButtonClickEventHandler.dispatchOnSuccess(this,new McxEventArgs(this._uploadFile))};McxFileUploader.prototype.getContent=function(){return this._rootElement};McxFileUploader.prototype.onUploadButtonClick=function(){return this._uploadButtonClickEventHandler};McxFileUploader.prototype.getUploadFile=function(){return this._uploadFile};
McxFileUploader.prototype.setFormatExceptionMessage=function(a){this._formatExceptionMessage=a};McxFileUploader.prototype.setAutoUpload=function(a){this._autoUpload=a};McxFileUploader.prototype.getFileName=function(){return this._fileUploader.get(0).files[0].name.split(".")};js.framework.ui.McxCommonControl.FillEditor={};js.framework.ui.McxCommonControl.FillEditor.McxFillEditor={};function McxFillEditor(){mcx.base(this);this.base=this;this._fill=this._colorSelector=this._rootElement=null;this.initialize()}mcx.inherits(McxFillEditor,McxUserControl);
McxFillEditor.prototype.initialize=function(){this._rootElement=$("<div/>");this._colorSelector=new McxColorPicker;var a=new McxLabeledEditor("Color",this._colorSelector);a.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesColor");this.base.addChild(this._rootElement,a)};McxFillEditor.prototype.applyFill=function(){this.getFill().setColor(this._colorSelector.getColor());this.getFill().setOpacity(this._colorSelector.getOpacity())};
McxFillEditor.prototype.setFill=function(a){this._fill=a;this._colorSelector.setOpacity(this.getFill().getOpacity());this._colorSelector.setColor(this.getFill().getColor())};McxFillEditor.prototype.getFillChangeHandler=function(){return this._colorSelector.getOnChangeHandler()};McxFillEditor.prototype.getFill=function(){return this._fill=this._fill||new McxFill};McxFillEditor.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.FontPicker={};js.framework.ui.McxCommonControl.FontPicker.McxFontPicker={};function McxFontPicker(){mcx.base(this);this.base=this;this._fontSelector=this._fontSelectButton=this._fontShortDescriptionBox=this._rootElement=null;this._fontAlign="normal";this._fontSize=12;this._fontFamily="";this._onFontChangeHanlder=new McxEventHandler;this.initialize();this.bindEvents()}mcx.inherits(McxFontPicker,McxUserControl);
McxFontPicker.prototype.initialize=function(){this._rootElement=new McxLayoutRow;this._rootElement.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center);this._fontShortDescriptionBox=$("<input/>").attr("type","text").attr("readonly","readonly").addClass("mcx-input fit");this._fontSelector=new McxFontSelector;this.updateFontDescription();this._fontSelectButton=$("<button/>").addClass("mcx-input fit").css("text-align","center").html("...").addClass("");var a=$("<div/>").css("position","relative").append(this._fontSelectButton);
this.base.addChild(a,this._fontSelector);this._fontSelector.getContent().css("position","absolute").css("z-index","2000").css("display","none");this._rootElement.createAndAddSpan(9,this._fontShortDescriptionBox);this._rootElement.createAndAddSpan(3,a);$(document).mouseup($.proxy(function(a){a=$(a.target);if(a.hasClass("mcx-font-selector")||0<a.parents(".mcx-font-selector").length)return!0;this.hideFontSelector()},this))};
McxFontPicker.prototype.hideFontSelector=function(){this._fontSelector.getContent().css("display","none")};
McxFontPicker.prototype.showFontSelector=function(){this._fontSelector.getContent().appendTo("body").css("top",this._fontSelectButton.offset().top+this._fontSelectButton.outerHeight(!0)).css("left",this._fontSelectButton.offset().left).css("right","auto").css("bottom","auto").css("display","block");this._fontSelector.getContent().offset().top+this._fontSelector.getContent().height()>$(window).height()&&this._fontSelector.getContent().css("top",this._fontSelectButton.offset().top-this._fontSelector.getContent().outerHeight(!0))};
McxFontPicker.prototype.toggleFontSelector=function(){this._fontSelector.getContent().is(":visible")?this.hideFontSelector():this.showFontSelector()};
McxFontPicker.prototype.bindEvents=function(){this._fontSelectButton.click($.proxy(function(){this.toggleFontSelector()},this));this._fontSelector.getFontSelectHandler().addListener(function(){this.updateFont();this.updateFontDescription();this.hideFontSelector();this.getFontChangeHandler().dispatchOnSuccess(this,null)},null,this);this._fontSelector.getFontCancelHandler().addListener(function(){this.resetFont();this.hideFontSelector()},null,this)};McxFontPicker.prototype.getFontAlign=function(){return this._fontAlign};
McxFontPicker.prototype.getFontFamily=function(){return this._fontFamily};McxFontPicker.prototype.getFontSize=function(){return this._fontSize};McxFontPicker.prototype.getFontUnit=function(){return"px"};McxFontPicker.prototype.setFontFamily=function(a){this._fontSelector.setFontFamily(a);this.updateFont()};McxFontPicker.prototype.setFontSize=function(a){this._fontSelector.setFontSize(a);this.updateFont()};
McxFontPicker.prototype.updateFontDescription=function(){var a=this._fontSelector.getFontFamilyName()+", "+this._fontSelector.getFontSize()+" px"+(this._fontSelector.getIsBold()?", bold":"")+(this._fontSelector.getIsItalic()?", italic":"");this._fontShortDescriptionBox.val(a)};
McxFontPicker.prototype.updateFont=function(){this._fontAlign=this._fontSelector.getIsBold()?"bold ":"";this._fontAlign+=this._fontSelector.getIsItalic()?"italic ":"normal ";this._fontSize=this._fontSelector.getFontSize();this._fontFamily=this._fontSelector.getFontFamily()};McxFontPicker.prototype.resetFont=function(){mcx.isDefAndNotNull(this._fontSize)&&this._fontSelector.setFontSize(this._fontSize);mcx.isDefAndNotNull(this._fontFamily)&&this._fontSelector.setFontFamily(this._fontFamily)};
McxFontPicker.prototype.getFontChangeHandler=function(){return this._onFontChangeHanlder};McxFontPicker.prototype.getContent=function(){return this._rootElement.getContent()};js.framework.ui.McxCommonControl.FontSelector={};js.framework.ui.McxCommonControl.FontSelector.McxFontSelector={};
function McxFontSelector(){mcx.base(this);this.base=this;this._rootElement=null;this._isItalic=this._isBold=!1;this._fontFamilyName="Arial";this._fontFamily="arial,helvetica,sans-serif";this._fontSize=8;this._okButtonEventHandler=new McxEventHandler;this._cancelButtonEventHandler=new McxEventHandler;this._previewLabel=this._italicCheckBox=this._boldCheckBox=this._cancleButton=this._okButton=null;this.initialize();this.bindEvents()}mcx.inherits(McxFontSelector,McxUserControl);
McxFontSelector.prototype.initialize=function(){this._rootElement=$("<div/>").addClass("mcx-font-selector");this._fontFamilySelectBox=$("<select/>").change($.proxy(this.fontFamilySelectBoxChange,this));for(var a=this.getWebSafeFontFamilies(),b=0;b<a.length;b++){var c=a[b];this._fontFamilySelectBox.append($("<option/>").val(c.style).html(c.name))}this._fontSizeSelectBox=$("<select/>").change($.proxy(this.fontSizeSelectBoxChange,this));a=this.getFontSizeList();for(b=0;b<a.length;b++)c=a[b],this._fontSizeSelectBox.append($("<option/>").val(c.toString()).html(c));
this._okButton=$("<button/>").html("Ok").attr("data-localize","McxCommonControl-FontStyleOKButton").addClass("mcx-input").css("width","100%");this._cancleButton=$("<button/>").html("Cancel").attr("data-localize","McxCommonControl-FontStyleCancelButton").addClass("mcx-input").css("width","100%");a=new McxLabeledEditor("F. Family",this._fontFamilySelectBox);a.setLabelLocalizationKey("McxCommonControl-FontFamily");b=new McxLabeledEditor("F. Size",this._fontSizeSelectBox);b.setLabelLocalizationKey("McxCommonControl-FontSize");
c=new McxGroupBox("Style");c.setLocalizationKeyForTitle("McxCommonControl-Style");var d=$("<div/>"),e=$("<div/>"),f=$("<div/>"),g=$("<div/>");this._boldCheckBox=new McxCheckBox;this.base.addChild(d,this._boldCheckBox);this._boldCheckBox.setText("McxCommonControl-FontStyleBold");this._boldCheckBox.onChangeHandler().addListener(this.boldCheckBoxChange,null,this);this._italicCheckBox=new McxCheckBox;this.base.addChild(e,this._italicCheckBox);this._italicCheckBox.setText("McxCommonControl-FontStyleItalic");
this._italicCheckBox.onChangeHandler().addListener(this.italicCheckBoxChange,null,this);c.addContent(d);c.addContent(e);c.addContent(f);c.addContent(g);e=new McxGroupBox("Sample Text");e.setLocalizationKeyForTitle("McxCommonControl-SampleText");e.setHeight(77);this._previewLabel=$("<div/>").html("AaBbYyZz").css("overflow","hidden").css("line-height","77px").css("text-align","center");e.addContent(this._previewLabel);d=new McxLayoutRow;d.createAndAddSpan(6,c);d.createAndAddSpan(6,e);c=new McxLayoutRow;
c.createAndAddSpan(9,a);c.createAndAddSpan(3,this._okButton);a=new McxLayoutRow;a.createAndAddSpan(9,b);a.createAndAddSpan(3,this._cancleButton);this.base.addChild(this._rootElement,c);this.base.addChild(this._rootElement,a);this.base.addChild(this._rootElement,d)};
McxFontSelector.prototype.bindEvents=function(){this._okButton.click($.proxy(function(){this._okButtonEventHandler.dispatchOnSuccess(this,null)},this));this._cancleButton.click($.proxy(function(){this._cancelButtonEventHandler.dispatchOnSuccess(this,null)},this))};
McxFontSelector.prototype.getWebSafeFontFamilies=function(){return[{name:"Arial",style:"arial,helvetica,sans-serif"},{name:"Arial Black",style:'"Arial Black",helvetica, sans-serif'},{name:"Avant Garde",style:'"Century Gothic","Avant Garde Gothic", "Avant Garde","URW Gothic L",helvetica,sans-serif'},{name:"Bookman",style:'"Bookman Old Style","URW Bookman L","itc bookman",times, serif'},{name:"Century Schoolbook",style:'"Century Schoolbook", Century,"new century schoolbook", "Century Schoolbook L", times, serif'},
{name:"Comic Sans MS",style:'"Comic Sans MS",arial,helvetica,sans-serif'},{name:"Courier New",style:'"courier new",courier,monospace'},{name:"Garamond",style:'Garamond,Garamond,"Garamond Antiqua",times,serif'}]};McxFontSelector.prototype.getFontSizeList=function(){return[2,3,4,5,6,7,8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72]};McxFontSelector.prototype.boldCheckBoxChange=function(){this._isBold=this._boldCheckBox.isChecked();this.updatePreview()};
McxFontSelector.prototype.italicCheckBoxChange=function(){this._isItalic=this._italicCheckBox.isChecked();this.updatePreview()};McxFontSelector.prototype.fontFamilySelectBoxChange=function(){this._fontFamily=this._fontFamilySelectBox.find("option:selected").val();this._fontFamilyName=this._fontFamilySelectBox.find("option:selected").html().toString();this.updatePreview()};
McxFontSelector.prototype.fontSizeSelectBoxChange=function(){this._fontSize=this._fontSizeSelectBox.find("option:selected").val();this.updatePreview()};McxFontSelector.prototype.updatePreview=function(){this._previewLabel.css("font-family",this._fontFamily).css("font-size",this._fontSize+"px").css("font-style",this._isItalic?"italic":"").css("font-weight",this._isBold?"bold":"normal")};McxFontSelector.prototype.getIsBold=function(){return this._isBold};McxFontSelector.prototype.getIsItalic=function(){return this._isItalic};
McxFontSelector.prototype.getFontSize=function(){return parseFloat(this._fontSize)};McxFontSelector.prototype.getFontFamilyName=function(){return this._fontFamilyName};McxFontSelector.prototype.getFontFamily=function(){return this._fontFamily};McxFontSelector.prototype.setIsBold=function(a){this._isBold=a;this._boldCheckBox.checked(a);this.updatePreview()};McxFontSelector.prototype.setIsItalic=function(a){this._isItalic=a;this._italicCheckBox.checked(a);this.updatePreview()};
McxFontSelector.prototype.setFontSize=function(a){isNaN(a)||8>a||(this._fontSize=parseFloat(a.toString()),this._fontSizeSelectBox.find("option").filter(function(){return $(this).val().toString()==a.toString()}).attr("selected","selected"),this.updatePreview())};
McxFontSelector.prototype.setFontFamily=function(a){if(""!=a){this._fontFamily=a;var b=this._fontFamilySelectBox.find("option").filter(function(){return $(this).val()==a});0==b.length&&(b=this._fontFamilySelectBox.find("option").filter(function(){return-1<$(this).val().indexOf(a)}));var c="";this._fontFamilyName=(c=0<b.length?b.html():this._fontFamilySelectBox.find("option:first").attr("selected","selected").html())&&""!=c?c:this._fontFamilyName;this.updatePreview()}};
McxFontSelector.prototype.getFontSelectHandler=function(){return this._okButtonEventHandler};McxFontSelector.prototype.getFontCancelHandler=function(){return this._cancelButtonEventHandler};McxFontSelector.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.GradientLegend={};js.framework.ui.McxCommonControl.GradientLegend.McxGradientLegend={};function McxGradientLegend(){mcx.base(this);this._rootElement=$("<div/>");this._titleElem=$("<div/>");this._stopList=$("<ul/>");this._gradient=null;this.initialize()}mcx.inherits(McxGradientLegend,McxUserControl);
McxGradientLegend.prototype.initialize=function(){this._titleElem.addClass("mcx-gradient-legend-title");var a=$("<div/>").addClass("mcx-gradient-legend-content");this._stopList.addClass("mcx-gradient-legend-stop-list");a.append(this._stopList);this._rootElement.addClass("mcx-gradient-legend").append(this._titleElem).append(a)};
McxGradientLegend.prototype.setGradient=function(a,b,c,d){b=b||0;c=c||100;d=d||1;this._gradient=a;this._stopList.empty();a.getStops();for(a=(c-b)/d;c>=b;c-=a)d=$("<li/>").addClass("mcx-gradient-legend-stop-label"),d.text(Math.round(c).toString()),this._stopList.append(d);this._gradient.paintElement(this._stopList,"bottom")};McxGradientLegend.prototype.getGradient=function(){return this._gradient};McxGradientLegend.prototype.setTitle=function(a){this._titleElem.html(a)};
McxGradientLegend.prototype.setTop=function(a){this._rootElement.css("top",a)};McxGradientLegend.prototype.setLeft=function(a){this._rootElement.css("left",a)};McxGradientLegend.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.GradientSelectBox={};js.framework.ui.McxCommonControl.GradientSelectBox.McxGradientSelectBox={};function McxGradientSelectBox(){mcx.base(this);this.base=this;this._selectListElement=this._selectComboElement=this._comboLabelElement=this._selectBox=this._rootElement=null;this._onGradientSelectEventHandler=new McxEventHandler;this._selectedGradient=null;this._isReversedCheckBox=new McxCheckBox;this.initialize()}mcx.inherits(McxGradientSelectBox,McxUserControl);
McxGradientSelectBox.prototype.initialize=function(){this._rootElement=$("<div/>").addClass("mcx-gradient-select-box-container");this._isReversedCheckBox.setText("Reverse","McxCommonControl-GradientReverse");this._isReversedCheckBox.onChangeHandler().addListener(function(){var a=this._isReversedCheckBox.isChecked();this.paintGradientSelectItems(a);this.getOnChangeHandler().dispatchOnSuccess(this,null)},null,this);this._selectBox=$("<div/>").addClass("mcx-gradient-select-box");this._comboLabelElement=
$("<span/>").text("Please Select a Gradient.").attr("data-localize","McxCommonControl-mcxLayerPropertiesSelectGradient").addClass("mcx-gradient-select-box-combo");this._selectComboElement=$("<div/>").addClass("mcx-gradient-select-box-combo").append(this._comboLabelElement).append($("<div/>").addClass("mcx-gradient-select-box-combo-arrow")).append($("<div/>").addClass("mcx-gradient-select-box-combo-splitter"));this._selectComboElement.click($.proxy(function(){this._selectBox.toggleClass("active");
this.relocateSelectListElement()},this));this._selectListElement=$("<div/>").addClass("mcx-gradient-select-box-list");this._selectBox.append(this._selectComboElement);this._selectBox.append(this._selectListElement);$(document).mousedown($.proxy(function(a){a=$(a.target);if(a.hasClass("mcx-gradient-select-box-container")||0<a.parents(".mcx-gradient-select-box-container").length||a.hasClass("mcx-gradient-select-box-list")||0<a.parents(".mcx-gradient-select-box-list").length)return!0;this._selectBox.removeClass("active");
this._selectListElement.css("display","none")},this));this._selectListElement.data("control",this);this._rootElement.append(this._selectBox);this.base.addChild(this._rootElement,this._isReversedCheckBox);this._isReversedCheckBox.getContent().find("label").css("float","left");this._isReversedCheckBox.getContent().find("input").css("margin","5px 5px 5px 0");this._isReversedCheckBox.hide()};
McxGradientSelectBox.prototype.relocateSelectListElement=function(){this._selectListElement.parent().is("body")||$("body").append(this._selectListElement);this._selectListElement.css("top",this._rootElement.offset().top+this._rootElement.height());this._selectListElement.css("left",this._selectBox.offset().left);this._selectListElement.css("width",parseFloat(this._rootElement.width()));this._selectListElement.css("display",this._selectBox.hasClass("active")?"block":"none")};
McxGradientSelectBox.prototype.setIsReversible=function(a){a?this._isReversedCheckBox.show():this._isReversedCheckBox.hide()};McxGradientSelectBox.prototype.paintGradientSelectItems=function(a){this._selectListElement.find(".mcx-gradient-select-box-list-item").each(function(b,c){var d=$(c),e=d.data("gradient");e&&(a&&(e=e.getReversedClone()),e.paintElement(d))})};
McxGradientSelectBox.prototype.addGradient=function(a){var b=a.getName(),c=this,b=$("<div/>").addClass("mcx-gradient-select-box-list-item").html(b).data("gradient",a).click(function(){c._selectBox.toggleClass("active");c.relocateSelectListElement();c._selectListElement.find(".selected").removeClass("selected");$(this).addClass("selected");c.setSelectedGradient($(this).data("gradient"))});a.paintElement(b);this._selectListElement.append(b)};
McxGradientSelectBox.prototype.setSelectedGradient=function(a){this._selectedGradient=a;this._comboLabelElement.removeAttr("data-localize").text(a.getName());this.getOnChangeHandler().dispatchOnSuccess(this,null)};McxGradientSelectBox.prototype.getOnChangeHandler=function(){return this._onGradientSelectEventHandler};McxGradientSelectBox.prototype.getSelectedGradient=function(){var a=this._selectedGradient;a&&this._isReversedCheckBox.isChecked()&&(a=a.getReversedClone());return a||null};
McxGradientSelectBox.prototype.dispose=function(){this.base.dispose();this._selectListElement.remove()};McxGradientSelectBox.prototype.getContent=function(){return this._rootElement};McxGradientSelectBox.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};$(window).load(function(){setInterval(function(){$(".mcx-gradient-select-box-list:visible").each(function(){var a=$(this).data("control");a&&a.relocateSelectListElement()})},10)});js.framework.ui.McxCommonControl.GradientSelectBox.McxPredefinedGradients={};function McxPredefinedGradients(){}McxPredefinedGradients.getGradients=function(){return McxPredefinedGradients.__gradients};
McxPredefinedGradients.__gradients=[{name:"AngledBlack",stops:{0:{r:0,g:0,b:0},5:{r:25,g:25,b:25},10:{r:51,g:51,b:51},15:{r:77,g:77,b:77},"20.197044":{r:102,g:102,b:102},25:{r:128,g:128,b:128},30:{r:153,g:153,b:153},35:{r:179,g:179,b:179},40:{r:204,g:204,b:204},45:{r:230,g:230,b:230},"50.246305":{r:51,g:51,b:51},55:{r:51,g:51,b:51},60:{r:51,g:51,b:51},"65.024631":{r:77,g:77,b:77},"69.950739":{r:102,g:102,b:102},"75.369458":{r:128,g:128,b:128},80:{r:153,g:153,b:153},85:{r:179,g:179,b:179},"90.147783":{r:204,
g:204,b:204},"95.073892":{r:230,g:230,b:230},100:{r:255,g:255,b:255}}},{name:"BluSteel",stops:{0:{r:0,g:0,b:0},70:{r:204,g:204,b:255},85:{r:153,g:153,b:153},93:{r:204,g:204,b:204},100:{r:230,g:230,b:230}}},{name:"BrownBlue",stops:{0:{r:145,g:79,b:50},"17.73399":{r:198,g:154,b:107},"33.497537":{r:249,g:220,b:195},"50.246305":{r:236,g:249,b:252},"66.995074":{r:142,g:214,b:239},"83.251232":{r:94,g:179,b:227},100:{r:47,g:104,b:179}}},{name:"BrownYellow",stops:{0:{r:88,g:50,b:16},"17.73399":{r:173,g:104,
b:79},"33.990148":{r:239,g:183,b:123},"50.246305":{r:255,g:204,b:153},"66.502463":{r:255,g:242,b:170},"83.743842":{r:255,g:255,b:192},100:{r:255,g:255,b:227}}},{name:"BYWaves",stops:{0:{r:102,g:102,b:255},10:{r:255,g:255,b:0},20:{r:102,g:102,b:255},30:{r:255,g:255,b:0},40:{r:102,g:102,b:204},50:{r:255,g:255,b:0},100:{r:102,g:51,b:0}}},{name:"Carnival",stops:{0:{r:78,g:218,b:146},2:{r:47,g:120,b:194},3:{r:218,g:48,b:185},5:{r:253,g:3,b:47},7:{r:205,g:165,b:47},9:{r:205,g:218,b:176},10:{r:44,g:218,
b:47},20:{r:205,g:218,b:18},25:{r:70,g:218,b:47},30:{r:205,g:172,b:47},40:{r:205,g:218,b:47},50:{r:47,g:213,b:141},60:{r:205,g:94,b:47},70:{r:198,g:59,b:162},80:{r:205,g:218,b:59},90:{r:52,g:205,b:247},100:{r:71,g:5,b:47}}},{name:"ChromaDepth",stops:{0:{r:0,g:0,b:0},"0.5":{r:0,g:0,b:0},"0.6":{r:0,g:0,b:136},"16.6":{r:0,g:0,b:220},"16.7":{r:0,g:136,b:136},"33.3":{r:0,g:220,b:220},"33.4":{r:0,g:136,b:0},50:{r:0,g:220,b:0},"50.1":{r:136,g:136,b:0},"66.7":{r:220,g:220,b:0},"66.8":{r:136,g:0,b:0},"83.3":{r:220,
g:0,b:0},"83.4":{r:136,g:0,b:136},100:{r:216,g:0,b:216}}},{name:"Cold",stops:{0:{r:0,g:80,b:250},"5.418719":{r:0,g:137,b:245},"10.837438":{r:29,g:188,b:239},"16.256158":{r:115,g:224,b:241},"21.674877":{r:183,g:244,b:247},"27.093596":{r:214,g:251,b:252},"32.512315":{r:219,g:255,b:253},"37.438424":{r:229,g:254,b:250},"43.349754":{r:248,g:250,b:234},"51.231527":{r:230,g:230,b:230},60:{r:248,g:250,b:234},65:{r:229,g:254,b:250},70:{r:219,g:255,b:253},75:{r:214,g:251,b:252},80:{r:183,g:244,b:247},85:{r:115,
g:224,b:241},90:{r:29,g:188,b:239},95:{r:0,g:137,b:245},100:{r:0,g:80,b:250}}},{name:"Colors1",stops:{0:{r:179,g:179,b:179},"11.111111":{r:0,g:0,b:255},"22.222222":{r:0,g:255,b:0},"33.333333":{r:255,g:0,b:0},"44.444444":{r:255,g:0,b:255},"55.555556":{r:153,g:0,b:204},"66.666667":{r:255,g:102,b:0},"77.777778":{r:255,g:153,b:204},"88.888889":{r:204,g:204,b:255},100:{r:0,g:204,b:255}}},{name:"Colors2",stops:{0:{r:255,g:255,b:204},"11.111111":{r:0,g:0,b:255},"22.222222":{r:0,g:255,b:0},"29.064039":{r:255,
g:255,b:0},"35.796387":{r:255,g:0,b:0},"44.444444":{r:255,g:0,b:255},"59.989054":{r:153,g:0,b:204},"70.114943":{r:255,g:102,b:0},"77.777778":{r:255,g:153,b:204},"86.425835":{r:153,g:255,b:153},100:{r:204,g:153,b:51}}},{name:"CottonCandy",stops:{0:{r:52,g:209,b:165},2:{r:113,g:200,b:164},3:{r:209,g:189,b:127},5:{r:101,g:186,b:113},7:{r:216,g:128,b:113},9:{r:216,g:209,b:188},10:{r:75,g:209,b:113},20:{r:216,g:209,b:154},25:{r:225,g:209,b:113},30:{r:216,g:120,b:113},40:{r:216,g:209,b:113},50:{r:113,g:204,
b:240},60:{r:216,g:107,b:113},70:{r:222,g:145,b:179},80:{r:216,g:209,b:244},90:{r:196,g:216,b:129},100:{r:133,g:10,b:113}}},{name:"CyanBrands",stops:{0:{r:0,g:0,b:0},"0.09":{r:0,g:0,b:51},"0.17":{r:0,g:0,b:102},"0.26":{r:0,g:0,b:153},"0.35":{r:0,g:0,b:204},"0.43":{r:0,g:0,b:255},"1.3":{r:0,g:51,b:0},"1.39":{r:0,g:51,b:51},"1.47":{r:0,g:51,b:102},"1.56":{r:0,g:51,b:153},"1.65":{r:0,g:51,b:204},"1.73":{r:0,g:51,b:255},"2.6":{r:0,g:102,b:0},"2.68":{r:0,g:102,b:51},"2.77":{r:0,g:102,b:102},"2.86":{r:0,
g:102,b:153},"2.94":{r:0,g:102,b:204},"3.03":{r:0,g:102,b:255},"3.9":{r:0,g:153,b:0},"3.98":{r:0,g:153,b:51},"4.07":{r:0,g:153,b:102},"4.16":{r:0,g:153,b:153},"4.24":{r:0,g:153,b:204},"4.33":{r:0,g:153,b:255},"5.19":{r:0,g:204,b:0},"5.28":{r:0,g:204,b:51},"5.37":{r:0,g:204,b:102},"5.45":{r:0,g:204,b:153},"5.54":{r:0,g:204,b:204},"5.63":{r:0,g:204,b:255},"6.49":{r:0,g:255,b:0},"6.58":{r:0,g:255,b:51},"6.67":{r:0,g:255,b:102},"6.75":{r:0,g:255,b:153},"6.84":{r:0,g:255,b:204},"6.93":{r:0,g:255,b:255},
"18.61":{r:51,g:0,b:0},"18.7":{r:51,g:0,b:51},"18.79":{r:51,g:0,b:102},"18.87":{r:51,g:0,b:153},"18.96":{r:51,g:0,b:204},"19.05":{r:51,g:0,b:255},"19.91":{r:51,g:51,b:0},20:{r:51,g:51,b:51},"20.09":{r:51,g:51,b:102},"20.17":{r:51,g:51,b:153},"20.26":{r:51,g:51,b:204},"20.35":{r:51,g:51,b:255},"21.21":{r:51,g:102,b:0},"21.3":{r:51,g:102,b:51},"21.39":{r:51,g:102,b:102},"21.47":{r:51,g:102,b:153},"21.56":{r:51,g:102,b:204},"21.65":{r:51,g:102,b:255},"22.51":{r:51,g:153,b:0},"22.6":{r:51,g:153,b:51},
"22.68":{r:51,g:153,b:102},"22.77":{r:51,g:153,b:153},"22.86":{r:51,g:153,b:204},"22.94":{r:51,g:153,b:255},"23.81":{r:51,g:204,b:0},"23.9":{r:51,g:204,b:51},"23.98":{r:51,g:204,b:102},"24.07":{r:51,g:204,b:153},"24.16":{r:51,g:204,b:204},"24.24":{r:51,g:204,b:255},"25.11":{r:51,g:255,b:0},"25.19":{r:51,g:255,b:51},"25.28":{r:51,g:255,b:102},"25.37":{r:51,g:255,b:153},"25.45":{r:51,g:255,b:204},"25.54":{r:51,g:255,b:255},"37.23":{r:102,g:0,b:0},"37.32":{r:102,g:0,b:51},"37.4":{r:102,g:0,b:102},"37.49":{r:102,
g:0,b:153},"37.58":{r:102,g:0,b:204},"37.66":{r:102,g:0,b:255},"38.53":{r:102,g:51,b:0},"38.61":{r:102,g:51,b:51},"38.7":{r:102,g:51,b:102},"38.79":{r:102,g:51,b:153},"38.87":{r:102,g:51,b:204},"38.96":{r:102,g:51,b:255},"39.83":{r:102,g:102,b:0},"39.91":{r:102,g:102,b:51},40:{r:102,g:102,b:102},"40.09":{r:102,g:102,b:153},"40.17":{r:102,g:102,b:204},"40.26":{r:102,g:102,b:255},"41.13":{r:102,g:153,b:0},"41.21":{r:102,g:153,b:51},"41.3":{r:102,g:153,b:102},"41.39":{r:102,g:153,b:153},"41.47":{r:102,
g:153,b:204},"41.56":{r:102,g:153,b:255},"42.42":{r:102,g:204,b:0},"42.51":{r:102,g:204,b:51},"42.6":{r:102,g:204,b:102},"42.68":{r:102,g:204,b:153},"42.77":{r:102,g:204,b:204},"42.86":{r:102,g:204,b:255},"43.72":{r:102,g:255,b:0},"43.81":{r:102,g:255,b:51},"43.9":{r:102,g:255,b:102},"43.98":{r:102,g:255,b:153},"44.07":{r:102,g:255,b:204},"44.16":{r:102,g:255,b:255},"55.84":{r:153,g:0,b:0},"55.93":{r:153,g:0,b:51},"56.02":{r:153,g:0,b:102},"56.1":{r:153,g:0,b:153},"56.19":{r:153,g:0,b:204},"56.28":{r:153,
g:0,b:255},"57.14":{r:153,g:51,b:0},"57.23":{r:153,g:51,b:51},"57.32":{r:153,g:51,b:102},"57.4":{r:153,g:51,b:153},"57.49":{r:153,g:51,b:204},"57.58":{r:153,g:51,b:255},"58.44":{r:153,g:102,b:0},"58.53":{r:153,g:102,b:51},"58.61":{r:153,g:102,b:102},"58.7":{r:153,g:102,b:153},"58.79":{r:153,g:102,b:204},"58.87":{r:153,g:102,b:255},"59.74":{r:153,g:153,b:0},"59.83":{r:153,g:153,b:51},"59.91":{r:153,g:153,b:102},60:{r:153,g:153,b:153},"60.09":{r:153,g:153,b:204},"60.17":{r:153,g:153,b:255},"61.04":{r:153,
g:204,b:0},"61.13":{r:153,g:204,b:51},"61.21":{r:153,g:204,b:102},"61.3":{r:153,g:204,b:153},"61.39":{r:153,g:204,b:204},"61.47":{r:153,g:204,b:255},"62.34":{r:153,g:255,b:0},"62.42":{r:153,g:255,b:51},"62.51":{r:153,g:255,b:102},"62.6":{r:153,g:255,b:153},"62.68":{r:153,g:255,b:204},"62.77":{r:153,g:255,b:255},"74.46":{r:204,g:0,b:0},"74.55":{r:204,g:0,b:51},"74.63":{r:204,g:0,b:102},"74.72":{r:204,g:0,b:153},"74.81":{r:204,g:0,b:204},"74.89":{r:204,g:0,b:255},"75.76":{r:204,g:51,b:0},"75.84":{r:204,
g:51,b:51},"75.93":{r:204,g:51,b:102},"76.02":{r:204,g:51,b:153},"76.1":{r:204,g:51,b:204},"76.19":{r:204,g:51,b:255},"77.06":{r:204,g:102,b:0},"77.14":{r:204,g:102,b:51},"77.23":{r:204,g:102,b:102},"77.32":{r:204,g:102,b:153},"77.4":{r:204,g:102,b:204},"77.49":{r:204,g:102,b:255},"78.35":{r:204,g:153,b:0},"78.44":{r:204,g:153,b:51},"78.53":{r:204,g:153,b:102},"78.61":{r:204,g:153,b:153},"78.7":{r:204,g:153,b:204},"78.79":{r:204,g:153,b:255},"79.65":{r:204,g:204,b:0},"79.74":{r:204,g:204,b:51},"79.83":{r:204,
g:204,b:102},"79.91":{r:204,g:204,b:153},80:{r:204,g:204,b:204},"80.09":{r:204,g:204,b:255},"80.95":{r:204,g:255,b:0},"81.04":{r:204,g:255,b:51},"81.13":{r:204,g:255,b:102},"81.21":{r:204,g:255,b:153},"81.3":{r:204,g:255,b:204},"81.39":{r:204,g:255,b:255},"93.07":{r:255,g:0,b:0},"93.16":{r:255,g:0,b:51},"93.25":{r:255,g:0,b:102},"93.33":{r:255,g:0,b:153},"93.42":{r:255,g:0,b:204},"93.51":{r:255,g:0,b:255},"94.37":{r:255,g:51,b:0},"94.46":{r:255,g:51,b:51},"94.55":{r:255,g:51,b:102},"94.63":{r:255,
g:51,b:153},"94.72":{r:255,g:51,b:204},"94.81":{r:255,g:51,b:255},"95.67":{r:255,g:102,b:0},"95.76":{r:255,g:102,b:51},"95.84":{r:255,g:102,b:102},"95.93":{r:255,g:102,b:153},"96.02":{r:255,g:102,b:204},"96.1":{r:255,g:102,b:255},"96.97":{r:255,g:153,b:0},"97.06":{r:255,g:153,b:51},"97.14":{r:255,g:153,b:102},"97.23":{r:255,g:153,b:153},"97.32":{r:255,g:153,b:204},"97.4":{r:255,g:153,b:255},"98.27":{r:255,g:204,b:0},"98.35":{r:255,g:204,b:51},"98.44":{r:255,g:204,b:102},"98.53":{r:255,g:204,b:153},
"98.61":{r:255,g:204,b:204},"98.7":{r:255,g:204,b:255},"99.57":{r:255,g:255,b:0},"99.65":{r:255,g:255,b:51},"99.74":{r:255,g:255,b:102},"99.83":{r:255,g:255,b:153},"99.91":{r:255,g:255,b:204},100:{r:255,g:255,b:255}}},{name:"Dirt",stops:{0:{r:153,g:102,b:51},100:{r:230,g:230,b:230}}},{name:"Electirc",stops:{0:{r:0,g:204,b:255},"26.181818":{r:153,g:0,b:204},"42.909091":{r:255,g:255,b:0},"60.363636":{r:0,g:0,b:255},"75.384615":{r:0,g:255,b:0},"79.272727":{r:255,g:0,b:0},"83.636364":{r:255,g:0,b:0},
100:{r:204,g:153,b:51}}},{name:"Forest",stops:{0:{r:103,g:211,b:187},2:{r:57,g:181,b:148},3:{r:211,g:251,b:0},5:{r:241,g:148,b:57},7:{r:42,g:116,b:57},9:{r:42,g:211,b:109},10:{r:91,g:211,b:57},20:{r:42,g:211,b:154},25:{r:152,g:211,b:57},30:{r:42,g:107,b:57},40:{r:42,g:211,b:57},50:{r:57,g:3,b:26},60:{r:42,g:153,b:57},70:{r:61,g:28,b:10},80:{r:42,g:211,b:98},90:{r:49,g:42,b:8},100:{r:224,g:67,b:57}}},{name:"GrassWhite",stops:{0:{r:153,g:102,b:51},5:{r:0,g:102,b:51},"10.344828":{r:117,g:193,b:120},
15:{r:255,g:255,b:255},"20.689655":{r:153,g:102,b:51},25:{r:0,g:102,b:51},30:{r:117,g:193,b:120},"35.46798":{r:255,g:255,b:255},40:{r:153,g:102,b:51},45:{r:0,g:102,b:51},"50.246305":{r:117,g:193,b:120},55:{r:255,g:255,b:255},60:{r:153,g:102,b:51},"64.53202":{r:0,g:102,b:51},"69.950739":{r:117,g:193,b:120},"75.369458":{r:255,g:255,b:255},80:{r:153,g:102,b:51},"85.221675":{r:0,g:102,b:51},90:{r:117,g:193,b:120},95:{r:255,g:255,b:255},100:{r:153,g:102,b:51}}},{name:"Grayscale",stops:{0:{r:0,g:0,b:0},
100:{r:255,g:255,b:255}}},{name:"Greens",stops:{0:{r:229,g:254,b:250},"9.359606":{r:198,g:230,b:208},"44.334975":{r:173,g:208,b:88},100:{r:0,g:153,b:51}}},{name:"HighPoints",stops:{0:{r:0,g:255,b:0},"72.3214285714286":{r:0,g:255,b:0},"72.3214285714287":{r:38,g:255,b:0},"73.2142857142857":{r:76,g:255,b:0},"74.1071428571429":{r:114,g:255,b:0},75:{r:152,g:255,b:0},"75.8928571428571":{r:190,g:255,b:0},"76.7857142857143":{r:229,g:255,b:0},"77.6785714285714":{r:255,g:243,b:0},"78.5714285714286":{r:255,
g:205,b:0},"79.4642857142857":{r:255,g:167,b:0},"80.3571428571429":{r:255,g:128,b:0},"81.25":{r:255,g:90,b:0},"82.1428571428571":{r:255,g:52,b:0},"83.0357142857143":{r:255,g:14,b:0},"83.9285714285714":{r:230,g:0,b:0},"84.8214285714286":{r:192,g:0,b:0},"85.7142857142857":{r:154,g:0,b:0},"86.6071428571429":{r:115,g:0,b:0},"87.5":{r:77,g:0,b:0},"88.3928571428571":{r:39,g:0,b:0},"89.2857142857143":{r:0,g:0,b:0},100:{r:0,g:0,b:0}}},{name:"HighPoints2",stops:{0:{r:0,g:0,b:0},70:{r:102,g:102,b:255},"78.817734":{r:0,
g:51,b:153},85:{r:51,g:102,b:102},93:{r:255,g:255,b:0},100:{r:255,g:0,b:0}}},{name:"Land",stops:{0:{r:0,g:255,b:0},"21.182266":{r:51,g:204,b:51},"45.812808":{r:153,g:102,b:51},"75.369458":{r:255,g:255,b:204},"90.147783":{r:255,g:255,b:255},100:{r:204,g:204,b:255}}},{name:"LandArid",stops:{0:{r:153,g:204,b:102},"21.182266":{r:255,g:255,b:153},"45.812808":{r:153,g:102,b:51},"75.369458":{r:255,g:255,b:204},"90.147783":{r:255,g:255,b:255},100:{r:204,g:204,b:255}}},{name:"LandSea",stops:{0:{r:0,g:0,b:0},
3:{r:0,g:51,b:153},32:{r:0,g:255,b:255},44:{r:102,g:51,b:0},100:{r:255,g:255,b:102}}},{name:"Midnight",stops:{0:{r:155,g:3,b:219},2:{r:105,g:248,b:80},3:{r:3,g:227,b:215},5:{r:6,g:162,b:105},7:{r:18,g:7,b:105},9:{r:18,g:3,b:148},10:{r:3,g:3,b:105},20:{r:18,g:3,b:22},25:{r:89,g:3,b:105},30:{r:18,g:208,b:105},40:{r:18,g:3,b:105},50:{r:105,g:10,b:224},60:{r:18,g:52,b:105},70:{r:15,g:87,b:115},80:{r:18,g:3,b:66},90:{r:226,g:18,b:12},100:{r:107,g:72,b:105}}},{name:"Mist",stops:{0:{r:165,g:4,b:13},2:{r:132,
g:233,b:162},3:{r:4,g:110,b:5},5:{r:61,g:99,b:132},7:{r:88,g:166,b:132},9:{r:88,g:4,b:199},10:{r:5,g:4,b:132},20:{r:88,g:4,b:210},25:{r:35,g:4,b:132},30:{r:88,g:161,b:132},40:{r:88,g:4,b:132},50:{r:132,g:140,b:250},60:{r:88,g:118,b:132},70:{r:54,g:76,b:199},80:{r:88,g:4,b:87},90:{r:122,g:88,b:155},100:{r:26,g:251,b:132}}},{name:"Pastel1",stops:{0:{r:230,g:230,b:230},11:{r:204,g:204,b:255},26:{r:153,g:204,b:204},"42.857143":{r:204,g:255,b:204},59:{r:255,g:255,b:204},80:{r:255,g:204,b:204},96:{r:255,
g:255,b:255},100:{r:255,g:255,b:255}}},{name:"Pastel2",stops:{0:{r:255,g:255,b:192},"22.660099":{r:151,g:195,b:157},"47.783251":{r:123,g:220,b:255},"72.413793":{r:142,g:123,b:167},100:{r:239,g:88,b:164}}},{name:"PinkPea",stops:{0:{r:242,g:113,b:120},"24.029557":{r:239,g:176,b:192},49:{r:186,g:204,b:204},"74.581281":{r:200,g:215,b:133},100:{r:173,g:208,b:88}}},{name:"PurpleBands",stops:{0:{r:153,g:0,b:204},5:{r:0,g:0,b:102},10:{r:204,g:204,b:255},15:{r:153,g:0,b:204},"20.197044":{r:0,g:0,b:102},"25.615764":{r:204,
g:204,b:255},30:{r:153,g:0,b:204},35:{r:0,g:0,b:102},"39.901478":{r:204,g:204,b:255},45:{r:153,g:0,b:204},50:{r:0,g:0,b:102},"54.187192":{r:204,g:204,b:255},60:{r:153,g:0,b:204},"63.546798":{r:0,g:0,b:102},"69.950739":{r:204,g:204,b:255},75:{r:153,g:0,b:204},80:{r:0,g:0,b:102},85:{r:204,g:204,b:255},90:{r:153,g:0,b:204},95:{r:0,g:0,b:102},100:{r:204,g:204,b:255}}},{name:"PurpleGreen",stops:{0:{r:88,g:82,b:116},"17.73399":{r:142,g:123,b:167},"33.497537":{r:195,g:195,b:224},"50.246305":{r:249,g:249,
b:255},"66.995074":{r:198,g:230,b:208},"83.251232":{r:151,g:195,b:157},100:{r:57,g:98,b:54}}},{name:"Rainbow",stops:{0:{r:153,g:102,b:255},20:{r:0,g:0,b:255},40:{r:0,g:255,b:0},60:{r:255,g:255,b:0},80:{r:255,g:102,b:0},100:{r:255,g:0,b:0}}},{name:"Rainbow2",stops:{0:{r:0,g:0,b:0},11:{r:0,g:0,b:255},26:{r:0,g:255,b:255},49:{r:0,g:153,b:0},59:{r:255,g:255,b:0},80:{r:255,g:0,b:0},96:{r:255,g:255,b:255},100:{r:255,g:255,b:255}}},{name:"RedHot",stops:{0:{r:255,g:0,b:0},100:{r:255,g:255,b:0}}},{name:"RedZebra",
stops:{0:{r:0,g:0,b:0},5:{r:255,g:255,b:255},10:{r:255,g:0,b:0},15:{r:255,g:255,b:255},"20.689655":{r:0,g:0,b:0},25:{r:255,g:255,b:255},30:{r:255,g:0,b:0},35:{r:255,g:255,b:255},40:{r:0,g:0,b:0},45:{r:255,g:255,b:255},50:{r:255,g:0,b:0},55:{r:255,g:255,b:255},60:{r:0,g:0,b:0},"64.53202":{r:255,g:255,b:255},"69.950739":{r:255,g:0,b:0},75:{r:255,g:255,b:255},80:{r:0,g:0,b:0},"85.221675":{r:255,g:255,b:255},90:{r:255,g:0,b:0},95:{r:255,g:255,b:255},100:{r:0,g:0,b:0}}},{name:"Swamp",stops:{0:{r:187,g:164,
b:208},2:{r:116,g:31,b:183},3:{r:164,g:95,b:165},5:{r:233,g:226,b:116},7:{r:7,g:8,b:116},9:{r:7,g:164,b:197},10:{r:114,g:164,b:116},20:{r:7,g:164,b:1},25:{r:58,g:164,b:116},30:{r:7,g:106,b:116},40:{r:7,g:164,b:116},50:{r:116,g:39,b:234},60:{r:7,g:127,b:116},70:{r:61,g:192,b:231},80:{r:7,g:164,b:54},90:{r:8,g:7,b:196},100:{r:58,g:141,b:116}}},{name:"Taffy",stops:{0:{r:153,g:153,b:255},5:{r:0,g:255,b:0},10:{r:255,g:153,b:204},15:{r:153,g:153,b:255},"20.197044":{r:255,g:255,b:255},25:{r:102,g:153,b:255},
30:{r:255,g:153,b:204},35:{r:0,g:255,b:0},40:{r:102,g:102,b:204},45:{r:255,g:153,b:204},50:{r:255,g:0,b:255},55:{r:0,g:204,b:255},60:{r:255,g:255,b:0},"65.024631":{r:230,g:230,b:230},"69.950739":{r:255,g:0,b:255},"75.369458":{r:0,g:255,b:255},80:{r:255,g:0,b:255},85:{r:255,g:153,b:204},"90.147783":{r:0,g:255,b:255},"95.073892":{r:102,g:153,b:255},100:{r:0,g:255,b:0}}},{name:"Terrain",stops:{0:{r:200,g:215,b:133},5:{r:171,g:217,b:177},10:{r:124,g:196,b:120},15:{r:117,g:193,b:120},20:{r:175,g:204,b:166},
25:{r:219,g:208,b:78},30:{r:241,g:207,b:14},35:{r:242,g:167,b:0},40:{r:192,g:159,b:13},45:{r:211,g:192,b:112},50:{r:240,g:219,b:161},55:{r:252,g:236,b:192},60:{r:248,g:250,b:234},65:{r:229,g:254,b:250},70:{r:219,g:255,b:253},75:{r:214,g:251,b:252},80:{r:183,g:244,b:247},85:{r:115,g:224,b:241},90:{r:29,g:188,b:239},95:{r:0,g:137,b:245},100:{r:0,g:80,b:250}}},{name:"Terrain2",stops:{0:{r:153,g:0,b:0},5:{r:171,g:217,b:177},10:{r:124,g:196,b:120},15:{r:117,g:193,b:120},20:{r:175,g:204,b:166},25:{r:219,
g:208,b:78},30:{r:241,g:207,b:14},35:{r:102,g:153,b:255},40:{r:192,g:159,b:13},45:{r:211,g:192,b:112},50:{r:240,g:219,b:161},55:{r:252,g:236,b:192},60:{r:248,g:250,b:234},65:{r:200,g:215,b:133},70:{r:255,g:153,b:153},75:{r:255,g:255,b:153},80:{r:183,g:244,b:247},85:{r:115,g:224,b:241},90:{r:29,g:188,b:239},95:{r:0,g:137,b:245},100:{r:0,g:80,b:250}}},{name:"TieDie",stops:{0:{r:255,g:255,b:255},5:{r:0,g:0,b:255},10:{r:0,g:255,b:255},15:{r:0,g:255,b:0},"20.197044":{r:255,g:255,b:0},25:{r:255,g:0,b:0},
30:{r:255,g:0,b:255},35:{r:153,g:0,b:204},40:{r:255,g:102,b:0},45:{r:255,g:153,b:204},50:{r:255,g:255,b:255},55:{r:0,g:0,b:255},60:{r:0,g:255,b:255},"65.024631":{r:0,g:255,b:0},"69.950739":{r:255,g:255,b:0},75:{r:255,g:0,b:0},80:{r:255,g:0,b:255},85:{r:153,g:0,b:204},90:{r:255,g:102,b:0},95:{r:255,g:153,b:204},100:{r:255,g:255,b:255}}},{name:"UsFlag",stops:{0:{r:0,g:51,b:153},5:{r:0,g:0,b:255},10:{r:0,g:0,b:255},15:{r:0,g:0,b:255},"20.689655":{r:0,g:0,b:255},"25.123153":{r:102,g:153,b:255},30:{r:255,
g:255,b:255},35:{r:255,g:255,b:255},40:{r:255,g:0,b:0},45:{r:255,g:255,b:255},"49.261084":{r:255,g:255,b:255},55:{r:255,g:0,b:0},60:{r:255,g:255,b:255},"64.53202":{r:255,g:255,b:255},"69.950739":{r:255,g:0,b:0},75:{r:255,g:255,b:255},"80.295567":{r:255,g:255,b:255},"85.221675":{r:255,g:0,b:0},90:{r:255,g:255,b:255},95:{r:255,g:255,b:255},100:{r:255,g:0,b:0}}},{name:"UsZebra",stops:{0:{r:0,g:0,b:255},5:{r:255,g:255,b:255},10:{r:255,g:0,b:0},15:{r:255,g:255,b:255},"20.689655":{r:0,g:0,b:255},25:{r:255,
g:255,b:255},30:{r:255,g:0,b:0},35:{r:255,g:255,b:255},40:{r:0,g:0,b:255},45:{r:255,g:255,b:255},50:{r:255,g:0,b:0},55:{r:255,g:255,b:255},60:{r:0,g:0,b:255},"64.53202":{r:255,g:255,b:255},"69.950739":{r:255,g:0,b:0},75:{r:255,g:255,b:255},80:{r:0,g:0,b:255},"85.221675":{r:255,g:255,b:255},90:{r:255,g:0,b:0},95:{r:255,g:255,b:255},100:{r:0,g:0,b:255}}},{name:"Zebra",stops:{0:{r:0,g:0,b:0},5:{r:255,g:255,b:255},10:{r:0,g:0,b:0},15:{r:255,g:255,b:255},"20.689655":{r:0,g:0,b:0},25:{r:255,g:255,b:255},
30:{r:0,g:0,b:0},35:{r:255,g:255,b:255},40:{r:0,g:0,b:0},45:{r:255,g:255,b:255},50:{r:0,g:0,b:0},55:{r:255,g:255,b:255},60:{r:0,g:0,b:0},"64.53202":{r:255,g:255,b:255},"69.950739":{r:0,g:0,b:0},75:{r:255,g:255,b:255},80:{r:0,g:0,b:0},"85.221675":{r:255,g:255,b:255},90:{r:0,g:0,b:0},95:{r:255,g:255,b:255},100:{r:0,g:0,b:0}}},{name:"Meteorology",stops:{0:{r:0,g:255,b:255},"0.05":{r:0,g:209,b:213},"0.1":{r:0,g:151,b:154},"0.2":{r:0,g:128,b:69},"0.5":{r:0,g:162,b:53},"0.8":{r:0,g:202,b:17},1:{r:0,g:245,
b:7},2:{r:72,g:255,b:70},5:{r:255,g:255,b:0},8:{r:255,g:220,b:0},10:{r:255,g:178,b:0},20:{r:255,g:138,b:0},50:{r:255,g:73,b:0},80:{r:229,g:0,b:0},100:{r:182,g:0,b:106},200:{r:255,g:0,b:255},500:{r:255,g:0,b:255},800:{r:255,g:0,b:255}}},{name:"Eler Gradient-1",stops:{0:{r:153,g:102,b:255},"0.5":{r:153,g:143,b:255},"1.3":{r:0,g:0,b:255},"2.8":{r:51,g:186,b:147},5:{r:0,g:255,b:0},17:{r:102,g:255,b:0},39:{r:255,g:255,b:0},65:{r:255,g:102,b:0},100:{r:255,g:0,b:0}}},{name:"Custom Gradient - 1",stops:{0:{r:175,
g:240,b:233},"0.392157":{r:175,g:240,b:230},"0.784314":{r:175,g:240,b:227},"1.176471":{r:175,g:240,b:222},"1.568627":{r:175,g:240,b:220},"1.960784":{r:175,g:240,b:217},"2.352941":{r:175,g:240,b:213},"2.745098":{r:177,g:242,b:212},"3.137255":{r:177,g:242,b:208},"3.529412":{r:177,g:242,b:205},"3.921569":{r:177,g:242,b:201},"4.313725":{r:177,g:242,b:198},"4.705882":{r:177,g:242,b:195},"5.098039":{r:176,g:245,b:191},"5.490196":{r:176,g:245,b:188},"5.882353":{r:176,g:245,b:183},"6.27451":{r:176,g:245,
b:181},"6.666667":{r:176,g:245,b:177},"7.058824":{r:180,g:245,b:176},"7.45098":{r:185,g:247,b:178},"7.843137":{r:188,g:247,b:178},"8.235294":{r:192,g:247,b:178},"8.627451":{r:197,g:247,b:178},"9.019608":{r:200,g:247,b:178},"9.411765":{r:202,g:247,b:178},"9.803922":{r:208,g:250,b:177},"10.19608":{r:211,g:250,b:177},"10.58824":{r:216,g:250,b:177},"10.98039":{r:218,g:250,b:177},"11.37255":{r:222,g:250,b:177},"11.76471":{r:227,g:250,b:177},"12.15686":{r:232,g:252,b:179},"12.54902":{r:237,g:252,b:179},
"12.94118":{r:240,g:252,b:179},"13.33333":{r:245,g:252,b:179},"13.72549":{r:248,g:252,b:179},"14.11765":{r:251,g:252,b:179},"14.5098":{r:252,g:252,b:177},"14.90196":{r:243,g:247,b:168},"15.29412":{r:238,g:245,b:162},"15.68627":{r:231,g:242,b:155},"16.07843":{r:222,g:237,b:147},"16.47059":{r:214,g:235,b:141},"16.86275":{r:208,g:232,b:135},"17.2549":{r:197,g:227,b:127},"17.64706":{r:190,g:224,b:121},"18.03922":{r:179,g:219,b:114},"18.43137":{r:172,g:217,b:111},"18.82353":{r:163,g:214,b:105},"19.21569":{r:153,
g:209,b:96},"19.60784":{r:143,g:207,b:91},20:{r:136,g:204,b:88},"20.39216":{r:125,g:199,b:82},"20.78431":{r:117,g:196,b:77},"21.17647":{r:105,g:191,b:71},"21.56863":{r:97,g:189,b:66},"21.96078":{r:86,g:186,b:61},"22.35294":{r:77,g:181,b:56},"22.7451":{r:69,g:179,b:52},"23.13725":{r:58,g:176,b:48},"23.52941":{r:47,g:171,b:43},"23.92157":{r:39,g:168,b:39},"24.31373":{r:36,g:166,b:41},"24.70588":{r:32,g:161,b:43},"25.09804":{r:27,g:158,b:44},"25.4902":{r:23,g:153,b:45},"25.88235":{r:21,g:150,b:47},"26.27451":{r:18,
g:148,b:50},"26.66667":{r:14,g:143,b:53},"27.05882":{r:11,g:140,b:54},"27.45098":{r:8,g:138,b:56},"27.84314":{r:5,g:133,b:58},"28.23529":{r:3,g:130,b:62},"28.62745":{r:0,g:128,b:64},"29.01961":{r:18,g:130,b:63},"29.41176":{r:30,g:130,b:62},"29.80392":{r:40,g:133,b:61},"30.19608":{r:49,g:135,b:60},"30.58824":{r:54,g:135,b:59},"30.98039":{r:62,g:138,b:59},"31.37255":{r:69,g:140,b:58},"31.76471":{r:76,g:143,b:57},"32.15686":{r:80,g:143,b:56},"32.54902":{r:88,g:145,b:55},"32.94118":{r:95,g:148,b:55},
"33.33333":{r:99,g:148,b:53},"33.72549":{r:106,g:150,b:53},"34.11765":{r:112,g:153,b:50},"34.5098":{r:118,g:153,b:49},"34.90196":{r:123,g:156,b:48},"35.29412":{r:130,g:158,b:47},"35.68627":{r:136,g:158,b:46},"36.07843":{r:143,g:161,b:45},"36.47059":{r:147,g:161,b:43},"36.86275":{r:155,g:163,b:42},"37.2549":{r:162,g:166,b:41},"37.64706":{r:168,g:166,b:39},"38.03922":{r:173,g:169,b:38},"38.43137":{r:179,g:169,b:36},"38.82353":{r:186,g:171,b:34},"39.21569":{r:194,g:172,b:33},"39.60784":{r:199,g:174,
b:32},40:{r:204,g:175,b:29},"40.39216":{r:212,g:178,b:25},"40.78431":{r:219,g:180,b:24},"41.17647":{r:224,g:181,b:22},"41.56863":{r:230,g:180,b:18},"41.96078":{r:237,g:181,b:14},"42.35294":{r:245,g:182,b:10},"42.7451":{r:250,g:185,b:5},"43.13725":{r:250,g:180,b:2},"43.52941":{r:247,g:174,b:2},"43.92157":{r:242,g:162,b:2},"44.31373":{r:240,g:161,b:2},"44.70588":{r:237,g:151,b:2},"45.09804":{r:232,g:144,b:2},"45.4902":{r:230,g:139,b:2},"45.88235":{r:227,g:133,b:2},"46.27451":{r:222,g:123,b:2},"46.66667":{r:219,
g:118,b:2},"47.05882":{r:217,g:113,b:2},"47.45098":{r:212,g:107,b:2},"47.84314":{r:209,g:99,b:2},"48.23529":{r:204,g:93,b:2},"48.62745":{r:201,g:88,b:2},"49.01961":{r:199,g:84,b:2},"49.41176":{r:194,g:79,b:2},"49.80392":{r:191,g:71,b:2},"50.19608":{r:189,g:67,b:2},"50.58824":{r:184,g:62,b:2},"50.98039":{r:181,g:59,b:2},"51.37255":{r:176,g:51,b:2},"51.76471":{r:173,g:48,b:2},"52.15686":{r:171,g:44,b:2},"52.54902":{r:166,g:40,b:2},"52.94118":{r:163,g:34,b:2},"53.33333":{r:161,g:33,b:2},"53.72549":{r:156,
g:27,b:2},"54.11765":{r:153,g:24,b:2},"54.5098":{r:148,g:21,b:1},"54.90196":{r:145,g:18,b:1},"55.29412":{r:143,g:13,b:1},"55.68627":{r:138,g:10,b:1},"56.07843":{r:135,g:8,b:1},"56.47059":{r:133,g:6,b:1},"56.86275":{r:128,g:1,b:1},"57.2549":{r:120,g:0,b:0},"57.64706":{r:120,g:5,b:1},"58.03922":{r:120,g:9,b:1},"58.43137":{r:120,g:12,b:2},"58.82353":{r:117,g:14,b:2},"59.21569":{r:117,g:14,b:2},"59.60784":{r:117,g:17,b:4},60:{r:117,g:19,b:4},"60.39216":{r:117,g:21,b:4},"60.78431":{r:117,g:22,b:5},"61.17647":{r:115,
g:23,b:5},"61.56863":{r:115,g:23,b:5},"61.96078":{r:115,g:25,b:5},"62.35294":{r:115,g:26,b:6},"62.7451":{r:115,g:28,b:6},"63.13725":{r:115,g:29,b:6},"63.52941":{r:112,g:30,b:7},"63.92157":{r:112,g:31,b:7},"64.31373":{r:112,g:31,b:7},"64.70588":{r:112,g:33,b:7},"65.09804":{r:112,g:34,b:8},"65.4902":{r:112,g:36,b:8},"65.88235":{r:112,g:36,b:8},"66.27451":{r:110,g:37,b:9},"66.66667":{r:110,g:37,b:9},"67.05882":{r:110,g:37,b:9},"67.45098":{r:110,g:40,b:10},"67.84314":{r:110,g:41,b:10},"68.23529":{r:110,
g:41,b:10},"68.62745":{r:107,g:41,b:11},"69.01961":{r:107,g:43,b:11},"69.41176":{r:107,g:43,b:11},"69.80392":{r:107,g:44,b:11},"70.19608":{r:107,g:45,b:12},"70.58824":{r:105,g:46,b:12},"70.98039":{r:105,g:46,b:13},"71.37255":{r:105,g:48,b:13},"71.76471":{r:105,g:48,b:14},"72.15686":{r:107,g:52,b:17},"72.54902":{r:110,g:55,b:21},"72.94118":{r:112,g:58,b:24},"73.33333":{r:115,g:61,b:28},"73.72549":{r:117,g:64,b:30},"74.11765":{r:120,g:67,b:35},"74.5098":{r:120,g:69,b:37},"74.90196":{r:122,g:72,b:40},
"75.29412":{r:125,g:76,b:45},"75.68627":{r:128,g:79,b:48},"76.07843":{r:130,g:82,b:52},"76.47059":{r:133,g:86,b:57},"76.86275":{r:133,g:88,b:60},"77.2549":{r:135,g:92,b:65},"77.64706":{r:138,g:94,b:67},"78.03922":{r:140,g:99,b:73},"78.43137":{r:143,g:102,b:77},"78.82353":{r:143,g:104,b:80},"79.21569":{r:145,g:109,b:86},"79.60784":{r:148,g:111,b:90},80:{r:148,g:114,b:95},"80.39216":{r:150,g:117,b:98},"80.78431":{r:153,g:122,b:104},"81.17647":{r:153,g:125,b:109},"81.56863":{r:156,g:129,b:114},"81.96078":{r:158,
g:133,b:119},"82.35294":{r:158,g:136,b:123},"82.7451":{r:161,g:140,b:129},"83.13725":{r:163,g:146,b:135},"83.52941":{r:163,g:148,b:139},"83.92157":{r:166,g:153,b:146},"84.31373":{r:166,g:156,b:151},"84.70588":{r:168,g:161,b:157},"85.09804":{r:168,g:163,b:160},"85.4902":{r:171,g:169,b:167},"85.88235":{r:171,g:171,b:171},"86.27451":{r:173,g:173,b:173},"86.66667":{r:176,g:176,b:176},"87.05882":{r:176,g:176,b:176},"87.45098":{r:179,g:179,b:179},"87.84314":{r:181,g:181,b:181},"88.23529":{r:184,g:184,b:184},
"88.62745":{r:186,g:186,b:186},"89.01961":{r:189,g:189,b:189},"89.41176":{r:191,g:191,b:191},"89.80392":{r:191,g:191,b:191},"90.19608":{r:194,g:194,b:194},"90.58824":{r:196,g:196,b:196},"90.98039":{r:199,g:199,b:199},"91.37255":{r:201,g:201,b:201},"91.76471":{r:204,g:204,b:204},"92.15686":{r:207,g:204,b:207},"92.54902":{r:209,g:207,b:209},"92.94118":{r:212,g:210,b:212},"93.33333":{r:214,g:212,b:214},"93.72549":{r:217,g:215,b:217},"94.11765":{r:217,g:215,b:217},"94.5098":{r:219,g:217,b:219},"94.90196":{r:222,
g:220,b:222},"95.29412":{r:224,g:222,b:224},"95.68627":{r:227,g:225,b:227},"96.07843":{r:230,g:227,b:230},"96.47059":{r:232,g:230,b:232},"96.86275":{r:235,g:232,b:235},"97.2549":{r:237,g:235,b:237},"97.64706":{r:240,g:237,b:240},"98.03922":{r:242,g:240,b:242},"98.43137":{r:245,g:242,b:245},"98.82353":{r:247,g:245,b:247},"99.21569":{r:250,g:247,b:250},"99.60784":{r:252,g:250,b:252},100:{r:255,g:252,b:255}}}];
McxPredefinedGradients.getGradientByName=function(a){for(var b=McxPredefinedGradients.getGradients(),c=0;c<b.length;c++){var d=b[c];if(d.name==a)return McxGradient.fromJSON(d)}return null};js.framework.ui.McxCommonControl.GroupBox={};js.framework.ui.McxCommonControl.GroupBox.McxGroupBox={};function McxGroupBox(a){mcx.base(this);this.base=this;this._contentElem=this._customCheckBoxBehaviourScope=this._customCheckBoxBehaviour=this._titleElem=this._rootElement=null;this._enableCheckBox=new McxCheckBox;this._blockerDiv=$("<div/>");this._title=a;this._mainSpan=new McxLayoutSpan(12);this._toolButtonContainer=$("<div/>");this.initialize()}mcx.inherits(McxGroupBox,McxUserControl);
McxGroupBox.prototype.initialize=function(){this._rootElement=new McxLayoutRow;this._rootElement.getContent().addClass("mcx-group-box");this._blockerDiv.css("position","absolute").css("top","0").css("bottom","0").css("left","0").css("right","0").css("z-index","1").css("background","rgba(255, 255, 255, 0.8)");this._titleElem=$('<span class="content-area-title">'+this._title+"</span>");this._contentElem=$('<div class="content-area"/>');this._enableCheckBox.getContent().css("z-index","1").css("position",
"absolute");this._blockerDiv.hide();this._enableCheckBox.checked(!0);this._enableCheckBox.hide();this._toolButtonContainer.addClass("mcx-group-box-tool-buttons").css("position","absolute").css("z-index",10).css("right",0).css("top",0);this._mainSpan.addContent(this._toolButtonContainer);this._mainSpan.addContent(this._enableCheckBox);this._mainSpan.addContent(this._titleElem);this._mainSpan.addContent(this._contentElem);this._contentElem.append(this._blockerDiv);this._enableCheckBox.onChangeHandler().addListener(function(){var a=
this._enableCheckBox.isChecked();this._customCheckBoxBehaviour?this._customCheckBoxBehaviour.apply(this._customCheckBoxBehaviourScope,[a]):this.setBlockerDivVisibility(a)},null,this);this._rootElement.addSpan(this._mainSpan)};McxGroupBox.prototype.setCheckBoxBehaviour=function(a,b){this._customCheckBoxBehaviour=a;this._customCheckBoxBehaviourScope=b||this};McxGroupBox.prototype.setCheckBoxState=function(a){this._enableCheckBox.checked(a)};
McxGroupBox.prototype.setBlockerDivVisibility=function(a){a?this._blockerDiv.hide():this._blockerDiv.show()};McxGroupBox.prototype.getContent=function(){return this._rootElement.getContent()};McxGroupBox.prototype.addContent=function(a){mcx.isInstanceOf(a,McxUserControl)?this.base.addChild(this._contentElem,a):this._contentElem.append(a)};McxGroupBox.prototype.setLocalizationKeyForTitle=function(a){this._titleElem.attr("data-localize",a)};McxGroupBox.prototype.compact=function(){this._rootElement.compact()};
McxGroupBox.prototype.setCanBeDisabled=function(a){a?this._enableCheckBox.show():this._enableCheckBox.hide()};McxGroupBox.prototype.setIsEnabled=function(a){this._enableCheckBox.checked(a);this.setBlockerDivVisibility(a)};McxGroupBox.prototype.getIsEnabled=function(){return this._enableCheckBox.isChecked()};McxGroupBox.prototype.getEnabledChangeHandler=function(){return this._enableCheckBox.onChangeHandler()};
McxGroupBox.prototype.addToolButton=function(a){a.getContent().css({padding:"2px 0",margin:"0 2px"});a.setButtonVisualType(McxButtonVisualType.linkButton);a.setButtonSize(McxButtonSize.small);this.base.addChild(this._toolButtonContainer,a)};McxGroupBox.prototype.setHeight=function(a){this._contentElem.css("height",a)};js.framework.ui.McxCommonControl.GroupedSelectView={};js.framework.ui.McxCommonControl.GroupedSelectView.McxGroupedSelectView={};function McxGroupedSelectView(a,b,c,d){mcx.base(this);this.base=this;this._rootElement=null;this._objectList=a;this._groupByGetter=b;this._textGetter=c;this._imageGetter=d;this._onItemClickHandler=new McxEventHandler;this.initialize()}mcx.inherits(McxGroupedSelectView,McxUserControl);
McxGroupedSelectView.prototype.initialize=function(){this._rootElement=$("<div/>");this._rootElement.groupedButtonList({objectList:this._objectList,imageField:this._imageGetter,textField:this._textGetter,groupBy:this._groupByGetter,onClick:$.proxy(this.onItemClick,this)})};McxGroupedSelectView.prototype.onItemClick=function(a){this._onItemClickHandler.dispatchOnSuccess(this,new McxGroupedViewItemSelectArgs(a))};McxGroupedSelectView.prototype.getItemClickHandler=function(){return this._onItemClickHandler};
McxGroupedSelectView.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.GroupedSelectView.McxGroupedViewItemSelectArgs={};function McxGroupedViewItemSelectArgs(a){mcx.base(this,[]);this._selectedItem=a}mcx.inherits(McxGroupedViewItemSelectArgs,McxEventArgs);McxGroupedViewItemSelectArgs.prototype.getSelectedItem=function(){return this._selectedItem};js.framework.ui.McxCommonControl.ImageButton={};js.framework.ui.McxCommonControl.ImageButton.McxImageButton={};function McxImageButton(a,b){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._imageUrl=a||"";this._text=b||null;this._height=this._width=32;this._onClickHanlder=new McxEventHandler;this._onMouseDownHandler=new McxEventHandler;this._button=$("<div/>").addClass("mcx-image-button");this._image=this._textElement=null;this._isSelected=this._isEnabled=!1;this.init()}
mcx.inherits(McxImageButton,McxUserControl);
McxImageButton.prototype.init=function(){var a=this,b=$("<div/>").css("display",""==McxPathFinder.getFullPath(this._imageUrl)?"none":"inline-block").css("background-image",'url("'+McxPathFinder.getFullPath(this._imageUrl)+'")').css("background-position","center").css("vertical-align","middle").css("background-repeat","no-repeat").width(this._width).height(this._height).appendTo(this._button);this._textElement=$("<div>").css("display","inline-block").css("vertical-align","middle").appendTo(this._button);
this._text&&this.setText(this._text);this._button.click(function(){a.onClick()}).mousedown(function(){a.onMouseDown()});this._image=b;$(this._rootElement).append(this._button);this.setEnabled(!0);this.setContentAlignment("center")};McxImageButton.prototype.setImageWidth=function(a){this._width=a;this._image.css("width",a)};McxImageButton.prototype.setImageHeight=function(a){this._height=a;this._image.css("height",a)};
McxImageButton.prototype.setImageClass=function(a){this._image.css("background","").css("display","inline-block");this._image.addClass(a)};McxImageButton.prototype.setContentAlignment=function(a){this._button.css("text-align",a)};McxImageButton.prototype.setEnabled=function(a){(this._isEnabled=a)?this._button.removeClass("disabled"):this._button.addClass("disabled")};McxImageButton.prototype.getEnabled=function(){return this._isEnabled};
McxImageButton.prototype.onClick=function(){this.getEnabled()&&this.onClickHandler().dispatchOnSuccess(this,null)};McxImageButton.prototype.onMouseDown=function(){this.getEnabled()&&this.onMouseDownHandler().dispatchOnSuccess(this,null)};
McxImageButton.prototype.setIsSelected=function(a){(this._isSelected=a)?this._button.css("background","#3996BE").css("color","white"):this._button.css("background","#fff").css("background","-moz-linear-gradient(left,  #fff 0%, #e5e5e5 100%)").css("background","-webkit-gradient(linear, left top, right top, color-stop(0%,#fff), color-stop(100%,#e5e5e5))").css("background","-webkit-linear-gradient(left,  #fff 0%,#e5e5e5 100%)").css("background","-o-linear-gradient(left,  #fff 0%,#e5e5e5 100%)").css("background",
"-ms-linear-gradient(left,  #fff 0%,#e5e5e5 100%)").css("background","linear-gradient(to right,  #fff 0%,#e5e5e5 100%)").css("color","black")};McxImageButton.prototype.getIsSelected=function(){return this._isSelected};McxImageButton.prototype.onClickHandler=function(){return this._onClickHanlder};McxImageButton.prototype.onMouseDownHandler=function(){return this._onMouseDownHandler};McxImageButton.prototype.setButtonWidth=function(a){this._button.css("width",a)};
McxImageButton.prototype.setButtonHeight=function(a){this._button.css("height",a)};McxImageButton.prototype.getContent=function(){return this._button};McxImageButton.prototype.setLocalizationKey=function(a){this._textElement.attr("data-localize",a)};McxImageButton.prototype.setText=function(a){this._text=a;this._textElement.text(a)};js.framework.ui.McxCommonControl.Label={};js.framework.ui.McxCommonControl.Label.McxLabelControl={};function McxLabelControl(){mcx.base(this);this.base=this;this._container=$("<div/>");this.localeText=this._label=null;this.init()}mcx.inherits(McxLabelControl,McxUserControl);McxLabelControl.prototype.init=function(){this._label=$('<label data-localize-for=""/>').appendTo(this._container)};McxLabelControl.prototype.setText=function(a){this.localeText=$("<span/>").html(a);this._label.html(this.localeText)};
McxLabelControl.prototype.getContent=function(){return this._container};McxLabelControl.prototype.setLocalizationKey=function(a){this.localeText.attr("data-localize",a)};McxLabelControl.prototype.createToolTip=function(a){this._label.css("cursor","help");this._label.html('<a href="#" class="toolTipLink" data-localize="'+a+'" data-localize-for="title" title="'+a+'">'+this._label[0].outerHTML+"</a>")};js.framework.ui.McxCommonControl.LabelFormatExpressionEditor={};js.framework.ui.McxCommonControl.LabelFormatExpressionEditor.McxLabelFormatExpressionEditor={};function McxLabelFormatExpressionEditor(a){mcx.base(this);this.base=this;this._rootElement=null;this._fieldList=a;this._isEnabled=!0;this._fieldSelectList=null;this._expressionTextBox=$("<textarea/>");this.initialize()}mcx.inherits(McxLabelFormatExpressionEditor,McxUserControl);
McxLabelFormatExpressionEditor.prototype.initialize=function(){var a=this;this._rootElement=new McxLayoutRow;this._fieldSelectList=$("<select/>").attr("size","5").css("width","100%").addClass("mcx-input fit");for(var b=0;b<this._fieldList.length;b++){var c=$("<option/>").val("["+this._fieldList[b]+"]").html(this._fieldList[b]);this._fieldSelectList.append(c)}this._expressionTextBox=$("<textarea/>").css("resize","none").css("width","96%").attr("rows","5").addClass("mcx-input fit");this._fieldSelectList.dblclick(function(){a._fieldSelectList.find("option:selected").each(function(){if(a._isEnabled){var b=
a._expressionTextBox[0].selectionStart,c=a._expressionTextBox.val(),f=$(this).val();a._expressionTextBox.val(c.substring(0,b)+f+c.substring(b));a._expressionTextBox[0].setSelectionRange(b+$(this).val().length,b+$(this).val().length);a._expressionTextBox.focus()}})});this._rootElement.createAndAddSpan(6,this._fieldSelectList);this._rootElement.createAndAddSpan(6,this._expressionTextBox)};McxLabelFormatExpressionEditor.prototype.getExpression=function(){return this._expressionTextBox.val().toString()};
McxLabelFormatExpressionEditor.prototype.setExpression=function(a){this._expressionTextBox.val(a)};McxLabelFormatExpressionEditor.prototype.setIsEnabled=function(a){(this._isEnabled=a)?(this._fieldSelectList.removeAttr("disabled"),this._expressionTextBox.removeAttr("disabled")):(this._fieldSelectList.attr("disabled","disabled"),this._expressionTextBox.attr("disabled","disabled"))};McxLabelFormatExpressionEditor.prototype.getIsEnabled=function(){return this._isEnabled};
McxLabelFormatExpressionEditor.prototype.getContent=function(){return this._rootElement.getContent()};McxLabelFormatExpressionEditor.prototype.clearSelection=function(){this._fieldSelectList.find("option:selected").remove()};js.framework.ui.McxCommonControl.LabelFormatSelector={};js.framework.ui.McxCommonControl.LabelFormatSelector.McxLabelFormatSelector={};function McxLabelFormatSelector(a){mcx.base(this);this.base=this;this._rootElement=null;this._fieldList=a;this._labelFormatExpressionEditor=null;this._labelFormatSelectBox=new McxSelectBox;this.initialize();this.bindEvents()}mcx.inherits(McxLabelFormatSelector,McxUserControl);
McxLabelFormatSelector.prototype.initialize=function(){this._rootElement=$("<div/>");this._labelFormatExpressionEditor=new McxLabelFormatExpressionEditor(this._fieldList);this._labelFormatExpressionEditor.setIsEnabled(!1);this._labelFormatSelectBox=new McxSelectBox;this._labelFormatSelectBox.setIsLocalizable(!0);this._labelFormatSelectBox.addCustomItem("McxCommonControl-mcxLayerPropertiesNone","None");for(var a=0;a<this._fieldList.length;a++)this._labelFormatSelectBox.addCustomItem(this._fieldList[a],
"["+this._fieldList[a]+"]");this._labelFormatSelectBox.addCustomItem("McxCommonControl-mcxLayerPropertiesExpression","Expression");a=new McxGroupBox("Format Expression");a.setLocalizationKeyForTitle("McxCommonControl-mcxLayerPropertiesFormatExpression");a.addContent(this._labelFormatExpressionEditor);a.getContent().find(".row-fluid").css("margin-bottom","0");var b=new McxGroupBox("Filed");b.setLocalizationKeyForTitle("McxCommonControl-mcxLayerPropertiesFiled");b.addContent(this._labelFormatSelectBox);
var c=new McxLayoutRow;c.createAndAddSpan(4,b);c.createAndAddSpan(8,a);this.base.addChild(this._rootElement,c)};
McxLabelFormatSelector.prototype.bindEvents=function(){this._labelFormatSelectBox.getOnSelectHandler().addListener(function(){"Expression"==this._labelFormatSelectBox.getSelectedValue()?this._labelFormatExpressionEditor.setIsEnabled(!0):(this._labelFormatExpressionEditor.setIsEnabled(!1),this._labelFormatExpressionEditor.setExpression(""),this._labelFormatExpressionEditor.clearSelection())},null,this)};
McxLabelFormatSelector.prototype.getFormat=function(){var a=this._labelFormatSelectBox.getSelectedValue();return"None"==a?null:"Expression"==a?this._labelFormatExpressionEditor.getExpression():a.toString()};
McxLabelFormatSelector.prototype.setFormat=function(a){a?-1<this._fieldList.indexOf(a.replace("[","").replace("]",""))?this._labelFormatSelectBox.setSelectedValue(a):(this._labelFormatSelectBox.setSelectedValue("Expression"),this._labelFormatExpressionEditor.setExpression(a),this._labelFormatExpressionEditor.setIsEnabled(!0)):this._labelFormatSelectBox.setSelectedValue(a||"None")};McxLabelFormatSelector.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.LayerComboBox={};js.framework.ui.McxCommonControl.LayerComboBox.McxLayerComboBox={};function McxLayerComboBox(a){mcx.base(this);this.base=this;this.appendToElement=a?$("#"+a):$("<div/>");this.layerCollection=null;this.layerArray=[];this._defaultValueArray=[];this._selectedItem=null;this.uniqueElementId=(new Date).getTime().toString();this.selectionChangeEventHandler=new McxEventHandler;this.width=170;this.setActiveLayer=!0;this._layerSelectBox=null}
mcx.inherits(McxLayerComboBox,McxUserControl);
McxLayerComboBox.prototype.initialize=function(){this._layerSelectBox=new McxSelectBox;this._layerSelectBox.setTextGetter("text");this._layerSelectBox.setValueGetter("value");this._layerSelectBox.setWidth(this.width);this._layerSelectBox.getContent().css("width",this.width).css("height","22px");$(this._layerSelectBox.getContent().find("select")[0]).css("padding","0");this._layerSelectBox.getOnSelectHandler().addListener(this.onSelectionChange,null,this);this.appendToElement.append(this._layerSelectBox.getContent())};
McxLayerComboBox.prototype.getSelectionChangeEventHandler=function(){return this.selectionChangeEventHandler};McxLayerComboBox.prototype.setLayerAsActiveLayer=function(a){this.setActiveLayer=a};McxLayerComboBox.prototype.setWidth=function(a){this.width=a};
McxLayerComboBox.prototype.onSelectionChange=function(){var a=this._layerSelectBox.getSelectedItem(),b=a.layer;mcx.isDefAndNotNull(b)?(this.setActiveLayer&&this.setSelectedLayer(b),this._selectedItem=b,this.selectionChangeEventHandler.dispatchOnSuccess(this,null),this.showSelectedItemIcon()):(a=a.object,this.setSelectedItem(b||a))};McxLayerComboBox.prototype.getSelectedLayer=function(){return mcx.isDefAndNotNull(this.layerCollection)?this.layerCollection.getActiveLayer():null};
McxLayerComboBox.prototype.setSelectedLayer=function(a){a&&(this.addLayerIfNotExist(a),this.layerCollection.setActiveLayer(a))};
McxLayerComboBox.prototype.refreshComboBox=function(){var a=[];if(mcx.isDefAndNotNull(this._layerSelectBox)){this._layerSelectBox.getOnSelectHandler().removeListener(this.onSelectionChange);this.layerArray=this.layerCollection.toLayerArray();for(var b=0;b<this._defaultValueArray.length;b++)a.push(this._defaultValueArray[b]);for(var b=null,c=0;c<this.layerArray.length;c++){var d=this.layerArray[c],e=this.setActiveLayer&&this.checkIfSelected(d);a.push({value:this.getUniqueKeyOfLayer(d),text:d.getAlias(),
layer:d});e&&(b=this.getUniqueKeyOfLayer(d))}this._layerSelectBox.clear();this._layerSelectBox.addItemRange(a);b&&this._layerSelectBox.setSelectedValue(b);this._layerSelectBox.getOnSelectHandler().addListener(this.onSelectionChange,null,this)}};
McxLayerComboBox.prototype.setLayerCollection=function(a){var b=this,c=function(a){b.refreshComboBox()},d=function(){b.refreshComboBox()};this.showSelectedItemIcon();mcx.isDefAndNotNull(this.layerCollection)&&(this.layerCollection.onLayerAdded().removeListener(c),this.layerCollection.onLayerRemoved().removeListener(c),this.layerCollection.onActiveLayerChanged().removeListener(d));this.layerCollection=a;this.layerCollection.onLayerAdded().addListener(c,null,this);this.layerCollection.onLayerRemoved().addListener(c,
null,this);this.layerCollection.onActiveLayerChanged().addListener(d,null,this);a=this.layerCollection.getActiveLayer();this.setSelectedLayer(a);this.refreshComboBox()};McxLayerComboBox.prototype.addLayerIfNotExist=function(a){for(var b=this.layerCollection.toLayerArray(),c=0;c<b.length;c++)if(this.getUniqueKeyOfLayer(b[c])==this.getUniqueKeyOfLayer(a))return;this.layerCollection.add(a)};McxLayerComboBox.prototype.getUniqueKeyOfLayer=function(a){return a.getClassId()};
McxLayerComboBox.prototype.checkIfSelected=function(a){return null!=this.getSelectedLayer()&&this.getUniqueKeyOfLayer(a)==this.getUniqueKeyOfLayer(this.getSelectedLayer())};
McxLayerComboBox.prototype.getImgCssClassForLayer=function(a){switch(a.getGeometryType()){case McxGeometryType.GeometryCollection:return"img-geometryCollection16";case McxGeometryType.LinearRing:return"img-linearRing16";case McxGeometryType.LineString:return"img-lineString16";case McxGeometryType.MultiLineString:return"img-multiLineString16";case McxGeometryType.MultiPoint:return"img-multiPoint16";case McxGeometryType.MultiPolygon:return"img-multiPolygon16";case McxGeometryType.Polygon:return"img-polygon16";
case McxGeometryType.Point:return"img-dot16";case McxGeometryType.Unknown:return"img-unknown16";default:return"img-none16"}};McxLayerComboBox.prototype.showSelectedItemIcon=function(){};McxLayerComboBox.prototype.addData=function(a,b,c){this._defaultValueArray.push({text:c[a],value:c[b],object:c})};McxLayerComboBox.prototype.setSelectedItem=function(a){this._selectedItem=a;this.getSelectionChangeEventHandler().dispatchOnSuccess(this,null)};McxLayerComboBox.prototype.selectItem=function(a){this._layerSelectBox.setSelectedValue(a.value)};
McxLayerComboBox.prototype.getSelectedItem=function(){return this._selectedItem};McxLayerComboBox.prototype.clearValue=function(){this._layerSelectBox.clear()};McxLayerComboBox.prototype.getContent=function(){return this.appendToElement};js.framework.ui.McxCommonControl.LayerFieldSelector={};js.framework.ui.McxCommonControl.LayerFieldSelector.McxLayerFieldSelector={};function McxLayerFieldSelector(a){mcx.base(this);this.base=this;this._fieldFilter=this._rootElement=null;this._layerSelectorHidden=a?a:!1;this._layerSelectBox=new McxSelectBox;this._layerFieldSelectBox=new McxSelectBox;this._fieldSelectionMode=McxSelectionMode.required;this._layers=null;this.initialize();this.bindEvents()}mcx.inherits(McxLayerFieldSelector,McxUserControl);
McxLayerFieldSelector.prototype.setFieldSelectionMode=function(a){this._fieldSelectionMode=a};
McxLayerFieldSelector.prototype.initialize=function(){this._rootElement=$("<div/>");this._fieldFilter=function(){return!0};this._layerSelectBox=new McxSelectBox;this._layerSelectBox.setTextGetter("getName");this._layerSelectBox.setValueGetter("getName");this._layerFieldSelectBox=new McxSelectBox;this._layerFieldSelectBox.setTextGetter("getFieldName");this._layerFieldSelectBox.setValueGetter("getFieldName");var a=new McxLabeledEditor("Layer",this._layerSelectBox);a.setLabelLocalizationKey("McxCommonControl-mcxLayerFieldSelectorLayer");
this._layerSelectorHidden||this.base.addChild(this._rootElement,a);a=new McxLabeledEditor("Field",this._layerFieldSelectBox);a.setLabelLocalizationKey("McxCommonControl-mcxLayerFieldSelectorField");this.base.addChild(this._rootElement,a)};McxLayerFieldSelector.prototype.bindEvents=function(){this._layerSelectBox.getOnSelectHandler().addListener(function(){var a=this._layerSelectBox.getSelectedItem();this.fillFieldSelectBox(a)},null,this)};
McxLayerFieldSelector.prototype.setLayers=function(a){this._layers=a;this._layerSelectBox.clear();this._layerSelectBox.addItemRange(a);this.getLayerChangeHandler().dispatchOnSuccess(this,null);this.fillFieldSelectBox(a[0])};McxLayerFieldSelector.prototype.setSelectedLayer=function(a){this._layerSelectBox.setSelectedItem(a)};McxLayerFieldSelector.prototype.setSelectedFieldByName=function(a){this._layerFieldSelectBox.setSelectedValue(a)};
McxLayerFieldSelector.prototype.fillFieldSelectBox=function(a){this._layerFieldSelectBox.clear();if(0!=mcx.isDefAndNotNull(a)){var b=new McxFieldDefinition;b.setFieldName("...");b.isEmptyItem=!0;this._fieldSelectionMode==McxSelectionMode.optional&&this._layerFieldSelectBox.addItem(b);for(var b=a.getSchema().getFieldCount(),c=0;c<b;c++){var d=a.getSchema().getField(c);this._fieldFilter(d)&&!d.isIgnored()&&this._layerFieldSelectBox.addItem(d)}this.getFieldChangeHandler().dispatchOnSuccess(this,null)}};
McxLayerFieldSelector.prototype.setFieldFilter=function(a){this._fieldFilter=a};McxLayerFieldSelector.prototype.getLayerChangeHandler=function(){return this._layerSelectBox.getOnSelectHandler()};McxLayerFieldSelector.prototype.getFieldChangeHandler=function(){return this._layerFieldSelectBox.getOnSelectHandler()};McxLayerFieldSelector.prototype.getField=function(){var a=this._layerFieldSelectBox.getSelectedItem();a&&a.isEmptyItem&&(a=null);return a};McxLayerFieldSelector.prototype.getLayer=function(){return this._layerSelectBox.getSelectedItem()};
McxLayerFieldSelector.prototype.getContent=function(){return this._rootElement};McxLayerFieldSelector.prototype.creationComplete=function(){this.base.localize()};McxLayerFieldSelector.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};js.framework.ui.McxCommonControl.LayerFieldSelector.McxSelectionMode={};var McxSelectionMode={required:0,optional:1};js.framework.ui.McxCommonControl.LayerListBox={};js.framework.ui.McxCommonControl.LayerListBox.McxLayerListCompleteEventArgs={};function McxLayerListCompleteEventArgs(a,b){mcx.base(this,b);this._layerArray=a}mcx.inherits(McxLayerListCompleteEventArgs,McxEventArgs);McxLayerListCompleteEventArgs.prototype.getLayerArray=function(){return this._layerArray};js.framework.ui.McxCommonControl.LayerListBox.McxLayerListSelectionEventArgs={};function McxLayerListSelectionEventArgs(a,b){mcx.base(this,b);this._layerArray=a}mcx.inherits(McxLayerListSelectionEventArgs,McxEventArgs);McxLayerListSelectionEventArgs.prototype.getLayerArray=function(){return this._layerArray};js.framework.ui.McxCommonControl.LayerListBox.McxLayerListUserControl={};
function McxLayerListUserControl(a){mcx.base(this);this._loadedLayerCount=0;this.base=this;this._cssSelectorList="div.mcx-layer-list";this._cssSelectorItem="div.mcx-layer-list-item";this._cssClassItemSelected="mcx-layer-list-item-selected";this._cssSelectorItemSelected="div.mcx-layer-list-item-selected";this._cssClassSpanLarge="item-text-left";this._cssClassSpanSmall="item-text-right";this._dataKeyLayer="layer";this._rootElement=$("<div/>");this.layerArray=a;this.selectionChangeEventHandler=new McxEventHandler;
this.listCompleteEventHandler=new McxEventHandler;this._cssClassItem="mcx-layer-list-item";this._loadingBar=null;this.append()}mcx.inherits(McxLayerListUserControl,McxUserControl);McxLayerListUserControl.prototype.getFeatureCountOnFailed=function(){this._loadedLayerCount++;this._loadedLayerCount==this.layerArray.length&&this._loadingBar.detach()};
McxLayerListUserControl.prototype.appendLayerItem=function(a){var b=this.getSelectListControl(),c=this,d=a.getAlias(),e=$("<div/>").addClass(this._cssClassItem),d=$("<span/>").addClass(this._cssClassSpanLarge).append(d);e.append(d);e.data(this._dataKeyLayer,a);e.click(function(a){var b=$(this).parents(this._cssSelectorList);a.ctrlKey?$(this).toggleClass(c._cssClassItemSelected):(b.find(c._cssSelectorItemSelected).removeClass(c._cssClassItemSelected),$(this).addClass(c._cssClassItemSelected));a=c.getSelectedLayers();
a=new McxLayerListSelectionEventArgs(a);c.selectionChangeEventHandler.dispatchOnSuccess(c,a)});b.append(e);if(this.layerArray.length==this.layerArray.indexOf(a)+1){var f=new McxLayerListCompleteEventArgs(this.layerArray);c.show();setTimeout(function(){c.listCompleteEventHandler.dispatchOnSuccess(this,f)},200)}};
McxLayerListUserControl.prototype.append=function(){var a=this.layerArray,b=$("<div/>").attr("id","mcxLayerList").addClass("mcx-layer-list").append($("<div/>").addClass("mcx-layer-list-content"));this._rootElement.append(b);0!=a.length&&(this._loadingBar=$("<div/>").html("&nbsp;").addClass("mcx-layer-list-loading"),this._rootElement.append(this._loadingBar));this.hide();for(b=0;b<a.length;b++)this.appendLayerItem(a[b]),this._loadedLayerCount++,this._loadedLayerCount==this.layerArray.length&&this._loadingBar.detach()};
McxLayerListUserControl.prototype.getSelectionChangeEventHandler=function(){return this.selectionChangeEventHandler};McxLayerListUserControl.prototype.getListCompleteEventHandler=function(){return this.listCompleteEventHandler};McxLayerListUserControl.prototype.getSelectedLayers=function(){var a=[],b=this;this.getSelectListControl().find(this._cssSelectorItem).each(function(c,d){var e=$(d);1==e.hasClass(b._cssClassItemSelected)&&(e=e.data(b._dataKeyLayer),a.push(e))});return a};
McxLayerListUserControl.prototype.getSelectListControl=function(){return $(this._rootElement).find(this._cssSelectorList)};McxLayerListUserControl.prototype.slideToggle=function(){this.getSelectListControl().slideToggle("fast")};McxLayerListUserControl.prototype.slideDown=function(){this.getSelectListControl().slideDown("fast")};McxLayerListUserControl.prototype.slideUp=function(){this.getSelectListControl().slideUp("fast")};McxLayerListUserControl.prototype.hide=function(){this.getSelectListControl().hide("fast")};
McxLayerListUserControl.prototype.show=function(){this.getSelectListControl().show("fast")};McxLayerListUserControl.prototype.getHeight=function(){return this.getSelectListControl().outerHeight()};McxLayerListUserControl.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.LayerManager={};js.framework.ui.McxCommonControl.LayerManager.IMcxLayerManager={};function IMcxLayerManager(){}IMcxLayerManager.prototype.setMap=function(a){};IMcxLayerManager.prototype.getLayerItems=function(a){};IMcxLayerManager.prototype.centralizeLayerManager=function(){};IMcxLayerManager.prototype.setMapInteractionFactory=function(a){};IMcxLayerManager.prototype.clear=function(){};IMcxLayerManager.prototype.getContent=function(){};js.framework.ui.McxCommonControl.LayerManager.McxLayerManager={};
function McxLayerManager(){mcx.base(this);this.base=this;this._map=null;this._visibilityChangeHandler=new McxEventHandler;this._selectedGroupItem=this._selectedItem=null;this._layerListItems=[];this._layerManagerElem=null;this._isOpenVertical=!1;this._mapInetractionFactory=this._layerManagerToolBarMagnetButton=this._layerManagerToolBarLabelButton=this._layerManagerToolBarSelectableButton=this._layerManagerToolBarEditableButton=this._layerManagerToolBarVisibleButton=this._layerManagerToolBarZoomButton=
this._layerManagerToolBarMoveBottomButton=this._layerManagerToolBarMoveTopButton=this._layerManagerToolBarMoveDownButton=this._layerManagerToolBarMoveUpButton=this._layerManagerToolBarFeatureGridButton=this._layerManagerToolBarRemoveButton=this._layerManagerListElem=this._layerManagerArrowRight=this._layerManagerArrowDown=this._layerItemOrderTimeoutHandle=null;this._isSetLayersComplete=!0;this.initialize();this.bindEvents()}mcx.inherits(McxLayerManager,McxUserControl);
McxLayerManager.prototype.initialize=function(){var a=$("<div/>").addClass("mcx-layer-manager"),b=$("<div/>").addClass("mcx-layer-manager-toolbar"),c=$("<div/>").attr("data-localize","McxCommonControl-layerManagerFeatureGridTitle").attr("data-localize-for","title").addClass("mcx-layer-manager-tool mcx-layer-manager-tool-feature-grid"),d=$("<div/>").attr("data-localize","McxCommonControl-layerManagerRemoveButtonTitle").attr("data-localize-for","title").addClass("mcx-layer-manager-tool mcx-layer-manager-tool-remove"),
e=$("<div/>").attr("data-localize","McxCommonControl-layerManagerMoveUpButtonTitle").attr("data-localize-for","title").addClass("mcx-layer-manager-tool mcx-layer-manager-tool-move-up"),f=$("<div/>").attr("data-localize","McxCommonControl-layerManagerMoveDownButtonTitle").attr("data-localize-for","title").addClass("mcx-layer-manager-tool mcx-layer-manager-tool-move-down"),g=$("<div/>").attr("data-localize","McxCommonControl-layerManagerMoveTopButtonTitle").attr("data-localize-for","title").addClass("mcx-layer-manager-tool mcx-layer-manager-tool-move-top"),
h=$("<div/>").attr("data-localize","McxCommonControl-layerManagerMoveBottomButtonTitle").attr("data-localize-for","title").addClass("mcx-layer-manager-tool mcx-layer-manager-tool-move-bottom"),k=$("<div/>").attr("data-localize","McxCommonControl-layerManagerZoomButtonTitle").attr("data-localize-for","title").addClass("mcx-layer-manager-tool mcx-layer-manager-tool-zoom"),m=$("<div/>").attr("data-localize","McxCommonControl-layerManagerVisibleButtonTitle").attr("data-localize-for","title").css("display",
"inline-block").addClass("mcx-layer-manager-tool mcx-layer-manager-tool-eye"),n=$("<div/>").attr("data-localize","McxCommonControl-layerManagerDrawButtonTitle").attr("data-localize-for","title").addClass("mcx-layer-manager-tool mcx-layer-manager-tool-draw").css("display","inline-block").addClass("section2"),p=$("<div/>").attr("data-localize","McxCommonControl-layerManagerSelectButtonTitle").attr("data-localize-for","title").addClass("mcx-layer-manager-tool mcx-layer-manager-tool-select").css("display",
"inline-block").addClass("section2"),q=$("<div/>").attr("data-localize","McxCommonControl-layerManagerToolButtonTitle").attr("data-localize-for","title").addClass("mcx-layer-manager-tool mcx-layer-manager-tool-label").css("display","inline-block").addClass("section2"),r=$("<div/>").attr("data-localize","McxCommonControl-layerManagerMagnetButtonTitle").attr("data-localize-for","title").addClass("mcx-layer-manager-tool mcx-layer-manager-tool-magnet").css("display","inline-block").css("margin-right",
"17px").addClass("hidden-phone").addClass("section2"),t=$("<div/>").attr("data-localize","McxCommonControl-layerManagerSelectionCountButtonTitle").attr("data-localize-for","title").addClass("mcx-layer-manager-tool mcx-layer-property-selectioncount mcx-layer-property-addgroup").css("display","inline-block").css("float","right").css("margin-right","32px").addClass("hidden-phone").addClass("section2"),u=$("<div/>").addClass("mcx-layer-manager-list"),v=$("<div/>").addClass("mcx-layer-manager-arrow-down"),
w=$("<div/>").addClass("mcx-layer-manager-arrow-right"),x=$("<div/>").addClass("mcx-layer-manager-toolbar-left-container"),y=$("<div/>").addClass("hidden-phone").addClass("mcx-layer-manager-toolbar-right-container");x.append(m);x.append(e);x.append(f);x.append(g);x.append(h);x.append(k);x.append(d);x.append(c);y.append(n);y.append(p);y.append(q);y.append(r);y.append(t);b.append(x);b.append(y);a.append(b);a.append(u);a.append(v);this._layerManagerElem=$("<div/>");this._layerManagerArrowDown=v;this._layerManagerArrowRight=
w;this._layerManagerElem=a;this._layerManagerListElem=u;this._layerManagerToolBarRemoveButton=d;this._layerManagerToolBarFeatureGridButton=c;this._layerManagerToolBarMoveUpButton=e;this._layerManagerToolBarMoveDownButton=f;this._layerManagerToolBarMoveTopButton=g;this._layerManagerToolBarMoveBottomButton=h;this._layerManagerToolBarZoomButton=k;this._layerManagerToolBarVisibleButton=m;this._layerManagerToolBarEditableButton=n;this._layerManagerToolBarSelectableButton=p;this._layerManagerToolBarLabelButton=
q;this._layerManagerToolBarMagnetButton=r;this._mapInetractionFactory=null;this._layerManagerElem=a;t.click($.proxy(function(){var a=this.createGroupItem(),b=this.base.getLocaleValue("McxCommonControl-layerManagerSelectionCountButtonTitle");a.setGroupName(b);a.enableEditMode()},this))};
McxLayerManager.prototype.bindEvents=function(){var a=this;if(McxMobile.isMobile.any()){var b={prevent_default:!0,scale_threshold:1,drag_min_distance:2,css_hacks:!1,stop_browser_behavior:!0,transform_always_block:!0};McxMobile.isMobile.iOS()&&(b.prevent_default=!1);Hammer(this._layerManagerListElem[0],b).on(McxGestureEventType.dragend,function(b){b=b.gesture;var d=b.velocityX;"left"==b.direction&&.3<d&&a.slideOff()})}this._layerManagerArrowDown.mousedown(function(){a.togglePanelVertical()});this._layerManagerArrowRight.click(function(){a.togglePanelHorizontal()});
this._layerManagerToolBarRemoveButton.click(function(){a.removeSelection()});this._layerManagerToolBarFeatureGridButton.click(function(){a.displayFeaturesOfSelectedLayerInGrid()});this._layerManagerToolBarMoveUpButton.click(function(){a.moveUpSelectedLayer()});this._layerManagerToolBarMoveDownButton.click(function(){a.moveDownSelectedLayer()});this._layerManagerToolBarMoveTopButton.click(function(){a.moveTopSelectedLayer()});this._layerManagerToolBarMoveBottomButton.click(function(){a.moveBottomSelectedLayer()});
this._layerManagerToolBarZoomButton.click(function(){a.zoomToSelectedLayer()});this._layerManagerToolBarVisibleButton.click(function(){a.toggleVisible()});this._layerManagerToolBarEditableButton.click(function(){a.toggleEditable()});this._layerManagerToolBarSelectableButton.click(function(){a.toggleSelectable()});this._layerManagerToolBarLabelButton.click(function(){a.toggleShowLabels()});this._layerManagerToolBarMagnetButton.click(function(){a.toggleSnap()});this.base.enableDropping(this._layerManagerListElem);
this.base.onDrop().addListener(function(a){var b=a.getDragItem();mcx.isInstanceOf(b,McxLayerManagerItem)?b.getLayer().setGroupName(""):mcx.isInstanceOf(b,McxLayerManagerGroupItem)&&b.setGroupName(b.getShortGroupName());a.stopPropagation();this.base.addChild(this._layerManagerListElem,b)},null,this)};
McxLayerManager.prototype.setMap=function(a){if(this._map!=a){this._map&&(this._map.getLayers().onLayerAdded().removeListener(this.onLayerAdd),this._map.getLayers().onLayerRemoved().removeListener(this.onLayerRemove),this._map.getLayers().getLayerOrderChangeHandler().removeListener(this.onLayerOrderChange));this.clear();this._map=a;var b=this._map.getLayers();this.setLayers(a.getLayers().toLayerArray());b.onLayerAdded().removeListener(this.onLayerAdd);b.onLayerAdded().addListener(this.onLayerAdd,
null,this);b.getLayerOrderChangeHandler().removeListener(this.onLayerOrderChange);b.getLayerOrderChangeHandler().addListener(this.onLayerOrderChange,null,this);b.onLayerRemoved().removeListener(this.onLayerRemove);b.onLayerRemoved().addListener(this.onLayerRemove,null,this);this.updateLayout()}};McxLayerManager.prototype.onLayerOrderChange=function(){};
McxLayerManager.prototype.onLayerRemove=function(a){for(var b=this.base.getInnerChildrenOfType(McxLayerManagerItem),c=0;c<b.length;c++){var d=b[c];d.getLayer()==a.getLayer()&&d.remove()}this._layerItemOrderTimeoutHandle&&clearTimeout(this._layerItemOrderTimeoutHandle);this._layerItemOrderTimeoutHandle=setTimeout(mcx.proxy(this.orderLayerItemsByLayerIndex,this),250);this.updateLayout()};
McxLayerManager.prototype.onLayerAdd=function(a){this.addLayer(a.getLayer());this._layerItemOrderTimeoutHandle&&clearTimeout(this._layerItemOrderTimeoutHandle);this._layerItemOrderTimeoutHandle=setTimeout(mcx.proxy(this.orderLayerItemsByLayerIndex,this),250);this.updateLayout()};
McxLayerManager.prototype.updateLayout=function(){var a=Math.max.apply(null,$(".mcx-layer-property-selectioncount").map(function(){return $(this).width()}).get());$(".mcx-layer-property-selectioncount").each(function(b,c){var d=a-$(c).width();$(c).css("margin-left",d/2);$(c).css("margin-right",d/2)})};McxLayerManager.prototype.togglePanelHorizontal=function(){};McxLayerManager.prototype.togglePanelVertical=function(){this._layerManagerElem.is(":animated")||(this._isOpenVertical?this.slideOff():this.slideOn())};
McxLayerManager.prototype.getVisibilityChangeHandler=function(){return this._visibilityChangeHandler};McxLayerManager.prototype.getIsVisible=function(){return this._layerManagerElem.hasClass("slide-on")};McxLayerManager.prototype.removeLayerItem=function(a){$("#"+a.getLayer().getUniqueId()).remove();a.getContent().detach();a.getLayer().getSelectableChangedEventHandler().removeListener(this.onSelectableChanged);this._map.getLayers().remove(a.getLayer());this._map.getRenderer().paintLabels()};
McxLayerManager.prototype.removeSelection=function(){if(this._selectedItem){this.removeLayerItem(this._selectedItem);this._selectedItem.getLayer();var a=this._layerListItems.indexOf(this._selectedItem);this._layerListItems.splice(a,1);this._selectedItem=null}else this._selectedGroupItem&&(this._selectedGroupItem.removeLayers(),this._selectedGroupItem.detach(),this._selectedGroupItem=null);this._layerManagerElem.removeClass("state-item-open")};McxLayerManager.prototype.getSelectedJqElements=function(){return this._layerManagerListElem.find(".mcx-layer-manager-group-item.selected, .mcx-layer-manager-list-item.selected")};
McxLayerManager.prototype.moveUpSelectedLayer=function(){var a=this.getSelectedJqElements();if(0<a.length){var b=a.prev();0<b.length&&a.detach().insertBefore(b);this.updateLayerOrders()}};McxLayerManager.prototype.moveDownSelectedLayer=function(){var a=this.getSelectedJqElements();if(0<a.length){var b=a.next();0<b.length&&a.detach().insertAfter(b);this.updateLayerOrders()}};
McxLayerManager.prototype.moveTopSelectedLayer=function(){var a=this.getSelectedJqElements();if(0<a.length){var b=a.parent().children().first();0<b.length&&0==b.is(a)&&a.detach().insertBefore(b);this.updateLayerOrders()}};McxLayerManager.prototype.moveBottomSelectedLayer=function(){var a=this.getSelectedJqElements();if(0<a.length){var b=a.parent().children().last();0<b.length&&0==b.is(a)&&a.detach().insertAfter(b);this.updateLayerOrders()}};
McxLayerManager.prototype.zoomToSelectedLayer=function(){this._selectedItem&&this._mapInetractionFactory&&this._mapInetractionFactory.createZoomLayerAction(this._selectedItem.getLayer(),.8).execute(this._map)};
McxLayerManager.prototype.toggleVisible=function(){var a=$(".mcx-layer-manager-list .mcx-layer-property-visible:not(.disabled)").length<$(".mcx-layer-manager-list .mcx-layer-property-visible.disabled").length;if(this._layerListItems)for(var b=0;b<this._layerListItems.length;b++)this._layerListItems[b].setVisible(a);a?$(".mcx-layer-manager-list .mcx-layer-manager-group-item-tool-bar .mcx-layer-property-visible").removeClass("disabled"):$(".mcx-layer-manager-list .mcx-layer-manager-group-item-tool-bar .mcx-layer-property-visible").addClass("disabled")};
McxLayerManager.prototype.toggleEditable=function(){var a=$(".mcx-layer-manager-list .edit-enabled .mcx-layer-property-editable:not(.disabled)").length<$(".mcx-layer-manager-list .edit-enabled .mcx-layer-property-editable.disabled").length;if(this._layerListItems)for(var b=0;b<this._layerListItems.length;b++)this._layerListItems[b].setEditable(a);a?$(".mcx-layer-manager-list .mcx-layer-manager-group-item-tool-bar .mcx-layer-property-editable").removeClass("disabled"):$(".mcx-layer-manager-list .mcx-layer-manager-group-item-tool-bar .mcx-layer-property-editable").addClass("disabled")};
McxLayerManager.prototype.toggleSelectable=function(){var a=$(".mcx-layer-manager-list .select-enabled .mcx-layer-property-selectable:not(.disabled)").length<$(".mcx-layer-manager-list .select-enabled  .mcx-layer-property-selectable.disabled").length;if(this._layerListItems)for(var b=0;b<this._layerListItems.length;b++)this._layerListItems[b].setSelectable(a);a?$(".mcx-layer-manager-list .mcx-layer-manager-group-item-tool-bar .mcx-layer-property-selectable").removeClass("disabled"):$(".mcx-layer-manager-list .mcx-layer-manager-group-item-tool-bar .mcx-layer-property-selectable").addClass("disabled")};
McxLayerManager.prototype.toggleShowLabels=function(){var a=$(".mcx-layer-manager-list .label-enabled .mcx-layer-property-label:not(.disabled)").length<$(".mcx-layer-manager-list .label-enabled .mcx-layer-property-label.disabled").length;if(this._layerListItems)for(var b=0;b<this._layerListItems.length;b++)this._layerListItems[b].setShowLabels(a,!0);this._map.getRenderer().paintLabels();a?$(".mcx-layer-manager-list .mcx-layer-manager-group-item-tool-bar .mcx-layer-property-label").removeClass("disabled"):
$(".mcx-layer-manager-list .mcx-layer-manager-group-item-tool-bar .mcx-layer-property-label").addClass("disabled")};
McxLayerManager.prototype.toggleSnap=function(){var a=$(".mcx-layer-manager-list .snap-enabled .mcx-layer-property-magnet:not(.disabled)").length<$(".mcx-layer-manager-list .snap-enabled .mcx-layer-property-magnet.disabled").length;if(this._layerListItems)for(var b=0;b<this._layerListItems.length;b++)this._layerListItems[b].setSnappable(a);a?$(".mcx-layer-manager-list .mcx-layer-manager-group-item-tool-bar .mcx-layer-property-magnet").removeClass("disabled"):$(".mcx-layer-manager-list .mcx-layer-manager-group-item-tool-bar .mcx-layer-property-magnet").addClass("disabled")};
McxLayerManager.prototype.orderLayerItemsByLayerIndex=function(){if(this._isSetLayersComplete){var a=this.getChildrenOfType(McxLayerManagerItem).concat(this.getChildrenOfType(McxLayerManagerGroupItem));if(!(1>=a.length)){for(var b=a.length-1;0<=b;b--)for(var c=1;c<=b;c++)if(this.getItemOrder(a[c-1])>this.getItemOrder(a[c])){var d=a[c-1];a[c-1]=a[c];a[c]=d}for(b=0;b<a.length;b++)a[b]&&(this._layerManagerListElem.prepend(a[b].getContent()),this._layerListItems[b]=a[b]);for(b=0;b<a.length;b++)a[b].getLayer()}}};
McxLayerManager.prototype.getItemOrder=function(a){return mcx.isInstanceOf(a,McxLayerManagerItem)?a.getLayer().getOrder():a.getTopLayerIndex()};McxLayerManager.prototype.onSelectableChanged=function(){var a=this.getLayer().isSelectable();this.setSelectable(a)};
McxLayerManager.prototype.addLayer=function(a){var b=this,c=null;0==mcx.isDefAndNotNull(this._layerListItems)&&(this._layerListItems=[]);var d=new McxLayerManagerItem(a,this._map);this._layerListItems.push(d);a.getSelectableChangedEventHandler().addListener(this.onSelectableChanged,null,d);(a=d.getLayer().getGroupName())&&""!=a?(c=this.getGroupByName(d.getLayer().getGroupName()),c.addLayerItem(d)):this.base.addChild(this._layerManagerListElem,d,McxUserControlAddMethod.prepend);this.centralizeLayerManager();
d.onDrop().addListener(function(a){var c=a.getDragItem();mcx.isInstanceOf(c,McxLayerManagerItem)&&b.mergeLayers(this,c);a.stopPropagation()},null,d);d.onSelect().addListener(function(){b._selectedItem=this;b._selectedGroupItem=null;b.getSelectedJqElements().removeClass("selected");b._selectedItem.setIsSelected(!0)},null,d);d.onTogglePropertiesPanel().addListener(function(){this.centralizeLayerManager()},null,this);d.localize()};
McxLayerManager.prototype.mergeLayers=function(a,b){var c=a.getLayer().getGroupName();if(!(2<=c.split("/").length)){var d=this.createGroupItem();d.setGroupName(b.getLayer().getName()+" - "+a.getLayer().getName());d.enableEditMode();d.getContent().insertBefore(a.getContent());d.addLayerItem(a);d.addLayerItem(b);d.expand();""!=c&&this.getGroupByName(c).addLayerItem(d)}};McxLayerManager.prototype.clear=function(){this._map=null;this.detachAllChildren()};
McxLayerManager.prototype.setLayers=function(a){this._isSetLayersComplete=!1;this._layerListItems=[];this.detachAllChildren();this._isSetLayersComplete=!1;for(var b in a.reverse())this.addLayer(a[b]);this._isSetLayersComplete=!0;this.orderLayerItemsByLayerIndex();this.centralizeLayerManager();this.updateLayout()};McxLayerManager.prototype.getLayerItems=function(a){return this._layerListItems?this._layerListItems:null};
McxLayerManager.prototype.centralizeLayerManager=function(){this._layerManagerElem.addClass("fit");0<this._layerManagerElem.find(".mcx-layer-manager-list-item.state-open").length?this._layerManagerElem.addClass("state-item-open"):this._layerManagerElem.removeClass("state-item-open")};McxLayerManager.prototype.setMapInteractionFactory=function(a){this._mapInetractionFactory=a};
McxLayerManager.prototype.slideOff=function(){this._isOpenVertical=!1;this._layerManagerElem.removeClass("slide-on");this.getVisibilityChangeHandler().dispatchOnSuccess(this,null)};McxLayerManager.prototype.slideOn=function(){this._isOpenVertical=!0;this._layerManagerElem.addClass("slide-on");this.getVisibilityChangeHandler().dispatchOnSuccess(this,null)};McxLayerManager.prototype.show=function(){this._layerManagerElem.show()};McxLayerManager.prototype.hide=function(){this._layerManagerElem.hide()};
McxLayerManager.prototype.createGroupItem=function(){var a=this,b=new McxLayerManagerGroupItem(this._map.getLayers());b.onItemDrop().addListener(this.updateLayerOrders,null,this);this.base.addChild(this._layerManagerListElem,b);b.onToggleExpand().addListener(this.updateLayout,null,this);b.onSelect().addListener(function(){a.getSelectedJqElements().removeClass("selected");this.setIsSelected(!0);a._selectedGroupItem=this;a._selectedItem=null},null,b);b.localize();return b};
McxLayerManager.prototype.findGroupByName=function(a,b){for(var c=a.getChildrenOfType(McxLayerManagerGroupItem),d=0;d<c.length;d++){var e=c[d];if(mcx.isInstanceOf(e,McxLayerManagerGroupItem)&&e.getShortGroupName()==b)return e}c=this.createGroupItem();c.setGroupName(b);mcx.isInstanceOf(a,McxLayerManagerGroupItem)&&a.addLayerItem(c);return c};
McxLayerManager.prototype.getGroupByName=function(a){var b=this.getChildren();if(-1==a.indexOf("/")){for(var c=0;c<b.length;c++){var d=b[c];if(mcx.isInstanceOf(d,McxLayerManagerGroupItem)&&d.getGroupName()==a)return d}c=this.createGroupItem();c.setGroupName(a);return c}a=a.split("/");b=[];for(c=0;c<a.length;c++)d=this.findGroupByName(0==c?this:b[c-1],a[c]),b[c]=d;return b[b.length-1]};
McxLayerManager.prototype.updateLayerOrders=function(){var a=this.getAllLayerItems(this),b;for(b in a){var c=this._layerManagerListElem.find(".mcx-layer-manager-list-item"),c=c.length-1-c.index(a[b].getContent()),d=a[b].getLayer();d.getOrder()!=c&&this._map.getLayers().changeOrder(d,c)}};McxLayerManager.prototype.orderLayersByUIIndex=function(){};
McxLayerManager.prototype.getAllLayerItems=function(a){var b=a.getChildrenOfType(McxLayerManagerItem);a=a.getChildrenOfType(McxLayerManagerGroupItem);for(var c=0;c<a.length;c++)b=b.concat(this.getAllLayerItems(a[c]));return b};
McxLayerManager.prototype.displayFeaturesOfSelectedLayerInGrid=function(){if(this._selectedItem&&this._mapInetractionFactory&&this._selectedItem.getLayer().isInstanceOf("IMcxSelectableLayer")){var a=this._mapInetractionFactory.createFeatureGridAction(this._selectedItem.getLayer());a.stretch&&a.stretch();a.execute(this._map)}};McxLayerManager.prototype.getContent=function(){return this._layerManagerElem};js.framework.ui.McxCommonControl.LayerManager.McxLayerManagerGroupItem={};
function McxLayerManagerGroupItem(a){mcx.base(this);this._rootElement=$("<div/>");this._toolBar=$("<div/>");this._layerList=$("<div/>");this._groupLabelElement=$("<div/>");this._groupNameTextBox=new McxTextBox(McxTextBoxType.Text);this._opacitySetter=new McxNumberSlider(!1,McxNumberSliderMode.Horizontal,0,100,1,100);this._expandButton=new McxButton;this._toolBarGroupLeft=$("<div/>");this._toolBarGroupRight=$("<div/>");this._toolBarGroupLabel=$("<div/>");this.base=this;this._layerCollection=a;this._itemDropHandler=
new McxEventHandler;this._itemAddHandler=new McxEventHandler;this._onSelectHandler=new McxEventHandler;this._onToggleExpandHandler=new McxEventHandler;this._groupName="Group";this._editButton=new McxButton;this._selectButton=new McxButton;this._labelButton=new McxButton;this._magnetButton=new McxButton;this._visibilityButton=new McxButton;this.initialize()}mcx.inherits(McxLayerManagerGroupItem,McxUserControl);
McxLayerManagerGroupItem.prototype.setOpacity=function(a){var b=this.base.getChildrenOfType(McxLayerManagerGroupItem).concat(this.base.getChildrenOfType(McxLayerManagerItem));this._opacitySetter.getValue()!=100*a&&this._opacitySetter.setValue(100*a);for(var c=0;c<b.length;c++)mcx.isInstanceOf(b[c],McxLayerManagerItem)?b[c].setLayerOpacity(a):b[c].setOpacity(a)};
McxLayerManagerGroupItem.prototype.createToolButtons=function(){this._opacitySetter.setCssDisplay(McxUserControlDisplay.inlineBlock);this._opacitySetter.getContent().css("margin-right","15px");this._opacitySetter.addClass("hidden-phone");this.base.addChild(this._toolBarGroupRight,this._opacitySetter);this._opacitySetter.onChange().addListener(function(){var a=this._opacitySetter.getValue();this.setOpacity(a/100)},null,this);this._opacitySetter.setValue(100);var a=[];this._expandButton.addClass("layer-manager-tool-button");
this._expandButton.setImage("mcx-layer-group-expand");this._expandButton.setButtonSize(McxButtonSize.small);this._expandButton.setButtonVisualType(McxButtonVisualType.linkButton);this.base.addChild(this._toolBarGroupLeft,this._expandButton);this._editButton.setImage("mcx-layer-property-editable");this._editButton.getContent().attr("data-localize","McxCommonControl-layerManagerDrawButtonTitle");this._editButton.getContent().attr("data-localize-for","title");this._editButton.getClickHandler().addListener(this.toggleEditable,
null,this);this._selectButton.setImage("mcx-layer-property-selectable");this._selectButton.getContent().attr("data-localize","McxCommonControl-layerManagerSelectButtonTitle");this._selectButton.getContent().attr("data-localize-for","title");this._selectButton.getClickHandler().addListener(this.toggleSelectable,null,this);this._labelButton.setImage("mcx-layer-property-label");this._labelButton.getContent().attr("data-localize","McxCommonControl-layerManagerToolButtonTitle");this._labelButton.getContent().attr("data-localize-for",
"title");this._labelButton.getClickHandler().addListener(this.toggleShowLabels,null,this);this._magnetButton.setImage("mcx-layer-property-magnet");this._magnetButton.getContent().attr("data-localize","McxCommonControl-layerManagerMagnetButtonTitle");this._magnetButton.getContent().attr("data-localize-for","title");this._magnetButton.addClass("tool-magnet");this._magnetButton.getClickHandler().addListener(this.toggleSnapable,null,this);this._visibilityButton.setImage("mcx-layer-property-visible");
this._visibilityButton.getContent().addClass("layer-manager-tool-button");this._visibilityButton.getContent().css("margin-left","8px").css("margin-right","5px");this._visibilityButton.getClickHandler().addListener(this.toggleVisible,null,this);a[a.length]=this._editButton;a[a.length]=this._selectButton;a[a.length]=this._labelButton;a[a.length]=this._magnetButton;a[a.length]=this._visibilityButton;for(var b=0;b<a.length;b++){var c=a[b];c.setButtonSize(McxButtonSize.small);c.setButtonState(McxButtonState.predefined);
c.setButtonVisualType(McxButtonVisualType.linkButton);c.getContent().addClass("layer-manager-tool-button");c.setAttributeValue("data-state","on");this.base.addChild(this._toolBarGroupRight,c)}};
McxLayerManagerGroupItem.prototype.toggleEditable=function(){for(var a=this.base.getInnerChildrenOfType(McxLayerManagerItem),b=this.getContent().find(".edit-enabled .mcx-layer-property.mcx-layer-property-editable").not(".disabled").length,c=this.getContent().find(".edit-enabled .mcx-layer-property.mcx-layer-property-editable.disabled").length,b=b>=c,c=0;c<a.length;c++)a[c].setEditable(!b);b?this.getContent().find(".mcx-layer-manager-group-item-tool-bar .mcx-layer-property-editable").addClass("disabled"):
this.getContent().find(".mcx-layer-manager-group-item-tool-bar .mcx-layer-property-editable").removeClass("disabled")};
McxLayerManagerGroupItem.prototype.toggleShowLabels=function(){for(var a=this.base.getInnerChildrenOfType(McxLayerManagerItem),b=this.getContent().find(".label-enabled .mcx-layer-property.mcx-layer-property-label").not(".disabled").length,c=this.getContent().find(".label-enabled .mcx-layer-property.mcx-layer-property-label.disabled").length,b=b>=c,c=0;c<a.length;c++)a[c].setShowLabels(!b);b?this.getContent().find(".mcx-layer-manager-group-item-tool-bar .mcx-layer-property-label").addClass("disabled"):
this.getContent().find(".mcx-layer-manager-group-item-tool-bar .mcx-layer-property-label").removeClass("disabled")};
McxLayerManagerGroupItem.prototype.toggleSelectable=function(){for(var a=this.base.getInnerChildrenOfType(McxLayerManagerItem),b=this.getContent().find(".select-enabled .mcx-layer-property.mcx-layer-property-selectable").not(".disabled").length,c=this.getContent().find(".select-enabled .mcx-layer-property.mcx-layer-property-selectable.disabled").length,b=b>=c,c=0;c<a.length;c++)a[c].setSelectable(!b);b?this.getContent().find(".mcx-layer-manager-group-item-tool-bar .mcx-layer-property-selectable").addClass("disabled"):
this.getContent().find(".mcx-layer-manager-group-item-tool-bar .mcx-layer-property-selectable").removeClass("disabled")};
McxLayerManagerGroupItem.prototype.toggleSnapable=function(){for(var a=this.base.getInnerChildrenOfType(McxLayerManagerItem),b=this.getContent().find(".snap-enabled .mcx-layer-property.mcx-layer-property-magnet").not(".disabled").length,c=this.getContent().find(".snap-enabled .mcx-layer-property.mcx-layer-property-magnet.disabled").length,b=b>=c,c=0;c<a.length;c++)a[c].setSnappable(!b);b?this.getContent().find(".mcx-layer-manager-group-item-tool-bar .mcx-layer-property-magnet").addClass("disabled"):
this.getContent().find(".mcx-layer-manager-group-item-tool-bar .mcx-layer-property-magnet").removeClass("disabled")};
McxLayerManagerGroupItem.prototype.toggleVisible=function(){for(var a=this.base.getInnerChildrenOfType(McxLayerManagerItem),b=this.getContent().find(".mcx-layer-property.mcx-layer-property-visible").not(".disabled").length,c=this.getContent().find(".mcx-layer-property.mcx-layer-property-visible.disabled").length,b=b>=c,c=0;c<a.length;c++)a[c].setVisible(!b);b?this.getContent().find(".mcx-layer-manager-group-item-tool-bar .mcx-layer-property-visible").addClass("disabled"):this.getContent().find(".mcx-layer-manager-group-item-tool-bar .mcx-layer-property-visible").removeClass("disabled")};
McxLayerManagerGroupItem.prototype.bindEvents=function(){this._expandButton.getClickHandler().addListener(this.toggleExpand,null,this);this._toolBar.click($.proxy(function(){this.onSelect().dispatchOnSuccess(this,null)},this));this.base.enableDragging(this._groupLabelElement);this.base.enableDropping();this.base.onDrop().addListener(function(a){var b=a.getDragItem();mcx.isInstanceOf(b,McxLayerManagerItem)?(b.getLayer().setGroupName(this.getGroupName()),this.addLayerControl(b),this.onItemDrop().dispatchOnSuccess(this,
null),a.stopPropagation()):!mcx.isInstanceOf(b,McxLayerManagerGroupItem)||mcx.isInstanceOf(this.base.getParent(),McxLayerManagerGroupItem)||0<b.getContent().find(".mcx-layer-manager-group-item").length||(b.setGroupName(this.getGroupName()+"/"+b.getShortGroupName()),this.addLayerControl(b),this.onItemDrop().dispatchOnSuccess(this,null),a.stopPropagation())},null,this);this._groupNameTextBox.getKeyPressHandler().addListener(function(a){a=a.getArgs();a.getKeyCode()==McxKeyCode.enter?(this._rootElement.removeClass("state-edit"),
this.setGroupName(this.getRootName()+this._groupNameTextBox.getValue())):a.getKeyCode()==McxKeyCode.escape&&this._rootElement.removeClass("state-edit")},null,this);this._groupLabelElement.on("dblclick",$.proxy(function(){this._rootElement.toggleClass("state-edit")},this))};McxLayerManagerGroupItem.prototype.removeLayers=function(){for(var a=this.getLayers(),b=0;b<a.length;b++)this._layerCollection.remove(a[b]);this.base.removeAllChildren()};McxLayerManagerGroupItem.prototype.onSelect=function(){return this._onSelectHandler};
McxLayerManagerGroupItem.prototype.setIsSelected=function(a){a?this._rootElement.addClass("selected"):this._rootElement.removeClass("selected")};
McxLayerManagerGroupItem.prototype.initialize=function(){this._rootElement.addClass("mcx-layer-manager-group-item");this._toolBar.addClass("mcx-layer-manager-group-item-tool-bar");this._toolBarGroupLeft.addClass("mcx-layer-manager-group-item-tool-group");this._toolBarGroupRight.addClass("mcx-layer-manager-group-item-tool-group pull-right");this._toolBarGroupLabel.addClass("mcx-layer-manager-group-item-tool-group label-group");this._groupLabelElement.addClass("mcx-layer-manager-group-item-label");
this._layerList.addClass("mcx-layer-manager-group-item-layer-list");this._groupNameTextBox.getContent().addClass("mcx-layer-manager-group-item-label-input");this._toolBarGroupLabel.append(this._groupLabelElement);this.base.addChild(this._toolBarGroupLabel,this._groupNameTextBox);this._toolBar.append(this._toolBarGroupLeft);this._toolBar.append(this._toolBarGroupLabel);this._toolBar.append(this._toolBarGroupRight);this.createToolButtons();this._rootElement.append(this._toolBar).append(this._layerList);
this.bindEvents()};McxLayerManagerGroupItem.prototype.onItemDrop=function(){return this._itemDropHandler};McxLayerManagerGroupItem.prototype.onItemAdd=function(){return this._itemAddHandler};McxLayerManagerGroupItem.prototype.onToggleExpand=function(){return this._onToggleExpandHandler};
McxLayerManagerGroupItem.prototype.addLayerControl=function(a){mcx.isInstanceOf(a,McxLayerManagerGroupItem)?a.setGroupName(this.getGroupName()+"/"+a.getShortGroupName()):mcx.isInstanceOf(a,McxLayerManagerItem)&&a.getLayer().setGroupName(this.getGroupName());this.base.addChild(this._layerList,a)};McxLayerManagerGroupItem.prototype.addLayerItem=function(a){this.addLayerControl(a);this.onItemAdd().dispatchOnSuccess(this,null)};McxLayerManagerGroupItem.prototype.enableEditMode=function(){this._rootElement.addClass("state-edit")};
McxLayerManagerGroupItem.prototype.setGroupName=function(a){this._groupName=a;this._groupLabelElement.text(this.getShortGroupName()).attr("title",this.getShortGroupName());this._groupNameTextBox.setValue(this.getShortGroupName());for(var b=this.base.getChildrenOfType(McxLayerManagerItem),c=0;c<b.length;c++)b[c].getLayer().setGroupName(a);b=this.base.getChildrenOfType(McxLayerManagerGroupItem);for(c=0;c<b.length;c++)b[c].setGroupName(a+"/"+b[c].getShortGroupName())};
McxLayerManagerGroupItem.prototype.getGroupName=function(){return this._groupName};McxLayerManagerGroupItem.prototype.getShortGroupName=function(){var a=this.getGroupName().split("/");return a[a.length-1]};McxLayerManagerGroupItem.prototype.getRootName=function(){var a=this.getGroupName().split("/");a.pop();return 0==a.length?"":a.join("/")+"/"};McxLayerManagerGroupItem.prototype.toggleExpand=function(){this._rootElement.toggleClass("state-open");this.onToggleExpand().dispatchOnSuccess(this,null)};
McxLayerManagerGroupItem.prototype.expand=function(){this._rootElement.addClass("state-open")};McxLayerManagerGroupItem.prototype.collapse=function(){this._rootElement.removeClass("state-open")};McxLayerManagerGroupItem.prototype.getLayers=function(){for(var a=this.base.getChildrenOfType(McxLayerManagerItem),b=this.base.getChildrenOfType(McxLayerManagerGroupItem),c=[],d=0;d<a.length;d++)c[c.length]=a[d].getLayer();for(d=0;d<b.length;d++)c=c.concat(b[d].getLayers());return c};
McxLayerManagerGroupItem.prototype.orderLayerItemsByLayerIndex=function(){for(var a=this.base.getChildrenOfType(McxLayerManagerItem),b={},c=0;c<a.length;c++){var d=a[c],e=this._layerCollection.indexOf(d.getLayer());b[e]=d}for(c in b)b[c]&&this._layerList.prepend(b[c].getContent())};McxLayerManagerGroupItem.prototype.getTopLayerIndex=function(){for(var a=this.base.getChildrenOfType(McxLayerManagerItem),b=0,c=0;c<a.length;c++)var d=a[c].getLayer(),b=Math.max(b,this._layerCollection.indexOf(d));return b};
McxLayerManagerGroupItem.prototype.getBottomLayerIndex=function(){for(var a=this.base.getChildrenOfType(McxLayerManagerItem),b=this.getTopLayerIndex(),c=0;c<a.length;c++)var d=a[c].getLayer(),b=Math.min(b,this._layerCollection.indexOf(d));return b};
McxLayerManagerGroupItem.prototype.getGroupByName=function(a){var b=this.getChildren();if(-1==a.indexOf("/")){for(var c=0;c<b.length;c++){var d=b[c];if(mcx.isInstanceOf(d,McxLayerManagerGroupItem)&&d.getGroupName()==a)return d}b=new McxLayerManagerGroupItem(this._layerCollection);b.setGroupName(a);this.addLayerItem(b);return b}a=a.split("/");for(var e=a[0],c=0;c<b.length;c++)if(d=b[c],mcx.isInstanceOf(d,McxLayerManagerGroupItem)&&d.getGroupName()==e)return d.getGroupByName(a.splice(0,1).join("/"));
b=new McxLayerManagerGroupItem(this._layerCollection);b.setGroupName(e);this.addLayerItem(b);return b.getGroupByName(a.splice(0,1).join("/"))};McxLayerManagerGroupItem.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.LayerManager.McxLayerManagerItem={};
function McxLayerManagerItem(a,b){mcx.base(this);this.base=this;this._layer=a;this._map=b;this._onSelectHandler=new McxEventHandler;this._onTogglePropertiesPanelHandler=new McxEventHandler;this._propertiesPanel=this._listItemElem=this._layerSelectionCountProperty=this._layerAdvencedPropertiesPanel=this._layerPropertiesButton=this._opacitySlider=this._layerLabelElem=this._layerSnapPropertyButton=this._layerLabelVisiblePropertyButton=this._layerSelectablePropertyButton=this._layerEditablePropertyButton=
this._layerVisiblePropertyButton=null;this.initialize();this.bindEvents()}mcx.inherits(McxLayerManagerItem,McxUserControl);
McxLayerManagerItem.prototype.initialize=function(){var a=$("<div/>").addClass("mcx-layer-manager-list-item");$("<div/>").addClass("mcx-layer-img");var b=$("<div/>").html(this._layer.getAlias()).attr("title",this._layer.getAlias()).addClass("mcx-layer-label"),c=$("<div/>").addClass("mcx-layer-properties").addClass("left"),d=$("<div/>").addClass("mcx-layer-properties"),e=$("<div/>").addClass("mcx-layer-properties").addClass("section2"),f=$("<div/>").css("width","100px").css("margin-left","5px").css("margin-right",
"10px").addClass("mcx-layer-properties").addClass("mcx-layer-properties-tool-opacity").addClass("section2"),g=$("<div/>").addClass("mcx-layer-properties").addClass("section2"),h=$("<div/>").addClass("mcx-layer-advenced-properties"),k=this._layer.getVisible(),m=this._layer.getEditable(),n=this._layer.isShowLabels&&this._layer.isShowLabels(),p=this._layer.isSelectable&&this._layer.isSelectable(),q=this._layer.getSnappable&&this._layer.getSnappable(),r=$("<div/>").addClass("mcx-layer-property").addClass("mcx-layer-property-visible");
k||r.addClass("disabled");k=$("<div/>").attr("data-localize","McxCommonControl-layerManagerDrawButtonTitle").attr("data-localize-for","title").addClass("mcx-layer-property").addClass("mcx-layer-property-editable");m||k.addClass("disabled");m=$("<div/>").attr("data-localize","McxCommonControl-layerManagerSelectButtonTitle").attr("data-localize-for","title").addClass("mcx-layer-property").addClass("mcx-layer-property-selectable");p||m.addClass("disabled");this._layer.isInstanceOf("IMcxSelectableLayer")&&
m.data("targetSetter","setSelectable");p=$("<div/>").attr("data-localize","McxCommonControl-layerManagerToolButtonTitle").attr("data-localize-for","title").addClass("mcx-layer-property").addClass("mcx-layer-property-label");n||p.addClass("disabled");var n=$("<div/>").html(this._layer.getSelectionCount&&this._layer.getSelectionCount()).addClass("mcx-layer-property").addClass("hidden-phone").addClass("mcx-layer-property-selectioncount"),t=$("<div/>").attr("data-localize","McxCommonControl-layerManagerMagnetButtonTitle").attr("data-localize-for",
"title").addClass("mcx-layer-property").addClass("hidden-phone").addClass("mcx-layer-property-magnet");q||t.addClass("disabled");var q=$("<div/>").addClass("mcx-layer-property").addClass("mcx-layer-property-properties"),u=new McxNumberSlider(!1,McxNumberSliderMode.Horizontal,0,100,5);this.base.addChild(f,u);u.setValue(100*this._layer.getOpacity());c.append(q);d.append(n);e.append(k);e.append(m);e.append(p);e.append(t);g.append(r);var v=$("<div/>").addClass("mcx-layer-manager-list-item-tool-bar");
v.append(c);v.append(b);v.append(g);v.append(d);v.append(e);v.append(f);a.append(v);a.append($("<div/>").addClass("extend-button"));a.append(h);this._layer.setSnappable&&a.addClass("snap-enabled");this._layer.setEditable&&a.addClass("edit-enabled");this._layer.setShowLabels&&a.addClass("label-enabled");this._layer.setSelectable&&a.addClass("select-enabled");this._layerVisiblePropertyButton=r;this._layerEditablePropertyButton=k;this._layerSnapPropertyButton=t;this._layerSelectablePropertyButton=m;
this._layerLabelVisiblePropertyButton=p;this._layerLabelElem=b;this._opacitySlider=u;this._layerPropertiesButton=q;this._layerAdvencedPropertiesPanel=h;this._layerSelectionCountProperty=n;this._listItemElem=a};McxLayerManagerItem.prototype.setIsSelected=function(a){a?this._listItemElem.addClass("selected"):this._listItemElem.removeClass("selected")};McxLayerManagerItem.prototype.getIsSelected=function(){return this._listItemElem.hasClass("selected")};
McxLayerManagerItem.prototype.toggleSnapable=function(){var a=!this._layerSnapPropertyButton.hasClass("disabled");this.setSnappable(!a)};McxLayerManagerItem.prototype.toggleEditable=function(){var a=!this._layerEditablePropertyButton.hasClass("disabled");this.setEditable(!a)};McxLayerManagerItem.prototype.toggleSelectable=function(){var a=!this._layerSelectablePropertyButton.hasClass("disabled");this.setSelectable(!a)};
McxLayerManagerItem.prototype.toggleVisible=function(){var a=!this._layerVisiblePropertyButton.hasClass("disabled");this.setVisible(!a);this._map.getRenderer().paintLayer(this._layer,null);this._layer.isShowLabels()&&this._map.inVisibleRange(this._layer.getMinLabelScale(),this._layer.getMaxLabelScale())&&this._map.getRenderer().paintLabels()};
McxLayerManagerItem.prototype.toggleShowLabels=function(){var a=!this._layerLabelVisiblePropertyButton.hasClass("disabled");this.setShowLabels(!a);this._layer.isShowLabels()&&this._map.inVisibleRange(this._layer.getMinLabelScale(),this._layer.getMaxLabelScale())&&this._map.getRenderer().paintLabels()};
McxLayerManagerItem.prototype.bindEvents=function(){var a=this;this._opacitySlider.onChange().addListener(function(){this.updateLayerOpacity()},null,this);this._layerVisiblePropertyButton.click($.proxy(this.toggleVisible,this));this._layerEditablePropertyButton.click($.proxy(this.toggleEditable,this));this._layerSelectablePropertyButton.click($.proxy(this.toggleSelectable,this));this._layerLabelVisiblePropertyButton.click($.proxy(this.toggleShowLabels,this));this._layerSnapPropertyButton.click($.proxy(this.toggleSnapable,
this));this._listItemElem.click(function(b){$(this).hasClass("selected")||$(b.target).is(".mcx-layer-property")&&!$(b.target).hasClass("mcx-layer-property-properties")||(a.onSelect().dispatchOnSuccess(a,new McxEventArgs(null)),b.preventDefault())});this._layerPropertiesButton.click(function(){$(".mcx-layer-advenced-properties").is(":animated")||(a._listItemElem.prop(!a._listItemElem.hasClass("state-open")),a._listItemElem.hasClass("state-open")?($(".mcx-layer-manager.state-item-open .mcx-layer-manager-list-item.state-open .mcx-layer-advenced-properties").removeClass("visibility-visible").css("display",
"none"),a.getContent().prop("draggable",!0),a._listItemElem.removeClass("state-open")):(a._listItemElem.addClass("state-open"),a.getContent().prop("draggable",!1),0==mcx.isDefAndNotNull(a._propertiesPanel)&&(a._propertiesPanel=new McxLayerPropertiesPanel(a._layer),a._propertiesPanel.onSaveButtonClickHandler().addListener(function(){this._map.getRenderer().paintLayer(this._layer,null)},null,a),a.base.addChild(a._layerAdvencedPropertiesPanel,a._propertiesPanel),a._propertiesPanel.localize()),setTimeout(function(){$(".mcx-layer-manager.state-item-open .mcx-layer-manager-list-item.state-open .mcx-layer-advenced-properties").css("display",
"block")},200),setTimeout(function(){$(".mcx-layer-manager.state-item-open .mcx-layer-manager-list-item.state-open .mcx-layer-advenced-properties").addClass("visibility-visible")},300)),a.onTogglePropertiesPanel().dispatchOnSuccess(a,new McxEventArgs(null)))});this._layer.isInstanceOf("IMcxSelectableLayer")&&(this._layer.getAddSelectionEventHandler().addListener(this.onLayerSelectionChange,null,this),this._layer.getRemoveSelectionEventHandler().addListener(this.onLayerSelectionChange,null,this));
this._layer.getVisibilityChangeHandler().addListener(function(){this.setVisible(this._layer.getVisible(),!0)},null,this);this._layer.getOpacityChangeHandler().addListener(function(){this.setLayerOpacity(this._layer.getOpacity())},null,this);this.base.enableDragging();this.base.enableDropping();this.base.onDrop().addListener(function(a){a.stopPropagation()},null,this)};
McxLayerManagerItem.prototype.onLayerSelectionChange=function(a){a=this._layer.getSelectionCount();0<a?(this._layerSelectionCountProperty.html(a),this._listItemElem.attr("title",String.format(McxLocalizationManager.getLocaleValue("McxCommonControl-SelectionCountIs"),a))):this._layerSelectionCountProperty.html("");setTimeout(function(){var a=Math.max.apply(null,$(".mcx-layer-property-selectioncount").map(function(){return $(this).width()}).get());$(".mcx-layer-property-selectioncount").each(function(c,
d){var e=a-$(d).width();$(d).css("margin-left",e/2);$(d).css("margin-right",e/2)})},10)};McxLayerManagerItem.prototype.updateLayerOpacity=function(){var a=this._opacitySlider.getValue();this._map.getLayers().setLayerOpacity(this._layer,a/100)};McxLayerManagerItem.prototype.setLayerOpacity=function(a){this._opacitySlider.setValue(100*a)};McxLayerManagerItem.prototype.loadPropertiesPane=function(){};McxLayerManagerItem.prototype.onSelect=function(){return this._onSelectHandler};
McxLayerManagerItem.prototype.getLayer=function(){return this._layer};McxLayerManagerItem.prototype.setVisible=function(a,b){b||(this._layer.setVisible(a),this._map.getRenderer().paintLayer(this._layer,null),this._map.getRenderer().paintLabels());!0===a?this._layerVisiblePropertyButton.removeClass("disabled"):this._layerVisiblePropertyButton.addClass("disabled")};
McxLayerManagerItem.prototype.setSnappable=function(a){this._layer.setSnappable&&(this._layer.setSnappable(a),!0===a?this._layerSnapPropertyButton.removeClass("disabled"):this._layerSnapPropertyButton.addClass("disabled"))};McxLayerManagerItem.prototype.setEditable=function(a){this._layer.setEditable&&(this._layer.setEditable(a),!0===a?this._layerEditablePropertyButton.removeClass("disabled"):this._layerEditablePropertyButton.addClass("disabled"))};
McxLayerManagerItem.prototype.setSelectable=function(a){this._layer.setSelectable&&(this._layer.setSelectable(a),1==a?this._layerSelectablePropertyButton.removeClass("disabled"):this._layerSelectablePropertyButton.addClass("disabled"))};McxLayerManagerItem.prototype.setShowLabels=function(a,b){this._layer.setShowLabels&&(this._layer.setShowLabels(a),b||this._map.getRenderer().paintLabels(),!0===a?this._layerLabelVisiblePropertyButton.removeClass("disabled"):this._layerLabelVisiblePropertyButton.addClass("disabled"))};
McxLayerManagerItem.prototype.onTogglePropertiesPanel=function(){return this._onTogglePropertiesPanelHandler};McxLayerManagerItem.prototype.getContent=function(){return this._listItemElem};js.framework.ui.McxCommonControl.LayerPropertiesPanel={};js.framework.ui.McxCommonControl.LayerPropertiesPanel.McxLayerFilterProperties={};function McxLayerFilterProperties(a){mcx.base(this);this.base=this;this._layer=a;this._rootElement=this._attrQueryGenerator=null;this.preInitContent();this.initialize();this.addLocalePath()}mcx.inherits(McxLayerFilterProperties,McxUserControl);McxLayerFilterProperties.prototype.preInitContent=function(){this._rootElement=$("<div/>").addClass("mcx-filter-properties-control")};
McxLayerFilterProperties.prototype.initialize=function(){var a=new McxAccordionContentDisplayer("Filter by Attribute");a.setButtonLocalizationKey("McxCommonControl-mcxLayerPropertiesFilterByAttribute");a.hideButtons();a.showContent();a.setIsFloating(!1);a.setIsToggleable(!1);this._attrQueryGenerator=new McxAttributeQueryGenerator;this._attrQueryGenerator.disableAdvencedQueryMode();this._attrQueryGenerator.setLayer(this._layer);a.addContent(this._attrQueryGenerator);this.base.addChild(this._rootElement,
a)};McxLayerFilterProperties.prototype.getContent=function(){return this._rootElement};McxLayerFilterProperties.prototype.addLocalePath=function(){McxLocalizationManager.addLocalePath("$McxCommonControl/LayerPropertiesPanel/locale/mcxLayerPropertiesPanel")};McxLayerFilterProperties.prototype.getAttributeFilter=function(){return this._attrQueryGenerator.getSql()};js.framework.ui.McxCommonControl.LayerPropertiesPanel.McxLayerGeometryProperties={};function McxLayerGeometryProperties(a){mcx.base(this);this.base=this;this._layer=a;this._rootElement=$("<div/>");this._paintModeSelectBox=this._renderModeSelect=null;this._visibleRangeSetter=new McxVisibleRangeSetter;this._cacheableCheckBox=this._zoomRangeGroup=this._lineSymbolizerEditor=this._polygonSymbolizerEditor=this._pointSymbolizerEditor=null;this.preInitContent();this.initialize()}
mcx.inherits(McxLayerGeometryProperties,McxUserControl);
McxLayerGeometryProperties.prototype.preInitContent=function(){$("<label/>").css("position","relative").css("left","20px");var a=new McxGroupBox("Zoom Range");a.setCanBeDisabled(!0);a.setLocalizationKeyForTitle("McxCommonControl-mcxLayerPropertiesZoomRange");a.setIsEnabled(!1);a.addContent(this._visibleRangeSetter);var b=new McxGroupBox("Common");b.setLocalizationKeyForTitle("McxCommonControl-mcxLayerPropertiesCommon");if(this._layer.isInstanceOf("IMcxSelectableLayer")){var c=new McxSelectBox;c.setTextGetter("text");
c.setValueGetter("value");c.setIsLocalizable(!0);c.addItemRange([{text:"McxCommonControl-Feature",value:McxPainterMode.ByFeature},{text:"McxCommonControl-Layer",value:McxPainterMode.ByLayer},{text:"McxCommonControl-Image",value:McxPainterMode.ByImage}]);var d=new McxLabeledEditor("Render Mode",c);d.setLabelSpanLength(5);d.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesRenderMode");c.setSelectedValue(this._layer.getPainterMode());b.addContent(d);this._paintModeSelectBox=c}c=new McxSelectBox;
c.setTextGetter("getKey");c.setValueGetter("getValue");c.setIsLocalizable(!0);c.addItemRange([new McxKeyValuePair("McxCommonControl-SingleTile","TRUE"),new McxKeyValuePair("McxCommonControl-Auto","FALSE")]);d=new McxLabeledEditor("Grid Size",c);d.setLabelSpanLength(5);d.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesGridSize");b.addContent(d);c.setSelectedValue(this._layer.isSingleTile()?"TRUE":"FALSE");var d=new McxCheckBox,e=new McxLabeledEditor("Cacheable",d);e.setLabelSpanLength(5);
e.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesCacheable");e.setLabelSpanLength(5);b.addContent(e);d.checked(this._layer.isCacheable());McxLocalizationManager.localizeContent(b.getContent());e=new McxLayoutRow;e.createAndAddSpan(6,a);e.createAndAddSpan(6,b);this.addTab("Drawing",e,"McxCommonControl-mcxLayerPropertiesDrawing","icon-polygon");this._zoomRangeGroup=a;this._renderModeSelect=c;this._cacheableCheckBox=d};
McxLayerGeometryProperties.prototype.initialize=function(){isNaN(this._layer.getMaxScale())||this._visibleRangeSetter.setMaxScale(this._layer.getMaxScale());isNaN(this._layer.getMinScale())||this._visibleRangeSetter.setMinScale(this._layer.getMinScale());0!=isNaN(this._layer.getMaxScale())||0!=isNaN(this._layer.getMinScale())||Infinity==Math.round(1/this._layer.getMaxScale())&&0==Math.round(1/this._layer.getMinScale())||(this._visibleRangeSetter.setIsDisplayWithZoomRange(!0),this._zoomRangeGroup.setIsEnabled(!0));
this._zoomRangeGroup.getEnabledChangeHandler().addListener(function(){this._visibleRangeSetter.setIsDisplayWithZoomRange(this._zoomRangeGroup.getIsEnabled())},null,this);var a=new McxPointSymbolizerEditor;a.setPointSymbolizer(this._layer.getSymbolizer().getPointSymbolizer());var b=new McxLineSymbolizerEditor;b.setLineSymbolizer(this._layer.getSymbolizer().getLineSymbolizer());var c=new McxLayoutRow;c.createAndAddSpan(12,b);var d=new McxPolygonSymbolizerEditor;d.setPolygonSymbolizer(this._layer.getSymbolizer().getPolygonSymbolizer());
var e=this._layer.getGeometryType(),f=e==McxGeometryType.GeometryCollection||e==McxGeometryType.MultiPoint||e==McxGeometryType.Point||e==McxGeometryType.Unknown,g=e==McxGeometryType.GeometryCollection||e==McxGeometryType.LinearRing||e==McxGeometryType.LineSegment||e==McxGeometryType.LineString||e==McxGeometryType.MultiLineString||e==McxGeometryType.Unknown;e!=McxGeometryType.GeometryCollection&&e!=McxGeometryType.MultiPolygon&&e!=McxGeometryType.Polygon&&e!=McxGeometryType.Unknown||this.addTab("Polygon",
d,"McxCommonControl-mcxLayerPropertiesPolygon","icon-polygon");g&&this.addTab("Line",c,"McxCommonControl-mcxLayerPropertiesLine","icon-line");f&&this.addTab("Point",a,"McxCommonControl-mcxLayerPropertiesPoint","icon-point");this._pointSymbolizerEditor=a;this._polygonSymbolizerEditor=d;this._lineSymbolizerEditor=b};
McxLayerGeometryProperties.prototype.addTab=function(a,b,c,d){a=new McxAccordionContentDisplayer(a);a.setButtonLocalizationKey(c);a.setContent(b);a.setIsFloating(!1);a.hideButtons();a.showContent();a.getContent().css("margin-top","5px");this.base.addChild(this._rootElement,a,McxUserControlAddMethod.prepend)};McxLayerGeometryProperties.prototype.getContent=function(){return this._rootElement};
McxLayerGeometryProperties.prototype.applyStyle=function(){this._visibleRangeSetter.getIsDisplayWithZoomRange()?(this._layer.setMinScale(1/this._visibleRangeSetter.getMinScale()),this._layer.setMaxScale(1/this._visibleRangeSetter.getMaxScale())):(this._layer.setMinScale(Number.MAX_VALUE),this._layer.setMaxScale(Number.MIN_VALUE));this._layer.setSingleTile("TRUE"==this._renderModeSelect.getSelectedItem().getValue());this._paintModeSelectBox&&this._paintModeSelectBox.getSelectedItem()&&(console.log("layer name = "+
this._layer.getName()),console.log("painter Mode = "+this._paintModeSelectBox.getSelectedItem().value),this._layer.setPainterMode(this._paintModeSelectBox.getSelectedItem().value));this._layer.setCacheable(this._cacheableCheckBox.isChecked());this._pointSymbolizerEditor.applyStyle();this._lineSymbolizerEditor.applyStyle();this._polygonSymbolizerEditor.applyStyle()};McxLayerGeometryProperties.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};js.framework.ui.McxCommonControl.LayerPropertiesPanel.McxLayerInfoProperties={};function McxLayerInfoProperties(a){mcx.base(this);this.base=this;this._layer=a;this._layerDescriptionLabel=this._servicedAddressLabel=this._coordinateSystemWktText=this._coordinateSystemName=this._rightBoundLabel=this._leftBoundLabel=this._bottomBoundLabel=this._topBoundLabel=this._featureCountLabel=this._dataSourceLabel=this._layerNameLabel=this._rootElement=null;this.initContent();this.initValues()}
mcx.inherits(McxLayerInfoProperties,McxUserControl);
McxLayerInfoProperties.prototype.initContent=function(){var a=$("<div/>").css("margin","10px");$("<div/>").addClass("mcx-row-fluid");$("<div/>").addClass("mcx-span6");$("<div/>").addClass("mcx-span12");$("<span/>").addClass("content-area-title");$("<div/>").addClass("content-area");var b=$("<table/>"),c=$('<input type="text" disabled="disabled"/>'),d=c.clone(),e=c.clone(),f=c.clone(),g=c.clone();$("<tr/>").append($("<td/>").html("Katman").attr("data-localize","McxCommonControl-mcxLayerPropertiesLayer")).append($("<td/>").append(c)).appendTo(b);
$("<tr/>").append($("<td/>").html("Veri Kayna\u011f\u0131").attr("data-localize","McxCommonControl-mcxLayerPropertiesDataSource")).append($("<td/>").append(d)).appendTo(b);$("<tr/>").append($("<td/>").html("Nesne Say\u0131s\u0131").attr("data-localize","McxCommonControl-mcxLayerPropertiesFeatureCount")).append($("<td/>").append(e)).appendTo(b);$("<tr/>").append($("<td/>").html("Servis Edilen Adres").attr("data-localize","McxCommonControl-servedAddress")).append($("<td/>").append(f)).appendTo(b);$("<tr/>").append($("<td/>").html("A\u00e7\u0131klama").attr("data-localize",
"McxCommonControl-mcxLayerPropertiesLayerDescription")).append($("<td/>").append(g)).appendTo(b);var h=$('<input type="text" disabled="disabled"/>'),k=$('<input type="text" disabled="disabled"/>'),m=$('<input type="text" disabled="disabled"/>'),n=$('<input type="text" disabled="disabled"/>'),p=$("<table/>").css("width","100%").addClass("mcx-coordinate-sytsem-info"),q=$('<input type="text" disabled="disabled" />'),r=$('<input type="text" disabled="disabled" />');$("<tr/>").append($("<td/>").html("Ad\u0131").attr("data-localize",
"McxCommonControl-mcxLayerPropertiesName")).append($("<td/>").append(q)).appendTo(p);$("<tr/>").append($("<td/>").html("Projection").attr("data-localize","McxCommonControl-mcxLayerPropertiesProjection")).append($("<td/>").append(r)).appendTo(p);var t=new McxAccordionContentDisplayer("Source");t.setButtonLocalizationKey("McxCommonControl-mcxLayerPropertiesSource");t.hideButtons();t.showContent();t.setIsFloating(!1);t.setIsToggleable(!1);t.addContent(b.addClass("mcx-source-info"));b=new McxAccordionContentDisplayer("Bounds");
b.setButtonLocalizationKey("McxCommonControl-mcxLayerPropertiesBounds");b.hideButtons();b.showContent();b.setIsFloating(!1);b.setIsToggleable(!1);b.addContent(h.addClass("mcx-bounds-top"));b.addContent(k.addClass("mcx-bounds-left"));b.addContent(m.addClass("mcx-bounds-right"));b.addContent(n.addClass("mcx-bounds-bottom"));var u=new McxAccordionContentDisplayer("Coordinate Reference System");u.setButtonLocalizationKey("McxCommonControl-mcxLayerPropertiesCoordinateReferenceSystem");u.hideButtons();
u.showContent();u.setIsFloating(!1);u.setIsToggleable(!1);u.addContent(p);this._layerNameLabel=c;this._dataSourceLabel=d;this._featureCountLabel=e;this._topBoundLabel=h;this._bottomBoundLabel=n;this._leftBoundLabel=k;this._rightBoundLabel=m;this._coordinateSystemName=q;this._coordinateSystemWktText=r;this._servicedAddressLabel=f;this._layerDescriptionLabel=g;a.find("input").val("-");this._rootElement=$("<div/>");this.base.addChild(this._rootElement,t);this.base.addChild(this._rootElement,b);this.base.addChild(this._rootElement,
u);if(a=this._layer.getInfo(""))c=new McxAccordionContentDisplayer("Source"),c.setButtonLocalizationKey("McxCommonControl-mcxLayerPropertiesLayerDescription"),c.hideButtons(),c.showContent(),c.setIsFloating(!1),c.setIsToggleable(!1),d=new McxLabelControl,d.setText(a),c.addContent(d),this.base.addChild(this._rootElement,c)};
McxLayerInfoProperties.prototype.initValues=function(){var a=this;a._layer.getCoordinateSystem()&&a._coordinateSystemWktText.val(a._layer.getCoordinateSystem().getCode());a._layerNameLabel.val(a._layer.getName());a._dataSourceLabel.val(a._layer.getDataSource().getName()||a._layer.getDataSourceName());a._coordinateSystemName.val(mcx.isDefAndNotNull(a._layer.getCoordinateSystem())?a._layer.getCoordinateSystem().toString():"");var b=new McxAjaxParameter;b.setParameters(this,function(b){a._featureCountLabel.val(b.getFeatureCount().toString())},
null);a._layer.getFeatureCount(b);b=new McxAjaxParameter;b.setParameters(this,function(b){b=b.getEnvelope();a._topBoundLabel.val(b.getTop().toFixed(3).toString());a._leftBoundLabel.val(b.getLeft().toFixed(3).toString());a._rightBoundLabel.val(b.getRight().toFixed(3).toString());a._bottomBoundLabel.val(b.getBottom().toFixed(3).toString())},null);a._layer.getEnvelope(b);this._servicedAddressLabel.val(a._layer.getFullName().replace("/Rest/Json/",""));a._layer.isInstanceOf("McxFsLayer")&&this._layerDescriptionLabel.val(a._layer.getDescription())};
McxLayerInfoProperties.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.LayerPropertiesPanel.McxLayerLabelingPropertiesPanel={};function McxLayerLabelingPropertiesPanel(a){mcx.base(this);this.base=this;this._rootElement=null;this._layer=a;this.layerScaledLabels=this._textSymbolizerEditor=this._labelFormatSelector=this._visibleRangeSetter=null;this.initialize()}mcx.inherits(McxLayerLabelingPropertiesPanel,McxUserControl);
McxLayerLabelingPropertiesPanel.prototype.initialize=function(){this._rootElement=$("<div/>").addClass("");new McxLayoutRow;for(var a=[],b=0;b<this._layer.getSchema().getFieldCount();b++)this._layer.getSchema().getField(b).isIgnored()||a.push(this._layer.getSchema().getField(b).getFieldName());b=new McxAccordionContentDisplayer("Label Format");b.setButtonLocalizationKey("McxCommonControl-mcxLayerPropertiesLabelFormat");b.setIsFloating(!1);b.hideButtons();b.showContent();this._labelFormatSelector=
new McxLabelFormatSelector(a);this._labelFormatSelector.setFormat(this._layer.getLabelFormat());b.addContent(this._labelFormatSelector);b.getContent().find(".row-fluid").css("margin-bottom","0");a=new McxAccordionContentDisplayer("\u00c7izim");a.setButtonLocalizationKey("McxCommonControl-mcxLayerPropertiesZoomRange");a.setIsFloating(!1);a.hideButtons();a.showContent();var c=new McxGroupBox("Zoom Range");c.setLocalizationKeyForTitle("McxCommonControl-mcxLayerPropertiesZoomRange");c.setCanBeDisabled(!0);
this._visibleRangeSetter=new McxVisibleRangeSetter;this._visibleRangeSetter.setMaxScale(isNaN(this._layer.getMaxLabelScale())?0:this._layer.getMaxLabelScale());this._visibleRangeSetter.setMinScale(isNaN(this._layer.getMinLabelScale())?Infinity:this._layer.getMinLabelScale());0!=isNaN(1/this._layer.getMaxLabelScale())||0!=isNaN(1/this._layer.getMaxLabelScale())||Infinity==Math.round(1/this._layer.getMaxLabelScale())&&0==Math.round(1/this._layer.getMinLabelScale())?c.setIsEnabled(!1):(this._visibleRangeSetter.setIsDisplayWithZoomRange(!0),
c.setIsEnabled(!0));c.addContent(this._visibleRangeSetter);a.addContent(c);c.getEnabledChangeHandler().addListener(function(){this._visibleRangeSetter.setIsDisplayWithZoomRange(c.getIsEnabled())},null,this);var d=new McxAccordionContentDisplayer("Text Sybolizer Editor");d.setButtonLocalizationKey("McxCommonControl-mcxLayerPropertiesTextSymbolizerEditor");d.setIsFloating(!1);d.hideButtons();d.showContent();this._textSymbolizerEditor=new McxTextSymbolizerEditor;this._textSymbolizerEditor.setTextSymbolizer(this._layer.getLabelSymbolizer());
d.addContent(this._textSymbolizerEditor);var e=$("<input/>").attr("type","checkbox").addClass(""),f=$("<span/>").attr("data-localize","McxCommonControl-mcxLayerPropertiesScaledLabels").html("Scaled Labels").css("left","5px").css("bottom","4px").css("position","relative").addClass("");this._layer.isScaledLabels()&&e.attr("checked","checked");this.layerScaledLabels=e;d.addContent(e);d.addContent(f);this.base.addChild(this._rootElement,b);this.base.addChild(this._rootElement,d);this.base.addChild(this._rootElement,
a)};
McxLayerLabelingPropertiesPanel.prototype.applyStyle=function(){var a=this.layerScaledLabels.attr("checked");a&&"checked"==a?this._layer.setScaledLabels(!0):this._layer.setScaledLabels(!1);a=this._labelFormatSelector.getFormat();mcx.isDefAndNotNull(a)?this._layer.setLabelFormat(this._labelFormatSelector.getFormat()):this._layer.setLabelFormat("");this._visibleRangeSetter.getIsDisplayWithZoomRange()?(this._layer.setMaxLabelScale(1/this._visibleRangeSetter.getMaxScale()),this._layer.setMinLabelScale(1/this._visibleRangeSetter.getMinScale())):
(this._layer.setMaxLabelScale(0),this._layer.setMinLabelScale(1/0));this._textSymbolizerEditor.applyStyle()};McxLayerLabelingPropertiesPanel.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.LayerPropertiesPanel.McxLayerPropertiesPanel={};
function McxLayerPropertiesPanel(a){mcx.base(this);this.base=this;this.title=a.getName()+" \u00d6zellikleri";this.layer=a;this._onSaveButtonClickHandler=new McxEventHandler;this._tabElement=this._rootElement=this._subtypeEngineView=null;this._tabControl=new McxTabControl;this._layerFilterPropertiesEditor=this._layerLabelingPropertiesEditor=this._layerGeometryPropertiesEditor=null;this._filterGuid="65AA9767-DA96-43D2-B9D2-FB4279682115";this.initialize()}mcx.inherits(McxLayerPropertiesPanel,McxUserControl);
McxLayerPropertiesPanel.prototype.updateLayout=function(){};McxLayerPropertiesPanel.prototype.createFilterPropertiesPanel=function(){return this._layerFilterPropertiesEditor=new McxLayerFilterProperties(this.layer)};
McxLayerPropertiesPanel.prototype.createSubtypeEngine=function(){var a=new McxSubtypeEngineView,b=new McxCodedDomainThematicStyleEditor,c=new McxUniqueValueThematicStyleEditor,d=new McxRangeThematicStyleEditor,e=new McxThematicStyleClearEditor,f=new McxThematicStyleExportEditor;b.initialize();c.initialize();d.initialize();e.initialize();f.initialize();a.addThematicStyleEditor(b);a.addThematicStyleEditor(c);a.addThematicStyleEditor(d);a.addThematicStyleEditor(e);a.addThematicStyleEditor(f);f.getOnImportEventHandler().addListener(this.onSubTypeImported,
null,this);a.setLayers([this.layer]);b.setSelectedLayer(this.layer);c.setSelectedLayer(this.layer);d.setSelectedLayer(this.layer);e.setSelectedLayer(this.layer);e.setSelectedLayer(this.layer);f.setSelectedLayer(this.layer);switch(this.layer.getSubtypeType().getSubtypeType()){case McxSubtypeType.CodedValueSubtype:a.setSelectedEditor(b);break;case McxSubtypeType.RangedValueSubtype:a.setSelectedEditor(d);break;case McxSubtypeType.UniqueValueSubtype:a.setSelectedEditor(c)}return this._subtypeEngineView=
a};McxLayerPropertiesPanel.prototype.createLabelingPanel=function(){var a=new McxLayerLabelingPropertiesPanel(this.layer);return this._layerLabelingPropertiesEditor=a};McxLayerPropertiesPanel.prototype.createGeometryPanel=function(){var a=new McxLayerGeometryProperties(this.layer);return this._layerGeometryPropertiesEditor=a};
McxLayerPropertiesPanel.prototype.createSaveToolButton=function(){var a=new McxButton;a.setText("Save");a.setImage("mcx-icon-save-white");a.setLocalizationKey("McxCommonControl-mcxLayerManagerSave");a.getClickHandler().addListener(this.applyStyle,null,this);this._tabControl.addToolButton(a)};
McxLayerPropertiesPanel.prototype.onSubTypeImported=function(){switch(this.layer.getSubtypeType().getSubtypeType()){case McxSubtypeType.CodedValueSubtype:this._subtypeEngineView.setSelectedEditor(this._subtypeEngineView._editors[0]);this._subtypeEngineView._editors[0].setSelectedLayer(this.layer);break;case McxSubtypeType.RangedValueSubtype:this._subtypeEngineView.setSelectedEditor(this._subtypeEngineView._editors[2]);this._subtypeEngineView._editors[2].setSelectedLayer(this.layer);break;case McxSubtypeType.UniqueValueSubtype:this._subtypeEngineView.setSelectedEditor(this._subtypeEngineView._editors[1]),
this._subtypeEngineView._editors[1].setSelectedLayer(this.layer)}};
McxLayerPropertiesPanel.prototype.initialize=function(){this._rootElement=$("<div/>").addClass("mcx-layer-properties-panel");var a=new McxLayerInfoProperties(this.layer);this._tabControl.showTab(this.addTab("Information",a,"McxCommonControl-mcxLayerPropertiesInformation"));this.addLazyTab("Geometry",mcx.proxy(this.createGeometryPanel,this),"McxCommonControl-mcxLayerPropertiesGeometry");this.layer.isInstanceOf("IMcxLabeledLayer")&&this.addLazyTab("Labeling",mcx.proxy(this.createLabelingPanel,this),
"McxCommonControl-mcxLayerPropertiesLabeling");this.layer.isInstanceOf("IMcxSubtypedLayer")&&this.addLazyTab("Subtype",mcx.proxy(this.createSubtypeEngine,this),"McxCommonControl-mcxLayerPropertiesSubtype");0==this.layer.isInstanceOf("IMcxTileLayer")&&this.addLazyTab("Filter",mcx.proxy(this.createFilterPropertiesPanel,this),"McxCommonControl-mcxLayerPropertiesFiltering");this.createSaveToolButton();this._tabControl.getTabChangeHandler().addListener(function(){this._rootElement.find("div.mcxpanel:visible,div.mcxaccordion:visible,div.mcxlayout:visible,div.mcxtabs-container:visible").trigger("_resize",
[!0]);McxLocalizationManager.localizeContent(this._tabControl.getActiveTabPage().getControl().getContent());this.updateLayout()},null,this);this.base.addChild(this._rootElement,this._tabControl)};McxLayerPropertiesPanel.prototype.addTab=function(a,b,c){var d=new McxTabPage;d.setTitle(a);d.setTitleLocalizationKey(c);d.setControl(b);this._tabControl.addTabPage(d);return d};
McxLayerPropertiesPanel.prototype.addLazyTab=function(a,b,c){var d=new McxLazyTabPage;d.setTitle(a);d.setTitleLocalizationKey(c);d.setControlInitializer(b);this._tabControl.addTabPage(d);return d};
McxLayerPropertiesPanel.prototype.applyStyle=function(){McxLoadingIndicator.setAsBusy(this.getContent());this._layerGeometryPropertiesEditor&&this._layerGeometryPropertiesEditor.applyStyle();this._subtypeEngineView&&this._subtypeEngineView.applyStyle();mcx.isDefAndNotNull(this._layerLabelingPropertiesEditor)&&this._layerLabelingPropertiesEditor.applyStyle();if(this._layerFilterPropertiesEditor){var a=this._layerFilterPropertiesEditor.getAttributeFilter();this.layer.getFilterCollection().removeWithGuid(this._filterGuid);
if(""!=a){var b=new McxFilter;b.setAttributeFilter(a);b.setFilterId(this._filterGuid);this.layer.getFilterCollection().add(b)}}this.onSaveButtonClickHandler().dispatchOnSuccess(this,null);McxLoadingIndicator.setAsIdle(this.getContent())};McxLayerPropertiesPanel.prototype.onSaveButtonClick=function(){this.applyStyle()};McxLayerPropertiesPanel.prototype.onSaveButtonClickHandler=function(){return this._onSaveButtonClickHandler};McxLayerPropertiesPanel.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};
McxLayerPropertiesPanel.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.Layout={};js.framework.ui.McxCommonControl.Layout.McxLabeledEditor={};function McxLabeledEditor(a,b,c,d,e){mcx.base(this);this.base=this;this._editable=!0;this._rootElement=new McxLayoutRow;this._labelElement=null;this._editor=b;this._elementOrder=McxLabeledEditorElementOrder.labelFirst;this._label=a;this._labelSpanLength=d||3;this._isEnableCheckboxVisible=e||!1;this._disableCheckBox=new McxCheckBox;this.initialize();c&&this.setLabelLocalizationKey(c)}
mcx.inherits(McxLabeledEditor,McxUserControl);
McxLabeledEditor.prototype.initialize=function(){this._labelElement=$("<div/>").html(this._label).addClass("");this._rootElement.addClass("mcx-labeled-editor");this._disableCheckBox.onChangeHandler().addListener(function(){var a=!this._disableCheckBox.isChecked();this.setEditorEditability(a)},null,this);this.setLabelSpanLength(this._labelSpanLength);this.setDisableCheckBoxVisibility(this._isEnableCheckboxVisible);this._isEnableCheckboxVisible&&this.setEditorEditability(!this._disableCheckBox.isChecked());this._rootElement.getContent().addClass("vcenter");
this.base.registerChild(this._rootElement)};McxLabeledEditor.prototype.setLabelSpanLength=function(a){this._labelSpanLength=a;this._rootElement.clearContent();this._rootElement.createAndAddSpan(a,$("<div/>").append(this._disableCheckBox.getContent().css("display","inline-block")).append(this._labelElement.css("display","inline-block"))).addClass("mcx-labeled-editor-label");this._rootElement.createAndAddSpan(12-a,this._editor);return this};
McxLabeledEditor.prototype.setElementOrder=function(a){this._elementOrder=a;this._rootElement.clearContent();a==McxLabeledEditorElementOrder.editorFirst?(this._rootElement.createAndAddSpan(this._labelSpanLength,this._labelElement),this._rootElement.createAndAddSpan(12-this._labelSpanLength,this._editor)):(this._rootElement.createAndAddSpan(12-this._labelSpanLength,this._editor),this._rootElement.createAndAddSpan(this._labelSpanLength,this._labelElement))};McxLabeledEditor.prototype.getContent=function(){return this._rootElement.getContent()};
McxLabeledEditor.prototype.setLabelLocalizationKey=function(a){this._labelElement.attr("data-localize",a)};McxLabeledEditor.prototype.setLabelAsBold=function(){this._labelElement.css("font-weight","bold")};McxLabeledEditor.prototype.getEditor=function(){return this._editor};McxLabeledEditor.prototype.setDisableCheckBoxVisibility=function(a){a?this._rootElement.addClass("mcx-labeled-editor-disable-on"):this._rootElement.removeClass("mcx-labeled-editor-disable-on");this._isEnableCheckboxVisible=a};
McxLabeledEditor.prototype.setEditorEditability=function(a){a?this._editor.disable():this._editor.enable();this._editable=!a};McxLabeledEditor.prototype.getIsEditable=function(){return this._editable};js.framework.ui.McxCommonControl.Layout.McxLabeledEditorElementOrder={};var McxLabeledEditorElementOrder={labelFirst:0,editorFirst:1};js.framework.ui.McxCommonControl.Layout.McxLayoutRow={};function McxLayoutRow(){mcx.base(this);this._rootElement=null;this.base=this;this.initialize()}mcx.inherits(McxLayoutRow,McxUserControl);McxLayoutRow.prototype.initialize=function(){this._rootElement=$("<div/>").css("margin","5px 0").addClass("mcx-row-fluid")};McxLayoutRow.prototype.getContent=function(){return this._rootElement};
McxLayoutRow.prototype.createAndAddSpan=function(a,b,c){a=new McxLayoutSpan(a);c&&a.setOffset(c);a.setContent(b);this.base.addChild(this._rootElement,a);return a};McxLayoutRow.prototype.fit=function(){this._rootElement.addClass("fit")};McxLayoutRow.prototype.compact=function(){this._rootElement.find(".row-fluid").css("margin","auto")};McxLayoutRow.prototype.addSpan=function(a){this.base.addChild(this._rootElement,a);return this};
McxLayoutRow.prototype.setSpanAlignmentMode=function(a){a==McxLayoutSpanAlignmentMode.center?this._rootElement.addClass("vcenter"):this._rootElement.removeClass("vcenter")};McxLayoutRow.prototype.clearContent=function(){this.base.detachAllChildren();this._rootElement.children().detach()};McxLayoutRow.prototype.createAndAddSpanFluent=function(a,b,c){this.createAndAddSpan(a,b,c);return this};js.framework.ui.McxCommonControl.Layout.McxLayoutSpan={};function McxLayoutSpan(a){mcx.base(this);this._rootElement=null;this._lenght=a;this._offset=0;this.base=this;this.initialize()}mcx.inherits(McxLayoutSpan,McxUserControl);McxLayoutSpan.prototype.initialize=function(){this._rootElement=$("<div/>").addClass("mcx-span"+this._lenght)};McxLayoutSpan.prototype.getContent=function(){return this._rootElement};
McxLayoutSpan.prototype.setContent=function(a){this.base.detachAllChildren();this._rootElement.children().detach();this.addContent(a)};McxLayoutSpan.prototype.addContent=function(a){mcx.isInstanceOf(a,McxUserControl)?this.base.addChild(this._rootElement,a):this._rootElement.append(a);return this};McxLayoutSpan.prototype.setOffset=function(a){this._offset=a;this._rootElement.addClass("mcx-offset"+this._offset)};js.framework.ui.McxCommonControl.Layout.McxLayoutSpanAlignmentMode={};var McxLayoutSpanAlignmentMode={top:0,center:1};js.framework.ui.McxCommonControl.LegendControl={};js.framework.ui.McxCommonControl.LegendControl.McxLegendControl={};
function McxLegendControl(){mcx.base(this);this._rootElement=$("<div/>").addClass("mcx-legend-control");this._title=$("<div/>").css("font-weight","bold").addClass("mcx-legend-control-header");this._mainPanel=$("<div/>").addClass("mcx-legend-control-main-panel");this._headerItem=$("<div/>").addClass("header");this._headerText=$("<div/>").addClass("text");this._closeButton=$("<div/>").addClass("close-button").text("X").addClass("");this._mainCircle=$("<div/>").addClass("mcx-legend-control-main-circle");
this._circleContainer=$("<div/>").addClass("mcx-legend-control-circle-container");this.initialize()}mcx.inherits(McxLegendControl,McxUserControl);
McxLegendControl.prototype.initialize=function(){this._headerItem.append(this._headerText);this._headerItem.append(this._closeButton);this._mainPanel.append(this._headerItem);this._rootElement.append(this._mainPanel);this._circleContainer.append(this._mainCircle);this._rootElement.append($("<div style='padding: 0; display: inline-block; position: relative; width: 53px;'/>").append(this._circleContainer));this._mainCircle.on("click",$.proxy(this.onMainCircleClick,this));this._closeButton.on("click",
$.proxy(this.onContainerCloseButtonClick,this));this._rootElement.on("mousedown",function(a){a.stopPropagation()});this._rootElement.on("mousewheel",function(a){a.stopPropagation()})};McxLegendControl.prototype.onMainCircleClick=function(){this._circleContainer.toggleClass("open");this._mainPanel.toggleClass("active")};
McxLegendControl.prototype.addLayerSubTypeList=function(a,b){this._rootElement.addClass("show");this.removeSubtypeList(a);var c=$("<div/>").addClass("mcx-legend-control-group-circle").addClass(a).data("layerName",a).data("fieldName",b);c.append($("<span/>").addClass("mcx-legend-control-group-circle-layer").text(a));c.append($("<span/>").addClass("mcx-legend-control-group-circle-field").text(b));0==this._circleContainer.find(".mcx-legend-control-group-circle.active").length&&c.addClass("active");this._circleContainer.prepend(c);
c.on("click",$.proxy(this.onLayerSelected,this));this.createLegendContent(a,b)};McxLegendControl.prototype.removeSubtypeList=function(a){this._rootElement.find("."+a).remove()};McxLegendControl.prototype.onContainerCloseButtonClick=function(){this._mainPanel.removeClass("active");this._circleContainer.removeClass("open")};
McxLegendControl.prototype.add=function(a,b,c){a=this._mainPanel.find("."+a+" .item-container");var d=$("<div/>").addClass("subtype-item");b=$("<div/>").addClass("status").css("background",b);var e=$("<img/>").prop("src",McxPathFinder.getFullPath("$McxCommonControl/assets/img/legendControl/cloud.png"));c=$("<div/>").addClass("dataColor-description").html(c);b.html(e);d.append(b).append(c);a.append(d)};
McxLegendControl.prototype.onLayerSelected=function(a){this._circleContainer.find(".mcx-legend-control-group-circle").removeClass("active");$(a.target).addClass("active");this._mainPanel.find(".container").removeClass("active");this._mainPanel.find("."+$(a.target).data("layerName")).eq(0).addClass("active");this._headerText.text($(a.target).data("layerName").toString())};
McxLegendControl.prototype.createLegendContent=function(a,b){var c=$("<div/>").addClass("container").addClass(a).data("layerName",a).data("fieldName",b);c.append($("<div/>").addClass("field-item").text(b));c.append($("<div/>").addClass("item-container"));0==this._mainPanel.find(".container.active").length&&(c.addClass("active"),this._headerText.text(a));this._mainPanel.append(c)};McxLegendControl.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.LineSymbolizerEditor={};js.framework.ui.McxCommonControl.LineSymbolizerEditor.McxLineSymbolizerEditor={};function McxLineSymbolizerEditor(){mcx.base(this);this.base=this;this._strokeEditor=this._lineSymbolizer=this._rootElement=null;this._isApplyImmediately=!1;this._strokeGroup=null;this.initialize()}mcx.inherits(McxLineSymbolizerEditor,McxUserControl);
McxLineSymbolizerEditor.prototype.initialize=function(){this._rootElement=$("<div/>");this._strokeEditor=new McxStrokeEditor;this._strokeGroup=new McxGroupBox("Stroke");this._strokeGroup.setCanBeDisabled(!0);this._strokeGroup.setLocalizationKeyForTitle("McxCommonControl-mcxLayerPropertiesStroke");this._strokeGroup.addContent(this._strokeEditor);var a=new McxLayoutRow;a.createAndAddSpan(6,this._strokeGroup).setOffset(3);this.base.addChild(this._rootElement,a);this._strokeEditor.getOnStrokeChangeHandler().addListener(function(){this.onStyleChange()},
null,this);this._strokeGroup.getEnabledChangeHandler().addListener(function(){this.onStyleChange()},null,this)};McxLineSymbolizerEditor.prototype.onStyleChange=function(){this._isApplyImmediately&&this.applyStyle()};McxLineSymbolizerEditor.prototype.setLineSymbolizer=function(a){this._lineSymbolizer=a;this._strokeEditor.setStroke(this._lineSymbolizer.getStroke())};McxLineSymbolizerEditor.prototype.setIsApplyImmediately=function(a){this._isApplyImmediately=a};
McxLineSymbolizerEditor.prototype.getContent=function(){return this._rootElement};McxLineSymbolizerEditor.prototype.applyStyle=function(){if(this._strokeGroup.getIsEnabled()){if(0==mcx.isDefAndNotNull(this._lineSymbolizer.getStroke())){var a=this._strokeEditor.getStroke();this._lineSymbolizer.setStroke(a)}this._strokeEditor.applyStroke()}else this._lineSymbolizer.setStroke(null)};js.framework.ui.McxCommonControl.LoadingIndicator={};js.framework.ui.McxCommonControl.LoadingIndicator.McxLoadingIndicator={};function McxLoadingIndicator(a){mcx.base(this);this.base=this;this._type=a?a:McxLoadingType.Dots;this._dataLoadingPanelKey="loadingPanel"}mcx.inherits(McxLoadingIndicator,McxUserControl);McxLoadingIndicator.prototype.initialize=function(){};
McxLoadingIndicator.prototype.setAsBusy=function(a,b){a=a||$("body");var c=new McxLoadingPanel(a,this._type);c.setIsCancelable(b||!1);c.show();a.data(this._dataLoadingPanelKey,c);return c};McxLoadingIndicator.prototype.setAsIdle=function(a){a=a||$("body");var b=a.data(this._dataLoadingPanelKey);b&&(a.data(this._dataLoadingPanelKey,null),b.close())};McxLoadingIndicator.getInstance=function(a){McxLoadingIndicator._instance=new McxLoadingIndicator(a);return McxLoadingIndicator._instance};
McxLoadingIndicator.setAsBusy=function(a,b,c){return McxLoadingIndicator.getInstance(c).setAsBusy(a,b)};McxLoadingIndicator.setAsIdle=function(a){McxLoadingIndicator.getInstance().setAsIdle(a)};js.framework.ui.McxCommonControl.LoadingPanel={};js.framework.ui.McxCommonControl.LoadingPanel.McxLoadingPanel={};function McxLoadingPanel(a,b){mcx.base(this);this._rootElement=$("<div/>");this._type=b?b:McxLoadingType.Dots;this._cancelButton=new McxButton;this._targetElement=a;this._textElement=null;this._dataLoadingElementKey="loadingElement";this.base=this;this.initialize()}mcx.inherits(McxLoadingPanel,McxUserControl);
McxLoadingPanel.prototype.initialize=function(){var a=this._targetElement.data(this._dataLoadingElementKey);if(!mcx.isDefAndNotNull(a)){var b=this._targetElement.not("input")||this._targetElement.not("html")||this._targetElement.not("textarea")?this._targetElement:this._targetElement.parent(),a=b.css("position");"relative"!=a&&"absolute"!=a&&b.css("position","relative");a=$("<div/>").css("display","none").css("top",0).css("bottom",0).addClass("mcx-modal");this._textElement=$("<div/>").attr("data-localize-for",
"content").addClass("mcx-loading-panel-text");this._cancelButton.setImage(McxPathFinder.getFullPath("$McxCommonControl/assets/img/loading/cancel16.png"));this._cancelButton.setButtonState(McxButtonState.error);this._cancelButton.setButtonSize(McxButtonSize.small);this._cancelButton.setText("Cancel");this._cancelButton.setLocalizationKey("McxCommonControl-mcxUICancel");this._cancelButton.getContent().css("position","absolute").css("top","10px").css("right","10px");this._cancelButton.hide();this._cancelButton.getClickHandler().addListener(this.close,
null,this);var c=this.visibleArea(this._targetElement[0]);this._targetElement!=b?a.css("top",this._targetElement.position().top).css("bottom",this._targetElement.position().bottom).width(c.getWidth()).height(c.getHeight()):a.css("left",0).css("right",0);this._targetElement.data(this._dataLoadingElementKey,a);this.base.addChild(a,this._cancelButton);a.append(this._textElement);b.append(a);this._type==McxLoadingType.Dots?a.append('<div class="mcx-loading-dots blue"><div class="mcx-loading-dot delay-12"></div><div class="mcx-loading-dot delay-10"></div><div class="mcx-loading-dot delay-8"></div><div class="mcx-loading-dot delay-6"></div><div class="mcx-loading-dot delay-4"></div><div class="mcx-loading-dot delay-2"></div><div class="mcx-loading-dot"></div></div>'):
this._type==McxLoadingType.Square?a.append('</div><div class="mcx-load-dots square"><div class="mcx-load-dot"></div><div class="mcx-load-dot delay-05"></div><div class="mcx-load-dot delay-01"></div><div class="mcx-load-dot delay-15"></div><div class="mcx-load-dot delay-02"></div><div class="mcx-load-dot delay-25"></div><div class="mcx-load-dot delay-03"></div><div class="mcx-load-dot delay-35"></div></div>'):this._type==McxLoadingType.Image?(b=$("<div/>").addClass("loading-image"),b.append($("<div/>").addClass("world")),
b.append($("<div/>").addClass("image")),a.append(b)):this._type==McxLoadingType.ImageSmall&&(b=$("<div/>").addClass("loading-image small"),b.append($("<div/>").addClass("world")),b.append($("<div/>").addClass("image")),a.append(b));this._rootElement=a;McxLocalizationManager.localizeContent(this._rootElement)}};McxLoadingPanel.prototype.setIsCancelable=function(a){a?this._cancelButton.show():this._cancelButton.hide()};
McxLoadingPanel.prototype.setText=function(a){this._textElement.attr("data-localize",a);this._textElement.text(a)};McxLoadingPanel.prototype.show=function(){this._rootElement.css("display","block")};McxLoadingPanel.prototype.hide=function(){this._rootElement.css("display","none")};McxLoadingPanel.prototype.close=function(){this._targetElement.data(this._dataLoadingElementKey,null);this.base.dispose()};McxLoadingPanel.prototype.getCancelEventHandler=function(){return this._cancelButton.getClickHandler()};
McxLoadingPanel.prototype.getContent=function(){return this._rootElement};var McxLoadingType={Dots:0,Image:1,ImageSmall:2,Square:3};js.framework.ui.McxCommonControl.MarkSelector={};js.framework.ui.McxCommonControl.MarkSelector.McxMarkSelector={};function McxMarkSelector(){mcx.base(this);this._rootElement=$("<div/>");this.base=this;this._wellKnowMarkSelectBox=new McxSelectBox;this._fillEditor=new McxFillEditor;this._editorTextArea=null;this._strokeEditor=new McxStrokeEditor;this._styleRow=new McxLayoutRow;this._htmlRow=new McxLayoutRow;this._onMarkChangeHandler=new McxEventHandler;this.initialize()}
mcx.inherits(McxMarkSelector,McxUserControl);McxMarkSelector.prototype.createEditor=function(){this._editorTextArea=(new McxTextArea).getContent().find("textarea");this._htmlRow.createAndAddSpan(12,this._editorTextArea)};
McxMarkSelector.prototype.initialize=function(){this._wellKnowMarkSelectBox.setTextGetter("getWellKnownName");this._wellKnowMarkSelectBox.setValueGetter("getWellKnownName");this._wellKnowMarkSelectBox.addItem(new McxCrossMark);this._wellKnowMarkSelectBox.addItem(new McxDiagCrossMark);this._wellKnowMarkSelectBox.addItem(new McxCircleMark);this._wellKnowMarkSelectBox.addItem(new McxSquareMark);this._wellKnowMarkSelectBox.addItem(new McxTriangleMark);this._wellKnowMarkSelectBox.addItem(new McxStarMark);
var a=new McxContentSymbol(document.createElement("div"));a.getWellKnownName=function(){return"custom html"};this._wellKnowMarkSelectBox.addItem(a);this._wellKnowMarkSelectBox.getOnSelectHandler().addListener(this.onMarkSelect,null,this);this._wellKnowMarkSelectBox.getContent().find("option").each(function(a,b){var e=$(b).text().replace(" ","_");$(b).attr("data-localize","McxCommonControl-MarkSelector"+e)});a=new McxGroupBox("Fill");a.setLocalizationKeyForTitle("McxCommonControl-Fill");a.addContent(this._fillEditor);
var b=new McxGroupBox("Stroke");b.setLocalizationKeyForTitle("McxCommonControl-Stroke");b.addContent(this._strokeEditor);this._fillEditor.setFill(new McxFill);this._strokeEditor.setStroke(new McxStroke);this._styleRow.createAndAddSpan(6,a);this._styleRow.createAndAddSpan(6,b);this.createEditor();a=new McxLabeledEditor("McxCommonControl-Mark",this._wellKnowMarkSelectBox);a.setLabelLocalizationKey("McxCommonControl-Mark");this.base.addChild(this._rootElement,a);this.base.addChild(this._rootElement,
this._styleRow);this.base.addChild(this._rootElement,this._htmlRow);this._fillEditor.getFillChangeHandler().addListener(this.markChanged,null,this);this._strokeEditor.getOnStrokeChangeHandler().addListener(this.markChanged,null,this);this._wellKnowMarkSelectBox.getOnSelectHandler().addListener(this.markChanged,null,this);this._editorTextArea.keydown(mcx.proxy(this.markChanged,this))};
McxMarkSelector.prototype.onMarkSelect=function(){this._fillEditor.applyFill();this._strokeEditor.applyStroke();var a=this._wellKnowMarkSelectBox.getSelectedItem(),b=mcx.isInstanceOf(a,McxContentSymbol);a&&!b?(this._styleRow.show(),this._htmlRow.hide(),this._fillEditor.setFill(a.getFill()),this._strokeEditor.setStroke(a.getStroke())):a&&b&&(this._styleRow.hide(),this._htmlRow.show(),this._htmlRow.getContent().find("textarea").focus(),a=a.getContent(),$(a).html(this._editorTextArea.val()))};
McxMarkSelector.prototype.applyCustomHtmlStyle=function(){var a=this._wellKnowMarkSelectBox.getSelectedItem(),b=a&&mcx.isInstanceOf(a,McxContentSymbol);a&&b&&(this._styleRow.hide(),this._htmlRow.show(),a=a.getContent(),$(a).html(this._editorTextArea.val()))};McxMarkSelector.prototype.getMark=function(){this._fillEditor.applyFill();this._strokeEditor.applyStroke();this.applyCustomHtmlStyle();return this._wellKnowMarkSelectBox.getSelectedItem()};
McxMarkSelector.prototype.setSelectedMark=function(a){if(a)if(mcx.isInstanceOf(a,McxContentSymbol)){if(this._wellKnowMarkSelectBox.setSelectedValue("custom html"),a=a.getContent()){a=$(a)[0].outerHTML;this._editorTextArea.val(a);var b=this._rootElement.find("iframe");0<b.length&&(b[0].src="data:text/html;charset=utf-8,"+a)}}else a.getWellKnownName&&(this._wellKnowMarkSelectBox.setSelectedValue(a.getWellKnownName()),b=this._wellKnowMarkSelectBox.getSelectedItem())&&(b.setFill(a.getFill()),b.setStroke(a.getStroke()),
this._fillEditor.setFill(a.getFill()),this._strokeEditor.setStroke(a.getStroke()))};McxMarkSelector.prototype.onMarkChange=function(){return this._onMarkChangeHandler};McxMarkSelector.prototype.markChanged=function(){this.onMarkChange().dispatchOnSuccess(this,null)};McxMarkSelector.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.MediaContainer={};js.framework.ui.McxCommonControl.MediaContainer.McxMedia={};function McxMedia(a,b){mcx.base(this);this.base=this;this._category=b;this._feature=a;this._mediaManager=a.getLayer();this._dataSource=a.getLayer().getDataSource();this.mediaContents=[];this.mediaCounter=0;this.initializeContents()}mcx.inherits(McxMedia,McxUserControl);
McxMedia.prototype.initializeContents=function(){this.mediaContents=[];var a=this._category.getCategoryId(),b=new McxAjaxParameter;b.setParameters(this,this.onGetMediaInfoSuccess,function(){});this._mediaManager.getMediaInfoByFeatureId(this._feature.getFeatureID(),a,b)};
McxMedia.prototype.onGetMediaInfoSuccess=function(a){a=a.getMediaInfo();for(var b=0;b<a.length;b++){var c=a[b],d=c.getMediaId(),e=new McxAjaxParameter;e.setParameters(this,this.onGetMediaDataSuccess,function(){});e.setArgs([d,c.getOriginalFileName(),a.length]);this._feature.getLayer().getMediaData(d,e)}if(0==a.length)this.onMediaContentsInitialized()};
McxMedia.prototype.onGetMediaDataSuccess=function(a){var b=a.getMediaData();a=a.getArgs();var c=new McxMediaContent(a[0],a[1]);c.setMediaUrl(b);this.mediaContents.push(c);if(this.mediaContents.length==a[2])this.onMediaContentsInitialized()};McxMedia.prototype.onMediaContentsInitialized=function(){};McxMedia.prototype.onDownloadButtonClick=function(){if(this.base.mediaContents&&0!=this.base.mediaContents.length){var a=this.mediaContents[this.base.mediaCounter-1].getMediaUrl();window.open(a,"_blank")}};
McxMedia.prototype.addMediaFile=function(a){if(null!=this.base._category){var b=new McxAjaxParameter;b.setParameters(this,function(a){this.initializeContents();this.mediaCounter=this.mediaContents.length;McxLoadingIndicator.setAsIdle(this.base.getContent())},function(a){McxLoadingIndicator.setAsIdle(this.base.getContent());McxMessageBox.show(null,a.getExceptionMessage().getException(),McxMessageBoxType.Error)});var c=this.base._feature.getGlobalID();McxLoadingIndicator.setAsBusy(this.base.getContent());
var d=this.base._feature.getFeatureID();this._mediaManager.addMediaContent(this.base._category.getCategoryId(),c,d,0,a,b)}};
McxMedia.prototype.onDeleteButtonClick=function(){if(null!=this._category){var a=null;if(0==this.mediaCounter&&1==this.base.mediaContents.length)a=this.base.mediaContents[this.mediaCounter];else if(0<this.mediaCounter&&0!=this.base.mediaContents.length)a=this.base.mediaContents[this.mediaCounter-1];else if(0==this.base.mediaContents.length)return;var b=new McxAjaxParameter;b.setParameters(this,function(a){this.mediaContents.splice(this.mediaCounter-1,1);1<this.mediaCounter&&this.mediaCounter--;this.reloadMedia();
McxLoadingIndicator.setAsIdle(this.base.getContent())},function(a){McxMessageBox.show(null,this.base.getLocaleValue("McxCommonControl-mcxMediaDeleteFailed"),McxMessageBoxType.Error);McxLoadingIndicator.setAsIdle(this.base.getContent())});this.base._feature.getLayer().deleteMedia(a.getMediaId(),b);McxLoadingIndicator.setAsBusy(this.base.getContent())}};McxMedia.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};McxMedia.prototype.getMediaCounter=function(){return this.mediaCounter};
McxMedia.prototype.setMediaCounter=function(a){this.mediaCounter=a};McxMedia.prototype.getMediaType=mcx.abstractMethod;McxMedia.prototype.reloadMedia=mcx.abstractMethod;js.framework.ui.McxCommonControl.MediaContainer.McxFileMedia={};function McxFileMedia(a,b){mcx.base(this,a,b);this._rootElement=$("<div/>");this._fileListBox=new McxListBox;this.base=this}mcx.inherits(McxFileMedia,McxMedia);
McxFileMedia.prototype.onMediaContentsInitialized=function(){var a=this;this._rootElement.css("display","table").css("width","100%").css("height","100%");this._rootElement.empty();var b=$("<div/>").css("height","40px").css("display","table-row"),c=$("<div/>").css("height","40px").css("display","table-row").css("vertical-align","middle").css("text-align","center").addClass("").clone().css("text-align","right").css("height","40px").css("width","45%").css("display","none"),d=$("<div/>").css("display",
"table-row").css("border","1x solid #ccc").addClass("mcx-icon-no-image").addClass("mcx-mcx-content-area-container"),e=$("<div/>").css("padding","10px").css("height","70%").css("display","table-cell").css("vertical-align","middle").css("text-align","center").addClass("mcx-content-area-container");d.append(e);this._fileListBox.clear();this._fileListBox.setTextGetter("getMediaName");this._fileListBox.setValueGetter("getMediaId");this._fileListBox.css("height","100%");this._fileListBox.getContent().find("select").css("height",
"100%");this._fileListBox.setVisibleItemCount(5);this._fileListBox.getOnSelectHandler().addListener(function(){var a=this._fileListBox.getSelectedItem();if(1==a.length)for(var a=a[0],b=0;b<this.base.mediaContents.length;b++)if(this.base.mediaContents[b].getMediaId()==a.getMediaId()){this.base.mediaCounter=b+1;break}},null,this);var f=$("<input/>").attr("type","file").prop("accept","*").addClass("filestyle");f.change(function(){a.addMediaFile(this.files[0])});c.append(f);f.hide();var g=new McxCommonToolBar,
h=new McxCommonToolBarItem;h.setImageClass("icon-add");h.setText("Dosya Ekle");h.setLocalizationKey("McxCommonControl-mcxUploadFileButton");h.getOnClickHandler().addListener(function(){f.click()},null,this);var k=new McxCommonToolBarItem;k.setImageClass("icon-remove");k.setText("Sil");k.setLocalizationKey("McxCommonControl-mcxDeleteButton");k.getOnClickHandler().addListener(this.base.onDeleteButtonClick,null,this);var m=new McxCommonToolBarItem;m.setImageClass("icon-download-media");m.setText("\u0130ndir");
m.setLocalizationKey("McxCommonControl-mcxDownloadButton");m.getOnClickHandler().addListener(this.base.onDownloadButtonClick,null,this);g.addToolBarItem(h);g.addToolBarItem(k);g.addToolBarItem(m);this.base.addChild(b,g);e.append(this._fileListBox.getContent());this._rootElement.append(b).append(d).append(c);this.reloadMedia()};McxFileMedia.prototype.reloadMedia=function(){this._fileListBox.clear();this._fileListBox.addItemRange(this.base.mediaContents)};McxFileMedia.prototype.getContent=function(){return this._rootElement};
McxFileMedia.prototype.getMediaType=function(){return McxMediaType.File};js.framework.ui.McxCommonControl.MediaContainer.McxImageMedia={};function McxImageMedia(a,b){mcx.base(this,a,b);this._rootElement=$("<div/>");this._image=$("<div/>");this._imageCountSpan=null;this.base.mediaCounter=1;this.base=this}mcx.inherits(McxImageMedia,McxMedia);
McxImageMedia.prototype.onMediaContentsInitialized=function(){this._rootElement.css("display","table").css("width","100%").css("height","100%");this._rootElement.empty();var a=$("<div/>").css("height","40px").css("display","table-row"),b=$("<div/>").css("height","40px").css("display","table-row").css("vertical-align","middle").css("text-align","center").addClass(""),c=b.clone().css("text-align","right").css("height","40px").css("width","45%").css("display","none");this._imageRow=$("<div/>").css("display",
"table-row").css("border","1x solid #ccc").addClass("mcx-icon-no-image").addClass("mcx-mcx-content-area-container");var d=$("<div/>").css("padding","10px").css("height","70%").css("display","table-cell").css("vertical-align","middle").css("text-align","center").addClass("mcx-content-area-container");this._image=$("<img>").css("max-width","375px").css("max-height","200px").appendTo(d);this._imageRow.append(d);var e=$("<input/>").attr("type","file").prop("accept","image").addClass("filestyle"),f=this;
e.change(function(){f.addMediaFile(this.files[0])});c.append(e);e.hide();d=new McxButton;d.setButtonVisualType(McxButtonVisualType.linkButton);d.setText("Sonraki");d.setLocalizationKey("McxCommonControl-mcxNextButton");d.setButtonSize(McxButtonSize.small);d.setButtonState(McxButtonState.active);d.getClickHandler().addListener(this.onNextButtonClick,null,this);var g=new McxButton;g.setButtonVisualType(McxButtonVisualType.linkButton);g.setText("\u00d6nceki");g.setLocalizationKey("McxCommonControl-mcxPreviousButton");
g.setButtonSize(McxButtonSize.small);g.setButtonState(McxButtonState.active);g.getClickHandler().addListener(this.onPrevButtonClick,null,this);var h=new McxCommonToolBar,k=new McxCommonToolBarItem;k.setImageClass("icon-add");k.setText("Resim ekle");k.setLocalizationKey("McxCommonControl-mcxUploadButton");var m=new McxCommonToolBarItem;m.setImageClass("icon-download-media");m.setText("\u0130ndir");m.setLocalizationKey("McxCommonControl-mcxDownloadButton");m.getOnClickHandler().addListener(this.base.onDownloadButtonClick,
null,this);k.getOnClickHandler().addListener(function(){e.click()},null,this);var n=new McxCommonToolBarItem;n.setImageClass("icon-remove");n.setText("Sil");n.setLocalizationKey("McxCommonControl-mcxDeleteButton");n.getOnClickHandler().addListener(this.base.onDeleteButtonClick,null,this);h.addToolBarItem(k);h.addToolBarItem(n);h.addToolBarItem(m);k=0;0<this.base.mediaContents.length&&(k=1);this._imageCountSpan=$("<span/>").text(k+"/"+this.base.mediaContents.length).css("margin-right","10px");this.base.addChild(a,
h);this.base.addChild(b,g);b.append(this._imageCountSpan);this.base.addChild(b,d);this._rootElement.append(a).append(this._imageRow).append(b).append(c);this.getImage(this.base.mediaContents[0].getMediaUrl())};McxImageMedia.prototype.onNextButtonClick=function(){this.base.mediaCounter<this.base.mediaContents.length&&(this.base.mediaCounter++,this.reloadMedia())};McxImageMedia.prototype.onPrevButtonClick=function(){1<this.base.mediaCounter&&(this.base.mediaCounter--,this.reloadMedia())};
McxImageMedia.prototype.reloadMedia=function(){this._imageCountSpan.text(this.base.mediaCounter+"/"+this.base.mediaContents.length).css("margin-right","10px");0<this.base.mediaCounter?this.getImage(this.base.mediaContents[this.base.mediaCounter-1].getMediaUrl()):(this._imageRow.addClass("mcx-icon-no-image"),this._image.attr("src","").hide())};McxImageMedia.prototype.getContent=function(){return this._rootElement};McxImageMedia.prototype.getMediaType=function(){return McxMediaType.Image};
McxImageMedia.prototype.getImage=function(a){if(null==a||""==a)return null;this._image.attr("src",a).show();this._image.unbind("click");this._image.click(function(){var b=new b(a);b.getImageLoaded().addListener(function(){b.showDialog(!1,!1)},null,this)});this._imageRow.removeClass("mcx-icon-no-image")};js.framework.ui.McxCommonControl.MediaContainer.McxMediaContainer={};function McxMediaContainer(a,b){mcx.base(this);this.base=this;this._dataSource=null;this._mediaCategories=[];this._mediaCategorySelectBox=new McxSelectBox;this._feature=a;this._mediaRow=null;this._container=b;this.initialize()}mcx.inherits(McxMediaContainer,McxUserControl);
McxMediaContainer.prototype.initialize=function(){var a=$("<div/>").css("display","table").css("width","100%").css("height","100%"),b=$("<div/>").css("text-align","center").css("display","table-row").css("height","30px").css("padding","5px 0").addClass("mcx-content-area-container");this._mediaRow=$("<div/>").css("display","table-row").addClass("mcx-mcx-content-area-container");a.append(b).append(this._mediaRow);this._container.append(a).css("height","100%").css("padding","10px").addClass("box-sizing-bordered");
this._mediaCategorySelectBox.setValueGetter("getCategoryId");this._mediaCategorySelectBox.setTextGetter("getCategoryName");this._mediaCategorySelectBox.getOnSelectHandler().addListener(this.updateMediaUI,null,this);a=new McxLabeledEditor("Katalog Se\u00e7",this._mediaCategorySelectBox);a.setLabelLocalizationKey("McxCommonControl-mcxChooseCatalogLabel");this.base.addChild($("<div/>").appendTo(b),a);this.initMediaCategories()};
McxMediaContainer.prototype.initMediaCategories=function(){var a=this._feature.getLayer();if(a.isInstanceOf("IMcxMediaManager")){McxLoadingIndicator.getInstance().setAsBusy(this.getContent());var b=new McxAjaxParameter;b.setParameters(this,function(a){McxLoadingIndicator.getInstance().setAsIdle(this.getContent());this._mediaCategories=a.getMediaCategories();this._mediaCategorySelectBox.addItemRange(this._mediaCategories);this.updateMediaUI()},function(a){McxLoadingIndicator.getInstance().setAsIdle(this.getContent());
a=McxLocalizationManager.getLocaleValue("McxCommonControl-noCategory").toString();McxMessageBox.show("",a,McxMessageBoxType.Error,McxDialogButtons.ok)});this.resultRequest=a.getMediaCategories(b).getRequest()}};
McxMediaContainer.prototype.updateMediaUI=function(){var a=this._mediaCategorySelectBox.getSelectedItem();a&&(McxButtonAuthorityHelper.instance.getButtonVisibility(McxButtonAuthorityType.FeatureExplorerMediaSaveAndDeleteButton),a.getMediaType()==McxMediaType.File?(this._mediaRow.children().detach(),a=new McxFileMedia(this._feature,a),this._mediaRow.append(a.getContent()),this.base.registerChild(a),a.localize()):a.getMediaType()==McxMediaType.Image?(this._mediaRow.children().detach(),a=new McxImageMedia(this._feature,
a),this._mediaRow.append(a.getContent()),this.base.registerChild(a),a.localize()):a.getMediaType()==McxMediaType.Video?(this._mediaRow.children().detach(),a=new McxVideoMedia(this._feature,a),this._mediaRow.append(a.getContent()),this.base.registerChild(a),a.localize()):a.getMediaType()==McxMediaType.Panaroma&&(this._mediaRow.children().detach(),a=new McxPanoramicImageMedia(this._feature,a),this._mediaRow.append(a.getContent()),this.base.registerChild(a),a.localize()))};
McxMediaContainer.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};McxMediaContainer.prototype.getContent=function(){return this._container};js.framework.ui.McxCommonControl.MediaContainer.McxPanoramicImageMedia={};function McxPanoramicImageMedia(a,b){mcx.base(this,a,b);this._rootElement=$("<div/>");this._image=$("<div/>");this._panoramicImageViewer=new McxPanoramicImageViewer;this._imageCountSpan=this._file=null;this.base=this}mcx.inherits(McxPanoramicImageMedia,McxMedia);
McxPanoramicImageMedia.prototype.initialize=function(){var a=this;this._rootElement.css("display","table").css("width","100%").css("height","100%");var b=$("<div/>").css("height","40px").css("display","table-row"),c=$("<div/>").css("height","40px").css("display","table-row").css("vertical-align","middle").css("text-align","center").addClass(""),d=c.clone().css("text-align","right").css("height","40px").css("width","45%").css("display","none"),e=$("<div/>").css("display","table-row").css("border",
"1x solid #ccc").addClass("mcx-icon-no-image").addClass("mcx-mcx-content-area-container"),f=$("<div/>").css("padding","10px").css("height","70%").css("display","table-cell").css("vertical-align","middle").css("text-align","center").addClass("mcx-content-area-container");f.append(this._panoramicImageViewer.getContent());e.append(f);var g=$("<input/>").attr("type","file").prop("accept","image").addClass("filestyle");g.change(function(){a.addMediaFile(this.files[0])});d.append(g);g.hide();f=new McxButton;
f.setButtonVisualType(McxButtonVisualType.linkButton);f.setText("Sonraki");f.setLocalizationKey("McxCommonControl-mcxNextButton");f.setButtonSize(McxButtonSize.small);f.setButtonState(McxButtonState.active);f.getClickHandler().addListener(this.nextButtonClick,null,this);var h=new McxButton;h.setButtonVisualType(McxButtonVisualType.linkButton);h.setText("\u00d6nceki");h.setLocalizationKey("McxCommonControl-mcxPreviousButton");h.setButtonSize(McxButtonSize.small);h.setButtonState(McxButtonState.active);
h.getClickHandler().addListener(this.prevButtonClick,null,this);var k=new McxCommonToolBar,m=new McxCommonToolBarItem;m.setImageClass("icon-add");m.setText("Resim ekle");m.setLocalizationKey("McxCommonControl-mcxUploadButton");m.getOnClickHandler().addListener(function(){g.click()},null,this);var n=new McxCommonToolBarItem;n.setImageClass("icon-remove");n.setText("Sil");n.setLocalizationKey("McxCommonControl-mcxDeleteButton");n.getOnClickHandler().addListener(this.base.onDeleteButtonClick,null,this);
k.addToolBarItem(m);k.addToolBarItem(n);m=0;0<this.base.mediaContents.length&&(m=1);this._imageCountSpan=$("<span/>").text(m+"/"+this.base.mediaContents.length).css("margin-right","10px");this.base.addChild(b,k);this.base.addChild(c,h);c.append(this._imageCountSpan);this.base.addChild(c,f);this._rootElement.append(b).append(e).append(c).append(d);this._imageRow=e;this.getImage(this.base.mediaContents[0])};
McxPanoramicImageMedia.prototype.nextButtonClick=function(){this.base.getMediaCounter()<this.base.mediaContents.length&&(this.setMediaCounter(this.base.getMediaCounter()+1),this.reloadMedia())};McxPanoramicImageMedia.prototype.prevButtonClick=function(){1<this.base.getMediaCounter()&&(this.base.setMediaCounter(this.base.getMediaCounter()-1),this.reloadMedia())};
McxPanoramicImageMedia.prototype.reloadMedia=function(){this._imageCountSpan.text(this.base.getMediaCounter()+"/"+this.base.mediaContents.length).css("margin-right","10px");0<this.base.getMediaCounter()?this.getImage(this.base.mediaContents[this.base.getMediaCounter()-1]):(this._imageRow.addClass("mcx-icon-no-image"),this._panoramicImageViewer.setImagePath(""))};McxPanoramicImageMedia.prototype.getContent=function(){return this._rootElement};McxPanoramicImageMedia.prototype.getMediaType=function(){return McxMediaType.Panaroma};
McxPanoramicImageMedia.prototype.getImage=function(a){null!=a&&(a=a.getMediaUrl(),this._panoramicImageViewer.setImagePath(a),this._imageRow.removeClass("mcx-icon-no-image"))};js.framework.ui.McxCommonControl.MediaContainer.McxVideoMedia={};function McxVideoMedia(a,b){mcx.base(this,a,b);this._rootElement=$("<div/>");this._video=$("<div/>");this._videoCountSpan=this._file=null;this.base=this}mcx.inherits(McxVideoMedia,McxMedia);
McxVideoMedia.prototype.onMediaContentsInitialized=function(){var a=this;this._rootElement.css("display","table").css("width","100%").css("height","100%");this._rootElement.empty();var b=$("<div/>").css("height","40px").css("display","table-row"),c=$("<div/>").css("height","40px").css("display","table-row").css("vertical-align","middle").css("text-align","center").addClass(""),d=c.clone().css("text-align","right").css("height","40px").css("width","45%").css("display","none"),e=$("<div/>").css("display",
"table-row").css("border","1x solid #ccc").addClass("mcx-icon-no-image").addClass("mcx-mcx-content-area-container"),f=$("<div/>").css("padding","10px").css("height","70%").css("display","table-cell").css("vertical-align","middle").css("text-align","center").addClass("mcx-content-area-container");this._video=$("<video>").prop("autoplay","true").prop("controls","true").css("max-width","375px").css("max-height","200px").appendTo(f);e.append(f);var g=$("<input/>").attr("type","file").prop("accept","video").addClass("filestyle");
g.change(function(){a.addMediaFile(this.files[0])});d.append(g);g.hide();f=new McxButton;f.setButtonVisualType(McxButtonVisualType.linkButton);f.setText("Sonraki");f.setLocalizationKey("McxCommonControl-mcxNextButton");f.setButtonSize(McxButtonSize.small);f.setButtonState(McxButtonState.active);f.getClickHandler().addListener(this.nextButtonClick,null,this);var h=new McxButton;h.setButtonVisualType(McxButtonVisualType.linkButton);h.setText("\u00d6nceki");h.setLocalizationKey("McxCommonControl-mcxPreviousButton");
h.setButtonSize(McxButtonSize.small);h.setButtonState(McxButtonState.active);h.getClickHandler().addListener(this.onPrevButtonClick,null,this);var k=new McxCommonToolBar,m=new McxCommonToolBarItem;m.setImageClass("icon-add");m.setText("Video ekle");m.setLocalizationKey("McxCommonControl-mcxUploadVideoButton");m.getOnClickHandler().addListener(function(){g.click()},null,this);var n=new McxCommonToolBarItem;n.setImageClass("icon-remove");n.setText("Sil");n.setLocalizationKey("McxCommonControl-mcxDeleteButton");
n.getOnClickHandler().addListener(this.base.onDeleteButtonClick,null,this);k.addToolBarItem(m);k.addToolBarItem(n);m=0;0<this.base.mediaContents.length&&(m=1);this._videoCountSpan=$("<span/>").text(m+"/"+this.base.mediaContents.length).css("margin-right","10px");this.base.addChild(b,k);this.base.addChild(c,h);c.append(this._videoCountSpan);this.base.addChild(c,f);this._rootElement.append(b).append(e).append(c).append(d);this._videoRow=e;this.getVideo(this.base.mediaContents[0])};
McxVideoMedia.prototype.nextButtonClick=function(){this.base.getMediaCounter()<this.base.mediaContents.length&&(this.base.setMediaCounter(this.base.getMediaCounter()+1),this.reloadMedia())};McxVideoMedia.prototype.onPrevButtonClick=function(){1<this.base.getMediaCounter()&&(this.base.setMediaCounter(this.base.getMediaCounter()-1),this.reloadMedia())};
McxVideoMedia.prototype.reloadMedia=function(){this._videoCountSpan.text(this.base.getMediaCounter()+"/"+this.base.mediaContents.length).css("margin-right","10px");0<this.base.getMediaCounter()?this.getVideo(this.base.mediaContents[this.base.getMediaCounter()-1]):(this._videoRow.addClass("mcx-icon-no-image"),this._video.attr("src","").hide())};McxVideoMedia.prototype.getContent=function(){return this._rootElement};McxVideoMedia.prototype.getMediaType=function(){return McxMediaType.Video};
McxVideoMedia.prototype.getVideo=function(a){null!=a&&(a=a.getMediaUrl(),this._video.attr("src",a).show(),this._videoRow.removeClass("mcx-icon-no-image"))};js.framework.ui.McxCommonControl.MediaContainer.Dialog={};js.framework.ui.McxCommonControl.MediaContainer.Dialog.McxImageCatalogDialog={};function McxImageCatalogDialog(a){mcx.base(this);this._imageContent=$("<div/>");this._img=$("<img/>");this._imageUrl=a+"&imageGuid="+McxGuid.createGuid();this._imageLoadEventHandler=new McxEventHandler;this.base=this;this.uiIntialize()}mcx.inherits(McxImageCatalogDialog,McxDialogBase);
McxImageCatalogDialog.prototype.uiIntialize=function(){this._img.css({width:"100%",height:"100%"}).attr("ondragstart","return false;");this._img.attr("src",this._imageUrl);this._imageContent.append(this._img);this._img.load($.proxy(function(){this.base.centralizeDialog();this._imageLoadEventHandler.dispatchOnSuccess(this,null)},this))};McxImageCatalogDialog.prototype.creationComplete=function(){this.base.getDialogElement().addClass("mcx-image-dialog");this.base.getDialogElement().find(".mcx-drag-handle").removeClass("mcx-drag-handle")};
McxImageCatalogDialog.prototype.getDialogToolButtons=function(){return McxDialogToolButtons.closeMaximize};McxImageCatalogDialog.prototype.getContent=function(){return this._imageContent};McxImageCatalogDialog.prototype.getDialogSize=function(){return McxDialogSize.large};McxImageCatalogDialog.prototype.getDialogMaxHeight=function(){return 480};McxImageCatalogDialog.prototype.getImageLoaded=function(){return this._imageLoadEventHandler};McxImageCatalogDialog.prototype.getIsSingleInstance=function(){return!1};js.framework.ui.McxCommonControl.MediaContainer.Dialog.McxImageMediaDialog={};function McxImageMediaDialog(a){mcx.base(this);this._imageContent=$("<div/>");this._img=$("<img/>");this._imageUrl=a+"&imageGuid="+McxGuid.createGuid();this._imageLoadEventHandler=new McxEventHandler;this.base=this;this.uiIntialize()}mcx.inherits(McxImageMediaDialog,McxDialogBase);
McxImageMediaDialog.prototype.uiIntialize=function(){this._img.css({width:"100%",height:"100%"}).attr("ondragstart","return false;");this._img.attr("src",this._imageUrl);this._imageContent.append(this._img);this._img.load($.proxy(function(){this.base.centralizeDialog();this._imageLoadEventHandler.dispatchOnSuccess(this,null)},this))};McxImageMediaDialog.prototype.creationComplete=function(){this.base.getDialogElement().addClass("mcx-image-dialog");this.base.getDialogElement().find(".mcx-drag-handle").removeClass("mcx-drag-handle")};
McxImageMediaDialog.prototype.getDialogToolButtons=function(){return McxDialogToolButtons.closeMaximize};McxImageMediaDialog.prototype.getContent=function(){return this._imageContent};McxImageMediaDialog.prototype.getDialogSize=function(){return McxDialogSize.large};McxImageMediaDialog.prototype.getDialogMaxHeight=function(){return 480};McxImageMediaDialog.prototype.getImageLoaded=function(){return this._imageLoadEventHandler};McxImageMediaDialog.prototype.getIsSingleInstance=function(){return!1};js.framework.ui.McxCommonControl.MiniToolBar={};js.framework.ui.McxCommonControl.MiniToolBar.McxMiniToolBar={};function McxMiniToolBar(a){mcx.base(this);this._map=a;this._rootElement=$("<div/>").addClass("mcx-mini-toolbar");this._toggleButton=$("<div/>").addClass("mcx-mini-toolbar-button").addClass("toggle");this.initialize()}mcx.inherits(McxMiniToolBar,McxUserControl);
McxMiniToolBar.prototype.initialize=function(){this._rootElement.append(this._toggleButton);this._toggleButton.click($.proxy(function(){this._rootElement.toggleClass("state-open")},this))};
McxMiniToolBar.prototype.addAction=function(a,b,c){var d=this._rootElement.find(".mcx-mini-toolbar-button:not(.toggle)").length,e=$("<div/>").addClass("mcx-mini-toolbar-button");this._rootElement.append(e.addClass(b||"tool-expand").css("left",40*d+5*d+55).click($.proxy(function(){this.action.execute(this.map)},{action:a,map:this._map})));c&&e.append($("<div/>").addClass("mcx-toolbar-botton-tooltip-container").append($("<div/>").addClass("mcx-toolbar-botton-tooltip").html(c)))};
McxMiniToolBar.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.NotificationBox={};js.framework.ui.McxCommonControl.NotificationBox.McxNotificationBox={};function McxNotificationBox(a){mcx.base(this);this.base=this;this._closeButton=this._contentContainer=this._autoCloseTimeOut=this._notification=null;this.uniqueElementId=(new Date).getTime().toString();this.init();this.setContent(a)}mcx.inherits(McxNotificationBox,McxUserControl);
McxNotificationBox.prototype.init=function(){var a=$("<div/>").attr("id",this.uniqueElementId).addClass("mcx-notification"),b=$("<div/>").addClass("mcx-notification-close").addClass("img-close16"),c=$("<div/>");b.data("notification",this);b.click(function(){$(this).data("notification").close()});a.append(b);c.append(a);a.hide();this._closeButton=b;this._notification=a;this._contentContainer=c};
McxNotificationBox.prototype.close=function(){var a=this._notification;this._notification.animate({opacity:0},200).hide(200);setTimeout(function(){a.remove()},400)};McxNotificationBox.prototype.show=function(){this._notification.slideDown(200);this._notification.animate({opacity:1},200);mcx.isDefAndNotNull(this._autoCloseTimeOut)&&setTimeout($.proxy(this.close,this),parseFloat(this._autoCloseTimeOut))};McxNotificationBox.prototype.hide=function(){this._notification.animate({opacity:0},200).hide(200)};
McxNotificationBox.prototype.setContent=function(a){this._closeButton.detach();this._notification.html("");this._notification.append(this._closeButton);this._notification.append(a)};McxNotificationBox.prototype.setAutoCloseTimeOut=function(a){return this._autoCloseTimeOut=a};McxNotificationBox.prototype.getContent=function(){return this._contentContainer};js.framework.ui.McxCommonControl.NumberBox={};js.framework.ui.McxCommonControl.NumberBox.McxNumberBox={};function McxNumberBox(a,b,c,d,e){mcx.base(this);this.base=this;this._min=a||Number.NEGATIVE_INFINITY;this._max=b||Number.POSITIVE_INFINITY;this._precision=mcx.isDefAndNotNull(c)?parseFloat(c):Number.MAX_VALUE;this._rootElement=null;this._width=d||50;this._height=e||18;this._numberBox=null;this._isEnabled=!0;this._onChangeHandler=new McxEventHandler;this.initialize()}mcx.inherits(McxNumberBox,McxValidatableControl);
McxNumberBox.prototype.initialize=function(){this._rootElement=$("<div/>");this._numberBox=$("<input/>").attr("type","text").addClass("fit").addClass("mcx-input").keypress($.proxy(this.checkValue,this)).keyup($.proxy(this.onChange,this));this._rootElement.append(this._numberBox)};McxNumberBox.prototype.clear=function(){this._numberBox.val("")};
McxNumberBox.prototype.checkValue=function(a){var b=a.which?a.which:a.keyCode,c=this._numberBox.val();this._numberBox.prop("selectionStart")&&this._numberBox.prop("selectionEnd")&&this._numberBox.prop("selectionStart")<this._numberBox.prop("selectionEnd")&&(c=this._numberBox.val().replace(this._numberBox.val().substring(this._numberBox.prop("selectionStart"),this._numberBox.prop("selectionEnd")),""));var d=this.getCursorPosition(),e=String.fromCharCode(b),e=c.substring(0,d)+e+c.substring(d);45==b&&
0>this._min&&0==d&&0==e.indexOf("-")||-1!==$.inArray(b,[8,9,27,13,190])||97==b&&!0===a.ctrlKey||99==b&&!0===a.ctrlKey||118==b&&!0===a.ctrlKey||120==b&&!0===a.ctrlKey||35<=b&&39>=b||46==b&&0<this._precision&&-1==c.indexOf(".")||((31<b&&(48>b||57<b)||-1<c.indexOf(".")&&c.split(".")[1].length+1>this._precision)&&a.preventDefault(),(parseFloat(e)>this._max||parseFloat(e)<this._min)&&a.preventDefault())};
McxNumberBox.prototype.getValue=function(){var a=parseFloat(this._numberBox.val());return isNaN(a)?null:a};McxNumberBox.prototype.setValue=function(a){/^-?[0-9]\d*(.\d+)?$/.test(a)&&(a>this._max&&(a=this._max),a<this._min&&(a=this._min),a.toString().split(".")[1]&&a.toString().split(".")[1].length>this._precision&&(a=parseFloat(a.toFixed(this._precision))),this._numberBox.val(a.toString()))};
McxNumberBox.prototype.setPlaceHolder=function(a,b){this._numberBox.attr("placeholder",a);b?this._numberBox.attr("data-localize",b).attr("data-localize-for","placeholder"):this._numberBox.removeAttr("data-localize").removeAttr("data-localize-for")};McxNumberBox.prototype.setIsEnabled=function(a){(this._isEnabled=a)?this._numberBox.removeAttr("disabled"):this._numberBox.attr("disabled","disabled")};McxNumberBox.prototype.setWidth=function(a){this._numberBox.css("width",a)};
McxNumberBox.prototype.setHeight=function(a){this._numberBox.css("height",a)};McxNumberBox.prototype.onChange=function(){this.base.getChangeEventHandler().dispatchOnSuccess(this,new McxEventArgs(null));this.getOnChangeHandler().dispatchOnSuccess(this,null)};McxNumberBox.prototype.getOnChangeHandler=function(){return this._onChangeHandler};McxNumberBox.prototype.getContent=function(){return this._rootElement};
McxNumberBox.prototype.getCursorPosition=function(){var a=$(this._numberBox).get(0),b=0;if("selectionStart"in a)b=a.selectionStart;else if("selection"in document){a.focus();var b=document.selection.createRange(),c=document.selection.createRange().text.length;b.moveStart("character",-a.value.length);b=b.text.length-c}return b};js.framework.ui.McxCommonControl.NumberSlider={};js.framework.ui.McxCommonControl.NumberSlider.McxNumberSlider={};
function McxNumberSlider(a,b,c,d,e,f,g){mcx.base(this);this.base=this;this._min=c||0;this._max=d||100;this._step=e||10;this._visualSize=f||"auto";this._defaultValue=g||this._min;this._sliderMode=b||McxNumberSliderMode.Horizontal;this._showTip=a||!1;this._rootElement=$("<div/>");this._onChangeHandler=new McxEventHandler;this._onSlideStartHandler=new McxEventHandler;this._onSlideEndHandler=new McxEventHandler;this._slider=$("<div />");this.initialize()}mcx.inherits(McxNumberSlider,McxUserControl);
McxNumberSlider.prototype.initialize=function(){var a=this;this._rootElement.append(this._slider);this._slider.noUiSlider({orientation:this._sliderMode==McxNumberSliderMode.Vertical?"vertical":"horizontal",range:{min:[this._min],max:[this._max]},step:this._step,start:[this._defaultValue]});this._slider.css("width",this._sliderMode==McxNumberSliderMode.Horizontal?this._visualSize:"5px");this._slider.css("height",this._sliderMode==McxNumberSliderMode.Vertical?this._visualSize:"5px");this._slider.css("margin",
"10px 7px 10px 3px");this._slider.on({change:function(){a.onChange().dispatchOnSuccess(a,new McxEventArgs(null))},slide:function(){a.onSlideStart().dispatchOnSuccess(a,new McxEventArgs(null))},set:function(){a.onSlideEnd().dispatchOnSuccess(a,new McxEventArgs(null))}})};McxNumberSlider.prototype.onChange=function(){return this._onChangeHandler};McxNumberSlider.prototype.onSlideStart=function(){return this._onSlideStartHandler};McxNumberSlider.prototype.onSlideEnd=function(){return this._onSlideEndHandler};
McxNumberSlider.prototype.getValue=function(){return parseFloat(this._slider.val())};McxNumberSlider.prototype.setValue=function(a){this._slider.val([a])};McxNumberSlider.prototype.resize=function(a,b){this._slider.css("width",a).css("height",b)};McxNumberSlider.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.NumberSlider.McxNumberSliderMode={};var McxNumberSliderMode={Horizontal:0,Vertical:1};js.framework.ui.McxCommonControl.NumberSpinner={};js.framework.ui.McxCommonControl.NumberSpinner.McxNumberSpinner={};function McxNumberSpinner(a,b,c,d){mcx.base(this);this.base=this;this._min=a||0;this._max=b||100;this._editable=1==mcx.isDefAndNotNull(c)?c||!1:!0;this._increment=1==mcx.isDefAndNotNull(d)?d||1:1;this._rootElement=$("<div/>");this._numberSpinnerElement=null;this._onChangeHanlder=new McxEventHandler;this.initialize()}mcx.inherits(McxNumberSpinner,McxUserControl);
McxNumberSpinner.prototype.initialize=function(){this._rootElement.addClass("mcx-number-spinner");var a=$("<div/>").addClass("mcx-number-spinner-area"),b=$("<div/>").addClass("mcx-number-spinner-upSlider").click($.proxy(this.increaseValue,this)),c=$("<div/>").addClass("mcx-number-spinner-downSlider").click($.proxy(this.decreaseValue,this));this._numberSpinnerElement=$("<input/>").css("float","right").addClass("fit").addClass("mcx-input").keypress($.proxy(this.checkValue,this));this._rootElement.append(this._numberSpinnerElement);
a.append(b);a.append(c);this._rootElement.append(a)};McxNumberSpinner.prototype.getContent=function(){return this._rootElement};McxNumberSpinner.prototype.increaseValue=function(){var a=(""==this._numberSpinnerElement.val()?0:parseFloat(this._numberSpinnerElement.val()))+this._increment;a<=this._max&&this._numberSpinnerElement.val(a.toString())};
McxNumberSpinner.prototype.decreaseValue=function(){var a=(""==this._numberSpinnerElement.val()?0:parseFloat(this._numberSpinnerElement.val()))-this._increment;a>=this._min&&this._numberSpinnerElement.val(a.toString())};
McxNumberSpinner.prototype.checkValue=function(a){var b=a.which?a.which:a.keyCode,c=this._numberSpinnerElement.val(),d=String.fromCharCode(b);-1!==$.inArray(b,[8,9,27,13,190])||65==b&&!0===a.ctrlKey||35<=b&&39>=b&&parseFloat(c+d)<this._max||((31<b&&(48>b||57<b)||parseFloat(c+d)>this._max)&&a.preventDefault(),parseFloat(c+d)<this._min&&(this._numberSpinnerElement.val(this._min.toString()),a.preventDefault()))};
McxNumberSpinner.prototype.setFit=function(a){a?this._rootElement.addClass("mcx-number-spinner-fit"):this._rootElement.removeClass("mcx-number-spinner-fit")};McxNumberSpinner.prototype.getValue=function(){return parseFloat(this._numberSpinnerElement.val())};McxNumberSpinner.prototype.setValue=function(a){/^\d+(.\d+){0,1}$/.test(a)&&this._numberSpinnerElement.val(a.toString())};McxNumberSpinner.prototype.setWidth=function(a){this._rootElement.css("width",a+"px")};
McxNumberSpinner.prototype.onSpinChange=function(){this._onChangeHanlder.dispatchOnSuccess(this,null)};McxNumberSpinner.prototype.getOnChangeHandler=function(){return this._onChangeHanlder};js.framework.ui.McxCommonControl.OpacitySetter={};js.framework.ui.McxCommonControl.OpacitySetter.McxOpacitySetter={};function McxOpacitySetter(){mcx.base(this);this.base=this;this._opacitySliderContainer=this._opacitySlider=this._opacityPickerButton=null;this._rootElement=$("<div/>");this.initialize();this.bindEvents()}mcx.inherits(McxOpacitySetter,McxUserControl);
McxOpacitySetter.prototype.initialize=function(){var a=$("<div/>"),b=$("<div/>").css("position","absolute").css("padding","0 10px 0 0").css("right","0").addClass(""),c=$("<div/>").css("position","relative").append(a).append(b);this._rootElement.append(c);c=new McxImageButton;c.setImageClass("mcx-img-opacity16");this.base.addChild(a,c);a=new McxNumberSlider(!1,McxNumberSliderMode.Horizontal);this.base.addChild(b,a);c.setImageWidth(16);c.setImageHeight(22);a.resize(100,30);b.hide();this._opacityPickerButton=
c;this._opacitySliderContainer=b;this._opacitySlider=a};McxOpacitySetter.prototype.bindEvents=function(){this._opacityPickerButton.onClickHandler().addListener(function(){this._opacitySliderContainer.is(":visible")?this._opacitySliderContainer.hide():this._opacitySliderContainer.show()},null,this)};McxOpacitySetter.prototype.onChange=function(){return this._opacitySlider.onChange()};McxOpacitySetter.prototype.onSlideStart=function(){return this._opacitySlider.onSlideStart()};
McxOpacitySetter.prototype.onSlideEnd=function(){return this._opacitySlider.onSlideEnd()};McxOpacitySetter.prototype.getValue=function(){return this._opacitySlider.getValue()};McxOpacitySetter.prototype.setValue=function(a){this._opacitySlider.setValue(a)};McxOpacitySetter.prototype.enable=function(){this._opacitySlider.enable()};McxOpacitySetter.prototype.disable=function(){this._opacitySlider.disable()};McxOpacitySetter.prototype.resize=function(a,b){this._opacitySlider.resize(a,b)};
McxOpacitySetter.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.OpenDataSourceControl={};js.framework.ui.McxCommonControl.OpenDataSourceControl.McxOpenDataSourceControl={};
function McxOpenDataSourceControl(){mcx.base(this);this.base=this;this._passwordTextBox=this._userNameTextBox=this._dataSourceCombo=this._rootElement=null;this._userNameAndPasswordCheckBox=new McxCheckBox;this._userNameAndPasswordCheckBoxRow=new McxLayoutRow;this._credentialContent=$("<div/>");this._canDisabled=!1;this.initialize();this.toggleCredentialArea()}mcx.inherits(McxOpenDataSourceControl,McxUserControl);
McxOpenDataSourceControl.prototype.initialize=function(){this._rootElement=$("<div/>");this._dataSourceCombo=new McxComboBox;this._dataSourceCombo.setTextGetter("text");this._dataSourceCombo.setValueGetter("value");this._dataSourceCombo.addEmptyItem("");var a=new McxLabeledEditor("Data Source",this._dataSourceCombo,"McxCommonDialog-mcxDataSourceListDialogDataSource",4),b=new McxLayoutRow;b.createAndAddSpan(10,a);this.base.addChild(this._rootElement,b);b=new McxLayoutRow;this._userNameTextBox=new McxTextBox(McxTextBoxType.Text);
a=new McxLabeledEditor("User Name",this._userNameTextBox,"McxCommonDialog-mcxDataSourceDialogUserName",4);b.createAndAddSpan(10,a);this.base.addChild(this._credentialContent,b);b=new McxLayoutRow;this._passwordTextBox=new McxTextBox(McxTextBoxType.Password);a=new McxLabeledEditor("Password",this._passwordTextBox,"McxCommonDialog-mcxDataSourceDialogPassword",4);b.createAndAddSpan(10,a);this.base.addChild(this._credentialContent,b);var c=$("<div/>").addClass("mcx-credential-expand mcx-button-image mcx-layer-group-expand");
c.click($.proxy(function(){this._userNameAndPasswordCheckBox.isChecked()?this._userNameAndPasswordCheckBox.checked(!1):this._userNameAndPasswordCheckBox.checked(!0);this.onDisableCheckBoxChange();c.toggleClass("state-open")},this));b=$("<hr/>").css("width","100%").css("margin","12px 0").addClass("fit");a=new McxLabelControl;a.setText("McxCommonControl-UserNameAndPassword");a.setLocalizationKey("McxCommonControl-UserNameAndPassword");a.getContent().css("font-style","italic");a.getContent().css("font-weight",
"bold");this._userNameAndPasswordCheckBox.checked(!1);this._userNameAndPasswordCheckBox.getContent().hide();this.base.addChild(c,this._userNameAndPasswordCheckBox);this._userNameAndPasswordCheckBoxRow.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center);this._userNameAndPasswordCheckBoxRow.getContent().css("margin-top","12px").css("margin-top","5px");this._userNameAndPasswordCheckBoxRow.createAndAddSpan(4,a);this._userNameAndPasswordCheckBoxRow.createAndAddSpan(7,b);this._userNameAndPasswordCheckBoxRow.createAndAddSpan(1,
c);this.base.addChild(this._rootElement,this._userNameAndPasswordCheckBoxRow);this._rootElement.append(this._credentialContent)};McxOpenDataSourceControl.prototype.getContent=function(){return this._rootElement};McxOpenDataSourceControl.prototype.setComboBoxHistory=function(a){for(var b=[],c=0;c<a.length;c++)b.push({text:a[c],value:a[c]});this._dataSourceCombo.addItemRange(b)};McxOpenDataSourceControl.prototype.canCredentialsDisabled=function(a){this._canDisabled=a;this.toggleCredentialArea()};
McxOpenDataSourceControl.prototype.toggleCredentialArea=function(){this._canDisabled?(this._userNameAndPasswordCheckBoxRow.show(),this._credentialContent.css("padding","0 10px").css("display","none")):this._userNameAndPasswordCheckBoxRow.hide()};McxOpenDataSourceControl.prototype.onDisableCheckBoxChange=function(){this._credentialContent.animate({height:"toggle"})};
McxOpenDataSourceControl.prototype.getUserName=function(){return this._canDisabled&&!this._userNameAndPasswordCheckBox.isChecked()?"":this._userNameTextBox.getValue()};McxOpenDataSourceControl.prototype.getPassword=function(){return this._canDisabled&&!this._userNameAndPasswordCheckBox.isChecked()?"":this._passwordTextBox.getValue()};McxOpenDataSourceControl.prototype.getDataSourceUri=function(){return this._dataSourceCombo.getText()};
McxOpenDataSourceControl.prototype.addDataToHistory=function(a){for(var b=this._dataSourceCombo.getItems(),c=!1,d=0;d<b.length;d++)b[d].value==a&&(c=!0);c||this._dataSourceCombo.addItemRange([{text:a,value:a}])};McxOpenDataSourceControl.prototype.setCredentialsDisabled=function(){this._userNameAndPasswordCheckBoxRow.hide();this._credentialContent.hide()};
McxOpenDataSourceControl.prototype.getHistoryAsArray=function(){for(var a=this._dataSourceCombo.getItems(),b=[],c=0;c<a.length;c++)a[c].value&&""!=a[c].value.toString()&&b.push(a[c].value.toString());return b};js.framework.ui.McxCommonControl.Panel={};js.framework.ui.McxCommonControl.Panel.McxPanel={};function McxPanel(){mcx.base(this);this._rootElement=$("<div/>").addClass("mcx-panel");this.base=this}mcx.inherits(McxPanel,McxUserControl);McxPanel.prototype.addControl=function(a,b){this.base.addChild(this._rootElement,a,b||McxUserControlAddMethod.append)};McxPanel.prototype.addElement=function(a,b){b==McxUserControlAddMethod.prepend?this._rootElement.prepend(a):this._rootElement.append(a)};
McxPanel.prototype.setAsBusy=function(){McxLoadingIndicator.setAsBusy(this.getContent())};McxPanel.prototype.setAsIdle=function(){McxLoadingIndicator.setAsIdle(this.getContent())};McxPanel.prototype.getContent=function(){return this._rootElement};McxPanel.prototype.fit=function(){this._rootElement.css("height","100%").addClass("panel-fit")};js.framework.ui.McxCommonControl.ContextMenu.McxContextMenu={};function McxContextMenu(){mcx.base(this);this.base=this;this.initialize()}mcx.inherits(McxContextMenu,McxPanel);McxContextMenu.prototype.initialize=function(){this.base._rootElement.addClass("mcx-context-menu");this.base._rootElement.click(this.stopPropagation).mousedown(this.stopPropagation).mouseup(this.stopPropagation);this.base._rootElement.click(function(a){a.stopPropagation()})};
McxContextMenu.prototype.show=function(a){$(".mcx-context-menu").detach();a=a||$("body");this.base.getContent().appendTo(a);a.get(0).addEventListener("click",$.proxy(this.base.hide,this),!0)};McxContextMenu.prototype.setPosition=function(a,b){this.base.getContent().offset({top:a,left:b})};McxContextMenu.prototype.addContextMenuItem=function(a){this.base.addControl(a)};McxContextMenu.prototype.createAndAddMenuItem=function(a,b){var c=new McxContextMenuItem;c.setText(a,b);this.base.addControl(c);return c};
McxContextMenu.prototype.stopPropagation=function(a){a.stopPropagation();a.preventDefault()};js.framework.ui.McxCommonControl.ContextMenu.McxContextMenuItem={};function McxContextMenuItem(){mcx.base(this);this.base=this;this._titleElem=$("<div/>").addClass("mcx-context-menu-item-title");this._clickEventHanlder=new McxEventHandler;this.initialize()}mcx.inherits(McxContextMenuItem,McxPanel);McxContextMenuItem.prototype.initialize=function(){this.base.addElement(this._titleElem);this.base._rootElement.click($.proxy(this.onClick,this)).addClass("mcx-context-menu-item")};
McxContextMenuItem.prototype.setText=function(a,b){this._titleElem.html(a);b&&this._titleElem.attr("data-localization",b)};McxContextMenuItem.prototype.getClickHandler=function(){return this._clickEventHanlder};McxContextMenuItem.prototype.onClick=function(a){a.preventDefault();a.stopImmediatePropagation();this.getClickHandler().dispatchOnSuccess(this,null)};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxBaseDataColumn={};
function McxBaseDataColumn(a,b){mcx.base(this);this.base=this;this._isBindable=!0;this.base._rootElement=$("<th/>").addClass("mcx-datagrid-column-header");this._title="";this._titleLocalizationKey=b||null;this._isRequired=this._isFilterable=this._isSearchable=this._isEditable=!1;this._pBindValueSetterName=this._pBindValueGetterName=this._fBindValueName=this._editorCreator=null;this._pBindFunctionParams=[];this._cBindScope=this._cBindSetter=this._cBindGetter=null;this._cBindParams=[];this._customValidaters=
[];this._convertFromEditor=this._convertToEditor=this._textGetterFunction=null;this._onEditorCreateHandler=new McxEventHandler;this._width=0;this._orderChangeHandler=new McxEventHandler;this._filterUI=new McxDataColumnFilterUI(this);this.init(a,b)}mcx.inherits(McxBaseDataColumn,McxPanel);McxBaseDataColumn.prototype.init=function(a,b){this.setTitle(a,b);this.enableOrdering();this.enableFiltering()};
McxBaseDataColumn.prototype.enableOrdering=function(){this.base._rootElement.click($.proxy(function(a){var b=McxDataGridColumnOrder.DESC;a=$(a.target);a.hasClass("order-desc")?(this.base._rootElement.removeClass("order-desc").addClass("order-asc"),a.removeClass("order-desc").addClass("order-asc"),b=McxDataGridColumnOrder.ASC):a.hasClass("order-asc")?(this.base._rootElement.removeClass("order-asc"),a.removeClass("order-asc"),b=McxDataGridColumnOrder.None):(this.base._rootElement.addClass("order-desc"),
a.addClass("order-desc"));this.base._rootElement.siblings("th").removeClass("order-asc").removeClass("order-desc");a.siblings("th").removeClass("order-asc").removeClass("order-desc");this.getOnOrderChangeHandler().dispatchOnSuccess(this,new McxDataGridOrderEventArgs(this,b))},this))};
McxBaseDataColumn.prototype.enableFiltering=function(){this._filterUI.getFilterApplyHandler().addListener(function(){0<this._filterUI.getFilter().getFilters().length?this.base._rootElement.addClass("filtered"):this.base._rootElement.removeClass("filtered")},null,this);this.base._rootElement.mouseenter($.proxy(function(){this._isFilterable&&this._filterUI.show()},this));this.base._rootElement.mouseleave($.proxy(function(){this._filterUI.hide()},this));document.body.addEventListener("mousedown",$.proxy(function(){0==
$(".mcx-datetime-picker:hover").length&&this._filterUI.hide()},this),!0)};McxBaseDataColumn.prototype.getTitle=function(){return this._title};McxBaseDataColumn.prototype.getOnOrderChangeHandler=function(){return this._orderChangeHandler};McxBaseDataColumn.prototype.getTitleLocalizationKey=function(){return this._titleLocalizationKey};McxBaseDataColumn.prototype.getIsEditable=function(){return this._isEditable&&this._isBindable};
McxBaseDataColumn.prototype.onEditorCreate=function(a){if(mcx.isInstanceOf(a,McxValidatableControl)){a.isRequired(this._isRequired);for(var b=0;b<this._customValidaters.length;b++)a.addCustomValidator(this._customValidaters[b]);this._onEditorCreateHandler.dispatchOnSuccess(this,new McxEventArgs(a))}};McxBaseDataColumn.prototype.createEditor=function(a){var b=null,b=this._editorCreator?this._editorCreator.call(this,a):new McxTextBox;this.onEditorCreate(b);return b};
McxBaseDataColumn.prototype.setTitle=function(a,b){this._title=a;this._titleLocalizationKey=b||null;this.base._rootElement.html(this._title).attr("title",a);this._titleLocalizationKey&&this.base._rootElement.attr("data-localize",this._titleLocalizationKey).attr("data-localize-for","title,content")};McxBaseDataColumn.prototype.setIsEditable=function(a){this._isEditable=a;return this};McxBaseDataColumn.prototype.setIsSearchable=function(a){this._isSearchable=a;return this};
McxBaseDataColumn.prototype.bindField=function(a){if(!this._isBindable)return this;this._fBindValueName=a;return this};McxBaseDataColumn.prototype.isEditable=function(a){this._isEditable=a;return this};McxBaseDataColumn.prototype.setIsFilterable=function(a){this._isFilterable=a;return this};McxBaseDataColumn.prototype.isRequired=function(a){this._isRequired=a;return this};McxBaseDataColumn.prototype.addCustomValidator=function(a){this._customValidaters[this._customValidaters.length]=a;return this};
McxBaseDataColumn.prototype.bindProperty=function(a,b,c){if(!this._isBindable)return this;this._pBindValueGetterName=a;this._pBindValueSetterName=b;this._pBindFunctionParams=c||[];return this};McxBaseDataColumn.prototype.setCustomTextGetter=function(a){this._textGetterFunction=a;return this};McxBaseDataColumn.prototype.setValueConverters=function(a,b){this._convertToEditor=a;this._convertFromEditor=b;return this};
McxBaseDataColumn.prototype.getValue=function(a){var b;if(this._fBindValueName)if(-1==this._fBindValueName.indexOf("."))b=a[this._fBindValueName];else{b=a;a=this._fBindValueName.split(".");for(var c=0;c<a.length;c++)b=b[a[c]]}else this._pBindValueGetterName?b=a[this._pBindValueGetterName].apply(a,this._pBindFunctionParams):this._cBindGetter&&this._cBindScope?b=this._cBindGetter.apply(this._cBindScope,[a].concat(this._cBindParams)):this._cBindGetter&&(b=this._cBindGetter.apply(a,[this._cBindParams]));
return this._convertToEditor?this._convertToEditor(b):b};
McxBaseDataColumn.prototype.setValue=function(a,b){this._convertFromEditor&&(b=this._convertFromEditor(b));if(this._fBindValueName)if(-1==this._fBindValueName.indexOf("."))a[this._fBindValueName]=b;else for(var c=this._fBindValueName.split("."),d=0;d<c.length;d++)a=a[c[d]];else this._pBindValueGetterName?a[this._pBindValueSetterName].apply(a,this._pBindFunctionParams.concat([b])):this._cBindSetter?this._cBindSetter.call(this._cBindScope,a,b):this._cBindSetter&&this._cBindScope?this._cBindSetter.apply(this._cBindScope,
[a].concat(this._cBindParams).concat([b])):this._cBindGetter&&this._cBindSetter.apply(a,[this._cBindParams].concat([b]))};McxBaseDataColumn.prototype.getText=function(a,b){if(this._textGetterFunction)return this._textGetterFunction.call(this,a,b);var c=this.getValue(a);this._convertFromEditor&&(c=this._convertFromEditor(c));0===c&&(c="0");return c?c.toString():""};McxBaseDataColumn.prototype.getEditorCreateHandler=function(){return this._onEditorCreateHandler};
McxBaseDataColumn.prototype.getIsBindable=function(){return this._isBindable};McxBaseDataColumn.prototype.onCellCreate=function(a){};McxBaseDataColumn.prototype.getBinding=function(){return this._fBindValueName?new McxDataGridFieldBinding(this._fBindValueName):this._pBindValueGetterName&&this._pBindValueGetterName?new McxDataGridPropertyBinding(this._pBindValueGetterName.toString(),this._pBindValueSetterName.toString(),this._pBindFunctionParams):null};
McxBaseDataColumn.prototype.bindCustom=function(a,b,c,d){this._cBindGetter=a;this._cBindSetter=b;this._cBindScope=c||null;this._cBindParams=d||[]};McxBaseDataColumn.prototype.setWidth=function(a){this._width=a;this.base.getContent().width(a);return this};McxBaseDataColumn.prototype.getWidth=function(){return this._width};McxBaseDataColumn.prototype.getFilterApplyHandler=function(){return this._filterUI.getFilterApplyHandler()};McxBaseDataColumn.prototype.getFilter=function(){return this._filterUI.getFilter()};
McxBaseDataColumn.prototype.addFilter=function(a){};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxButtonColumn={};function McxButtonColumn(a,b){mcx.base(this,a,b);this.base=this;this.base._isBindable=!1;this._onClickEventHandler=new McxEventHandler;this._buttonImage=this._buttonTitleLocalizationKey=this._buttonTitle="";this._buttonVisaulType=McxButtonVisualType.button;this.initialize()}mcx.inherits(McxButtonColumn,McxBaseDataColumn);
McxButtonColumn.prototype.initialize=function(){this.base._editorCreator=function(){var a=new McxButton;a.setButtonSize(McxButtonSize.small);this._buttonTitle&&a.setText(this._buttonTitle);this._buttonTitleLocalizationKey&&a.setLocalizationKey(this._buttonTitleLocalizationKey);this._buttonImage&&a.setImage(this._buttonImage);this._buttonVisaulType&&a.setButtonVisualType(this._buttonVisaulType);a.getClickHandler().addListener(this.onButtonClick,null,{scope:this,button:a});a.getContent().find(".mcx-button-label").css({"white-space":"nowrap"});
return a}};McxButtonColumn.prototype.setButtonText=function(a,b){this._buttonTitle=a;this._buttonTitleLocalizationKey=b||"";return this};McxButtonColumn.prototype.setButtonImage=function(a){this._buttonImage=a;return this};McxButtonColumn.prototype.setButtonVisualType=function(a){this._buttonVisaulType=a;return this};McxButtonColumn.prototype.addListener=function(a,b){this.getClickHandler().addListener(a,null,b);return this};
McxButtonColumn.prototype.onButtonClick=function(){var a=this.scope,b=this.button.getParentsOfType(McxDataRow)[0];a.getClickHandler().dispatchOnSuccess(a,new McxDataRowEventArgs(b))};McxButtonColumn.prototype.getClickHandler=function(){return this._onClickEventHandler};McxButtonColumn.prototype.onCellCreate=function(a){a.getContent().css({padding:"5px 10px","text-align":"center"})};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxCheckBoxColumn={};function McxCheckBoxColumn(a,b){mcx.base(this,a,b);this.base=this;this.initialize()}mcx.inherits(McxCheckBoxColumn,McxBaseDataColumn);McxCheckBoxColumn.prototype.initialize=function(){this.base._editorCreator=function(a){var b=new McxCheckBox;b.setValue(a);return b}};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxComboBoxColumn={};function McxComboBoxColumn(a,b){mcx.base(this,a,b);this.base=this;this._textGetter=this._valueGetter="toString";this._data=[];this.initialize()}mcx.inherits(McxComboBoxColumn,McxBaseDataColumn);
McxComboBoxColumn.prototype.initialize=function(){this.base._editorCreator=$.proxy(function(a){var b=new McxComboBox;b.setValueGetter(this._valueGetter||"toString");b.setTextGetter(this._textGetter||"toString");b.addEmptyItem("...");b.addItemRange(this._data||[]);b.setValue(a);return b},this)};McxComboBoxColumn.prototype.setComboBoxParams=function(a,b,c){this._valueGetter=b||"toString";this._textGetter=c||"toString";this._data=a;return this};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxDataCell={};
function McxDataCell(a){mcx.base(this);this.base=this;this.base._rootElement=$("<td/>").addClass("mcx-datagrid-cell");this._item=null;this._column=a;this._labelContainer=$("<div/>").addClass("mcx-datagrid-cell-container");this._editorContainer=$("<div/>").addClass("mcx-datagrid-cell-container");this._editor=null;this._isEditable=!1;this._initialValue=null;this._column.getIsEditable()||this.base._rootElement.addClass("non-editable");this.initialize();this._column.onCellCreate(this)}
mcx.inherits(McxDataCell,McxPanel);McxDataCell.prototype.initialize=function(){this.base.addElement(this._labelContainer);this.base.addElement(this._editorContainer.hide());this._editorContainer.keydown($.proxy(function(a){a.keyCode!=McxKeyCode.enter||this.validate()||(a.stopImmediatePropagation(),a.preventDefault(),a.stopPropagation())},this));var a=this._column.getWidth();a&&this.base._rootElement.css("min-width",a+"px")};
McxDataCell.prototype.createEditor=function(a){var b=null;a&&(b=this._column.getValue(a));this._editor=this._column.createEditor(b);mcx.isInstanceOf(this._editor,McxValidatableControl)||alert("Implementation error! Bindable columns have to create McxValidateableControl as editor");this.base.addChild(this._editorContainer,this._editor)};McxDataCell.prototype.saveState=function(){this._initialValue=this._column.getValue(this._item)};
McxDataCell.prototype.setItem=function(a){this._item=a;setTimeout($.proxy(function(){var b=this._column.getText(a,this);this._labelContainer.html(b)},this),2);this._editor&&this._editor.setValue(this._column.getValue(a));this.saveState()};McxDataCell.prototype.startEditing=function(){this._editor||this.createEditor(this._item);if(this._column.getIsEditable()||this._isEditable)this._editorContainer.show(),this._labelContainer.hide()};
McxDataCell.prototype.validate=function(){if(!this._column.getIsEditable()&&!this._isEditable)return!0;var a=this._editor.validate();a||this.base._rootElement.find("input:first").focus().select();return a};McxDataCell.prototype.finishEditing=function(){0==this._column.getIsEditable()&&0==this._isEditable||!this._editor.validate()||(this._column.setValue(this._item,this._editor.getValue()),this._labelContainer.html(this._column.getText(this._item,this)),this._editorContainer.hide(),this._labelContainer.show())};
McxDataCell.prototype.setIsEditable=function(a){(this._isEditable=a)?this.base._rootElement.removeClass("non-editable"):this._isEditable||this.base._rootElement.hasClass("non-editable")||this.base._rootElement.addClass("non-editable")};McxDataCell.prototype.getIsEditable=function(){return this._isEditable};McxDataCell.prototype.cancelEditing=function(){this._editorContainer.hide();this._labelContainer.show()};McxDataCell.prototype.isChanged=function(){return this._initialValue!=this._column.getValue(this._item)};
McxDataCell.prototype.revert=function(){this._column.setValue(this._item,this._initialValue);this._editor&&this._editor.setValue(this._initialValue);this._labelContainer.html(this._column.getText(this._item,this))};McxDataCell.prototype.getColumn=function(){return this._column};McxDataCell.prototype.refresh=function(){this._labelContainer.html(this._column.getText(this._item,this))};McxDataCell.prototype.getText=function(){return this._labelContainer.html().toString()};
McxDataCell.prototype.setText=function(a){return this._labelContainer.html(a)};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxDataColumnFilterUI={};function McxDataColumnFilterUI(a){mcx.base(this);this._column=a;this._filterButton=$("<div/>").addClass("mcx-column-filter-button");this._filterPanel=$("<div/>").addClass("mcx-column-filter-panel");this._addButton=new McxButton;this._applyButton=new McxButton;this.base=this;this.initialize()}mcx.inherits(McxDataColumnFilterUI,McxPanel);
McxDataColumnFilterUI.prototype.initialize=function(){this.base.getContent().css("position","absolute");this.base._rootElement.addClass("mcx-data-column-filter-ui");this.base.addElement(this._filterButton);this.base.addElement(this._filterPanel.hide().append($("<div/>").addClass("mcx-filter-editor-container")));this._applyButton.setButtonSize(McxButtonSize.small);this._addButton.setButtonSize(McxButtonSize.small);this._applyButton.setIsFullWidth(!0);this._addButton.setIsFullWidth(!0);this._addButton.setImage("$McxCommonControl/assets/img/common/plus-16.png");
this._applyButton.setImage("$McxCommonControl/assets/img/common/tick.png");this.base.addChild(this._filterPanel,(new McxLayoutRow).addSpan((new McxLayoutSpan(6)).addContent(this._addButton)).addSpan((new McxLayoutSpan(6)).addContent(this._applyButton)));this.base._rootElement.mouseleave($.proxy(function(){setTimeout($.proxy(function(){$("th").is(":hover")||0<$(".mcx-datetime-picker:hover").length||this.hide()},this),20)},this));this._filterButton.click($.proxy(function(){this._filterPanel.toggle(0)},
this));this._addButton.getClickHandler().addListener(function(){var a=this._column.createEditor(),b=new McxButton;b.setButtonSize(McxButtonSize.small);b.setButtonVisualType(McxButtonVisualType.linkButton);b.setIsFullWidth(!0);b.getContent().css("padding","auto");b.setImage("$McxCommonControl/assets/img/common/delete.png");a=(new McxLayoutRow).addSpan((new McxLayoutSpan(10)).addContent(a)).addSpan((new McxLayoutSpan(2)).addContent(b));b.getClickHandler().addListener(function(){this.remove()},null,
a);this.base.addChild(this._filterPanel.find(".mcx-filter-editor-container"),a)},null,this);this._applyButton.getClickHandler().addListener(function(){this.base._rootElement.css("opacity",0);this._filterPanel.hide();this.getContent().hide()},null,this)};McxDataColumnFilterUI.prototype.show=function(){McxDataColumnFilterUI.superClass_.show.call(this);this.base.getContent().css("opacity",100).offset(this._column.getContent().offset()).appendTo($("body"))};
McxDataColumnFilterUI.prototype.hide=function(){setTimeout($.proxy(function(){this.base.getContent().is(":hover")||(this.base._rootElement.css("opacity",0),this._filterPanel.hide(),McxDataColumnFilterUI.superClass_.hide.call(this))},this),20)};McxDataColumnFilterUI.prototype.getFilterApplyHandler=function(){return this._applyButton.getClickHandler()};
McxDataColumnFilterUI.prototype.getFilter=function(){for(var a=new McxDataGridFilterBuilder,b=this.base.getInnerChildrenOfType(McxValidatableControl),c=0;c<b.length;c++){var d=b[c].getValue();d&&a.addFilter(new McxDataGridColumnFilter(this._column,d))}return a};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxDataGrid={};
function McxDataGrid(){mcx.base(this);this.base=this;this._table=$("<table/>").addClass("mcx-datagrid");this._data=[];this._columns=[];this._thead=$("<thead/>").append($("<tr/>"));this._tbody=$("<tbody/>");this._gridContainer=$("<div/>").addClass("mcx-datagrid-container");this._tableContainer=$("<div/>").css({display:"inline-block","min-height":"150px","margin-top":"-35px","background-color":"#f5f5f5",position:"relative"}).addClass("");this._loadMoreButton=$("<div/>").addClass("mcx-datagird-loadmorebutton");
this._rowSelectHandler=new McxEventHandler;this._onRowChangeHandler=new McxEventHandler;this._onRowRemoveHandler=new McxEventHandler;this._onRowDoubleClickHandler=new McxEventHandler;this._onRowClickHandler=new McxEventHandler;this._onRowAddHandler=new McxEventHandler;this._pageIndex=0;this._dataCountPerPage=20;this._gridDataSource=null;this._isEditable=!0;this._filterBuilderContainer=$("<div/>").addClass("mcx-datagrid-filter-container");this._filterToggleButton=$("<div/>").addClass("mcx-datagrid-filter-button").addClass("toggle");
this._filterSaveButton=$("<div/>").addClass("mcx-datagrid-filter-button").addClass("save");this._rowHeight=null;this._selectionMode=McxDataRowSelectMode.SingleSelect;this.initialize()}mcx.inherits(McxDataGrid,McxPanel);
McxDataGrid.prototype.initialize=function(){this._table.append(this._thead);this._table.append(this._tbody);this._tableContainer.append(this._table);this._gridContainer.append(this._tableContainer);this.base.addElement(this._gridContainer);this.base.addElement(this._loadMoreButton.text("Daha Fazla Sonu\u00e7 G\u00f6r\u00fcnt\u00fcle").addClass("mcx-datagrid-loadmore").hide());this._loadMoreButton.click($.proxy(this.loadMore,this));this._table.keydown($.proxy(function(a){38!=a.keyCode&&40!=a.keyCode||
0!=this.base._rootElement.find(".mcx-datagrid-row.last-focused").length?38==a.keyCode?this.base._rootElement.find(".mcx-datagrid-row.last-focused").prev(".mcx-datagrid-row").focus():40==a.keyCode&&this.base._rootElement.find(".mcx-datagrid-row.last-focused").next(".mcx-datagrid-row").focus():0<this.base._rootElement.find(".mcx-datagrid-row.mode-edit").length?this.base._rootElement.find(".mcx-datagrid-row.mode-edit").focus():38==a.keyCode?this.base._rootElement.find(".mcx-datagrid-row:first").focus():
this.base._rootElement.find(".mcx-datagrid-row:last").focus()},this));this._tbody.click($.proxy(function(a){$(a.target).is("tbody")&&(a=this.getSelectedRow(),a.isEditMode()&&a.finishEditing())},this))};McxDataGrid.prototype.setRowSelectionMode=function(a){this._selectionMode=a};McxDataGrid.prototype.getSelectedRows=function(){for(var a=this.base.getInnerChildrenOfType(McxDataRow),b=[],c=0;c<a.length;c++){var d=a[c];d.getIsSelected()&&b.push(d)}return b};
McxDataGrid.prototype.fitColumns=function(){this._table.css("width","100%").addClass("fit-columns")};McxDataGrid.prototype.stretch=function(){this.base.fit();this._gridContainer.css("overflow-y","hidden").css("height","90%");this._tableContainer.css("overflow-x","hidden").css("height","100%");this._gridDataSource&&this._gridContainer.css("box-sizing","border-box").css("border-bottom","32px solid transparent").css("margin-bottom","-32px")};
McxDataGrid.prototype.addColumn=function(a){this._columns.push(a);this.base.addChild(this._thead.find("tr"),a);a.getOnOrderChangeHandler().addListener(this.columnOrderChange,null,this);a.getFilterApplyHandler().addListener(this.applyFilter,null,this)};McxDataGrid.prototype.columnOrderChange=function(a){var b=a.getOrderType();a=a.getColumn();this._gridDataSource&&(this.clear(),this._gridDataSource.orderBy(a,b),this._pageIndex=1)};McxDataGrid.prototype.getColumns=function(){return this._columns};
McxDataGrid.prototype.applyFilter=function(){this.clear();if(this._gridDataSource){for(var a=new McxDataGridFilterBuilder,b=0;b<this._columns.length;b++)a.merge(this._columns[b].getFilter());this._gridDataSource.setFilter(a);this._pageIndex=1}};
McxDataGrid.prototype.relocateColumnHeaders=function(){this.base._rootElement.find("br").remove();this.base._rootElement.find(".mcx-datagrid-headerclone").parent().remove();var a=this._table.clone(!0).addClass("mcx-datagrid-headerclone");a.find("[tabindex]").removeAttr("tabindex");$("<div/>").append(a).insertBefore(this._tableContainer).css({display:"inline-block",height:"31px","overflow-y":"hidden","overflow-x":"hidden",position:"relative","margin-right":this._tableContainer.width()>this._table.width()&&
this._table.hasClass("fit-columns")?"17px":"auto","z-index":10}).after($("<br/>"));$("<div/>").addClass("scroll-hider").insertAfter(this._tableContainer)};McxDataGrid.prototype.addDataRange=function(a){this._data=this._data.concat(a);for(var b=0;b<a.length;b++)this.createRow(a[b]);setTimeout($.proxy(function(){this.relocateColumnHeaders()},this),1)};McxDataGrid.prototype.getRows=function(){return this.base.getInnerChildrenOfType(McxDataRow)};
McxDataGrid.prototype.addItem=function(a,b){return this.createRow(a,b,!0)};
McxDataGrid.prototype.createRow=function(a,b,c){var d=new McxDataRow;this._rowHeight&&d.setHeight(this._rowHeight);d.setRowSelectionMode(this._selectionMode);for(var e=0;e<this._columns.length;e++){var f=this._columns[e],g=null,g=f.getIsBindable()?new McxDataCell(f):new McxNonBindableDataCell(f);g.setItem(a);d.addCell(g)}d.getRowStartEditingHandler().addListener(this.relocateColumnHeaders,null,this);d.getRowFinishEditingHandler().addListener(this.relocateColumnHeaders,null,this);d.getRowChangeHandler().addListener(this.onRowChanged,
null,this);d.getRowSelectHandler().addListener(this.onRowSelected,null,this);d.getRowClickHandler().addListener(this.onRowClickHandler,null,this);d.getRowDoubleClickHandler().addListener(this.onRowDoubleClick,null,this);d.setItem(a);d.isEditable(this._isEditable);isNaN(parseFloat(b))||0==parseFloat(b)?this.base.addChild(this._tbody,d):(d.getContent().insertBefore(this._tbody.find("tr:nth-child("+parseFloat(b+1)+")")),this.base.registerChild(d));c&&this.relocateColumnHeaders();this.getRowAddHandler().dispatchOnSuccess(this,
new McxDataRowEventArgs(d));return d};McxDataGrid.prototype.getData=function(){return this._data};McxDataGrid.prototype.getSelectedRow=function(){for(var a=this.base.getInnerChildrenOfType(McxDataRow),b=0;b<a.length;b++){var c=a[b];if(c.getIsSelected())return c}return null};McxDataGrid.prototype.getSelectedItem=function(){var a=this.getSelectedRow();return a?a.getItem():null};
McxDataGrid.prototype.getSelectedItems=function(){for(var a=this.getSelectedRows(),b=[],c=0;c<a.length;c++)b.push(a[c].getItem());return b};McxDataGrid.prototype.setHeight=function(a){this._tableContainer.height(a);a&&"auto"!=a&&this._tableContainer.css("overflow-x","hidden")};McxDataGrid.prototype.setRowHeight=function(a){this._rowHeight=a;for(var b=this.getRows(),c=0;c<b.length;c++)b[c].setHeight(a)};McxDataGrid.prototype.getRowSelectHandler=function(){return this._rowSelectHandler};
McxDataGrid.prototype.getChanges=function(){for(var a=[],b=this.base.getInnerChildrenOfType(McxDataRow),c=0;c<b.length;c++){var d=b[c];d.isChanged()&&(a[a.length]=d.getItem())}return a};McxDataGrid.prototype.onRowChanged=function(a){this.getRowChangeHandler().dispatchOnSuccess(this,a)};McxDataGrid.prototype.onRowStartEditing=function(){this.relocateColumnHeaders()};McxDataGrid.prototype.onRowSelected=function(a){this.getRowSelectHandler().dispatchOnSuccess(this,a)};
McxDataGrid.prototype.onRowDoubleClick=function(a){this._isEditable||this.getRowDoubleClickHandler().dispatchOnSuccess(this,a)};McxDataGrid.prototype.onRowClickHandler=function(a){for(var b=this.getRows(),c=0;c<b.length;c++){var d=b[c];d!=a.getRow()&&d.isEditMode()&&d.finishEditing()}this.getRowClickHandler().dispatchOnSuccess(this,a)};
McxDataGrid.prototype.removeRow=function(a){a&&(this.getRowRemoveHandler().dispatchOnSuccess(this,new McxDataRowEventArgs(a)),this.base.removeChild(a),a=this._data.indexOf(a.getItem()),this._data=this._data.splice(a,1))};McxDataGrid.prototype.getRowChangeHandler=function(){return this._onRowChangeHandler};McxDataGrid.prototype.getRowRemoveHandler=function(){return this._onRowRemoveHandler};McxDataGrid.prototype.getRowDoubleClickHandler=function(){return this._onRowDoubleClickHandler};
McxDataGrid.prototype.getRowClickHandler=function(){return this._onRowClickHandler};McxDataGrid.prototype.getRowAddHandler=function(){return this._onRowAddHandler};
McxDataGrid.prototype.setDataSource=function(a){this._pageIndex=0;this.base.removeAllChildrenOfType(McxDataRow);this._data=[];this._gridDataSource=a;this._gridDataSource.getDataCompleteEventHandler().addListener(this.onGetDataComplete,null,this);this._gridDataSource.getDataStartEventHandler().addListener(this.onGetDataStart,null,this);this._gridDataSource.getSearchDataCompleteEventHandler().addListener(this.onSearchDataComplete,null,this);var b=a.getFilter();a=b.getFilters();if(b&&0<a.length)for(b=
0;b<a.length;b++){var c=a[b];c.getColumn().addFilter(c)}this.loadMore()};McxDataGrid.prototype.onGetDataComplete=function(a){McxLoadingIndicator.setAsIdle(this.base._rootElement);a=a.getData();this.clear();a&&0<a.length?this.addDataRange(a):this.relocateColumnHeaders();this._loadMoreButton.removeClass("state-loading");this._loadMoreButton.text("Daha Fazla Sonu\u00e7 G\u00f6r\u00fcnt\u00fcle - "+this._data.length+" kay\u0131t g\u00f6r\u00fcnt\u00fcleniyor.").show()};
McxDataGrid.prototype.onGetDataStart=function(){McxLoadingIndicator.setAsBusy(this.base._rootElement)};McxDataGrid.prototype.onSearchDataComplete=function(a){this.clear();this.onGetDataComplete(a)};McxDataGrid.prototype.loadMore=function(){this._loadMoreButton.addClass("state-loading");var a=this._dataCountPerPage,b=this.getRows().length;this._gridDataSource.getData(0,b+a)};
McxDataGrid.prototype.setIsEditable=function(a){this._isEditable=a;a=this.base.getInnerChildrenOfType(McxDataRow);for(var b=0;b<a.length;b++)a[b].isEditable(this._isEditable)};McxDataGrid.prototype.clear=function(){this._data=[];this.base.removeAllChildrenOfType(McxDataRow)};
McxDataGrid.prototype.addEmptyRow=function(a){for(var b={},c=0;c<this._columns.length;c++){var d=this._columns[c];if(d.getIsBindable()){var e=d.getBinding();mcx.isInstanceOf(e,McxDataGridFieldBinding)&&(b[e.getFieldName()]=null);mcx.isInstanceOf(e,McxDataGridPropertyBinding)&&(b[e.getGetterName()+"_"]=null,b[e.getGetterName()]=function(){return this[e.getGetterName()+"_"]},b[e.getSetterName()]=function(a){this[e.getGetterName()+"_"]=a})}}return this.addItem(b,a)};
McxDataGrid.prototype.getIndexOfRow=function(a){return $(a.getContent()).index()};McxDataGrid.prototype.getSelectedRowIndex=function(){return this.getIndexOfRow(this.getSelectedRow())};McxDataGrid.prototype.setDataCountPerPage=function(a){this._dataCountPerPage=a};McxDataGrid.prototype.getGridDataSource=function(){return this._gridDataSource};McxDataGrid.prototype.refresh=function(a,b){this.clear();this._gridDataSource.getData(a?a:0,b?b:this._gridDataSource.getLastLimit())};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxDataGridFilterBuilderPanel={};function McxDataGridFilterBuilderPanel(){mcx.base(this);this.base=this;this._columns=[];this.initialize()}mcx.inherits(McxDataGridFilterBuilderPanel,McxPanel);McxDataGridFilterBuilderPanel.prototype.initialize=function(){this.base.addClass("mcx-datagrid-filter-builder")};
McxDataGridFilterBuilderPanel.prototype.addColumn=function(a){this._columns.push(a);var b=new McxLabeledEditor(a.getTitle(),a.createEditor(),a.getTitleLocalizationKey()||"",6,!0);b.setTag("column",a);this.base.addControl(b)};
McxDataGridFilterBuilderPanel.prototype.getFilter=function(){for(var a=new McxDataGridFilterBuilder,b=this.base.getInnerChildrenOfType(McxLabeledEditor),c=0;c<b.length;c++){var d=b[c],e=d.getTagValue("column");mcx.isInstanceOf(e,McxBaseDataColumn)&&d.getIsEditable()&&(d=d.getEditor(),mcx.isInstanceOf(d,McxValidatableControl)&&a.addFilter(new McxDataGridColumnFilter(e,d.getValue())))}return a};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxDataRow={};
function McxDataRow(){mcx.base(this);this.base=this;this.base._rootElement=$("<tr/>").addClass("mcx-datagrid-row").prop("tabindex","0");this._item=null;this._cellList=[];this._onRowStartEditingHandler=new McxEventHandler;this._onRowFinishEditingHandler=new McxEventHandler;this._onRowChangeHandler=new McxEventHandler;this._onRowSelectHandler=new McxEventHandler;this._onRowDoubleClickHandler=new McxEventHandler;this._onRowClickHandler=new McxEventHandler;this._isEditable=!0;this._selectionMode=McxDataRowSelectMode.SingleSelect;
this._height=null;this.initialize()}mcx.inherits(McxDataRow,McxPanel);McxDataRow.prototype.setRowSelectionMode=function(a){this._selectionMode=a};
McxDataRow.prototype.startEditing=function(){if(this._isEditable&&this._cellList.some(function(a){return a.getColumn().getIsEditable()})){this.base.addClass("mode-edit");for(var a=0;a<this._cellList.length;a++)this._cellList[a].startEditing();this.base._rootElement.find("input:visible:first").focus();this.getRowStartEditingHandler().dispatchOnSuccess(this,new McxDataRowEventArgs(this))}};McxDataRow.prototype.setHeight=function(a){this._height=a;this.base._rootElement.height(a)};
McxDataRow.prototype.onDoubleClick=function(){this.applySelection();this.getRowDoubleClickHandler().dispatchOnSuccess(this,new McxDataRowEventArgs(this))};McxDataRow.prototype.getRowDoubleClickHandler=function(){return this._onRowDoubleClickHandler};McxDataRow.prototype.getRowClickHandler=function(){return this._onRowClickHandler};
McxDataRow.prototype.applySelection=function(){this._selectionMode==McxDataRowSelectMode.None?this.base.removeClass("selected"):(this._selectionMode==McxDataRowSelectMode.SingleSelect&&this.base._rootElement.siblings().removeClass("selected"),this.base.toggleClass("selected"));this.base._rootElement.siblings().removeClass("last-focused");this.base.addClass("last-focused");this.base._rootElement.hasClass("selected")&&this.getRowSelectHandler().dispatchOnSuccess(this,new McxDataRowEventArgs(this))};
McxDataRow.prototype.onFocus=function(a){this.applySelection();$(a.target).blur()};McxDataRow.prototype.onClick=function(a){this.getRowClickHandler().dispatchOnSuccess(this,new McxDataRowEventArgs(this))};McxDataRow.prototype.getIsSelected=function(){return this.base._rootElement.hasClass("selected")};McxDataRow.prototype.validate=function(){for(var a=!0,b=0;b<this._cellList.length;b++)if(a=this._cellList[b].validate(),!a)return!1;return a};
McxDataRow.prototype.finishEditing=function(){if(this.validate()){this.base.removeClass("mode-edit");for(var a=0;a<this._cellList.length;a++)this._cellList[a].finishEditing();this.isChanged()&&this.getRowChangeHandler().dispatchOnSuccess(this,new McxDataRowEventArgs(this));this.base._rootElement.focus();this.getRowFinishEditingHandler().dispatchOnSuccess(this,new McxDataRowEventArgs(this));setTimeout($.proxy(function(){$(".mcx-datetime-picker").hide()},this),150)}};
McxDataRow.prototype.isEditMode=function(){return this.base._rootElement.hasClass("mode-edit")};McxDataRow.prototype.cancelEditing=function(){this.base.removeClass("mode-edit");for(var a=0;a<this._cellList.length;a++)this._cellList[a].cancelEditing();this.base._rootElement.focus()};
McxDataRow.prototype.initialize=function(){this.base._rootElement.dblclick($.proxy(this.startEditing,this));this.base._rootElement.dblclick($.proxy(this.onDoubleClick,this));this.base._rootElement.focus($.proxy(this.onFocus,this));this.base._rootElement.click($.proxy(this.onClick,this));this.base._rootElement.keydown($.proxy(function(a){a.keyCode==McxKeyCode.enter?(this.isEditMode()?this.finishEditing():this.startEditing(),a.stopPropagation(),a.stopImmediatePropagation()):a.keyCode==McxKeyCode.escape&&
(this.cancelEditing(),a.stopPropagation(),a.stopImmediatePropagation())},this))};McxDataRow.prototype.setItem=function(a){this._item=a;for(var b=0;b<this._cellList.length;b++)this._cellList[b].setItem(a)};McxDataRow.prototype.getItem=function(){return this._item};McxDataRow.prototype.isChanged=function(){for(var a=0;a<this._cellList.length;a++)if(this._cellList[a].isChanged())return!0;return!1};
McxDataRow.prototype.addCell=function(a){this._height&&a.getContent().css("padding","0 5px");this._cellList.push(a);this.base.addControl(a)};McxDataRow.prototype.getRowChangeHandler=function(){return this._onRowChangeHandler};McxDataRow.prototype.getRowStartEditingHandler=function(){return this._onRowStartEditingHandler};McxDataRow.prototype.getRowFinishEditingHandler=function(){return this._onRowFinishEditingHandler};McxDataRow.prototype.getRowSelectHandler=function(){return this._onRowSelectHandler};
McxDataRow.prototype.refresh=function(){for(var a=0;a<this._cellList.length;a++){var b=this._cellList[a];mcx.isInstanceOf(b,McxDataCell)&&b.refresh()}};McxDataRow.prototype.isEditable=function(a){this._isEditable=a};McxDataRow.prototype.saveState=function(){for(var a=0;a<this._cellList.length;a++)this._cellList[a].saveState()};McxDataRow.prototype.revert=function(){for(var a=0;a<this._cellList.length;a++)this._cellList[a].revert()};McxDataRow.prototype.getDataCells=function(){return this.base.getInnerChildrenOfType(McxDataCell)};
McxDataRow.prototype.getDataCellByColumn=function(a){for(var b=this.getDataCells(),c=0;c<b.length;c++)if(b[c].getColumn()==a)return b[c];return null};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxDateColumn={};function McxDateColumn(a,b){mcx.base(this,a,b);this.base=this;this._pickerType=McxDateColumnPickerType.date;this._format="DD/MM/YYYY";this.initialize()}mcx.inherits(McxDateColumn,McxBaseDataColumn);
McxDateColumn.prototype.initialize=function(){this.base._editorCreator=$.proxy(function(a){var b=null;this._pickerType==McxDateColumnPickerType.date?b=new McxDateTimePicker(!0,!1):this._pickerType==McxDateColumnPickerType.time?b=new McxDateTimePicker(!1,!0):this._pickerType==McxDateColumnPickerType.dateAndTime&&(b=new McxDateTimePicker(!0,!0));b.setFormat(this._format||"DD/MM/YYYY");b.setValue(a);return b},this)};McxDateColumn.prototype.setFormat=function(a){this._format=a;return this};
McxDateColumn.prototype.setPickerType=function(a){this._pickerType=a||McxDateColumnPickerType.date;return this};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxFeatureRelationColumn={};function McxFeatureRelationColumn(a,b){mcx.base(this,a,b);this.base=this;this._dataSource=null;this._fieldName=this._layerName=this._dataSourceName="";this._showLabels=!1;this.initialize()}mcx.inherits(McxFeatureRelationColumn,McxBaseDataColumn);
McxFeatureRelationColumn.prototype.initialize=function(){this.base._editorCreator=$.proxy(function(a){var b=new McxFieldRelationEditor;b.setParameters(this._dataSource,this._dataSourceName,this._layerName,this._fieldName,a,!this._showLabels);return b},this);this.base.setWidth(100)};McxFeatureRelationColumn.prototype.setParams=function(a,b,c,d,e){this._dataSource=a;this._dataSourceName=b;this._layerName=c;this._fieldName=d;this._showLabels=e||!1;return this};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxLabelDataCell={};function McxLabelDataCell(a){mcx.base(this,new McxBaseDataColumn(a));this.base=this;this.base._rootElement=$("<td/>").addClass("mcx-datagrid-cell");this._text=a;this._labelContainer=$("<div/>").addClass("mcx-datagrid-cell-container");this.base._rootElement.addClass("non-editable");this.base.addElement(this._labelContainer);this._labelContainer.text(this._text)}mcx.inherits(McxLabelDataCell,McxDataCell);
McxLabelDataCell.prototype.setItem=function(a){};McxLabelDataCell.prototype.startEditing=function(){};McxLabelDataCell.prototype.validate=function(){return!0};McxLabelDataCell.prototype.finishEditing=function(){};McxLabelDataCell.prototype.cancelEditing=function(){};McxLabelDataCell.prototype.isChanged=function(){return!1};McxLabelDataCell.prototype.revert=function(){};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxNonBindableDataCell={};function McxNonBindableDataCell(a){mcx.base(this,a);this.base=this;this.base._rootElement.addClass("non-editable")}mcx.inherits(McxNonBindableDataCell,McxDataCell);McxNonBindableDataCell.prototype.setItem=function(a){this.base._item=a;this.base._editor=this.base._column.createEditor();this.base.removeAllChildren();this.base.addControl(this.base._editor)};McxNonBindableDataCell.prototype.startEditing=function(){};
McxNonBindableDataCell.prototype.validate=function(){return!0};McxNonBindableDataCell.prototype.finishEditing=function(){};McxNonBindableDataCell.prototype.cancelEditing=function(){};McxNonBindableDataCell.prototype.isChanged=function(){return!1};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxNumberColumn={};function McxNumberColumn(a,b){mcx.base(this,a,b);this.base=this;this.initialize()}mcx.inherits(McxNumberColumn,McxBaseDataColumn);McxNumberColumn.prototype.initialize=function(){this.base._editorCreator=function(a){var b=new McxNumberBox(-1*Number.MAX_VALUE,Number.MAX_VALUE);b.setValue(a);return b}};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxSelectBoxColumn={};function McxSelectBoxColumn(a,b){mcx.base(this,a,b);this.base=this;this._textGetter=this._valueGetter="toString";this._data=[];this.initialize()}mcx.inherits(McxSelectBoxColumn,McxBaseDataColumn);
McxSelectBoxColumn.prototype.initialize=function(){this.base._editorCreator=$.proxy(function(a){var b=new McxSelectBox;b.setValueGetter(this._valueGetter||"toString");b.setTextGetter(this._textGetter||"toString");b.addEmptyItem("...");b.addItemRange(this._data||[]);b.setValue(a);return b},this)};McxSelectBoxColumn.prototype.setSelectBoxParams=function(a,b,c){this._valueGetter=b||"toString";this._textGetter=c||"toString";this._data=a;return this};js.framework.ui.McxCommonControl.DataGrid.DataGrid.McxStringColumn={};function McxStringColumn(a,b){mcx.base(this,a,b);this.base=this;this.initialize()}mcx.inherits(McxStringColumn,McxBaseDataColumn);McxStringColumn.prototype.initialize=function(){this.base._editorCreator=function(a){var b=new McxTextBox;b.setValue(a);return b}};js.framework.ui.McxCommonControl.DataGrid.PropertyGrid={};js.framework.ui.McxCommonControl.DataGrid.PropertyGrid.McxPropertyGrid={};function McxPropertyGrid(){mcx.base(this);this.base=this;this._table=$("<table/>").addClass("mcx-datagrid");this._columns=[];this._tbody=$("<tbody/>");this._tableContainer=$("<div/>").css({"overflow-x":"hidden",position:"relative",border:"1px solid #006eff"}).addClass("");this._toolBar=new McxCommonToolBar;this._item=null;this.initialize()}
mcx.inherits(McxPropertyGrid,McxPanel);
McxPropertyGrid.prototype.initialize=function(){this.base._rootElement.css("height","100%");this.base.addElement($("<div class ='mcx-property-grid-toolbar' style='position: absolute; z-index: 9999999; right: 0; left: 0;' />").append(this._toolBar.getContent()));this._table.append(this._tbody);this._tableContainer.append(this._table);this.base.addElement($("<div class ='mcx-property-grid-table' style='position: absolute; top: 40px; bottom: 0; overflow-x: hidden'/>").append(this._tableContainer));this._table.css("width",
"100%");this._table.keydown($.proxy(function(a){38!=a.keyCode&&40!=a.keyCode||0!=this.base._rootElement.find(".mcx-datagrid-row:focus").length||(0<this.base._rootElement.find(".mcx-datagrid-row.mode-edit").length?this.base._rootElement.find(".mcx-datagrid-row.mode-edit").focus():38==a.keyCode?this.base._rootElement.find(".mcx-datagrid-row:first").focus():this.base._rootElement.find(".mcx-datagrid-row:last").focus());38==a.keyCode?this.base._rootElement.find(".mcx-datagrid-row:focus").prev(".mcx-datagrid-row").focus():
40==a.keyCode&&this.base._rootElement.find(".mcx-datagrid-row:focus").next(".mcx-datagrid-row").focus()},this))};
McxPropertyGrid.prototype.setItem=function(a){if(a){this.clear();for(var b=0;b<this._columns.length;b++){var c=this._columns[b],d=new McxDataRow;d.addCell(new McxLabelDataCell(c.getTitle()));c=c.getIsBindable()?new McxDataCell(c):new McxNonBindableDataCell(c);d.addCell(c);c.setItem(a);d.setItem(a);d.getRowClickHandler().addListener(this.onRowClickHandler,null,this);this.base.addChild(this._tbody,d)}this._item=a}};
McxPropertyGrid.prototype.onRowClickHandler=function(a){for(var b=this.getInnerChildrenOfType(McxDataRow),c=0;c<b.length;c++){var d=b[c];d!=a.getRow()&&d.isEditMode()&&d.finishEditing()}};McxPropertyGrid.prototype.getItem=function(){return this._item};McxPropertyGrid.prototype.getChangedColumns=function(){for(var a=[],b=this.base.getInnerChildrenOfType(McxDataCell),c=0;c<b.length;c++)b[c].isChanged()&&(a[a.length]=b[c].getColumn());return a};
McxPropertyGrid.prototype.clear=function(a){this.base.removeAllChildrenOfType(McxDataRow);a&&(this._columns=[])};McxPropertyGrid.prototype.addHorizontalColumn=function(a){this._columns.push(a)};McxPropertyGrid.prototype.getToolBar=function(){return this._toolBar};McxPropertyGrid.prototype.showToolBar=function(){this._toolBar.getContent().appendTo(this.base._rootElement.find(".mcx-property-grid-toolbar"));this.base.getContent().find(".mcx-property-grid-table").css("top","40px")};
McxPropertyGrid.prototype.hideToolBar=function(){this._toolBar.detach();this.base.getContent().find(".mcx-property-grid-table").css("top",0)};McxPropertyGrid.prototype.revert=function(){for(var a=this.base.getInnerChildrenOfType(McxDataCell),b=0;b<a.length;b++)a[b].revert()};McxPropertyGrid.prototype.fit=function(){McxPropertyGrid.superClass_.fit.call(this);this.base._rootElement.css({"overflow-x":"hidden"});this._toolBar.getContent().is(":visible")&&this._tableContainer.css("top","30px")};js.framework.ui.McxCommonControl.FeatureGrid.McxDomainColumn={};function McxDomainColumn(a,b){mcx.base(this,a,b);this.base=this;this._codedValues=[];this.initialize()}mcx.inherits(McxDomainColumn,McxBaseDataColumn);McxDomainColumn.prototype.initialize=function(){this.base.setCustomTextGetter(this.domainTextGetter)};
McxDomainColumn.prototype.createEditor=function(){var a=new McxSelectBox;a.setTextGetter("getValue");a.setValueGetter("getCode");a.addItemRange(this._codedValues);this.base.onEditorCreate(a);return a};McxDomainColumn.prototype.setDomain=function(a,b){this._codedValues=[];if(!b)return this;var c=new McxAjaxParameter;c.setAsync(!1);c=a.getDomain(b,c);if(!c||!c.getDomain())return this;this._codedValues=c.getDomain().getCodedValues();return this};
McxDomainColumn.prototype.domainTextGetter=function(a){a=this.base.getValue(a);if(!a&&0!=a)return"";for(var b=0;b<this._codedValues.length;b++)if(this._codedValues[b].getCode()==a)return this._codedValues[b].getValue();return a.toString()};js.framework.ui.McxCommonControl.FeatureGrid.McxFeatureGrid={};function McxFeatureGrid(a,b){mcx.base(this);this.base=this;this._layer=a;this._isCopyLayer=0!=b;this._dataGrid=new McxDataGrid;this._aliasFieldNames=[];this._showFieldNamesArray=[];this._gridShowCount=20;this._editEnabled=!0;this._multiSelectEnabled=!1;this._beforeFeatureSaveHandler=new McxEventHandler;this._beforeFeatureDeleteHandler=new McxEventHandler;this._afterFeatureDeleteHandler=new McxEventHandler}mcx.inherits(McxFeatureGrid,McxPanel);
McxFeatureGrid.prototype.initialize=function(){this._layer.isInstanceOf("IMcxSelectableLayer")&&(this.base.addControl(this._dataGrid),this.createColumns(),this._dataGrid.setRowHeight(20),this._dataGrid.getRowChangeHandler().addListener(this.onRowChange,null,this),this._dataGrid.setDataSource(new McxDataGridFeatureDataSource(this._layer,this._isCopyLayer)))};
McxFeatureGrid.prototype.onRowChange=function(a){var b=a.getRow().getItem(),c=this._layer.createEdit(),d=new McxAjaxParameter;d.setParameters(this,function(){McxLoadingIndicator.setAsIdle(this.base.getContent());a.getRow().saveState();a.getRow().refresh()},function(){a.getRow().revert();McxLoadingIndicator.setAsIdle(this.base.getContent());McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("McxCommonControl-SaveFailed"),McxMessageBoxType.Error)});McxLoadingIndicator.setAsBusy(this.base.getContent());
-1<b.getFeatureID()?c.update(b,d):c.insert(b,d);this.onBeforeSaveFeature(a)};McxFeatureGrid.prototype.onBeforeSaveFeature=function(a){this.getBeforeFeatureSaveHandler().dispatchOnSuccess(this,a)};McxFeatureGrid.prototype.getBeforeFeatureSaveHandler=function(){return this._beforeFeatureSaveHandler};McxFeatureGrid.prototype.stringToBoolean=function(a){return"false"!=a.toString().toLowerCase()&&"true"==a.toString().toLowerCase()?!0:!1};
McxFeatureGrid.prototype.booleanToString=function(a){return!0===a?"True":0==a?"False":"Null"};
McxFeatureGrid.prototype.createColumns=function(){for(var a=this._showFieldNamesArray||[],b=this._dataGrid,c=this._layer.getSchema().getFieldCount(),d=function(a,b){var c=a.getDataSource().getRelation(a.getName(),b,window.McxRelationDirection.up,null);return 0==!(c&&c.getRelation())},e=0;e<c;e++){var f=this._layer.getSchema().getField(e),g=f.getDomainName(),h=f.getFieldName();if(!(0<a.length&&-1==a.indexOf(h)||-1==a.indexOf(h)&&(f.isIgnored()||f.getFieldName()==this._layer.getGeometryField()))){var k=
this._aliasFieldNames[h]||f.getAlias()||h,m=f.getFieldType(),n=new McxStringColumn(k);d(this._layer,h)?(g=this._layer.getDataSource(),m=g.getName(),n=(new McxFeatureRelationColumn(k)).setParams(g,m,this._layer.getName(),h).bindProperty("getValue","setValue",[h]),n.setCustomTextGetter($.proxy(function(a,c){var d=this.self,e=this.column.getValue(a),f=this.fieldName;McxFeatureGridHelper.getRelationLabelAsync($.proxy(function(a){c.setText(a);b.relocateColumnHeaders()},this),f,e,d._layer.getName(),d._layer.getDataSource());
return"Y\u00fckleniyor..."},{column:n,self:this,fieldName:h}))):g?n=(new McxDomainColumn(k)).setDomain(this._layer.getDataSource(),g):m==McxDataType.Boolean?n=(new McxCheckBoxColumn(k)).setValueConverters(this.stringToBoolean,this.booleanToString):m==McxDataType.Byte||m==McxDataType.Decimal||m==McxDataType.Double||m==McxDataType.Float||m==McxDataType.Int16||m==McxDataType.Int32||m==McxDataType.Int64?n=new McxNumberColumn(k):m==McxDataType.DateTime&&(n=(new McxDateColumn(k)).setFormat("DD/MM/YYYY"));
n.setIsFilterable(!0);n.isEditable(this._editEnabled&&f.isEditable()&&!f.isPrimaryKey()&&this._layer.getGeometryField()!=h);n.isRequired(f.isRequired());n.bindProperty("getValue","setValue",[h]);this._dataGrid.addColumn(n)}}};McxFeatureGrid.prototype.setGridCount=function(a){this._dataGrid.setDataCountPerPage(a)};McxFeatureGrid.prototype.getSelectedFeature=function(){return this._dataGrid.getSelectedItem()};McxFeatureGrid.prototype.getSelectedFeatures=function(){return this._dataGrid.getSelectedItems()};
McxFeatureGrid.prototype.setEditable=function(a){this._editEnabled=a;this._dataGrid.setIsEditable(a)};McxFeatureGrid.prototype.insertFeature=function(){this._dataGrid.addItem(this._layer.createFeatureBuffer(),0)};
McxFeatureGrid.prototype.deleteFeature=function(){var a=this._dataGrid.getSelectedRow(),b=a.getItem();if(b&&b.getFeatureID()){var c=new McxAjaxParameter;c.setAsync(!0);c.setParameters(this,function(){var a=this._dataGrid.getSelectedRow();this._dataGrid.removeRow(a);this.onAfterFeatureRemove(new McxDataRowEventArgs(a))},function(){});this._layer.createEdit().deleteFeature(b,c);this.onBeforeFeatureRemove(new McxDataRowEventArgs(a))}};McxFeatureGrid.prototype.getSelectedFeatureEventHandler=function(){return this._dataGrid.getRowSelectHandler()};
McxFeatureGrid.prototype.onBeforeFeatureRemove=function(a){this.getBeforeFeatureDeleteHandler().dispatchOnSuccess(this,a)};McxFeatureGrid.prototype.onAfterFeatureRemove=function(a){this.getAfterFeatureDeleteHandler().dispatchOnSuccess(this,a)};McxFeatureGrid.prototype.getBeforeFeatureDeleteHandler=function(){return this._beforeFeatureDeleteHandler};McxFeatureGrid.prototype.getAfterFeatureDeleteHandler=function(){return this._afterFeatureDeleteHandler};McxFeatureGrid.prototype.setDataGridSize=function(a){this._dataGrid.setHeight(a)};
McxFeatureGrid.prototype.showFieldNames=function(a){this._showFieldNamesArray=a};McxFeatureGrid.prototype.enableMultiSelection=function(a){this._multiSelectEnabled=a;this._dataGrid.setRowSelectionMode(a?McxDataRowSelectMode.MultiSelect:McxDataRowSelectMode.SingleSelect)};McxFeatureGrid.prototype.setAlias=function(a,b){this._aliasFieldNames[a]=b};McxFeatureGrid.prototype.stretch=function(){this.base.fit();this._dataGrid.stretch()};McxFeatureGrid.prototype.fitColumns=function(){this._dataGrid.fitColumns()};
McxFeatureGrid.prototype.getDataGrid=function(){return this._dataGrid};McxFeatureGrid.prototype.addImageButtonColumn=function(a,b){var c=(new McxButtonColumn(b)).setButtonImage(a);c.setButtonVisualType(McxButtonVisualType.linkButton);this._dataGrid.addColumn(c);return c.getClickHandler()};McxFeatureGrid.prototype.getRowDoubleClickHandler=function(){return this._dataGrid.getRowDoubleClickHandler()};js.framework.ui.McxCommonControl.HorizontalAccordion={};js.framework.ui.McxCommonControl.HorizontalAccordion.McxHorizontalAccordion={};function McxHorizontalAccordion(){mcx.base(this);this.base=this;this._containerTr=$("<tr/>");this.base._rootElement.append($("<table/>").addClass("mcx-horizontal-accordion-root").append(this._containerTr))}mcx.inherits(McxHorizontalAccordion,McxPanel);
McxHorizontalAccordion.prototype.addTabPage=function(a,b){var c=$("<td/>").addClass("mcx-horizontal-accordion-page").data("tabPage",a),d=$("<div/>").addClass("mcx-horizontal-accordion-title").html("<label>"+a.getTitle()+"</label>"),e=$("<div/>").addClass("mcx-horizontal-accordion-content");0<this.base._rootElement.find(".mcx-horizontal-accordion-page").length&&c.addClass("mcx-horizontal-accordion-state-closed");b&&c.addClass("mcx-horizontal-accordion-state-fixed");d.click($.proxy(function(){this.toggleClass("mcx-horizontal-accordion-state-closed")},
c));a.getControlSetHandler().addListener(function(){this.self.base.addChild(this.$paneContent,this.tabPage.getControl())},null,{self:this,$paneContent:e,tabPage:a});c.append(d).append(e);this._containerTr.append(c)};McxHorizontalAccordion.prototype.hidePage=function(a){this._containerTr.find(".mcx-horizontal-accordion-page").each(function(b,c){$(c).data("tabPage")==a&&$(c).hide()})};
McxHorizontalAccordion.prototype.showPage=function(a){this._containerTr.find(".mcx-horizontal-accordion-page").each(function(b,c){$(c).data("tabPage")==a&&$(c).show()})};McxHorizontalAccordion.prototype.getTabPageList=function(){var a=[];this._containerTr.find(".mcx-horizontal-accordion-page").each(function(b,c){var d=$(c).data("tabPage");d&&(a[a.length]=d)});return a};js.framework.ui.McxCommonControl.PanoramicImageViewer={};js.framework.ui.McxCommonControl.PanoramicImageViewer.McxPanoramicImageViewer={};
function McxPanoramicImageViewer(){mcx.base(this);this.timeout=null;this.rightButton=$("<div/>").addClass("Panoramic-button-right").prepend('<img draggable="false" id="rightButton" src="src/beus/McxIbbWebAkomApp/Control/assets/img/right.png" width="48px" height="48px" />');this.leftButton=$("<div/>").addClass("Panoramic-button-left").prepend('<img id="rightButton" src="src/beus/McxIbbWebAkomApp/Control/assets/img/left.png" width="48px" height="48px" />');this._imageDiv=$("<div/>").addClass("Panoramic-image");
this._imageDiv.append(this.leftButton).append(this.rightButton);this.initialize()}mcx.inherits(McxPanoramicImageViewer,McxUserControl);
McxPanoramicImageViewer.prototype.initialize=function(){this.leftButton.mousedown($.proxy(function(){this.turnLeftRight("+")},this));this.rightButton.mousedown($.proxy(function(){this.turnLeftRight("-")},this));this._imageDiv.mouseup($.proxy(function(){this.turnLeftRight("+","stop")},this));this._imageDiv.mouseleave($.proxy(function(){this.turnLeftRight("+","stop")},this))};McxPanoramicImageViewer.prototype.setImagePath=function(a){this._imageDiv.css("background-image",'url("'+a+'")')};
McxPanoramicImageViewer.prototype.turnLeftRight=function(a,b){if("stop"==b)return clearInterval(this.timeout),!1;var c=(new Date).getTime();this.timeout=setInterval($.proxy(function(){var b=(new Date).getTime()-c,e=this._imageDiv.css("background-position").split("px")[0].split("%")[0],e=isNaN(parseFloat(e))?0:parseFloat(e);this._imageDiv.css("background-position",parseFloat(e)+("+"==a?-parseFloat(b/75)%100:parseFloat(b/75)%100)+"%");c=(new Date).getTime()},this),.1)};
McxPanoramicImageViewer.prototype.getContent=function(){return this._imageDiv};js.framework.ui.McxCommonControl.PointSymbolizerEditor={};js.framework.ui.McxCommonControl.PointSymbolizerEditor.McxPointSymbolizerEditor={};
function McxPointSymbolizerEditor(){mcx.base(this);this.base=this;this._opacitySlider=this._anchorPointSelector=this._setSymbolButton=this._rootElement=null;this._sizeNumberBox=new McxNumberBox(0,Number.MAX_VALUE,2,136);this._rotateSpinner=new McxNumberSpinner(0,360);this._pointSymbolizer=null;this._markSelector=new McxMarkSelector;this._displacementX=new McxNumberBox;this._displacementY=new McxNumberBox;this._isApplyImmediately=!1;this.initContent()}mcx.inherits(McxPointSymbolizerEditor,McxUserControl);
McxPointSymbolizerEditor.prototype.initContent=function(){var a=$("<div/>"),b=$("<div/>").addClass("mcx-row-fluid"),c=$("<div/>").addClass("mcx-span6");$("<div/>").addClass("mcx-span12");var d=$("<span/>").addClass("content-area-title"),e=$("<div/>").addClass("content-area"),f=$("<div/>").addClass("mcx-span8"),g=new McxNumberSlider(!1,McxNumberSliderMode.Horizontal,0,100,1);g.setValue(100);this.base.addChild(f,g);this._opacitySlider=g;this._anchorPointSelector=new McxAnchorPointEditor;this.base.registerChild(this._sizeNumberBox);
this.base.registerChild(this._rotateSpinner);this.base.registerChild(this._anchorPointSelector);a.append(b.clone().append(c.clone().append(d.clone().html("Symbols").attr("data-localize","McxCommonControl-mcxLayerPropertiesSymbols")).append(e.clone().append(b.clone().css("margin-top","7px").append($("<div/>").addClass("mcx-span4").attr("data-localize","McxCommonControl-mcxLayerPropertiesOpacity").html("Opacity")).append(f)).append(b.clone().append($("<div/>").addClass("mcx-span4").attr("data-localize",
"McxCommonControl-mcxLayerPropertiesSize").html("Size").css("line-height","30px")).append($("<div/>").addClass("mcx-span8").append(this._sizeNumberBox.getContent()))).append(b.clone().css("padding-top","5px").append($('<div style="line-height:28px" />').addClass("mcx-span4").attr("data-localize","McxCommonControl-mcxLayerPropertiesRotation").html("Rotation")).append($("<div/>").addClass("mcx-span8").append(this._rotateSpinner.getContent()))))).append(c.clone().append(d.clone().html("Anchor Point").attr("data-localize",
"McxCommonControl-mcxLayerPropertiesAnchorPoint")).append(e.clone().append(this._anchorPointSelector.getContent()))));b=new McxGroupBox("Displacement");b.setLocalizationKeyForTitle("McxCommonControl-Displacement");c=new McxLayoutRow;c.createAndAddSpan(6,new McxLabeledEditor("Disp. X",this._displacementX,"McxCommonControl-DisplacementX"));c.createAndAddSpan(6,new McxLabeledEditor("Disp. Y",this._displacementY,"McxCommonControl-DisplacementY"));b.addContent(c);this._rootElement=$("<div/>").append(this._markSelector.getContent()).append(a).addClass("");
this.base.addChild(this._rootElement,b);this._markSelector.onMarkChange().addListener(this.applyIfImmediate,null,this);this._opacitySlider.onChange().addListener(this.applyIfImmediate,null,this);this._rotateSpinner.getOnChangeHandler().addListener(this.applyIfImmediate,null,this);this._sizeNumberBox.getOnChangeHandler().addListener(this.applyIfImmediate,null,this)};
McxPointSymbolizerEditor.prototype.setPointSymbolizer=function(a){this._pointSymbolizer=a;this._sizeNumberBox.setValue(this._pointSymbolizer.getSize());this._rotateSpinner.setValue(this._pointSymbolizer.getRotation());this._anchorPointSelector.setAnchorPoint(this._pointSymbolizer.getAnchorPoint());this._anchorPointSelector.setDisplacement(this._pointSymbolizer.getDisplacement());this._displacementX.setValue(this._pointSymbolizer.getDisplacement().getDisplacementX());this._displacementY.setValue(this._pointSymbolizer.getDisplacement().getDisplacementY());
(a=this._pointSymbolizer.getSymbols())&&0<a.length&&this._markSelector.setSelectedMark(a[0])};
McxPointSymbolizerEditor.prototype.applyStyle=function(){if(this._pointSymbolizer){this._pointSymbolizer.setOpacity(this._opacitySlider.getValue()/100);this._anchorPointSelector.applyAnchor();this._pointSymbolizer.setSize(this._sizeNumberBox.getValue());this._pointSymbolizer.setRotation(this._rotateSpinner.getValue());this._pointSymbolizer.getDisplacement().setDisplacementX(this._displacementX.getValue());this._pointSymbolizer.getDisplacement().setDisplacementY(this._displacementY.getValue());var a=
this._markSelector.getMark();a&&this._pointSymbolizer.setSymbols([a])}};McxPointSymbolizerEditor.prototype.setIsApplyImmediately=function(a){this._isApplyImmediately=a};McxPointSymbolizerEditor.prototype.applyIfImmediate=function(){this._isApplyImmediately&&this.applyStyle()};McxPointSymbolizerEditor.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.PolygonSymbolizerEditor={};js.framework.ui.McxCommonControl.PolygonSymbolizerEditor.McxPolygonSymbolizerEditor={};function McxPolygonSymbolizerEditor(){mcx.base(this);this.base=this;this._fillEditor=this._strokeEditor=this._polygonSymbolizer=this._rootElement=null;this._setSymbolizerCompleted=this._isApplyImmediately=!1;this._fillGroup=this._strokeGroup=null;this.initialize()}mcx.inherits(McxPolygonSymbolizerEditor,McxUserControl);
McxPolygonSymbolizerEditor.prototype.initialize=function(){this._rootElement=$("<div/>");this._strokeEditor=new McxStrokeEditor;this._fillEditor=new McxFillEditor;this._strokeGroup=new McxGroupBox("Stroke");this._strokeGroup.addContent(this._strokeEditor);this._strokeGroup.setLocalizationKeyForTitle("McxCommonControl-mcxLayerPropertiesStroke");this._strokeGroup.setCanBeDisabled(!0);this._fillGroup=new McxGroupBox("Fill");this._fillGroup.addContent(this._fillEditor);this._fillGroup.setLocalizationKeyForTitle("McxCommonControl-mcxLayerPropertiesFill");
this._fillGroup.setCanBeDisabled(!0);var a=new McxLayoutRow;a.createAndAddSpan(6,this._strokeGroup);a.createAndAddSpan(6,this._fillGroup);this.base.addChild(this._rootElement,a);this._strokeEditor.getOnStrokeChangeHandler().addListener(function(){this.onStyleChange()},null,this);this._fillEditor.getFillChangeHandler().addListener(function(){this.onStyleChange()},null,this);this._fillGroup.getEnabledChangeHandler().addListener(function(){this.onStyleChange()},null,this);this._strokeGroup.getEnabledChangeHandler().addListener(function(){this.onStyleChange()},
null,this)};McxPolygonSymbolizerEditor.prototype.setPolygonSymbolizer=function(a){this._setSymbolizerCompleted=!1;this._polygonSymbolizer=a;0==mcx.isDefAndNotNull(this._polygonSymbolizer.getStroke())&&this._strokeGroup.setIsEnabled(!1);this._strokeEditor.setStroke(this._polygonSymbolizer.getStroke());0==mcx.isDefAndNotNull(this._polygonSymbolizer.getFill())&&this._fillGroup.setIsEnabled(!1);this._fillEditor.setFill(this._polygonSymbolizer.getFill());this._setSymbolizerCompleted=!0};
McxPolygonSymbolizerEditor.prototype.onStyleChange=function(){this._isApplyImmediately&&this._setSymbolizerCompleted&&this.applyStyle()};McxPolygonSymbolizerEditor.prototype.setIsApplyImmediately=function(a){this._isApplyImmediately=a};McxPolygonSymbolizerEditor.prototype.getContent=function(){return this._rootElement};
McxPolygonSymbolizerEditor.prototype.applyStyle=function(){this._fillGroup.getIsEnabled()?(this._polygonSymbolizer.setFill(this._fillEditor.getFill()),this._fillEditor.applyFill()):this._polygonSymbolizer.setFill(null);this._strokeGroup.getIsEnabled()?(this._polygonSymbolizer.setStroke(this._strokeEditor.getStroke()),this._strokeEditor.applyStroke()):this._polygonSymbolizer.setStroke(null)};js.framework.ui.McxCommonControl.ProgressBar={};js.framework.ui.McxCommonControl.ProgressBar.McxProgressBar={};
function McxProgressBar(){mcx.base(this);this.base=this;this._rootElement=$("<div/>").addClass("mcx-progress-bar-container");this._progressBarStripElem=$('<div style="width: 100%;" class="bar"></div>');this._progressBarLabelElem=$("<div/>").attr("data-localize","progressLoading").html("Loading").addClass("mcx-progress-bar-label");this.uniqueElementId=McxGuid.createGuid();this.initialize()}mcx.inherits(McxProgressBar,McxUserControl);
McxProgressBar.prototype.initialize=function(){var a=$('<div class="progress progress-striped active"></div>').append(this._progressBarLabelElem).append(this._progressBarStripElem);this._rootElement.append(a)};McxProgressBar.prototype.getContent=function(){return this._rootElement};McxProgressBar.prototype.finish=function(){this._rootElement.find(".progress").removeClass("progress-striped").removeClass("active").removeClass("progress-canceled").addClass("progress-finished")};
McxProgressBar.prototype.cancel=function(){this._rootElement.find(".progress").removeClass("progress-striped").removeClass("active").removeClass("progress-finished").addClass("progress-canceled")};McxProgressBar.prototype.start=function(){this._rootElement.find(".progress").addClass("progress-striped").addClass("active").removeClass("progress-finished").removeClass("progress-canceled")};McxProgressBar.prototype.setText=function(a){this._progressBarLabelElem.html(a)};
McxProgressBar.prototype.setPercentage=function(a){this._rootElement.find(".bar").css("width",a+"%")};js.framework.ui.McxCommonControl.RadioButton={};js.framework.ui.McxCommonControl.RadioButton.McxRadioButton={};function McxRadioButton(a){mcx.base(this);this.base=this;this._container=$("<div/>");this._radioButton=null;this._isEnabled=!1;this._label=null;this._onChangeHandler=new McxEventHandler;this._radioButtonName=this._radioButtonValue="";this._name=a||"";this._radioButtonId=McxGuid.createGuid();this.init()}mcx.inherits(McxRadioButton,McxUserControl);
McxRadioButton.prototype.init=function(){this._radioButton=$('<input id="'+this._radioButtonId+'" type="radio"/>');this._radioButton.change($.proxy(this.onChange,this));this._name&&this._radioButton.prop("name",this._name);this._label=$('<label for="'+this._radioButtonId+'" data-localize-for=""/>');this._container.append($('<div style="float: left;padding: 5px"/>').append(this._radioButton)).append(this._label)};
McxRadioButton.prototype.setText=function(a){a=$("<span/>").html(a).attr("data-localize",a);this._label.find("span").remove();this._label.append(a)};McxRadioButton.prototype.getText=function(){return this._label.find("span").html().toString()};McxRadioButton.prototype.isChecked=function(){return this._radioButton.is(":checked")};McxRadioButton.prototype.checked=function(a){this._radioButton.attr("checked",a)};
McxRadioButton.prototype.onChange=function(){this.onChangeHandler().dispatchOnSuccess(this,null)};McxRadioButton.prototype.onChangeHandler=function(){return this._onChangeHandler};McxRadioButton.prototype.getContent=function(){return this._container};McxRadioButton.prototype.setValue=function(a){this._radioButtonValue=a;this._radioButton.attr({value:this._radioButtonValue})};McxRadioButton.prototype.getValue=function(){return this._radioButtonValue};
McxRadioButton.prototype.setName=function(a){this._radioButtonName=a;this._radioButton.attr({name:this._radioButtonName})};McxRadioButton.prototype.enabled=function(a){a?this._radioButton.removeAttr("disabled"):this._radioButton.attr("disabled","disabled")};McxRadioButton.prototype.setAttribute=function(a,b){this._radioButton.attr(a,b)};McxRadioButton.prototype.getAttribute=function(a){return this._radioButton.attr(a).toString()};
McxRadioButton.prototype.createToolTip=function(a){this._label.css("cursor","help");this._label.html('<a href="#" class="toolTipLink" data-localize="'+a+'" data-localize-for="title" title="'+a+'">'+this._label[0].outerHTML+"</a>")};js.framework.ui.McxCommonControl.RenderStatusWatermark={};js.framework.ui.McxCommonControl.RenderStatusWatermark.McxRenderStatusWatermark={};
function McxRenderStatusWatermark(){mcx.base(this);this.base=this;this._onClickEventHandler=new McxEventHandler;this._watermarkTextElem=this._watermarkElem=null;this._closeButtonTemplate=$('<div data-localize="McxCommonControl-mcxRenderWaterMarkAbort">abort</div>').css("-o-border-radius","5px").css("-webkit-transition"," all 0.2s ease").css("-moz-transition"," all 0.2s ease").css("-ms-transition"," all 0.2s ease").css("-o-transition"," all 0.2s ease").css("transition"," all 0.2s ease;").addClass("watermark-abort-text");
this._map=null;this.initialize();this.bindEvents()}mcx.inherits(McxRenderStatusWatermark,McxUserControl);
McxRenderStatusWatermark.prototype.initialize=function(){var a=$('<div style="font-weight:normal;color:#000000;letter-spacing:1pt;word-spacing:3pt;font-size:41px;text-align:left;font-family:courier new, courier, monospace;"></div>').attr("title","Abort").attr("data-localize","abort").attr("data-localize-for","title").css("-moz-border-radius","5px").css("-webkit-border-radius","5px").css("-o-border-radius","5px").css("-webkit-transition"," all 0.2s ease").css("-moz-transition"," all 0.2s ease").css("-ms-transition",
" all 0.2s ease").css("-o-transition"," all 0.2s ease").css("transition"," all 0.2s ease;").css("border-radius","5px").css("background","#fff").css("display","none").css("position","absolute").css("bottom","50px").css("cursor","pointer").css("right","10px").css("z-index",999999999).css("min-width","75px").css("text-align","center").addClass("mcx-render-watermark");this._watermarkTextElem=$("<div/>").appendTo(a);this._watermarkElem=a};
McxRenderStatusWatermark.prototype.setValue=function(a){this._watermarkElem.hasClass("hover")||this._watermarkTextElem.html("%"+Math.round(a).toString())};McxRenderStatusWatermark.prototype.show=function(){this._watermarkElem.show();var a=this._watermarkElem.parents(".mcxpanel");0<a.length&&this._watermarkElem.detach().appendTo(a)};McxRenderStatusWatermark.prototype.hide=function(){this._watermarkElem.hide(0).css("background","#fff").css("color","#000").removeClass("hover")};
McxRenderStatusWatermark.prototype.onClick=function(){return this._onClickEventHandler};
McxRenderStatusWatermark.prototype.bindEvents=function(){var a=this;this._watermarkElem.mousedown(function(b){mcx.isDefAndNotNull(a._map)&&a._map.getRenderer().abortRender();a.onClick().dispatchOnSuccess(a,null);b.stopPropagation()});var b=0;this._watermarkElem.hover(function(){a._watermarkTextElem.html("");a._watermarkTextElem.append(a._closeButtonTemplate.html(McxLocalizationManager.getLocaleValue("app_abort")));$(this).css("background","#ff4444").css("color","#fff").addClass("hover");clearTimeout(b)},
function(){var a=this;b=setTimeout(function(){$(a).css("background","#fff").css("color","#000").css("transform","rotateY(0deg)").removeClass("hover");a._closeButtonTemplate.css("transform","rotateY(0deg)")},200)})};McxRenderStatusWatermark.prototype.setMap=function(a){this._map=a};McxRenderStatusWatermark.prototype.onRenderChange=function(a){a.getStatus()!=McxRendererStatus.End&&a.getStatus()!=McxRendererStatus.Canceled||this.hide()};McxRenderStatusWatermark.prototype.getContent=function(){return this._watermarkElem};js.framework.ui.McxCommonControl.ScaleControl={};js.framework.ui.McxCommonControl.ScaleControl.McxScaleControl={};
function McxScaleControl(a){mcx.base(this);this._rootElement=$("<div/>").addClass("mcx-scale-control");this._map=a;this._clicked=!1;this._scaleBar=null;this._factor=5;this._max=a.getScale()*this._factor;this._zoomInButton=$("<div/>").addClass("mcx-crm-zoom-control-button zoom-in").click($.proxy(this.zoomIn,this));this._zoomOutButton=$("<div/>").addClass("mcx-crm-zoom-control-button zoom-out").click($.proxy(this.zoomOut,this));this.initialize();a.getScaleChangedEventHandler().addListener(this.onScaleChange,
null,this)}mcx.inherits(McxScaleControl,McxUserControl);
McxScaleControl.prototype.initialize=function(){var a=$("<div/>").addClass("container").attr("draggable","true"),b=$("<div/>").addClass("stick");this._scaleBar=$("<div/>").addClass("bar");a.append(b);a.append(this._scaleBar);this._rootElement.append(this._zoomInButton);this._rootElement.append(a);this._rootElement.append(this._zoomOutButton);this._scaleBar.css("margin-top","55px");var c=this;a.on("mousedown",function(a){c._clicked=!0});a.on("mousemove",function(a){c._clicked&&c.calculateTop(a,this)});
a.on("mouseup",function(a){a=a.clientY-$(this).offset().top;a>$(this).height()-5&&(a=$(this).height()-5);var b=$(this).height();c._map.setScale(1/(100*a/b*c._max/100));c._map.getRenderer().paintLayer(null,null);c._scaleBar.css("margin-top",(b-10)/2+"px")});$(document).on("mouseup",function(){c._clicked=!1})};
McxScaleControl.prototype.zoomIn=function(){if(this._map){var a=this._map.getWorld(),b=a.getCentroid(),c=a.getWidth(),a=a.getHeight(),b=new McxBounds(b.getX()-c/4,b.getY()-a/4,b.getX()+c/4,b.getY()+a/4,this._map.getCoordinateSystem());this._map.setWorld(b.getLeft(),b.getBottom(),b.getRight(),b.getTop());b=this._map.getRenderer();b.clearBackBuffer();b.getLabelCanvas().clearCanvas();b.paintLayer(null,null)}};
McxScaleControl.prototype.zoomOut=function(){if(this._map){var a=this._map.getWorld(),b=a.getCentroid(),c=a.getWidth(),a=a.getHeight(),b=new McxBounds(b.getX()-1.4*c,b.getY()-1.4*a,b.getX()+1.4*c,b.getY()+1.4*a,this._map.getCoordinateSystem());this._map.setWorld(b.getLeft(),b.getBottom(),b.getRight(),b.getTop());b=this._map.getRenderer();b.clearBackBuffer();b.paintLayer(null,null)}};McxScaleControl.prototype.onScaleChange=function(){this._max=Math.round(1/this._map.getScale())*this._factor};
McxScaleControl.prototype.calculateTop=function(a,b){var c=a.clientY-$(b).offset().top;c>$(b).height()-5&&(c=$(b).height()-5);this._scaleBar.css("margin-top",c+"px")};McxScaleControl.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.SelectBox={};js.framework.ui.McxCommonControl.SelectBox.McxSelectBox={};
function McxSelectBox(){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._selectBox=$("<select/>");this._optionDataKey="relatedSelectItem";this._onSelectHandler=new McxEventHandler;this._textGetter="getValue";this._valueGetter="getKey";this._textGetterParams=[];this._valueGetterParams=[];this._optionFormatter=this._options=null;this._isLocalizable=!1;this._isLimited=!0;this._maxItemCount=1E3;this._showMaxItemMessage=!1;this._maxItemMessage="";this._maxItemMessageShown=!1;this._onBlurEventHandler=
new McxEventHandler;this._onClickEventHandler=new McxEventHandler;this._firstClick=!0;this._isDuplicateValuesAllowed=!1;this.initialize()}mcx.inherits(McxSelectBox,McxValidatableControl);McxSelectBox.prototype.initialize=function(){this._selectBox.addClass("mcx-input").addClass("fit").css("width","100%").change($.proxy(this.onSelectionChange,this)).blur($.proxy(this.onBlur,this)).mousedown($.proxy(this.onFirstClick,this));this._rootElement.append(this._selectBox)};
McxSelectBox.prototype.setWidth=function(a){this._selectBox.width(a)};McxSelectBox.prototype.setIsLocalizable=function(a){this._isLocalizable=a};McxSelectBox.prototype.getOnSelectHandler=function(){return this._onSelectHandler};McxSelectBox.prototype.getOnBlurHandler=function(){return this._onBlurEventHandler};
McxSelectBox.prototype.getSelectedItem=function(){var a=this._selectBox.find("option:selected").data(this._optionDataKey);if(!a)return null;var b=a.isEmptyItem,c=a.isCustomItem;(b||c)&&a.selectCallback&&a.selectCallback();return b?null:c?new McxKeyValuePair(this.getValueForItem(a,this._valueGetter,this._valueGetterParams),this.getValueForItem(a,this._textGetter,this._textGetterParams)):a};
McxSelectBox.prototype.getSelectedValue=function(){var a=this.getSelectedItem();return a?this.getValueForItem(a,this._valueGetter,this._valueGetterParams):null};McxSelectBox.prototype.getValueForItem=function(a,b,c){if(0==mcx.isDefAndNotNull(b))for(var d in a)if("function"!==typeof a[b]){b=d;break}return 0==mcx.isDefAndNotNull(b)?null:"function"===typeof b?b.apply(a,c):"function"===typeof a[b]?a[b].apply(a,c)||0==a[b].apply(a,c)?a[b].apply(a,c):"":a[b]||0==a[b]?a[b]:""};
McxSelectBox.prototype.setTextGetter=function(a,b){this._textGetter=a;this._textGetterParams=b?b:[];var c=this;this._selectBox.find("option").each(function(){var a=$(this).data(c._optionDataKey);$(this).html(c.getValueForItem(a,c._textGetter,c._textGetterParams).toString())})};
McxSelectBox.prototype.setValueGetter=function(a,b){this._valueGetter=a;this._valueGetterParams=b?b:[];var c=this;this._selectBox.find("option").each(function(){var a=$(this).data(c._optionDataKey);$(this).val(c.getValueForItem(a,c._valueGetter,c._valueGetterParams).toString())})};
McxSelectBox.prototype.addItem=function(a,b){if(this._isLimited&&this._selectBox.find("option").length>this._maxItemCount)this._showMaxItemMessage&&!this._maxItemMessageShown&&(this._maxItemMessageShown=!0,McxMessageBox.show("",this._maxItemMessage,McxMessageBoxType.Information));else{var c=this.getValueForItem(a,this._valueGetter,this._valueGetterParams);if(this._isDuplicateValuesAllowed||!this.containsValue(c)){var d=$("<option/>").data(this._optionDataKey,a).val(c).text(this.getValueForItem(a,
this._textGetter,this._textGetterParams)).addClass("");this._isLocalizable&&McxLocalizationManager.localizeContent(d.attr("data-localize",this.getValueForItem(a,this._textGetter,this._textGetterParams)),"",!0);mcx.isDefAndNotNull(this._optionFormatter)&&this._optionFormatter.call(this,d,a);var e=null;b&&(e=this._selectBox.find('optgroup[label="'+b+'"]'),0==e.length&&(e=$("<optgroup/>").attr("label",b).appendTo(this._selectBox)));e&&0<e.parents("select").length?e.append(d):this._selectBox.append(d);
1==this._selectBox.find("option").length&&this.setSelectedValue(c)}}};McxSelectBox.prototype.containsValue=function(a){var b=this;return 0<this._selectBox.find("option").filter(function(){var c=$(this).data(b._optionDataKey);return b.getValueForItem(c,b._valueGetter,b._valueGetterParams)==a}).length};McxSelectBox.prototype.addItemRange=function(a){for(var b=0;b<a.length;b++)this.addItem(a[b])};
McxSelectBox.prototype.onSelectionChange=function(){this.base.getChangeEventHandler().dispatchOnSuccess(this,new McxEventArgs(null));this.getOnSelectHandler().dispatchOnSuccess(this,new McxSelectBoxEventArgs([this.getSelectedItem()],this))};McxSelectBox.prototype.onBlur=function(){this._onBlurEventHandler.dispatchOnSuccess(this,null)};McxSelectBox.prototype.clear=function(){this._selectBox.html("")};McxSelectBox.prototype.clearSelection=function(){this.setSelectedValue([])};
McxSelectBox.prototype.setSelectedItem=function(a){this.setSelectedValue(this.getValueForItem(a,this._valueGetter,this._valueGetterParams))};McxSelectBox.prototype.setSelectedValue=function(a){this._selectBox.val([]);null!=a&&(this._selectBox.val(a.toString()),0<this._selectBox.find("option:selected").length&&this._selectBox.change())};McxSelectBox.prototype.setOptionFormatter=function(a){this._optionFormatter=a};McxSelectBox.prototype.setIsEnabled=function(a){this._selectBox.prop("disabled",a)};
McxSelectBox.prototype.addEmptyItem=function(a,b){var c={};c[this._textGetter||"getValue"]=a;c.isEmptyItem=!0;c.selectCallback=b;this.addItem(c)};McxSelectBox.prototype.addCustomItem=function(a,b,c){var d=this._valueGetter||"getKey",e={};e[this._textGetter||"getValue"]=a;e[d]=b;e.isCustomItem=!0;e.selectCallback=c;this.addItem(e)};
McxSelectBox.prototype.updateTextOfValue=function(a,b){var c=this;this._selectBox.find("option").filter(function(){var b=$(this).data(c._optionDataKey);return c.getValueForItem(b,c._valueGetter,c._valueGetterParams)==a}).html(b)};McxSelectBox.prototype.removeItem=function(a){(a=this.getValueForItem(a,this._valueGetter,this._valueGetterParams))&&this.removeItemByValue(a)};
McxSelectBox.prototype.removeItemByValue=function(a){var b=this;this._selectBox.find("option").filter(function(){var c=$(this).data(b._optionDataKey);return b.getValueForItem(c,b._valueGetter,b._valueGetterParams)==a}).remove()};McxSelectBox.prototype.isEmpty=function(){return 0==this._selectBox.find("option").length};
McxSelectBox.prototype.getItems=function(a){var b=this,c=[];this._selectBox.find("option").each(function(d,e){var f=$(e).data(b._optionDataKey);a?a&&mcx.isInstanceOf(f,a)&&(c[c.length]=f):c[c.length]=f});return c};McxSelectBox.prototype.setIsLimited=function(a){this._isLimited=a};McxSelectBox.prototype.setMaxItemCount=function(a){this._maxItemCount=a};McxSelectBox.prototype.getMaxItemCount=function(){return this._maxItemCount};
McxSelectBox.prototype.setMaxItemCountMessage=function(a){this._showMaxItemMessage=!0;this._maxItemMessage=a};McxSelectBox.prototype.moveUpSelection=function(){var a=$(this._selectBox.find("option:selected")),b=a.prev("option:not(:selected)").eq(0);a.insertBefore(b)};McxSelectBox.prototype.moveDownSelection=function(){var a=$(this._selectBox.find("option:selected")),b=a.next("option:not(:selected)").eq(0);a.insertAfter(b)};
McxSelectBox.prototype.getText=function(){var a=this.getValueForItem(this.getSelectedItem(),this._textGetter,this._textGetterParams);return a?a.toString():""};McxSelectBox.prototype.getValue=McxSelectBox.prototype.getSelectedValue;McxSelectBox.prototype.setValue=McxSelectBox.prototype.setSelectedValue;McxSelectBox.prototype.getContent=function(){return this._rootElement};
McxSelectBox.prototype.onFirstClick=function(){0!=this._firstClick&&(this._firstClick=!1,this._onClickEventHandler.dispatchOnSuccess(this,null),this.dropdownOpen())};McxSelectBox.prototype.getOnFirstClickHandler=function(){return this._onClickEventHandler};McxSelectBox.prototype.isDuplicateValuesAllowed=function(a){this._isDuplicateValuesAllowed=a||!1};
McxSelectBox.prototype.dropdownOpen=function(){var a=this._selectBox[0],b=!1;document.createEvent?(b=document.createEvent("MouseEvents"),b.initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),b=a.dispatchEvent(b)):a.fireEvent&&(b=a.fireEvent("onmousedown"));b||console.log("dropdown not support")};js.framework.ui.McxCommonControl.ComboBox.McxComboBox={};function McxComboBox(){mcx.base(this);this.base=this;this._placeHolderInput=$("<input/>").prop("type","text");this._removeItemButton=$("<div/>").addClass("mcx-combobox-remove-button");this._isAutoFocus=this._filterStatus=!0;this._lazyLoader=null;this._enterEventHandler=new McxEventHandler;this.initializeComboBox()}mcx.inherits(McxComboBox,McxSelectBox);
McxComboBox.prototype.initializeComboBox=function(){var a=null;this.base._rootElement.addClass("mcx-combobox").append(this._placeHolderInput);this.base._rootElement.addClass("mcx-combobox").append(this._removeItemButton);this.base.setTextGetter("toString");this.base.setValueGetter("toString");this.base.getOnSelectHandler().addListener(function(){this._placeHolderInput.val(this.base._selectBox.find("option:selected").text());this._isAutoFocus&&this._placeHolderInput.focus()},null,this);this.base._selectBox.keydown($.proxy(function(a){a=
a.keyCode||a.charCode;if(38==a||40==a)this._placeHolderInput.val(this.base._selectBox.find("option:selected").first().text()),this.filterOptionsByInputValue()},this));this.base._selectBox.keypress($.proxy(function(a){var c=String.fromCharCode(a.which||a.keyCode),d=this._placeHolderInput.val();a=a.keyCode||a.charCode;/[A-Za-z0-9 _]*[A-Za-z0-9 _][A-Za-z0-9 _]*/.test(c)?this._placeHolderInput.val(d+c):a==McxKeyCode.backspace?this._placeHolderInput.val(d.substring(0,d.length-1)):a==McxKeyCode.enter&&
this._enterEventHandler.dispatchOnSuccess(this,new McxEventArgs(d));this.filterOptionsByInputValue()},this));this._placeHolderInput.keydown($.proxy(function(b){b.which==McxKeyCode.enter&&(b=this._placeHolderInput.val(),this._enterEventHandler.dispatchOnSuccess(this,new McxEventArgs(b)));a&&clearTimeout(a);a=setTimeout($.proxy(this.filterOptionsByInputValue,this),500)},this))};McxComboBox.prototype.getText=function(){return this._placeHolderInput.val().toString()};
McxComboBox.prototype.setFilterStatus=function(a){this._filterStatus=a};McxComboBox.prototype.setText=function(a){return this._placeHolderInput.val(a)};McxComboBox.prototype.filterOptionsByInputValue=function(){if(this._filterStatus){var a=this._placeHolderInput.val().toString();if(this._lazyLoader){var b=this._lazyLoader.call(this,a);this.base.clear();this.base.addEmptyItem(a);this.base.addItemRange(b)}else this.filterOptionsByText(a)}};
McxComboBox.prototype.filterOptionsByText=function(a){this.base._selectBox.find("option").each(function(b,c){-1<$(c).text().indexOf(a)?$(c).show():$(c).hide()});0==this.base._selectBox.find("option:visible").length&&18>this.base._rootElement.height()?this.base._selectBox.prop("style","height: 30px ! important;"):this.base._selectBox.removeAttr("style")};McxComboBox.prototype.setLazyLoader=function(a){this._lazyLoader=a};McxComboBox.prototype.isAutoFocusOnSelection=function(a){this._isAutoFocus=a};
McxComboBox.prototype.getOnEnterKey=function(){return this._enterEventHandler};js.framework.ui.McxCommonControl.ListBox={};js.framework.ui.McxCommonControl.ListBox.McxListBox={};function McxListBox(){mcx.base(this);this.base=this;this._isMultiSelect=!1;this.makeListBox()}mcx.inherits(McxListBox,McxSelectBox);McxListBox.prototype.makeListBox=function(){this.base.getSelectedItem=this.getSelectedItems;this.base._selectBox.attr("size",10)};McxListBox.prototype.setVisibleItemCount=function(a){this.base._selectBox.attr("size",a)};
McxListBox.prototype.removeSelectedItems=function(){var a=this.getSelectedItems(),b=this.base.getItems().filter(function(b){return 0>a.indexOf(b)});this.base.clear();this.base.addItemRange(b)};McxListBox.prototype.setHeight=function(a){this.base._selectBox.css("height",a)};McxListBox.prototype.selectAll=function(){this._isMultiSelect&&(this.base._selectBox.find("option").prop("selected",!0),this.onSelectionChange())};McxListBox.prototype.deselectAll=function(){this.base._selectBox.val([]);this.onSelectionChange()};
McxListBox.prototype.setMultiSelect=function(a){this.base._selectBox.prop("multiple",a);this._isMultiSelect=a};McxListBox.prototype.fitHeightToOptionsLength=function(){var a=this.base._selectBox.find("option").length;this.setVisibleItemCount(a);$.browser.webkit&&(4>a?this.base._selectBox.css("max-height",20*a+10+"px"):this.base._selectBox.css("max-height","none"))};
McxListBox.prototype.getSelectedItems=function(){var a=[],b=this;this.base._selectBox.find("option:selected").each(function(){var c=$(this).data(b._optionDataKey);c.isEmptyItem||a.push(c)});return a};McxListBox.prototype.setSelectedItems=function(a){for(var b=[],c=0;c<a.length;c++)b[c]=this.base.getValueForItem(a[c],this.base._valueGetter);this.base._selectBox.val([]).val(b);this.base.getOnSelectHandler().dispatchOnSuccess(this,new McxEventArgs(a))};
McxListBox.prototype.onSelectionChange=function(){this.base.getOnSelectHandler().dispatchOnSuccess(this,new McxSelectBoxEventArgs(this.getSelectedItems(),this))};McxListBox.prototype.selectValue=function(a){if(0!=mcx.isDefAndNotNull(a)){if(this._isMultiSelect){var b=this.base._selectBox.val()||[],b=b.concat(a);this.base._selectBox.val(b)}else this.base._selectBox.val(a.toString());this.onSelectionChange()}};
McxListBox.prototype.equals=function(a,b){if(a==b||a===b)return!0;for(var c in a)if(a[c].toString()!=b[c].toString())return!1;return!0};js.framework.ui.McxCommonControl.SelectBox.McxFancySelectBox={};function McxFancySelectBox(a){mcx.base(this);this._isMultiSelect=a||!1;this.base=this;this._onEnterKeyEventHandler=new McxEventHandler;this._eventHandler={};this.init()}mcx.inherits(McxFancySelectBox,McxSelectBox);
McxFancySelectBox.prototype.bindInput=function(){this.base._selectBox.data("select2").$dropdown.find(".select2-search__field").bindFirst("keydown",$.proxy(function(a){13==a.keyCode&&this.getOnEnterKey().dispatchOnSuccess(this,null)},this))};
McxFancySelectBox.prototype.init=function(){this.base._selectBox.prop("multiple",this._isMultiSelect);this._eventHandler.change=new McxEventHandler;this._eventHandler.open=new McxEventHandler;this._eventHandler.close=new McxEventHandler;this._eventHandler.highlight=new McxEventHandler;this._eventHandler.selecting=new McxEventHandler;this._eventHandler.unselecting=new McxEventHandler;this._eventHandler.unselect=new McxEventHandler;this._eventHandler.select=new McxEventHandler;this._eventHandler.removed=
new McxEventHandler;this._eventHandler.loaded=new McxEventHandler;this._eventHandler.focus=new McxEventHandler;this.base._selectBox.select2().on("change",$.proxy(function(a){a=new McxEventArgs(a);this._eventHandler.change.dispatchOnSuccess(this,a)},this)).on("select2:open",$.proxy(function(a){a=new McxEventArgs(a);this._eventHandler.open.dispatchOnSuccess(this,a)},this)).on("select2:close",$.proxy(function(a){a=new McxEventArgs(a);this._eventHandler.close.dispatchOnSuccess(this,a)},this)).on("select2:highlight",
$.proxy(function(a){a=new McxEventArgs(a);this._eventHandler.highlight.dispatchOnSuccess(this,a)},this)).on("select2:selecting",$.proxy(function(a){a=new McxEventArgs(a);this._eventHandler.selecting.dispatchOnSuccess(this,a)},this)).on("select2:select",$.proxy(function(a){a=new McxEventArgs(a);this._eventHandler.select.dispatchOnSuccess(this,a)},this)).on("select2:removed",$.proxy(function(a){a=new McxEventArgs(a);this._eventHandler.removed.dispatchOnSuccess(this,a)},this)).on("select2:unselecting",
$.proxy(function(a){a=new McxEventArgs(a);this._eventHandler.unselecting.dispatchOnSuccess(this,a)},this)).on("select2:unselect",$.proxy(function(a){a=new McxEventArgs(a);this._eventHandler.unselect.dispatchOnSuccess(this,a)},this)).on("select2:loaded",$.proxy(function(a){a=new McxEventArgs(a);this._eventHandler.loaded.dispatchOnSuccess(this,a)},this)).on("select2:focus",$.proxy(function(a){a=new McxEventArgs(a);this._eventHandler.focus.dispatchOnSuccess(this,a)},this));this.bindInput()};
McxFancySelectBox.prototype.clearSelection=function(){McxFancySelectBox.superClass_.clearSelection.call(this);this.base._selectBox.select2("destroy");this.base._selectBox.select2()};McxFancySelectBox.prototype.addItem=function(a,b){McxFancySelectBox.superClass_.addItem.call(this,a,b);this.base._selectBox.select2("destroy");this.base._selectBox.select2();this.bindInput()};McxFancySelectBox.prototype.getOnEnterKey=function(){return this._onEnterKeyEventHandler};
McxFancySelectBox.prototype.getText=function(){var a=this.base._selectBox.data("select2").$dropdown.find(".select2-search__field").val();return a?a.toString():""};McxFancySelectBox.prototype.getSelectedItems=function(){var a=[],b=this;this.base._selectBox.find("option:selected").each(function(){var c=$(this).data(b._optionDataKey);mcx.isDefAndNotNull(c)?c.isEmptyItem||a.push(c):(c={},c[b.base._textGetter]=$(this).val(),c[b.base._valueGetter]=$(this).text(),a.push(c))});return a};
McxFancySelectBox.prototype.setSelectedValues=function(a){this.base._selectBox.val(a).trigger("change")};McxFancySelectBox.prototype.getOnUnSelectingEventHandler=function(){return this._eventHandler.unselecting};McxFancySelectBox.prototype.getOnUnSelectEventHandler=function(){return this._eventHandler.unselect};McxFancySelectBox.prototype.getOnOpenEventHandler=function(){return this._eventHandler.open};McxFancySelectBox.prototype.getOnCloseEventHandler=function(){return this._eventHandler.close};
McxFancySelectBox.prototype.getOnSelectingEventHandler=function(){return this._eventHandler.selecting};McxFancySelectBox.prototype.getOnSelectEventHandler=function(){return this._eventHandler.select};McxFancySelectBox.prototype.getOnLoadedEventHandler=function(){return this._eventHandler.loaded};
McxFancySelectBox.prototype.removeItemByValue=function(a){var b=this,c=function(a){b.base._selectBox.find("option").filter(function(){return this.value.toString()==a.toString()}).remove();b.base._selectBox.change()};if($.isArray(a))for(var d in a)c(a[d]);else c(a)};McxFancySelectBox.prototype.addSelectedValue=function(a){this.base._selectBox.find("option").filter(function(){return this.value.toString()==a.toString()}).prop("selected",!0);this.base._selectBox.change()};
McxFancySelectBox.prototype.getFcsboxElement=function(a){return this.base._selectBox.select2(a)};McxFancySelectBox.prototype.deselectAll=function(){this.clearSelection()};js.framework.ui.McxCommonControl.SelectBox.McxSelectBoxEventArgs={};function McxSelectBoxEventArgs(a,b){mcx.base(this);this._selectedItems=a||[];this._selectBox=b}mcx.inherits(McxSelectBoxEventArgs,McxEventArgs);McxSelectBoxEventArgs.prototype.getSelectedItems=function(){return this._selectedItems};McxSelectBoxEventArgs.prototype.getSelectBox=function(){return this._selectBox};js.framework.ui.McxCommonControl.SelectionFilterControl={};js.framework.ui.McxCommonControl.SelectionFilterControl.McxAttributeSelectionFilterControl={};
function McxAttributeSelectionFilterControl(a){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._layerSelectBox=this._layerArray=null;this._control=new McxAttributeQueryGenerator;this._selectionArray=this._selectionSelectBox=null;this._showSelectionBox=a;this._isExport=!1;this._selectionFilter=this._driverFilterCombo=this._mapRadio=this._gridRadio=null}mcx.inherits(McxAttributeSelectionFilterControl,McxUserControl);McxAttributeSelectionFilterControl.prototype.getContent=function(){return this._rootElement};
McxAttributeSelectionFilterControl.prototype.initializeComponent=function(){this.createLayerSelect();this.createSelectionModeSelect();var a=new McxLayoutRow;a.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center);var b=a.createAndAddSpan(4,"McxCommonControl-spatialQueryReferenceLayer");b.getContent().attr("data-localize","McxCommonControl-spatialQueryReferenceLayer");a.createAndAddSpan(8,this._layerSelectBox.getContent());this.base.addChild(this._rootElement,a);this._showSelectionBox&&(a=new McxLayoutRow,
a.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center),b=a.createAndAddSpan(4,"McxCommonControl-spatialQueryTask"),b.getContent().attr("data-localize","McxCommonControl-spatialQueryTask"),a.createAndAddSpan(8,this._selectionSelectBox.getContent()),this.base.addChild(this._rootElement,a));b=new McxLayoutRow;b.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center);this._isExport?(this._driverFilterCombo=new McxSelectBox,this._driverFilterCombo.setTextGetter("text"),this._driverFilterCombo.setValueGetter("value"),
a=new McxLabelControl,a.setText(McxLocalizationManager.getLocaleValue("McxCommonControl-ExportFormatLabel")),a.setLocalizationKey("McxCommonControl-ExportFormatLabel"),b.createAndAddSpan(4,a),b.createAndAddSpan(8,this._driverFilterCombo),this._driverFilterCombo.addItemRange(driverFilterObject)):(this._gridRadio=new McxRadioButton,this._mapRadio=new McxRadioButton,this._gridRadio.setText(McxLocalizationManager.getLocaleValue("McxCommonControl-Grid")),this._mapRadio.setText(McxLocalizationManager.getLocaleValue("McxCommonControl-Map")),
this._gridRadio.setName("selectionResultRadioGroup"),this._mapRadio.setName("selectionResultRadioGroup"),this._mapRadio.checked(!0),this._gridRadio.getContent().find("input").css("outline","none"),this._mapRadio.getContent().find("input").css("outline","none"),a=new McxLabelControl,a.setText(McxLocalizationManager.getLocaleValue("McxCommonControl-ShowSelectResult")),a.setLocalizationKey("McxCommonControl-ShowSelectResult"),b.createAndAddSpan(4,a),b.createAndAddSpan(4,this._gridRadio),b.createAndAddSpan(4,
this._mapRadio),b.getContent().css("margin-bottom","10px"),b.getContent().css("margin-top","10px"));this.base.addChild(this._rootElement,b);b=new McxLayoutRow;b.createAndAddSpan(12,this._control);this.base.addChild(this._rootElement,b);b=this._layerSelectBox.getSelectedItem();this._control.setLayer(b)};
McxAttributeSelectionFilterControl.prototype.createLayerSelect=function(){this._layerSelectBox=new McxSelectBox;this._layerSelectBox.setTextGetter("getAlias");this._layerSelectBox.setValueGetter("getName");for(var a=[],b=0;b<this._layerArray.length;b++)this._layerArray[b].isInstanceOf("IMcxSelectableLayer")&&a.push(this._layerArray[b]);this._layerArray=a;this._layerSelectBox.addItemRange(this._layerArray);this._layerSelectBox.getOnSelectHandler().addListener(this.layerChanged,null,this)};
McxAttributeSelectionFilterControl.prototype.createSelectionModeSelect=function(){this._selectionSelectBox=new McxSelectBox;this._selectionSelectBox.setIsLocalizable(!0);this._selectionSelectBox.setTextGetter("text");this._selectionSelectBox.setValueGetter("value");if(null!=this._selectionArray){for(var a=[],b=0;b<this._selectionArray.length;b++){var c={text:this.getSelectModeLocaleValue(this._selectionArray[b]),value:this._selectionArray[b]};a.push(c)}this._selectionArray=a}else this._selectionArray=
[{text:"McxCommonControl-GeometrySelectionSelectTask",value:"0"},{text:"McxCommonControl-GeometrySelectionAddTask",value:"1"},{text:"McxCommonControl-GeometrySelectionRemoveTask",value:"2"},{text:"McxCommonControl-GeometrySelectionCurrentSelectionTask",value:"3"}];this._selectionSelectBox.addItemRange(this._selectionArray)};
McxAttributeSelectionFilterControl.prototype.getSelectModeLocaleValue=function(a){switch(a){case "1":return"McxCommonControl-GeometrySelectionAddTask";case "0":return"McxCommonControl-GeometrySelectionSelectTask";case "2":return"McxCommonControl-GeometrySelectionRemoveTask";case "3":return"McxCommonControl-GeometrySelectionCurrentSelectionTask"}return""};McxAttributeSelectionFilterControl.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};
McxAttributeSelectionFilterControl.prototype.setLayerArray=function(a){this._layerArray=a};McxAttributeSelectionFilterControl.prototype.setSelectModeArray=function(a){this._selectionArray=a};McxAttributeSelectionFilterControl.prototype.getLayer=function(){return this._layerSelectBox.getSelectedItem()};
McxAttributeSelectionFilterControl.prototype.getLayerFilter=function(){var a=this._layerSelectBox.getSelectedItem(),b=new McxRequestFilter;b.setAttributeFilter(this._control.getSql());this._selectionFilter=new McxLayerRequestFilter;this._selectionFilter.setLayer(a);this._selectionFilter.setFilter(b);return this._selectionFilter};McxAttributeSelectionFilterControl.prototype.layerChanged=function(){var a=this._layerSelectBox.getSelectedItem();this._control.setLayer(a)};
McxAttributeSelectionFilterControl.prototype.getSelectionMode=function(){return this._selectionSelectBox.getSelectedItem().value};McxAttributeSelectionFilterControl.prototype.getExportMapFiltersComboValue=function(){return null!=this._driverFilterCombo?this._driverFilterCombo.getSelectedItem().value:null};McxAttributeSelectionFilterControl.prototype.setIsExport=function(a){this._isExport=a};
McxAttributeSelectionFilterControl.prototype.showResultOnMap=function(){return null!=this._mapRadio?this._mapRadio.isChecked():!1};McxAttributeSelectionFilterControl.prototype.showResultOnGrid=function(){return null!=this._gridRadio?this._gridRadio.isChecked():!1};McxAttributeSelectionFilterControl.prototype.getSelectedRadioButton=function(){return null!=this._mapRadio&&this._mapRadio.isChecked()?this._mapRadio:null!=this._gridRadio&&this._gridRadio.isChecked()?this._gridRadio:null};
McxAttributeSelectionFilterControl.prototype.getSql=function(){return this._control.getSql()};js.framework.ui.McxCommonControl.SelectionFilterControl.McxDriverFilterObject={};
var driverFilterObject=[{text:"MapCodeX GIS (*.mdb)",value:"464f8c4e-bcd9-491c-b52e-82a5ac6d63e5"},{text:"ESRI Shape Files (*.shp)",value:"26c9c3d8-5d06-460c-8694-e2ca4664bba6"},{text:"MapInfo Files (*.tab;*.mif)",value:"43fb9256-66ca-a0f1-5c49-7820883b4099"},{text:"MicroStation DGN Files (*.dgn)",value:"82b7ee38-55b2-58c5-745d-509281a15740"},{text:"GML Files (*.xml)",value:"396d77d6-aef0-30af-f431-862cc87c3770"},{text:"KML Files (*.kml)",value:"b043387f-0ad8-278e-8676-7db2322ac389"},{text:"GeoJSON Files (*.geojson)",
value:"e390b2c0-9ec0-51d1-8b93-dfda9cd29407"},{text:"AutoCAD DWG (*.dwg) (*.dxf)",value:"7afae75f-f54c-4be3-ac37-17460d08fa69"},{text:"GML2, GML31, GML32 (*.xml)(*.gml)",value:"396d77d6-aef0-30af-f431-862cc87c3770"}];js.framework.ui.McxCommonControl.SelectionFilterControl.McxGeometrySelectionFilterControl={};
function McxGeometrySelectionFilterControl(a){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._selectionSelectBox=this._selectedFeatureCheck=this._selectedFeatureCount=this._relationSelectBox=this._targetLayerList=this._sourceLayerSelectBox=this._selectionArray=this._relationArray=this._selectedLayerArray=this._targetLayerArray=this._sourceLayerArray=null;this._layer=[];this._componentChangedEventHandler=new McxEventHandler;this._showSelectionBox=a;this._layerFilterArray=[]}
mcx.inherits(McxGeometrySelectionFilterControl,McxUserControl);McxGeometrySelectionFilterControl.prototype.getContent=function(){return this._rootElement};
McxGeometrySelectionFilterControl.prototype.initializeComponent=function(){this.createSourceLayerSelect();this.createTargetLayerList();this.createRelationSelect();this.createSelectionModeSelect();var a=new McxLayoutRow,b=new McxLabeledEditor("McxCommonControl-spatialQueryReferenceLayer",this._sourceLayerSelectBox);b.setLabelLocalizationKey("McxCommonControl-spatialQueryReferenceLayer");b.setLabelSpanLength(5);a.createAndAddSpan(12,b);this._rootElement.append(a.getContent());b=new McxLayoutRow;b.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center);
this._selectedFeatureCheck=new McxCheckBox;this._selectedFeatureCheck.setText("McxCommonControl-useSelectedFeatures");this._selectedFeatureCheck.setEnabled(!1);this._selectedFeatureCheck.checked(!0);a=new McxLabelControl;a.setText("Use Selected Items");a.setLocalizationKey("McxCommonControl-useSelectedFeatures");b.createAndAddSpan(5,a);a=new McxLayoutSpan(7);this._selectedFeatureCount=new McxLabelControl;this._selectedFeatureCount.setText("0");this._selectedFeatureCount.getContent().css("float","left").css("margin-right",
"3px");a.addContent(this._selectedFeatureCount.getContent());var c=new McxLabelControl;c.setText("McxCommonControl-featureSelected");c.setLocalizationKey("McxCommonControl-featureSelected");a.addContent(c);b.addSpan(a);this._rootElement.append(b.getContent());a=new McxLayoutRow;b=new McxLabeledEditor("McxCommonControl-spatialQueryOperator",this._relationSelectBox);b.setLabelLocalizationKey("McxCommonControl-spatialQueryOperator");b.setLabelSpanLength(5);a.createAndAddSpan(12,b);this._rootElement.append(a.getContent());
a=new McxLayoutRow;b=new McxLabeledEditor("McxCommonControl-spatialQueryDestinationLayer",this._targetLayerList);b.setLabelLocalizationKey("McxCommonControl-spatialQueryDestinationLayer");b.setLabelSpanLength(5);a.createAndAddSpan(12,b);this._rootElement.append(a.getContent());this._showSelectionBox&&(a=new McxLayoutRow,b=new McxLabeledEditor("McxCommonControl-spatialQueryTask",this._selectionSelectBox),b.setLabelLocalizationKey("McxCommonControl-spatialQueryTask"),b.setLabelSpanLength(5),a.createAndAddSpan(12,
b),this._rootElement.append(a.getContent()));this.referenceLayerChanged()};
McxGeometrySelectionFilterControl.prototype.createSourceLayerSelect=function(){this._sourceLayerSelectBox=new McxSelectBox;this._sourceLayerSelectBox.setTextGetter("getAlias");this._sourceLayerSelectBox.setValueGetter("getName");for(var a=[],b=0;b<this._sourceLayerArray.length;b++)a.push(this._sourceLayerArray[b]),this._sourceLayerArray[b].getAddSelectionEventHandler().addListener(this.referenceLayerChanged,null,this),this._sourceLayerArray[b].getRemoveSelectionEventHandler().addListener(this.referenceLayerChanged,null,
this);this._sourceLayerArray=a;this._sourceLayerSelectBox.addItemRange(this._sourceLayerArray);this._sourceLayerSelectBox.getOnSelectHandler().addListener(this.referenceLayerChanged,null,this)};
McxGeometrySelectionFilterControl.prototype.createTargetLayerList=function(){for(var a=[],b=0;b<this._targetLayerArray.length;b++)this._targetLayerArray[b].isInstanceOf("IMcxSelectableLayer")&&a.push(this._targetLayerArray[b]);this._targetLayerArray=a;this._targetLayerList=new McxLayerListUserControl(this._targetLayerArray);this._targetLayerList.getSelectionChangeEventHandler().addListener(this.targetLayerSelectionChanged,null,this)};
McxGeometrySelectionFilterControl.prototype.createRelationSelect=function(){this._relationSelectBox=new McxSelectBox;this._relationSelectBox.setTextGetter("text");this._relationSelectBox.setValueGetter("value");this._relationSelectBox.setIsLocalizable(!0);if(null!=this._relationArray){for(var a=[],b=0;b<this._relationArray.length;b++){var c={text:this.getRelationLocaleValue(this._relationArray[b]),value:this._relationArray[b]};a.push(c)}this._relationArray=a}else this._relationArray=[{text:"McxCommonControl-GeometrySelectionIntersectOpertator",
value:McxSpatialRelation.Intersects},{text:"McxCommonControl-GeometrySelectionContainsOpertator",value:McxSpatialRelation.Contains},{text:"McxCommonControl-GeometrySelectionOverlapsOpertator",value:McxSpatialRelation.Overlaps},{text:"McxCommonControl-GeometrySelectionWithinOpertator",value:McxSpatialRelation.Within},{text:"McxCommonControl-GeometrySelectionTouchesOpertator",value:McxSpatialRelation.Touches},{text:"McxCommonControl-GeometrySelectionCrossesOpertator",value:McxSpatialRelation.Crosses},
{text:"McxCommonControl-GeometrySelectionDisjointOpertator",value:McxSpatialRelation.Disjoint}];this._relationSelectBox.addItemRange(this._relationArray)};
McxGeometrySelectionFilterControl.prototype.createSelectionModeSelect=function(){this._selectionSelectBox=new McxSelectBox;this._selectionSelectBox.setTextGetter("text");this._selectionSelectBox.setValueGetter("value");this._selectionSelectBox.setIsLocalizable(!0);if(null!=this._selectionArray){for(var a=[],b=0;b<this._selectionArray.length;b++){var c={text:this.getSelectModeLocaleValue(this._selectionArray[b]),value:this._selectionArray[b]};a.push(c)}this._selectionArray=a}else this._selectionArray=
[{text:"McxCommonControl-GeometrySelectionSelectTask",value:"0"},{text:"McxCommonControl-GeometrySelectionAddTask",value:"1"},{text:"McxCommonControl-GeometrySelectionRemoveTask",value:"2"},{text:"McxCommonControl-GeometrySelectionCurrentSelectionTask",value:"3"}];this._selectionSelectBox.addItemRange(this._selectionArray)};
McxGeometrySelectionFilterControl.prototype.getSelectModeLocaleValue=function(a){switch(a){case "1":return"McxCommonControl-GeometrySelectionAddTask";case "0":return"McxCommonControl-GeometrySelectionSelectTask";case "2":return"McxCommonControl-GeometrySelectionRemoveTask";case "3":return"McxCommonControl-GeometrySelectionCurrentSelectionTask"}return""};
McxGeometrySelectionFilterControl.prototype.getRelationLocaleValue=function(a){switch(a){case McxSpatialRelation.Intersects:return"McxCommonControl-GeometrySelectionIntersectOpertator";case McxSpatialRelation.Contains:return"McxCommonControl-GeometrySelectionContainsOpertator";case McxSpatialRelation.Overlaps:return"McxCommonControl-GeometrySelectionOverlapsOpertator";case McxSpatialRelation.Within:return"McxCommonControl-GeometrySelectionWithinOpertator";case McxSpatialRelation.Touches:return"McxCommonControl-GeometrySelectionTouchesOpertator";
case McxSpatialRelation.Crosses:return"McxCommonControl-GeometrySelectionCrossesOpertator";case McxSpatialRelation.Disjoint:return"McxCommonControl-GeometrySelectionDisjointOpertator"}return""};
McxGeometrySelectionFilterControl.prototype.getLayer=function(){this._layer=[];var a=new McxFilter,b=this._sourceLayerSelectBox.getSelectedItem(),c=b.getSelection();if(0==b.getSelectionCount())return McxMessageBox.show(null,this.base.getLocaleValue("McxCommonControl-selectedFeatureNotFoundError"),McxMessageBoxType.Error),null;for(;c.read();)b=c.getCurrent().getGeometry(),a.setGeometry(b);c=this._relationSelectBox.getSelectedItem().value;a.setSpatialRelation(c);c=this._targetLayerList.getSelectedLayers();
if(0==c.length)return McxMessageBox.show(null,this.base.getLocaleValue("McxCommonControl-targetLayerNotFound"),McxMessageBoxType.Error),null;for(b=0;b<c.length;b++)c[b].getFilterCollection().addFilter(a),this._layer.push(c[b]);return this._layer};McxGeometrySelectionFilterControl.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};McxGeometrySelectionFilterControl.prototype.setSourceLayerArray=function(a){this._sourceLayerArray=a};
McxGeometrySelectionFilterControl.prototype.setSpatialRelationArray=function(a){this._relationArray=a};McxGeometrySelectionFilterControl.prototype.setTargetLayerArray=function(a){this._targetLayerArray=a};McxGeometrySelectionFilterControl.prototype.setSelectModeArray=function(a){this._selectionArray=a};
McxGeometrySelectionFilterControl.prototype.targetLayerSelectionChanged=function(){this._selectedLayerArray=this._targetLayerList.getSelectedLayers();this._componentChangedEventHandler.dispatchOnSuccess(this,null)};McxGeometrySelectionFilterControl.prototype.getComponentChangedHandler=function(){return this._componentChangedEventHandler};McxGeometrySelectionFilterControl.prototype.getSelectedLayers=function(){return this._selectedLayerArray};
McxGeometrySelectionFilterControl.prototype.getSelectionMode=function(){return this._selectionSelectBox.getSelectedItem().value};McxGeometrySelectionFilterControl.prototype.updateSelectedFeatureCount=function(a){this._selectedFeatureCheck.setText(a.toString())};
McxGeometrySelectionFilterControl.prototype.referenceLayerChanged=function(){if(mcx.isDefAndNotNull(this._sourceLayerSelectBox.getSelectedItem())){var a=this._sourceLayerSelectBox.getSelectedItem();mcx.isDefAndNotNull(this._selectedFeatureCount)&&this._selectedFeatureCount.setText(a.getSelectionCount().toString())}};
McxGeometrySelectionFilterControl.prototype.getLayerFilter=function(){this._layerFilterArray=[];var a=new McxRequestFilter,b=this._sourceLayerSelectBox.getSelectedItem(),c=b.getSelection();if(0==b.getSelectionCount())return McxMessageBox.show(null,this.base.getLocaleValue("McxCommonControl-selectedFeatureNotFoundError"),McxMessageBoxType.Error),null;for(;c.read();)b=c.getCurrent().getGeometry(),a.addGeometry(b);c=this._relationSelectBox.getSelectedItem().value;a.setSpatialRelation(c);c=this._targetLayerList.getSelectedLayers();
if(0==c.length)return McxMessageBox.show(null,this.base.getLocaleValue("McxCommonControl-targetLayerNotFound"),McxMessageBoxType.Error),null;for(b=0;b<c.length;b++){var d=new McxLayerRequestFilter;d.setLayer(c[b]);d.setFilter(a);this._layerFilterArray.push(d)}return this._layerFilterArray};js.framework.ui.McxCommonControl.Splitter={};js.framework.ui.McxCommonControl.Splitter.McxSplitter={};function McxSplitter(a){mcx.base(this);this._rootElement=$("<div/>").addClass("mcx-splitter").addClass("mcx-stripped");this._splitterType=a||McxSplitterType.horizontal;this.base=this;this.initialize()}mcx.inherits(McxSplitter,McxUserControl);
McxSplitter.prototype.initialize=function(){var a=this;this._splitterType==McxSplitterType.horizontal?this._rootElement.addClass("type-horizontal"):this._rootElement.addClass("type-vertical");this._rootElement.mousedown(function(b){McxSplitter.__splitterStartX=b.pageX||b.clientX||b.screenX;McxSplitter.__splitterStartY=b.pageY||b.clientY||b.screenY;McxSplitter.__splitterPrevTarget=$(this).prev();McxSplitter.__splitterNextTarget=$(this).next();McxSplitter.__splitType=a._splitterType;McxSplitter.__isSplitting=
!0})};McxSplitter.prototype.getContent=function(){return this._rootElement};
McxSplitter.initialize=function(){McxSplitter.__splitterStartX=NaN;McxSplitter.__splitterStartY=NaN;McxSplitter.__splitterPrevTarget=null;McxSplitter.__splitterNextTarget=null;McxSplitter.__splitType=null;McxSplitter.__isSplitting=!1;$(document).ready(function(){$(document).mousemove(function(a){if(McxSplitter.__isSplitting){var b=a.pageX||a.clientX||a.screenX;a=a.pageY||a.clientY||a.screenY;var c=a-McxSplitter.__splitterStartY;if(McxSplitter.__splitType==McxSplitterType.horizontal){var d=McxSplitter.__splitterPrevTarget.css("overflow",
"auto").height()+c;(0<c&&McxSplitter.__splitterPrevTarget.get(0).scrollHeight>McxSplitter.__splitterPrevTarget.height()||0>c)&&McxSplitter.__splitterPrevTarget.height(d);McxSplitter.__splitterPrevTarget.get(0).scrollHeight==McxSplitter.__splitterPrevTarget.height()&&McxSplitter.__splitterPrevTarget.height("auto")}McxSplitter.__splitterStartX=b;McxSplitter.__splitterStartY=a}});$(document).mouseup(function(){McxSplitter.__isSplitting=!1})})};McxSplitter.initialize();js.framework.ui.McxCommonControl.Splitter.McxSplitterType={};var McxSplitterType={vertical:1,horizontal:2};js.framework.ui.McxCommonControl.StrokeEditor={};js.framework.ui.McxCommonControl.StrokeEditor.McxStrokeEditor={};function McxStrokeEditor(){mcx.base(this);this.base=this;this._widthSelector=this._stroke=this._colorSelector=this._rootElement=null;this._onStrokeChangeHandler=new McxEventHandler;this.initialize()}mcx.inherits(McxStrokeEditor,McxUserControl);
McxStrokeEditor.prototype.initialize=function(){this._rootElement=$("<div/>");this._colorSelector=new McxColorPicker;this._widthSelector=new McxNumberSpinner(0,100,!0,1);var a=new McxLabeledEditor("Color",this._colorSelector),b=new McxLabeledEditor("Width",this._widthSelector);a.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesColor");b.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesWidth");b.getContent().css("margin-bottom","0");this.base.addChild(this._rootElement,a);this.base.addChild(this._rootElement,
b);this._colorSelector.getOnChangeHandler().addListener(function(){this.getOnStrokeChangeHandler().dispatchOnSuccess(this,null)},null,this);this._widthSelector.getOnChangeHandler().addListener(function(){this.getOnStrokeChangeHandler().dispatchOnSuccess(this,null)},null,this)};McxStrokeEditor.prototype.applyStroke=function(){this.getStroke().setWidth(this._widthSelector.getValue());this.getStroke().setColor(this._colorSelector.getColor());this.getStroke().setOpacity(this._colorSelector.getOpacity())};
McxStrokeEditor.prototype.setStroke=function(a){this._stroke=a;this._colorSelector.setOpacity(this.getStroke().getOpacity());this._colorSelector.setColor(this.getStroke().getColor());this._widthSelector.setValue(this.getStroke().getWidth())};McxStrokeEditor.prototype.getOnStrokeChangeHandler=function(){return this._onStrokeChangeHandler};McxStrokeEditor.prototype.getStroke=function(){return this._stroke=this._stroke||new McxStroke};McxStrokeEditor.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.SubtypeColoringEditor={};js.framework.ui.McxCommonControl.SubtypeColoringEditor.McxSubtypeColoringEditor={};function McxSubtypeColoringEditor(){mcx.base(this);this.base=this;this._rootElement=null;this._gridItemSelectHandler=new McxEventHandler;this._gridItemBeforeSelectHandler=new McxEventHandler;this._selectedColoringItems=null;this._classifyGrid=new McxDataGrid;this._coloringRow=this._selectedGridItem=this._coloringItemRange=null;this.initialize()}
mcx.inherits(McxSubtypeColoringEditor,McxUserControl);
McxSubtypeColoringEditor.prototype.initialize=function(){this._rootElement=$("<div/>");var a=new McxLayoutRow;this._classifyGrid.clear();this._classifyGrid.setIsEditable(!0);a.createAndAddSpan(12,this._classifyGrid);this._classifyGrid.addColumn((new McxStringColumn("Value","McxCommonControl-valueLabel")).bindProperty("getValue","setValue").setIsEditable(!1).setCustomTextGetter(function(a){return a.getText()||a.getValue()}));this._classifyGrid.fitColumns();this._classifyGrid.setHeight(300);this._classifyGrid.addColumn((new McxButtonColumn("D\u00fczenle",
"McxCommonControl-LayerPropertiesEditStyle")).setButtonText("...").addListener(this.onClassifyGridClick,this));this._classifyGrid.addColumn((new McxComboBoxColumn("Min Scale","McxCommonControl-LayerPropertiesMinScale")).setComboBoxParams(this.getDefaultRanges(),"value","text").setIsEditable(!0).bindProperty("getMinScale","setMinScale").setCustomTextGetter(function(a){return a.getMinScale()}));this._classifyGrid.addColumn((new McxComboBoxColumn("Max Scale","McxCommonControl-LayerPropertiesMaxScale")).setComboBoxParams(this.getDefaultRanges(),
"value","text").setIsEditable(!0).bindProperty("getMaxScale","setMaxScale").setCustomTextGetter(function(a){return a.getMaxScale()}));this._classifyGrid.addColumn((new McxButtonColumn("Kald\u0131r","McxCommonControl-LayerPropertiesRemove")).setButtonText(" ---- ").addListener(this.classifyGridRemoveClick,this));this.base.addChild(this._rootElement,a);this._classifyGrid.getRowChangeHandler().addListener(this.afterClassifyGridEdit,null,this);this.setColoringItemsToClassifyGrid([])};
McxSubtypeColoringEditor.prototype.getDefaultRanges=function(){return[{value:1E7,text:"1:10000000"},{value:1E6,text:"1:1000000"},{value:1E5,text:"1:100000"},{value:5E4,text:"1:50000"},{value:25E3,text:"1:25000"},{value:1E4,text:"1:10000"},{value:5E3,text:"1:5000"},{value:1E3,text:"1:1000"}]};
McxSubtypeColoringEditor.prototype.classifyGridRemoveClick=function(a){var b=a.getRow().getItem();a=this._selectedColoringItems.filter(function(a){return b.getText()==a.getText()&&b.getValue()==a.getValue()});for(var c=0;c<a.length;c++){var d=this._selectedColoringItems.indexOf(a[c]);this._selectedColoringItems.splice(d,1)}this.setColoringItemsToClassifyGrid(this._selectedColoringItems)};McxSubtypeColoringEditor.prototype.setColoringItemRange=function(a){this._coloringItemRange=a};
McxSubtypeColoringEditor.prototype.setColoringItemsToClassifyGrid=function(a){this._classifyGrid.clear();a=a||this._selectedColoringItems||[];var b=[];this._selectedColoringItems=a;a.forEach(function(a,c){a.getText()||a.getValue()||(b[b.length]=c)});for(var c=0;c<b.length;c++)a.splice(b[c],1);c=new McxSubtypeColoringItem("","",NaN,NaN);c.setSymbolizer(new McxCompositeSymbolizer);c.setLabelSymbolizer(new McxTextSymbolizer);a[a.length]=c;this._classifyGrid.addDataRange(a);a=this._classifyGrid.getRows();
a[a.length-1].getDataCells()[0].setIsEditable(!0)};McxSubtypeColoringEditor.prototype.setSelectedColoringItems=function(a){this._selectedColoringItems=a};McxSubtypeColoringEditor.prototype.getSelectedSubtypeColoringItems=function(){return this._selectedColoringItems};
McxSubtypeColoringEditor.prototype.onClassifyGridClick=function(a){mcx.isDefAndNotNull(this._selectedGridItem)&&this.getBeforeSelectedItemChangeHandler().dispatchOnSuccess(this,null);this._selectedGridItem=a.getRow().getItem();this.getGridItemSelectHandler().dispatchOnSuccess(this,null)};McxSubtypeColoringEditor.prototype.afterClassifyGridEdit=function(){this._selectedColoringItems=this._classifyGrid.getData();this.setColoringItemsToClassifyGrid()};
McxSubtypeColoringEditor.prototype.getSelectedGridItem=function(){return this._selectedGridItem};McxSubtypeColoringEditor.prototype.getGridItemSelectHandler=function(){return this._gridItemSelectHandler};McxSubtypeColoringEditor.prototype.getBeforeSelectedItemChangeHandler=function(){return this._gridItemBeforeSelectHandler};McxSubtypeColoringEditor.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.SubtypeEngine={};js.framework.ui.McxCommonControl.SubtypeEngine.IMcxThematicStyleEditor={};function IMcxThematicStyleEditor(){}IMcxThematicStyleEditor.prototype.getName=function(){};IMcxThematicStyleEditor.prototype.setLayers=function(a){};IMcxThematicStyleEditor.prototype.getContent=function(){};IMcxThematicStyleEditor.prototype.applyStyle=function(){};IMcxThematicStyleEditor.prototype.updateLayout=function(){};IMcxThematicStyleEditor.prototype.initialize=function(){};
IMcxThematicStyleEditor.prototype.getActiveLayer=function(){};js.framework.ui.McxCommonControl.SubtypeEngine.McxCodedDomainThematicStyleEditor={};
function McxCodedDomainThematicStyleEditor(){mcx.base(this);this.base=this;this._selectedLayer=this._selectedSubtypeField=this._layers=null;this._isInitialized=!1;this._selectedField="";this._rootElement=$("<div/>");this._layerFieldSelector=new McxLayerFieldSelector(!0);this._gradientSelectBox=new McxGradientSelectBox;this._classifyDialog=new McxFeatureClassifyDialog;this._selectedGradient=null;this._symbolizerDialog=new McxSymbolizerEditorDialog;this._subtypeColoringEditor=null}
mcx.inherits(McxCodedDomainThematicStyleEditor,McxUserControl);
McxCodedDomainThematicStyleEditor.prototype.initialize=function(){if(!this._isInitialized){this._classifyDialog.getSubmitHandler().addListener(this.setItemsClassifyGrid,null,this);var a=new McxAccordionContentDisplayer("Data");a.setButtonLocalizationKey("McxCommonControl-mcxLayerPropertiesData");this.base.addChild(this._rootElement,a);a.showContent();a.hideButtons();a.setIsFloating(!1);this.createDataGroup(a);a=new McxAccordionContentDisplayer("Coloring");a.setButtonLocalizationKey("McxCommonControl-mcxLayerPropertiesColoring");
this.base.addChild(this._rootElement,a);a.showContent();a.hideButtons();a.setIsFloating(!1);this.base.addChild(this._rootElement,a);this.createColoringGroup(a);this._layerFieldSelector.getFieldChangeHandler().addListener(this.onFieldChange,null,this);this._isInitialized=!0}};
McxCodedDomainThematicStyleEditor.prototype.onFieldChange=function(){this._selectedLayer=this._layerFieldSelector.getLayer();this._selectedSubtypeField=this._layerFieldSelector.getField();this._subtypeColoringEditor.setColoringItemsToClassifyGrid([]);this._subtypeColoringEditor.setSelectedColoringItems([])};
McxCodedDomainThematicStyleEditor.prototype.setItemsClassifyGrid=function(){var a=this._classifyDialog.getClassifyView().getSelectedColoringItems();this._classifyDialog.getClassifyView().setSelectedColoringItems(a);this._classifyDialog.getClassifyView().applyGradient();a=this._classifyDialog.getClassifyView().getSelectedColoringItems();this._subtypeColoringEditor.setColoringItemsToClassifyGrid(a)};McxCodedDomainThematicStyleEditor.prototype.setLayers=function(a){this._layers=a;this._layerFieldSelector.setLayers(a)};
McxCodedDomainThematicStyleEditor.prototype.setSelectedLayer=function(a){this._layerFieldSelector.setSelectedLayer(a);mcx.isDefAndNotNull(a.getSubtypeType().getSubtypeField())&&this._layerFieldSelector.setSelectedFieldByName(a.getSubtypeType().getSubtypeField());this.initColoringItems()};
McxCodedDomainThematicStyleEditor.prototype.initColoringItems=function(){for(var a=this.base._layerFieldSelector.getLayer(),b=[],c=0;c<a.getSubtypes().getCount();c++){var d=new McxSubtypeColoringItem("",a.getSubtypes().getAt(c).getScript(),NaN,NaN),e=a.getSubtypes().getAt(c).getScript().getScript().split("==")[1].replace(/'/g,"").trim();d.setText(e);d.setValue(e);d.setSymbolizer(a.getSubtypes().getAt(c).getSymbolizer());b.push(d)}this._subtypeColoringEditor.setColoringItemsToClassifyGrid(b)};
McxCodedDomainThematicStyleEditor.prototype.getName=function(){return"McxCommonControl-CodedDomain"};McxCodedDomainThematicStyleEditor.prototype.getContent=function(){return this._rootElement};McxCodedDomainThematicStyleEditor.prototype.filterField=function(a){return""==a.getDomainName()||null==a.getDomainName()||void 0==a.getDomainName()?!1:!0};
McxCodedDomainThematicStyleEditor.prototype.createDataGroup=function(a){this._layerFieldSelector.setFieldFilter(this.filterField);var b=new McxLayoutRow;b.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center);b.createAndAddSpan(9,this.base._layerFieldSelector);var c=new McxButton;c.setText("Classify");c.setLocalizationKey("McxCommonControl-LayerPropertiesClassify");c.setButtonState(McxButtonState.active);c.setIsFullWidth(!0);c.getClickHandler().addListener(this.onClassifyButtonClick,null,this);
b.createAndAddSpan(3,c);a.addContent(b);b=McxPredefinedGradients.getGradients();for(c=0;c<b.length;c++)this._gradientSelectBox.addGradient(McxGradient.fromJSON(b[c]));this._gradientSelectBox.setIsReversible(!0);this._gradientSelectBox.getOnChangeHandler().addListener(function(){this._selectedGradient=this._gradientSelectBox.getSelectedGradient();this._classifyDialog.getClassifyView().setGradient(this._selectedGradient)},null,this);c=new McxLabeledEditor("Gradient",this._gradientSelectBox);c.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesGradient");
c.getContent().css("margin-left","0");b=new McxLayoutRow;b.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.top);b.createAndAddSpan(9,c);b.getContent().css("margin-left","0");c=new McxButton;c.setText("Classify All");c.setLocalizationKey("McxCommonControl-LayerPropertiesClassifyAll");c.setButtonState(McxButtonState.active);c.setIsFullWidth(!0);c.getContent().css("margin-top","5px");c.getClickHandler().addListener(this.onClassifyAllButtonClick,null,this);b.createAndAddSpan(3,c);a.addContent(b)};
McxCodedDomainThematicStyleEditor.prototype.createColoringGroup=function(a){this._subtypeColoringEditor=new McxSubtypeColoringEditor;a.addContent(this._subtypeColoringEditor);this._subtypeColoringEditor.getGridItemSelectHandler().addListener(function(){var a=this._subtypeColoringEditor.getSelectedGridItem();a?(this._symbolizerDialog.getEditor().setIsEnabled(!0),this._symbolizerDialog.getEditor().setSymbolizer(a.getSymbolizer()),this._symbolizerDialog.getEditor().setLabelSymbolizer(a.getLabelSymbolizer()),
this._symbolizerDialog.showDialog(!0,!1)):this._symbolizerDialog.getEditor().setIsEnabled(!1)},null,this)};
McxCodedDomainThematicStyleEditor.prototype.onClassifyButtonClick=function(){this._classifyDialog.getClassifyView().setColoringItemRange([]);this._classifyDialog.showDialog(!0,!1);var a=new McxAjaxParameter;a.setParameters(this,function(a){a=a.getArgs();this._classifyDialog.getClassifyView().setColoringItemRange(a);McxLoadingIndicator.setAsIdle(this._classifyDialog.getContent())},function(){McxLoadingIndicator.setAsIdle(this._classifyDialog.getContent())});McxLoadingIndicator.setAsBusy(this._classifyDialog.getContent());
this.updateColoringEditor(a)};
McxCodedDomainThematicStyleEditor.prototype.onClassifyAllButtonClick=function(){var a=new McxAjaxParameter;a.setParameters(this,function(a){a=a.getArgs();this._classifyDialog.getClassifyView().setColoringItemRange(a);this._classifyDialog.getClassifyView().setSelectedColoringItems(a);this._classifyDialog.getClassifyView().applyGradient();this._subtypeColoringEditor.setColoringItemsToClassifyGrid(a);McxLoadingIndicator.setAsIdle(this._subtypeColoringEditor.getContent())},function(){McxLoadingIndicator.setAsIdle(this._subtypeColoringEditor.getContent())});
McxLoadingIndicator.setAsBusy(this._subtypeColoringEditor.getContent());this.updateColoringEditor(a)};
McxCodedDomainThematicStyleEditor.prototype.updateColoringEditor=function(a){function b(b){g=[];var c=b.getFeatureReader();if(c){for(;c.read();){var d=c.getCurrent(),f=d.getField(b.getArgs().toString()),h=k.getCodedValues().filter(function(a){return a.getCode()==d.getValue(f.getFieldName())});if(h.length){h=h[0];h=new McxSubtypeColoringItem(h.getValue(),h,NaN,NaN);if(e.isInstanceOf("McxFsLayer")){var t=e.getSymbolizer().clone();h.setSymbolizer(t)}else h.setSymbolizer(new McxCompositeSymbolizer);g.push(h)}}a.getAsync()&&
a.getSuccess().call(a.getScope(),new McxEventArgs(g))}}function c(){a.getAsync()&&a.getError().call(a.getScope(),null)}console.log("here");var d=this._layerFieldSelector.getLayer(),e=d,f=this._layerFieldSelector.getField();if(0==mcx.isDefAndNotNull(e)||0==mcx.isDefAndNotNull(f))a.getError().call(a.getScope(),null);else{this._symbolizerDialog.getEditor().setGeometryType(d.getGeometryType());var g=[],h=new McxAjaxParameter;h.setAsync(!1);var k=d.getDataSource().getDomain(f.getDomainName(),h).getDomain();
0==mcx.isDefAndNotNull(k)?(this._subtypeColoringEditor.setColoringItemsToClassifyGrid([]),a.getError().call(a.getScope(),null)):(f=f.getFieldName(),h=new McxAjaxParameter,h.setParameters(this,b,c),h.setArgs(f),d.query(f,"1=1 group by "+f+" order by "+f,h))}};
McxCodedDomainThematicStyleEditor.prototype.applyStyle=function(){var a=this._subtypeColoringEditor.getSelectedSubtypeColoringItems(),b=this._layerFieldSelector.getLayer();if(b&&b.isInstanceOf("IMcxLayer")){var c=b.getSubtypes();if(c&&(c.clear(),mcx.isDefAndNotNull(a)&&0!=a.length)){for(var d=0;d<a.length;d++){var e=a[d],f=e.getValue();if(null!=f&&""!=f){var g=String.format("[{0}]=={1}",this._layerFieldSelector.getField().getFieldName(),f.getCode()),g=new McxScript(g),g=new McxSubtype(g);g.setLabelSymbolizer(e.getLabelSymbolizer());
g.setSymbolizer(e.getSymbolizer());f&&(g.setValue(f.getCode()),g.setVisibility(!0),c.add(g))}}b.setSubtypeType(new McxDefinedSubtypeObject(McxSubtypeType.CodedValueSubtype,this._selectedSubtypeField.getFieldName()));a=this._layerFieldSelector.getField();mcx.isDefAndNotNull(a)&&(this._selectedSubtypeField=a)}}};
McxCodedDomainThematicStyleEditor.prototype.updateLayout=function(){this._rootElement.find("div.mcxpanel:visible,div.mcxaccordion:visible,div.mcxlayout:visible,div.mcxtabs-container:visible").trigger("_resize",[!0])};McxCodedDomainThematicStyleEditor.prototype.getActiveLayer=function(){return this._layerFieldSelector.getLayer()};js.framework.ui.McxCommonControl.SubtypeEngine.McxFeatureClassifyDialog={};function McxFeatureClassifyDialog(){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._classifyView=new McxFeatureClassifyView}mcx.inherits(McxFeatureClassifyDialog,McxDialogBase);
McxFeatureClassifyDialog.prototype.initialize=function(){var a=new McxPanel;a.addControl(this._classifyView);a.getContent().css("margin-bottom","10px");a.getContent().css("height","455px");this.base.addChild(this._rootElement,a);this.base.onCloseDialog().addListener(function(){$(".mcx-content-overlay").remove()},null,this)};McxFeatureClassifyDialog.prototype.getClassifyView=function(){return this._classifyView};McxFeatureClassifyDialog.prototype.getDialogSize=function(){return McxDialogSize.small};
McxFeatureClassifyDialog.prototype.getContent=function(){return this._rootElement};
McxFeatureClassifyDialog.prototype.createDialogElem=function(){var a=$("<div/>").addClass("mcx-mini-dialog-header").addClass("mcx-drag-handle"),b=$("<div/>").addClass("mcx-mini-dialog-header-tool-container");this.base._dialogBody.addClass("mcx-mini-dialog");this.base._dialogFooter.addClass("mcx-mini-dialog");this.base._dialogCancelButton.setText("Cancel");this.base._dialogCancelButton.setLocalizationKey("mcxDialogCancel");this.base._dialogOkButton.setText("Ok");this.base._dialogOkButton.setLocalizationKey("mcxDialogOk");
this.base._dialogElem.append(a).append(this.base._dialogBody).append(this.base._dialogFooter).append(this.base._dialogResizeHandleLeft).append(this.base._dialogResizeHandleRight).append(this.base._dialogResizeHandleBottom);a.append(b);this.base.createToolButtons(b);this.base._dialogFooter.hide(0)};
McxFeatureClassifyDialog.prototype.centralizeDialog=function(){this.base._dialogElem.offset({top:($("#layerManagerContainer").height()-this.base._dialogElem.height())/2,left:($("#layerManagerContainer").width()-this.base._dialogElem.width())/2});this.repositionIfDialogOverlows()};
McxFeatureClassifyDialog.prototype.repositionIfDialogOverlows=function(){var a=this.base._dialogElem.offset(),b=$("#layerManagerContainer").height(),c=$("#layerManagerContainer").width(),d=this.base._dialogElem.height(),e=this.base._dialogElem.width();a.top+d>b&&(a.top=b-d);a.left+e>c&&(a.left=c-e);0>a.top&&(a.top=0);0>a.left&&(a.left=0);this.base._dialogElem.offset(a)};
McxFeatureClassifyDialog.prototype.showDialog=function(a,b){a?this.base._dialogElem.addClass("state-modal"):this.base._dialogElem.removeClass("state-modal");b&&this.base.enableResize();if(this.base.getIsSingleInstance()&&McxDialogBase.isExistDialogOfType(this.constructor))McxDialogBase.getExistDialogOfType(this.constructor).show();else{if(0==this.base._dialogElem.parents("#layerManagerContainer").length){var c=this;$("#layerManagerContainer").append(c.base._dialogElem);setTimeout(function(){c.base._dialogElem.focus();
c.base._dialogElem.removeClass("anim-show").removeClass("anim-suspend");c.base._dialogElem.css("opacity",0);c.base._dialogElem.removeClass("visibility-hidden");50>=c.base._dialogElem.offset().top&&0==c.base._dialogElem.offset().left?c.centralizeDialog():c.repositionIfDialogOverlows();c.base.updateLayout();c.base._dialogElem.css("opacity",1);c.base._dialogElem.addClass("anim-show")},25)}0>McxDialogBase._currentDialogs.indexOf(this)&&McxDialogBase._currentDialogs.push(this);this.base._isInitialized||
(this.initialize(),this.base._dialogBody.append(this.getContent()),this.base.creationComplete(),this.base.enableHotKeys(),this.base._isInitialized=!0);$(".mcx-layer-manager-list-item").append($("<div/>").addClass("mcx-content-overlay"));this.base.update();this.base.focusFirstInput();this.base.setAsActiveDialog();this.base.onDialogShown().dispatchOnSuccess(this,null)}};js.framework.ui.McxCommonControl.SubtypeEngine.McxRangeThematicStyleEditor={};function McxRangeThematicStyleEditor(){mcx.base(this);this.base=this;this._classNumberSpinner=new McxNumberSpinner(0)}mcx.inherits(McxRangeThematicStyleEditor,McxCodedDomainThematicStyleEditor);
McxRangeThematicStyleEditor.prototype.initialize=function(){this.base._classifyDialog.getSubmitHandler().addListener(this.base.setItemsClassifyGrid,null,this);var a=new McxAccordionContentDisplayer("Data");a.setButtonLocalizationKey("McxCommonControl-mcxLayerPropertiesData");this.base.addChild(this.base._rootElement,a);a.showContent();a.hideButtons();a.setIsFloating(!1);this.createDataGroup(a);a=new McxAccordionContentDisplayer("Coloring");a.setButtonLocalizationKey("McxCommonControl-mcxLayerPropertiesColoring");
this.base.addChild(this.base._rootElement,a);a.showContent();a.hideButtons();a.setIsFloating(!1);this.base.addChild(this.base._rootElement,a);this.base.createColoringGroup(a);this.base._layerFieldSelector.getFieldChangeHandler().addListener(this.base.onFieldChange,null,this)};
McxRangeThematicStyleEditor.prototype.createDataGroup=function(a){this.base._layerFieldSelector.setFieldFilter(this.filterField);var b=new McxLayoutRow;b.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center);b.createAndAddSpan(9,this.base._layerFieldSelector);var c=new McxButton;c.setText("Classify");c.setLocalizationKey("McxCommonControl-LayerPropertiesClassify");c.setButtonState(McxButtonState.active);c.setIsFullWidth(!0);c.getClickHandler().addListener(this.base.onClassifyAllButtonClick,null,
this);b.createAndAddSpan(3,c);a.addContent(b);b=McxPredefinedGradients.getGradients();for(c=0;c<b.length;c++)this.base._gradientSelectBox.addGradient(McxGradient.fromJSON(b[c]));this.base._gradientSelectBox.setIsReversible(!0);this.base._gradientSelectBox.getOnChangeHandler().addListener(function(){this.base._selectedGradient=this.base._gradientSelectBox.getSelectedGradient();this.base._classifyDialog.getClassifyView().setGradient(this.base._selectedGradient)},null,this);c=new McxLabeledEditor("Gradient",
this.base._gradientSelectBox);c.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesGradient");c.getContent().css("margin-left","0");b=new McxLayoutRow;b.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.top);b.createAndAddSpan(9,c);b.getContent().css("margin-left","0");a.addContent(b);b=new McxLayoutRow;b.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.top);this._classNumberSpinner.setValue(10);c=new McxLabeledEditor("Class",this._classNumberSpinner);b.createAndAddSpan(9,c);b.getContent().css("margin-left",
"0");a.addContent(b)};McxRangeThematicStyleEditor.prototype.getName=function(){return"McxCommonControl-RangeValue"};McxRangeThematicStyleEditor.prototype.filterField=function(a){return a.getDomainName()?!1:a.getFieldType()==McxDataType.Double||a.getFieldType()==McxDataType.Float||a.getFieldType()==McxDataType.Int32||a.getFieldType()==McxDataType.Int64||a.getFieldType()==McxDataType.Int16};
McxRangeThematicStyleEditor.prototype.updateColoringEditor=function(a){var b=this._layerFieldSelector.getLayer(),c=this._layerFieldSelector.getField();if(0==mcx.isDefAndNotNull(b)||0==mcx.isDefAndNotNull(c))a.getError().call(a.getScope(),null);else{this.base._symbolizerDialog.getEditor().setGeometryType(b.getGeometryType());var d=[],e=new McxAjaxParameter;e.setParameters(this,function(e){e=e.getFeatureReader();e.count();e=e.toArray();var f=parseFloat(e[0].getValue(c.getFieldName())),k=parseFloat(e[e.length-
1].getValue(c.getFieldName()));e=this._classNumberSpinner.getValue();for(var k=(k-f)/e,m=f,f=f+k,n=0;n<e;n++){m=new McxSubtypeColoringItem(m+" - "+f,{first:m,last:f},NaN,NaN);if(b.isInstanceOf("McxFsLayer")){var p=b.getSymbolizer().clone();m.setSymbolizer(p)}else m.setSymbolizer(new McxCompositeSymbolizer);m.setLabelSymbolizer(new McxTextSymbolizer);d.push(m);m=f;f=m+k}a.getAsync()&&a.getSuccess().call(a.getScope(),new McxEventArgs(d))},function(){a.getAsync()&&a.getError().call(a.getScope(),null)});
e.setTimeOut(10);var f="1=1 group by "+c.getFieldName()+" order by "+c.getFieldName();b.query(c.getFieldName(),f,e);this.base._selectedSubtypeField=c;this.base._selectedLayer=b}};
McxRangeThematicStyleEditor.prototype.applyStyle=function(){if(0!=mcx.isDefAndNotNull(this.base._selectedLayer)&&0!=mcx.isDefAndNotNull(this.base._selectedSubtypeField)){var a=this.base._subtypeColoringEditor.getSelectedSubtypeColoringItems(),b=this.base._layerFieldSelector.getLayer(),c=this.base._layerFieldSelector.getField();b.getSubtypes().clear();if(!mcx.isDefAndNotNull(a)||0!=a.length){for(var d=0;d<a.length-1;d++){var e=a[d],f=e.getValue().first,g=e.getValue().last,h=String.format("[{0}]({1} - {2})",
c.getFieldName(),f.toFixed(2),g.toFixed(2)),f=String.format("[{0}] >= {1} && [{0}] < {2}",c.getFieldName(),f,g),g=new McxScript(f),g=new McxSubtype(g);g.setValue(f);g.setVisibility(!0);g.setName(h);g.setSymbolizer(e.getSymbolizer());b.getSubtypes().add(g)}a=new McxDefinedSubtypeObject(McxSubtypeType.RangedValueSubtype,c.getFieldName());b.setSubtypeType(a)}}};js.framework.ui.McxCommonControl.SubtypeEngine.McxSubtypeColoringItem={};function McxSubtypeColoringItem(a,b,c,d){this._text=a;this._value=b;this._minScale=c;this._maxScale=d;this._labelSymbolizer=this._symbolizer=null}McxSubtypeColoringItem.prototype.getText=function(){return this._text};McxSubtypeColoringItem.prototype.getValue=function(){return this._value};McxSubtypeColoringItem.prototype.setText=function(a){this._text=a};McxSubtypeColoringItem.prototype.setValue=function(a){this._value=a};
McxSubtypeColoringItem.prototype.setMinScale=function(a){this._minScale=a};McxSubtypeColoringItem.prototype.getMinScale=function(){return this._minScale};McxSubtypeColoringItem.prototype.setMaxScale=function(a){this._maxScale=a};McxSubtypeColoringItem.prototype.getMaxScale=function(){return this._maxScale};McxSubtypeColoringItem.prototype.getSymbolizer=function(){return this._symbolizer};McxSubtypeColoringItem.prototype.getLabelSymbolizer=function(){return this._labelSymbolizer};
McxSubtypeColoringItem.prototype.setSymbolizer=function(a){this._symbolizer=a};McxSubtypeColoringItem.prototype.setLabelSymbolizer=function(a){this._labelSymbolizer=a};js.framework.ui.McxCommonControl.SubtypeEngine.McxSubtypeEngineView={};function McxSubtypeEngineView(){mcx.base(this);this.base=this;this._selectedEditor=this._layers=this._editorSpan=this._mainRow=this._thematicStyleSelectBox=this._editors=this._rootElement=null;McxSubtypeEngineView._legendControl=McxApplication.getActiveDocument().getLegend();this.initialize()}mcx.inherits(McxSubtypeEngineView,McxUserControl);
McxSubtypeEngineView.prototype.initialize=function(){this._rootElement=$("<div/>").addClass("");this._editors=[];var a=new McxPanel;this._thematicStyleSelectBox=new McxSelectBox;this._thematicStyleSelectBox.setIsLocalizable(!0);a.addControl(new McxLabeledEditor("Thematic Style",this._thematicStyleSelectBox,"McxCommonControl-thematicStyle"));a.css("margin-bottom","auto");a.css("padding","0 10px");this._mainRow=new McxLayoutRow;this._editorSpan=new McxLayoutSpan(12);this._mainRow.addSpan(this._editorSpan);
this._mainRow.css("margin-top","auto");this.base.addChild(this._rootElement,a);this.base.addChild(this._rootElement,this._mainRow);this.bindEvents()};McxSubtypeEngineView.prototype.bindEvents=function(){this._thematicStyleSelectBox.getOnSelectHandler().addListener(function(){var a=this._thematicStyleSelectBox.getSelectedItem();this.setSelectedEditor(a);McxLocalizationManager.applyLocalization()},null,this)};
McxSubtypeEngineView.prototype.addThematicStyleEditor=function(a){-1<this._editors.indexOf(a)||(this._editors.push(a),0==mcx.isDefAndNotNull(this._selectedEditor)&&this.setSelectedEditor(a),this._thematicStyleSelectBox.setTextGetter("getName"),this._thematicStyleSelectBox.setValueGetter("getName"),this._thematicStyleSelectBox.addItem(a),this._thematicStyleSelectBox.localize(),mcx.isDefAndNotNull(this._layers)&&a.setLayers(this._layers))};
McxSubtypeEngineView.prototype.setSelectedEditor=function(a){this._selectedEditor!=a&&(this._selectedEditor=a,this._editorSpan.setContent(a),this._thematicStyleSelectBox.setSelectedValue(a.getName()),this._selectedEditor.updateLayout())};McxSubtypeEngineView.prototype.setLayers=function(a){this._layers=a;for(a=0;a<this._editors.length;a++)this._editors[a].setLayers(this._layers)};
McxSubtypeEngineView.prototype.applyStyle=function(){if(null!=this._selectedEditor){this._selectedEditor.applyStyle();var a=this._selectedEditor.getActiveLayer();if(a){var b=a.getSubtypes().getCount(),c=a.getGeometryType();if(0!=b)for(var d=0;d<b;d++){var e=a.getSubtypes().getAt(d);e.getValue();c==McxGeometryType.Polygon||c==McxGeometryType.MultiPolygon||c==McxGeometryType.None||c==McxGeometryType.GeometryCollection?(e=e.getSymbolizer().getPolygonSymbolizer().getFill())&&e.getColor():(c==McxGeometryType.LinearRing||
c==McxGeometryType.LineSegment||c==McxGeometryType.MultiLineString||c==McxGeometryType.LineString)&&(e=e.getSymbolizer().getLineSymbolizer().getStroke())&&e.getColor()}}}};McxSubtypeEngineView.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.SubtypeEngine.McxSymbolizerEditorDialog={};function McxSymbolizerEditorDialog(){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._symbolizerEditor=new McxSymbolizerEditor}mcx.inherits(McxSymbolizerEditorDialog,McxDialogBase);
McxSymbolizerEditorDialog.prototype.initialize=function(){var a=new McxPanel;a.addControl(this._symbolizerEditor);a.getContent().css("padding-bottom","10px");this.base.addChild(this._rootElement,a);this.base.onCloseDialog().addListener(function(){$(".mcx-content-overlay").remove()},null,this)};McxSymbolizerEditorDialog.prototype.getEditor=function(){return this._symbolizerEditor};McxSymbolizerEditorDialog.prototype.getDialogSize=function(){return McxDialogSize.medium};
McxSymbolizerEditorDialog.prototype.getContent=function(){return this._rootElement};
McxSymbolizerEditorDialog.prototype.createDialogElem=function(){var a=$("<div/>").addClass("mcx-mini-dialog-header").addClass("mcx-drag-handle"),b=$("<div/>").addClass("mcx-mini-dialog-header-tool-container");this.base._dialogBody.addClass("mcx-mini-dialog");this.base._dialogFooter.addClass("mcx-mini-dialog");this.base._dialogCancelButton.setText("Cancel");this.base._dialogCancelButton.setLocalizationKey("mcxDialogCancel");this.base._dialogOkButton.setText("Ok");this.base._dialogOkButton.setLocalizationKey("mcxDialogOk");
this.base._dialogElem.append(a).append(this.base._dialogBody).append(this.base._dialogFooter).append(this.base._dialogResizeHandleLeft).append(this.base._dialogResizeHandleRight).append(this.base._dialogResizeHandleBottom);a.append(b);this.base.createToolButtons(b);this.base._dialogFooter.hide(0)};
McxSymbolizerEditorDialog.prototype.centralizeDialog=function(){this.base._dialogElem.offset({top:($("#layerManagerContainer").height()-this.base._dialogElem.height())/2,left:($("#layerManagerContainer").width()-this.base._dialogElem.width())/2});this.repositionIfDialogOverlows()};
McxSymbolizerEditorDialog.prototype.repositionIfDialogOverlows=function(){var a=this.base._dialogElem.offset(),b=$("#layerManagerContainer").height(),c=$("#layerManagerContainer").width(),d=this.base._dialogElem.height(),e=this.base._dialogElem.width();a.top+d>b&&(a.top=b-d);a.left+e>c&&(a.left=c-e);0>a.top&&(a.top=0);0>a.left&&(a.left=0);this.base._dialogElem.offset(a)};
McxSymbolizerEditorDialog.prototype.showDialog=function(a,b){a?this.base._dialogElem.addClass("state-modal"):this.base._dialogElem.removeClass("state-modal");b&&this.base.enableResize();if(this.base.getIsSingleInstance()&&McxDialogBase.isExistDialogOfType(this.constructor))McxDialogBase.getExistDialogOfType(this.constructor).show();else{if(0==this.base._dialogElem.parents("#layerManagerContainer").length){var c=this;$("#layerManagerContainer").append(c.base._dialogElem);setTimeout(function(){c.base._dialogElem.focus();
c.base._dialogElem.removeClass("anim-show").removeClass("anim-suspend");c.base._dialogElem.css("opacity",0);c.base._dialogElem.removeClass("visibility-hidden");50>=c.base._dialogElem.offset().top&&0==c.base._dialogElem.offset().left?c.centralizeDialog():c.repositionIfDialogOverlows();c.base.updateLayout();c.base._dialogElem.css("opacity",1);c.base._dialogElem.addClass("anim-show")},25)}0>McxDialogBase._currentDialogs.indexOf(this)&&McxDialogBase._currentDialogs.push(this);this.base._isInitialized||
(this.initialize(),this.base._dialogBody.append(this.getContent()),this.base.creationComplete(),this.base.enableHotKeys(),this.base._isInitialized=!0);$(".mcx-layer-manager-list-item").append($("<div/>").addClass("mcx-content-overlay"));this.base.update();this.base.focusFirstInput();this.base.setAsActiveDialog();this.base.onDialogShown().dispatchOnSuccess(this,null)}};js.framework.ui.McxCommonControl.SubtypeEngine.McxThematicStyleClearEditor={};function McxThematicStyleClearEditor(){mcx.base(this);this.base=this;this._rootElement=null;this._descriptionTextArea=$("<div/>");this._selectedLayer=this._layers=this._layerSelectBox=null}mcx.inherits(McxThematicStyleClearEditor,McxUserControl);McxThematicStyleClearEditor.prototype.getName=function(){return"McxCommonControl-ClearSubtype"};McxThematicStyleClearEditor.prototype.setLayers=function(a){this._layers=a;this._layerSelectBox.addItemRange(a)};
McxThematicStyleClearEditor.prototype.updateDescription=function(){var a=this._layerSelectBox.getSelectedItem();this._descriptionTextArea.html(McxLocalizationManager.getLocaleValue("McxCommonControl-NoThematicText"));if(a&&0<a.getSubtypes().getCount()){var b="";switch(a.getSubtypeType()){case McxSubtypeType.CodedValueSubtype:b="coded value";break;case McxSubtypeType.RangedValueSubtype:b="ranged value";break;case McxSubtypeType.UniqueValueSubtype:b="unique value"}a=McxLocalizationManager.getLocaleValue("McxCommonControl-ThematicText");
a=String.format(a,b).toString();this._descriptionTextArea.html(a).removeAttr("data-localize")}};McxThematicStyleClearEditor.prototype.setSelectedLayer=function(a){0!=mcx.isDefAndNotNull(a)&&(this._layerSelectBox.setSelectedValue(a.getName()),this.updateDescription())};McxThematicStyleClearEditor.prototype.getContent=function(){return this._rootElement};McxThematicStyleClearEditor.prototype.applyStyle=function(){0!=mcx.isDefAndNotNull(this._selectedLayer)&&this._selectedLayer.getSubtypes().clear()};
McxThematicStyleClearEditor.prototype.updateLayout=function(){this.updateDescription()};
McxThematicStyleClearEditor.prototype.initialize=function(){this._rootElement=$("<div/>");this._layerSelectBox=new McxSelectBox;this._layerSelectBox.setTextGetter("getName");this._layerSelectBox.setValueGetter("getName");var a=new McxGroupBox("Clear");a.setLocalizationKeyForTitle("McxCommonControl-mcxLayerPropertiesClear");var b=new McxLabeledEditor("Layer",this._layerSelectBox);b.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesLayer");a.addContent(b);this._descriptionTextArea.css({border:"1px solid rgba(201, 201, 201, 1)",
"border-radius":"2px",padding:"5px"});b=new McxLabeledEditor("Description",this._descriptionTextArea);b.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesDescription");a.addContent(b);this._layerSelectBox.getOnSelectHandler().addListener(function(){this._selectedLayer=this._layerSelectBox.getSelectedItem()},null,this);this.base.addChild(this._rootElement,a)};McxThematicStyleClearEditor.prototype.getActiveLayer=function(){return this._layerSelectBox.getSelectedItem()};js.framework.ui.McxCommonControl.SubtypeEngine.McxThematicStyleExportEditor={};function McxThematicStyleExportEditor(){mcx.base(this);this.base=this;this._rootElement=null;this._downloadButton=new McxButton;this._selectedLayer=this._layers=this._layerSelectBox=null;this._importInput=$("<input/>").attr("type","file").attr("accept",".mcls").addClass("import-input");this._importButton=new McxButton;this._onImportEventHandler=new McxEventHandler}mcx.inherits(McxThematicStyleExportEditor,McxUserControl);
McxThematicStyleExportEditor.prototype.getName=function(){return"McxCommonControl-ExportImportSubtype"};McxThematicStyleExportEditor.prototype.setLayers=function(a){this._layers=a;this._layerSelectBox.addItemRange(a)};McxThematicStyleExportEditor.prototype.setSelectedLayer=function(a){0!=mcx.isDefAndNotNull(a)&&this._layerSelectBox.setSelectedValue(a.getName())};McxThematicStyleExportEditor.prototype.getContent=function(){return this._rootElement};
McxThematicStyleExportEditor.prototype.getOnImportEventHandler=function(){return this._onImportEventHandler};McxThematicStyleExportEditor.prototype.applyStyle=function(){};McxThematicStyleExportEditor.prototype.updateLayout=function(){};
McxThematicStyleExportEditor.prototype.initialize=function(){this._rootElement=$("<div/>");this._layerSelectBox=new McxSelectBox;this._layerSelectBox.setTextGetter("getName");this._layerSelectBox.setValueGetter("getName");var a=new McxGroupBox("D\u0131\u015fa Aktar");a.setLocalizationKeyForTitle("McxCommonControl-mcxLayerPropertiesExport");var b=new McxLabeledEditor("Layer",this._layerSelectBox);b.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesLayer");a.addContent(b);this._downloadButton.getContent().css({border:"1px solid rgba(201, 201, 201, 1)",
"border-radius":"2px",padding:"5px"});this._downloadButton.setIsFullWidth(!0);this._downloadButton.setText("D\u0131\u015far\u0131 Aktar");this._downloadButton.getClickHandler().addListener(this.exportStyle,null,this);b=new McxLabeledEditor("",this._downloadButton);b.setLabelLocalizationKey("");a.addContent(b);var b=new McxGroupBox("\u0130\u00e7eri Aktar"),c=new McxLabeledEditor("Dosya",this._importInput);b.addContent(c);this._importButton.setIsFullWidth(!0);this._importButton.setText("\u0130\u00e7eri Aktar");
this._importButton.getClickHandler().addListener(this.importStyle,null,this);c=new McxLabeledEditor("",this._importButton);b.addContent(c);this._layerSelectBox.getOnSelectHandler().addListener(function(){this._selectedLayer=this._layerSelectBox.getSelectedItem()},null,this);this.base.addChild(this._rootElement,a);this.base.addChild(this._rootElement,b)};
McxThematicStyleExportEditor.prototype.importStyle=function(){var a=this,b=$(this._importInput)[0].files[0];if(-1==b.type.indexOf("mcls")&&-1==b.name.indexOf("mcls"))McxMessageBox.show("\u0130\u00e7eri Aktar","\u015ee\u00e7ti\u011finiz Dosya format\u0131n\u0131 kontrol ediniz.",McxMessageBoxType.Error);else{McxLoadingIndicator.setAsBusy(this._rootElement);var c=new FileReader;c.onload=function(){var b=(new DOMParser).parseFromString(this.result,"text/xml"),c=McxXMLReader.createXmlDocument(b),b=a._selectedLayer,
c=c.findSingleNode("Style"),f=c.findSingleNode("SubtypeType").getValue();f&&b.setSubtypeType(new McxDefinedSubtypeObject(parseInt(f.split(",")[0].toString(),0),f.split(",")[1]));c=c.findSingleNode("subtypes").findNodes("subtype");b.getSubtypes().clear();for(f=0;f<c.length;f++){var g=a.createSubtypeFromXml(c[f]);if(g&&null!=g){b.getSubtypes().add(g);var h=b.getGeometryType();h==McxGeometryType.Polygon||h==McxGeometryType.MultiPolygon||h==McxGeometryType.None||h==McxGeometryType.GeometryCollection?
(g=g.getSymbolizer().getPolygonSymbolizer().getFill())&&g.getColor():(h==McxGeometryType.LinearRing||h==McxGeometryType.LineSegment||h==McxGeometryType.MultiLineString||h==McxGeometryType.LineString)&&(g=g.getSymbolizer().getLineSymbolizer().getStroke())&&g.getColor();a._importInput.val("");McxLoadingIndicator.setAsIdle(a._rootElement);a._onImportEventHandler.dispatchOnSuccess(this,null)}}};c.readAsText(b)}};
McxThematicStyleExportEditor.prototype.exportStyle=function(){var a=McxXMLReader.createXmlNode("LayerStyle"),b=McxXMLReader.createXmlNode("Style"),c=this._selectedLayer;if(0<c.getSubtypes().getCount()){b.appendTextNode("SubtypeType",c.getSubtypeType().getSubtypeType().toString()+","+c.getSubtypeType().getSubtypeField().toString());var d=McxXMLReader.createXmlNode("Subtypes"),e=c.getSubtypes();if(0<e.getCount()){for(var f=0;f<e.getCount();f++){var g=e.getAt(f);if(0!=mcx.isDefAndNotNull(g)){var h=McxXMLReader.createXmlNode("Subtype");
h.appendTextNode("Script",g.getScript().getScript().toString());h.appendTextNode("minScale",g.getMinScale().toString());h.appendTextNode("maxScale",g.getMaxScale().toString());var k=g.getSymbolizer();if(mcx.isDefAndNotNull(k)){var m=McxXMLReader.createXmlNode("Symbolizer");m.appendNode(k.toSLD());h.appendNode(m)}h.appendTextNode("Visible",g.isVisible().toString());d.appendNode(h)}}b.appendNode(d)}}a.appendNode(b);b=document.createElement("a");document.body.appendChild(b);$(b).css("display","none");
c=c.getClassId()+".mcls";a=new Blob([a.toString()],{type:"text/mcls"});a=window.URL.createObjectURL(a);b.href=a;b.download=c;b.click()};
McxThematicStyleExportEditor.prototype.createSubtypeFromXml=function(a){if(!a||a.isEmpty())return null;var b=a.findSingleNode("Script").getValue(),c=a.findSingleNode("Visible").getValue(),b=new McxScript(b.toString()),b=new McxSubtype(b);b.setMinScale(parseFloat(a.findSingleNode("minScale").getValue()));b.setMaxScale(parseFloat(a.findSingleNode("maxScale").getValue()));a=a.findSingleNode("Symbolizer");0==a.isEmpty()&&(a=McxSldReader.readCompositeSymbolizer(a),b.setSymbolizer(a));b.setVisibility("true"==
c.toLowerCase());return b};McxThematicStyleExportEditor.prototype.getActiveLayer=function(){return this._layerSelectBox.getSelectedItem()};js.framework.ui.McxCommonControl.SubtypeEngine.McxUniqueValueThematicStyleEditor={};function McxUniqueValueThematicStyleEditor(){mcx.base(this);this.base=this}mcx.inherits(McxUniqueValueThematicStyleEditor,McxCodedDomainThematicStyleEditor);
McxUniqueValueThematicStyleEditor.prototype.initialize=function(){this.base._classifyDialog.getSubmitHandler().addListener(this.base.setItemsClassifyGrid,null,this);var a=new McxAccordionContentDisplayer("Classify");a.setButtonLocalizationKey("McxCommonControl-mcxLayerPropertiesData");this.base.addChild(this.base._rootElement,a);a.showContent();a.hideButtons();a.setIsFloating(!1);this.createDataGroup(a);a=new McxAccordionContentDisplayer("Coloring");a.setButtonLocalizationKey("McxCommonControl-mcxLayerPropertiesColoring");
a.showContent();a.hideButtons();a.setIsFloating(!1);this.base.addChild(this._rootElement,a);this.createColoringGroup(a)};
McxUniqueValueThematicStyleEditor.prototype.updateColoringEditor=function(a){function b(b){f=[];var c=b.getFeatureReader();if(c){for(;c.read();){var e=c.getCurrent(),g=e.getField(b.getArgs().toString()),e=new McxSubtypeColoringItem(e.getValue(g.getFieldName()).toString(),e.getValue(g.getFieldName()),NaN,NaN);d.isInstanceOf("McxFsLayer")?(g=d.getSymbolizer().clone(),e.setSymbolizer(g)):e.setSymbolizer(new McxCompositeSymbolizer);f.push(e)}a.getAsync()&&a.getSuccess().call(a.getScope(),new McxEventArgs(f))}return null}
function c(){a.getAsync()&&a.getError().call(a.getScope(),null)}var d=this.base._layerFieldSelector.getLayer(),e=this.base._layerFieldSelector.getField();if(0==mcx.isDefAndNotNull(d)||0==mcx.isDefAndNotNull(e))a.getError().call(a.getScope(),null);else{var f=[];McxLoadingIndicator.setAsBusy(this.base._classifyDialog.getContent());var e=e.getFieldName(),g=new McxAjaxParameter;g.setArgs(e);g.setParameters(this,b,c);d.query(e,"1=1 group by "+e+" order by "+e,g)}};
McxUniqueValueThematicStyleEditor.prototype.createDataGroup=function(a){this.base._layerFieldSelector.setFieldFilter(this.base.filterField);var b=new McxLayoutRow;b.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center);b.createAndAddSpan(9,this.base._layerFieldSelector);var c=new McxButton;c.setText("Classify");c.setLocalizationKey("McxCommonControl-LayerPropertiesClassify");c.setButtonState(McxButtonState.active);c.setIsFullWidth(!0);c.getClickHandler().addListener(this.base.onClassifyButtonClick,
null,this);b.createAndAddSpan(3,c);a.addContent(b);b=McxPredefinedGradients.getGradients();for(c=0;c<b.length;c++)this.base._gradientSelectBox.addGradient(McxGradient.fromJSON(b[c]));this.base._gradientSelectBox.setIsReversible(!0);this.base._gradientSelectBox.getOnChangeHandler().addListener(function(){this.base._selectedGradient=this.base._gradientSelectBox.getSelectedGradient();this.base._classifyDialog.getClassifyView().setGradient(this.base._selectedGradient)},null,this);c=new McxLabeledEditor("Gradient",
this.base._gradientSelectBox);c.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesGradient");c.getContent().css("margin-left","0");b=new McxLayoutRow;b.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.top);b.createAndAddSpan(9,c);b.getContent().css("margin-left","0");c=new McxButton;c.setText("Classify All");c.setLocalizationKey("McxCommonControl-LayerPropertiesClassifyAll");c.setButtonState(McxButtonState.active);c.setIsFullWidth(!0);c.getContent().css("margin-top","5px");c.getClickHandler().addListener(this.base.onClassifyAllButtonClick,
null,this);b.createAndAddSpan(3,c);a.addContent(b)};
McxUniqueValueThematicStyleEditor.prototype.createColoringGroup=function(a){this.base._subtypeColoringEditor=new McxSubtypeColoringEditor;a.addContent(this.base._subtypeColoringEditor);this.base._subtypeColoringEditor.getGridItemSelectHandler().addListener(function(){var a=this.base._subtypeColoringEditor.getSelectedGridItem();a&&(this.base._symbolizerDialog.getEditor().setIsEnabled(!0),this.base._symbolizerDialog.getEditor().setGeometryType(this.base._layerFieldSelector.getLayer().getGeometryType()),this.base._symbolizerDialog.getEditor().setSymbolizer(a.getSymbolizer()),
this.base._symbolizerDialog.getEditor().setLabelSymbolizer(a.getLabelSymbolizer()),this.base._symbolizerDialog.showDialog(!0,!1))},null,this)};McxUniqueValueThematicStyleEditor.prototype.getName=function(){return"McxCommonControl-UniqueValue"};McxUniqueValueThematicStyleEditor.prototype.filterField=function(a){return""==a.getDomainName()||null==a.getDomainName()||void 0==a.getDomainName()?!0:!1};
McxUniqueValueThematicStyleEditor.prototype.applyStyle=function(){if(0!=mcx.isDefAndNotNull(this.base._layerFieldSelector.getLayer())&&0!=mcx.isDefAndNotNull(this.base._layerFieldSelector.getField())){var a=this.base._subtypeColoringEditor.getSelectedSubtypeColoringItems(),b=this.base._layerFieldSelector.getLayer(),c=this.base._layerFieldSelector.getField();b.getSubtypes().clear();if(!mcx.isDefAndNotNull(a)||0!=a.length){for(var d=0;d<a.length;d++){var e=a[d],f=e.getText()||e.getValue();if(f){var g=
c.getFieldType(),f=g==McxDataType.Int32?parseInt(f,10):g==McxDataType.Float||g==McxDataType.Double||g==McxDataType.Int64||g==McxDataType.Int16?parseFloat(f):"'"+f+"'",g=String.format("[{0}] == {1}",c.getFieldName(),f),g=new McxScript(g),g=new McxSubtype(g);g.setMaxScale(1/e.getMaxScale());g.setMinScale(1/e.getMinScale());g.setValue(f);g.setVisibility(!0);g.setSymbolizer(e.getSymbolizer());b.getSubtypes().add(g)}}a=new McxDefinedSubtypeObject(McxSubtypeType.UniqueValueSubtype,c.getFieldName());b.setSubtypeType(a)}}};js.framework.ui.McxCommonControl.SymbolizerEditor={};js.framework.ui.McxCommonControl.SymbolizerEditor.McxSymbolizerEditor={};
function McxSymbolizerEditor(){mcx.base(this);this.base=this;this._selectedContent=this._selectedButton=this._isEnabeld=this._labelSymbolizer=this._symbolizer=this._polygonSymbolizer=this._lineSymbolizer=this._pointSymbolizer=this._contentContainer=this._labelSymbolizerButton=this._polygonSymbolizerButton=this._lineSymbolizerButton=this._pointSymbolizerButton=this._labelSymbolizerEditor=this._polygonSymbolizerEditor=this._lineSymbolizerEditor=this._pointSymbolizerEditor=this._rootElement=null;this._geometryType=
McxGeometryType.Unknown;this.initialize();this.bindEvents()}mcx.inherits(McxSymbolizerEditor,McxUserControl);
McxSymbolizerEditor.prototype.initialize=function(){this._rootElement=$("<div/>");this._pointSymbolizerButton=new McxButton;this._pointSymbolizerButton.setText("Point");this._pointSymbolizerButton.setLocalizationKey("McxCommonControl-mcxLayerPropertiesPoint");this._lineSymbolizerButton=new McxButton;this._lineSymbolizerButton.setText("Line");this._lineSymbolizerButton.setLocalizationKey("McxCommonControl-mcxLayerPropertiesLine");this._polygonSymbolizerButton=new McxButton;this._polygonSymbolizerButton.setText("Polygon");
this._polygonSymbolizerButton.setLocalizationKey("McxCommonControl-mcxLayerPropertiesPolygon");this._labelSymbolizerButton=new McxButton;this._labelSymbolizerButton.setText("Label");this._labelSymbolizerButton.setLocalizationKey("McxCommonControl-mcxLayerPropertiesLabel");this._pointSymbolizerButton.setIsFullWidth(!0);this._lineSymbolizerButton.setIsFullWidth(!0);this._polygonSymbolizerButton.setIsFullWidth(!0);this._labelSymbolizerButton.setIsFullWidth(!0);this._pointSymbolizerButton.setButtonState(McxButtonState.predefined);
this._lineSymbolizerButton.setButtonState(McxButtonState.predefined);this._polygonSymbolizerButton.setButtonState(McxButtonState.predefined);this._labelSymbolizerButton.setButtonState(McxButtonState.predefined);var a=new McxLayoutRow;a.createAndAddSpan(3,this._pointSymbolizerButton);a.createAndAddSpan(3,this._lineSymbolizerButton);a.createAndAddSpan(3,this._polygonSymbolizerButton);a.createAndAddSpan(3,this._labelSymbolizerButton);this._pointSymbolizerEditor=new McxPointSymbolizerEditor;this._lineSymbolizerEditor=
new McxLineSymbolizerEditor;this._polygonSymbolizerEditor=new McxPolygonSymbolizerEditor;this._labelSymbolizerEditor=new McxTextSymbolizerEditor;this._pointSymbolizerEditor.setIsApplyImmediately(!0);this._polygonSymbolizerEditor.setIsApplyImmediately(!0);this._lineSymbolizerEditor.setIsApplyImmediately(!0);this._labelSymbolizerEditor.setIsApplyImmediately(!0);var b=new McxLayoutRow;this._contentContainer=new McxLayoutSpan(12);this._contentContainer.addContent(this._pointSymbolizerEditor);this._contentContainer.addContent(this._polygonSymbolizerEditor);
this._contentContainer.addContent(this._lineSymbolizerEditor);this._contentContainer.addContent(this._labelSymbolizerEditor);b.addSpan(this._contentContainer);this._contentContainer.css("margin-top","10px");this.base.addChild(this._rootElement,a);this.base.addChild(this._rootElement,b);this.setIsEnabled(!1);this.hideEditors()};McxSymbolizerEditor.prototype.setPointSymbolizer=function(a){this._pointSymbolizer=a;this.updateButtonStates();this._pointSymbolizerEditor.setPointSymbolizer(a)};
McxSymbolizerEditor.prototype.setPolygonSymbolizer=function(a){this._polygonSymbolizer=a;this.updateButtonStates();this._polygonSymbolizerEditor.setPolygonSymbolizer(a)};McxSymbolizerEditor.prototype.setLineSymbolizer=function(a){this._lineSymbolizer=a;this.updateButtonStates();this._lineSymbolizerEditor.setLineSymbolizer(a)};McxSymbolizerEditor.prototype.setLabelSymbolizer=function(a){this._labelSymbolizer=a;this.updateButtonStates();this._labelSymbolizerEditor.setTextSymbolizer(a)};
McxSymbolizerEditor.prototype.setSymbolizer=function(a){a.isInstanceOf("IMcxCompositeSymbolizer")?(this.setLineSymbolizer(a.getLineSymbolizer()),this.setPolygonSymbolizer(a.getPolygonSymbolizer()),this.setPointSymbolizer(a.getPointSymbolizer()),this._symbolizer=a):a.isInstanceOf("IMcxPolygonSymbolizer")?(this.setPolygonSymbolizer(a),this._symbolizer=a):a.isInstanceOf("IMcxPointSymbolizer")?(this.setPointSymbolizer(a),this._symbolizer=a):a.isInstanceOf("IMcxLineSymbolizer")&&(this.setLineSymbolizer(a),
this._symbolizer=a)};McxSymbolizerEditor.prototype.getSymbolizer=function(){return this._symbolizer};McxSymbolizerEditor.prototype.getPointSymbolizer=function(){return this._pointSymbolizer};McxSymbolizerEditor.prototype.getPolygonSymbolizer=function(){return this._polygonSymbolizer};McxSymbolizerEditor.prototype.getLineSymbolizer=function(){return this._lineSymbolizer};McxSymbolizerEditor.prototype.getLabelSymbolizer=function(){return this._labelSymbolizer};
McxSymbolizerEditor.prototype.updateButtonStates=function(){var a=this._geometryType,b=a==McxGeometryType.GeometryCollection||a==McxGeometryType.MultiPoint||a==McxGeometryType.Point||a==McxGeometryType.Unknown,c=a==McxGeometryType.GeometryCollection||a==McxGeometryType.LinearRing||a==McxGeometryType.LineSegment||a==McxGeometryType.LineString||a==McxGeometryType.MultiLineString||a==McxGeometryType.Unknown,a=a==McxGeometryType.GeometryCollection||a==McxGeometryType.MultiPolygon||a==McxGeometryType.Polygon||
a==McxGeometryType.Unknown;this._pointSymbolizerButton.setButtonState(1==this._isEnabeld&&mcx.isDefAndNotNull(this._pointSymbolizer)&&b?McxButtonState.predefined:McxButtonState.disabled);this._lineSymbolizerButton.setButtonState(1==this._isEnabeld&&mcx.isDefAndNotNull(this._lineSymbolizer)&&c?McxButtonState.predefined:McxButtonState.disabled);this._polygonSymbolizerButton.setButtonState(1==this._isEnabeld&&mcx.isDefAndNotNull(this._polygonSymbolizer)&&a?McxButtonState.predefined:McxButtonState.disabled);
this._labelSymbolizerButton.setButtonState(1==this._isEnabeld&&mcx.isDefAndNotNull(this._labelSymbolizer)?McxButtonState.predefined:McxButtonState.disabled)};McxSymbolizerEditor.prototype.updateSelection=function(){null==this._selectedButton&&null==this._selectedContent&&this.setSelectedButton(this._polygonSymbolizerButton,this._polygonSymbolizerEditor.getContent())};
McxSymbolizerEditor.prototype.setIsEnabled=function(a){this._isEnabeld!=a&&(this._isEnabeld=a,this.updateButtonStates(),a?(this._contentContainer.getContent().show(),this.updateSelection()):this._contentContainer.getContent().hide())};McxSymbolizerEditor.prototype.hideEditors=function(){this._pointSymbolizerEditor.getContent().hide();this._lineSymbolizerEditor.getContent().hide();this._polygonSymbolizerEditor.getContent().hide();this._labelSymbolizerEditor.getContent().hide()};
McxSymbolizerEditor.prototype.setSelectedButton=function(a,b){this.updateButtonStates();this._selectedButton=a;this._selectedContent=b;b.show();a.setButtonState(McxButtonState.active)};
McxSymbolizerEditor.prototype.bindEvents=function(){this._pointSymbolizerButton.getClickHandler().addListener(function(){this._pointSymbolizer&&(this.hideEditors(),this.setSelectedButton(this._pointSymbolizerButton,this._pointSymbolizerEditor.getContent()))},null,this);this._lineSymbolizerButton.getClickHandler().addListener(function(){this._lineSymbolizer&&(this.hideEditors(),this.setSelectedButton(this._lineSymbolizerButton,this._lineSymbolizerEditor.getContent()))},null,this);this._polygonSymbolizerButton.getClickHandler().addListener(function(){this._polygonSymbolizer&&
(this.hideEditors(),this.setSelectedButton(this._polygonSymbolizerButton,this._polygonSymbolizerEditor.getContent()))},null,this);this._labelSymbolizerButton.getClickHandler().addListener(function(){this._labelSymbolizerButton&&(this.hideEditors(),this.setSelectedButton(this._labelSymbolizerButton,this._labelSymbolizerEditor.getContent()))},null,this)};
McxSymbolizerEditor.prototype.applyStyle=function(){this._lineSymbolizerEditor.applyStyle();this._polygonSymbolizerEditor.applyStyle();this._pointSymbolizerEditor.applyStyle();this._labelSymbolizerEditor.applyStyle()};McxSymbolizerEditor.prototype.setGeometryType=function(a){this._geometryType=a};McxSymbolizerEditor.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.TabControl={};js.framework.ui.McxCommonControl.TabControl.IMcxTabPage={};function IMcxTabPage(){}IMcxTabPage.prototype.getTitle=function(){};IMcxTabPage.prototype.getTitleChangedEventHandler=function(){};IMcxTabPage.prototype.getTitleLocalizationKey=function(){};IMcxTabPage.prototype.getControl=function(){};IMcxTabPage.prototype.getControlSetHandler=function(){};IMcxTabPage.prototype.getId=function(){};IMcxTabPage.prototype.setId=function(a){};js.framework.ui.McxCommonControl.TabControl.McxTabControl={};function McxTabControl(){mcx.base(this);this.base=this;this._dataTabPageKey="mcxTabPage";this._tabChangeEventHandler=new McxEventHandler;this._beforeTabChangeEventHandler=new McxEventHandler;this._tabCloseEventHandler=new McxEventHandler;this._tabHeaderContainer=$("<div/>");this._tabContentContainer=$("<div/>");this._tabHeaderToolContainer=$("<div/>");this._pages=[];this._activeTabPage=null;this.initialize()}mcx.inherits(McxTabControl,McxPanel);
McxTabControl.prototype.initialize=function(){this._tabHeaderContainer.addClass("mcx-tab-header-container");this._tabHeaderToolContainer.addClass("mcx-tab-tool-container").appendTo(this._tabHeaderContainer);this._tabContentContainer.addClass("mcx-tab-content-container");this.base._rootElement.addClass("mcx-tab").append(this._tabHeaderContainer).append(this._tabContentContainer);this.base._rootElement.css({width:"100%",height:"100%"})};
McxTabControl.prototype.fit=function(){McxTabControl.superClass_.fit.call(this);this._tabContentContainer.css({position:"absolute",right:"0px",bottom:"0px",left:"0px",top:"40px",padding:"0px 0px 10px"})};
McxTabControl.prototype.setActiveTabPage=function(a){this._activeTabPage&&this.getBeforeTabChangeHandler().dispatchOnSuccess(this,new McxEventArgs(this._activeTabPage));var b=a.getControl().getContent().addClass("mcx-tab-page");this._tabContentContainer.children().detach();this._tabContentContainer.append(b);this.base.registerChild(a.getControl());a.getControl().updateLayout();this._activeTabPage=a;this.getTabChangeHandler().dispatchOnSuccess(this,new McxEventArgs(a))};
McxTabControl.prototype.addTabPage=function(a,b){var c=this;this._pages.push(a);var d=this.createHeaderElement(a.getTitle(),a.getTitleLocalizationKey());d.data(this._dataTabPageKey,a);var e=$("<div/>").text("x").addClass("mcx-tab-header-item-close-button").data("tabPage",a);d.click(function(){c._tabHeaderContainer.find(".selected").removeClass("selected");var a=$(this).data(c._dataTabPageKey);c.setActiveTabPage(a);$(this).addClass("selected")});b?(this._tabHeaderToolContainer.before($("<div/>").css({display:"inline-block",
"vertical-align":"center"}).append(d).append(e)),e.click($.proxy(function(){var a=e.data("tabPage");e.parent().remove();var b=a.getControl();b&&b.remove();b=this._pages.indexOf(a);this._pages.splice(b,1);a.getControl().setTag("#mapOrder#",this._pages.length);if(b=this._pages[b]||this._pages[b+1]||this._pages[b-1])this.showTab(b),b.getControl().updateLayout();this.getTabCloseHandler().dispatchOnSuccess(this,new McxEventArgs(a))},this))):this._tabHeaderToolContainer.before(d);0==mcx.isInstanceOf(a,
McxLazyTabPage)&&this.base.registerChild(a.getControl());a.getControlSetHandler().addListener(function(){c.base.registerChild(this.getControl())},null,a);a.headerElement=d;a.getTitleChangedEventHandler().addListener(this.onTitleChange,null,this)};McxTabControl.prototype.addToolButton=function(a){a.setButtonSize(McxButtonSize.small);a.setButtonVisualType(McxButtonVisualType.linkButton);this.base.addChild(this._tabHeaderToolContainer,a)};
McxTabControl.prototype.createHeaderElement=function(a,b){var c=$("<div/>").html(a).addClass("mcx-tab-header-item");b&&c.attr("data-localize",b);return c};McxTabControl.prototype.showTab=function(a){0>this._pages.indexOf(a)&&this.addTabPage(a);this.setActiveTabPage(a)};McxTabControl.prototype.getTabChangeHandler=function(){return this._tabChangeEventHandler};McxTabControl.prototype.getBeforeTabChangeHandler=function(){return this._beforeTabChangeEventHandler};
McxTabControl.prototype.getTabCloseHandler=function(){return this._tabCloseEventHandler};McxTabControl.prototype.getActiveTabPage=function(){return this._activeTabPage};McxTabControl.prototype.getPages=function(){return this._pages};McxTabControl.prototype.setTabVisibility=function(a,b){var c=a.headerElement;c&&(b?(a.getControl().css("display","block"),c.css("display","inline-block")):(c.hide(),a.getControl().css("display","none")))};McxTabControl.prototype.clear=function(){this.base.removeAllChildren()};
McxTabControl.prototype.onTitleChange=function(a){a=a.getArgs();var b=a.headerElement;b.text(a.getTitle());a.getTitleLocalizationKey()&&b.attr("data-localize",a.getTitleLocalizationKey())};js.framework.ui.McxCommonControl.TabControl.McxTabPage={};function McxTabPage(){this._titleLocalizationKey=this._title="";this._control=null;this._controlSetHandler=new McxEventHandler;this._tags=new McxDictionary;this._titileChangeEventHandler=new McxEventHandler;this._tabId=0}McxTabPage.prototype.setTitle=function(a,b){this._title=a;b&&this.setTitleLocalizationKey(b);this.getTitleChangedEventHandler().dispatchOnSuccess(this,new McxEventArgs(this))};
McxTabPage.prototype.setControl=function(a){this._control=a;this.getControlSetHandler().dispatchOnSuccess(this,null)};McxTabPage.prototype.setTitleLocalizationKey=function(a){this._titleLocalizationKey=a};McxTabPage.prototype.getTitle=function(){return this._title};McxTabPage.prototype.getTitleChangedEventHandler=function(){return this._titileChangeEventHandler};McxTabPage.prototype.getTitleLocalizationKey=function(){return this._titleLocalizationKey};McxTabPage.prototype.getControl=function(){return this._control};
McxTabPage.prototype.getControlSetHandler=function(){return this._controlSetHandler};McxTabPage.prototype.setId=function(a){this._tabId=a};McxTabPage.prototype.getId=function(){return this._tabId};js.framework.ui.McxCommonControl.TabControl.McxLazyTabPage={};function McxLazyTabPage(){mcx.base(this);this.base=this;this._controlInitializer=mcx.abstractMethod}mcx.inherits(McxLazyTabPage,McxTabPage);McxLazyTabPage.prototype.setControlInitializer=function(a,b,c){this._controlInitializer=a;this._controlInitializerScope=b;this._controlInitializerArgs=c};
McxLazyTabPage.prototype.getControl=function(){this.base._control||this.base.setControl(this._controlInitializer.apply(this._controlInitializerScope||this,this._controlInitializerArgs?[this._controlInitializerArgs]:null));return this.base._control};js.framework.ui.McxCommonControl.TextArea={};js.framework.ui.McxCommonControl.TextArea.McxTextArea={};function McxTextArea(){mcx.base(this);this.base=this;this._textArea=this._rootElement=null;this._isEnabled=!0;this.initialize()}mcx.inherits(McxTextArea,McxValidatableControl);
McxTextArea.prototype.initialize=function(){this._rootElement=$("<div/>");this._textArea=$("<textarea/>").addClass("mcx-input").addClass("fit");this._textArea.change($.proxy(function(){this.base.getChangeEventHandler().dispatchOnSuccess(this,new McxEventArgs(null))},this));this._rootElement.append(this._textArea)};McxTextArea.prototype.getContent=function(){return this._rootElement};McxTextArea.prototype.getValue=function(){return this._textArea.val().toString()};McxTextArea.prototype.setValue=function(a){this._textArea.val(a)};
McxTextArea.prototype.setWidth=function(a){this._textArea.css("width",a)};McxTextArea.prototype.setIsEnabled=function(a){(this._isEnabled=a)?this._textArea.removeAttr("disabled"):this._textArea.attr("disabled","disabled")};McxTextArea.prototype.setResizable=function(a){(this._isEnabled=a)?this._textArea.css("resize","both"):this._textArea.css("resize","none")};js.framework.ui.McxCommonControl.TextBox={};js.framework.ui.McxCommonControl.TextBox.McxTextBox={};function McxTextBox(a){mcx.base(this);this.base=this;this._textBox=this._rootElement=null;this._type=a||McxTextBoxType.Text;this._isEnabled=!0;this._keyPressHandler=new McxEventHandler;this.initialize()}mcx.inherits(McxTextBox,McxValidatableControl);
McxTextBox.prototype.initialize=function(){this._rootElement=$("<div/>");this._textBox=$("<input/>").attr("type",this._type==McxTextBoxType.Password?"password":"text").keyup($.proxy(this.onKeyPress,this)).addClass("fit").addClass("mcx-input");this._rootElement.append(this._textBox)};McxTextBox.prototype.clear=function(){this._textBox.val("")};McxTextBox.prototype.getContent=function(){return this._rootElement};
McxTextBox.prototype.setPlaceHolder=function(a,b){this._textBox.attr("placeholder",a);if(b)return this._textBox.attr("data-localize",b).attr("data-localize-for","placeholder")};McxTextBox.prototype.focus=function(){this._textBox.focus()};McxTextBox.prototype.getValue=function(){return this._textBox.val().toString()};McxTextBox.prototype.setValue=function(a){this._textBox.val(a)};McxTextBox.prototype.setWidth=function(a){this._textBox.css("width",a)};
McxTextBox.prototype.setHeight=function(a){this._textBox.css("height",a)};McxTextBox.prototype.setIsEnabled=function(a){(this._isEnabled=a)?this._textBox.removeAttr("disabled"):this._textBox.attr("disabled","disabled")};McxTextBox.prototype.onKeyPress=function(a){this.base.getChangeEventHandler().dispatchOnSuccess(this,new McxEventArgs(null));this.getKeyPressHandler().dispatchOnSuccess(this,new McxEventArgs(new McxKeyEventArgs(a)))};McxTextBox.prototype.getKeyPressHandler=function(){return this._keyPressHandler};js.framework.ui.McxCommonControl.TextBox.McxTextBoxType={};var McxTextBoxType={Text:0,Password:1,Number:2};js.framework.ui.McxCommonControl.TextEditor={};js.framework.ui.McxCommonControl.TextEditor.McxTextEditor={};function McxTextEditor(){mcx.base(this);this.base=this;this._fillEditor=this._fontPicker=this._font=this._fill=this._rootElement=null;this._onTextChangeHandler=new McxEventHandler;this.initialize()}mcx.inherits(McxTextEditor,McxUserControl);
McxTextEditor.prototype.initialize=function(){this._rootElement=$("<div/>");this._fontPicker=new McxFontPicker;this._fillEditor=new McxFillEditor;var a=new McxLabeledEditor("Font",this._fontPicker),b=new McxLayoutRow;b.createAndAddSpan(12,a);a.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesFont");this.base.addChild(this._rootElement,b);this.base.addChild(this._rootElement,this._fillEditor);this._rootElement.find(".row-fluid").css("margin-bottom","0px");b.getContent().css("margin-bottom",
"5px");this._fillEditor.getFillChangeHandler().addListener(this.onTextChange,null,this);this._fontPicker.getFontChangeHandler().addListener(this.onTextChange,null,this)};McxTextEditor.prototype.setFill=function(a){this._fill=a;this._fillEditor.setFill(this._fill)};McxTextEditor.prototype.setFont=function(a){this._font=a;this._fontPicker.setFontFamily(this._font.getFontFamily());this._fontPicker.setFontSize(this._font.getFontSize());this._fontPicker.updateFontDescription()};
McxTextEditor.prototype.getTextChangeHandler=function(){return this._onTextChangeHandler};McxTextEditor.prototype.applyStyle=function(){this._font.setFontAlign(this._fontPicker.getFontAlign());this._font.setFontFamily(this._fontPicker.getFontFamily());this._font.setFontSize(this._fontPicker.getFontSize());this._font.setFontUnit(this._fontPicker.getFontUnit());this._fillEditor.applyFill()};McxTextEditor.prototype.onTextChange=function(){this.getTextChangeHandler().dispatchOnSuccess(this,null)};
McxTextEditor.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.TextSymbolizerEditor={};js.framework.ui.McxCommonControl.TextSymbolizerEditor.McxTextSymbolizerEditor={};function McxTextSymbolizerEditor(){mcx.base(this);this.base=this;this._anchorPointSelector=this._textEditor=this._textSymbolizer=this._rootElement=null;this._isApplyImmediately=!1;this.initialize()}mcx.inherits(McxTextSymbolizerEditor,McxUserControl);
McxTextSymbolizerEditor.prototype.initialize=function(){this._rootElement=$("<div/>");this._textEditor=new McxTextEditor;this._anchorPointSelector=new McxAnchorPointEditor;var a=new McxGroupBox("Text Properties");a.addContent(this._textEditor);a.setLocalizationKeyForTitle("McxCommonControl-mcxLayerPropertiesTextProperties");var b=new McxGroupBox("Anchor Properties");b.addContent(this._anchorPointSelector);b.setLocalizationKeyForTitle("McxCommonControl-mcxLayerPropertiesAnchorProperties");var c=new McxLayoutRow;
c.createAndAddSpan(6,a);c.createAndAddSpan(6,b);this.base.addChild(this._rootElement,c)};
McxTextSymbolizerEditor.prototype.setTextSymbolizer=function(a){0!=mcx.isDefAndNotNull(a)&&(this._textSymbolizer=a,this._textEditor.setFont(this._textSymbolizer.getFont()),this._textEditor.setFill(this._textSymbolizer.getFill()),this._anchorPointSelector.setAnchorPoint(this._textSymbolizer.getAnchorPoint()),this._anchorPointSelector.setDisplacement(this._textSymbolizer.getDisplacement()),this._textEditor.getTextChangeHandler().addListener(function(){this.onStyleChange()},null,this))};
McxTextSymbolizerEditor.prototype.onStyleChange=function(){this._isApplyImmediately&&this.applyStyle()};McxTextSymbolizerEditor.prototype.setIsApplyImmediately=function(a){this._isApplyImmediately=a};McxTextSymbolizerEditor.prototype.applyStyle=function(){this._textEditor.applyStyle();this._anchorPointSelector.applyAnchor()};McxTextSymbolizerEditor.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.TimerControl={};js.framework.ui.McxCommonControl.TimerControl.McxTimerControl={};
function McxTimerControl(){mcx.base(this);this.base=this;this._rootElement=null;this._countDate=new Date;this._hoursSecondNumber=this._hoursFirstNumber=this._minutesSecondNumber=this._minutesFirstNumber=this._secondSecondNumber=this._secondFirstNumber=null;this._onCountCompleted=new McxEventHandler;this._passedSecond=this._passedMinute=this._passedHour=this._remainingSecond=this._remainingMinute=this._remainingHour=this._forwardInterval=this._backInterval=0;this.initialize()}
mcx.inherits(McxTimerControl,McxUserControl);
McxTimerControl.prototype.initialize=function(){this._rootElement=$("<div/>").css("z-index",99999999999999).addClass("");this._hoursFirstNumber=$("<div/>").addClass("mcx-timer-control-number-area");this._hoursFirstNumber.text("0");this._rootElement.append(this._hoursFirstNumber);this._hoursSecondNumber=$("<div/>").addClass("mcx-timer-control-number-area");this._hoursSecondNumber.text("5");this._rootElement.append(this._hoursSecondNumber);var a=$("<div/>").addClass("mcx-timer-control-separator-area");a.text(":");
this._rootElement.append(a);this._minutesFirstNumber=$("<div/>").addClass("mcx-timer-control-number-area");this._minutesFirstNumber.text("5");this._rootElement.append(this._minutesFirstNumber);this._minutesSecondNumber=$("<div/>").addClass("mcx-timer-control-number-area");this._minutesSecondNumber.text("9");this._rootElement.append(this._minutesSecondNumber);a=$("<div/>").addClass("mcx-timer-control-separator-area");a.text(":");this._rootElement.append(a);this._secondFirstNumber=$("<div/>").addClass("mcx-timer-control-number-area");
this._secondFirstNumber.text("9");this._rootElement.append(this._secondFirstNumber);this._secondSecondNumber=$("<div/>").addClass("mcx-timer-control-number-area");this._secondSecondNumber.text("9");this._rootElement.append(this._secondSecondNumber)};McxTimerControl.prototype.setCountDate=function(a){this._countDate=a};
McxTimerControl.prototype.calculateDifference=function(){this._countDate.toLocaleString();var a=parseInt(this._countDate.getHours(),10),b=parseInt(this._countDate.getMinutes(),0),c=parseInt(this._countDate.getSeconds(),0),d=new Date,e=parseInt(d.getHours(),10),f=parseInt(d.getMinutes(),10),d=parseInt(d.getSeconds(),10);this._remainingHour=a-e;this._remainingMinute=b-f;this._remainingSecond=c-d;0>this._remainingSecond&&(this._remainingSecond+=60,this._remainingMinute+=-1);0>this._remainingMinute&&
(this._remainingMinute+=60,this._remainingHour+=-1);10>this._remainingHour?(this._hoursFirstNumber.text("0"),this._hoursSecondNumber.text(this._remainingHour.toString())):(this._hoursFirstNumber.text(this._remainingHour.toString().substr(0,1)),this._hoursSecondNumber.text(this._remainingHour.toString().substr(1,1)));10>this._remainingMinute?(this._minutesFirstNumber.text("0"),this._minutesSecondNumber.text(this._remainingMinute.toString())):(this._minutesFirstNumber.text(this._remainingMinute.toString().substr(0,
1)),this._minutesSecondNumber.text(this._remainingMinute.toString().substr(1,1)));10>this._remainingSecond?(this._secondFirstNumber.text("0"),this._secondSecondNumber.text(this._remainingSecond.toString())):(this._secondFirstNumber.text(this._remainingSecond.toString().substr(0,1)),this._secondSecondNumber.text(this._remainingSecond.toString().substr(1,1)))};
McxTimerControl.prototype.countBack=function(){this.calculateDifference();this._rootElement.find(".mcx-timer-control-separator-area").removeClass("count-forward").addClass("count-back");this._rootElement.find(".mcx-timer-control-number-area").removeClass("count-forward").addClass("count-back");this._backInterval=setInterval($.proxy(function(){-1<this._remainingSecond%10&&(this._secondSecondNumber.text((this._remainingSecond%10).toString()),this._secondFirstNumber.text(Math.floor(this._remainingSecond/
10).toString()),this._remainingSecond--);-1==this._remainingSecond&&(0!=this._remainingMinute&&(this._remainingSecond=59),this._minutesSecondNumber.text((this._remainingMinute%10).toString()),this._minutesFirstNumber.text(Math.floor(this._remainingMinute/10).toString()),this._remainingMinute--);-1==this._remainingMinute&&(0!=this._remainingHour&&(this._remainingMinute=59),this._remainingHour--,-1<this._remainingHour&&(this._hoursSecondNumber.text((this._remainingHour%10).toString()),this._hoursFirstNumber.text(Math.floor(this._remainingHour/
10).toString())));-1==this._remainingSecond&&-1==this._remainingMinute&&-1==this._remainingHour&&(clearInterval(this._backInterval),this.getOnCountCompleted().dispatchOnSuccess(this,null))},this),1E3)};
McxTimerControl.prototype.countForward=function(){this._rootElement.find(".mcx-timer-control-separator-area").removeClass("count-back").addClass("count-forward");this._rootElement.find(".mcx-timer-control-number-area").removeClass("count-back").addClass("count-forward");this._forwardInterval=setInterval($.proxy(function(){59>this._passedSecond&&(this._passedSecond++,this._secondSecondNumber.text((this._passedSecond%10).toString()),this._secondFirstNumber.text(Math.floor(this._passedSecond/10).toString()),
this._minutesSecondNumber.text((this._passedMinute%10).toString()),this._minutesFirstNumber.text(Math.floor(this._passedMinute/10).toString()),this._hoursSecondNumber.text((this._passedHour%10).toString()),this._hoursFirstNumber.text(Math.floor(this._passedHour/10).toString()));58<this._passedSecond&&(this._passedSecond=-1,this._passedMinute++);58<this._passedMinute&&(this._passedMinute=0,this._passedHour++)},this),1E3)};
McxTimerControl.prototype.stop=function(){clearInterval(this._backInterval);clearInterval(this._forwardInterval)};McxTimerControl.prototype.getOnCountCompleted=function(){return this._onCountCompleted};McxTimerControl.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.ToolBar={};js.framework.ui.McxCommonControl.ToolBar.McxToolBar={};function McxToolBar(a){mcx.base(this);this.base=this;this.touchArea=this.map=this.mapFactory=null;this.toolBarId=McxGuid.createGuid();this.appendToElement=a?"#"+a:"body";this._scaleComboBox=new McxComboBox;this._coordinateSystemClickHandler=new McxEventHandler;this._content=this.layerSelectBox=null}mcx.inherits(McxToolBar,McxUserControl);McxToolBar.prototype.getScaleValueArrayFromSettings=function(){return[]};
McxToolBar.prototype.onScaleChange=function(){this.setScaleComboText(this.map.getScale())};McxToolBar.prototype.onFail=function(){};McxToolBar.prototype.setScaleValueToSettings=function(a){McxSettingsManager.write("scaleSettings",a,null)};
McxToolBar.prototype.setScaleComboText=function(a){this._scaleComboBox.getOnSelectHandler().removeListener(this.onScaleSelect);this._scaleComboBox.clear();this.updateScaleCombo(Math.round(1/a));this._scaleComboBox.getOnSelectHandler().addListener(this.onScaleSelect,null,this)};
McxToolBar.prototype.creationComplete=function(){$("#DragTool").click(this,this.setPan);$("#zoomAreaTool").click(this,this.setZoom);$("#viewallbutton").click(this,this.setZoomLimit);$("#CoordinateTool").click(this,this.showCoordinate);$("#Printtool").click(this,this.print);$("#InfoTool").click(this,$.proxy(this.setIdentifyController,this));$("#measuretool").click(this,$.proxy(this.measureController,this));$("#SelectTool").click(this,this.setSelectController);$("#AreaSelection").click(this,this.setSelectOnActiveLayerController);
$("#clearTool").click(this,this.clearSelection);$("#quickSearchTool").click(this,this.quickSearchTool);$("#toolBarChangeCoordinateSystem").click(this,this.setCoordinateSystemSetterAction);this.initLayerSelectBox();this.initScaleCombo()};McxToolBar.prototype.initialize=function(){$(this.appendToElement).append(this.getContent());this.creationComplete()};
McxToolBar.prototype.initCoordinateSystemTextBox=function(){function a(a){(a=b.map.viewToWorld(a.pageX-a.currentTarget.offsetLeft,a.pageY-a.currentTarget.offsetTop))&&$("#toolBarCoordinateLabel").html(a.getX().toFixed(4)+", "+a.getY().toFixed(4))}var b=this;this.map.getContent().unbind("mousemove",a);this.map.getContent().bind("mousemove",a)};
McxToolBar.prototype.setCoordinateSystemText=function(){var a=this.map.getCoordinateSystem(),b="Local";mcx.isDefAndNotNull(a)&&a.getName&&mcx.isDefAndNotNull(a.getName())&&""!=a.getName()&&(b=a.getName());$("#coordinateSystemLabel").css("display","block").text(b)};McxToolBar.prototype.setLeftMargin=function(a){var b=$(window).width()-a,c=$("#"+this.toolBarId).outerHeight();$("#"+this.toolBarId).width(b).css("left",a+"px").css("bottom",c+"px")};
McxToolBar.prototype.setPan=function(a){a=a.data;if(null!=a.map){var b=a.mapFactory.createPanController();a.map.getInputHandler().setController(b)}};McxToolBar.prototype.setZoom=function(a){a=a.data;if(null!=a.map){var b=a.mapFactory.createZoomWindowController();a.map.getInputHandler().setController(b)}};
McxToolBar.prototype.setZoomLimit=function(a){a=a.data;if(null!=a.map){for(var b=a.map.getLayers().toLayerArray(),c=[],d=0;d<b.length;d++)b[d].getVisible()&&c.push(b[d]);a.mapFactory.zoomLayersAction(c,a.map)}};McxToolBar.prototype.showCoordinate=function(a){a=a.data;if(null!=a.map){var b=a.mapFactory.showCoordinateController();a.map.getInputHandler().setController(b)}};McxToolBar.prototype.print=function(a){a=a.data;null!=a.map&&a.mapFactory.createPrintOptionsAction().execute(a.map)};
McxToolBar.prototype.quickSearchTool=function(a){a=a.data;null!=a.map&&a.mapFactory.quickSearchAction(a.map)};McxToolBar.prototype.clearSelection=function(a){a=a.data;if(null!=a.map){a=a.map;for(var b=a.getLayers().toLayerArray(),c=0;c<b.length;c++)b[c].clearSelection();a.getRenderer().paintSelections()}};McxToolBar.prototype.setIdentifyController=function(a){a=a.data;if(null!=a.map){var b=a.mapFactory.createIdentifyController();a.map.getInputHandler().setController(b)}};
McxToolBar.prototype.measureController=function(a){a=a.data;if(null!=a.map){var b=a.mapFactory.createMeasureController();a.map.getInputHandler().setController(b)}};McxToolBar.prototype.setSelectController=function(a){a=a.data;if(null!=a.map){var b=a.mapFactory.createSelectController();a.map.getInputHandler().setController(b)}};McxToolBar.prototype.setCoordinateSystemSetterAction=function(a){a=a.data;if(null!=a.map){var b=a.mapFactory.createCoordinateSystemSetterAction();a.map.getInputHandler().execute(b)}};
McxToolBar.prototype.setSelectOnActiveLayerController=function(a){a=a.data;if(null!=a.map){var b=a.mapFactory.createSelectOnActiveLayerController(a.map);a.map.getInputHandler().setController(b)}};
McxToolBar.prototype.initScaleCombo=function(){var a=this;this.base.addChild(this._content.find("#scale.scale"),this._scaleComboBox);this._scaleComboBox.getContent().find("input").height("20px");this._scaleComboBox.css("height","22px");this._scaleComboBox.css("width","100px");this._scaleComboBox.setTextGetter("text");this._scaleComboBox.setValueGetter("value");this._scaleComboBox.setFilterStatus(!1);this._scaleComboBox.isAutoFocusOnSelection(!1);a.updateScaleCombo();a.saveAndApplyScale=function(b){a.applyScale(b)};
this._scaleComboBox.getOnSelectHandler().addListener(this.onScaleSelect,null,this);this._scaleComboBox.getOnEnterKey().addListener(function(){var b=a._scaleComboBox.getText(),b=this.normalizeScale(b);a.saveAndApplyScale(b.toString())},null,this)};McxToolBar.prototype.onScaleSelect=function(){var a=this._scaleComboBox.getSelectedValue();this.applyScale(a.toString())};
McxToolBar.prototype.normalizeScale=function(a){for(;0<=a.indexOf("1:")||0<=a.indexOf("1/");){var b=a.indexOf("1:");0<=b&&(a=a.substring(b+2));b=a.indexOf("1/");0<=b&&(a=a.substring(b+2))}return parseFloat(a)||1};McxToolBar.prototype.addScaleValueToSettings=function(a){for(var b=this.getPreDefScaleData(),c=0;c<b.length;c++)if(a==b[c].value)return;b=this.getScaleValueArrayFromSettings();0>b.indexOf(a)&&b.push(a);this.setScaleValueToSettings(b)};
McxToolBar.prototype.removeScaleValueFromSettings=function(a){var b=this.getScaleValueArrayFromSettings();a=b.indexOf(a.toString());0<=a&&b.splice(a,1);this.setScaleValueToSettings(b)};McxToolBar.prototype.applyScale=function(a){this.map.setScale(1/parseFloat(a));this.map.getRenderer().paintLayer(null,null)};
McxToolBar.prototype.updateScaleCombo=function(a){this._scaleComboBox.clear();for(var b=this.getPreDefScaleData(),c=this.getScaleValueArrayFromSettings(),d=0;d<c.length;d++){var e=c[d];b.push({text:"1:"+e,value:e})}for(var f,c=0;c<b.length;c++)b[c].value==a&&(f=b[c]);a&&!f&&(f={text:"1:"+a,value:a},b.push(f));this._scaleComboBox.addItemRange(b);a&&(this._scaleComboBox.setSelectedItem(f),this._scaleComboBox.setText(f.text))};
McxToolBar.prototype.setMap=function(a){if(null!=this.map||null!=a)mcx.isDefAndNotNull(this.map)&&(this.map.getCRSChangedEventHandler().removeListener(this.setCoordinateSystemText),this.map.getScaleChangedEventHandler().removeListener(this.onScaleChange),this.map.getLayers().onLayerAdded().removeListener(this.updateLayerComboBox),this.map.getLayers().onLayerRemoved().removeListener(this.updateLayerComboBox)),this.map=a,this.map.getScaleChangedEventHandler().addListener(this.onScaleChange,null,this),
this.map.getLayers().onLayerAdded().addListener(this.updateLayerComboBox,null,this),this.map.getLayers().onLayerRemoved().addListener(this.updateLayerComboBox,null,this),this.updateLayerComboBox(),this._scaleComboBox.getOnSelectHandler().removeListener(this.onScaleSelect),this.updateScaleCombo(),this._scaleComboBox.getOnSelectHandler().addListener(this.onScaleSelect,null,this),this.setScaleComboText(this.map.getScale()),this.initCoordinateSystemTextBox(),this.map.getCRSChangedEventHandler().addListener(this.setCoordinateSystemText,
null,this),this.setCoordinateSystemText()};McxToolBar.prototype.setMapInteractionFactory=function(a){this.mapFactory=a};McxToolBar.prototype.updateLayerComboBox=function(){null!=this.layerSelectBox&&this.layerSelectBox.setLayerCollection(this.map.getLayers())};
McxToolBar.prototype.getPreDefScaleData=function(){return[{text:"1:1000",value:1E3,isPreDefined:!0},{text:"1:5000",value:5E3,isPreDefined:!0},{text:"1:10000",value:1E4,isPreDefined:!0},{text:"1:250000",value:25E4,isPreDefined:!0},{text:"1:500000",value:5E5,isPreDefined:!0},{text:"1:1000000",value:1E6,isPreDefined:!0}]};McxToolBar.prototype.initLayerSelectBox=function(){this.layerSelectBox=new McxLayerComboBox("layerSelectionContainer");this.layerSelectBox.initialize()};
McxToolBar.prototype.getContent=function(){0==mcx.isDefAndNotNull(this._content)&&(this._content=$("<div/>").attr("id",this.toolBarId).css("z-index",1002).css("margin","0px 150px 0px 50px").css("left",0).css("right",0).css("position","absolute").css("text-align","center").append('<div class="statusbar-mcxpanel hidden-phone"><div class="statusbar"><div class="statusbar_inner"><ul id="statusBarList">    <li id="DragTool" title="Pan" class="status-pan" data-localize="McxCommonControl-mcxToolBarPan"   data-localize-for="title"></li>   <li id="zoomAreaTool" title="Zoom" class="status-zoom" data-localize="McxCommonControl-mcxToolBarZoom"   data-localize-for="title"></li>    <li id="viewallbutton" title="View Entire Map" class="status-extent"    data-localize="McxCommonControl-mcxToolBarViewEntireMap" data-localize-for="title"></li>    <li id="InfoTool" title="Info" class="status-info"    data-localize="McxCommonControl-mcxToolBarInfo" data-localize-for="title"></li>    <li id="Printtool" title="Print Tool" class="status-print" data-localize="McxCommonControl-mcxToolBarPrint" data-localize-for="title"></li>    <li class="separator"></li>    <li id="SelectTool" title="Select" class="status-select" data-localize="McxCommonControl-mcxToolBarSelect"   data-localize-for="title"></li>   <li id="AreaSelection" title="Select on Active Layer" class="status-areaselection"   data-localize="McxCommonControl-mcxToolBarAreaSelect" data-localize-for="title"></li>   <li id="clearTool" title="Clear Selection" class="clear-selection" data-localize="McxCommonControl-mcxToolBarClearSelection"   data-localize-for="title"></li>   <li class="separator"></li>   <li id="CoordinateTool" title="Coordinate Tool" class="coordinate-status"   data-localize="McxCommonControl-mcxToolBarCoordinate" data-localize-for="title"></li>   <li id="measuretool" title="Measuring Tool" class="status-measure" data-localize="McxCommonControl-mcxToolBarMeasure"   data-localize-for="title"></li>   <li id="quickSearchTool" title="Quick Search" class="quick-search" data-localize="McxCommonControl-mcxToolQuickSearch"   data-localize-for="title"></li></ul><div id="layerSelectionContainer" class="hidden-phone"></div><div id="scale" class="scale  hidden-phone"></div><div id="toolBarChangeCoordinateSystem" title="Change units projection" style="margin:auto;  border: 1px solid #CCCCCC !important; margin: 2px 10px; padding-left:20px; vertical-align: middle; width:auto !important;"class="gc-icon gc-pointer gc-grid  hidden-phone"data-localize="McxCommonControl-mcxToolBarChangeUnitsProjection" data-localize-for="title">   <span id="coordinateSystemLabel">Local</span></div><div class="coordinates  hidden-phone">   <div title="Coordinate" id="coordinatesnum" data-localize="McxCommonControl-mcxToolBarJumpToCoordinates"   data-localize-for="title">       <input maxlength="554" style="display: none;" class="inline"/>       <div id="toolBarCoordinateLabel" class="omniedit">       </div>   </div></div></div></div></div>'));
return this._content};McxToolBar.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};js.framework.ui.McxCommonControl.VisibleRangeSetter={};js.framework.ui.McxCommonControl.VisibleRangeSetter.McxVisibleRangeSetter={};function McxVisibleRangeSetter(){mcx.base(this);this.base=this;this._maximumRangeSelectBox=this._appendToElement=null;this._isDisplayWithZoomRange=!1;this._minimumRangeSelectBox=null;this.init()}mcx.inherits(McxVisibleRangeSetter,McxUserControl);McxVisibleRangeSetter.prototype.init=function(){this.initUI()};
McxVisibleRangeSetter.prototype.getDefaultRanges=function(){return[{value:1E5,text:"1:100000"},{value:5E4,text:"1:50000"},{value:25E3,text:"1:25000"},{value:1E4,text:"1:10000"},{value:5E3,text:"1:5000"},{value:1E3,text:"1:1000"}]};
McxVisibleRangeSetter.prototype.initUI=function(){this._appendToElement=$("<div/>");var a=$("<span/>").attr("data-localize","McxCommonControl-mcxLayerPropertiesMinimum").html("Minimum"),b=$("<td/>"),c=new McxFancySelectBox;c.setTextGetter("text");c.setValueGetter("value");c.addItemRange(this.getDefaultRanges());c.getOnEnterKey().addListener(this.normalizeScale,null,{selectBox:c,scope:this});this.base.addChild(b,c);c.disable();var b=$("<tr/>").append($("<td/>").append(a)).append(b),d=$("<span/>").attr("data-localize",
"McxCommonControl-mcxLayerPropertiesMaximum").html("Maximum"),e=$("<td/>"),a=new McxFancySelectBox;a.setTextGetter("text");a.setValueGetter("value");a.addItemRange(this.getDefaultRanges());a.getOnEnterKey().addListener(this.normalizeScale,null,{selectBox:a,scope:this});this.base.addChild(e,a);a.disable();d=$("<tr/>").append($("<td/>").append(d)).append(e);b=$("<table/>").css("margin","auto").append(b).append(d);b=this.createRow().append(this.createSpan(12).append(b));this._appendToElement.append(b);
this._minimumRangeSelectBox=c;this._maximumRangeSelectBox=a};McxVisibleRangeSetter.prototype.getMinScale=function(){return this.getIsDisplayWithZoomRange()?parseFloat(this._minimumRangeSelectBox.getSelectedValue()):Number.MAX_VALUE};McxVisibleRangeSetter.prototype.convertScaleStringToNumber=function(a){for(a=a.replace(/\s+/g,"");0<=a.indexOf("1:")||0<=a.indexOf("1/");){var b=a.indexOf("1:");0<=b&&(a=a.substring(b+2));b=a.indexOf("1/");0<=b&&(a=a.substring(b+2))}return parseFloat(a)};
McxVisibleRangeSetter.prototype.normalizeScale=function(){var a=this.selectBox,b=a.getText(),b=this.scope.convertScaleStringToNumber(b),b=parseFloat(b)||1;a.addItem({value:b,text:"1:"+b});a.setSelectedValue(b)};McxVisibleRangeSetter.prototype.getMaxScale=function(){return this.getIsDisplayWithZoomRange()?parseFloat(this._maximumRangeSelectBox.getSelectedValue()):0};
McxVisibleRangeSetter.prototype.setMinScale=function(a){a=Math.round(1/a);this._minimumRangeSelectBox.containsValue(a)||this._minimumRangeSelectBox.addItem({value:a,text:"1:"+a});this._minimumRangeSelectBox.setValue(a)};McxVisibleRangeSetter.prototype.setMaxScale=function(a){a=Math.round(1/a);this._maximumRangeSelectBox.containsValue(a)||this._maximumRangeSelectBox.addItem({value:a,text:"1:"+Math.round(a)});this._maximumRangeSelectBox.setValue(a)};McxVisibleRangeSetter.prototype.createRow=function(){return $("<div/>").addClass("mcx-row-fluid")};
McxVisibleRangeSetter.prototype.createSpan=function(a){return $("<div/>").addClass("mcx-span"+a)};McxVisibleRangeSetter.prototype.getIsDisplayWithZoomRange=function(){return this._isDisplayWithZoomRange};McxVisibleRangeSetter.prototype.setIsDisplayWithZoomRange=function(a){(this._isDisplayWithZoomRange=a)?(this._maximumRangeSelectBox.enable(),this._minimumRangeSelectBox.enable()):(this._maximumRangeSelectBox.disable(),this._minimumRangeSelectBox.disable())};
McxVisibleRangeSetter.prototype.getContent=function(){return this._appendToElement};js.framework.ui.McxCommonControl.WebPageViewer={};js.framework.ui.McxCommonControl.WebPageViewer.McxWebPageViewer={};function McxWebPageViewer(){mcx.base(this);this.base=this;this._iframeElement=this._rootElement=null;this.initialize()}mcx.inherits(McxWebPageViewer,McxUserControl);
McxWebPageViewer.prototype.initialize=function(){this._rootElement=$("<div/>").css("width","100%").css("height","100%").addClass("");this._iframeElement=$("<iframe/>").css("width","100%").css("height","100%").css("border","none").addClass("");this._rootElement.append(this._iframeElement)};McxWebPageViewer.prototype.setWegPage=function(a){if(""==a||null==a)a="about:blank";this._iframeElement.attr("src",a)};McxWebPageViewer.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.Wizard={};js.framework.ui.McxCommonControl.Wizard.McxWizard={};
function McxWizard(){mcx.base(this);this.base=this;this._finishButton=this._nextButton=this._prevButton=this._buttonContainer=this._pageContainer=this._headerContainer=this._rootElement=null;this._pages=[];this._currentPageIndex=-1;this.initializeComponent=this.initializeComponent||mcx.abstractMethod;this.onLoad=this.onLoad||mcx.abstractMethod;this.onPageChange=this.onPageChange||mcx.abstractMethod;this.onFinish=this.onFinish||mcx.abstractMethod}mcx.inherits(McxWizard,McxUserControl);
McxWizard.prototype.initializeVerticalWizard=function(){this._rootElement=$("<div/>");this._pageContainer=$("<div/>");this._pageContainer.css("height","10px");this._pageContainer.addClass("wizard-content-panel");this._pageContainer.append("content panel");this._headerContainer=$("<div/>");this._headerContainer.css("height","10px");this._headerContainer.addClass("wizard-page-header-container");var a=new McxLayoutRow;a.createAndAddSpan(3,this._headerContainer);a.createAndAddSpan(9,this._pageContainer);
this.base.addChild(this._rootElement,a);this.createButtonPanel();this.initializeComponent();for(a=0;a<this._pages.length;a++)this._pages[a].initializeComponent(a,!0),this._pages[a].setAsDisabledPage(),this._pages[a].getHeaderContent().click({pageIndex:a},$.proxy(this.onHeaderButtonClick,this)).addClass("wizard-vertical-page-header"),this._headerContainer.append(this._pages[a].getHeaderContent());this._nextButton.removeAttr("disabled");this._pages[0].setEnabled(!0);this._pages[0].setAsActivePage();
this._pageContainer.html("");this._pageContainer.append(this._pages[0].getPageContent());this._pages[0].onCurrent();this._currentPageIndex=0;this.onLoad()};
McxWizard.prototype.initializeHorizontalWizard=function(){this._rootElement=$("<div/>");this._pageContainer=$("<div/>").css("height","300px").addClass("wizard-content-panel").append("content panel");this._headerContainer=$("<div/>").css("height","50px").css("display","inline-flex").addClass("wizard-page-header-container");this.base.addChild(this._rootElement,(new McxLayoutRow).createAndAddSpan(12,this._headerContainer));this.base.addChild(this._rootElement,(new McxLayoutRow).createAndAddSpan(12,this._pageContainer));
this.createButtonPanel();this.initializeComponent();for(var a=100/this._pages.length,b=0;b<this._pages.length;b++)this._pages[b].initializeComponent(b,!0),this._pages[b].setAsDisabledPage(),this._pages[b].getHeaderContent().click({pageIndex:b},$.proxy(this.onHeaderButtonClick,this)).css("width",a+"%").addClass(""),this._headerContainer.append(this._pages[b].getHeaderContent());this._nextButton.removeAttr("disabled");this._pages[0].setEnabled(!0);this._pages[0].setAsActivePage();this._pageContainer.html("");
this._pageContainer.append(this._pages[0].getPageContent());this._pages[0].onCurrent();this._currentPageIndex=0;this.onLoad()};
McxWizard.prototype.createButtonPanel=function(){this._prevButton=$("<button/>").click($.proxy(this.onPrevButtonClick,this)).html("\u00d6nceki").attr("disabled","disabled").addClass("mcx-input").addClass("wizard-button");this._nextButton=$("<button/>").click($.proxy(this.onNextButtonClick,this)).html("Sonraki").attr("disabled","disabled").addClass("mcx-input").addClass("wizard-button");this._finishButton=$("<button/>").click($.proxy(this.onFinishButtonClick,this)).html("Son").attr("disabled","disabled").addClass("mcx-input").addClass("wizard-button");
this._buttonContainer=$("<div/>").addClass("wizard-button-container").append(this._prevButton).append(this._nextButton).append(this._finishButton);var a=new McxLayoutRow;a.createAndAddSpan(12,this._buttonContainer);this.base.addChild(this._rootElement,a)};McxWizard.prototype.onPrevButtonClick=function(){this.changeWizardPage(this._currentPageIndex-1)};McxWizard.prototype.onNextButtonClick=function(){this.changeWizardPage(this._currentPageIndex+1)};McxWizard.prototype.onFinishButtonClick=function(){this.onFinish()};
McxWizard.prototype.onHeaderButtonClick=function(a){a=a.data.pageIndex;this._pages[a].getEnabled()&&this.changeWizardPage(a)};
McxWizard.prototype.changeWizardPage=function(a){this._pages[this._currentPageIndex].onLeave(a>this._currentPageIndex)&&(0==a?this._prevButton.attr("disabled","disabled"):this._prevButton.removeAttr("disabled"),a==this._pages.length-1?(this._nextButton.attr("disabled","disabled"),this._finishButton.removeAttr("disabled")):this._nextButton.removeAttr("disabled"),this._pages[this._currentPageIndex].setAsEnabledPage(),this._pages[a].setEnabled(!0),this._pages[a].setAsActivePage(),this._pageContainer.children().detach(),
this._pageContainer.append(this._pages[a].getPageContent()),this._pages[a].onCurrent(),this._currentPageIndex=a,this.onPageChange(a+1,this._pages[a].getPageName))};McxWizard.prototype.addPage=function(a){this._pages.push(a);a=60*this._pages.length+10;this._pageContainer.css("height",a);this._headerContainer.css("height",a)};McxWizard.prototype.getLocalizationPath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};McxWizard.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.Wizard.McxWizardPage={};function McxWizardPage(){mcx.base(this);this.base=this;this._isValidated=this._isEnabled=!1;this._pageIndex=-1;this._headerContent=null;this.onLeave=this.onLeave||mcx.abstractMethod;this.onCurrent=this.onCurrent||mcx.abstractMethod;this.getPageName=this.getPageName||mcx.abstractMethod;this.getPageTitle=this.getPageTitle||mcx.abstractMethod;this.getPageContent=this.getPageContent||mcx.abstractMethod}mcx.inherits(McxWizardPage,McxUserControl);
McxWizardPage.prototype.initializeComponent=function(a,b){this._headerContent=$("<div/>");if(b){var c=$("<label/>").addClass("wizard-page-header-number").append(a+1);this._headerContent.append(c)}c=$("<span/>").append(this.getPageTitle()).addClass("wizard-page-header-label");c=$("<span/>").addClass("wizard-page-header-text").append(this.getPageName()).append("<br>").append(c);this._headerContent.addClass(".wizard-page-header").append(c)};McxWizardPage.prototype.getHeaderContent=function(){return this._headerContent};
McxWizardPage.prototype.getEnabled=function(){return this._isEnabled};McxWizardPage.prototype.setAsEnabledPage=function(){this._headerContent.removeClass().addClass("wizard-page-header-enabled");this._isEnabled=!0};McxWizardPage.prototype.setAsDisabledPage=function(){this._headerContent.removeClass().addClass("wizard-page-header-disabled")};McxWizardPage.prototype.setAsActivePage=function(){this._headerContent.removeClass().addClass("wizard-page-header-active")};McxWizardPage.prototype.leave=function(){};
McxWizardPage.prototype.isValidated=function(){return this._isValidated};McxWizardPage.prototype.setEnabled=function(a){a?this.setAsEnabledPage():this.setAsDisabledPage();this._isEnabled=a};js.framework.ui.McxCommonControl.WorkspaceManagerView={};js.framework.ui.McxCommonControl.WorkspaceManagerView.McxGroupedWorkspaceView={};
function McxGroupedWorkspaceView(a){mcx.base(this);this.base=this;this._type=a;this._workspaceRange=this._groupedWorkspaceArray=this._groupButtonContainer=this._groupContainer=this._rootElement=null;this._workspaceInfoBoxListDataKey="workspaceInfoBoxList";this._workspaceInfoClickHandler=new McxEventHandler;this._workspaceInfoDeleteRequestHandler=new McxEventHandler;this._workspaceInfoRenameRequestHandler=new McxEventHandler;this._workspaceInfoShareRequestHandler=new McxEventHandler;this._workspaceInfoSetDefaultReqeustHandler=
new McxEventHandler;this._reportOpenButtonClickHandler=new McxEventHandler;this._reportSaveButtonClickHandler=new McxEventHandler;this.initialize()}mcx.inherits(McxGroupedWorkspaceView,McxUserControl);
McxGroupedWorkspaceView.prototype.initialize=function(){this._rootElement=$("<div/>").css("white-space","pre-line").addClass("");this._groupButtonContainer=$("<div/>").addClass("mcx-grouped-workspace-group-button-container");this._groupContainer=$("<div/>").addClass("mcx-grouped-workspace-group-container");this._type==McxGroupedWorkspaceViewType.Horizontal&&this._groupContainer.addClass("type-horizontal");this._rootElement.append(this._groupButtonContainer);this._rootElement.append(this._groupContainer)};
McxGroupedWorkspaceView.prototype.createUI=function(){var a=this;this._groupButtonContainer.empty();for(var b in this._groupedWorkspaceArray){var c=$("<div/>").addClass("mcx-button").addClass("state-danger").text(b).attr("data-localize",b).data(this._workspaceInfoBoxListDataKey,this._groupedWorkspaceArray[b]);c.click(function(){var b=$(this).data(a._workspaceInfoBoxListDataKey);a.base.detachChildrenOfType(McxWorkspaceInfoBox);a.base.detachChildrenOfType(McxReportInfoBox);for(var c in b)a.base.addChild(a._groupContainer,
b[c]);a._groupButtonContainer.find(".mcx-button.state-active").removeClass("state-active").addClass("state-danger");$(this).removeClass("state-danger").addClass("state-active")});this._groupButtonContainer.append(c)}var d=$("<div/>").addClass("mcx-grouped-workspace-type-button vertical");this._groupButtonContainer.append(d);d.click($.proxy(function(){this._groupContainer.toggleClass("type-horizontal");d.toggleClass("vertical")},this));this._groupButtonContainer.find(".mcx-button:first").click()};
McxGroupedWorkspaceView.prototype.setWorkspaceRange=function(a){var b=this;this._workspaceRange=a;this._groupedWorkspaceArray={};for(a=0;a<this._workspaceRange.length;a++){var c=new McxWorkspaceInfoBox;c.setWorkspaceInfo(this._workspaceRange[a]);c.getWorkspaceInfoClick().addListener(function(){b.getWorkspaceInfoClickHandler().dispatchOnSuccess(b,new McxWorkspaceInfoClickArgs(this.getWorkspaceInfo()))},null,c);c.getDeleteRequestEventHandler().addListener(function(){b.getWorkspaceInfoDeleteRequestHandler().dispatchOnSuccess(b,
new McxWorkspaceInfoClickArgs(this.getWorkspaceInfo()))},null,c);c.getRenameRequestEventHandler().addListener(function(){b.getWorkspaceInfoRenameRequestHandler().dispatchOnSuccess(b,new McxWorkspaceInfoClickArgs(this.getUpdateClone()))},null,c);c.getShareRequestEventHandler().addListener(function(){b.getWorkspaceInfoShareRequestHandler().dispatchOnSuccess(b,new McxWorkspaceInfoClickArgs(this.getWorkspaceInfo()))},null,c);c.getSetDefaultRequestEventHandler().addListener(function(){var a=this,c=a.getUpdateClone();
c.setIsDefault(!a.getWorkspaceInfo().isDefault());b.getWorkspaceInfoSetDefaultRequestHandler().dispatchOnSuccess(b,new McxWorkspaceInfoClickArgs(c));c.isDefault()&&c.getPropertyChangeHandler().addListener(function(){for(var c=0;c<b._workspaceRange.length;c++){var e=b._workspaceRange[c];a.getWorkspaceInfo().getId()!=e.getId()&&e.isDefault()&&e.setIsDefault(!1)}},null,this)},null,c);0==mcx.isDefAndNotNull(this._groupedWorkspaceArray[c.getGroupNameForWorkspace()])&&(this._groupedWorkspaceArray[c.getGroupNameForWorkspace()]=
[]);this._groupedWorkspaceArray[c.getGroupNameForWorkspace()].push(c)}this.createUI()};
McxGroupedWorkspaceView.prototype.setReportsRange=function(a){for(var b=this,c=0;c<a.length;c++){var d=new McxReportInfoBox(a[c]);d.getSaveButtonClickHandler().addListener(function(){b._reportSaveButtonClickHandler.dispatchOnSuccess(this,new McxEventArgs(this))},null,d);d.getOpenButtonClickHandler().addListener(function(){b._reportOpenButtonClickHandler.dispatchOnSuccess(this,new McxEventArgs(this.getReportName()))},null,d);0==mcx.isDefAndNotNull(this._groupedWorkspaceArray.reports)&&(this._groupedWorkspaceArray.reports=
[]);this._groupedWorkspaceArray.reports.push(d)}a=$("<div/>").addClass("mcx-button").addClass("state-danger").text("reports").attr("data-localize","McxCommonControl-ReportTitle").data("reportsDataKey",this._groupedWorkspaceArray.reports);a.click(function(){var a=b._groupedWorkspaceArray.reports;b._groupContainer.children().detach();for(var c=0;c<a.length;c++)b.base.addChild(b._groupContainer,a[c]);b._groupButtonContainer.find(".mcx-button.state-active").removeClass("state-active").addClass("state-danger");
$(this).removeClass("state-danger").addClass("state-active")});this._groupButtonContainer.append(a)};McxGroupedWorkspaceView.prototype.getWorkspaceInfoClickHandler=function(){return this._workspaceInfoClickHandler};McxGroupedWorkspaceView.prototype.getWorkspaceInfoDeleteRequestHandler=function(){return this._workspaceInfoDeleteRequestHandler};McxGroupedWorkspaceView.prototype.getWorkspaceInfoRenameRequestHandler=function(){return this._workspaceInfoRenameRequestHandler};
McxGroupedWorkspaceView.prototype.getWorkspaceInfoShareRequestHandler=function(){return this._workspaceInfoShareRequestHandler};McxGroupedWorkspaceView.prototype.getWorkspaceInfoSetDefaultRequestHandler=function(){return this._workspaceInfoSetDefaultReqeustHandler};McxGroupedWorkspaceView.prototype.getReportOpenButtonClickHandler=function(){return this._reportOpenButtonClickHandler};McxGroupedWorkspaceView.prototype.getReportSaveButtonClickHandler=function(){return this._reportSaveButtonClickHandler};
McxGroupedWorkspaceView.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.WorkspaceManagerView.McxGroupedWorkspaceViewType={};var McxGroupedWorkspaceViewType={Vertical:1,Horizontal:2};js.framework.ui.McxCommonControl.WorkspaceManagerView.McxReportInfoBox={};function McxReportInfoBox(a){mcx.base(this);this.base=this;this._reportSaveButton=this._reportOpenButton=this._reportButtonsContainer=this._reportNameLabel=this._reportImageElement=this._reportPreviewContainer=this._rootElement=null;this._reportName=a;this._onOpenButtonClickEventHandler=new McxEventHandler;this._onSaveButtonClickEventHandler=new McxEventHandler;this.initialize()}mcx.inherits(McxReportInfoBox,McxUserControl);
McxReportInfoBox.prototype.initialize=function(){this._rootElement=$("<div/>").addClass("mcx-report-info-box");this._reportPreviewContainer=$("<div/>").addClass("mcx-workspace-info-preview");this._reportImageElement=$("<div/>").addClass("mcx-workspace-info-image");this._reportNameLabel=$("<div/>").addClass("mcx-workspace-info-name-label");this._reportButtonsContainer=$("<div/>").addClass("mcx-report-info-button-container");this._reportOpenButton=$("<div/>").addClass("mcx-workspace-info-button").addClass("mcx-workspace-info-open-button");
this._reportOpenButton.click($.proxy(this.openButtonClick,this));this._reportSaveButton=$("<div/>").addClass("mcx-workspace-info-button").addClass("mcx-workspace-info-save-button");this._reportSaveButton.click($.proxy(this.saveButtonClick,this));this._reportButtonsContainer.append(this._reportOpenButton);this._reportButtonsContainer.append(this._reportSaveButton);this._reportPreviewContainer.append(this._reportImageElement);this._reportPreviewContainer.append(this._reportNameLabel);this._reportPreviewContainer.append(this._reportButtonsContainer);
this._reportNameLabel.text(this._reportName);this._reportImageElement.removeClass().addClass("mcx-workspace-info-image").addClass("mcx-default-report-image");this._rootElement.append(this._reportPreviewContainer)};McxReportInfoBox.prototype.openButtonClick=function(){this._onOpenButtonClickEventHandler.dispatchOnSuccess(this,null)};McxReportInfoBox.prototype.saveButtonClick=function(){this._onSaveButtonClickEventHandler.dispatchOnSuccess(this,null)};McxReportInfoBox.prototype.getReportName=function(){return this._reportName};
McxReportInfoBox.prototype.getOpenButtonClickHandler=function(){return this._onOpenButtonClickEventHandler};McxReportInfoBox.prototype.getSaveButtonClickHandler=function(){return this._onSaveButtonClickEventHandler};McxReportInfoBox.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.WorkspaceManagerView.McxUser={};function McxUser(a,b){this._displayName=a||"";this._image=b||"";this.token=this._userName="";this._isGroup=!1;this._id=-1;this._defaultWsId=null;this._nodeId=-1}McxUser.prototype.setDisplayName=function(a){this._displayName=a};McxUser.prototype.setId=function(a){this._id=a};McxUser.prototype.setImage=function(a){this._image=a};McxUser.prototype.setIsGroup=function(a){this._isGroup=a};
McxUser.prototype.setUserName=function(a){this._userName=a};McxUser.prototype.setDefaultWorkspaceId=function(a){this._defaultWsId=a};McxUser.prototype.getDefaultWorkspaceId=function(){return this._defaultWsId};McxUser.prototype.getDisplayName=function(){return mcx.isDefAndNotNull(this._displayName)&&""!=this._displayName?this._displayName:this._userName};McxUser.prototype.getImageUrl=function(){return this._image};McxUser.prototype.getId=function(){return this._id};McxUser.prototype.getIsGroup=function(){return this._isGroup};
McxUser.prototype.getUserName=function(){return this._userName};McxUser.prototype.setToken=function(a){this.token=a};McxUser.prototype.getToken=function(){return decodeURI(this.token)};McxUser.prototype.setNodeId=function(a){this._nodeId=a};McxUser.prototype.getNodeId=function(){return this._nodeId};js.framework.ui.McxCommonControl.WorkspaceManagerView.McxWorkspaceInfo={};function McxWorkspaceInfo(a,b,c,d,e,f){this._id=a||null;this._name=b||null;this._description=d||"";this._imageUrl=c||"";this._groupName=e||"";this._renameEventHandler=new McxEventHandler;this._isDefault=f||!1;this._owner=null;this._lastModifiedDate=this._creationDate="";this._bounds=null}McxWorkspaceInfo.prototype.getId=function(){return this._id};McxWorkspaceInfo.prototype.getName=function(){return this._name};
McxWorkspaceInfo.prototype.getDescription=function(){return this._description};McxWorkspaceInfo.prototype.getGroupName=function(){return this._groupName};McxWorkspaceInfo.prototype.getImage=function(){return this._imageUrl};McxWorkspaceInfo.prototype.isDefault=function(){return this._isDefault};McxWorkspaceInfo.prototype.getCreationDate=function(){return this._creationDate};McxWorkspaceInfo.prototype.getLastModifiedDate=function(){return this._lastModifiedDate};
McxWorkspaceInfo.prototype.getOwner=function(){return this._owner};McxWorkspaceInfo.prototype.setId=function(a){this._id=a};McxWorkspaceInfo.prototype.setName=function(a){this._name=a};McxWorkspaceInfo.prototype.setDescription=function(a){this._description=a};McxWorkspaceInfo.prototype.setGroupName=function(a){this._groupName=a};McxWorkspaceInfo.prototype.setImage=function(a){this._imageUrl=a};McxWorkspaceInfo.prototype.setIsDefault=function(a){this._isDefault=a};
McxWorkspaceInfo.prototype.setCreationDate=function(a){this._creationDate=a};McxWorkspaceInfo.prototype.setLastModifiedDate=function(a){this._lastModifiedDate=a};McxWorkspaceInfo.prototype.setOwner=function(a){this._owner=a};McxWorkspaceInfo.prototype.getPropertyChangeHandler=function(){return this._renameEventHandler};McxWorkspaceInfo.prototype.setOpeningBounds=function(a){this._bounds=a};McxWorkspaceInfo.prototype.getOpeningBounds=function(){return this._bounds};
McxWorkspaceInfo.prototype.clone=function(){var a=new McxWorkspaceInfo(this.getId(),this.getName(),this.getImage(),this.getDescription(),this.getGroupName(),this.isDefault());a.setCreationDate(this.getCreationDate());a.setLastModifiedDate(this.getLastModifiedDate());a.setOwner(this.getOwner());return a};js.framework.ui.McxCommonControl.WorkspaceManagerView.McxWorkspaceInfoBox={};
function McxWorkspaceInfoBox(){mcx.base(this);this.base=this;this._workspaceInfoDetailOwnerImage=this._workspaceInfoDetailOwnerLabel=this._workspaceInfoDetailModifiedDateLabel=this._workspaceInfoDetailCreationDateLabel=this._workspaceInfoDetailContainer=this._workspaceShareButton=this._workspaceDetailButton=this._workspaceRenameButton=this._workspaceDeleteButton=this._workspaceDefaultButton=this._workspaceButtonsContainer=this._workspaceNameInput=this._workspaceNameLabel=this._workspaceImageElement=
this._defaultWorkspaceCheckElement=this._workspacePreviewContainer=this._rootElement=null;this._setDefaultRequestEventHandler=new McxEventHandler;this._shareRequestEventHandler=new McxEventHandler;this._deleteRequestEventHandler=new McxEventHandler;this._renameRequestEventHandler=new McxEventHandler;this._workspaceInfoClickHandler=new McxEventHandler;this._groupByGetter="getGroupName";this._textGetter="getName";this._imageGetter="getImage";this._updateClone=this._workspaceInfo=null;this._defaultWorkspaceImageClass=
"mcx-default-workspace-image";this.initialize();this.bindEvents()}mcx.inherits(McxWorkspaceInfoBox,McxUserControl);
McxWorkspaceInfoBox.prototype.initialize=function(){this._rootElement=$("<div/>").addClass("mcx-workspace-info-box");this._defaultWorkspaceCheckElement=$("<div/>").addClass("mcx-workspace-info-box-default-check-element");this._workspacePreviewContainer=$("<div/>").addClass("mcx-workspace-info-preview");this._workspaceImageElement=$("<div/>").addClass("mcx-workspace-info-image");this._workspaceNameLabel=$("<div/>").addClass("mcx-workspace-info-name-label");this._workspaceNameInput=$("<input/>").attr("type",
"text").css("display","none").addClass("mcx-workspace-info-name-input");this._workspaceButtonsContainer=$("<div/>").addClass("mcx-workspace-info-button-container");this._workspaceDefaultButton=$("<div/>").attr("data-localize","McxApplication-DefaultWorkspace").attr("data-localize-for","title").addClass("mcx-workspace-info-button").addClass("mcx-workspace-info-default-button");this._workspaceDeleteButton=$("<div/>").attr("data-localize","McxApplication-DeleteWorkspace").attr("data-localize-for","title").addClass("mcx-workspace-info-button").addClass("mcx-workspace-info-delete-button");
this._workspaceRenameButton=$("<div/>").attr("data-localize","McxApplication-RenameWorkspace").attr("data-localize-for","title").addClass("mcx-workspace-info-button").addClass("mcx-workspace-info-rename-button");this._workspaceDetailButton=$("<div/>").attr("data-localize","McxApplication-Information").attr("data-localize-for","title").addClass("mcx-workspace-info-button").addClass("mcx-workspace-info-detail-button");this._workspaceShareButton=$("<div/>").attr("data-localize","McxApplication-ShareWorkspace").attr("data-localize-for",
"title").addClass("mcx-workspace-info-button").addClass("mcx-workspace-info-share-button");this._workspaceInfoDetailContainer=$("<div/>").addClass("mcx-workspace-info-detail-container");this._workspaceInfoDetailCreationDateLabel=$("<div/>").addClass("mcx-workspace-info-box-detail-item-value");this._workspaceInfoDetailModifiedDateLabel=$("<div/>").addClass("mcx-workspace-info-box-detail-item-value");this._workspaceInfoDetailOwnerLabel=$("<div/>").addClass("mcx-workspace-info-box-detail-item-value");
this._workspaceInfoDetailOwnerImage=$("<div/>").addClass("mcx-workspace-info-box-detail-item-image");var a=$("<div/>").addClass("mcx-workspace-info-box-detail-item").append($("<div/>").attr("data-localize","McxCommonControl-workspaceInfoCreationDate").text("Creation Date").addClass("mcx-workspace-info-box-detail-item-label")).append(this._workspaceInfoDetailCreationDateLabel),b=$("<div/>").addClass("mcx-workspace-info-box-detail-item").append($("<div/>").attr("data-localize","McxCommonControl-workspaceInfoModifiedDate").text("Modified Date").addClass("mcx-workspace-info-box-detail-item-label")).append(this._workspaceInfoDetailModifiedDateLabel),
c=$("<div/>").addClass("mcx-workspace-info-box-detail-item").append($("<div/>").attr("data-localize","McxCommonControl-workspaceInfoOwner").text("Owner").addClass("mcx-workspace-info-box-detail-item-label")).append(this._workspaceInfoDetailOwnerImage).append(this._workspaceInfoDetailOwnerLabel);this._workspaceInfoDetailContainer.append(a);this._workspaceInfoDetailContainer.append(b);this._workspaceInfoDetailContainer.append(c);this._workspacePreviewContainer.append(this._workspaceImageElement).append(this._workspaceNameLabel).append(this._workspaceNameInput);
this._workspaceButtonsContainer.append(this._workspaceRenameButton).append(this._workspaceDefaultButton).append(this._workspaceDeleteButton).append(this._workspaceShareButton).append(this._workspaceDetailButton);this._rootElement.append(this._workspaceInfoDetailContainer).append(this._defaultWorkspaceCheckElement).append(this._workspacePreviewContainer).append(this._workspaceButtonsContainer)};
McxWorkspaceInfoBox.prototype.bindEvents=function(){var a=this;this._workspaceDeleteButton.click($.proxy(this.onDeleteButtonClick,this));this._workspaceDefaultButton.click($.proxy(this.onDefaultButtonClick,this));this._workspaceRenameButton.mousedown($.proxy(this.onRenameButtonClick,this));this._workspaceDetailButton.click($.proxy(this.onDetailButtonClick,this));this._workspaceShareButton.click($.proxy(this.onShareButtonClick,this));this._workspaceNameLabel.dblclick($.proxy(this.onWorkspaceInfoClick,
this));this._workspaceImageElement.click($.proxy(this.onWorkspaceInfoClick,this));this._defaultWorkspaceCheckElement.click($.proxy(this.onWorkspaceInfoClick,this));this._workspaceNameInput.click(function(a){a.stopPropagation()});this._workspaceNameInput.keypress(function(b){a.onNameInputKeyPress(b.keyCode)});this._workspaceNameInput.blur(function(a){})};
McxWorkspaceInfoBox.prototype.updateLayout=function(){this._workspaceNameLabel.text(this.getTextForWorkspace());this._workspaceNameInput.val(this.getTextForWorkspace());var a=this.getImageForWorkspace();if("data:image/jpeg;base64,null"==a||""==a)a=this._defaultWorkspaceImageClass;a&&(-1<a.indexOf("http://")||-1<a.indexOf(".png")||-1<a.indexOf(".gif")||-1<a.indexOf(".jpg")?(a=-1<a.indexOf("?")?a+"&"+Date.now():a+"?"+Date.now(),this._workspaceImageElement.removeClass().addClass("mcx-workspace-info-image").css("background-image",
"url("+a+")"),$("<img/>").error($.proxy(function(){this._workspaceImageElement.css("background-image","").addClass(this._defaultWorkspaceImageClass)},this)).attr("src",a)):-1<a.indexOf("base64")?this._workspaceImageElement.removeClass().addClass("mcx-workspace-info-image").css("background-image","url("+a+")"):this._workspaceImageElement.removeClass().addClass("mcx-workspace-info-image").addClass(a));this._workspaceInfo.isDefault()?(this._rootElement.parent().find(".mcx-workspace-info-box.default").removeClass("default"),
this._rootElement.addClass("default")):this._rootElement.removeClass("default");mcx.isDefAndNotNull(this._workspaceInfo.getOwner())&&(this._workspaceInfoDetailCreationDateLabel.text(this._workspaceInfo.getCreationDate()),this._workspaceInfoDetailModifiedDateLabel.text(this._workspaceInfo.getLastModifiedDate()),this._workspaceInfoDetailOwnerLabel.text(this._workspaceInfo.getOwner().getDisplayName()),this._workspaceInfoDetailOwnerImage.css("background-image","url("+this._workspaceInfo.getOwner().getImageUrl()+
")"))};McxWorkspaceInfoBox.prototype.setWorkspaceInfo=function(a){mcx.isDefAndNotNull(this._workspaceInfo)&&this._workspaceInfo.getPropertyChangeHandler().removeListener(this.onWorkspaceUpdate);this._workspaceInfo=a;this._workspaceInfo.getPropertyChangeHandler().addListener(this.onWorkspaceUpdate,null,this);this.updateLayout()};McxWorkspaceInfoBox.prototype.getWorkspaceInfo=function(){return this._workspaceInfo};McxWorkspaceInfoBox.prototype.setTextGetter=function(a){this._textGetter=a};
McxWorkspaceInfoBox.prototype.setImageGetter=function(a){this._imageGetter=a};McxWorkspaceInfoBox.prototype.setGroupNameGetter=function(a){this._groupByGetter=a};McxWorkspaceInfoBox.prototype.onWorkspaceInfoClick=function(){this.getWorkspaceInfoClick().dispatchOnSuccess(this,null)};McxWorkspaceInfoBox.prototype.onDeleteButtonClick=function(){this.getDeleteRequestEventHandler().dispatchOnSuccess(this,null)};
McxWorkspaceInfoBox.prototype.onDefaultButtonClick=function(){this.getSetDefaultRequestEventHandler().dispatchOnSuccess(this,null)};McxWorkspaceInfoBox.prototype.onShareButtonClick=function(){this.getShareRequestEventHandler().dispatchOnSuccess(this,null)};McxWorkspaceInfoBox.prototype.toggleNameInputVisibility=function(){this._workspaceNameInput.is(":visible")?(this._workspaceNameLabel.show(),this._workspaceNameInput.hide()):(this._workspaceNameLabel.hide(),this._workspaceNameInput.show().focus())};
McxWorkspaceInfoBox.prototype.onRenameButtonClick=function(){this.toggleNameInputVisibility()};McxWorkspaceInfoBox.prototype.onDetailButtonClick=function(){this._workspaceInfoDetailContainer.toggleClass("on")};McxWorkspaceInfoBox.prototype.onNameInputKeyPress=function(a){a==McxKeyCode.enter?(this.toggleNameInputVisibility(),this.getRenameRequestEventHandler().dispatchOnSuccess(this,null)):a==McxKeyCode.escape&&this.toggleNameInputVisibility()};
McxWorkspaceInfoBox.prototype.getDeleteRequestEventHandler=function(){return this._deleteRequestEventHandler};McxWorkspaceInfoBox.prototype.getSetDefaultRequestEventHandler=function(){return this._setDefaultRequestEventHandler};McxWorkspaceInfoBox.prototype.getShareRequestEventHandler=function(){return this._shareRequestEventHandler};McxWorkspaceInfoBox.prototype.getRenameRequestEventHandler=function(){return this._renameRequestEventHandler};McxWorkspaceInfoBox.prototype.getWorkspaceInfoClick=function(){return this._workspaceInfoClickHandler};
McxWorkspaceInfoBox.prototype.getValueForWorkspace=function(a,b){if(0==mcx.isDefAndNotNull(a)||0==mcx.isDefAndNotNull(b))return null;if("function"==typeof b)return b.call(a);var c=a[b];return"function"==typeof c?c.call(a):c};McxWorkspaceInfoBox.prototype.getGroupNameForWorkspace=function(){return(this.getValueForWorkspace(this._workspaceInfo,this._groupByGetter)||"Public Workspaces").toString()};
McxWorkspaceInfoBox.prototype.getTextForWorkspace=function(){return(this.getValueForWorkspace(this._workspaceInfo,this._textGetter)||"Workspaces").toString()};McxWorkspaceInfoBox.prototype.getImageForWorkspace=function(){return(this.getValueForWorkspace(this._workspaceInfo,this._imageGetter)||"mcx-default-workspace-image").toString()};McxWorkspaceInfoBox.prototype.getContent=function(){return this._rootElement};McxWorkspaceInfoBox.prototype.onWorkspaceUpdate=function(){this.updateLayout()};
McxWorkspaceInfoBox.prototype.getUpdateClone=function(){this._updateClone=this._workspaceInfo.clone();this._updateClone.setName(this._workspaceNameInput.val().toString());this._updateClone.getPropertyChangeHandler().addListener(function(){this._workspaceInfo.setName(this._updateClone.getName());this._workspaceInfo.setIsDefault(this._updateClone.isDefault());this._workspaceInfo.setGroupName(this._updateClone.getGroupName());var a=this._updateClone.getImage();this._workspaceInfo.setImage(a);this.updateLayout()},
null,this);return this._updateClone};js.framework.ui.McxCommonControl.WorkspaceManagerView.McxWorkspaceInfoClickArgs={};function McxWorkspaceInfoClickArgs(a){mcx.base(this,[]);this._selectedItem=a}mcx.inherits(McxWorkspaceInfoClickArgs,McxEventArgs);McxWorkspaceInfoClickArgs.prototype.getWorkspaceInfo=function(){return this._selectedItem};js.framework.ui.McxCommonControl.WorkspaceManagerView.McxWorkspaceInfoGroupType={};var McxWorkspaceInfoGroupType={allWorkspaces:0,myWorkspaces:1,sharedWorkspaces:2,sharedWithMe:3};js.framework.ui.McxCommonControl.WorkspaceManagerView.McxWorkspaceManagerView={};function McxWorkspaceManagerView(){mcx.base(this);this.base=this;this._workspaceInfoArray=this._rootElement=null;this._workspaceInfoClickHandler=new McxEventHandler;this._groupedWorkspaceView=null;this.initialize()}mcx.inherits(McxWorkspaceManagerView,McxUserControl);
McxWorkspaceManagerView.prototype.initialize=function(){var a=McxButtonAuthorityHelper.instance.getButtonVisibility(McxButtonAuthorityType.WorkspaceViewTypeButton),b=McxGroupedWorkspaceViewType.Vertical;a||(b=McxGroupedWorkspaceViewType.Horizontal);this._rootElement=$("<div/>");this._groupedWorkspaceView=new McxGroupedWorkspaceView(b);this.base.addChild(this._rootElement,this._groupedWorkspaceView);this._workspaceInfoArray=[]};
McxWorkspaceManagerView.prototype.addWorkspaceInfoRange=function(a){this._workspaceInfoArray.push.apply(this._workspaceInfoArray,a);this._groupedWorkspaceView.setWorkspaceRange(a)};McxWorkspaceManagerView.prototype.addReportRange=function(a){this._groupedWorkspaceView.setReportsRange(a)};McxWorkspaceManagerView.prototype.setWorkspaceInfoRange=function(a){this._workspaceInfoArray=a;this._groupedWorkspaceView.setWorkspaceRange(a)};McxWorkspaceManagerView.prototype.getWorkspaceInfoClickHandler=function(){return this._groupedWorkspaceView.getWorkspaceInfoClickHandler()};
McxWorkspaceManagerView.prototype.getWorkspaceInfoDeleteRequestHandler=function(){return this._groupedWorkspaceView.getWorkspaceInfoDeleteRequestHandler()};McxWorkspaceManagerView.prototype.getWorkspaceInfoShareRequestHandler=function(){return this._groupedWorkspaceView.getWorkspaceInfoShareRequestHandler()};McxWorkspaceManagerView.prototype.getWorkspaceInfoSetDefaultRequestHandler=function(){return this._groupedWorkspaceView.getWorkspaceInfoSetDefaultRequestHandler()};
McxWorkspaceManagerView.prototype.getReportOpenButtonClickHandler=function(){return this._groupedWorkspaceView.getReportOpenButtonClickHandler()};McxWorkspaceManagerView.prototype.getReportSaveButtonClickHandler=function(){return this._groupedWorkspaceView.getReportSaveButtonClickHandler()};McxWorkspaceManagerView.prototype.getWorkspaceInfoRenameRequestHandler=function(){return this._groupedWorkspaceView.getWorkspaceInfoRenameRequestHandler()};McxWorkspaceManagerView.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonControl.ZoomControl={};js.framework.ui.McxCommonControl.ZoomControl.McxZoomControl={};
function McxZoomControl(a){mcx.base(this);this._rootElement=$("<div/>").addClass("mcx-crm-zoom-control");this._zoomInButton=$("<div/>").addClass("mcx-crm-zoom-control-button zoom-in").click($.proxy(this.zoomIn,this));this._zoomOutButton=$("<div/>").addClass("mcx-crm-zoom-control-button zoom-out").click($.proxy(this.zoomOut,this));this._panButton=$("<div/>").addClass("mcx-crm-zoom-control-button pan").click($.proxy(this.pan,this));this._map=null;this._mapInteractionFactory=a;this.initialize()}
mcx.inherits(McxZoomControl,McxUserControl);McxZoomControl.prototype.initialize=function(){this._rootElement.append(this._panButton).append(this._zoomInButton).append(this._zoomOutButton);this._zoomInButton.attr("data-localize-for","title").attr("data-localize","McxCommonControl-mcxToolBarZoom");this._zoomOutButton.attr("data-localize-for","title").attr("data-localize","McxCommonControl-ZoomOutButton");this._panButton.attr("data-localize-for","title").attr("data-localize","McxCommonControl-mcxToolBarPan")};
McxZoomControl.prototype.getContent=function(){return this._rootElement};McxZoomControl.prototype.setMap=function(a){this._map=a};McxZoomControl.prototype.zoomIn=function(){if(this._map){var a=this._map.getWorld(),b=a.getCentroid(),c=a.getWidth(),a=a.getHeight(),b=new McxBounds(b.getX()-c/4,b.getY()-a/4,b.getX()+c/4,b.getY()+a/4,this._map.getCoordinateSystem());this._map.setWorld(b.getLeft(),b.getBottom(),b.getRight(),b.getTop());b=this._map.getRenderer();b.clearBackBuffer();b.paintLayer(null,null)}};
McxZoomControl.prototype.zoomOut=function(){if(this._map){var a=this._map.getWorld(),b=a.getCentroid(),c=a.getWidth(),a=a.getHeight(),b=new McxBounds(b.getX()-1.4*c,b.getY()-1.4*a,b.getX()+1.4*c,b.getY()+1.4*a,this._map.getCoordinateSystem());this._map.setWorld(b.getLeft(),b.getBottom(),b.getRight(),b.getTop());b=this._map.getRenderer();b.clearBackBuffer();b.paintLayer(null,null)}};McxZoomControl.prototype.pan=function(){if(this._map){var a=this._mapInteractionFactory.createPanController();this._map.getInputHandler().setController(a)}};
js.framework.ui.McxCommonDialog={};js.framework.ui.McxCommonDialog.AddSelectedToDialog={};js.framework.ui.McxCommonDialog.AddSelectedToDialog.McxAddSelectedToDialog={};function McxAddSelectedToDialog(a){mcx.base(this);this.createMap=a;this._mapNameTextBox=this._layerNameTextBox=null;this.content=$("<div/>")}mcx.inherits(McxAddSelectedToDialog,McxDialogBase);McxAddSelectedToDialog.prototype.getDialogSize=function(){return McxDialogSize.small};
McxAddSelectedToDialog.prototype.creationComplete=function(){if(this.createMap){this._mapNameTextBox=new McxTextBox(McxTextBoxType.Text);var a=new McxLabeledEditor("Map",this._mapNameTextBox,"McxCommonDialog-mcxAddSelectedToDialogMapName",4);this.base.addChild(this.content,a)}this._layerNameTextBox=new McxTextBox(McxTextBoxType.Text);a=new McxLabeledEditor("Layer",this._layerNameTextBox,"McxCommonDialog-mcxAddSelectedToDialogLayerName",4);this.base.addChild(this.content,a)};
McxAddSelectedToDialog.prototype.getLayerAndMapName=function(){var a=this._layerNameTextBox.getValue(),b="";this.createMap&&(b=this._mapNameTextBox.getValue());return{layerName:a,mapName:b}};McxAddSelectedToDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxAddSelectedToDialog.prototype.getDialogTitle=function(){return"McxCommonDialog-mcxAddSelectedToDialogTitle"};McxAddSelectedToDialog.prototype.getContent=function(){return this.content};js.framework.ui.McxCommonDialog.ClusterMapDialog={};js.framework.ui.McxCommonDialog.ClusterMapDialog.McxClusterMapDialog={};function McxClusterMapDialog(){mcx.base(this);this.base=this;this._layerComboBox=new McxLayerComboBox;this._radiusNumberBox=new McxNumberBox(0,Number.MAX_VALUE,2);this._layerModeSelectBox=new McxSelectBox;this._layerNameTextBox=new McxTextBox(McxTextBoxType.Text);this._layers=[];this._content=null}mcx.inherits(McxClusterMapDialog,McxDialogBase);
McxClusterMapDialog.prototype.initialize=function(){this.initializeContent()};McxClusterMapDialog.prototype.getDialogTitle=function(){return"McxCommonDialog-heatMapDialogTitle"};McxClusterMapDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxClusterMapDialog.prototype.setLayers=function(a){this._layers=a.toLayerArray();this._layerComboBox.initialize();this._layerComboBox.setLayerCollection(a)};
McxClusterMapDialog.prototype.initializeContent=function(){this._content=$("<div/>").addClass("");var a=new McxLayoutRow,b=new McxLabeledEditor("McxCommonDialog-heatMapDialogLayerNameLabel",this._layerNameTextBox);b.setLabelLocalizationKey("McxCommonDialog-heatMapDialogLayerNameLabel");a.createAndAddSpan(12,b);this.base.addChild(this._content,a);a=new McxLayoutRow;b=new McxLabeledEditor("McxCommonDialog-Layer",this._layerComboBox);b.setLabelLocalizationKey("McxCommonDialog-Layer");a.createAndAddSpan(12,
b);this.base.addChild(this._content,a);a=new McxLayoutRow;this._layerModeSelectBox.setTextGetter("text");this._layerModeSelectBox.setValueGetter("value");this._layerModeSelectBox.setIsLocalizable(!0);this._layerModeSelectBox.addItemRange([{text:"McxCommonDialog-heatMapAutoDrawMode",value:!1},{text:"McxCommonDialog-heatMapSingleTileDrawMode",value:!0}]);this._layerModeSelectBox.setSelectedValue(!0);b=new McxLabeledEditor("McxCommonDialog-heatMapDialogDrawModeLabel",this._layerModeSelectBox);b.setLabelLocalizationKey("McxCommonDialog-heatMapDialogDrawModeLabel");
a.createAndAddSpan(12,b);this.base.addChild(this._content,a);a=new McxLayoutRow;this._radiusNumberBox.getContent().css("margin-left","2px");this._radiusNumberBox.setValue(100);b=new McxLabeledEditor("McxCommonDialog-Radius",this._radiusNumberBox);b.setLabelLocalizationKey("McxCommonDialog-Radius");a.createAndAddSpan(12,b);this.base.addChild(this._content,a)};
McxClusterMapDialog.prototype.numberFieldFilter=function(a){return a.getFieldType()==McxDataType.Byte||a.getFieldType()==McxDataType.Double||a.getFieldType()==McxDataType.Float||a.getFieldType()==McxDataType.Int32||a.getFieldType()==McxDataType.Int64||a.getFieldType()==McxDataType.Int16};McxClusterMapDialog.prototype.creationComplete=function(){McxLocalizationManager.localizeContent(this.getContent())};McxClusterMapDialog.prototype.getSelectedLayer=function(){return this._layerComboBox.getSelectedLayer()};
McxClusterMapDialog.prototype.getRadius=function(){return this._radiusNumberBox.getValue()};McxClusterMapDialog.prototype.getLayerName=function(){return this._layerNameTextBox.getValue()};McxClusterMapDialog.prototype.getIsSingleTile=function(){var a=this._layerModeSelectBox.getSelectedItem();return a&&a.value?!0:!1};McxClusterMapDialog.prototype.getContent=function(){return this._content};McxClusterMapDialog.prototype.getIsSingleInstance=function(){return!0};js.framework.ui.McxCommonDialog.CoordinateCreatorDialog={};js.framework.ui.McxCommonDialog.CoordinateCreatorDialog.McxCoordinateCreatorDialog={};function McxCoordinateCreatorDialog(a,b){mcx.base(this);this._coordinateCreatorControl=new McxCoordinateCreator(a,b);this._rootElement=$("<div/>");this.base=this;this._map=a;this.pointSymbolizer=new McxPointSymbolizer;this.markerGuid="78AA01F5-B84B-4480-AA5E-CA3B2F621937"}mcx.inherits(McxCoordinateCreatorDialog,McxDialogBase);
McxCoordinateCreatorDialog.prototype.createMarker=function(){this._map.getMarkerCollection().removeWithGuid(this.markerGuid);var a=new McxPointMarker(this.getCoordinate(),this.markerGuid);a.setSymbolizer(this.pointSymbolizer);this._map.getMarkerCollection().add(a);this._map.getRenderer().paintNonLayer()};McxCoordinateCreatorDialog.prototype.onCoordinateChange=function(){this.createMarker()};
McxCoordinateCreatorDialog.prototype.initialize=function(){this.base.addChild(this._rootElement,this._coordinateCreatorControl);this._coordinateCreatorControl.getCoordinateCreateHandler().addListener(this.onCoordinateChange,null,this);var a=new McxCrossMark,b=new McxStroke;b.setColor("red");b.setWidth(2);var c=new McxFill;c.setColor("red");a.setStroke(b);a.setFill(c);this.pointSymbolizer.setSymbols([a]);this.pointSymbolizer.getAnchorPoint().setAnchorPointY(.5);this.createMarker()};
McxCoordinateCreatorDialog.prototype.getDialogSize=function(){return McxDialogSize.small};McxCoordinateCreatorDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxCoordinateCreatorDialog.prototype.getDialogTitle=function(){return"McxCommonDialog-PointEditor"};McxCoordinateCreatorDialog.prototype.getContent=function(){return this._rootElement};McxCoordinateCreatorDialog.prototype.getCoordinate=function(){return this._coordinateCreatorControl.getCoordinate()};
McxCoordinateCreatorDialog.prototype.getCoordinateCreateHandler=function(){return this._coordinateCreatorControl.getCoordinateCreateHandler()};McxCoordinateCreatorDialog.prototype.onCloseButtonClick=function(){McxCoordinateCreatorDialog.superClass_.onCloseButtonClick.call(this);this._map.getMarkerCollection().removeWithGuid(this.markerGuid);this._map.getRenderer().paintNonLayer()};
McxCoordinateCreatorDialog.prototype.onOkButtonClick=function(){McxCoordinateCreatorDialog.superClass_.onOkButtonClick.call(this);this._map.getMarkerCollection().removeWithGuid(this.markerGuid);this._map.getRenderer().paintNonLayer()};js.framework.ui.McxCommonDialog.CoordinateSystemDialog={};js.framework.ui.McxCommonDialog.CoordinateSystemDialog.McxCoordinateSystemDialog={};
function McxCoordinateSystemDialog(a){mcx.base(this);this.dataGrid=new McxDataGrid;this._previewLabel=this.content=null;this.base=this;this.searchTextBox=this.nameRadio=this.epsgRadio=null;this._codeColumn=(new McxStringColumn("Code","McxCommonDialog-mcxCoordinateSystemDialogCODE_")).bindField("Code");this._nameColumn=(new McxStringColumn("Name","McxCommonDialog-mcxCoordinateSystemDialogNAME")).bindField("Name");this.coordinateSystemDefinitions=a}mcx.inherits(McxCoordinateSystemDialog,McxDialogBase);
McxCoordinateSystemDialog.prototype.initialize=function(){var a=$("<textarea/>").addClass("mcxdatagrid-editable-input").attr("id","textBoxArea").css("resize","none").css("width","98%"),b=$('<div id="mcxCoordinateSystemDialogGrid"></div>'),a=$('<div class="mcx-row-fluid"><div class="mcx-span12"><div id="textBoxSearchArea" style="margin-top: 10px">'+a[0].outerHTML+"</div></div></div>"),c=new McxLayoutRow;c.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center);this.epsgRadio=new McxRadioButton;this.epsgRadio.checked(!0);
this.epsgRadio.setName("searchRadio");this.epsgRadio.setText("McxCommonDialog-mcxCoordinateSystemDialogEpsg");this.epsgRadio.getContent().find("input").css("vertical-align","top");c.createAndAddSpan(4,this.epsgRadio);this.nameRadio=new McxRadioButton;this.nameRadio.setName("searchRadio");this.nameRadio.setText("McxCommonDialog-mcxCoordinateSystemDialogName");this.nameRadio.getContent().find("input").css("vertical-align","top");c.createAndAddSpan(2,this.nameRadio);this.searchTextBox=new McxTextBox(McxTextBoxType.Text);
this.searchTextBox.setWidth("90%");c.createAndAddSpan(6,this.searchTextBox);var d=new McxGroupBox("");d.setLocalizationKeyForTitle("McxCommonDialog-mcxCoordinateSystemDialogSearch");this._previewLabel=$("<div/>").append(c.getContent());d.addContent(this._previewLabel);c=new McxLayoutRow;c.createAndAddSpan(12,d.getContent());this.content=$("<div/>").append(b).append(b.clone().attr("id","xyz")).append(b.clone().attr("id","textT")).append(a).append(c.getContent())};
McxCoordinateSystemDialog.prototype.getDialogSize=function(){return McxDialogSize.large};McxCoordinateSystemDialog.prototype.rowClick=function(a){a=this.dataGrid.getSelectedItem();if(!a)return null;a=a.Proj4;$("#textBoxArea").val(a)};
McxCoordinateSystemDialog.prototype.creationComplete=function(){var a=this;this.base.addChild($("#mcxCoordinateSystemDialogGrid"),this.dataGrid);this.dataGrid.fitColumns();var b=this._codeColumn;this.dataGrid.addColumn(this._codeColumn);this.dataGrid.addColumn(this._nameColumn);this.dataGrid.addColumn((new McxStringColumn("Proj4","McxCommonDialog-mcxCoordinateSystemDialogPROJ4")).bindField("Proj4"));this.dataGrid.setHeight(300);this.dataGrid.setDataSource(new McxDataGridArrayDataSource(this.coordinateSystemDefinitions));
this.dataGrid.getRowSelectHandler().addListener(this.rowClick,null,this);this.epsgRadio.onChangeHandler().addListener(function(){b=this._codeColumn},null,this);this.nameRadio.onChangeHandler().addListener(function(){b=this._nameColumn},null,this);this.searchTextBox.getKeyPressHandler().addListener(function(){var c=this.searchTextBox.getValue();if(1<=c.length){var d=new McxDataGridFilterBuilder;d.addFilter(new McxDataGridColumnFilter(b,b==this._codeColumn?parseFloat(c):c));a.dataGrid.getGridDataSource().setFilter(d);
a.localize()}else""==c&&(a.dataGrid.getGridDataSource().setFilter(null),a.localize())},null,this)};McxCoordinateSystemDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxCoordinateSystemDialog.prototype.getDialogTitle=function(){return"McxCommonDialog-mcxCoordinateSystemDialogTitle"};McxCoordinateSystemDialog.prototype.getContent=function(){return this.content};McxCoordinateSystemDialog.prototype.getDialogImageUrl=function(){return"$McxCommonDialog/assets/img/defaultDialogImage16.png"};
McxCoordinateSystemDialog.prototype.getCoordinateSystem=function(){var a=this.dataGrid.getSelectedItem();if(!a)return null;a=parseInt(a.Code,10);return 0==a?null:McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(a)};js.framework.ui.McxCommonDialog.DataSourceListDialog={};js.framework.ui.McxCommonDialog.DataSourceListDialog.IMcxDataSourceListDialog={};function IMcxDataSourceListDialog(){}IMcxDataSourceListDialog.prototype.getDataSource=function(){};IMcxDataSourceListDialog.prototype.getUrlHistoryArray=function(){};IMcxDataSourceListDialog.prototype.getSelectedLayerNames=function(){};IMcxDataSourceListDialog.prototype.getUrl=function(a,b){};IMcxDataSourceListDialog.prototype.getDataSourceUrl=function(){};js.framework.ui.McxCommonDialog.DataSourceListDialog.McxDataSourceLayerListControl={};function McxDataSourceLayerListControl(a,b){mcx.base(this);this.base=this;this._rootElement=$("<div/>").addClass("mcx-data-source-layer-list");this._layerListElem=new McxListBox;this.layerArray=a;this.dataSourceName=b;this._accordionControl=new McxAccordionContentDisplayer(b);this.initialize()}mcx.inherits(McxDataSourceLayerListControl,McxUserControl);
McxDataSourceLayerListControl.prototype.initialize=function(){this._accordionControl.addContent(this._layerListElem);this._accordionControl.getContent().find(".mcx-button").css({padding:"2px","font-size":"12px"});this._accordionControl.hideButtons();this._accordionControl.hideContent();this._accordionControl.setIsFloating(!1);this.base.addChild(this._rootElement,this._accordionControl);this._layerListElem.setMultiSelect(!0);for(var a=0;a<this.layerArray.length;a++)this._layerListElem.addItem(new McxKeyValuePair(this.layerArray[a],
this.layerArray[a]));8>this._layerListElem.getItems().length?this._layerListElem.fitHeightToOptionsLength():this._layerListElem.setVisibleItemCount(8);this._layerListElem.deselectAll()};McxDataSourceLayerListControl.prototype.getSelectedLayers=function(){for(var a=this._layerListElem.getSelectedItems(),b=[],c=0;c<a.length;c++){var d=a[c];mcx.isInstanceOf(d,McxKeyValuePair)&&(b[b.length]=d.getValue())}return b};McxDataSourceLayerListControl.prototype.showList=function(){this._accordionControl.showContent()};
McxDataSourceLayerListControl.prototype.getContent=function(){return this._rootElement};js.framework.ui.McxCommonDialog.DataSourceListDialog.McxDataSourceListDialog={};
function McxDataSourceListDialog(a,b){mcx.base(this);this.base=this;this._urlHistoryList=a;this._openRequestList=[];this._url=this._password=this._userName=this._credentials="";this._layerListItems=[];this._title=b;this._content=$("<div/>");this._driver=new McxFsDriver;this._driverType=McxDriverType.Feature;this._authenticationControl=new McxOpenDataSourceControl;this._getDataSourceButton=new McxButton;this._listContainer=$("<div/>").css("border-top","1px dashed #2e80aa").css("padding-top","5px").addClass("");
this._dataSouceListControl=this._dataSource=null}mcx.inherits(McxDataSourceListDialog,McxDialogBase);
McxDataSourceListDialog.prototype.initialize=function(){this._authenticationControl.setComboBoxHistory(this._urlHistoryList);this._getDataSourceButton.setText("Get Data Source");this._getDataSourceButton.setLocalizationKey("McxCommonDialog-mcxDataSourceDialogGetSource");this.base.addChild(this._content,this._authenticationControl);this.base.addFooterButton(this._getDataSourceButton);this._content.append(this._listContainer);this._getDataSourceButton.getClickHandler().addListener(this.onGetDataSourceButtonClick,
null,this);this.base.setOkButtonText("Add Layer(s)","McxCommonDialog-mcxDataSourceListDialogAddLayers");this.base.disableOkButton();this._dataSouceListControl=new McxDataSourceListControl};McxDataSourceListDialog.prototype.getDialogButtons=function(){return McxDialogButtons.ok};
McxDataSourceListDialog.prototype.onGetDataSourceButtonClick=function(){this.disableGetButton();this.base.disableOkButton();var a=this._authenticationControl.getDataSourceUri(),b=this._authenticationControl.getUserName(),c=this._authenticationControl.getPassword(),d="";""!=b&&""!=c&&(d=b+";"+c);this.getDataSources(d,a)};McxDataSourceListDialog.prototype.onClose=function(){this.cancelRequests()};McxDataSourceListDialog.prototype.getIsSingleInstance=function(){return!0};
McxDataSourceListDialog.prototype.getDialogSize=function(){return McxDialogSize.large};McxDataSourceListDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxDataSourceListDialog.prototype.getDialogTitle=function(){return this._title};McxDataSourceListDialog.prototype.disableGetButton=function(){this.base.setAsBusy();this._getDataSourceButton.setButtonState(McxButtonState.disabled)};
McxDataSourceListDialog.prototype.enableGetButton=function(){this.base.setAsIdle();this._getDataSourceButton.setButtonState(McxButtonState.active)};
McxDataSourceListDialog.prototype.getDataSources=function(a,b){this._authenticationControl.addDataToHistory(b);this._credentials=mcx.cry(a);this._url=b;this.enableGetButton();var c=new McxAjaxParameter;c.setParameters(this,function(a){a=a.getDataSourceNames();this._dataSouceListControl.clear();for(var c=0;c<a.length;c++){var f=this.getUrl(a[c],b),g=this._driver.openDataSource(f).getDataSource();this._dataSouceListControl.addDataSourceItem(a[c],{dataSourceName:a[c],driver:this._driver,source:f,dataSource:g})}this._listContainer.append(this._dataSouceListControl.getContent());
this.base.enableOkButton()},function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxCommonDialog-DataSourceGetError"),McxMessageBoxType.Error);this.base.setAsIdle()});this._driverType==McxDriverType.ArcGisTile||this._driverType==McxDriverType.ArcGisRest?(this._credentials=a,this._driver.getDataSourceInfo(b,a,c)):this._driver.getDataSourceInfo(b+"/REST/JSON/",this._credentials,c)};
McxDataSourceListDialog.prototype.cancelRequests=function(){for(var a=0;a<this._openRequestList.length;a++)this._openRequestList[a].abort();this._openRequestList=[]};McxDataSourceListDialog.prototype.getComboBoxData=function(){return this._authenticationControl.getHistoryAsArray()};McxDataSourceListDialog.prototype.getUrlHistoryArray=function(){return this._authenticationControl.getHistoryAsArray()};McxDataSourceListDialog.prototype.getSelectedLayerNames=function(){return this._dataSouceListControl.getSelectedLayers()};
McxDataSourceListDialog.prototype.setCredentialsDisabled=function(){this._authenticationControl.setCredentialsDisabled()};McxDataSourceListDialog.prototype.getDataSourceUrl=function(){return this._authenticationControl.getDataSourceUri()};McxDataSourceListDialog.prototype.getContent=function(){return this._content};
McxDataSourceListDialog.prototype.getUrl=function(a,b){switch(this._driverType){case McxDriverType.Feature:return"MFS@REST@"+this._credentials+"@"+a+"@"+b;case McxDriverType.Tile:return"MTS@REST@"+this._credentials+"@"+a+"@"+b;case McxDriverType.Raster:return"MMS@REST@"+this._credentials+"@"+a+"@"+b;case McxDriverType.ArcGisRest:return"AGS@REST@"+this._credentials+"@"+b;case McxDriverType.ArcGisTile:return"ATCS@REST@"+this._credentials+"@"+b}return""};
McxDataSourceListDialog.prototype.setCanCredentialsDisabled=function(a){this._authenticationControl.canCredentialsDisabled(a)};McxDataSourceListDialog.prototype.getDataSource=function(){return this._dataSource};
McxDataSourceListDialog.prototype.setDriverType=function(a){this._driverType=a;switch(a){case McxDriverType.Feature:this._driver=new McxFsDriver;break;case McxDriverType.Tile:this._driver=new McxTileDriver;break;case McxDriverType.Raster:this._driver=new McxTileDriver;break;case McxDriverType.ArcGisRest:this._driver=new McxArcGisDriver;break;case McxDriverType.ArcGisTile:this._driver=new McxArcGisTileCacheDriver}};js.framework.ui.McxCommonDialog.DataSourceListDialog.McxDriverType={};var McxDriverType={Feature:0,Tile:1,Raster:2,WMS:3,ArcGisRest:4,ArcGisTile:5,WMTS:6};js.framework.ui.McxCommonDialog.DataSourceListDialog.McxSelectedDataSourceInfo={};function McxSelectedDataSourceInfo(a,b){this._dataSourceName=a;this._layerNameList=b}McxSelectedDataSourceInfo.prototype.getLayerNameList=function(){return this._layerNameList};McxSelectedDataSourceInfo.prototype.getDataSourceName=function(){return this._dataSourceName};js.framework.ui.McxCommonDialog.DataSourceListDialog.McxWmsDataListDialog={};
function McxWmsDataListDialog(a,b){mcx.base(this);this._title=b;this._urlHistoryList=a;this._url="";this.base=this;this._openRequestList=[];this._content=$("<div/>");this._dataSourceCombo=new McxComboBox;this._layerListItems=[];this._driverType=McxDriverType.WMS;this._wmsVersionCombo=new McxSelectBox;this._tileOption="TILED";this._driver=new McxOgcDriver;this._getDataSourceButton=new McxButton;this._listContainer=$("<div/>");this._wmsVersionObject=[];this._wmsTileOptionObject=[]}
mcx.inherits(McxWmsDataListDialog,McxDialogBase);
McxWmsDataListDialog.prototype.initialize=function(){this._dataSourceCombo.setTextGetter("text");this._dataSourceCombo.setValueGetter("value");this._dataSourceCombo.addEmptyItem("");this.setComboBoxHistory(this._urlHistoryList);this._getDataSourceButton.setText("Get Data Source");this._getDataSourceButton.setLocalizationKey("McxCommonDialog-mcxDataSourceDialogGetSource");this._getDataSourceButton.getClickHandler().addListener(this.onGetDataSourceButtonClick,null,this);this.base.setOkButtonText("Add Layer(s)",
"McxCommonDialog-mcxDataSourceListDialogAddLayers");this.base.disableOkButton();this._wmsVersionObject=[{text:"1.3.0",value:"1.3.0"},{text:"1.1.1",value:"1.1.1"}];this._wmsVersionCombo.setTextGetter("text");this._wmsVersionCombo.setValueGetter("value");this._wmsVersionCombo.addItemRange(this._wmsVersionObject);var a=new McxLabeledEditor("Data Source",this._dataSourceCombo);a.setLabelLocalizationKey("McxCommonDialog-mcxDataSourceListDialogDataSource");var b=new McxLabeledEditor("Wms Version",this._wmsVersionCombo);
b.setLabelLocalizationKey("McxCommonDialog-mcxDataSourceDialogWnsVersion");this.base.addChild(this._content,a);this.base.addChild(this._content,b);this.base.addFooterButton(this._getDataSourceButton);this._content.append(this._listContainer)};McxWmsDataListDialog.prototype.onGetDataSourceButtonClick=function(){this.disableGetButton();var a=this._dataSourceCombo.getText();"?"===a.substr(-1)&&(a=a.substring(0,a.length-1));this.getDataSources(a)};
McxWmsDataListDialog.prototype.getDataSources=function(a){this.setAsBusy();this.cancelRequests();this.base.disableOkButton();this.addDataToHistory(a);this._driver.setTileOption(!0);this._driver.setWmsversion(this._wmsVersionCombo.getSelectedValue());var b=new McxAjaxParameter;b.setAsync(!1);var c=this.getUrl("",a);(new McxAjaxParameter).setAsync(!1);this._dataSource=this._driver.openDataSource(c).getDataSource();b=this._driver.getDataSourceInfo(a,"",b).getDataSourceNames();this._url=a;this.base.detachChildrenOfType(McxDataSourceLayerListControl);
this._listContainer.empty();for(a=0;a<b.length;a++)c=b[a],c="WMS",this.getServerLayer(c)};McxWmsDataListDialog.prototype.getDialogTitle=function(){return this._title};McxWmsDataListDialog.prototype.getContent=function(){return this._content};McxWmsDataListDialog.prototype.getDialogSize=function(){return McxDialogSize.medium};
McxWmsDataListDialog.prototype.getServerLayer=function(a){var b=new McxAjaxParameter;b.setArgs(new McxEventArgs(a));b.setParameters(this,function(a){var b=a.getRequest(),b=this._openRequestList.indexOf(b);-1<b&&this._openRequestList.splice(b,1);0==this._openRequestList.length&&(this.enableGetButton(),this.base.setAsIdle());b=a.getLayerNames();a=a.getArgs().getArgs();b=new McxDataSourceLayerListControl(b,a);b.showList();this._layerListItems[a]=b;this.base.addChild(this._listContainer,b);this.base.enableOkButton()},
function(){this.enableGetButton();this.base.setAsIdle()});a=this._driver.getLayerInfo(this._url,a,"",b);this._openRequestList[this._openRequestList.length]=a.getRequest()};McxWmsDataListDialog.prototype.getUrlHistoryArray=function(){return this.getHistoryAsArray()};McxWmsDataListDialog.prototype.getUrl=function(a,b){return"WMS@REST@credentials=@WMS@"+b+"@"+this._wmsVersionCombo.getSelectedValue()+"@"+this._tileOption};McxWmsDataListDialog.prototype.disableGetButton=function(){this.setAsBusy();this._getDataSourceButton.setButtonState(McxButtonState.disabled)};
McxWmsDataListDialog.prototype.enableGetButton=function(){this.setAsIdle();this._getDataSourceButton.setButtonState(McxButtonState.active)};McxWmsDataListDialog.prototype.getDataSource=function(){return this._dataSource};McxWmsDataListDialog.prototype.getSelectedLayerNames=function(){for(var a=this.base.getChildrenOfType(McxDataSourceLayerListControl),b=[],c=0;c<a.length;c++)b=b.concat(a[c].getSelectedLayers());a={};a.layers=b;a.driver=this._driver;a.source=this._dataSource.getSource();return[a]};
McxWmsDataListDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxWmsDataListDialog.prototype.cancelRequests=function(){for(var a=0;a<this._openRequestList.length;a++)this._openRequestList[a].abort();this._openRequestList=[]};McxWmsDataListDialog.prototype.getDataSourceUrl=function(){var a=this._dataSourceCombo.getSelectedValue();"?"===a.substr(-1)&&(a=a.substring(0,a.length-1));return a};
McxWmsDataListDialog.prototype.setComboBoxHistory=function(a){this._dataSourceCombo.clear();for(var b=[],c=0;c<a.length;c++)b.push({text:a[c],value:a[c]});this._dataSourceCombo.addItemRange(b)};McxWmsDataListDialog.prototype.getHistoryAsArray=function(){for(var a=this._dataSourceCombo.getItems(),b=[],c=0;c<a.length;c++)a[c].value&&""!=a[c].value.toString()&&b.push(a[c].value.toString());return b};
McxWmsDataListDialog.prototype.addDataToHistory=function(a){for(var b=this._dataSourceCombo.getItems(),c=!1,d=0;d<b.length;d++)b[d].value==a&&(c=!0);c||this._dataSourceCombo.addItemRange([{text:a,value:a}])};js.framework.ui.McxCommonDialog.DataSourceListDialog.McxWmtsDataListDialog={};function McxWmtsDataListDialog(a,b){mcx.base(this);this._title=b;this._urlHistoryList=a;this._url="";this._driverType=McxDriverType.WMTS;this._driver=new McxOgcDriver;this.base=this;this._openRequestList=[];this._content=$("<div/>");this._dataSourceCombo=new McxComboBox;this._layerListItems=[];this._getDataSourceButton=new McxButton;this._listContainer=$("<div/>")}mcx.inherits(McxWmtsDataListDialog,McxDialogBase);
McxWmtsDataListDialog.prototype.initialize=function(){this._dataSourceCombo.setTextGetter("text");this._dataSourceCombo.setValueGetter("value");this._dataSourceCombo.addEmptyItem("");this.setComboBoxHistory(this._urlHistoryList);this._getDataSourceButton.setText("Get Data Source");this._getDataSourceButton.setLocalizationKey("McxCommonDialog-mcxDataSourceDialogGetSource");this._getDataSourceButton.getClickHandler().addListener(this.onGetDataSourceButtonClick,null,this);this.base.setOkButtonText("Add Layer(s)",
"McxCommonDialog-mcxDataSourceListDialogAddLayers");this.base.disableOkButton();var a=new McxLabeledEditor("Data Source",this._dataSourceCombo);a.setLabelLocalizationKey("McxCommonDialog-mcxDataSourceListDialogDataSource");this.base.addChild(this._content,a);this.base.addFooterButton(this._getDataSourceButton);this._content.append(this._listContainer)};
McxWmtsDataListDialog.prototype.onGetDataSourceButtonClick=function(){this.disableGetButton();var a=this._dataSourceCombo.getText();"?"===a.substr(-1)&&(a=a.substring(0,a.length-1));this.getDataSources(a)};
McxWmtsDataListDialog.prototype.getDataSources=function(a){this.setAsBusy();this.cancelRequests();this.base.disableOkButton();this.addDataToHistory(a);var b=new McxAjaxParameter;b.setAsync(!1);var c=this.getUrl("",a);(new McxAjaxParameter).setAsync(!1);this._dataSource=this._driver.openDataSource(c).getDataSource();b=this._driver.getDataSourceInfo(a,"",b).getDataSourceNames();this._url=a;this.base.detachChildrenOfType(McxDataSourceLayerListControl);this._listContainer.empty();for(a=0;a<b.length;a++)c=
b[a],c="WMTS",this.getServerLayer(c)};McxWmtsDataListDialog.prototype.getDialogTitle=function(){return this._title};McxWmtsDataListDialog.prototype.getContent=function(){return this._content};McxWmtsDataListDialog.prototype.getDialogSize=function(){return McxDialogSize.medium};
McxWmtsDataListDialog.prototype.getServerLayer=function(a){var b=new McxAjaxParameter;b.setArgs(new McxEventArgs(a));b.setParameters(this,function(a){var b=a.getRequest(),b=this._openRequestList.indexOf(b);-1<b&&this._openRequestList.splice(b,1);0==this._openRequestList.length&&(this.enableGetButton(),this.base.setAsIdle());b=a.getLayerNames();a=a.getArgs().getArgs();b=new McxDataSourceLayerListControl(b,a);b.showList();this._layerListItems[a]=b;this.base.addChild(this._listContainer,b);this.base.enableOkButton()},
function(){this.enableGetButton();this.base.setAsIdle()});a=this._driver.getLayerInfo(this._url,a,"",b);this._openRequestList[this._openRequestList.length]=a.getRequest()};McxWmtsDataListDialog.prototype.getUrlHistoryArray=function(){return this.getHistoryAsArray()};McxWmtsDataListDialog.prototype.getUrl=function(a,b){return"WMTS@REST@credentials=@WMTS@"+b+"@@"};McxWmtsDataListDialog.prototype.disableGetButton=function(){this.setAsBusy();this._getDataSourceButton.setButtonState(McxButtonState.disabled)};
McxWmtsDataListDialog.prototype.enableGetButton=function(){this.setAsIdle();this._getDataSourceButton.setButtonState(McxButtonState.active)};McxWmtsDataListDialog.prototype.getDataSource=function(){return this._dataSource};McxWmtsDataListDialog.prototype.getSelectedLayerNames=function(){for(var a=this.base.getChildrenOfType(McxDataSourceLayerListControl),b=[],c=0;c<a.length;c++)b=b.concat(a[c].getSelectedLayers());a={};a.layers=b;a.driver=this._driver;a.source=this._dataSource.getSource();return[a]};
McxWmtsDataListDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxWmtsDataListDialog.prototype.cancelRequests=function(){for(var a=0;a<this._openRequestList.length;a++)this._openRequestList[a].abort();this._openRequestList=[]};McxWmtsDataListDialog.prototype.getDataSourceUrl=function(){var a=this._dataSourceCombo.getSelectedValue();"?"===a.substr(-1)&&(a=a.substring(0,a.length-1));return a};
McxWmtsDataListDialog.prototype.setComboBoxHistory=function(a){this._dataSourceCombo.clear();for(var b=[],c=0;c<a.length;c++)b.push({text:a[c],value:a[c]});this._dataSourceCombo.addItemRange(b)};McxWmtsDataListDialog.prototype.getHistoryAsArray=function(){for(var a=this._dataSourceCombo.getItems(),b=[],c=0;c<a.length;c++)a[c].value&&""!=a[c].value.toString()&&b.push(a[c].value.toString());return b};
McxWmtsDataListDialog.prototype.addDataToHistory=function(a){for(var b=this._dataSourceCombo.getItems(),c=!1,d=0;d<b.length;d++)b[d].value==a&&(c=!0);c||this._dataSourceCombo.addItemRange([{text:a,value:a}])};js.framework.ui.McxCommonDialog.FeatureExplorerDialog={};js.framework.ui.McxCommonDialog.FeatureExplorerDialog.IMcxFeatureExplorerDialog={};function IMcxFeatureExplorerDialog(){}IMcxFeatureExplorerDialog.prototype.getFeatureExplorer=function(){};IMcxFeatureExplorerDialog.prototype.setMap=function(a){};IMcxFeatureExplorerDialog.prototype.setMapInteractionFactory=function(a){};js.framework.ui.McxCommonDialog.FeatureExplorerDialog.McxFeatureExplorerDialog={};function McxFeatureExplorerDialog(a){mcx.base(this);this._map=a;this._dialogId="featureExplorerDialog";this._mapInetractionFactory=null;this._featureExplorer=new McxFeatureExplorer;this._content=$("<div/>").addClass("halil-test");this.base=this;this._featureExplorerContainer=$("<div/>").css("height","100%").addClass("")}mcx.inherits(McxFeatureExplorerDialog,McxDialogBase);
McxFeatureExplorerDialog.prototype.initialize=function(){this._content.append(this._featureExplorerContainer).css("height","100%").addClass("")};McxFeatureExplorerDialog.prototype.onClose=function(){this._mapInetractionFactory.createHighlightAction(null,McxHighLightMode.ClearList).execute(this._map);this._featureExplorer.clear();$(".mcx-dialog").find("div.mcxpanel:visible,div.mcxaccordion:visible,div.mcxlayout:visible,div.mcxtabs-container:visible").trigger("_resize",[!0])};
McxFeatureExplorerDialog.prototype.creationComplete=function(){this.initializeFeatureExplorer()};McxFeatureExplorerDialog.prototype.getDialogSize=function(){return McxDialogSize.large};McxFeatureExplorerDialog.prototype.getDialogHeight=function(){return 400};McxFeatureExplorerDialog.prototype.getDialogButtons=function(){return McxDialogButtons.none};McxFeatureExplorerDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};
McxFeatureExplorerDialog.prototype.getDialogTitle=function(){return"McxCommonDialog-mcxDockPaneFeatureExplorer"};McxFeatureExplorerDialog.prototype.zoomFeatureClick=function(){var a=this._featureExplorer.getSelectedFeatures(),a=this._mapInetractionFactory.createZoomFeatureAction(a,1/3);this._map.getInputHandler().execute(a)};McxFeatureExplorerDialog.prototype.blinkFeatureClick=function(){var a=this._featureExplorer.getSelectedFeatures();this._mapInetractionFactory.createHighlightAction(a,McxHighLightMode.AddNew).execute(this._map)};
McxFeatureExplorerDialog.prototype.panFeatureClick=function(){var a=this._featureExplorer.getSelectedFeatures();this._mapInetractionFactory.createPanFeatureAction(a).execute(this._map)};McxFeatureExplorerDialog.prototype.removeFeatureClick=function(){var a=this._featureExplorer.getSelectedFeatures();this._featureExplorer.removeFeatures(a);this._mapInetractionFactory.createHighlightAction(null,McxHighLightMode.ClearList).execute(this._map)};
McxFeatureExplorerDialog.prototype.deleteFeatureClick=function(){this.blinkFeatureClick();this._featureExplorer.deleteSelectedFeatures();this._mapInetractionFactory.createHighlightAction(null,McxHighLightMode.ClearList).execute(this._map)};McxFeatureExplorerDialog.prototype.selectAllFeaturesClick=function(){this._featureExplorer.selectAllFeatures()};McxFeatureExplorerDialog.prototype.deselectAllFeaturesClick=function(){this._featureExplorer.deselectAllFeatures()};
McxFeatureExplorerDialog.prototype.initializeFeatureExplorer=function(){var a=this;this._featureExplorer.setMapInteractionFactory(this._mapInetractionFactory);this.base.addChild(this._featureExplorerContainer,this._featureExplorer);var b=this._featureExplorer;b.setMap(this._map);b.initialize();b.getSetAsBusyEventHandler().addListener(function(){a.setAsBusy()},null,this);b.getSetAsIdleEventHandler().addListener(function(){a.setAsIdle()},null,this);b.onFeatureSelectionChange().addListener(this.blinkFeatureClick,
null,this);McxLocalizationManager.downloadPath(this.getLocalizationPath());b.addToolButton(McxLocalizationManager.getLocaleValue("McxCommonDialog-mcxZoomInSelection"),mcx.proxy(this.zoomFeatureClick,this),"icon-zoom-selection","McxCommonDialog-mcxZoomInSelection");b.addToolButton(McxLocalizationManager.getLocaleValue("McxCommonDialog-mcxCenterSelection"),mcx.proxy(this.panFeatureClick,this),"icon-pan-selection","McxCommonDialog-mcxCenterSelection");b.addToolButton(McxLocalizationManager.getLocaleValue("McxCommonDialog-mcxRemoveSelectionFromList"),
mcx.proxy(this.removeFeatureClick,this),"icon-remove-selection","McxCommonDialog-mcxRemoveSelectionFromList");McxButtonAuthorityHelper.instance.getButtonVisibility(McxButtonAuthorityType.FeatureExplorerSaveAndDeleteButton)&&b.addToolButton(McxLocalizationManager.getLocaleValue("McxCommonDialog-mcxDeleteSelection"),mcx.proxy(this.deleteFeatureClick,this),"icon-delete-selection","McxCommonDialog-mcxDeleteSelection");b.addToolButton(McxLocalizationManager.getLocaleValue("McxCommonDialog-mcxSelectAllFeatures"),
mcx.proxy(this.selectAllFeaturesClick,this),"icon-all-selection","McxCommonDialog-mcxSelectAllFeatures");b.addToolButton(McxLocalizationManager.getLocaleValue("McxCommonDialog-mcxCancelFeatureSelection"),mcx.proxy(this.deselectAllFeaturesClick,this),"icon-remove-all-selection","McxCommonDialog-mcxCancelFeatureSelection");this._featureExplorer=b};McxFeatureExplorerDialog.prototype.getFeatureExplorer=function(){return this._featureExplorer};
McxFeatureExplorerDialog.prototype.setMap=function(a){this._map=a;this._featureExplorer&&this._featureExplorer.setMap(this._map)};McxFeatureExplorerDialog.prototype.setMapInteractionFactory=function(a){this._mapInetractionFactory=a};McxFeatureExplorerDialog.prototype.getContent=function(){return this._content};js.framework.ui.McxCommonDialog.FeatureGridWrapperDialog={};js.framework.ui.McxCommonDialog.FeatureGridWrapperDialog.McxFeatureGridWrapperDialog={};function McxFeatureGridWrapperDialog(a){mcx.base(this);this.base=this;this.contentElement=$("<div/>").css("height","90%").addClass("");this.featureGridWrapper=a}mcx.inherits(McxFeatureGridWrapperDialog,McxDialogBase);McxFeatureGridWrapperDialog.prototype.getIsSingleInstance=function(){return!1};
McxFeatureGridWrapperDialog.prototype.creationComplete=function(){this.base.addChild(this.contentElement,this.featureGridWrapper)};McxFeatureGridWrapperDialog.prototype.getContent=function(){return this.contentElement};McxFeatureGridWrapperDialog.prototype.getDialogSize=function(){return McxDialogSize.large};McxFeatureGridWrapperDialog.prototype.getDialogHeight=function(){return 300};McxFeatureGridWrapperDialog.prototype.getDialogTitle=function(){return"McxCommonDialog-featureGridDialogTitle"};
McxFeatureGridWrapperDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxFeatureGridWrapperDialog.prototype.getDialogButtons=function(){return McxDialogButtons.none};js.framework.ui.McxCommonDialog.GoToXY={};js.framework.ui.McxCommonDialog.GoToXY.McxGotoXY={};function McxGoToXY(){mcx.base(this);this._content=null;this.base=this}mcx.inherits(McxGoToXY,McxDialogBase);McxGoToXY.prototype.initialize=function(){this._content=$("<div/>");this._xNumberBox=new McxTextBox;this._yNumberBox=new McxTextBox;this.base.addChild(this._content,new McxLabeledEditor("X",this._xNumberBox));this.base.addChild(this._content,new McxLabeledEditor("Y",this._yNumberBox))};
McxGoToXY.prototype.getDialogSize=function(){return McxDialogSize.small};McxGoToXY.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxGoToXY.prototype.getDialogTitle=function(){return"McxCommonDialog-gotoXYDialogTitle"};McxGoToXY.prototype.getX=function(){return this._xNumberBox.getValue()};McxGoToXY.prototype.getY=function(){return this._yNumberBox.getValue()};McxGoToXY.prototype.setX=function(a){this._xNumberBox.setValue(a)};
McxGoToXY.prototype.setY=function(a){this._yNumberBox.setValue(a)};McxGoToXY.prototype.getContent=function(){return this._content};js.framework.ui.McxCommonDialog.HeatMapDialog={};js.framework.ui.McxCommonDialog.HeatMapDialog.McxHeatMapDialog={};
function McxHeatMapDialog(){mcx.base(this);this.base=this;this._layerFieldSelector=new McxLayerFieldSelector;this._radiusNumberBox=new McxNumberBox(0,Number.MAX_VALUE,2);this._gradientSelectBox=new McxGradientSelectBox;this._layerModeSelectBox=new McxSelectBox;this._opacitySlider=new McxNumberSlider(!0,McxNumberSliderMode.Horizontal,0,100,1);this._layerNameTextBox=new McxTextBox(McxTextBoxType.Text);this._layers=[];this._content=null}mcx.inherits(McxHeatMapDialog,McxDialogBase);
McxHeatMapDialog.prototype.initialize=function(){this.initializeContent()};McxHeatMapDialog.prototype.getDialogTitle=function(){return"McxCommonDialog-heatMapDialogTitle"};McxHeatMapDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxHeatMapDialog.prototype.setLayers=function(a){this._layers=a;this._layerFieldSelector.setLayers(a)};
McxHeatMapDialog.prototype.initializeContent=function(){this._content=$("<div/>").addClass("");for(var a=0;a<McxPredefinedGradients.getGradients().length;a++)this._gradientSelectBox.addGradient(McxGradient.fromJSON(McxPredefinedGradients.getGradients()[a]));this._gradientSelectBox.setIsReversible(!0);this._layerFieldSelector.setFieldFilter(this.numberFieldFilter);this._layerFieldSelector.setFieldSelectionMode(McxSelectionMode.optional);this._layerModeSelectBox.setTextGetter("text");this._layerModeSelectBox.setValueGetter("value");
this._layerModeSelectBox.setIsLocalizable(!0);this._layerModeSelectBox.addItemRange([{text:"McxCommonDialog-heatMapAutoDrawMode",value:!1},{text:"McxCommonDialog-heatMapSingleTileDrawMode",value:!0}]);this._layerModeSelectBox.setSelectedValue(!0);var a=new McxLayoutRow,b=new McxLabeledEditor("McxCommonDialog-heatMapDialogLayerNameLabel",this._layerNameTextBox);b.setLabelLocalizationKey("McxCommonDialog-heatMapDialogLayerNameLabel");a.createAndAddSpan(12,b);this.base.addChild(this._content,a);a=new McxLayoutRow;
this._layerFieldSelector.localize();a.createAndAddSpan(12,this._layerFieldSelector);this.base.addChild(this._content,a);a=new McxLayoutRow;b=new McxLabeledEditor("McxCommonDialog-heatMapDialogGradientLabel",this._gradientSelectBox);b.setLabelLocalizationKey("McxCommonDialog-heatMapDialogGradientLabel");a.createAndAddSpan(12,b);this.base.addChild(this._content,a);a=new McxLayoutRow;a.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center);this._radiusNumberBox.getContent().css("margin-left","2px");
b=new McxLayoutRow;b.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center);b.createAndAddSpan(10,this._radiusNumberBox);var c=$("<div/>");c.text("px");b.createAndAddSpan(1,c);b=new McxLabeledEditor("McxCommonDialog-heatMapDialogRadiusLabel",b);b.setLabelSpanLength(6);b.setLabelLocalizationKey("McxCommonDialog-heatMapDialogRadiusLabel");a.createAndAddSpan(6,b);b=new McxLabeledEditor("McxCommonDialog-heatMapDialogOpacityLabel",this._opacitySlider);b.setLabelLocalizationKey("McxCommonDialog-heatMapDialogOpacityLabel");
b.setLabelSpanLength(4);a.createAndAddSpan(6,b);this.base.addChild(this._content,a);a=new McxLabeledEditor("McxCommonDialog-heatMapDialogDrawModeLabel",this._layerModeSelectBox);a.setLabelLocalizationKey("McxCommonDialog-heatMapDialogDrawModeLabel");this.base.addChild(this._content,a);this._radiusNumberBox.setValue(10);this._opacitySlider.setValue(100)};
McxHeatMapDialog.prototype.numberFieldFilter=function(a){return a.getFieldType()==McxDataType.Byte||a.getFieldType()==McxDataType.Double||a.getFieldType()==McxDataType.Float||a.getFieldType()==McxDataType.Int32||a.getFieldType()==McxDataType.Int64||a.getFieldType()==McxDataType.Int16};McxHeatMapDialog.prototype.creationComplete=function(){McxLocalizationManager.localizeContent(this.getContent())};McxHeatMapDialog.prototype.getSelectedLayer=function(){return this._layerFieldSelector.getLayer()};
McxHeatMapDialog.prototype.getSelectedFieldName=function(){var a=this._layerFieldSelector.getField();return a?a.getFieldName():""};McxHeatMapDialog.prototype.getOpacity=function(){return this._opacitySlider.getValue()};McxHeatMapDialog.prototype.getGradient=function(){return this._gradientSelectBox.getSelectedGradient()};McxHeatMapDialog.prototype.getRadius=function(){return this._radiusNumberBox.getValue()};McxHeatMapDialog.prototype.getLayerName=function(){return this._layerNameTextBox.getValue()};
McxHeatMapDialog.prototype.getIsSingleTile=function(){var a=this._layerModeSelectBox.getSelectedItem();return a&&a.value?!0:!1};McxHeatMapDialog.prototype.getContent=function(){return this._content};js.framework.ui.McxCommonDialog.InputDialog={};js.framework.ui.McxCommonDialog.InputDialog.McxInputBoxDialog={};function McxInputBoxDialog(a){mcx.base(this);this.title=a;this._content=null;this.cssSelectorInput="#mcxInputBoxDialogValue";this._textBox=new McxTextBox(McxTextBoxType.Text)}mcx.inherits(McxInputBoxDialog,McxDialogBase);McxInputBoxDialog.prototype.initialize=function(){var a=$("<div/>").append($("<div/>").css("text-align","center").append(this._textBox.getContent()));this._content=$("<div/>").append(a)};
McxInputBoxDialog.prototype.getDialogSize=function(){return McxDialogSize.small};McxInputBoxDialog.prototype.getDialogHeight=function(){return"auto"};McxInputBoxDialog.prototype.getDialogTitle=function(){return this.title};McxInputBoxDialog.prototype.getValue=function(){return this._textBox.getValue()};McxInputBoxDialog.prototype.setValue=function(a){this._textBox.setValue(a)};McxInputBoxDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};
McxInputBoxDialog.prototype.getDialogImageUrl=function(){return"img/Layers16.png"};McxInputBoxDialog.prototype.getContent=function(){return this._content};McxInputBoxDialog.prototype.getIsSingleInstance=function(){return!1};js.framework.ui.McxCommonDialog.OnlineMapDialog={};js.framework.ui.McxCommonDialog.OnlineMapDialog.McxOnlineMapDialog={};function McxOnlineMapDialog(a){mcx.base(this);this.map=a;this._dataSourceList=this._content=null}mcx.inherits(McxOnlineMapDialog,McxDialogBase);
McxOnlineMapDialog.prototype.initialize=function(){var a=$("<div/>");this._content=$("<div/>").append(a);var b=this.map;a.groupedButtonList({objectList:this._dataSourceList||[],imageField:"imageSrc",textField:"text",groupBy:"group",onClick:function(a){a=a.value;var d=(new McxTileDriver).openDataSource("MOM@@OnlineMap").getDataSource(),e=new McxAjaxParameter;e.setAsync(!1);a=d.getLayer(a,e).getLayers();1<=a.length&&b.getLayers().add(a[0]);b.getRenderer().paintLayer(a,null)}})};
McxOnlineMapDialog.prototype.getDialogMaxHeight=function(){return 400};McxOnlineMapDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxOnlineMapDialog.prototype.getDialogTitle=function(){return"McxCommonDialog-mcxOnlineMapDialogTitle"};McxOnlineMapDialog.prototype.getContent=function(){return this._content};McxOnlineMapDialog.prototype.getDialogButtons=function(){return McxDialogButtons.none};
McxOnlineMapDialog.prototype.setDataSourceList=function(a){this._dataSourceList=a};js.framework.ui.McxCommonDialog.OpenCoverageDialog={};js.framework.ui.McxCommonDialog.OpenCoverageDialog.McxOpenCoverageDialog={};function McxOpenCoverageDialog(a){mcx.base(this);this._driverType=McxDriverType.Feature;this._uriList=a;this._listContainer=$("<div/>");this._driver=new McxFsDriver;this._dataSourceList=[];this._layerList=[];this._rootElement=$("<div/>");this._contentId=McxGuid.createGuid();this._datasourceListControl=new McxDataSourceListControl}mcx.inherits(McxOpenCoverageDialog,McxDialogBase);
McxOpenCoverageDialog.prototype.initialize=function(){this._rootElement.attr("id",this._contentId);this._rootElement.append(this._datasourceListControl.getContent());for(var a in this._uriList){var b=this.getDataSources(this._uriList[a]);b&&this._datasourceListControl.addDataSourceItem(b.dataSourceName,b)}};
McxOpenCoverageDialog.prototype.getUrl=function(a,b){switch(this._driverType){case McxDriverType.Feature:return"MFS@REST@"+a+"@@"+b;case McxDriverType.Tile:return"MTS@REST@"+a+"@@"+b;case McxDriverType.Raster:return"MMS@REST@"+a+"@@"+b;case McxDriverType.WMS:return"WMS@REST@credentials="+a+"@@"+b;case McxDriverType.ArcGisRest:return"AGS@REST@@@"+b}return""};
McxOpenCoverageDialog.prototype.getDataSources=function(a){var b=a.split("@"),b=this.getDriver(b[0]);if(null==b)return null;(new McxAjaxParameter).setAsync(!1);var c=b.openDataSource(a);if(null==c)return null;c=c.getDataSource();return Object({dataSourceName:c.getName(),driver:b,source:a,dataSource:c})};McxOpenCoverageDialog.prototype.getContent=function(){return this._rootElement};McxOpenCoverageDialog.prototype.getDialogTitle=function(){return"McxMapAddon-OpenCoverage"};
McxOpenCoverageDialog.prototype.getLayerList=function(){return this._datasourceListControl.getSelectedLayers()};McxOpenCoverageDialog.prototype.getDriver=function(a){switch(a){case "MFS":return new McxFsDriver;case "MMS":return new McxTileDriver;case "MTS":return new McxTileDriver;case "WMS":return new McxOgcDriver;case "AGS":return new McxArcGisDriver;default:return new McxFsDriver}};McxOpenCoverageDialog.prototype.getDialogSize=function(){return McxDialogSize.large};js.framework.ui.McxCommonDialog.PrintOptionsDialog={};js.framework.ui.McxCommonDialog.PrintOptionsDialog.McxPrintOptionsDialog={};
function McxPrintOptionsDialog(a,b){mcx.base(this);this.base=this;this._map=a;this._printedMap=null;this._mapGuid="map_"+McxGuid.createGuid();this._mapDiv=$("<div/>");this._paperDiv=$("<div/>");this._rootElement=$("<div/>");this._imageW=Math.floor(parseFloat(mcx.mm2Px("210","")))-15;this._imageH=Math.floor(parseFloat(mcx.mm2Px("297","")))-15;this._imageUrl="";this._smoothingSelectBox=new McxSelectBox;this._paperSizeSelectBox=new McxSelectBox;this._mcxColorPicker=null;this._mapIntFactory=b;this._scaleComboBox=
new McxComboBox;this._scaleChanged=!1;this._scale=a.getScale()}mcx.inherits(McxPrintOptionsDialog,McxDialogBase);
McxPrintOptionsDialog.prototype.creationComplete=function(){var a=this;this._scaleComboBox.setTextGetter("text");this._scaleComboBox.setValueGetter("value");this._mapDiv.css("height","200px").css("width","450px").css("position","relative").css("overflow","hidden").attr("id",this._mapGuid);this._paperDiv.css("height","256px").css("width","256px");this._paperDiv.css("background-image","url("+McxPathFinder.getFullPath("$McxCommonDialog/assets/img/r_portrait.png")+")").attr("rotation",!0).click(function(){JSON.parse($(this).attr("rotation"))?
($(this).css("background-image","url("+McxPathFinder.getFullPath("$McxCommonDialog/assets/img/r_landspace.png")+")"),$(this).attr("rotation",!1)):($(this).css("background-image","url("+McxPathFinder.getFullPath("$McxCommonDialog/assets/img/r_portrait.png")+")"),$(this).attr("rotation",!0));a.paperSizeCalc()});var b=$("<div/>");b.append(this.selectionComboBox().getContent());b.append(this.scaleSelect().getContent());b.append(this.colorPicker().getContent());b.append(this.paperSizeSelect().getContent());
b.append(this.smoothingSelect().getContent());var c=new McxLayoutRow;c.createAndAddSpan(6,this._paperDiv);c.createAndAddSpan(6,b);this.base.addChild(this._rootElement,c);this.preview(null);b=new McxButton;b.setText("Print");b.setImage("$McxCommonDialog/assets/img/print-16.png");b.getClickHandler().addListener(function(){this.printPrepare("print")},null,this);b.setLocalizationKey("McxCommonDialog-print");c=new McxButton;c.setText("Download");c.setImage("$McxCommonDialog/assets/img/download-16.png");
c.getClickHandler().addListener(function(){this.printPrepare("download")},null,this);c.setLocalizationKey("McxCommonDialog-download");this.base.addFooterButton(b);this.base.addFooterButton(c);this.base.onCloseDialog().addListener(function(){this._map.getInputHandler().setController(null)},null,this)};McxPrintOptionsDialog.prototype.getContent=function(){return this._rootElement};
McxPrintOptionsDialog.prototype.printPrepare=function(a){McxLoadingIndicator.setAsBusy(this.getContent(),!1);var b=document.createElement("canvas"),c=b.getContext("2d");c.canvas.width=this._imageW;c.canvas.height=this._imageH;c.fillStyle="white";b.style.width=this._imageW+"px";b.style.height=this._imageH+"px";c.fillRect(0,0,b.width,b.height);var d=function(){this._imageUrl=b.toDataURL("image/png");"download"==a?this.downloadImage():"print"==a&&this.print();McxLoadingIndicator.setAsIdle(this.getContent())},
c=new McxAjaxParameter;c.setParameters(this,d,d);var d=b.getContext("2d"),e=new McxPrintOptions;e.setAjaxParameter(c);e.setContext(d);e.setLayers(null);e.setMap(this._printedMap);e.setWidth(this._imageW);e.setHeight(this._imageH);e.setBounds(this._printedMap.getWorld());e.setFillStyle("rgba("+function(a){return["0x"+a[1]+a[2]|0,"0x"+a[3]+a[4]|0,"0x"+a[5]+a[6]|0]}(this._mcxColorPicker.getColor())+","+this._mcxColorPicker.getOpacity()+")");(new McxMapPrinter).print(e)};
McxPrintOptionsDialog.prototype.getDialogSize=function(){return McxDialogSize.large};McxPrintOptionsDialog.prototype.getDialogTitle=function(){return"McxCommonDialog-mcxprintOptionsDialogTitle"};McxPrintOptionsDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxPrintOptionsDialog.prototype.getDialogButtons=function(){return McxDialogButtons.none};
McxPrintOptionsDialog.prototype.preview=function(a){var b;this._mapDiv.empty();null!=a&&(b=a.getArgs().bounds);b||(b=this._map.getWorld());a=new McxMap(this._mapGuid);var c=new McxRenderer(a);a.setRenderer(c);a.setLayerCollection(c);a.setCoordinateSystem(this._map.getCoordinateSystem());c=new McxCanvasProvider;a.getRenderer().addCanvasProvider(c);a.setDisplay(this._imageW,this._imageH);a.setWorld(b.getLeft(),b.getBottom(),b.getRight(),b.getTop());b=this._map.getLayers().toLayerArray();for(c=0;c<b.length;c++)a.getLayers().add(b[c]),
a.getRenderer().paintLayer(b[c],null);this._printedMap=a;this._scaleChanged||(this._scaleComboBox.addItem({text:"1:"+parseInt(1/this._scale,10),value:parseInt(1/this._scale,10),isPreDefined:!0}),this._scaleComboBox.setSelectedValue(parseInt(1/this._scale,10)));this._printedMap.setScale(this._scale);this._printedMap.getRenderer().paintLayer(null,null)};
McxPrintOptionsDialog.prototype.scaleSelect=function(){var a=this;this._scaleComboBox.addItemRange([{text:"1:1000",value:1E3,isPreDefined:!0},{text:"1:5000",value:5E3,isPreDefined:!0},{text:"1:10000",value:1E4,isPreDefined:!0},{text:"1:250000",value:25E4,isPreDefined:!0},{text:"1:500000",value:5E5,isPreDefined:!0},{text:"1:1000000",value:1E6,isPreDefined:!0}]);var b=function(b){var c=[];null==b?(c[0]=1,c[1]=a._scaleComboBox.getSelectedValue()):c=b.getArgs().split(":");a._scale=c[0]/c[1];a._printedMap.setScale(a._scale);
a._printedMap.getRenderer().paintLayer(null,null)};this._scaleComboBox.getOnSelectHandler().addListener(function(){a._scaleChanged=!0;b(null)},null,this);this._scaleComboBox.getOnEnterKey().addListener(b,null,this);var c=new McxLabelControl;c.setText("\u00d6l\u00e7ek");c.setLocalizationKey("McxCommonDialog-scale");c.createToolTip("McxCommonDialog-scaleDescription");var d=new McxLayoutRow;d.createAndAddSpan(4,c);d.createAndAddSpan(8,this._scaleComboBox);c=new McxLayoutRow;c.createAndAddSpan(12,d);
return c};
McxPrintOptionsDialog.prototype.selectionComboBox=function(){var a=McxGuid.createGuid(),b=new McxRadioButton("McxCommonDialog-printAll");b.setName(a+"_print");b.setText("McxCommonDialog-printAll");b.checked(!0);b.createToolTip("McxCommonDialog-printAllDescription");b.onChangeHandler().addListener(function(){this._map.getInputHandler().setController(null);this.preview(null)},null,this);b.checked(!0);var c=new McxRadioButton("McxCommonDialog-printWithSelectionTool");c.setName(a+"_print");c.setText("McxCommonDialog-printWithSelectionTool");
c.createToolTip("McxCommonDialog-printWithSelectionToolDescription");c.onChangeHandler().addListener(function(){var a=this._mapIntFactory.createPrintRectangleController(this);this._map.getInputHandler().setController(a)},null,this);a=new McxLayoutRow;a.createAndAddSpan(6,b);a.createAndAddSpan(6,c);return a};
McxPrintOptionsDialog.prototype.downloadImage=function(){for(var a=this._imageUrl.replace(/^data:image\/(png|jpg);base64,/,""),b="EkranGoruntusu-"+(new Date).getTime()+".png",c=Blob,a=window.atob(a),d=a.length,e=new ArrayBuffer(d),f=new Uint8Array(e),g=0;g<d;g++)f[g]=a.charCodeAt(g);c=new c([e],{type:"image/png"});"undefined"!==typeof window.chrome?(a=document.createElement("a"),a.href=window.URL.createObjectURL(c),a.download=b,a.click()):"undefined"!==typeof window.navigator.msSaveBlob?window.navigator.msSaveBlob(c,
b):(b=new window.File([c],b,{type:"application/force-download"}),window.open(URL.createObjectURL(b)))};McxPrintOptionsDialog.prototype.print=function(){var a=$("<img/>");a.css("max-height","100%");a.attr("src",this._imageUrl);a.attr("width","100%");a.printElement()};
McxPrintOptionsDialog.prototype.colorPicker=function(){this._mcxColorPicker=new McxColorPicker;var a=new McxLabelControl;a.setText("Renk");a.setLocalizationKey("McxCommonDialog-color");a.createToolTip("McxCommonDialog-colorDescription");var b=new McxLayoutRow;b.createAndAddSpan(4,a);b.createAndAddSpan(8,this._mcxColorPicker);a=new McxLayoutRow;a.createAndAddSpan(12,b);return a};
McxPrintOptionsDialog.prototype.smoothingSelect=function(){this._smoothingSelectBox.setTextGetter("name");this._smoothingSelectBox.setValueGetter("code");this._smoothingSelectBox.setIsLocalizable(!0);this._smoothingSelectBox.addItem({code:!0,name:"McxCommonDialog-open"});this._smoothingSelectBox.addItem({code:!1,name:"McxCommonDialog-close"});var a=new McxLabelControl;a.setText("Yumu\u015fatma");a.setLocalizationKey("McxCommonDialog-smoothing");a.createToolTip("McxCommonDialog-smoothingDescription");
var b=new McxLayoutRow;b.createAndAddSpan(4,a);b.createAndAddSpan(8,this._smoothingSelectBox);a=new McxLayoutRow;a.createAndAddSpan(12,b);return a};
McxPrintOptionsDialog.prototype.paperSizeSelect=function(){this._paperSizeSelectBox.setTextGetter("name");this._paperSizeSelectBox.setValueGetter("size");this._paperSizeSelectBox.setIsLocalizable(!0);this._paperSizeSelectBox.addItem({size:"210x297",name:"A4"});this._paperSizeSelectBox.addItem({size:"297x420",name:"A3"});this._paperSizeSelectBox.addItem({size:"420x594",name:"A2"});this._paperSizeSelectBox.addItem({size:"594x841",name:"A1"});this._paperSizeSelectBox.addItem({size:"841x1189",name:"A0"});
this._paperSizeSelectBox.addItem({size:"148x210",name:"A5"});this._paperSizeSelectBox.addItem({size:"105x148",name:"A6"});this._paperSizeSelectBox.addItem({size:"74x105",name:"A7"});this._paperSizeSelectBox.addItem({size:"52x74",name:"A8"});this._paperSizeSelectBox.addItem({size:"37x52",name:"A9"});this._paperSizeSelectBox.addItem({size:"26x37",name:"A10"});this._paperSizeSelectBox.getOnSelectHandler().addListener(function(){this.paperSizeCalc()},null,this);var a=new McxLabelControl;a.setText("Ka\u011f\u0131t");
var b=new McxLayoutRow;b.createAndAddSpan(4,a);b.createAndAddSpan(8,this._paperSizeSelectBox);a=new McxLayoutRow;a.createAndAddSpan(12,b);return a};
McxPrintOptionsDialog.prototype.paperSizeCalc=function(){var a=this._paperSizeSelectBox.getSelectedValue().split("x"),b=parseFloat(a[0]),a=parseFloat(a[1]);this._imageW=Math.floor(parseFloat(mcx.mm2Px(b-10+"","")));this._imageH=Math.floor(parseFloat(mcx.mm2Px(a-10+"","")));JSON.parse(this._paperDiv.attr("rotation"))||(this._imageW=Math.floor(parseFloat(mcx.mm2Px(a-10+"",""))),this._imageH=Math.floor(parseFloat(mcx.mm2Px(b-20+"",""))));this.preview(null)};js.framework.ui.McxCommonDialog.SelectByAttributeDialog={};js.framework.ui.McxCommonDialog.SelectByAttributeDialog.McxSelectByAttributeDialog={};function McxSelectByAttributeDialog(a){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._control=null;this._map=a;this._loadedEventHandler=new McxEventHandler;this._closedEventHandler=new McxEventHandler;this._exportButtonClickHandler=new McxEventHandler;this._exportMapDialogView=!1;this._showSelectBox=!0;this._layerArray=null}
mcx.inherits(McxSelectByAttributeDialog,McxDialogBase);McxSelectByAttributeDialog.prototype.getDialogSize=function(){return McxDialogSize.auto};
McxSelectByAttributeDialog.prototype.creationComplete=function(){this._rootElement.css("width","530px").addClass("");this._control=new McxAttributeSelectionFilterControl(this._showSelectBox);this._control.setLayerArray(this._layerArray);this._control.setIsExport(this._exportMapDialogView);this._control.initializeComponent();this.base.addChild(this._rootElement,this._control);this._loadedEventHandler.dispatchOnSuccess(this,null);var a="",a=this._exportMapDialogView?"McxCommonDialog-Export":"McxCommonDialog-ShowResult",
b=new McxButton;b.setText("Export");b.setLocalizationKey(a);b.getClickHandler().addListener(function(){this._exportButtonClickHandler.dispatchOnSuccess(this,null)},null,this);this.base.addFooterButton(b)};McxSelectByAttributeDialog.prototype.setLayerArray=function(a){this._layerArray=a};McxSelectByAttributeDialog.prototype.onClose=function(){this._closedEventHandler.dispatchOnSuccess(this,null)};
McxSelectByAttributeDialog.prototype.getDialogTitle=function(){return this._exportMapDialogView?"McxCommonDialog-ExportByAttributeDialogTitle":"McxCommonDialog-SelectByAttributeDialogTitle"};McxSelectByAttributeDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxSelectByAttributeDialog.prototype.getContent=function(){return this._rootElement};McxSelectByAttributeDialog.prototype.getDialogLoadedEventHandler=function(){return this._loadedEventHandler};
McxSelectByAttributeDialog.prototype.getClosedEventHandler=function(){return this._closedEventHandler};McxSelectByAttributeDialog.prototype.getControl=function(){return this._control};McxSelectByAttributeDialog.prototype.showResultOnMap=function(){return this._control.showResultOnMap()};McxSelectByAttributeDialog.prototype.showResultOnGrid=function(){return this._control.showResultOnGrid()};McxSelectByAttributeDialog.prototype.getSelectedRadioButton=function(){return this._control.getSelectedRadioButton()};
McxSelectByAttributeDialog.prototype.setShowExportMapView=function(a){this._exportMapDialogView=a};McxSelectByAttributeDialog.prototype.showSelectionMode=function(a){this._showSelectBox=a};McxSelectByAttributeDialog.prototype.getExportMapFiltersComboValue=function(){return this._control.getExportMapFiltersComboValue()};McxSelectByAttributeDialog.prototype.onSelectButtonClickHandler=function(){return this._exportButtonClickHandler};McxSelectByAttributeDialog.prototype.onCancelButtonClickHandler=function(){return this.base.getCancelButtonClickHandler()};
McxSelectByAttributeDialog.prototype.getSql=function(){return this._control.getSql()};McxSelectByAttributeDialog.prototype.getDialogButtons=function(){return McxDialogButtons.none};js.framework.ui.McxCommonDialog.SelectByGeometryDialog={};js.framework.ui.McxCommonDialog.SelectByGeometryDialog.McxSelectByGeometryDialog={};
function McxSelectByGeometryDialog(a){mcx.base(this);this.base=this;this._control=this._rootElement=null;this._map=a;this._mapRadio=this._gridRadio=null;this._loadedEventHandler=new McxEventHandler;this._closedEventHandler=new McxEventHandler;this._exportButtonClickHandler=new McxEventHandler;this._exportMapDialogView=!1;this._driverFilterCombo=null;this._showSelectBox=!0;this._layerArray=null}mcx.inherits(McxSelectByGeometryDialog,McxDialogBase);
McxSelectByGeometryDialog.prototype.getIsSingleInstance=function(){return!0};McxSelectByGeometryDialog.prototype.initialize=function(){this.initializeUiControls()};McxSelectByGeometryDialog.prototype.onClose=function(){this._closedEventHandler.dispatchOnSuccess(this,null)};McxSelectByGeometryDialog.prototype.setLayerArray=function(a){this._layerArray=a};
McxSelectByGeometryDialog.prototype.initializeUiControls=function(){this._control=new McxGeometrySelectionFilterControl(this._showSelectBox);this._control.setSourceLayerArray(this._layerArray);this._control.setTargetLayerArray(this._layerArray);this._control.initializeComponent();var a=new McxLayoutRow,b="";if(this._exportMapDialogView){b="McxCommonDialog-Export";this._driverFilterCombo=new McxSelectBox;this._driverFilterCombo.setTextGetter("text");this._driverFilterCombo.setValueGetter("value");
var c=new McxLabeledEditor(McxLocalizationManager.getLocaleValue("McxCommonDialog-ExportFormatLabel"),this._driverFilterCombo);c.setLabelLocalizationKey("McxCommonDialog-ExportFormatLabel");c.setLabelSpanLength(5);a.createAndAddSpan(12,c);this._driverFilterCombo.addItemRange(driverFilterObject)}else b="McxCommonDialog-ShowResult",this._gridRadio=new McxRadioButton,this._gridRadio.setText(McxLocalizationManager.getLocaleValue("McxCommonDialog-Grid")),this._gridRadio.setValue("grid"),this._gridRadio.getContent().find("input").css("outline",
"none"),this._gridRadio.setName("selectionResultRadioGroup"),this._mapRadio=new McxRadioButton,this._mapRadio.setText(McxLocalizationManager.getLocaleValue("McxCommonDialog-Map")),this._mapRadio.setName("selectionResultRadioGroup"),this._mapRadio.setValue("map"),this._mapRadio.getContent().find("input").css("outline","none"),this._mapRadio.checked(!0),c=new McxLabelControl,c.setText(McxLocalizationManager.getLocaleValue("McxCommonDialog-ShowSelectResult")),c.setLocalizationKey("McxCommonDialog-ShowSelectResult"),
a.createAndAddSpan(5,c),a.createAndAddSpan(3,this._gridRadio.getContent()),a.createAndAddSpan(4,this._mapRadio.getContent()),a.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center),a.getContent().css("margin","10px 0 10px");this._control.getComponentChangedHandler().addListener(this.controlComponentChanged,null,this);this._rootElement=$("<div/>");this.base.addChild(this._rootElement,this._control);this.base.addChild(this._rootElement,a);this._loadedEventHandler.dispatchOnSuccess(this,null);a=new McxButton;
a.setText("Export");a.setLocalizationKey(b);a.getClickHandler().addListener(function(){this._exportButtonClickHandler.dispatchOnSuccess(this,null)},null,this);this.base.addFooterButton(a)};McxSelectByGeometryDialog.prototype.setShowExportMapView=function(a){this._exportMapDialogView=a};McxSelectByGeometryDialog.prototype.showSelectionMode=function(a){this._showSelectBox=a};McxSelectByGeometryDialog.prototype.getDialogHeight=function(){return"auto"};
McxSelectByGeometryDialog.prototype.getDialogTitle=function(){return this._exportMapDialogView?"McxCommonDialog-ExportByGeometryDialogTitle":"McxCommonDialog-SelectByGeometryDialogTitle"};McxSelectByGeometryDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxSelectByGeometryDialog.prototype.getContent=function(){return this._rootElement};McxSelectByGeometryDialog.prototype.getScenarioDialogLoadedEventHandler=function(){return this._loadedEventHandler};
McxSelectByGeometryDialog.prototype.getClosedEventHandler=function(){return this._closedEventHandler};McxSelectByGeometryDialog.prototype.onSelectButtonClickHandler=function(){return this._exportButtonClickHandler};McxSelectByGeometryDialog.prototype.onCancelButtonClickHandler=function(){return this.base.getCancelButtonClickHandler()};McxSelectByGeometryDialog.prototype.getSelectControl=function(){return this._control};
McxSelectByGeometryDialog.prototype.controlComponentChanged=function(){null!=this._gridRadio&&1<this._control.getSelectedLayers().length?(this._gridRadio.enabled(!1),this._mapRadio.checked(!0)):null!=this._gridRadio&&this._gridRadio.enabled(!0)};McxSelectByGeometryDialog.prototype.getSelectedRadioButton=function(){return null!=this._mapRadio&&this._mapRadio.isChecked()?this._mapRadio:null!=this._gridRadio&&this._gridRadio.isChecked()?this._gridRadio:null};
McxSelectByGeometryDialog.prototype.getExportMapFiltersComboValue=function(){return null!=this._driverFilterCombo?this._driverFilterCombo.getSelectedItem().value:null};McxSelectByGeometryDialog.prototype.getDialogButtons=function(){return McxDialogButtons.none};McxSelectByGeometryDialog.prototype.getLayerFilter=function(){return this._control.getLayerFilter()};McxSelectByGeometryDialog.prototype.getDialogMaxHeight=function(){return 500};js.framework.ui.McxCommonDialog.ShareWorkspaceDialog={};js.framework.ui.McxCommonDialog.ShareWorkspaceDialog.McxShareWorkspaceDialog={};
function McxShareWorkspaceDialog(){mcx.base(this);this._content=null;this._userListBox=new McxFancySelectBox(!0);this._groupListBox=new McxListBox;this._activeSelectBox=new McxListBox;this._shareWithGroupsButton=new McxButton;this._shareWithUsersButton=new McxButton;this._clearShareButton=new McxButton;this._userRange=[];this._rootElement=$("<div/>");this._isReadOnly=!1;this.preInitializeUIElements()}mcx.inherits(McxShareWorkspaceDialog,McxDialogBase);
McxShareWorkspaceDialog.prototype.getDialogId=function(){return"mcxShareWorkspaceDialog"};
McxShareWorkspaceDialog.prototype.initialize=function(){this.updateReadonlyLayout();this._clearShareButton.setText("Clear");this._clearShareButton.setLocalizationKey("McxCommonDialog-shareWorkspaceClear");this._shareWithUsersButton.setButtonSize(McxButtonSize.small);this._shareWithGroupsButton.setButtonSize(McxButtonSize.small);this._clearShareButton.setButtonSize(McxButtonSize.small);this._clearShareButton.setButtonState(McxButtonState.danger);var a=$("<div/>"),b=$("<div/>").css("margin-top","5px");
a.append(this._shareWithGroupsButton.getContent());a.append(this._shareWithUsersButton.getContent());a.append(this._clearShareButton.getContent());b.append(this._groupListBox.getContent());b.append(this._userListBox.getContent());this._rootElement.append(a);this._rootElement.append(b);this.activateGroupsTab();this.bindEvents()};
McxShareWorkspaceDialog.prototype.preInitializeUIElements=function(){this._userListBox.setValueGetter("getId");this._groupListBox.setValueGetter("getId");this._userListBox.setTextGetter("getDisplayName");this._groupListBox.setTextGetter("getDisplayName");this._groupListBox.setMultiSelect(!0);this._groupListBox.setOptionFormatter(this.optionFormatter)};
McxShareWorkspaceDialog.prototype.bindEvents=function(){this._shareWithGroupsButton.getClickHandler().addListener(function(){this.activateGroupsTab()},null,this);this._shareWithUsersButton.getClickHandler().addListener(function(){this.activateUserTab()},null,this);this._clearShareButton.getClickHandler().addListener(function(){this._activeSelectBox.deselectAll()},null,this)};
McxShareWorkspaceDialog.prototype.optionFormatter=function(a,b){a.css("background-color","#ddd").css("background-size","18px").css("padding","6px 6px 6px 24px").css("margin-bottom","2px").css("background-repeat","no-repeat").css("color","#555").css("background-position","3px center").css("background-image","url("+b.getImageUrl()+")")};
McxShareWorkspaceDialog.prototype.setUserRange=function(a){var b=[];this._userListBox.setMaxItemCount(a.length);this._groupListBox.clear();this._userListBox.clear();this._userRange=a;for(var c=0;c<a.length;c++){var d=a[c];d.getIsGroup()?this._groupListBox.addItem(d):b[d.getId()]={name:d.getDisplayName(),user:d}}this._userListBox.getContent().find("select").append(function(){var a=[],c;for(c in b)a.push($("<option value="+c+"/>").data("relatedSelectItem",b[c].user).text(b[c].name));return a}());this._groupListBox.deselectAll()};
McxShareWorkspaceDialog.prototype.setAlreadySharedUserRange=function(a){for(var b=0;b<a.length;b++){var c=a[b];c.getIsGroup()?this._groupListBox.selectValue(c.getId()):this._userListBox.addSelectedValue(c.getId())}};McxShareWorkspaceDialog.prototype.getSelectedUsers=function(){var a=this._userListBox.getSelectedItems();return this._groupListBox.getSelectedItems().concat(a)};McxShareWorkspaceDialog.prototype.onClose=function(){};McxShareWorkspaceDialog.prototype.creationComplete=function(){};
McxShareWorkspaceDialog.prototype.getDialogWidth=function(){return 400};McxShareWorkspaceDialog.prototype.getDialogHeight=function(){return"auto"};McxShareWorkspaceDialog.prototype.getDialogTitle=function(){return"McxCommonDialog-mcxShareWorkspaceDialogTitle"};McxShareWorkspaceDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxShareWorkspaceDialog.prototype.getDialogImageUrl=function(){return"$McxCommonDialog/assets/img/defaultDialogImage16.png"};
McxShareWorkspaceDialog.prototype.activateGroupsTab=function(){this._shareWithUsersButton.setButtonState(McxButtonState.normal);this._userListBox.getContent().css("display","none");this._shareWithGroupsButton.setButtonState(McxButtonState.active);this._groupListBox.getContent().css("display","block");this._activeSelectBox=this._groupListBox};
McxShareWorkspaceDialog.prototype.activateUserTab=function(){this._shareWithGroupsButton.setButtonState(McxButtonState.normal);this._groupListBox.getContent().css("display","none");this._shareWithUsersButton.setButtonState(McxButtonState.active);this._userListBox.getContent().css("display","block");this._activeSelectBox=this._userListBox};
McxShareWorkspaceDialog.prototype.updateReadonlyLayout=function(){this._userListBox.setIsEnabled(this._isReadOnly);this._groupListBox.setIsEnabled(this._isReadOnly);this._isReadOnly?(this._shareWithGroupsButton.setText("See Groups"),this._shareWithUsersButton.setText("See Users"),this._shareWithUsersButton.setLocalizationKey("McxCommonDialog-seeSharedWorkspaceWithUsers"),this._shareWithGroupsButton.setLocalizationKey("McxCommonDialog-seeSharedWorkspaceWithGroups"),this._clearShareButton.getContent().css("display",
"none")):(this._shareWithGroupsButton.setText("Select Groups"),this._shareWithUsersButton.setText("Select Users"),this._shareWithUsersButton.setLocalizationKey("McxCommonDialog-shareWorkspaceWithUsers"),this._shareWithGroupsButton.setLocalizationKey("McxCommonDialog-shareWorkspaceWithGroups"),this._clearShareButton.getContent().css("display","inline-block"))};McxShareWorkspaceDialog.prototype.setIsReadOnly=function(a){this._isReadOnly=a;this.updateReadonlyLayout()};
McxShareWorkspaceDialog.prototype.getContent=function(){return mcx.isDefAndNotNull(this._content)?this._content:this._content=$("<div/>").attr("id",this.getDialogId()).append(this._rootElement)};McxShareWorkspaceDialog.prototype.getDialogSize=function(){return McxDialogSize.medium};js.framework.ui.McxCommonDialog.ShowCoordinateDialog={};js.framework.ui.McxCommonDialog.ShowCoordinateDialog.McxShowCoordinateDialog={};function McxShowCoordinateDialog(){mcx.base(this);this.base=this;this._coordinateX=new McxTextBox;this._coordinateY=new McxTextBox;this._containerElement=$("<div/>").addClass("")}mcx.inherits(McxShowCoordinateDialog,McxDialogBase);McxShowCoordinateDialog.prototype.getDialogSize=function(){return McxDialogSize.small};
McxShowCoordinateDialog.prototype.getDialogTitle=function(){return this.base.getLocaleValue("McxCommonDialog-showCoordinateDialogTitle")};McxShowCoordinateDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxShowCoordinateDialog.prototype.getDialogButtons=function(){return McxDialogButtons.none};
McxShowCoordinateDialog.prototype.creationComplete=function(){this._coordinateX.setValue("0");this._coordinateY.setValue("0");this.base.addChild(this._containerElement,new McxLabeledEditor("X",this._coordinateX));this.base.addChild(this._containerElement,new McxLabeledEditor("Y",this._coordinateY))};McxShowCoordinateDialog.prototype.setX=function(a){this._coordinateX.setValue(a)};McxShowCoordinateDialog.prototype.setY=function(a){this._coordinateY.setValue(a)};
McxShowCoordinateDialog.prototype.getX=function(){return this._coordinateX.getValue()};McxShowCoordinateDialog.prototype.getY=function(){return this._coordinateY.getValue()};McxShowCoordinateDialog.prototype.getContent=function(){return this._containerElement};js.framework.ui.McxCommonDialog.WorkspaceSelectionDialog={};js.framework.ui.McxCommonDialog.WorkspaceSelectionDialog.McxWorkspaceSelectionDialog={};function McxWorkspaceSelectionDialog(){mcx.base(this);this._content=null;this._workspaceManagmentControl=new McxWorkspaceManagerView;this._workspaceInfoArray=null}mcx.inherits(McxWorkspaceSelectionDialog,McxDialogBase);McxWorkspaceSelectionDialog.prototype.getDialogId=function(){return"mcxWorkspaceSelectionDialog"};
McxWorkspaceSelectionDialog.prototype.getDialogImageUrl=function(){return"$McxCommonDialog/assets/img/defaultDialogImage16.png"};McxWorkspaceSelectionDialog.prototype.initialize=function(){};McxWorkspaceSelectionDialog.prototype.onClose=function(){};McxWorkspaceSelectionDialog.prototype.creationComplete=function(){$("#workspaceSelectionDialogInner").append(this._workspaceManagmentControl.getContent())};McxWorkspaceSelectionDialog.prototype.getDialogWidth=function(){return 575};
McxWorkspaceSelectionDialog.prototype.getDialogHeight=function(){return"auto"};McxWorkspaceSelectionDialog.prototype.getLocalizationPath=function(){return"$McxCommonDialog/assets/locale/mcxCommonDialog"};McxWorkspaceSelectionDialog.prototype.getDialogTitle=function(){return"McxCommonDialog-mcxWorkspaceSelectionDialogTitle"};
McxWorkspaceSelectionDialog.prototype.getContent=function(){if(0==mcx.isDefAndNotNull(this._content)){var a=$('<div title="Workspace Selection Dialog" data-localize="mcxWorkspaceSelectionDialog" data-localize-for="title"><div id="workspaceSelectionDialogInner"></div></div>');this._content=$("<div/>").attr("id",this.getDialogId()).append(a)}return this._content};McxWorkspaceSelectionDialog.prototype.setWorkspaces=function(a){this._workspaceInfoArray=a;this._workspaceManagmentControl.setWorkspaceInfoRange(a)};
McxWorkspaceSelectionDialog.prototype.getWorkspaceInfoClickHandler=function(){return this._workspaceManagmentControl.getWorkspaceInfoClickHandler()};
js.builtin={};js.builtin.McxBase={};js.builtin.McxBase.IMcxFeatureHelper={};function IMcxFeatureHelper(){}IMcxFeatureHelper.prototype.copyFields=function(a,b){};IMcxFeatureHelper.prototype.groupByLayer=function(a){};IMcxFeatureHelper.prototype.getScreenFeatures=function(a){};IMcxFeatureHelper.prototype.getLayers=function(a){};IMcxFeatureHelper.prototype.getFeatureWithId=function(a,b){};IMcxFeatureHelper.prototype.getCodedValueOfField=function(a,b,c){};js.builtin.McxBase.IMcxGeometryHelper={};function IMcxGeometryHelper(){}IMcxGeometryHelper.prototype.getPoints=function(a,b){};IMcxGeometryHelper.prototype.removeRepeated=function(a){};js.builtin.McxBase.IMcxMarkerHelper={};function IMcxMarkerHelper(){}IMcxMarkerHelper.prototype.createMarker=function(a,b,c){};js.builtin.McxBase.IMcxSelectionHelper={};function IMcxSelectionHelper(){}IMcxSelectionHelper.prototype.hitTest=function(a,b,c){};IMcxSelectionHelper.prototype.hitTestByLayer=function(a,b,c,d){};IMcxSelectionHelper.prototype.hitTestByScreenFeatures=function(a,b,c){};IMcxSelectionHelper.prototype.checkGeometryType=function(a,b){};IMcxSelectionHelper.prototype.getGeometryType=function(a){};IMcxSelectionHelper.prototype.checkLayer=function(a,b){};IMcxSelectionHelper.prototype.clearSelection=function(a){};
IMcxSelectionHelper.prototype.checkSelection=function(a){};IMcxSelectionHelper.prototype.getSelectionCount=function(a){};IMcxSelectionHelper.prototype.getSelection=function(a){};IMcxSelectionHelper.prototype.getSelectableLayer=function(a){};IMcxSelectionHelper.prototype.isSelected=function(a){};IMcxSelectionHelper.prototype.applyFilter=function(a,b,c){};IMcxSelectionHelper.prototype.addSelection=function(a,b){};IMcxSelectionHelper.prototype.removeSelection=function(a,b){};js.builtin.McxBase.McxApplyMode={};var McxApplyMode={None:0,Pick:1,Select:2};js.builtin.McxBase.McxDefaultOptionUI={};function McxDefaultOptionUI(){}McxDefaultOptionUI.createUI=function(a,b,c){var d=new McxControllerUI;d.getSubmitHandler().addListener(a,null,c);d.onCancel().addListener(b,null,c);return d};js.builtin.McxBase.McxFeatureHelper={};function McxFeatureHelper(){}
McxFeatureHelper.prototype.copyFields=function(a,b){for(var c=a.getLayer(),d=b.getLayer(),e=0;e<b.getFieldCount();e++){var f=b.getFieldName(e),g=b.getField(e);mcx.areStringEqual(f,d.getKeyField(),!0)||mcx.areStringEqual(f,d.getGuidField(),!0)||mcx.areStringEqual(f,d.getGeometryField(),!0)||mcx.areStringEqual(f,d.getGeometryField()+"_LENGTH",!0)||mcx.areStringEqual(f,d.getGeometryField()+"_AREA",!0)||mcx.areStringEqual(f,d.getGeometryField()+"_X",!0)||mcx.areStringEqual(f,d.getGeometryField()+"_Y",
!0)||mcx.areStringEqual(f,d.getSymbolizerField(),!0)||mcx.areStringEqual(f,d.getLabelSymbolizerField(),!0)||g.getFieldType()==McxDataType.Guid||0>c.getSchema().getFieldOrdinal(f)||0>a.getFieldOrdinal(f)||(g=b.getFieldType(e),null!=McxFieldDefinition.tryChangeType(a.getValue(f),g)&&b.setValue(f,a.getValue(f)))}};McxFeatureHelper.prototype.groupByLayer=function(a){return McxFeatureGroup.groupFeatures(a)};
McxFeatureHelper.prototype.getScreenFeatures=function(a){for(var b=[],c=a.getLayers().toLayerArray(),d=0;d<c.length;d++)var e=a.getPaintedFeatures(c[d]).getAll(),b=b.concat(e);return b};McxFeatureHelper.prototype.getLayers=function(a){a=McxFeatureGroup.groupFeatures(a);for(var b=[],c=0;c<a.length;c++)b.push(a[c].getLayer());return b};
McxFeatureHelper.prototype.getFeatureWithId=function(a,b){var c=new McxAjaxParameter;c.setAsync(!1);c=a.getFeatures("",c).getFeatureReader();if(null==c)return null;for(;c.read();){var d=c.getCurrent();if(d.getFeatureID()==b)return d}return null};
McxFeatureHelper.prototype.getCodedValueOfField=function(a,b,c){var d=new McxAjaxParameter;d.setAsync(!1);for(var e=a.getDataSourceName(),d=a.getDataSource().getDomains(e,d).getDomains(),e=0;e<a.getSchema().getFieldCount();e++)if(a.getSchema().getField(e).getFieldName()==b){if(null==a.getSchema().getField(e).getDomainName())break;for(var f=0;f<d.length;f++)if(a.getSchema().getField(e).getDomainName()==d[f].getDomainName())for(var g=d[f].getCodedValues(),h=0;h<g.length;h++)if(g[h].getCode().toString()==
c)return g[h].getValue()}return null};McxFeatureHelper.prototype.getBB=function(a){a instanceof Array||(a=[a]);for(var b=[],c=0;c<a.length;c++){var d=a[c].getGeometry();d&&null!=d&&(d=d.getBounds(),b.push(d))}return b};McxFeatureHelper.instance=new McxFeatureHelper;js.builtin.McxBase.McxFieldSet={};function McxFieldSet(a,b){this.layer=a;this.fields=[];this.fields=b instanceof Array?b:[b]}McxFieldSet.prototype.getFields=function(){return this.fields};McxFieldSet.prototype.getLayer=function(){return this.layer};js.builtin.McxBase.McxGeometryHelper={};function McxGeometryHelper(){this.drawSnapSensitivity=15;this.areaDrawPointCount=64}
McxGeometryHelper.prototype.getPoints=function(a,b){var c=a.getGeometry().transformTo(b);if(c.isInstanceOf(McxGeometryType.Point))return[c];if(c.isInstanceOf(McxGeometryType.MultiPoint))return c.getPoints();if(c.isInstanceOf(McxGeometryType.LineString))return c.getPoints();if(c.isInstanceOf(McxGeometryType.MultiLineString)){for(var d=c.getLines(),e=[],c=0;c<d.length;c++)e=e.concat(d[c].getPoints());return e}if(c.isInstanceOf(McxGeometryType.Polygon)){for(var e=[],e=e.concat(c.getShell().getPoints()),
d=c.getHoles(),f=0;f<d.length;f++)e=e.concat(d[f].getPoints());return e}if(c.isInstanceOf(McxGeometryType.MultiPolygon)){for(var g=c.getPolygons(),e=[],c=0;c<g.length;c++)for(e=e.concat(g[c].getShell().getPoints()),d=g[c].getHoles(),f=0;f<d.length;f++)e=e.concat(d[f].getPoints());return e}return[]};McxGeometryHelper.prototype.removeRepeated=function(a){for(var b=!1,c=null,d=[],e=0;e<a.length-1;e++)a[e].equals(a[e+1])?b&&a[e].equals(c)||(b=!0,c=a[e].clone(),d.push(c)):b=!1;return d};
McxGeometryHelper.prototype.checkLayerGeometryTypesEquivalence=function(a,b){switch(a){case McxGeometryType.Point:if(b!=McxGeometryType.Point)return!1;break;case McxGeometryType.LineString:if(b!=McxGeometryType.LineString&&b!=McxGeometryType.LineSegment)return!1;break;case McxGeometryType.Polygon:if(b!=McxGeometryType.Polygon)return!1;break;case McxGeometryType.MultiPoint:if(b!=McxGeometryType.Point&&b!=McxGeometryType.MultiPoint)return!1;break;case McxGeometryType.MultiLineString:if(b!=McxGeometryType.MultiLineString&&
b!=McxGeometryType.LineString&&b!=McxGeometryType.LineSegment)return!1;break;case McxGeometryType.MultiPolygon:if(b!=McxGeometryType.MultiPolygon&&b!=McxGeometryType.Polygon)return!1;break;case McxGeometryType.LinearRing:if(b!=McxGeometryType.LinearRing)return!1;break;case McxGeometryType.LineSegment:if(b!=McxGeometryType.LineSegment)return!1;break;case McxGeometryType.None:return!1}return!0};
McxGeometryHelper.prototype.createGeometryWithType=function(a,b,c){var d=null,e=McxFactoryFinder.GeometryFactory(c);switch(b){case McxGeometryType.Unknown:d=a.clone().transformTo(c);break;case McxGeometryType.Point:a.isInstanceOf(McxGeometryType.Point)&&(d=a.clone().transformTo(c));break;case McxGeometryType.LineSegment:a.isInstanceOf(McxGeometryType.LineSegment)&&(d=a.clone().transformTo(c));break;case McxGeometryType.LineString:a.isInstanceOf(McxGeometryType.LineString)?d=a.clone().transformTo(c):
a.isInstanceOf(McxGeometryType.LineSegment)&&(d=a.clone().transformTo(c),d=e.createLineString([d.getPoints()]));break;case McxGeometryType.LinearRing:a.isInstanceOf(McxGeometryType.LinearRing)&&(d=a.clone().transformTo(c));break;case McxGeometryType.Polygon:a.isInstanceOf(McxGeometryType.Polygon)&&(d=a.clone().transformTo(c));break;case McxGeometryType.MultiPoint:a.isInstanceOf(McxGeometryType.MultiPoint)?d=a.clone().transformTo(c):a.isInstanceOf(McxGeometryType.Point)&&(d=a.clone().transformTo(c),
d=e.createMultiPoint([d]));break;case McxGeometryType.MultiLineString:a.isInstanceOf(McxGeometryType.MultiLineString)?d=a.clone().transformTo(c):a.isInstanceOf(McxGeometryType.LineString)?(d=a.clone().transformTo(c),d=e.createMultiLineString([d])):a.isInstanceOf(McxGeometryType.LineSegment)&&(d=a.clone().transformTo(c),d=e.createLineString([d.getPoints()]),d=e.createMultiLineString([d]));break;case McxGeometryType.MultiPolygon:a.isInstanceOf(McxGeometryType.MultiPolygon)?d=a.clone().transformTo(c):
a.isInstanceOf(McxGeometryType.Polygon)&&(d=a.clone().transformTo(c),d=e.createMultiPolygon([d]));break;case McxGeometryType.GeometryCollection:d=a.clone().transformTo(c)}return d};McxGeometryHelper.prototype.setDrawingSettingValues=function(){var a=McxSettingsManager.read("DrawSettings",null).getSettings(),b="";a&&0<a.length&&(b=JSON.parse(a[0]),this.drawSnapSensitivity=parseInt(b.DrawSnapSensitivity,10),this.areaDrawPointCount=parseInt(b.AreaDrawPointCount,10))};
McxGeometryHelper.prototype.setSelectionSettings=function(a,b){McxSettingsManager.write("DrawSettings",JSON.stringify({DrawSnapSensitivity:a.toString(),AreaDrawPointCount:b.toString()}),null)};McxGeometryHelper.prototype.getSnapSensitivity=function(){return this.drawSnapSensitivity};McxGeometryHelper.prototype.getAreaDrawPointCount=function(){return this.areaDrawPointCount};
McxGeometryHelper.prototype.getBB=function(a,b){a instanceof Array||(a=[a]);for(var c=null,d=0;d<a.length;d++){var e=a[d];e&&null!=e&&(e=e.getBounds().transformTo(b),c=null==c?e:e.merge(c))}return c};McxGeometryHelper.instance=new McxGeometryHelper;js.builtin.McxBase.McxMarkerHelper={};function McxMarkerHelper(){}
McxMarkerHelper.prototype.createMarker=function(a,b,c){a.length||(a=[a]);for(var d=[],e=0;e<a.length;e++){var f=a[e],g=null,h=f.getGeometry();null!=h&&(null!=c&&(h=h.transformTo(c)),h.isInstanceOf(McxGeometryType.Polygon)?(g=new McxPolygonMarker(h.clone(),b),f=f.getLayer().getSymbolizer().getPolygonSymbolizer().clone(),null!=f.getFill()&&f.getFill().setColor("transparent"),g.setSymbolizer(f)):h.isInstanceOf(McxGeometryType.MultiPolygon)?(g=new McxMultiPolygonMarker(h.clone(),b),f=f.getLayer().getSymbolizer().getPolygonSymbolizer().clone(),
null!=f.getFill()&&f.getFill().setColor("transparent"),g.setSymbolizer(f)):h.isInstanceOf(McxGeometryType.MultiLineString)?(g=new McxMultiLineStringMarker(h.clone(),b),g.setSymbolizer(f.getLayer().getSymbolizer().getLineSymbolizer())):h.isInstanceOf(McxGeometryType.LineString)||h.isInstanceOf(McxGeometryType.MultiLineString)?(g=new McxLineStringMarker(h.clone(),b),g.setSymbolizer(f.getLayer().getSymbolizer().getLineSymbolizer())):h.isInstanceOf(McxGeometryType.Point)&&(g=new McxPointMarker(h.clone(),
b),g.setSymbolizer(f.getLayer().getSymbolizer().getPointSymbolizer())),null!=g&&d.push(g))}return d};
McxMarkerHelper.prototype.createMarkerFromGeometry=function(a,b){a.length||(a=[a]);for(var c=[],d=0;d<a.length;d++){var e=a[d],f=null;e.isInstanceOf(McxGeometryType.Polygon)?(f=new McxPolygonMarker(e.clone(),b),e=McxFactoryFinder.StyleFactory().createPolygonSymbolizer(),f.setSymbolizer(e)):e.isInstanceOf(McxGeometryType.MultiPolygon)?(f=new McxMultiPolygonMarker(e.clone(),b),e=McxFactoryFinder.StyleFactory().createPolygonSymbolizer(),f.setSymbolizer(e)):e.isInstanceOf(McxGeometryType.LineString)||
e.isInstanceOf(McxGeometryType.MultiLineString)?(f=new McxLineStringMarker(e.clone(),b),f.setSymbolizer(McxFactoryFinder.StyleFactory().createLineSymbolizer())):e.isInstanceOf(McxGeometryType.Point)&&(f=new McxPointMarker(e.clone(),b),f.setSymbolizer(McxFactoryFinder.StyleFactory().createPointSymbolizer()));null!=f&&c.push(f)}return c};McxMarkerHelper.instance=new McxMarkerHelper;js.builtin.McxBase.McxSelectFilter={};function McxSelectFilter(){this.selectMode=McxSelectMode.Add;this.geometryTypes=[];this.fieldSets=[];this.polygonBoundarySelect=!0;this.spatialRelation=McxSpatialRelation.Intersects;this.geometry=null}McxSelectFilter.prototype.getSelectMode=function(){return this.selectMode};McxSelectFilter.prototype.setSelectMode=function(a){this.selectMode=a};McxSelectFilter.prototype.getGeometryTypes=function(){return this.geometryTypes};
McxSelectFilter.prototype.setGeometryTypes=function(a){this.geometryTypes=a};McxSelectFilter.prototype.getFieldSets=function(){return this.fieldSets};McxSelectFilter.prototype.setFieldSets=function(a){this.fieldSets=a};McxSelectFilter.prototype.getPolygonBoundarySelect=function(){return this.polygonBoundarySelect};McxSelectFilter.prototype.setPolygonBoundarySelect=function(a){this.polygonBoundarySelect=a};McxSelectFilter.prototype.getSpatialRelation=function(){return this.spatialRelation};
McxSelectFilter.prototype.setSpatialRelation=function(a){this.spatialRelation=a};McxSelectFilter.prototype.getGeometry=function(){return this.geometry};McxSelectFilter.prototype.setGeometry=function(a){this.geometry=a};js.builtin.McxBase.McxSelectionHelper={};function McxSelectionHelper(){this.maxSelectionCount=400;this.selectCountPerRequest=200;this._isSelectionFull=!1;this.requestTimeout=45E3;this.snapSensitivity=10;this.gridShowCount=20;this._selectionCountChangeHandler=new McxEventHandler}
McxSelectionHelper.prototype.setSelectionSettingValues=function(){var a=McxSettingsManager.read("SelectionSettings",null).getSettings(),b="";a&&0<a.length&&(b=JSON.parse(a[0]),this.maxSelectionCount=parseInt(b.MaximumSelectionCount,10),this.selectCountPerRequest=parseInt(b.SelectionCountPerRequest,10),this.requestTimeout=parseInt(b.SelectionRequestTimeOut,10),this.snapSensitivity=parseInt(b.SelectionSensitivity,10),this.gridShowCount=parseInt(b.GridShowCount,10))};
McxSelectionHelper.prototype.setSelectionSettings=function(a,b,c,d,e){McxSettingsManager.write("SelectionSettings",JSON.stringify({MaximumSelectionCount:a.toString(),SelectionCountPerRequest:b.toString(),SelectionRequestTimeOut:c.toString(),SelectionSensitivity:d.toString(),GridShowCount:e.toString()}),null)};
McxSelectionHelper.prototype.hitTest=function(a,b){for(var c=b.getFieldSets(),d=function(c){for(var d=c.getFeatureReader(),e=[];d.read();){var f=d.getCurrent();if(null!=f)if(f.isInstanceOf("McxMemFeature")){var g=new McxMemFeature(f.getLayer(),f.getLayer().getSchema());g.createFromFeature(f);e.push(g)}else e.push(f)}c=new McxSelectResult(b,e,c.getLayer(),a.getArgs());a.getSuccess().call(a.getScope(),c)},e=function(c){c=c.getArgs()[1];var d=new McxSelectResult(b,null,null,a.getArgs());c.getError().call(c.getScope(),
d)},f=0;f<c.length;f++){var g=c[f],h=g.getLayer();if(this.checkLayer(h,b)&&h.getVisible()){var g=g.getFields(),k=new McxAjaxParameter;k.setParameters(d,d,e);k.setArgs(a.getArgs());var m="";if(null==g||0>=g.length||1==g.length&&""==g[0]||1==g.length&&null==g[0])m="";else for(var m="",n=0;n<g.length;n++)m+=g[n],n<g.length-1&&(m+=",");this.hitTestByLayer(k,h,b,m)}else h=new McxSelectResult(b,[],h,a.getArgs()),a.getError().call(a.getScope(),h)}};
McxSelectionHelper.prototype.hitTestByLayer=function(a,b,c,d){if(null==d||""==d)d=b.getKeyField()+","+b.getGeometryField();var e=c.getGeometry(),e=null!=e.getCoordinateSystem()||null!=b.getCoordinateSystem()?e.transformTo(b.getCoordinateSystem()):e;b.isInstanceOf("McxFsLayer");return b.search(d,b.getFilterCollection().toString(),e,c.getSpatialRelation(),a)};
McxSelectionHelper.prototype.hitTestByScreenFeatures=function(a,b,c){a=[];var d=c.getGeometry();c=c.getSpatialRelation();if("Intersects"==c)for(var e in b)c=b[e],c.intersects(d)&&(a[e]=c);else if("Contains"==c)for(e in b[e])c=b[e],d.contains(c)&&(a[e]=c);else if("Within"==c)for(e in b[e])c=b[e],c.contains(d)&&(a[e]=c);return a};
McxSelectionHelper.prototype.checkGeometryType=function(a,b){if(null==b.getGeometryTypes())return!0;for(var c=this.getGeometryType(a),d=0;d<b.getGeometryTypes().length;d++)if(b.getGeometryTypes()[d]==c)return!0;return!1};
McxSelectionHelper.prototype.getGeometryType=function(a){if(a.isInstanceOf(McxGeometryType.Point))return McxGeometryType.Point;if(a.isInstanceOf(McxGeometryType.Polygon))return McxGeometryType.Polygon;if(a.isInstanceOf(McxGeometryType.LinearRing))return McxGeometryType.LinearRing;if(a.isInstanceOf(McxGeometryType.GeometryCollection))return McxGeometryType.GeometryCollection;if(a.isInstanceOf(McxGeometryType.LineString))return McxGeometryType.LineString;if(a.isInstanceOf(McxGeometryType.MultiLineString))return McxGeometryType.MultiLineString;
if(a.isInstanceOf(McxGeometryType.MultiPoint))return McxGeometryType.MultiPoint;if(a.isInstanceOf(McxGeometryType.None))return McxGeometryType.None;a.isInstanceOf(McxGeometryType.Unknown);return McxGeometryType.Unknown};McxSelectionHelper.prototype.checkLayer=function(a,b){if(null==b.getFieldSets())return!1;for(var c=0;c<b.getFieldSets().length;c++)if(b.getFieldSets()[c].getLayer().getClassId()==a.getClassId())return!0;return!1};
McxSelectionHelper.prototype.clearSelection=function(a){this._isSelectionFull=!1;a=a.getLayers().toLayerArray();for(var b=0;b<a.length;b++)a[b].clearSelection()};McxSelectionHelper.prototype.checkSelection=function(a){if(0<this.getSelectionCount(a))return!0;(a=McxLocalizationManager.getLocaleValue("McxBase-mustSelectFeature"))&&""!=a&&McxMessageBox.show("",a,McxMessageBoxType.Warning,McxDialogButtons.ok);return!1};
McxSelectionHelper.prototype.getSelectionCount=function(a){var b=0;a=a.getLayers().toLayerArray();for(var c=0;c<a.length;c++)b+=a[c].getSelectionCount();return b};McxSelectionHelper.prototype.getSelection=function(a){var b=[];a=a.getLayers().toLayerArray();for(var c=0;c<a.length;c++){var d=a[c];if(d.isInstanceOf("McxFsLayer")||d.isInstanceOf("McxMemLayer"))for(var d=d.getSelection(),e=0;d.read()&&!(b.push(d.getCurrent()),e++,e>this.maxSelectionCount););}return b};
McxSelectionHelper.prototype.getSelectableLayer=function(a){var b=[];a=a.getLayers().toLayerArray();for(var c=0;c<a.length;c++){var d=a[c];d.isSelectable()&&b.push(d)}return b};McxSelectionHelper.prototype.isSelected=function(a){return a.getLayer().isFeatureSelected(a)};
McxSelectionHelper.prototype.applyFilter=function(a,b,c){var d=new McxAjaxParameter;d.setParameters(this,function(d){var f=d.getFeatures();if(null==f||0==f.length)return null;switch(c.getSelectMode()){case McxSelectMode.Add:this.addSelection(b,f);break;case McxSelectMode.Remove:this.removeSelection(b,f);break;default:this.clearSelection(b),this.addSelection(b,f)}d=new McxSelectResult(c,f,d.getLayer(),a.getArgs());a.getSuccess().call(a.getScope(),d)},function(){});this.hitTest(d,c)};
McxSelectionHelper.prototype.addSelection=function(a,b){for(var c=McxFeatureGroup.groupFeatures(b),d=[],e=this.getSelectionCount(a),f=0;f<c.length;f++){for(var g=c[f],h=!1,k=g.getLayer(),g=g.getFeatures(),m=0;m<g.length;m++){var n=g[m],p=n.getLayer().findFeature(n.getFeatureID()).getGeometry();n.setGeometry(p);if(++e>=this.maxSelectionCount){this._isSelectionFull=!0;McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxBase-MaxSelectionCountExceeded"),McxMessageBoxType.Error);h=!0;break}for(var q=
this._isSelectionFull=!1,p=0;p<b.length;p++)if(!McxSelectionHelper.instance.isSelected(b[p])){q=!0;break}k.addSelection(n)}q&&d.push(k);if(h)break}0<d.length&&a.getRenderer().paintSelections()};
McxSelectionHelper.prototype.removeSelection=function(a,b){if(null!=b&&null!=a){b.length||(b=[b]);for(var c=McxFeatureGroup.groupFeatures(b),d=[],e=0;e<c.length;e++){for(var f=c[e],g=f.getLayer(),h=!1,f=f.getFeatures(),k=0;k<b.length;k++)if(McxSelectionHelper.instance.isSelected(b[k])){h=!0;break}g.removeSelection(f);h&&d.push(g)}0<d.length&&a.getRenderer().paintSelections()}};McxSelectionHelper.instance=new McxSelectionHelper;McxSelectionHelper.prototype.getMaxSelectionCount=function(){return this.maxSelectionCount};
McxSelectionHelper.prototype.getAvailableSelectionCount=function(a){return this.maxSelectionCount-this.getSelectionCount(a)};McxSelectionHelper.prototype.getSelectionStatus=function(){return this._isSelectionFull};McxSelectionHelper.prototype.getSelectionRequestTimeout=function(){return this.requestTimeout};McxSelectionHelper.prototype.getSnapSensitivity=function(){return this.snapSensitivity};McxSelectionHelper.prototype.getGridShowCount=function(){return this.gridShowCount};
McxSelectionHelper.prototype.getSelectCountPerRequest=function(){return this.selectCountPerRequest};McxSelectionHelper.prototype.getSelectionCountChangeHandler=function(){return this._selectionCountChangeHandler};js.builtin.McxBase.McxSelectMode={};var McxSelectMode={Create:0,Add:1,Remove:2,SelectFromCurrentSelection:3};js.builtin.McxBase.McxSelectResult={};function McxSelectResult(a,b,c,d){mcx.base(this,d);this.filter=a;this.features=b;this.layer=c}mcx.inherits(McxSelectResult,McxResult);McxSelectResult.prototype.getFilter=function(){return this.filter};McxSelectResult.prototype.getFeatures=function(){return this.features};McxSelectResult.prototype.getLayer=function(){return this.layer};js.builtin.McxBase.McxSelectToolMode={};var McxSelectToolMode={Fence:0,LineString:1,Polygon:2,Circle:3};js.builtin.McxBase.Controller={};js.builtin.McxBase.Controller.IMcxDrawController={};function IMcxDrawController(){}IMcxDrawController.prototype.getDrawingCompletedEventHandler=function(){};js.builtin.McxBase.Controller.McxController={};function McxController(){this.map=null;this.cursor=McxCursors.Default;this.description="";this.descriptionChangedEventHandler=new McxEventHandler;this.cursorChangedEventHandler=new McxEventHandler}McxController.prototype.onStartInteraction=function(){};McxController.prototype.onEndInteraction=function(){};McxController.prototype.getCursor=function(){return this.cursor};McxController.prototype.getDescription=function(){return this.description};
McxController.prototype.startInteraction=function(a){null!=a&&(this.map=a,this.onStartInteraction())};McxController.prototype.endInteraction=function(){this.onEndInteraction()};McxController.prototype.paint=function(a){};McxController.prototype.onMouseClick=function(a){};McxController.prototype.onMouseWheel=function(a){};McxController.prototype.onMouseMove=function(a){};McxController.prototype.onMouseUp=function(a){};
McxController.prototype.onMouseDown=function(a){if("right"==a.getButton()){var b=new McxContextMenu;b.setPosition(a.getY(),a.getX());this.onContextMenuShown(b)}};McxController.prototype.onContextMenuShown=function(a){};McxController.prototype.onKeyPress=function(a){};McxController.prototype.onKeyUp=function(a){};McxController.prototype.onKeyDown=function(a){};McxController.prototype.onTap=function(a){};McxController.prototype.onHold=function(a){};McxController.prototype.onDoubleTap=function(a){};
McxController.prototype.onPinch=function(a){};McxController.prototype.onSwipe=function(a){};McxController.prototype.onSwipeLeft=function(a){};McxController.prototype.onSwipeRight=function(a){};McxController.prototype.onSwipeUp=function(a){};McxController.prototype.onSwipeDown=function(a){};McxController.prototype.onRotate=function(a){};McxController.prototype.onDragStart=function(a){};McxController.prototype.onDragEnd=function(a){};McxController.prototype.onDrag=function(a){};
McxController.prototype.getDescriptionChangedEventHandler=function(){return this.descriptionChangedEventHandler};McxController.prototype.getCursorChangedEventHandler=function(){return this.cursorChangedEventHandler};McxController.prototype.onCursorChanged=function(){this.cursorChangedEventHandler.dispatchOnSuccess(this,null)};McxController.prototype.onDescriptionChanged=function(){this.descriptionChangedEventHandler.dispatchOnSuccess(this,null)};
McxController.prototype.setDescription=function(a){this.description=a;this.onDescriptionChanged()};McxController.prototype.setCursor=function(a){this.cursor=a;this.onCursorChanged()};McxController.prototype.isInstanceOf=function(a){return"McxController"==a||"IMcxMouseListener"==a||"IMcxTouchListener"==a||"IMcxKeyListener"==a};McxController.prototype.getOptionUI=function(){};McxController.prototype.reset=function(){};js.builtin.McxBase.Controller.McxCompositeController={};function McxCompositeController(){mcx.base(this);this.currentStep=0;this.controllers=[];this.currentController=null;this.base=this}mcx.inherits(McxCompositeController,McxController);McxCompositeController.prototype.onStartInteraction=function(){this.currentStep=0;this.performNextStep()};McxCompositeController.prototype.add=function(a){this.controllers.push(a)};McxCompositeController.prototype.getCurrentStep=function(){return this.currentStep};
McxCompositeController.prototype.performNextStep=function(){this.currentStep>=this.controllers.length||this.nextStep(this.controllers[this.currentStep],this.currentStep)||(this.currentController=this.controllers[this.currentStep],this.currentController.getCursorChangedEventHandler().addListener(this.controllerCursorChanged,null,this),this.currentController.getDescriptionChangedEventHandler().addListener(this.controllerDescriptionChanged,null,this),this.currentController.startInteraction(this.map),
this.currentStep++)};McxCompositeController.prototype.nextStep=mcx.abstractMethod;McxCompositeController.prototype.reset=function(){this.currentStep=0};McxCompositeController.prototype.onEndInteraction=function(){for(var a=this.currentStep=0;a<this.controllers.length;a++)this.controllers[a].endInteraction()};McxCompositeController.prototype.controllerCursorChanged=function(){this.base.setCursor(this.currentController.getCursor())};McxCompositeController.prototype.controllerDescriptionChanged=function(){};
McxCompositeController.prototype.paint=function(a){McxCompositeController.superClass_.paint.call(this,a);null!=this.currentController&&this.currentController.paint(a)};McxCompositeController.prototype.onMouseClick=function(a){McxCompositeController.superClass_.onMouseClick.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxMouseListener"))this.currentController.onMouseClick(a)};
McxCompositeController.prototype.onMouseWheel=function(a){McxCompositeController.superClass_.onMouseWheel.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxMouseListener"))this.currentController.onMouseWheel(a)};McxCompositeController.prototype.onMouseMove=function(a){McxCompositeController.superClass_.onMouseMove.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxMouseListener"))this.currentController.onMouseMove(a)};
McxCompositeController.prototype.onMouseUp=function(a){McxCompositeController.superClass_.onMouseUp.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxMouseListener"))this.currentController.onMouseUp(a);"right"==a.getButton()&&this.performNextStep()};McxCompositeController.prototype.onMouseDown=function(a){McxCompositeController.superClass_.onMouseDown.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxMouseListener"))this.currentController.onMouseDown(a)};
McxCompositeController.prototype.onKeyDown=function(a){McxCompositeController.superClass_.onKeyDown.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxKeyListener"))this.currentController.onKeyDown(a)};McxCompositeController.prototype.onKeyPress=function(a){McxCompositeController.superClass_.onKeyPress.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxKeyListener"))this.currentController.onKeyPress(a)};
McxCompositeController.prototype.onKeyUp=function(a){McxCompositeController.superClass_.onKeyUp.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxKeyListener"))this.currentController.onKeyUp(a)};McxCompositeController.prototype.onTap=function(a){McxCompositeController.superClass_.onTap.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxTouchListener"))this.currentController.onTap(a)};
McxCompositeController.prototype.onDoubleTap=function(a){McxCompositeController.superClass_.onDoubleTap.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxTouchListener"))this.currentController.onDoubleTap(a)};McxCompositeController.prototype.onPinchIn=function(a){McxCompositeController.superClass_.onPinchIn.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxTouchListener"))this.currentController.onPinchIn(a)};
McxCompositeController.prototype.onPinchOut=function(a){McxCompositeController.superClass_.onPinchOut.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxTouchListener"))this.currentController.onPinchOut(a)};McxCompositeController.prototype.onSwipe=function(a){McxCompositeController.superClass_.onSwipe.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxTouchListener"))this.currentController.onSwipe(a)};
McxCompositeController.prototype.onSwipeLeft=function(a){McxCompositeController.superClass_.onSwipeLeft.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxTouchListener"))this.currentController.onSwipeLeft(a)};McxCompositeController.prototype.onSwipeRight=function(a){McxCompositeController.superClass_.onSwipeRight.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxTouchListener"))this.currentController.onSwipeRight(a)};
McxCompositeController.prototype.onSwipeUp=function(a){McxCompositeController.superClass_.onSwipeUp.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxTouchListener"))this.currentController.onSwipeUp(a)};McxCompositeController.prototype.onSwipeDown=function(a){McxCompositeController.superClass_.onSwipeDown.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxTouchListener"))this.currentController.onSwipeDown(a)};
McxCompositeController.prototype.onRotate=function(a){McxCompositeController.superClass_.onRotate.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxTouchListener"))this.currentController.onRotate(a)};McxCompositeController.prototype.onDragStart=function(a){McxCompositeController.superClass_.onDragStart.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxTouchListener"))this.currentController.onDragStart(a)};
McxCompositeController.prototype.onDragEnd=function(a){McxCompositeController.superClass_.onDragEnd.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxTouchListener"))this.currentController.onDragEnd(a)};McxCompositeController.prototype.onDrag=function(a){McxCompositeController.superClass_.onDrag.call(this,a);if(null!=this.currentController&&this.currentController.isInstanceOf("IMcxTouchListener"))this.currentController.onDrag(a)};
McxCompositeController.prototype.isInstanceOf=function(a){return"McxCompositeController"==a};js.builtin.McxBase.Controller.McxDetectValueController={};function McxDetectValueController(a){mcx.base(this);this._lastTimeMouseMoved=0;this._value="";this._y=this._x=0;this.base=this;this._timerId=0;this.format=["yukseklik = {0}"];this.layer=[];this.layer=a instanceof Array?a:[a]}mcx.inherits(McxDetectValueController,McxController);
McxDetectValueController.prototype.onMouseMove=function(a){null!=this.layer&&(this._lastTimeMouseMoved=(new Date).getTime(),this._x=a.getX(),this._y=a.getY(),this._value="",clearTimeout(this._timerId),this._timerId=setTimeout($.proxy(this.getValue,this),500))};
McxDetectValueController.prototype.getValue=function(){if(!(500>(new Date).getTime()-this._lastTimeMouseMoved)){var a=this.map.viewToWorld(this._x,this._y),b=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(4326),b=McxFactoryFinder.GeometryFactory(b).createPoint(a.x,a.y),c=this.base.map.getLayers(),d=Number.MIN_VALUE;this.base.map.getMarkerCollection().clear();for(var e=0;e<c.getCount();e++)for(var f=this.base.map.getLayers().getAt(e),g=0;g<this.layer.length;g++)if(f.getName()==this.layer[g].getName()){var h=
c.getCanvasByIndex(e);h.isInstanceOf("McxImageCanvas")&&(h=h.getColorWithPoint(a),"255"==h&&(h="DEGER YOK"),""!=h&&(d=d==Number.MIN_VALUE?String.format(this.format[g],h):d+("&"+String.format(this.format[g],h))))}""!=d&&(a=$("<div>").html(d).addClass("railfall-result-container"),a=new McxContentMarker(b,McxGuid.createGuid(),a),this.base.map.getMarkerCollection().add(a));this.base.map.getRenderer().paintNonLayer()}};McxDetectValueController.prototype.setFormat=function(a){this.format=a};
McxDetectValueController.prototype.setLayer=function(a){this.layer=a instanceof Array?a:[a]};js.builtin.McxBase.Controller.McxDrawingCompletedEventArgs={};function McxDrawingCompletedEventArgs(a){mcx.base(this,null);this.geometry=a}mcx.inherits(McxDrawingCompletedEventArgs,McxEventArgs);McxDrawingCompletedEventArgs.prototype.getGeometry=function(){return this.geometry};js.builtin.McxBase.Controller.McxSnappableController={};
function McxSnappableController(){mcx.base(this);this.currentPoint=this.snapFinder=this.cursorPosition=this.lastCreatedPoint=this.lastPoint=this.dlg=null;this.snapUse=this.freeSnap=!0;this.points=[];this.removedCoordinates=[];this.addedCoordinates=[];this.sPressedBefore=!1;this.sPressedCounter=0;this.removedCoordinateFirst=this.removedCoordinateLast=null;this.isReadBefore=this.isFirstPass=!1;this.lineCoordinates=[];this.firstLineCoordinates=[];this.secondLineCoordinates=[];this.pointListChangedEventHandler=
new McxEventHandler;this.drawLines=[];this.base=this}mcx.inherits(McxSnappableController,McxController);McxSnappableController.prototype.onStartInteraction=function(){this.snapFinder=new McxSnapFinder(this.map)};McxSnappableController.prototype.onEndInteraction=function(){null!=this.snapFinder&&this.snapUse&&(this.snapFinder.clearGlobalEngine(),this.snapFinder.putTarget(null,this.lastPoint));this.sketchUndoFinish()};
McxSnappableController.prototype.paint=function(a){if(null!=this.drawLines&&!(0>=this.drawLines.length)&&this.sPressedBefore){var b=McxFactoryFinder.StyleFactory().createLineSymbolizer();b.getStroke().setColor("red");b.getStroke().setWidth(4);a.getGeodeticGraphics().drawLineString(this.drawLines,b,1,0,0)}};
McxSnappableController.prototype.onMouseDown=function(a){McxSnappableController.superClass_.onMouseDown.call(this,a);if("left"==a.getButton()){this.sPressedBefore&&(this.sPressedBefore=!1,this.sPressedCounter=0,this.isReadBefore=!1,this.drawLines=[],this.lineCoordinates=[]);this.currentPoint=new McxPoint(a.getX(),a.getY(),null);var b=this.snapPoint(this.currentPoint,this.lastPoint);this.lastPoint=McxFactoryFinder.GeometryFactory(null).createPoint(a.getX(),a.getY());this.cursorPosition=b;if(null==
b)this.freeSnap&&(b=this.map.viewToWorld(a.getX(),a.getY()),this.onCoordinateCreated(a,b));else this.onCoordinateCreated(a,b)}};McxSnappableController.prototype.onMouseMove=function(a){if(null!=this.snapFinder&&this.snapUse){this.snapFinder.clearGlobalEngine();var b=McxFactoryFinder.GeometryFactory(null).createPoint(a.getX(),a.getY());this.snapFinder.putTarget(b,this.lastPoint)}this.cursorPosition=this.map.viewToWorld(a.getX(),a.getY());this.map.getRenderer().paintNonLayer()};
McxSnappableController.prototype.snapPoint=function(a,b){if(null==this.snapFinder||!this.snapUse)return this.map.viewToWorld(a.getX(),a.getY());var c=this.snapFinder.acceptTarget(a);if(null!=c&&!isNaN(c.getX())&&!isNaN(c.getY()))return c;this.snapFinder.isFreeSnapUsable();return null};
McxSnappableController.prototype.onKeyPress=function(a){McxSnappableController.superClass_.onKeyPress.call(this,a);if(a.getKeyCode()==McxKeyCode.n)this.onGenerateCoordinate();else a.getKeyCode()!=McxKeyCode.s||2>this.points.length&&!this.sPressedBefore||(this.sPressedCounter++,null!=this.lineCoordinates&&this.sPressedCounter==this.lineCoordinates.length+1&&(this.sPressedCounter=1),1!=this.sPressedCounter||this.sPressedBefore||(this.isFirstPass=!0,this.removedCoordinateLast=this.points[this.points.length-
1],this.points.pop(),this.removedCoordinateFirst=this.points[this.points.length-1],this.points.pop()),this.sPressedBefore=!0,this.onCompleteCoordinates(),this.map.getRenderer().paintNonLayer())};
McxSnappableController.prototype.onCompleteCoordinates=function(){if(!this.isReadBefore){this.lineCoordinates=[];for(var a=this.map.getLayers().toLayerArray(),b=0;b<a.length;b++){var c=a[b];if((c.isInstanceOf("McxFsLayer")||c.isInstanceOf("McxMemLayer"))&&c.getVisible()&&this.base.map.inVisibleRange(c.getMinScale(),c.getMaxScale())){var c=this.map.getPaintedFeatures(c).geometries,d;for(d in c){var e=c[d].transformTo(this.base.map.getCoordinateSystem());this.isReadBefore=!0;if(e.isInstanceOf(McxGeometryType.Polygon))this.readPolygon(e);
else if(e.isInstanceOf(McxGeometryType.MultiPolygon))for(var e=e.getPolygons(),f=0;f<e.length;f++)this.readPolygon(e[f]);else if(e.isInstanceOf(McxGeometryType.LineString)){var e=e.getPoints(),g=0,h=0,f=0,k=!1;for(d=0;d<e.length;d++)if(e[d].equals(this.removedCoordinateFirst)&&(g++,h=d),e[d].equals(this.removedCoordinateLast)&&(g++,f=d),2==g){k=!0;break}if(k){g=[];if(h>f)for(;h>=f;h--)g.push(e[h]);else for(;h<=f;h++)g.push(e[h]);e=[];this.lineCoordinates.push(g);e.push(this.removedCoordinateFirst);
this.lineCoordinates.push(e)}}}}}}if(!(0>=this.lineCoordinates.length)){if(1==this.sPressedCounter){if(0<this.points.length&&this.points[this.points.length-1].equals(this.lineCoordinates[this.lineCoordinates.length-1][this.lineCoordinates[this.lineCoordinates.length-1].length-1])&&this.isFirstPass)for(b=0;b<this.lineCoordinates[this.lineCoordinates.length-1].length;b++)this.points.pop()}else for(b=0;b<this.lineCoordinates[this.sPressedCounter-2].length;b++)this.points.pop();this.points=this.points.concat(this.lineCoordinates[this.sPressedCounter-
1]);this.drawLines=this.lineCoordinates[this.sPressedCounter-1];this.isFirstPass=!1}};
McxSnappableController.prototype.readPolygon=function(a){a=a.getShell().getPoints();for(var b=0,c=0,d=0,e=!1,f=0;f<a.length;f++){if(2==b){e=!0;break}a[f].equals(this.removedCoordinateFirst)?(b++,c=f):a[f].equals(this.removedCoordinateLast)&&(b++,d=f)}if(!e)return!1;if(c>d){this.firstLineCoordinates=[];this.secondLineCoordinates=[];for(b=c;b<a.length;b++)this.firstLineCoordinates.push(a[b]);for(b=0;b<=d;b++)this.firstLineCoordinates.push(a[b]);b=c}else{this.firstLineCoordinates=[];this.secondLineCoordinates=
[];for(b=c;b<=d;b++)this.firstLineCoordinates.push(a[b]);for(b=c;0<=b;b--)this.secondLineCoordinates.push(a[b]);b=a.length-1}for(;b>=d;b--)this.secondLineCoordinates.push(a[b]);a=[];a.push(this.removedCoordinateFirst);this.lineCoordinates.push(this.secondLineCoordinates);this.lineCoordinates.push(this.firstLineCoordinates);this.lineCoordinates.push(a);return!0};
McxSnappableController.prototype.onCoordinateCreated=function(a,b){if(this.base.map.getInputHandler().controller.isInstanceOf("McxSnappableController")){this.lastCreatedPoint=b;this.removedCoordinates=[];this.addedCoordinates.push(b);var c=new McxSketchUndoableAction;c.setController(this);this.base.map.getInputHandler().execute(c);this.base.map.getRenderer().paintNonLayer()}else this.sketchUndoFinish()};
McxSnappableController.prototype.isInstanceOf=function(a){return McxSnappableController.superClass_.isInstanceOf.call(this,a)||"McxSnappableController"==a};McxSnappableController.prototype.useFreeSnap=function(a){this.freeSnap=a};McxSnappableController.prototype.isUseFreeSnap=function(){return this.freeSnap};McxSnappableController.prototype.useSnap=function(a){this.snapUse=a};McxSnappableController.prototype.isUseSnap=function(){return this.snapUse};
McxSnappableController.prototype.getPointListChangedEventHandler=function(){return this.pointListChangedEventHandler};McxSnappableController.prototype.onTap=function(a){var b=new McxMouseEventArgs;b.setX(a.getX());b.setY(a.getY());b.setButton("left");this.onMouseDown(b)};McxSnappableController.prototype.onHold=function(a){McxSnappableController.superClass_.onHold.call(this,a);var b=new McxMouseEventArgs;b.setX(a.getX());b.setY(a.getY());b.setButton("right");this.onMouseDown(b)};
McxSnappableController.prototype.onGenerateCoordinate=function(){if(null!=this.cursorPosition){var a=this.base.map.worldToView(this.cursorPosition.getX(),this.cursorPosition.getY()),b=Math.round(a.getX()),a=Math.round(a.getY()),c;c=this.lastCreatedPoint?McxFactoryFinder.GeometryFactory(this.map.getCoordinateSystem()).createLineString([this.lastCreatedPoint,this.cursorPosition]):McxFactoryFinder.GeometryFactory(this.map.getCoordinateSystem()).createLineString([this.cursorPosition]);this.dlg=new McxCoordinateCreatorDialog(this.base.map,
c);this.dlg.setDialogPosition(b,a);this.dlg.showDialog(!0,!1);this.dlg.getOkButtonClickHandler().addListener(this.onOkButtonClickCoordinateDialog,null,this)}};McxSnappableController.prototype.onOkButtonClickCoordinateDialog=function(){var a=this.dlg.getCoordinate(),b=new McxMouseEventArgs(null);b.setX(a.getX());b.setY(a.getY());b.setButton("left");this.onCoordinateCreated(b,a)};
McxSnappableController.prototype.undo=function(){var a=this.addedCoordinates[this.addedCoordinates.length-1];this.addedCoordinates.splice(this.addedCoordinates.length-1,1);this.removedCoordinates.push(a);0<this.addedCoordinates.length&&(a=this.addedCoordinates[this.addedCoordinates.length-1],this.points[this.points.length-1]=a)};
McxSnappableController.prototype.redo=function(){var a=this.removedCoordinates[this.removedCoordinates.length-1];this.removedCoordinates.splice(this.removedCoordinates.length-1,1);this.addedCoordinates.push(a);this.points.push(a)};
McxSnappableController.prototype.sketchUndoFinish=function(){for(var a=0;a<this.base.map.getInputHandler().undoStack.length;a++)this.base.map.getInputHandler().undoStack[a].isInstanceOf("IMcxSketchUndoableAction")&&(this.base.map.getInputHandler().undoStack.splice(a,1),a--)};js.builtin.McxBase.Controller.McxAdvancePaintController={};function McxAdvancePaintController(a,b){mcx.base(this);this.targetLayer=b;this.pointSymbolizer=a.getPointSymbolizer();this.lineSymbolizer=a.getLineSymbolizer();this.polygonSymbolizer=a.getPolygonSymbolizer();this.drawingCompleteEventHandler=new McxEventHandler;this.drawController=null;this.base=this;this._geometryType=b.getGeometryType();this.initialize()}mcx.inherits(McxAdvancePaintController,McxSnappableController);
McxAdvancePaintController.prototype.initialize=function(){switch(this._geometryType){case McxGeometryType.Point:case McxGeometryType.MultiPoint:this.drawController=new McxPaintPointController(this.pointSymbolizer);break;case McxGeometryType.LineSegment:this.drawController=new McxPaintLineSegmentController(this.lineSymbolizer);break;case McxGeometryType.LineString:case McxGeometryType.LinearRing:case McxGeometryType.MultiLineString:this.drawController=new McxPaintLineStringController(this.lineSymbolizer);
break;case McxGeometryType.Polygon:case McxGeometryType.MultiPolygon:this.drawController=new McxPaintPolygonController(this.polygonSymbolizer);break;default:this.drawController=new McxPaintPolygonController(this.polygonSymbolizer)}this.drawController.getDrawingCompletedEventHandler().addListener(this.onDrawingCompleted,null,this)};McxAdvancePaintController.prototype.onDrawingCompleted=function(a){a=a.getGeometry();this.drawingCompleted(a)};
McxAdvancePaintController.prototype.onStartInteraction=function(){McxAdvancePaintController.superClass_.onStartInteraction.call(this);this.base.setCursor(McxCursors.crossHair);null!=this.drawController&&this.drawController.startInteraction.call(this.drawController,this.base.map)};
McxAdvancePaintController.prototype.onEndInteraction=function(){McxAdvancePaintController.superClass_.onEndInteraction.call(this);null!=this.drawController&&(this.drawController.getDrawingCompletedEventHandler().removeListener(this.onDrawingCompleted),this.drawController.endInteraction.call(this.drawController))};
McxAdvancePaintController.prototype.onMouseDown=function(a){McxAdvancePaintController.superClass_.onMouseDown.call(this,a);null!=this.drawController&&this.drawController.onMouseDown.call(this.drawController,a)};McxAdvancePaintController.prototype.onMouseMove=function(a){McxAdvancePaintController.superClass_.onMouseMove.call(this,a);null!=this.drawController&&this.drawController.onMouseMove.call(this.drawController,a)};
McxAdvancePaintController.prototype.onKeyPress=function(a){McxAdvancePaintController.superClass_.onKeyPress.call(this,a);null!=this.drawController&&this.drawController.onKeyPress.call(this.drawController,a)};McxAdvancePaintController.prototype.drawingCompleted=function(a){};McxAdvancePaintController.prototype.getDrawingCompletedEventHandler=function(){return this.drawingCompleteEventHandler};
McxAdvancePaintController.prototype.onTap=function(a){McxAdvancePaintController.superClass_.onTap.call(this,a);null!=this.drawController&&this.drawController.onTap.call(this.drawController,a)};McxAdvancePaintController.prototype.paint=function(a){null!=this.drawController&&this.drawController.paint.call(this.drawController,a)};McxAdvancePaintController.prototype.reset=function(){null!=this.drawController&&this.drawController.reset.call(this.drawController)};js.builtin.McxBase.Controller.McxPaintEllipseController={};function McxPaintEllipseController(a){mcx.base(this);this.polygonSymbolizer=a;this.origin=null;this.firstPass=this.isCircle=!0;this.drawingCompleteEventHandler=new McxEventHandler;this.base=this}mcx.inherits(McxPaintEllipseController,McxSnappableController);McxPaintEllipseController.prototype.setCircle=function(a){this.isCircle=a};
McxPaintEllipseController.prototype.onStartInteraction=function(){McxPaintEllipseController.superClass_.onStartInteraction.call(this);this.base.setCursor(McxCursors.crossHair)};McxPaintEllipseController.prototype.onEndInteraction=function(){McxPaintEllipseController.superClass_.onEndInteraction.call(this);this.base.setCursor(McxCursors.Default);this.reset();this.base.map.getRenderer().paintNonLayer()};
McxPaintEllipseController.prototype.finishDrawing=function(){var a=(this.origin.getX()+this.cursorPosition.getX())/2,b=(this.origin.getY()+this.cursorPosition.getY())/2,a=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createPoint(a,b),b=Math.abs(this.origin.getX()-this.cursorPosition.getX()),c=Math.abs(this.origin.getY()-this.cursorPosition.getY());this.isCircle&&(b=c=Math.sqrt(Math.pow(this.origin.getX()-this.cursorPosition.getX(),2)+Math.pow(this.origin.getY()-this.cursorPosition.getY(),
2))/2);if(null!=this.base.map.getCoordinateSystem())var d=this.base.map.getCoordinateSystem().getDistancePerUnit(),c=c*d,b=b*d;a=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createEllipse(a.getX(),a.getY(),c,b);this.origin=null;this.firstPass=!0;this.drawingCompleted(a)};
McxPaintEllipseController.prototype.onCoordinateCreated=function(a,b){this.firstPass?(this.origin=b,this.firstPass=!1):this.origin.equals(this.cursorPosition)||null==this.polygonSymbolizer||(this.base.cursorPosition=b,this.finishDrawing());McxPaintEllipseController.superClass_.onCoordinateCreated.call(this,a,b)};McxPaintEllipseController.prototype.drawingCompleted=function(a){a=new McxDrawingCompletedEventArgs(a);this.drawingCompleteEventHandler.dispatchOnSuccess(this,a)};
McxPaintEllipseController.prototype.getDrawingCompletedEventHandler=function(){return this.drawingCompleteEventHandler};
McxPaintEllipseController.prototype.paint=function(a){if(null!=this.base.map&&null!=this.origin&&!this.origin.equals(this.cursorPosition)&&null!=this.polygonSymbolizer){var b=(this.origin.getX()+this.cursorPosition.getX())/2,c=(this.origin.getY()+this.cursorPosition.getY())/2,b=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createPoint(b,c),c=Math.abs(this.origin.getX()-this.cursorPosition.getX()),d=Math.abs(this.origin.getY()-this.cursorPosition.getY());this.isCircle&&(c=d=
Math.sqrt(Math.pow(this.origin.getX()-this.cursorPosition.getX(),2)+Math.pow(this.origin.getY()-this.cursorPosition.getY(),2))/2);if(null!=this.base.map.getCoordinateSystem())var e=this.base.map.getCoordinateSystem().getDistancePerUnit(),d=d*e,c=c*e;b=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createEllipse(b.getX(),b.getY(),d,c);a.getGeodeticGraphics().drawPolygon(b.getPoints(),this.polygonSymbolizer,1,0,0)}};
McxPaintEllipseController.prototype.reset=function(){this.origin=null;this.base.cursorPosition=null};js.builtin.McxBase.Controller.McxPaintLineSegmentController={};function McxPaintLineSegmentController(a){mcx.base(this);this.startCoordinate=null;this.lineSymbolizer=a;this.firstPass=!0;this.drawingCompleteEventHandler=new McxEventHandler;this.base=this}mcx.inherits(McxPaintLineSegmentController,McxSnappableController);McxPaintLineSegmentController.prototype.onStartInteraction=function(){McxPaintLineSegmentController.superClass_.onStartInteraction.call(this);this.base.setCursor(McxCursors.crossHair)};
McxPaintLineSegmentController.prototype.onEndInteraction=function(){McxPaintLineSegmentController.superClass_.onEndInteraction.call(this);this.startCoordinate=null;null!=this.base.map&&this.base.map.getRenderer().paintNonLayer();this.base.setCursor(McxCursors.Default)};
McxPaintLineSegmentController.prototype.onCoordinateCreated=function(a,b){McxPaintLineSegmentController.superClass_.onCoordinateCreated.call(this,a,b);if(this.firstPass){var c=new McxDrawEventArgs(a,[b],[]);this.startCoordinate=b;this.firstPass=!1;this.base.pointListChangedEventHandler.dispatchOnSuccess(this,c)}else{c=[];c.push(this.startCoordinate);c.push(b);this.startCoordinate=null;this.firstPass=!0;var d=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createLineSegment(c[0],
c[1]);this.drawingCompleted(d);c=new McxDrawEventArgs(a,[c[0],c[1]],[]);this.base.pointListChangedEventHandler.dispatchOnSuccess(this,c);McxPaintLineSegmentController.superClass_.onCoordinateCreated.call(this,a,b)}};McxPaintLineSegmentController.prototype.drawingCompleted=function(a){a=new McxDrawingCompletedEventArgs(a);this.drawingCompleteEventHandler.dispatchOnSuccess(this,a)};McxPaintLineSegmentController.prototype.getDrawingCompletedEventHandler=function(){return this.drawingCompleteEventHandler};
McxPaintLineSegmentController.prototype.paint=function(a){if(null!=this.base.map&&null!=this.startCoordinate&&null!=this.base.cursorPosition){var b=[];b.push(this.startCoordinate);b.push(this.base.cursorPosition);a.getGeodeticGraphics().drawLineString(b,this.lineSymbolizer,1,0,0)}};js.builtin.McxBase.Controller.McxPaintLineStringController={};function McxPaintLineStringController(a){mcx.base(this);this.lineSymbolizer=a;this.drawingCompletedEventHandler=new McxEventHandler;this.base=this}mcx.inherits(McxPaintLineStringController,McxSnappableController);McxPaintLineStringController.prototype.onStartInteraction=function(){McxPaintLineStringController.superClass_.onStartInteraction.call(this);this.base.setCursor(McxCursors.crossHair)};
McxPaintLineStringController.prototype.onEndInteraction=function(){McxPaintLineStringController.superClass_.onEndInteraction.call(this);this.reset();this.base.map.getRenderer().paintNonLayer();this.base.setCursor(McxCursors.Default)};
McxPaintLineStringController.prototype.onKeyDown=function(a){McxPaintLineStringController.superClass_.onKeyPress.call(this,a);!a.ctrlKeyPresses()||"z"!=String.fromCharCode(a.getKeyCode()).toLowerCase()&&26!=a.getKeyCode()||1>=this.base.points.length||(this.base.points.splice(this.base.points.length-1,1),this.base.map.getRenderer().paintNonLayer())};
McxPaintLineStringController.prototype.onMouseDown=function(a){McxPaintLineStringController.superClass_.onMouseDown.call(this,a);"right"==a.getButton()&&(2>this.base.points.length||this.finishDraw())};McxPaintLineStringController.prototype.onCoordinateCreated=function(a,b){this.base.points.push(b);McxPaintLineStringController.superClass_.onCoordinateCreated.call(this,a,b)};
McxPaintLineStringController.prototype.finishDraw=function(){var a=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createLineString(this.base.points);this.reset();this.drawingCompleted(a)};McxPaintLineStringController.prototype.drawingCompleted=function(a){a=new McxDrawingCompletedEventArgs(a);this.drawingCompletedEventHandler.dispatchOnSuccess(this,a)};McxPaintLineStringController.prototype.getDrawingCompletedEventHandler=function(){return this.drawingCompletedEventHandler};
McxPaintLineStringController.prototype.paint=function(a){McxPaintLineStringController.superClass_.paint.call(this,a);if(null!=this.base.map&&!(0>=this.base.points.length)){for(var b=[],c=0;c<this.base.points.length;c++)b.push(this.base.points[c]);null!=this.base.cursorPosition&&b.push(this.base.cursorPosition);a.getGeodeticGraphics().drawLineString(b,this.lineSymbolizer,1,0,0)}};McxPaintLineStringController.prototype.reset=function(){this.base.points=[]};js.builtin.McxBase.Controller.McxPaintPointController={};function McxPaintPointController(a){mcx.base(this);this.pointSymbolizer=a;this.drawingCompletedEventHandler=new McxEventHandler;this.base=this}mcx.inherits(McxPaintPointController,McxSnappableController);McxPaintPointController.prototype.onStartInteraction=function(){McxPaintPointController.superClass_.onStartInteraction.call(this);this.base.setCursor(McxCursors.crossHair);this.base.setDescription("McxMapping-PaintRectangleController")};
McxPaintPointController.prototype.onEndInteraction=function(){McxPaintPointController.superClass_.onEndInteraction.call(this);this.base.map.getRenderer().paintNonLayer();this.base.setCursor(McxCursors.Default)};McxPaintPointController.prototype.drawingCompleted=function(a){a=new McxDrawingCompletedEventArgs(a);this.drawingCompletedEventHandler.dispatchOnSuccess(this,a)};McxPaintPointController.prototype.getDrawingCompletedEventHandler=function(){return this.drawingCompletedEventHandler};
McxPaintPointController.prototype.onCoordinateCreated=function(a,b){"left"==a.getButton()&&(b.setCoordinateSystem(this.base.map.getCoordinateSystem()),this.drawingCompleted(b),McxPaintPointController.superClass_.onCoordinateCreated.call(this,a,b))};js.builtin.McxBase.Controller.McxPaintPolygonController={};function McxPaintPolygonController(a){mcx.base(this);this.polygonSymbolizer=a;this.drawingCompleteEventHandler=new McxEventHandler;this.base=this}mcx.inherits(McxPaintPolygonController,McxSnappableController);McxPaintPolygonController.prototype.onStartInteraction=function(){McxPaintPolygonController.superClass_.onStartInteraction.call(this);this.base.setCursor.call(this,McxCursors.crossHair);this.base.setDescription.call(this,"McxMapping-PaintRectangleController")};
McxPaintPolygonController.prototype.onEndInteraction=function(){McxPaintPolygonController.superClass_.onEndInteraction.call(this);this.reset();this.base.map.getRenderer().paintNonLayer();this.base.setCursor(McxCursors.Default)};
McxPaintPolygonController.prototype.onKeyDown=function(a){McxPaintPolygonController.superClass_.onKeyPress.call(this,a);!a.ctrlKeyPresses()||"z"!=String.fromCharCode(a.getKeyCode()).toLowerCase()&&26!=a.getKeyCode()||1>=this.base.points.length||(this.base.points.splice(this.base.points.length-1,1),this.base.map.getRenderer().paintNonLayer())};McxPaintPolygonController.prototype.onMouseDown=function(a){McxPaintPolygonController.superClass_.onMouseDown.call(this,a);"right"==a.getButton()&&this.finishDraw()};
McxPaintPolygonController.prototype.onCoordinateCreated=function(a,b){this.base.points.push(b);McxPaintPolygonController.superClass_.onCoordinateCreated.call(this,a,b)};
McxPaintPolygonController.prototype.finishDraw=function(){if(!(3>this.base.points.length)){this.base.points.push(this.base.points[0]);var a=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createLinearRing(this.base.points),a=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createPolygon(a,null);this.reset();this.drawingCompleted(a)}};
McxPaintPolygonController.prototype.drawingCompleted=function(a){a=new McxDrawingCompletedEventArgs(a);this.drawingCompleteEventHandler.dispatchOnSuccess(this,a)};McxPaintPolygonController.prototype.getDrawingCompletedEventHandler=function(){return this.drawingCompleteEventHandler};
McxPaintPolygonController.prototype.paint=function(a){McxPaintPolygonController.superClass_.paint.call(this,a);if(null!=this.base.map&&!(0>=this.base.points.length)){for(var b=[],c=0;c<this.base.points.length;c++)b.push(this.base.points[c]);null!=this.base.cursorPosition&&b.push(this.base.cursorPosition);a.getGeodeticGraphics().drawPolygon(b,this.polygonSymbolizer,1,0,0)}};McxPaintPolygonController.prototype.reset=function(){this.base.points=[]};
McxPaintPolygonController.prototype.setPolygonSymbolizer=function(a){this.polygonSymbolizer=a};js.builtin.McxBase.Controller.McxPaintRectangleController={};function McxPaintRectangleController(a){mcx.base(this);this.symbolizer=a;this.endCoordinate=null;this.started=!1;this.drawingCompleteEventHandler=new McxEventHandler;this.initialize();this.base=this}mcx.inherits(McxPaintRectangleController,McxSnappableController);
McxPaintRectangleController.prototype.initialize=function(){if(null==this.symbolizer){var a=new McxFill;a.setColor("blue");a.setOpacity(.2);var b=new McxStroke;b.setColor("blue");this.symbolizer=McxFactoryFinder.StyleFactory().createPolygonSymbolizerWithStrokeAndFill(b,a)}};McxPaintRectangleController.prototype.onStartInteraction=function(){McxPaintRectangleController.superClass_.onStartInteraction.call(this);this.base.setCursor.call(this,McxCursors.crossHair);this.base.setDescription.call(this,"McxMapping-PaintRectangleController")};
McxPaintRectangleController.prototype.onEndInteraction=function(){McxPaintRectangleController.superClass_.onEndInteraction.call(this);this.base.setCursor.call(this,McxCursors.Default);this.base.map.getRenderer().paintNonLayer()};
McxPaintRectangleController.prototype.onCoordinateCreated=function(a,b){null==this.base.startCoordinate?(this.base.startCoordinate=b,this.started=!0):(this.endCoordinate=b,this.drawingCompleted(this.base.startCoordinate,this.endCoordinate),this.started=!1,this.endCoordinate=this.base.startCoordinate=null,McxPaintRectangleController.superClass_.onCoordinateCreated.call(this,a,b))};McxPaintRectangleController.prototype.onMouseClick=function(a){};McxPaintRectangleController.prototype.onMouseUp=function(a){};
McxPaintRectangleController.prototype.onMouseWheel=function(a){};McxPaintRectangleController.prototype.drawingCompleted=function(a,b){var c=Math.min(a.getX(),b.getX()),d=Math.max(a.getX(),b.getX()),e=Math.min(a.getY(),b.getY()),f=Math.max(a.getY(),b.getY()),g=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()),c=g.createBounds(c,e,d,f),g=g.createPolygon(c,[]),g=new McxDrawingCompletedEventArgs(g);this.drawingCompleteEventHandler.dispatchOnSuccess(this,g)};
McxPaintRectangleController.prototype.getDrawingCompletedEventHandler=function(){return this.drawingCompleteEventHandler};McxPaintRectangleController.prototype.paint=function(a){McxPaintRectangleController.superClass_.paint.call(this,a);null!=this.base.map&&this.started&&null!=this.base.startCoordinate&&null!=this.cursorPosition&&a.getGeodeticGraphics().drawRectangle(this.base.startCoordinate,this.cursorPosition,this.symbolizer,1)};
McxPaintRectangleController.prototype.reset=function(){this.endCoordinate=this.base.startCoordinate=null;this.started=!1};McxPaintRectangleController.prototype.isInstanceOf=function(a){return McxPaintRectangleController.superClass_.isInstanceOf.call(this,a)||"McxPaintRectangleController"==a};js.builtin.McxBase.Snap={};js.builtin.McxBase.Snap.McxSnapEngine={};
function McxSnapEngine(a){this.map=a;this.enabled=!0;this.textSymbolizer=new McxTextSymbolizer;a=new McxFill;a.setColor("black");this.textSymbolizer.setFill(a);this.textSymbolizer.getFont().setFontAlign("bold");this.backgroundSymbolizer=new McxPolygonSymbolizer;a=new McxFill;a.setColor("#FFFF99");var b=new McxStroke;b.setColor("black");this.backgroundSymbolizer.setFill(a);this.backgroundSymbolizer.setStroke(b);this.toolTipEnabled=!0}McxSnapEngine.prototype.isEnable=function(){return this.enabled};
McxSnapEngine.prototype.isToolTipEnable=function(){return this.toolTipEnabled};McxSnapEngine.prototype.setToolTipEnable=function(a){this.toolTipEnabled=a};McxSnapEngine.prototype.find=function(a,b){return null};McxSnapEngine.prototype.setEnable=function(a){this.enabled=a};McxSnapEngine.prototype.paint=function(a,b){};
McxSnapEngine.prototype.createEnvelope=function(a){var b=a.x-this.getSnapBuffer()/2;a=a.y-this.getSnapBuffer()/2;var c=this.getSnapBuffer(),d=this.getSnapBuffer();return McxFactoryFinder.GeometryFactory(null).createBounds(b,a,b+c,a+d)};
McxSnapEngine.prototype.extractSnapPairs=function(a){var b=[],c=[];if(a.isInstanceOf(McxGeometryType.MultiPoint)||a.isInstanceOf(McxGeometryType.MultiLineString)||a.isInstanceOf(McxGeometryType.MultiPolygon))for(var d=0;d<a.getComponents().length;d++)c.push(a.getComponents()[d]);else c.push(a);for(a=0;a<c.length;a++)if(d=c[a],d.transformTo(this.map.getCoordinateSystem()),d.isInstanceOf(McxGeometryType.Point)){var e=d,f=McxGeodeticGraphics.toDisplay(this.map,e),d=[];d.push(e);e=[];e.push(f);e=new McxSnapPair(d,
e);b.push(e)}else if(d.isInstanceOf(McxGeometryType.LineString))f=McxGeodeticGraphics.toDisplay(this.map,d),d=d.getPoints(),e=f.getPoints(),e=new McxSnapPair(d,e),b.push(e);else if(d.isInstanceOf(McxGeometryType.Polygon)){var f=McxGeodeticGraphics.toDisplay(this.map,d),e=d.getShell().getPoints(),g=f.getShell().getPoints(),e=new McxSnapPair(e,g);b.push(e);d=d.getHoles();f=f.getHoles();for(e=0;e<d.length&&!(e>=f.length);e++){var g=d[e].getPoints(),h=f[e].getPoints(),g=new McxSnapPair(g,h);b.push(g)}}return b};
McxSnapEngine.prototype.drawToolTip=function(a,b,c){a.getGeodeticGraphics().useTransform(!1);b=McxFactoryFinder.GeometryFactory(null).createPoint(b.getX(),b.getY()-5);a.getGeodeticGraphics().drawTextWithBackGround(c,b,this.textSymbolizer,this.backgroundSymbolizer,1);a.getGeodeticGraphics().useTransform(!0)};McxSnapEngine.prototype.isInstanceOf=function(a){return"McxSnapEngine"==a};McxSnapEngine.prototype.getSnapBuffer=function(){return McxGeometryHelper.instance.getSnapSensitivity()};js.builtin.McxBase.Snap.McxEnvelopeCenterSnapEngine={};function McxEnvelopeCenterSnapEngine(a){mcx.base(this,a);this.base=this;this.lineSymbolizer=new McxLineSymbolizer}mcx.inherits(McxEnvelopeCenterSnapEngine,McxSnapEngine);McxEnvelopeCenterSnapEngine.prototype.init=function(){var a=new McxStroke;a.setColor("#323292");a.setWidth(2);this.lineSymbolizer.setStroke(a)};
McxEnvelopeCenterSnapEngine.prototype.find=function(a,b){for(var c=null,d=Number.MAX_VALUE,e=this.base.map.getLayers().toLayerArray(),f=0;f<e.length;f++){var g=e[f];if(g.getVisible()&&g.getSnappable()&&this.base.map.inVisibleRange(g.getMinScale(),g.getMaxScale())){var g=this.base.map.getPaintedFeatures(g).getAll(),h;for(h in g){var k=g[h].transformTo(this.base.map.getCoordinateSystem());if(!k.isInstanceOf(McxGeometryType.Point)&&!k.isInstanceOf(McxGeometryType.MultiPoint)&&(k=k.getBounds().getCentroid(),
null!=k)){var m=McxGeodeticGraphics.toDisplay(this.base.map,k).distanceTo(a);m>this.base.getSnapBuffer()||m>=d||(c=k)}}}}return c};
McxEnvelopeCenterSnapEngine.prototype.paint=function(a,b){var c=McxEnvelopeCenterSnapEngine.superClass_.createEnvelope.call(this,b);a.getGeodeticGraphics().useTransform(!1);a.getGeodeticGraphics().drawLineSegment(new McxPoint(c.left,c.bottom,null),new McxPoint(c.right,c.top,null),this.lineSymbolizer,1,0,0);a.getGeodeticGraphics().drawLineSegment(new McxPoint(c.right,c.top,null),new McxPoint(c.left,c.top,null),this.lineSymbolizer,1,0,0);a.getGeodeticGraphics().drawLineSegment(new McxPoint(c.left,c.top,
null),new McxPoint(c.right,c.bottom,null),this.lineSymbolizer,1,0,0);a.getGeodeticGraphics().drawLineSegment(new McxPoint(c.right,c.bottom,null),new McxPoint(c.left,c.bottom,null),this.lineSymbolizer,1,0,0);a.getGeodeticGraphics().drawLineSegment(new McxPoint(c.left,c.top,null),new McxPoint(c.left,c.bottom,null),this.lineSymbolizer,1,0,0);a.getGeodeticGraphics().drawLineSegment(new McxPoint(c.right,c.top,null),new McxPoint(c.right,c.bottom,null),this.lineSymbolizer,1,0,0);a.getGeodeticGraphics().useTransform(!0)};
McxEnvelopeCenterSnapEngine.prototype.isInstanceOf=function(a){return"McxSnapEngine"==a||"McxEnvelopeCenterSnapEngine"==a};js.builtin.McxBase.Snap.McxIntersectionSnapEngine={};function McxIntersectionSnapEngine(a){mcx.base(this,a);this.lineSymbolizer=new McxLineSymbolizer;a=new McxStroke;a.setColor("#323292");a.setWidth(2);this.lineSymbolizer.setStroke(a);this.base=this}mcx.inherits(McxIntersectionSnapEngine,McxSnapEngine);
McxIntersectionSnapEngine.prototype.find=function(a,b){for(var c=null,d=Number.MAX_VALUE,e=[],f=McxIntersectionSnapEngine.superClass_.createEnvelope.call(this,a),g=this.base.map.getLayers().toLayerArray(),h=0;h<g.length;h++){var k=g[h];if(k.getVisible()&&k.getSnappable()&&this.base.map.inVisibleRange(k.getMinScale(),k.getMaxScale())){var m=this.base.map.getPaintedFeatures(k).getAll(),n;for(n in m)for(var k=m[n].transformTo(this.base.map.getCoordinateSystem()),p=McxIntersectionSnapEngine.superClass_.extractSnapPairs.call(this,
k),q=0;q<p.length;q++)for(var r=p[q],k=0;k<r.getDisplayCoordinates().length-1;k++){var t=McxFactoryFinder.GeometryFactory(null).createLineSegment(r.getDisplayCoordinates()[k],r.getDisplayCoordinates()[k+1]);t.getBounds().intersectsBounds(f)&&e.push(t)}}}for(k=0;k<e.length;k++)for(f=e[k],g=0;g<e.length;g++)h=e[g],f.intersectSegment(h)&&(h=f.intersectSegment(h),null!=h&&h.isInstanceOf(McxGeometryType.Point)&&(n=h.distanceTo(a),n>this.base.getSnapBuffer()||n>=d||(d=n,c=this.base.map.viewToWorld(h.getX(),
h.getY()))));return c};
McxIntersectionSnapEngine.prototype.paint=function(a,b){var c=McxIntersectionSnapEngine.superClass_.createEnvelope.call(this,b),d=McxFactoryFinder.GeometryFactory(null).createPoint(c.getLeft(),c.getTop()),e=McxFactoryFinder.GeometryFactory(null).createPoint(c.getRight(),c.getBottom()),f=McxFactoryFinder.GeometryFactory(null).createPoint(c.getRight(),c.getTop()),c=McxFactoryFinder.GeometryFactory(null).createPoint(c.getLeft(),c.getBottom());a.getGeodeticGraphics().useTransform(!1);a.getGeodeticGraphics().drawLineSegment(d,
e,this.lineSymbolizer,1,0,0);a.getGeodeticGraphics().drawLineSegment(f,c,this.lineSymbolizer,1,0,0);a.getGeodeticGraphics().useTransform(!1)};McxIntersectionSnapEngine.prototype.isInstanceOf=function(a){return"McxSnapEngine"==a||"McxIntersectionSnapEngine"==a};js.builtin.McxBase.Snap.McxMidPointSnapEngine={};function McxMidPointSnapEngine(a){mcx.base(this,a);this.base=this}mcx.inherits(McxMidPointSnapEngine,McxSnapEngine);
McxMidPointSnapEngine.prototype.find=function(a,b){for(var c=null,d=Number.MAX_VALUE,e=this.base.map.getLayers().toLayerArray(),f=0;f<e.length;f++){var g=e[f];if(g.getVisible()&&g.getSnappable()&&this.base.map.inVisibleRange(g.getMinScale(),g.getMaxScale())){var g=this.base.map.getPaintedFeatures(g).getAll(),h;for(h in g)for(var k=g[h].transformTo(this.base.map.getCoordinateSystem()),k=McxMidPointSnapEngine.superClass_.extractSnapPairs.call(this,k),m=0;m<k.length;m++){var n=k[m],p=n.getDisplayCoordinates();
n.getWorldCoordinates();for(n=0;n<p.length-1;n++){var q=(p[n].x+p[n+1].x)/2,r=(p[n].y+p[n+1].y)/2,q=McxFactoryFinder.GeometryFactory(null).createPoint(q,r);null!=q&&q.distanceTo&&(r=q.distanceTo(a),r>this.base.getSnapBuffer()||r>=d||(c=this.base.map.viewToWorld(q.x,q.y)))}}}}return c};
McxMidPointSnapEngine.prototype.paint=function(a,b){var c=McxMidPointSnapEngine.superClass_.createEnvelope.call(this,b);a.getGeodeticGraphics().context.strokeStyle="#323292";a.getGeodeticGraphics().context.lineWidth=2;var d=c.top;c.top=c.bottom;c.bottom=d;a.getGeodeticGraphics().context.beginPath();a.getGeodeticGraphics().context.lineTo(c.left+c.getWidth()/2,c.top);a.getGeodeticGraphics().context.lineTo(c.left,c.bottom);a.getGeodeticGraphics().context.closePath();a.getGeodeticGraphics().context.stroke();
a.getGeodeticGraphics().context.beginPath();a.getGeodeticGraphics().context.lineTo(c.left,c.bottom);a.getGeodeticGraphics().context.lineTo(c.right,c.bottom);a.getGeodeticGraphics().context.closePath();a.getGeodeticGraphics().context.stroke();a.getGeodeticGraphics().context.beginPath();a.getGeodeticGraphics().context.lineTo(c.right,c.bottom);a.getGeodeticGraphics().context.lineTo(c.left+c.getWidth()/2,c.top);a.getGeodeticGraphics().context.closePath();a.getGeodeticGraphics().context.stroke()};
McxMidPointSnapEngine.prototype.isInstanceOf=function(a){return"McxSnapEngine"==a||"McxMidPointSnapEngine"==a};js.builtin.McxBase.Snap.McxNearestSnapEngine={};function McxNearestSnapEngine(a){mcx.base(this,a);this.lineSymbolizer=new McxLineSymbolizer;a=new McxStroke;a.setColor("#323292");a.setWidth(2);this.lineSymbolizer.setStroke(a);this.base=this}mcx.inherits(McxNearestSnapEngine,McxSnapEngine);
McxNearestSnapEngine.prototype.find=function(a,b){for(var c=null,d=Number.MAX_VALUE,e=this.base.map.getLayers().toLayerArray(),f=0;f<e.length;f++){var g=e[f];if(g.getVisible()&&g.getSnappable()&&this.base.map.inVisibleRange(g.getMinScale(),g.getMaxScale())){var g=this.base.map.getPaintedFeatures(g).getAll(),h;for(h in g)for(var k=g[h].transformTo(this.base.map.getCoordinateSystem()),k=McxNearestSnapEngine.superClass_.extractSnapPairs.call(this,k),m=0;m<k.length;m++)for(var n=k[m],p=0;p<n.getDisplayCoordinates().length-
1;p++){var q=n.getDisplayCoordinates()[p],r=n.getDisplayCoordinates()[p+1],q=McxFactoryFinder.GeometryFactory(null).createLineSegment(q,r).getPerpendicularFoot(a,!1),r=q.distanceTo(a);r>this.base.getSnapBuffer()||r>=d||(d=r,c=this.base.map.viewToWorld(q.getX(),q.getY()))}}}return c};
McxNearestSnapEngine.prototype.paint=function(a,b){var c=McxNearestSnapEngine.superClass_.createEnvelope.call(this,b);a.getGeodeticGraphics().useTransform(!1);var d=McxFactoryFinder.GeometryFactory(null).createPoint(c.getLeft(),c.getBottom()),e=McxFactoryFinder.GeometryFactory(null).createPoint(c.getRight(),c.getTop()),f=McxFactoryFinder.GeometryFactory(null).createPoint(c.getLeft(),c.getTop()),c=McxFactoryFinder.GeometryFactory(null).createPoint(c.getRight(),c.getBottom());a.getGeodeticGraphics().drawLineSegment(d,
e,this.lineSymbolizer,1,0,0);a.getGeodeticGraphics().drawLineSegment(e,f,this.lineSymbolizer,1,0,0);a.getGeodeticGraphics().drawLineSegment(f,c,this.lineSymbolizer,1,0,0);a.getGeodeticGraphics().drawLineSegment(c,d,this.lineSymbolizer,1,0,0);a.getGeodeticGraphics().useTransform(!0)};McxNearestSnapEngine.prototype.isInstanceOf=function(a){return"McxSnapEngine"==a||"McxNearestSnapEngine"==a};js.builtin.McxBase.Snap.McxPerpendicularSnapEngine={};function McxPerpendicularSnapEngine(a){mcx.base(this,a);this.lineSymbolizer=new McxLineSymbolizer;a=new McxStroke;a.setColor("#323292");a.setWidth(2);this.lineSymbolizer.setStroke(a);this.base=this}mcx.inherits(McxPerpendicularSnapEngine,McxSnapEngine);
McxPerpendicularSnapEngine.prototype.find=function(a,b){var c=null,d=Number.MAX_VALUE,e=[];e.push(b);e.push(a);for(var e=this.base.map.getLayers().toLayerArray(),f=0;f<e.length;f++){var g=e[f];if(g.getVisible()&&g.getSnappable()&&this.base.map.inVisibleRange(g.getMinScale(),g.getMaxScale())){var g=this.base.map.getPaintedFeatures(g).getAll(),h;for(h in g)for(var k=g[h].transformTo(this.base.map.getCoordinateSystem()),k=McxPerpendicularSnapEngine.superClass_.extractSnapPairs.call(this,k),m=0;m<k.length;m++){var n=
k[m];if(!n.getDisplayCoordinates()[n.getDisplayCoordinates().length-1].equals(b))for(var p=0;p<n.getDisplayCoordinates().length-1;p++){var q=n.getDisplayCoordinates()[p],r=n.getDisplayCoordinates()[p+1],q=McxFactoryFinder.GeometryFactory(null).createLineSegment(q,r).getPerpendicularFoot(b,!1);null!=q&&(r=q.distanceTo(a),r>this.base.getSnapBuffer()||r>=d||(d=r,c=this.base.map.viewToWorld(q.getX(),q.getY())))}}}}return c};
McxPerpendicularSnapEngine.prototype.paint=function(a,b){var c=b.getX()-this.base.getSnapBuffer()/2,d=b.getY()-this.base.getSnapBuffer()/2,e=McxFactoryFinder.GeometryFactory(null).createPoint(c,d),c=b.getX()+this.base.getSnapBuffer()/2,d=b.getY()+this.base.getSnapBuffer()/2,f=McxFactoryFinder.GeometryFactory(null).createPoint(c,d),c=b.getX()-this.base.getSnapBuffer()/2,d=b.getY()+this.base.getSnapBuffer()/2,g=McxFactoryFinder.GeometryFactory(null).createPoint(c,d),c=b.getX()-this.base.getSnapBuffer()/
2,d=b.getY(),h=McxFactoryFinder.GeometryFactory(null).createPoint(c,d),c=b.getX(),d=b.getY()+this.base.getSnapBuffer()/2,c=McxFactoryFinder.GeometryFactory(null).createPoint(c,d);a.getGeodeticGraphics().useTransform(!1);a.getGeodeticGraphics().drawLineSegment(e,g,this.lineSymbolizer,1,0,0);a.getGeodeticGraphics().drawLineSegment(g,f,this.lineSymbolizer,1,0,0);a.getGeodeticGraphics().drawLineSegment(h,b,this.lineSymbolizer,1,0,0);a.getGeodeticGraphics().drawLineSegment(b,c,this.lineSymbolizer,1,0,
0);a.getGeodeticGraphics().useTransform(!0)};McxPerpendicularSnapEngine.prototype.isInstanceOf=function(a){return"McxSnapEngine"==a||"McxPerpendicularSnapEngine"==a};js.builtin.McxBase.Snap.McxPointSnapEngine={};function McxPointSnapEngine(a){mcx.base(this,a);this.polygonSymbolizer=new McxPolygonSymbolizer;a=new McxFill;a.setColor("transparent");var b=new McxStroke;b.setColor("#323292");b.setWidth(2);this.polygonSymbolizer.setFill(a);this.polygonSymbolizer.setStroke(b);this.base=this}mcx.inherits(McxPointSnapEngine,McxSnapEngine);
McxPointSnapEngine.prototype.find=function(a,b){for(var c=null,d=Number.MAX_VALUE,e=this.base.map.getLayers().toLayerArray(),f=0;f<e.length;f++){var g=e[f];if(g.getVisible()&&g.getSnappable()&&this.base.map.inVisibleRange(g.getMinScale(),g.getMaxScale())){var g=this.base.map.getPaintedFeatures(g).getAll(),h;for(h in g){var k=g[h].transformTo(this.base.map.getCoordinateSystem());if(k&&null!=k&&k.isInstanceOf(McxGeometryType.Point))for(var k=McxPointSnapEngine.superClass_.extractSnapPairs.call(this,
k),m=0;m<k.length;m++)for(var n=k[m],p=n.getDisplayCoordinates(),q=n.getWorldCoordinates(),r=0;r<n.getDisplayCoordinates().length;r++){var t=p[r].distanceTo(a);t>this.base.getSnapBuffer()||t>=d||(d=t,c=q[r])}}}}return c};McxPointSnapEngine.prototype.paint=function(a,b){a.getGeodeticGraphics().useTransform(!1);a.getGeodeticGraphics().drawCircle(b.getX(),b.getY(),this.base.getSnapBuffer()/2,0,2*Math.PI,!1,this.polygonSymbolizer,1,0,0);a.getGeodeticGraphics().useTransform(!0)};
McxPointSnapEngine.prototype.isInstanceOf=function(a){return"McxSnapEngine"==a||"McxPointSnapEngine"==a};js.builtin.McxBase.Snap.McxSnapFinder={};function McxSnapFinder(a){this.map=a;this.globalEngine=this.result=this.last=this.current=null;this.alertTimerId=0;this.enabled=!0}McxSnapFinder.prototype.isEnable=function(){return this.enabled};
McxSnapFinder.prototype.putTarget=function(a,b){var c=this;this.current=a;this.last=b;clearTimeout(this.alertTimerId);this.alertTimerId=setTimeout(function(){for(var a=null,b=null,f=c.map.getSnapEngines(),g=0;g<f.length;g++){var h=f[g];if(h.isEnable()&&(a=h.find(c.current,c.last),null!=a)){b=h;break}}null==a?(c.result=null,c.globalEngine=null):(f=c.map.worldToView(a.x,a.y),g=c.map.createDrawContext(),b.paint(g,f),c.result=a,c.globalEngine=b)},100)};
McxSnapFinder.prototype.isFreeSnapUsable=function(){for(var a=this.map.getSnapEngines(),b=0;b<a.length;b++)if(a[b].isEnable())return!0;return!1};
McxSnapFinder.prototype.acceptTarget=function(a){if(null==this.result||null==this.globalEngine)return null;var b=this.current.x-this.globalEngine.getSnapBuffer()/2,c=this.current.y-this.globalEngine.getSnapBuffer()/2,d=this.globalEngine.getSnapBuffer(),e=this.globalEngine.getSnapBuffer();return McxFactoryFinder.GeometryFactory(null).createBounds(b,c,b+d,c+e).contains(a.getX(),a.getY())?this.result:null};McxSnapFinder.prototype.clearGlobalEngine=function(){this.globalEngine=null};js.builtin.McxBase.Snap.McxSnapPair={};function McxSnapPair(a,b){this.worldCoordinates=a;this.displayCoordinates=b}McxSnapPair.prototype.getDisplayCoordinates=function(){return this.displayCoordinates};McxSnapPair.prototype.getWorldCoordinates=function(){return this.worldCoordinates};js.builtin.McxBase.Snap.McxVertexSnapEngine={};function McxVertexSnapEngine(a){mcx.base(this,a);this.polygonSymbolizer=new McxPolygonSymbolizer;this.base=this;this.initialize()}mcx.inherits(McxVertexSnapEngine,McxSnapEngine);McxVertexSnapEngine.prototype.initialize=function(){var a=new McxFill;a.setColor("transparent");var b=new McxStroke;b.setColor("#323292");b.setWidth(2);this.polygonSymbolizer.setFill(a);this.polygonSymbolizer.setStroke(b)};
McxVertexSnapEngine.prototype.find=function(a,b){for(var c=null,d=Number.MAX_VALUE,e=this.base.map.getLayers().toLayerArray(),f=0;f<e.length;f++){var g=e[f];if(g.getSnappable()&&g.getVisible()&&this.base.map.inVisibleRange(g.getMinScale(),g.getMaxScale())){var g=this.base.map.getPaintedFeatures(g).getAll(),h;for(h in g){var k=g[h].transformTo(this.base.map.getCoordinateSystem());if(!k.isInstanceOf(McxGeometryType.Point)&&!k.isInstanceOf(McxGeometryType.MultiPoint))for(var k=McxVertexSnapEngine.superClass_.extractSnapPairs.call(this,
k),m=0;m<k.length;m++)for(var n=k[m],p=n.getDisplayCoordinates(),q=0;q<p.length;q++){var r=p[q].distanceTo(a);r>this.base.getSnapBuffer()||r>=d||(d=r,c=n.getWorldCoordinates()[q].clone())}}}}return c};
McxVertexSnapEngine.prototype.paint=function(a,b){var c=b.getX()-this.base.getSnapBuffer()/2,d=b.getY()-this.base.getSnapBuffer()/2,e=McxFactoryFinder.GeometryFactory(null).createPoint(c,d),c=McxFactoryFinder.GeometryFactory(null).createPoint(c+this.base.getSnapBuffer(),d+this.base.getSnapBuffer());a.getGeodeticGraphics().useTransform(!1);a.getGeodeticGraphics().drawRectangle(e,c,this.polygonSymbolizer,1);a.getGeodeticGraphics().useTransform(!0)};
McxVertexSnapEngine.prototype.isInstanceOf=function(a){return"McxSnapEngine"==a||"McxVertexSnapEngine"==a};
js.builtin.McxMapping={};js.builtin.McxMapping.McxMapHelper={};
var McxMapHelper={print:function(a,b,c,d,e,f){var g=new McxPrintOptions;g.setContext(a);g.setWidth(b);g.setHeight(c);g.setMap(d);g.setLayers(e);g.setAjaxParameter(f);(new McxMapPrinter).print(g)},getScreenShot:function(a,b,c,d){var e=new McxPrintOptions;e.setWidth(c);e.setHeight(d);e.setMap(a);e.setAjaxParameter(b);(new McxMapPrinter).getScreenShot(e)},getSelectableLayers:function(a){a=a.getLayers().toLayerArray();for(var b=[],c=0;c<a.length;c++)a[c].isInstanceOf("IMcxSelectableLayer")&&b.push(a[c]);
return b}};js.builtin.McxMapping.McxNativeInputHandler={};function McxNativeInputHandler(a){mcx.base(this,a);this.base=this;this.lastControllerUI=this.lastNotification=this.lastController=this.panController=null;this.executionActive=!1;this.alertTimerId=0;this.scaleLevel=1;this.zoomCenter=null;this._mouseY=this._mouseX=0;this._inspectorStatus=!1;this.init()}mcx.inherits(McxNativeInputHandler,McxDefaultInputHandler);
McxNativeInputHandler.prototype.init=function(){this.base.controller=new McxPanController;this.base.controller.getCursorChangedEventHandler().addListener(this.onCursorChanged,null,this);this.base.controller.getDescriptionChangedEventHandler().addListener(this.onDescriptionChanged,null,this);this.base.controller.startInteraction(this.base.map);this.lastController=this.base.controller};
McxNativeInputHandler.prototype.onDescriptionChanged=function(){var a=this.base.controller.getDescription();if(a&&null!=a&&this._inspectorStatus){var b=new McxControllerMessage;b.setMessage(a);var c=this;setTimeout(function(){b.setPosition(c._mouseX,c._mouseY);b.showMessage()},1E3)}};
McxNativeInputHandler.prototype.onMouseWheel=function(a){this.base.map.getRenderer().abortRender();var b=this.base.map.viewToWorld(a.getX(),a.getY()),c=a.getWheelDelta(),b=new McxZoomAction(c,b);this.base.map.getInputHandler().execute(b);McxNativeInputHandler.superClass_.onMouseWheel.call(this,a)};
McxNativeInputHandler.prototype.onMouseMove=function(a){if(null!=this.panController)this.panController.onMouseMove(a);this._mouseX=a.getX();this._mouseY=a.getY();McxNativeInputHandler.superClass_.onMouseMove.call(this,a)};
McxNativeInputHandler.prototype.onMouseUp=function(a){McxNativeInputHandler.superClass_.onMouseUp.call(this,a);null!=this.panController&&"middle"==a.getButton()?(this.panController.onMouseUp(a),this.panController.endInteraction(),this.panController=null):"right"==a.getButton()&&this.base.controller.isInstanceOf("McxPanController")&&(this.base.controller.endInteraction(),this.base.controller.getCursorChangedEventHandler().removeListener(this.onCursorChanged),this.base.controller.getDescriptionChangedEventHandler().removeListener(this.onDescriptionChanged),
this.base.controller=this.lastController,this.base.controller.startInteraction(this.base.map),this.base.controller.getCursorChangedEventHandler().addListener(this.onCursorChanged,null,this),this.base.controller.getDescriptionChangedEventHandler().addListener(this.onDescriptionChanged,null,this))};
McxNativeInputHandler.prototype.onMouseDown=function(a){if("middle"==a.getButton())this.panController=new McxPanController,this.panController.startInteraction(this.base.map),this.panController.onMouseDown(a);else{if("right"==a.getButton()&&this.base.controller.isInstanceOf("McxSnappableController"))for(var b=0;b<this.base.undoStack.length;b++)this.base.undoStack[b].isInstanceOf("IMcxSketchUndoableAction")&&(this.base.undoStack.splice(b,1),b--);McxNativeInputHandler.superClass_.onMouseDown.call(this,
a)}};McxNativeInputHandler.prototype.onKeyPress=function(a){McxNativeInputHandler.superClass_.onKeyPress.call(this,a)};
McxNativeInputHandler.prototype.onKeyDown=function(a){if(a.getKeyCode()==McxKeyCode.end)this.base.map.getRenderer().abortRender();else if(a.getKeyCode()==McxKeyCode.escape)this.setController(null);else if(a.getKeyCode()==McxKeyCode.z&&a.ctrlKeyPresses())this.base.map.getInputHandler().undo();else if(a.getKeyCode()==McxKeyCode.y&&a.ctrlKeyPresses())this.base.map.getInputHandler().redo();else if(a.getKeyCode()==McxKeyCode.y&&a.altKeyPresses()){var b=this.base.map,b=b.getViewUndoBuffer();b.redo()}else if(a.getKeyCode()==
McxKeyCode.z&&a.altKeyPresses())b=this.base.map,b=b.getViewUndoBuffer(),b.undo();else if(a.getKeyCode()==McxKeyCode.add)b=this.base.map.getDisplay(),b=McxFactoryFinder.GeometryFactory(null).createPoint(b.getWidth()/2,b.getHeight()/2),b=this.base.map.viewToWorld(b.x,b.y),b=new McxZoomAction(.5,b),this.base.execute(b);else if(a.getKeyCode()==McxKeyCode.subtract)b=this.base.map.getDisplay(),b=McxFactoryFinder.GeometryFactory(null).createPoint(b.getWidth()/2,b.getHeight()/2),b=this.base.map.viewToWorld(b.x,
b.y),b=new McxZoomAction(2,b),this.base.execute(b);else if(a.getKeyCode()==McxKeyCode.leftarrow)b=this.base.map.getWorld().getWidth()/10,b=new McxSlideAction(b,0),this.base.execute(b);else if(a.getKeyCode()==McxKeyCode.rightarrow)b=this.base.map.getWorld().getWidth()/10,b=new McxSlideAction(-1*b,0),this.base.execute(b);else if(a.getKeyCode()==McxKeyCode.uparrow)b=this.base.map.getWorld().getHeight()/10,b=new McxSlideAction(0,b),this.base.execute(b);else if(a.getKeyCode()==McxKeyCode.downarrow)b=this.base.map.getWorld().getHeight()/
10,b=new McxSlideAction(0,-1*b),this.base.execute(b);else if(a.getKeyCode()==McxKeyCode.q&&a.altKeyPresses())this.lastController=this.base.controller,this.base.controller=new McxZoomWindowController,this.base.controller.getCursorChangedEventHandler().addListener(this.onCursorChanged,null,this),this.base.controller.getDescriptionChangedEventHandler().addListener(this.onDescriptionChanged,null,this),this.base.controller.startInteraction(this.base.map);else if(a.getKeyCode()==McxKeyCode.w&&a.altKeyPresses())this.lastController=
this.base.controller,this.base.controller=new McxPanController,this.base.controller.getCursorChangedEventHandler().addListener(this.onCursorChanged,null,this),this.base.controller.getDescriptionChangedEventHandler().addListener(this.onDescriptionChanged,null,this),this.base.controller.startInteraction(this.base.map);else if(a.getKeyCode()==McxKeyCode.r&&a.altKeyPresses())b=new McxZoomExtentAction,b.execute(this.base.map);else if(a.getKeyCode()==McxKeyCode.enter){var c=this.base.controller.getOptionUI();
null!=c&&c.getUIStatus()&&!c.getIsModal()?setTimeout($.proxy(function(){c.hideUI()},this),10):null==c||c.getUIStatus()||setTimeout($.proxy(function(){c.showUI()},this),10)}McxNativeInputHandler.superClass_.onKeyDown.call(this,a)};McxNativeInputHandler.prototype.onTap=function(a){McxNativeInputHandler.superClass_.onTap.call(this,a)};
McxNativeInputHandler.prototype.onDoubleTap=function(a){this.base.map.getRenderer().abortRender();var b=this.base.map.viewToWorld(a.getX(),a.getY()),c=2/3;this.base.map.getRenderer().zoomTo(c,b.x,b.y);this.zoomCenter=null;this.scaleLevel=1;McxNativeInputHandler.superClass_.onDoubleTap.call(this,a)};McxNativeInputHandler.prototype.onSwipe=function(a){a=new McxSlideAction(a.getDeltaX(),a.getDeltaY());this.base.map.getInputHandler().execute(a)};
McxNativeInputHandler.prototype.onPinch=function(a){if(this.scaleLevel!=a.getWheelDelta()){this.base.map.getRenderer().abortRender();null==this.zoomCenter&&(this.zoomCenter=this.base.map.viewToWorld(a.getX(),a.getY()));var b=1/a.getWheelDelta();3E-5>Math.abs(this.scaleLevel-b)||(this.scaleLevel=b,this.base.map.getRenderer().zoomToMobile(b,this.zoomCenter.x,this.zoomCenter.y),McxNativeInputHandler.superClass_.onPinch.call(this,a))}};McxNativeInputHandler.prototype.onSwipeLeft=function(a){};
McxNativeInputHandler.prototype.onSwipeRight=function(a){};McxNativeInputHandler.prototype.onSwipeUp=function(a){};McxNativeInputHandler.prototype.onSwipeDown=function(a){};McxNativeInputHandler.prototype.onRotate=function(a){};McxNativeInputHandler.prototype.onDragStart=function(a){this.panController=new McxPanController;this.panController.startInteraction(this.base.map);this.panController.onDragStart(a);McxNativeInputHandler.superClass_.onDragStart.call(this,a)};
McxNativeInputHandler.prototype.onDragEnd=function(a){this.panController.onDragEnd(a);this.panController.endInteraction();this.panController=null;McxNativeInputHandler.superClass_.onDragEnd.call(this,a)};McxNativeInputHandler.prototype.onDrag=function(a){if(null!=this.panController)this.panController.onDrag(a);McxNativeInputHandler.superClass_.onDrag.call(this,a)};
McxNativeInputHandler.prototype.onRelease=function(a){null==this.zoomCenter&&(this.zoomCenter=this.base.map.viewToWorld(a.getX(),a.getY()));a=new McxPoint(this.zoomCenter.x,this.zoomCenter.y,this.base.map.getCoordinateSystem());a=this.base.map.getWorld().scale(1/this.scaleLevel,a);this.base.map.setWorld(a.left,a.bottom,a.right,a.top);this.base.map.getRenderer().paintLayer(null,null);this.zoomCenter=null;this.scaleLevel=1};
McxNativeInputHandler.prototype.setController=function(a){this.lastController=this.base.controller;this.base.controller.endInteraction();this.base.controller=null==a?new McxPanController:a;this.base.controller.getCursorChangedEventHandler().addListener(this.onCursorChanged,null,this);this.base.controller.getDescriptionChangedEventHandler().addListener(this.onDescriptionChanged,null,this);this.base.controller.startInteraction(this.base.map);null!=this.lastControllerUI&&this.lastControllerUI.remove();
(a=this.base.controller.getOptionUI())&&null!=a&&(this.lastControllerUI=this.showControllerUI(a))};McxNativeInputHandler.prototype.onCursorChanged=function(){var a=this.base.controller.getCursor();0<a.length&&"$"==a[0]&&(a="url('"+McxPathFinder.getFullPath(a)+"'), default");$("#"+this.base.map.getName()).css("cursor",a)};
McxNativeInputHandler.prototype.showNotification=function(a){var b=$("#notificationContainer");0==b.length&&(b=$("<div/>").attr("id","notificationContainer").css("position","absolute").css("z-index","15000").css("top","27px").css("max-width","30%").css("right","10px").css("text-align","center"),$("#mainContainer").append(b));a=new McxNotificationBox(a);var c=a.getContent();b.prepend(c);a.show();return a};
McxNativeInputHandler.prototype.showControllerUI=function(a){a.onCancel().addListener(function(){a.hideUI()},null,this);a.getStartStatus()?a.showUI():a.hide();$("body").append(a.getContent());a.localize();return a};McxNativeInputHandler.prototype.setInspectorStatus=function(a){this._inspectorStatus=a};McxNativeInputHandler.prototype.getInspectorStatus=function(){return this._inspectorStatus};js.builtin.McxMapping.Action={};js.builtin.McxMapping.Action.Mcx3dMapAction={};function Mcx3dMapAction(){}Mcx3dMapAction.prototype.execute=function(a){};Mcx3dMapAction.prototype.isInstanceOf=function(a){return"Mcx3dMapAction"==a};js.builtin.McxMapping.Action.McxBlinkAction={};function McxBlinkAction(a,b){this.features=a;this.interval=b;this.markers=[];this.map=null;this.fillColor="red";this.opacity=.2;this.strokeWidth=2;this.strokeColor="red";this.guid=McxGuid.createGuid();this.continuous=!1;this.secondTimerTick=this.firstTimerTick=null}McxBlinkAction.prototype.setContinuous=function(a){this.continuous=a};McxBlinkAction.prototype.getContinuous=function(){return this.continuous};
McxBlinkAction.prototype.execute=function(a){this.map=a;this.guid=McxGuid.createGuid();this.createMarkers()};
McxBlinkAction.prototype.createMarkers=function(){var a=new McxStroke;a.setWidth(this.strokeWidth);a.setColor(this.strokeColor);var b=new McxFill;b.setColor(this.fillColor);b.setOpacity(this.opacity);var c=new McxCircleMark,d=b.clone();d.setOpacity(1);c.setFill(d);d=a.clone();d.setWidth(3);c.setStroke(d);for(d=0;d<this.features.length;d++){var e=null,f=this.features[d];f&&null!=f&&(f.getGeometry().isInstanceOf(McxGeometryType.Point)?(e=f.getGeometry(),e=new McxPointMarker(e,this.guid),f=new McxPointSymbolizer,
f.setSymbols([c]),e.setSymbolizer(f)):f.getGeometry().isInstanceOf(McxGeometryType.Polygon)?(e=f.getGeometry(),e=new McxPolygonMarker(e,this.guid),f=new McxPolygonSymbolizer,f.setFill(b),f.setStroke(a),e.setSymbolizer(f)):f.getGeometry().isInstanceOf(McxGeometryType.LineString)?(e=f.getGeometry(),e=new McxLineStringMarker(e,this.guid),f=new McxLineSymbolizer,f.setStroke(a),e.setSymbolizer(f)):f.getGeometry().isInstanceOf(McxGeometryType.MultiLineString)?(e=f.getGeometry(),e=new McxMultiLineStringMarker(e,
this.guid),f=new McxLineSymbolizer,f.setStroke(a),e.setSymbolizer(f)):f.getGeometry().isInstanceOf(McxGeometryType.MultiPolygon)&&(e=f.getGeometry(),e=new McxMultiPolygonMarker(e,this.guid),f=new McxPolygonSymbolizer,f.setStroke(a),f.setFill(b),e.setSymbolizer(f)),null!=e&&this.markers.push(e))}var g=this;this.firstTimerTick=function(){null==g.markers||0>=g.markers.length||(g.map.getMarkerCollection().removeRange(g.markers),g.continious?setTimeout(g.secondTimerTick,g.interval):g.map.getRenderer().paintNonLayer())};
this.secondTimerTick=function(){g.blink();setTimeout(g.firstTimerTick,g.interval)};setTimeout(this.secondTimerTick,0)};McxBlinkAction.prototype.blink=function(){null==this.markers||0>=this.markers.length||(this.map.getMarkerCollection().addRange(this.markers),this.map.getRenderer().paintNonLayer())};McxBlinkAction.prototype.clearMarkers=function(){0<this.markers.length&&this.map.getMarkerCollection().removeRange(this.markers)};
McxBlinkAction.prototype.isInstanceOf=function(a){return"McxBlinkAction"==a};js.builtin.McxMapping.Action.McxBlinkGeometryAction={};function McxBlinkGeometryAction(a,b){this.geometries=[];this.geometries=a instanceof Array?a:[a];this.interval=b;this.markers=[];this.map=null;this.fillColor="red";this.opacity=.2;this.strokeWidth=2;this.strokeColor="red";this.guid=McxGuid.createGuid();this.continuous=!1;this.secondTimerTick=this.firstTimerTick=null}McxBlinkGeometryAction.prototype.setContinuous=function(a){this.continuous=a};McxBlinkGeometryAction.prototype.getContinuous=function(){return this.continuous};
McxBlinkGeometryAction.prototype.execute=function(a){this.map=a;this.guid=McxGuid.createGuid();this.createMarkers()};
McxBlinkGeometryAction.prototype.createMarkers=function(){var a=new McxStroke;a.setWidth(this.strokeWidth);a.setColor(this.strokeColor);var b=new McxFill;b.setColor(this.fillColor);b.setOpacity(this.opacity);var c=new McxCircleMark,d=b.clone();d.setOpacity(1);c.setFill(d);d=a.clone();d.setWidth(3);c.setStroke(d);for(d=0;d<this.geometries.length;d++){var e=null,f=this.geometries[d];f&&null!=f&&(f.isInstanceOf(McxGeometryType.Point)?(e=new McxPointMarker(f,this.guid),f=new McxPointSymbolizer,f.setSymbols([c]),
e.setSymbolizer(f)):f.isInstanceOf(McxGeometryType.Polygon)?(e=new McxPolygonMarker(f,this.guid),f=new McxPolygonSymbolizer,f.setFill(b),f.setStroke(a),e.setSymbolizer(f)):f.isInstanceOf(McxGeometryType.LineString)?(e=new McxLineStringMarker(f,this.guid),f=new McxLineSymbolizer,f.setStroke(a),e.setSymbolizer(f)):f.isInstanceOf(McxGeometryType.MultiPolygon)&&(e=new McxMultiPolygonMarker(f,this.guid),f=new McxPolygonSymbolizer,f.setStroke(a),f.setFill(b),e.setSymbolizer(f)),null!=e&&this.markers.push(e))}var g=
this;this.firstTimerTick=function(){null==g.markers||0>=g.markers.length||(g.map.getMarkerCollection().removeRange(g.markers),g.continious?setTimeout(g.secondTimerTick,g.interval):g.map.getRenderer().paintNonLayer())};this.secondTimerTick=function(){g.blink();setTimeout(g.firstTimerTick,g.interval)};setTimeout(this.secondTimerTick,0)};McxBlinkGeometryAction.prototype.blink=function(){null==this.markers||0>=this.markers.length||(this.map.getMarkerCollection().addRange(this.markers),this.map.getRenderer().paintNonLayer())};
McxBlinkGeometryAction.prototype.clearMarkers=function(){0<this.markers.length&&this.map.getMarkerCollection().removeRange(this.markers)};McxBlinkGeometryAction.prototype.isInstanceOf=function(a){return"McxBlinkGeometryAction"==a};js.builtin.McxMapping.Action.McxCoordinateSystemSetterAction={};function McxCoordinateSystemSetterAction(){this.map=this.dialog=null}McxCoordinateSystemSetterAction.prototype.execute=function(a){this.map=a;$.ajax({url:$("mcxconfigurationpath").attr("src")||"src/appdata/McxConfiguration.xml",dataType:"xml",type:"GET",cache:!0,async:!0,success:$.proxy(this.serviceUriSuccess,this),error:$.proxy(this.serviceUriFail,this)})};
McxCoordinateSystemSetterAction.prototype.dialogOkButtonClick=function(){var a=this.dialog.getCoordinateSystem();this.map.setCoordinateSystem(a)};McxCoordinateSystemSetterAction.prototype.serviceUriSuccess=function(a){a=$(a).find("services").find("geospatialService").find("uri").text()+"/rest/json/GetCSDefinitions";$.ajax({url:a,dataType:"json",type:"GET",cache:!0,async:!0,success:$.proxy(this.serviceSuccess,this),error:$.proxy(this.serviceFail,this)})};
McxCoordinateSystemSetterAction.prototype.serviceUriFail=function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxMapping-CoordinateTransformServiceURIFailMessage"),McxMessageBoxType.Error)};McxCoordinateSystemSetterAction.prototype.serviceSuccess=function(a){this.dialog=new McxCoordinateSystemDialog(a);this.dialog.showDialog(!1,!1);this.dialog.getOkButtonClickHandler().addListener(this.dialogOkButtonClick,null,this)};
McxCoordinateSystemSetterAction.prototype.serviceFail=function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxMapping-CoordinateTransformServiceFailMessage"),McxMessageBoxType.Error)};McxCoordinateSystemSetterAction.prototype.isInstanceOf=function(a){return"McxCoordinateSystemSetterAction"==a};js.builtin.McxMapping.Action.McxCreateClusterMapAction={};function McxCreateClusterMapAction(){this._clusterMapDialog=new McxClusterMapDialog;this._map=null}
McxCreateClusterMapAction.prototype.execute=function(a){0==mcx.isDefAndNotNull(a)&&McxMessageBox.show(null,"No map found!",McxMessageBoxType.Error);this._map=a;a=a.getLayers();for(var b=a.length-1;0<b;b--)a.getAt(b).isInstanceOf("IMcxTileLayer")||a.removeAt(b);this._clusterMapDialog.setLayers(a);this._clusterMapDialog.getSubmitHandler().addListener(this.onHeatMapFieldsSelected,null,this);this._clusterMapDialog.showDialog()};
McxCreateClusterMapAction.prototype.onHeatMapFieldsSelected=function(a){var b=this._clusterMapDialog.getLayerName(),c=this._clusterMapDialog.getSelectedLayer(),d=this._clusterMapDialog.getRadius(),e=this._clusterMapDialog.getIsSingleTile();if(0==mcx.isDefAndNotNull(c))McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("McxMapping-NoLayerSelectedError"),McxMessageBoxType.Error),a.setIsValidated(!1);else if(""==b)McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("McxMapping-LayerNameRequiredError"),
McxMessageBoxType.Error),a.setIsValidated(!1);else{this._map.getLayers().remove(c);a=c.getSymbolizer().clone();var f=new McxAjaxParameter;f.setAsync(!1);f=c.getDataSource().getLayer(c.getName(),f,!0).getLayers()[0];null!=f&&(f.setAlias("CLUSTER:"+b),f.setOrder(c.getOrder()),f.setSymbolizer(a),b=new McxClusterMapCanvas(f,this._map),b.setSingleTile(e),b.setRadius(d),d=this._map.getRenderer(),d.addCanvas(b),d.paintLayer(b.getLayers(),null))}};
McxCreateClusterMapAction.prototype.isInstanceOf=function(a){return"McxCreateClusterMapAction"==a};js.builtin.McxMapping.Action.McxCreateHeatMapAction={};function McxCreateHeatMapAction(){this._heatMapDialog=new McxHeatMapDialog;this._map=null}
McxCreateHeatMapAction.prototype.execute=function(a){0==mcx.isDefAndNotNull(a)&&McxMessageBox.show(null,"No map found!",McxMessageBoxType.Error);this._map=a;var b={},b=a.getLayers().toLayerArray();a=[];for(var c=0;c<b.length;c++)b[c].isInstanceOf("IMcxTileLayer")||a.push(b[c]);this._heatMapDialog.setLayers(a);this._heatMapDialog.getSubmitHandler().addListener(this.onHeatMapFieldsSelected,null,this);this._heatMapDialog.showDialog()};
McxCreateHeatMapAction.prototype.onHeatMapFieldsSelected=function(a){var b=this._heatMapDialog.getRadius(),c=this._heatMapDialog.getGradient()||new McxGradient,d=this._heatMapDialog.getOpacity(),e=this._heatMapDialog.getSelectedLayer(),f=this._heatMapDialog.getSelectedFieldName();0==mcx.isDefAndNotNull(e)?(McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("McxMapping-NoLayerSelectedError"),McxMessageBoxType.Error),a.setIsValidated(!1)):""==this._heatMapDialog.getLayerName()?(McxMessageBox.show(null,
McxLocalizationManager.getLocaleValue("McxMapping-LayerNameRequiredError"),McxMessageBoxType.Error),a.setIsValidated(!1)):(a=new McxAjaxParameter,a.setAsync(!1),e=e.getDataSource().getLayer(e.getName(),a,!0).getLayers()[0],null!=e&&(e.setAlias("HEATMAP:"+this._heatMapDialog.getLayerName()),e=new McxHeatMapCanvas(e,this._map),e.setSingleTile(this._heatMapDialog.getIsSingleTile()),e.setParameters(b,d,c),e.setAdditiveFields(f),b=this._map.getRenderer(),b.addCanvas(e),b.paintLayer(e.getLayers(),null)))};
McxCreateHeatMapAction.prototype.isInstanceOf=function(a){return"McxCreateHeatMapAction"==a};js.builtin.McxMapping.Action.McxEditMapBackColorAction={};function McxEditMapBackColorAction(){}McxEditMapBackColorAction.prototype.isInstanceOf=function(a){return"IMcxAction"==a||"McxEditMapBackColorAction"==a};McxEditMapBackColorAction.prototype.execute=function(a){var b=new McxColorSelectDialog(a.getBackColor());b.getColorChangedEventHandler().addListener(function(){var c=b.getSelectedColor();a.setBackColor(c)},function(){},this);b.showDialog(!0,!1)};js.builtin.McxMapping.Action.McxExportByAttributeAction={};function McxExportByAttributeAction(){this._dataSource=this._map=this._control=this._dialog=null}
McxExportByAttributeAction.prototype.execute=function(a){this._map=a;this._dialog=new McxSelectByAttributeDialog(this._map);this._dialog.setShowExportMapView(!0);this._dialog.showSelectionMode(!1);this._dialog.onCancelButtonClickHandler().addListener(this.cancelButtonClick,null,this);this._dialog.onSelectButtonClickHandler().addListener(this.selectButtonClick,null,this);this._dialog.setLayerArray(this._map.getLayers().toLayerArray());this._dialog.showDialog();this._control=this._dialog.getControl()};
McxExportByAttributeAction.prototype.selectButtonClick=function(){var a=new McxFilter;a.setAttributeFilter(this._control.getSql());this._dialog.setAsBusy();var b=this._control.getLayer(),c=this._dialog.getExportMapFiltersComboValue(),d=b.getDataSource().getSource().split("@")[4],e=new McxAjaxParameter;e.setParameters(this,function(){this._dialog.setAsIdle()},function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxMapping-ExportMapFailMessage"),McxMessageBoxType.Error);this._dialog.setAsIdle()});
a=new McxExportMapAction(d,[b],c.toString(),a);a.setAjaxParameter(e);a.execute(this._map)};McxExportByAttributeAction.prototype.cancelButtonClick=function(){this._dialog.close()};McxExportByAttributeAction.prototype.isInstanceOf=function(a){return"McxExportByAttributeAction"==a};js.builtin.McxMapping.Action.McxExportMapAction={};function McxExportMapAction(a,b,c,d,e){this._layer=b;this._driverFilter=c;this._url=a;this._ajaxParameter=null;this._filter=d;this._geometryArray=e||[]}McxExportMapAction.prototype.setAjaxParameter=function(a){this._ajaxParameter=a};
McxExportMapAction.prototype.execute=function(a){a=function(){};var b=function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxMapping-ExportMapFailMessage"),McxMessageBoxType.Error)};null==this._ajaxParameter&&(this._ajaxParameter=new McxAjaxParameter,this._ajaxParameter.setParameters(this,a,b));a={};for(var c=0;c<this._layer.length;c++){var d=this._layer[c],b=d.getDataSource(),e=b.getSource(),b=d.getName();a[e]&&null!=a[e]||(a[e]=[]);a[e][c]=d}for(var f in a){b=a[f][0].getDataSource();
e=Object.keys(a)[0];c=e.split("@")[2];e=e.split("@")[3];c=c.split(";");d=b.getDriver();null==this._filter&&(this._filter=new McxFilter);var g=this._filter.getSpatialRelation().toString(),h=[],k;for(k in a[f]){var b=a[f][k].getName(),m=this._filter.getAttributeFilter(),b=new McxLayerParam(e+":"+b,m);h.push(b)}d.exportMapData(this._url,c[0],this._driverFilter,h,this._geometryArray,g.toString(),this._ajaxParameter)}};McxExportMapAction.prototype.isInstanceOf=function(a){return"McxExportMapAction"==a};js.builtin.McxMapping.Action.McxExportSelectByGeometryAction={};function McxExportSelectByGeometryAction(){this._dataSource=this._layer=this._map=this._control=this._dialog=null}
McxExportSelectByGeometryAction.prototype.execute=function(a){this._map=a;this._dialog=new McxSelectByGeometryDialog(this._map);this._dialog.showSelectionMode(!1);this._dialog.setShowExportMapView(!0);this._dialog.onCancelButtonClickHandler().addListener(this.cancelButtonClick,null,this);this._dialog.onSelectButtonClickHandler().addListener(this.selectButtonClick,null,this);this._dialog.setLayerArray(this._map.getLayers().toLayerArray());this._dialog.showDialog();this._control=this._dialog.getSelectControl()};
McxExportSelectByGeometryAction.prototype.selectButtonClick=function(){var a=this._dialog.getLayerFilter()[0].getFilter(),b=new McxFilter;b.setSpatialRelation(a.getSpatialRelation());this._dialog.setAsBusy();this._layer=this._control.getLayer();if(0!=this._layer.length){for(var c=this._layer[0].getDataSource().getSource(),d=0;d<this._layer.length;d++)if(c!=this._layer[d].getDataSource().getSource()){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxMapping-MultiDataSourceMessage"),McxMessageBoxType.Warning);
return}var d=this._dialog.getExportMapFiltersComboValue(),e=c.split("@")[4],c=new McxAjaxParameter;c.setParameters(this,function(){this._dialog.setAsIdle()},function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxMapping-ExportMapFailMessage"),McxMessageBoxType.Error);this._dialog.setAsIdle()});a=new McxExportMapAction(e,this._layer,d.toString(),b,a.getGeometryArray());a.setAjaxParameter(c);a.execute(this._map)}};McxExportSelectByGeometryAction.prototype.cancelButtonClick=function(){this._dialog.close()};
McxExportSelectByGeometryAction.prototype.isInstanceOf=function(a){return"McxExportSelectByGeometryAction"==a};js.builtin.McxMapping.Action.McxFeatureGridAction={};function McxFeatureGridAction(a,b){this._layer=a;this._mapInteractionFactory=b;this._isStretched=!1;this._featureGridDialog=null;this._beforeFeatureGridInitHandler=new McxEventHandler;this._afterDialogInitHandler=new McxEventHandler}
McxFeatureGridAction.prototype.execute=function(a){a=new McxFeatureGridWrapper(a,this._layer,this._mapInteractionFactory);var b=McxButtonAuthorityHelper.instance.getButtonVisibility(McxButtonAuthorityType.FeatureGridSaveAndDeleteButton);a.setEditable(b);a.setToolbar(!0,!0,!1,b,b);this.getBeforeFeatureGridInitHandler().dispatchOnSuccess(this,new McxEventArgs(a));a.initialize();this._isStretched&&a.stretch();this._featureGridDialog=new McxFeatureGridWrapperDialog(a);this._featureGridDialog.showDialog();
this.getAfterDialogInitHandler().dispatchOnSuccess(this,new McxEventArgs(this._featureGridDialog))};McxFeatureGridAction.prototype.getFeatureGridDialog=function(){return this._featureGridDialog};McxFeatureGridAction.prototype.stretch=function(){this._isStretched=!0};McxFeatureGridAction.prototype.getBeforeFeatureGridInitHandler=function(){return this._beforeFeatureGridInitHandler};McxFeatureGridAction.prototype.getAfterDialogInitHandler=function(){return this._afterDialogInitHandler};
McxFeatureGridAction.prototype.isInstanceOf=function(a){return"McxFeatureGridAction"==a};js.builtin.McxMapping.Action.McxGoToAction={};function McxGoToAction(a){this.coordinate=a;this.localePath=""}McxGoToAction.prototype.setLocaleFolderPath=function(a){this.localePath=a};
McxGoToAction.prototype.execute=function(a){var b=$("<div/>").addClass("myLocation-marker"),c=new McxGoToXY;c.showDialog(!1,!1);c.setLocaleFolderPath(this.localePath);var d=new McxAjaxParameter;d.setAsync(!1);d.setParameters(this,function(){},function(){});d=a.getWorld().getCentroid();c.setX(d.getX());c.setY(d.getY());c.getOkButtonClickHandler().addListener(function(){var d=parseFloat(c.getX()),f=parseFloat(c.getY()),f=McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createPoint(d,f),d=new McxContentMarker(f,
McxGuid.createGuid(),b),f=new McxZoomBoundsAction([f.getBounds()]);f.setRatio(1);a.getMarkerCollection().clear();a.getMarkerCollection().add(d);a.getInputHandler().execute(f);setTimeout(function(){a.getMarkerCollection().clear();b.detach()},3E4)},null,this)};McxGoToAction.prototype.isInstanceOf=function(a){return"McxGoToAction"==a};js.builtin.McxMapping.Action.McxGotoLocationAction={};function McxGoToLocationAction(){this.localePath="";this.markerId=McxGuid.createGuid()}McxGoToLocationAction.prototype.setLocaleFolderPath=function(a){this.localePath=a};
McxGoToLocationAction.prototype.execute=function(a){var b=$("<div/>").addClass("myLocation-marker"),c=this;navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(d){var e=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(4326),e=McxFactoryFinder.GeometryFactory(e).createPoint(d.coords.longitude,d.coords.latitude).transformTo(a.getCoordinateSystem());d=new McxContentMarker(e,c.markerId,b);e=new McxZoomBoundsAction([e.getBounds()]);e.setRatio(1/6);a.getMarkerCollection().clear();
a.getMarkerCollection().add(d);a.getInputHandler().execute(e);setTimeout(function(){a.getMarkerCollection().clear();b.detach()},3E4)})};McxGoToLocationAction.prototype.isInstanceOf=function(a){return"McxGoToLocationAction"==a};js.builtin.McxMapping.Action.McxHighLightAction={};function McxHighLightAction(a,b){this.features=a;this.hightLightMode=b;this.map=null;this.fillColor="red";this.opacity=.2;this.strokeWidth=2;this.strokeColor="red";this.guid="C296F457-FA00-4C6C-BC59-12FD6FE5F4D2"}McxHighLightAction.prototype.setFillColor=function(a){this.fillColor=a};McxHighLightAction.prototype.setStrokeColor=function(a){this.strokeColor=a};
McxHighLightAction.prototype.execute=function(a){this.hightLightMode==McxHighLightMode.ClearList?this.clearMarkers(a):(this.hightLightMode==McxHighLightMode.AddNew&&this.clearMarkers(a),null!=this.features&&this.createMarkers(a))};
McxHighLightAction.prototype.createMarkers=function(a){var b=new McxStroke;b.setWidth(this.strokeWidth);b.setColor(this.strokeColor);var c=new McxFill;c.setColor(this.fillColor);c.setOpacity(this.opacity);var d=new McxCircleMark,e=c.clone();e.setOpacity(1);d.setFill(e);e=b.clone();e.setWidth(3);d.setStroke(e);for(e=0;e<this.features.length;e++){var f=null,g=this.features[e];g&&null!=g&&(g.getGeometry().isInstanceOf(McxGeometryType.Point)?(f=g.getGeometry(),f=new McxPointMarker(f,this.guid),g=new McxPointSymbolizer,
g.setSymbols([d]),f.setSymbolizer(g)):g.getGeometry().isInstanceOf(McxGeometryType.Polygon)?(f=g.getGeometry(),f=new McxPolygonMarker(f,this.guid),g=new McxPolygonSymbolizer,g.setFill(c),g.setStroke(b),f.setSymbolizer(g)):g.getGeometry().isInstanceOf(McxGeometryType.LineString)?(f=g.getGeometry(),f=new McxLineStringMarker(f,this.guid),g=new McxLineSymbolizer,g.setStroke(b),f.setSymbolizer(g)):g.getGeometry().isInstanceOf(McxGeometryType.MultiPolygon)&&(f=g.getGeometry(),f=new McxMultiPolygonMarker(f,
this.guid),g=new McxPolygonSymbolizer,g.setStroke(b),g.setFill(c),f.setSymbolizer(g)),null!=f&&a.getMarkerCollection().add(f))}a.getRenderer().paintNonLayer()};McxHighLightAction.prototype.clearMarkers=function(a){a.getMarkerCollection().removeWithGuid(this.guid);a.getRenderer().paintNonLayer()};McxHighLightAction.prototype.isInstanceOf=function(a){return"McxHighLightAction"==a};js.builtin.McxMapping.Action.McxMapAddonSettings={};var McxMapAddonSettings={featureLayerUriKey:"featureLayerUriKey",rasterLayerUriKey:"rasterLayerUriKey",tileLayerUriKey:"tileLayerUriKey",getMapServiceUriKey:"getMapServerUri",wmsLayerUriKey:"wmsLayerUriKey",arcGisLayerUriKey:"arcGisLayerUriKey",arcGisTileLayerUriKey:"arcGisTileLayerUriKey"};js.builtin.McxMapping.Action.McxMarkerBlinkAction={};function McxMarkerBlinkAction(a,b){this.markerFeatures=a;this.interval=b;this.markers=[];this.map=null;this.fillColor="blue";this.opacity=.2;this.strokeWidth=2;this.strokeColor="red";this.guid=McxGuid.createGuid();this.continuous=!1;this.secondTimerTick=this.firstTimerTick=null}McxMarkerBlinkAction.prototype.setContinuous=function(a){this.continuous=a};McxMarkerBlinkAction.prototype.getContinuous=function(){return this.continuous};
McxMarkerBlinkAction.prototype.execute=function(a){this.map=a;this.guid=McxGuid.createGuid();this.createMarkers()};
McxMarkerBlinkAction.prototype.createMarkers=function(){var a=new McxStroke;a.setWidth(this.strokeWidth);a.setColor(this.strokeColor);var b=new McxFill;b.setColor(this.fillColor);b.setOpacity(this.opacity);var c=new McxCircleMark;c.setFill(b);c.setStroke(a);var d=null,e=this.markerFeatures;if(e&&null!=e&&(e.getGeometry().isInstanceOf(McxGeometryType.Point)?(a=e.getGeometry(),d=new McxPointMarker(a,this.guid),a=new McxPointSymbolizer,a.setSymbols([c]),d.setSymbolizer(a)):e.getGeometry().isInstanceOf(McxGeometryType.Polygon)?
(d=e.getGeometry(),d=new McxPolygonMarker(d,this.guid),c=new McxPolygonSymbolizer,c.setFill(b),c.setStroke(a),d.setSymbolizer(c)):e.getGeometry().isInstanceOf(McxGeometryType.LineString)?(b=e.getGeometry(),d=new McxLineStringMarker(b,this.guid),b=new McxLineSymbolizer,b.setStroke(a),d.setSymbolizer(b)):e.getGeometry().isInstanceOf(McxGeometryType.MultiPolygon)&&(d=e.getGeometry(),d=new McxMultiPolygonMarker(d,this.guid),c=new McxPolygonSymbolizer,c.setStroke(a),c.setFill(b),d.setSymbolizer(c)),null!=
d)){this.markers.push(d);var f=this;this.firstTimerTick=function(){null==f.markers||0>=f.markers.length||(f.map.getMarkerCollection().removeRange(f.markers),f.continious?setTimeout(f.secondTimerTick,f.interval):f.map.getRenderer().paintNonLayer())};this.secondTimerTick=function(){f.blink();setTimeout(f.firstTimerTick,f.interval)};setTimeout(this.secondTimerTick,0)}};
McxMarkerBlinkAction.prototype.blink=function(){null==this.markers||0>=this.markers.length||(this.map.getMarkerCollection().addRange(this.markers),this.map.getRenderer().paintNonLayer())};McxMarkerBlinkAction.prototype.isInstanceOf=function(a){return"McxMarkerBlinkAction"==a};js.builtin.McxMapping.Action.McxOpenCadLayerAction={};function McxOpenCadLayerAction(){this.localePath=""}McxOpenCadLayerAction.prototype.setLocalePath=function(a){this.localePath=a};
McxOpenCadLayerAction.prototype.execute=function(a){var b=McxLocalizationManager.getLocaleValue("McxMapping-OpenCadLayer"),c=new McxInputBoxDialog(b);c.showDialog(!1,!1);c.getOkButtonClickHandler().addListener(function(){var b=c.getValue(),b=(new McxMemDriver).openDataSource("").getDataSource().createLayer(b,a.getCoordinateSystem(),McxGeometryType.Unknown,[]);b.setPainterMode(McxPainterMode.ByFeature);b.setOrder(a.getLayers().getCount());a.getLayers().add(b);var e=new McxFieldDefinition;e.setFieldName("Label");
e.setIsEditable(!0);e.setFieldType("String");b.getSchema().addField(e);b.setLabelFormat("[Label]");b.setShowLabels(!0);a.getRenderer().paintLayer(b,null)},null,this)};McxOpenCadLayerAction.prototype.isInstanceOf=function(a){return"McxOpenCadLayerAction"==a};js.builtin.McxMapping.Action.McxPanFeatureAction={};function McxPanFeatureAction(a){this.features=a}
McxPanFeatureAction.prototype.execute=function(a){if(!(null==this.features||0>=this.features.length)){for(var b,c=0;c<this.features.length;c++)if(null!=this.features[c].getGeometry()){var d=this.features[c].getGeometry().transformTo(a.getCoordinateSystem());null!=d&&(b=0==c?d.getBounds():b.merge(d.getBounds()))}b=b.getCentroid();c=a.getWorld().getCentroid();b=McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createPoint(b.getX()-c.getX(),b.getY()-c.getY());a.getRenderer().translate(b.getX(),
b.getY(),!0);a.getRenderer().paintLayer(null,null)}};McxPanFeatureAction.prototype.isInstanceOf=function(a){return"McxPanFeatureAction"==a};js.builtin.McxMapping.Action.McxPrintOptionsAction={};function McxPrintOptionsAction(a){this._mapIntFactry=a}McxPrintOptionsAction.prototype.execute=function(a){(new McxPrintOptionsDialog(a,this._mapIntFactry)).showDialog()};McxPrintOptionsAction.prototype.isInstanceOf=function(a){return"McxPanFeatureAction"==a};js.builtin.McxMapping.Action.McxSlideAction={};function McxSlideAction(a,b){this.dx=a;this.dy=b}
McxSlideAction.prototype.execute=function(a){if(0!=this.dx||0!=this.dy){a.getRenderer().paintNonLayer();var b=McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createPoint(-1*this.dx,this.dy),c=a.getWorld();if(0>b.x)var d=c.left+b.x,e=c.left;else d=c.right,e=c.right+b.x;if(0>b.y)var f=c.bottom+b.y,g=c.bottom;else f=c.top,g=c.top+b.y;var h=McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()),k=h.createBounds(d,f,e,g),d=h.createBounds(d,c.bottom,e,c.top),c=h.createBounds(c.left,f,c.right,
g);a.getRenderer().translate(b.x,b.y,!0);a.getRenderer().paintLayer(null,[k,d,c])}};McxSlideAction.prototype.isInstanceOf=function(a){return"McxSlideAction"==a};js.builtin.McxMapping.Action.McxWorkspaceSelectionAction={};function McxWorkspaceSelectionAction(a){this._worspaceSelectionDialog=null;this._workspaceInfoArray=a}
McxWorkspaceSelectionAction.prototype.execute=function(a){this._worspaceSelectionDialog=new McxWorkspaceSelectionDialog;this._worspaceSelectionDialog.setWorkspaces(this._workspaceInfoArray);this._worspaceSelectionDialog.getWorkspaceInfoClickHandler().addListener(this.onWorkspaceInfoClick,null,this);this._worspaceSelectionDialog.showDialog(!1,!1)};McxWorkspaceSelectionAction.prototype.onWorkspaceInfoClick=function(a){a=a.getWorkspaceInfo();McxMessageBox.show("",a.getName().toString(),McxMessageBoxType.Information)};
McxWorkspaceSelectionAction.prototype.isInstanceOf=function(a){return"McxWorkspaceSelectionAction"==a};js.builtin.McxMapping.Action.McxZoomAction={};function McxZoomAction(a,b){this.ratio=a;this.cursorPosition=b}McxZoomAction.prototype.execute=function(a){a.getRenderer().zoomTo(this.ratio,this.cursorPosition.x,this.cursorPosition.y)};McxZoomAction.prototype.isInstanceOf=function(a){return"McxZoomAction"==a};js.builtin.McxMapping.Action.McxZoomBoundsAction={};function McxZoomBoundsAction(a){this.bounds=a;this.ratio=.5}
McxZoomBoundsAction.prototype.execute=function(a){if(!(null==this.bounds||0>=this.bounds.length||null==this.bounds[0])){a.getWorld();for(var b=null,c=0;c<this.bounds.length;c++)if(null!=this.bounds[c]){var d=this.bounds[c].transformTo(a.getCoordinateSystem());null!=d&&(b=null==b?d:b.merge(d))}c=a.getScale();a.setScale(.001);if(b.getLeft()==b.getRight()&&b.getBottom()==b.getTop())var e=a.worldToView(b.getLeft(),b.getTop()),f=e.getX()-30,b=e.getX()+30,d=e.getY()-30,e=e.getY()+30,f=McxFactoryFinder.GeometryFactory(null).createPoint(f,
e),d=McxFactoryFinder.GeometryFactory(null).createPoint(b,d),b=a.viewToWorld(f.getX(),f.getY()),g=a.viewToWorld(d.getX(),d.getY()),d=Math.min(b.getX(),g.getX()),f=Math.min(b.getY(),g.getY()),e=Math.max(b.getX(),g.getX()),b=Math.max(b.getY(),g.getY()),b=McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createBounds(d,f,e,b);b=b.inflate(b.getWidth()*(1/this.ratio),b.getHeight()*(1/this.ratio));a.setWorld(b.getLeft(),b.getBottom(),b.getRight(),b.getTop());1==this.ratio&&a.setScale(c);if(b=a.getScaleSet())c=
parseFloat(b.getZoomLevelAt(0)),b=parseFloat(b.getZoomLevelAt(b.getScaleLength()-1)),1/a.getScale()<1/c?a.setScale(c):1/a.getScale()>1/b&&a.setScale(b);a.getWorld();b=a.getRenderer();for(c=0;c<b.getCount();c++)d=b.getCanvasByIndex(c),d.paintBackBuffer(),d.clearCanvas(),d.clearBackBuffer();a.getRenderer().paintLayer(null,null)}};McxZoomBoundsAction.prototype.setRatio=function(a){this.ratio=a};McxZoomBoundsAction.prototype.isInstanceOf=function(a){return"McxZoomBoundsAction"==a};js.builtin.McxMapping.Action.McxZoomExtentAction={};function McxZoomExtentAction(){}
McxZoomExtentAction.prototype.execute=function(a){McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createBounds(0,0,0,0);for(var b=a.getLayers(),c=function(b){b=b.getEnvelope();b=b.transformTo(a.getCoordinateSystem());a.setWorld(b.getLeft(),b.getBottom(),b.getRight(),b.getTop());a.getRenderer().paintLayer(null,null)},d=function(a){},e=0;e<b.getCount();e++){var f=b.getAt(e),g=new McxAjaxParameter;g.setParameters(this,c,d);f.getEnvelope(g)}};
McxZoomExtentAction.prototype.isInstanceOf=function(a){return"McxZoomExtentAction"==a};js.builtin.McxMapping.Action.McxZoomFeatureAction={};function McxZoomFeatureAction(a){this.features=a;this.ratio=.5}
McxZoomFeatureAction.prototype.execute=function(a){if(!(null==this.features||0>=this.features.length)){for(var b=[],c=0;c<this.features.length;c++){var d=this.features[c].getGeometry();if(null!=d){var e=null,e=d.isInstanceOf(McxGeometryType.Point)||d.isInstanceOf(McxGeometryType.MultiPoint)?this.getPointBounds(d,a):d.getBounds();e.setCoordinateSystem(d.getCoordinateSystem());null!=e&&b.push(e)}}b=new McxZoomBoundsAction(b);b.setRatio(this.ratio);b.execute(a)}};
McxZoomFeatureAction.prototype.getPointBounds=function(a,b){var c=a.transformTo(b.getCoordinateSystem()),d=b.geometryToView(c).getBounds(),c=b.viewToWorld(d.getLeft(),d.getBottom()),e=b.viewToWorld(d.getRight(),d.getTop()),d=Math.min(c.getX(),e.getX()),f=Math.max(c.getX(),e.getX()),g=Math.min(c.getY(),e.getY()),c=Math.max(c.getY(),e.getY());return(new McxBounds(d,g,f,c,b.getCoordinateSystem())).transformTo(a.getCoordinateSystem())};McxZoomFeatureAction.prototype.setRatio=function(a){this.ratio=a};
McxZoomFeatureAction.prototype.isInstanceOf=function(a){return"McxZoomFeatureAction"==a};js.builtin.McxMapping.Action.McxZoomGeometryAction={};function McxZoomGeometryAction(a){this.geometries=null;this.geometries=a instanceof Array?a:[a];this.ratio=.5}
McxZoomGeometryAction.prototype.execute=function(a){if(!(null==this.geometries||0>=this.geometries.length)){for(var b=[],c=0;c<this.geometries.length;c++){var d=this.geometries[c];if(null!=d){var e=null,e=d.isInstanceOf(McxGeometryType.Point)||d.isInstanceOf(McxGeometryType.MultiPoint)?this.getPointBounds(d,a):d.getBounds();e.setCoordinateSystem(d.getCoordinateSystem());null!=e&&b.push(e)}}b=new McxZoomBoundsAction(b);b.setRatio(this.ratio);b.execute(a)}};
McxZoomGeometryAction.prototype.getPointBounds=function(a,b){var c=a.transformTo(b.getCoordinateSystem()),d=b.geometryToView(c).getBounds(),c=b.viewToWorld(d.getLeft(),d.getBottom()),e=b.viewToWorld(d.getRight(),d.getTop()),d=Math.min(c.getX(),e.getX()),f=Math.max(c.getX(),e.getX()),g=Math.min(c.getY(),e.getY()),c=Math.max(c.getY(),e.getY());return(new McxBounds(d,g,f,c,b.getCoordinateSystem())).transformTo(a.getCoordinateSystem())};
McxZoomGeometryAction.prototype.setRatio=function(a){this.ratio=a};McxZoomGeometryAction.prototype.isInstanceOf=function(a){return"McxZoomGeometryAction"==a};js.builtin.McxMapping.Action.McxZoomLayerAction={};function McxZoomLayerAction(a,b){this.layers=a;this.envelope=null;this.inflateRatio=b}
McxZoomLayerAction.prototype.execute=function(a){var b=[];if(Array.isArray(this.layers)){if(null==this.layers||0>=this.layers.length||null==this.layers[0])return;for(var c=0;c<this.layers.length;c++)this.getEnvelope(this.layers[c]),this.envelope.setCoordinateSystem(this.layers[c].getCoordinateSystem()),b.push(this.envelope)}else{c=this.layers;if(null==c)return;this.getEnvelope(c);this.envelope.setCoordinateSystem(c.getCoordinateSystem());b.push(this.envelope)}b=new McxZoomBoundsAction(b);b.setRatio(1/
this.inflateRatio);b.execute(a)};McxZoomLayerAction.prototype.getEnvelope=function(a){var b=new McxAjaxParameter;b.setAsync(!1);this.envelope=a.getEnvelope(b).getEnvelope()};McxZoomLayerAction.prototype.isInstanceOf=function(a){return"McxZoomLayerAction"==a};js.builtin.McxMapping.Action.McxZoomSelectedAction={};function McxZoomSelectedAction(){}McxZoomSelectedAction.prototype.execute=function(a){var b=McxSelectionHelper.instance.getSelection(a);0<b.length?(b=new McxZoomFeatureAction(b),b.setRatio(1),b.execute(a)):McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxMapping-ZoomToSelectedNotSelect"),McxMessageBoxType.Warning,McxDialogButtons.ok)};McxZoomSelectedAction.prototype.isInstanceOf=function(a){return"McxZoomSelectedAction"==a};js.builtin.McxMapping.Action.Bookmark={};js.builtin.McxMapping.Action.Bookmark.McxAddBookmarkAction={};function McxAddBookmarkAction(a,b){this._bookmark=a;this._markerGuid=b}
McxAddBookmarkAction.prototype.execute=function(a){var b=this._bookmark,c=new McxPoint(b.getLattitude(),b.getLongitude(),new McxCoordinateSystem(4326)),b=this._bookmark.getFeatureBalloon();b.getAdditionalData("marker");c=new McxContentMarker(c,this._markerGuid,b.getContent());b.setAdditionalData("marker",c);b.getCloseButtonClickHandler().removeListener(this.onSuccess);b.getCloseButtonClickHandler().addListener(this.onSuccess,null,[b,a]);var d=McxGuid.createGuid();b.setTag("markerId",d);c.setTag(d);
a.getMarkerCollection().add(c);a.getRenderer().paintNonLayer();b.getContent().addClass("anim-suspend")};McxAddBookmarkAction.prototype.onSuccess=function(){var a=this[0],b=this[1],c=a.getAdditionalData("marker");a.detach();b.getMarkerCollection().removeMarker(c);b.getRenderer().paintNonLayer()};McxAddBookmarkAction.prototype.isInstanceOf=function(a){return"McxAddBookmarkAction"==a};js.builtin.McxMapping.Action.Bookmark.McxCloseBookmarkAction={};function McxCloseBookmarkAction(a,b){this._bookmark=a;this._markerGuid=b}McxCloseBookmarkAction.prototype.execute=function(a){for(var b=this._bookmark.getFeatureBalloon(),c=b.getAdditionalData("marker"),b=b.getTagValue("markerId"),d=a.getMarkerCollection().find(this._markerGuid),e=0;e<d.length;e++)b==d[e].getTag()&&a.getMarkerCollection().removeMarker(c);a.getRenderer().paintNonLayer()};
McxCloseBookmarkAction.prototype.isInstanceOf=function(a){return"McxCloseBookmarkAction"==a};js.builtin.McxMapping.Action.Bookmark.McxCreateBookmarkAction={};function McxCreateBookmarkAction(a){this._bookMarkCreatedEventHandler=new McxEventHandler;this._markerGuid=a}
McxCreateBookmarkAction.prototype.execute=function(a){var b=new McxCreateBookmarkController;a.getInputHandler().setController(b);b.onBookmarkCreated().addListener(function(a){this.onBookmarkCreated().dispatchOnSuccess(this,a)},null,this);var c=function(){this.onBookmarkCreated().dispatchOnSuccess(this,null);b.getInteractionEndEventHandler().removeListener(c);a.getInputHandler().setController(null)};b.getInteractionEndEventHandler().addListener(c,null,this)};
McxCreateBookmarkAction.prototype.onBookmarkCreated=function(){return this._bookMarkCreatedEventHandler};McxCreateBookmarkAction.prototype.isInstanceOf=function(a){return"McxCreateBookmarkAction"==a};js.builtin.McxMapping.Action.Bookmark.McxEditBookmarkAction={};function McxEditBookmarkAction(a,b){this._bookmark=a;this._onBookmarkEditHandler=new McxEventHandler;this._markerGuid=b}
McxEditBookmarkAction.prototype.execute=function(a){var b=new McxBookmarkEditDialog;b.setBookmark(this._bookmark);b.getSubmitHandler().addListener(function(c){var d=b.getBookmark();d.getTitle()&&d.getLongitude()&&d.getLattitude()?(c=new McxAddBookmarkAction(d,this._markerGuid),a.getInputHandler().execute(c),this.onBookmarkEdited().dispatchOnSuccess(this,null)):(McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("McxMapping-BookmarkRequiredFields"),McxMessageBoxType.Warning),c.setIsValidated(!1))},
null,this);b.showDialog()};McxEditBookmarkAction.prototype.onBookmarkEdited=function(){return this._onBookmarkEditHandler};McxEditBookmarkAction.prototype.isInstanceOf=function(a){return"McxEditBookmarkAction"==a};js.builtin.McxMapping.Action.Bookmark.McxManageBookmarksAction={};function McxManageBookmarksAction(){this._markerGuid=McxGuid.createGuid();this._bookMarkKey="HTML5.Main.Map.Bookmarks";this._map=null}
McxManageBookmarksAction.prototype.execute=function(a){this._map=a;var b=this.getBookmarksFromSettings(),c=new McxBookmarkManagementDialog(this._markerGuid,a);c.setDialogSize(McxDialogSize.medium);c.showDialog();c.setBookmarks(b);c.onCloseDialog().addListener(function(){var a=c.getBookmarks();this.saveBookmarks(a)},null,this)};McxManageBookmarksAction.prototype.saveBookmarks=function(a){a=this.serializeBookmarks(a);McxSettingsManager.write(this._bookMarkKey,a,null)};
McxManageBookmarksAction.prototype.getBookmarksFromSettings=function(){var a=McxSettingsManager.read(this._bookMarkKey,null).getSettings()[0];if(a)try{return this.deserializeBookmarks(a)}catch(b){}return[]};McxManageBookmarksAction.prototype.deserializeBookmarks=function(a){var b=[];a=JSON.parse(a);for(var c=0;c<a.length;c++){var d=new McxBookMark,e=a[c];d.setLattitude(e.lattitude);d.setLongitude(e.longtitude);d.setDescription(e.description);d.setTitle(e.title);b.push(d)}return b};
McxManageBookmarksAction.prototype.serializeBookmarks=function(a){for(var b=[],c=0;c<a.length;c++)b.push({lattitude:a[c].getLattitude(),longtitude:a[c].getLongitude(),title:a[c].getTitle(),description:a[c].getDescription()});return JSON.stringify(b)};McxManageBookmarksAction.prototype.isInstanceOf=function(a){return"McxManageBookmarksAction"==a};js.builtin.McxMapping.Action.LayerListDialog={};js.builtin.McxMapping.Action.LayerListDialog.McxDataSourceListAction={};function McxDataSourceListAction(){this._lastRequest=null;this.localePath="";this.driverType=McxDriverType.Feature}McxDataSourceListAction.prototype.setLocaleFolderPath=function(a){this.localePath=a};
McxDataSourceListAction.prototype.execute=function(a){var b=this,c=McxSettingsManager.read(b.getUrlHistoryKey(),null).getSettings(),d=null;this.driverType==McxDriverType.WMS?d=new McxWmsDataListDialog(c,b.getDialogTitle()):this.driverType==McxDriverType.WMTS?d=new McxWmtsDataListDialog(c,b.getDialogTitle()):this.driverType==McxDriverType.ArcGisRest?(d=new McxDataSourceListDialog(c,b.getDialogTitle()),d.setDriverType(this.driverType),d.setCanCredentialsDisabled(!0)):this.driverType==McxDriverType.ArcGisTile?
(d=new McxDataSourceListDialog(c,b.getDialogTitle()),d.setDriverType(this.driverType),d.setCredentialsDisabled()):(d=new McxDataSourceListDialog(c,b.getDialogTitle()),d.setDriverType(this.driverType));var e=function(){var a=function(){},c=d.getUrlHistoryArray(),e=new McxAjaxParameter;e.setAsync(!0);e.setParameters(this,a,a);McxSettingsManager.write(b.getUrlHistoryKey(),c,e)};d.getOkButtonClickHandler().addListener(function(){b.getServerLayer(d,a);e()},null,this);d.getCloseButtonClickHandler().addListener(e,
null,this);d.getCancelButtonClickHandler().addListener(e,null,this);d.showDialog(!1,!1)};
McxDataSourceListAction.prototype.getServerLayer=function(a,b){var c=0,d=new McxAjaxParameter;d.setParameters(this,function(a){a=a.getLayers();for(var c=0;c<a.length;c++)b.getLayers().add(a[c]);b.getRenderer().paintLayer(a,null)},function(){c++;0==c&&b.getRenderer().paintLayer(null,null)});var e=a.getSelectedLayerNames(),f;for(f in e){var g=e[f],h=g.layers.join(";");g.driver.openDataSource(g.source).getDataSource().getLayer(h,d,!0)}};
McxDataSourceListAction.prototype.setDriverType=function(a){this.driverType=a};McxDataSourceListAction.prototype.getUrl=mcx.abstractMethod;
McxDataSourceListAction.prototype.getUrlHistoryKey=function(){switch(this.driverType){case McxDriverType.Feature:return McxMapAddonSettings.featureLayerUriKey;case McxDriverType.Tile:return McxMapAddonSettings.tileLayerUriKey;case McxDriverType.Raster:return McxMapAddonSettings.rasterLayerUriKey;case McxDriverType.WMS:return McxMapAddonSettings.wmsLayerUriKey;case McxDriverType.ArcGisRest:return McxMapAddonSettings.arcGisLayerUriKey;case McxDriverType.ArcGisTile:return McxMapAddonSettings.arcGisTileLayerUriKey}return""};
McxDataSourceListAction.prototype.getDialogTitle=function(){switch(this.driverType){case McxDriverType.Feature:return"McxCommonDialog-mcxFeatureDataSourceListDialogTitle";case McxDriverType.Tile:return"McxCommonDialog-mcxTileDataSourceListDialogTitle";case McxDriverType.Raster:return"McxCommonDialog-mcxRasterDataSourceListDialogTitle";case McxDriverType.WMS:return"McxCommonDialog-mcxWmsDataSourceListDialogTitle";case McxDriverType.ArcGisRest:return"McxCommonDialog-mcxArcGisMapDataSourceListDialogTitle";
case McxDriverType.ArcGisTile:return"McxCommonDialog-mcxArcGisTileDataSourceListDialogTitle"}return""};McxDataSourceListAction.prototype.openDataSource=function(a){for(var b=[new McxFsDriver,new McxTileDriver,new McxOgcDriver,new McxArcGisDriver,new McxArcGisTileCacheDriver,new McxMemDriver],c=0;c<b.length;c++){var d=b[c].openDataSource(a);if(null!=d)return d}return null};McxDataSourceListAction.prototype.isInstanceOf=function(a){return"McxDataSourceListAction"==a};js.builtin.McxMapping.Action.ExportMapDialog={};js.builtin.McxMapping.Action.ExportMapDialog.McxOpenExportMapAction={};function McxExportMapByDrawingAction(a){mcx.base(this);this._urlHistory=a;this.base=this;this._mcxDataSourceListDialog=null}mcx.inherits(McxExportMapByDrawingAction,McxDataSourceListAction);
McxExportMapByDrawingAction.prototype.execute=function(a){this._mcxDataSourceListDialog=new McxExportMapDialog(this._urlHistory);this._mcxDataSourceListDialog.setActiveMap(a);this._mcxDataSourceListDialog.setDriverType(this.base.driverType);this._mcxDataSourceListDialog.showDialog(!1,!1)};McxExportMapByDrawingAction.prototype.setActiveMap=function(a){null!=this._mcxDataSourceListDialog&&this._mcxDataSourceListDialog.setActiveMap(a)};
McxExportMapByDrawingAction.prototype.isInstanceOf=function(a){return"McxExportMapByDrawingAction"==a};js.builtin.McxMapping.Action.LayerListDialog.McxFeatureDataSourceListAction={};function McxFeatureDataSourceListAction(){mcx.base(this)}mcx.inherits(McxFeatureDataSourceListAction,McxDataSourceListAction);McxFeatureDataSourceListAction.prototype.getUrl=function(a,b,c){return"MFS@REST@credentials="+a+"@"+c+"@"+b};McxFeatureDataSourceListAction.prototype.getUrlHistoryKey=function(){return McxMapAddonSettings.featureLayerUriKey};McxFeatureDataSourceListAction.prototype.getDialogTitle=function(){return"McxCommonDialog-mcxFeatureDataSourceListDialogTitle"};
McxFeatureDataSourceListAction.prototype.isInstanceOf=function(a){return"McxFeatureDataSourceListAction"==a};js.builtin.McxMapping.Action.LayerListDialog.McxRasterListAction={};function McxRasterListAction(){mcx.base(this)}mcx.inherits(McxRasterListAction,McxDataSourceListAction);McxRasterListAction.prototype.getUrl=function(a,b,c){return"MMS@REST@credentials="+a+"@"+c+"@"+b};McxRasterListAction.prototype.getUrlHistoryKey=function(){return McxMapAddonSettings.rasterLayerUriKey};McxRasterListAction.prototype.getDialogTitle=function(){return"McxCommonDialog-mcxRasterDataSourceListDialogTitle"};
McxRasterListAction.prototype.isInstanceOf=function(a){return"McxRasterListAction"==a};js.builtin.McxMapping.Action.LayerListDialog.McxTileListAction={};function McxTileListAction(){mcx.base(this)}mcx.inherits(McxTileListAction,McxDataSourceListAction);McxTileListAction.prototype.getUrl=function(a,b,c){return"MTS@REST@credentials="+a+"@"+c+"@"+b};McxTileListAction.prototype.getUrlHistoryKey=function(){return McxMapAddonSettings.tileLayerUriKey};McxTileListAction.prototype.getDialogTitle=function(){return"McxCommonDialog-mcxTileDataSourceListDialogTitle"};
McxTileListAction.prototype.isInstanceOf=function(a){return"McxTileListAction"==a};js.builtin.McxMapping.Action.OnlineMapDialog={};js.builtin.McxMapping.Action.OnlineMapDialog.McxCreateOnlineMapAction={};function McxCreateOnlineMapAction(){this.localePath=""}McxCreateOnlineMapAction.prototype.setLocalePath=function(a){this.localePath=a};McxCreateOnlineMapAction.prototype.execute=function(a){a=new McxOnlineMapDialog(a);a.setLocaleFolderPath(this.localePath);a.setDataSourceList(McxOnlineMapData.getData());a.showDialog(!1,!0)};
McxCreateOnlineMapAction.prototype.isInstanceOf=function(a){return"McxCreateOnlineMapAction"==a};js.builtin.McxMapping.Action.OnlineMapDialog.McxOnlineMapData={};function McxOnlineMapData(){}
McxOnlineMapData.__onlineMapData=[{text:"Google",value:McxTileLayerType.Google,selected:!0,description:"Normal Style of Google Map",imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/googleMap64.png"),group:"Google"},{text:"Google Hybrid",value:McxTileLayerType.GoogleHybrid,selected:!1,description:"Hybrid Style of Google Map",imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/googleMap64.png"),group:"Google"},{text:"Google Satellite",value:McxTileLayerType.GoogleSatellite,selected:!1,
description:"Satellite Style of Google Map",imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/googleMap64.png"),group:"Google"},{text:"Google Terrain",value:McxTileLayerType.GoogleTerrain,selected:!1,description:"Terrain Style of Google Map",imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/googleMap64.png"),group:"Google"},{text:"Yandex",value:McxTileLayerType.YandexMap,selected:!0,description:"Normal Style of Yandex Map",imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/yandex-icon-64.png"),
group:"Yandex"},{text:"Yandex Hybrid",value:McxTileLayerType.YandexHybridMap,selected:!1,description:"Hybrid Style of Yandex Map",imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/yandex-icon-64.png"),group:"Yandex"},{text:"Yandex Satellite",value:McxTileLayerType.YandexSatelliteMap,selected:!1,description:"Satellite Style of Yandex Map",imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/yandex-icon-64.png"),group:"Yandex"},{text:"Bing",value:McxTileLayerType.Bing,selected:!1,description:"Normal Style of Bing Map",
imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/bingMap64.jpg"),group:"Bing"},{text:"Bing Hybrid",value:McxTileLayerType.BingHybrid,selected:!1,description:"Terrain Style of Google Map",imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/bingMap64.jpg"),group:"Bing"},{text:"Bing Satellite",value:McxTileLayerType.BingSatellite,selected:!1,description:"Satellite Style of Bing Map",imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/bingMap64.jpg"),group:"Bing"},{text:"OpenStreet Map",
value:McxTileLayerType.OpenStreet,selected:!1,description:"Normal Style of OpenStreet Map",imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/openSeaMap64.png"),group:"Open Street"},{text:"OpenStreet Map Humanitarian",value:McxTileLayerType.Humanitarian,selected:!1,description:"Hybrid Style of OpenStreet Map",imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/openSeaMap64.png"),group:"Open Street"},{text:"OpenStreet Map Open Sea",value:McxTileLayerType.OpenSeaHybrid,selected:!1,description:"Hybrid Style of OpenStreet Map",
imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/openSeaMap64.png"),group:"Open Street"},{text:"OpenStreet Map Cycle",value:McxTileLayerType.OpenCycle,selected:!1,description:"Cycle Style of OpenStreet Map",imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/openSeaMap64.png"),group:"Open Street"},{text:"OpenStreet Map Cycle Landscape",value:McxTileLayerType.OpenCycleLandscape,selected:!1,description:"Cycle Landscape Style of OpenStreet Map",imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/openSeaMap64.png"),
group:"Open Street"},{text:"OpenStreet Map Transport",value:McxTileLayerType.OpenCycleTransport,selected:!1,description:"Transport Style of OpenStreet Map",imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/openSeaMap64.png"),group:"Open Street"},{text:"OpenStreet Map Quest Open",value:McxTileLayerType.OpenStreetQuestHybrid,selected:!1,description:"Quest Hybrid Style of OpenStreet Map",imageSrc:McxPathFinder.getFullPath("$McxMapping/assets/img/openSeaMap64.png"),group:"Open Street"}];
McxOnlineMapData.getData=function(){return McxOnlineMapData.__onlineMapData};js.builtin.McxMapping.Control={};js.builtin.McxMapping.Control.McxQuickFindControl={};function McxQuickFindControl(a,b){mcx.base(this);this.base=this;this._map=a;this._valueSelectBox=this._fieldSelectBox=this._layerSelectBox=null;this._layerExist=!1;this._valuesButton=this._nullButton=this._valueHintSpan=this._valueEditorSpan=this._valueTextBox=this._valueNumberBox=null;this._operator="=";this._isNull=!1;this._distinctValueDialog=null;this._interactionFactory=b;this._rootElement=$("<div/>")}
mcx.inherits(McxQuickFindControl,McxUserControl);McxQuickFindControl.prototype.initialize=function(){this.initializeUiControls()};
McxQuickFindControl.prototype.initializeUiControls=function(){this._fieldSelectBox=new McxSelectBox;this._layerSelectBox=new McxSelectBox;this._valueTextBox=new McxTextBox(McxTextBoxType.Text);var a=new McxLayoutRow;a.createAndAddSpan(12,new McxLabeledEditor(this.base.getLocaleValue("McxMapping-LayerComboLabel"),this._layerSelectBox,"McxMapping-LayerComboLabel",3));this._layerSelectBox.getOnSelectHandler().addListener(this.layerChanged,null,this);var b=new McxLayoutRow;b.createAndAddSpan(12,new McxLabeledEditor(this.base.getLocaleValue("McxMapping-FieldComboLabel"),
this._fieldSelectBox,"McxMapping-FieldComboLabel",3));this._fieldSelectBox.getOnSelectHandler().addListener(this.fieldChanged,null,this);var c=new McxLayoutRow;c.createAndAddSpan(3,new McxLabeledEditor(this.base.getLocaleValue("McxMapping-SearchTextLabel"),this._valueTextBox,"McxMapping-SearchTextLabel",12));var d=McxSettingsManager.read("QuickSearchQuery",null).getSettings()[0];""!=d&&this._valueTextBox.setValue(d);this._valueEditorSpan=new McxLayoutSpan(7);this._valueEditorSpan.setContent(this._valueTextBox);
c.addSpan(this._valueEditorSpan);this._nullButton=new McxButton;this._nullButton.setText("Null");this._nullButton.getClickHandler().addListener(this.nullButtonClicked,null,this);c.createAndAddSpan(1,this._nullButton);this._valuesButton=new McxButton;this._valuesButton.setText("?");this._valuesButton.getClickHandler().addListener(this.valuesButtonClicked,null,this);c.createAndAddSpan(1,this._valuesButton);this._valueHintSpan=$("<span/>");this._valueHintSpan.attr("data-localize","McxMapping-StringHint").html(this.base.getLocaleValue("McxMapping-StringHint"));
d=new McxLayoutRow;d.createAndAddSpan(3,"");d.createAndAddSpan(9,this._valueHintSpan);this._rootElement.append(a.getContent());this._rootElement.append(b.getContent());this._rootElement.append(c.getContent());this._rootElement.append(d.getContent());this.fillLayerList();McxLocalizationManager.localizeContent(this._rootElement,McxPathFinder.getFullPath("$McxMapping/Dialog/QuickFindDialog/assets/locale/quickFindDialog"))};
McxQuickFindControl.prototype.fillLayerList=function(){this._layerSelectBox.setTextGetter("getName");this._layerSelectBox.setValueGetter("getName");for(var a=[],b=this._map.getLayers(),c=McxSettingsManager.read("QuickSearchLayerName",null).getSettings()[0],d=0;d<b.getCount();d++){var e=b.getAt(d);e.isInstanceOf("IMcxSelectableLayer")&&""!=e.getDataSourceName()&&a.push(b.getAt(d));e.getName()==c&&(this._layerExist=!0)}this._layerSelectBox.addItemRange(a);this._layerExist&&""!=c&&this._layerSelectBox.setSelectedValue(c)};
McxQuickFindControl.prototype.layerChanged=function(){this._fieldSelectBox.clear();this._fieldSelectBox.setTextGetter("getFieldName");this._fieldSelectBox.setValueGetter("getFieldName");for(var a=this._layerSelectBox.getSelectedItem(),b=a.getSchema().getFieldCount(),c=[],d=0;d<b;d++){var e=a.getSchema().getField(d);e.isIgnored()||c.push(e)}this._fieldSelectBox.addItemRange(c);this._layerExist&&(a=McxSettingsManager.read("QuickSearchFieldName",null).getSettings()[0],""!=a&&this._fieldSelectBox.setSelectedValue(a))};
McxQuickFindControl.prototype.fieldChanged=function(){if(!this._isNull){var a=this._fieldSelectBox.getSelectedItem();this.removeValueEditor();a.getFieldType()==McxDataType.Int32||a.getFieldType()==McxDataType.Int64||a.getFieldType()==McxDataType.Int16?null==a.getDomainName()?this.createValueNumberBox(a):this.createValueDomainSelectBox(a):a.getFieldType()==McxDataType.Double||a.getFieldType()==McxDataType.Float?this.createValueNumberBox(a):a.getFieldType()==McxDataType.Boolean?this.createValueBooleanSelectBox(a):
(this.createValueTextBox(a),this._operator="like")}};McxQuickFindControl.prototype.removeValueEditor=function(){this._valueSelectBox=this._valueTextBox=this._valueNumberBox=null};McxQuickFindControl.prototype.createValueTextBox=function(a){this._valueTextBox=new McxTextBox(McxTextBoxType.Text);a=McxSettingsManager.read("QuickSearchQuery",null).getSettings()[0];""!=a&&this._valueTextBox.setValue(a);this._valueEditorSpan.setContent(this._valueTextBox)};
McxQuickFindControl.prototype.createValueNumberBox=function(a){a.getPrecision();this._valueNumberBox=new McxNumberBox(-9223372036854775808,0x7fffffffffffffff,10);this._valueEditorSpan.setContent(this._valueNumberBox);a=McxSettingsManager.read("QuickSearchQuery",null).getSettings()[0];""!=a&&this._valueNumberBox.setValue(parseFloat(a))};
McxQuickFindControl.prototype.createValueDomainSelectBox=function(a){this._valueSelectBox=new McxSelectBox;a=a.getDomainName();var b=this._layerSelectBox.getSelectedItem(),c=new McxAjaxParameter;c.setAsync(!1);b.getDataSourceName();if(a=b.getDataSource().getDomain(a,c))if(a=a.getDomain())a=a.getCodedValues(),this._valueSelectBox.setTextGetter("getValue"),this._valueSelectBox.setValueGetter("getCode"),this._valueSelectBox.addItemRange(a);this._valueEditorSpan.setContent(this._valueSelectBox);a=McxSettingsManager.read("QuickSearchQuery",
null).getSettings()[0];""!=a&&this._valueSelectBox.setSelectedValue(a)};McxQuickFindControl.prototype.createValueBooleanSelectBox=function(a){a=[];a.push(new McxCodedValue(0,McxLocalizationManager.getLocaleValue("McxMapping-False")));a.push(new McxCodedValue(1,McxLocalizationManager.getLocaleValue("McxMapping-True")));this._valueSelectBox=new McxSelectBox;this._valueSelectBox.setTextGetter("getValue");this._valueSelectBox.setValueGetter("getCode");this._valueSelectBox.addItemRange(a);this._valueEditorSpan.setContent(this._valueSelectBox)};
McxQuickFindControl.prototype.setValueEditorEnable=function(){this._isNull?(this.removeValueEditor(),this.createValueTextBox(null),this._valueTextBox.setValue("null"),this._valueTextBox.setIsEnabled(!1)):this.fieldChanged()};McxQuickFindControl.prototype.nullButtonClicked=function(){this._isNull=!this._isNull;this.setValueEditorEnable()};
McxQuickFindControl.prototype.findButtonClicked=function(){var a=this._layerSelectBox.getSelectedItem(),b=this._fieldSelectBox.getSelectedItem(),c="",d="";null!=this._valueNumberBox?d=c=this._valueNumberBox.getValue().toString():null!=this._valueSelectBox?d=c=this._valueSelectBox.getSelectedItem().getCode():(c="'"+this._valueTextBox.getValue()+"'",d=c.split("'").join(""));McxSettingsManager.write("QuickSearchFieldName",this._fieldSelectBox.getSelectedValue().toString(),null);McxSettingsManager.write("QuickSearchLayerName",
this._layerSelectBox.getSelectedValue().toString(),null);McxSettingsManager.write("QuickSearchQuery",d,null);McxSelectionHelper.instance.getGridShowCount();var e=new McxFilter,b=b.getFieldName()+" "+this._operator+" "+c;e.setAttributeFilter(b);b=new McxAjaxParameter;b.setAsync(!0);b.setParameters(this,function(a){a=a.getLayers()[0];a.getFilterCollection().add(e);a=new McxFeatureGridWrapper(this._map,a,this._interactionFactory);var b=McxButtonAuthorityHelper.instance.getButtonVisibility(McxButtonAuthorityType.FeatureGridSaveAndDeleteButton);
a.setEditable(b);a.setToolbar(!0,!0,!1,b,b);a.initialize();(new McxFeatureGridWrapperDialog(a)).showDialog()},function(){});a.getDataSource().getLayer(a.getName(),b,!0)};
McxQuickFindControl.prototype.valuesButtonClicked=function(){if(!this._isNull){var a=this._layerSelectBox.getSelectedItem(),b=this._fieldSelectBox.getSelectedItem();this._distinctValueDialog=new McxFindDistinctValueDialog(a,b);this._distinctValueDialog.getOkButtonClickHandler().addListener(this.findValueDialogOkButtonClicked,null,this);this._distinctValueDialog.showDialog(!0,!0)}};
McxQuickFindControl.prototype.findValueDialogOkButtonClicked=function(){var a=this._distinctValueDialog.getSelectedValue();null!=this._valueTextBox?this._valueTextBox.setValue(a):null!=this._valueNumberBox&&this._valueNumberBox.setValue(parseFloat(a))};McxQuickFindControl.prototype.getContent=function(){return this._rootElement};js.builtin.McxMapping.Controller={};js.builtin.McxMapping.Controller.McxCreateBookmarkController={};function McxCreateBookmarkController(){mcx.base(this);this.base=this;this._bookMarkCreatedEventHandler=new McxEventHandler;this._interactionEndEventHandler=new McxEventHandler;this._dialog=new McxBookmarkEditDialog;this.initialize()}mcx.inherits(McxCreateBookmarkController,McxController);
McxCreateBookmarkController.prototype.initialize=function(){this._dialog.onCloseDialog().addListener(function(){this.base.map.getInputHandler().setController(null)},null,this);this._dialog.getSubmitHandler().addListener(function(a){this._dialog.getBookmark().getTitle()&&this._dialog.getBookmark().getLattitude()&&this._dialog.getBookmark().getLongitude()?this.onBookmarkCreated().dispatchOnSuccess(this,new McxEventArgs(this._dialog.getBookmark())):(a.setIsValidated(!1),McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("McxMapping-BookmarkRequiredFields"),
McxMessageBoxType.Warning))},null,this);this._dialog.getCloseButtonClickHandler().addListener(function(){this.base.setCursor(McxCursors.Default);this.onBookmarkCreated().dispatchOnSuccess(this,null)},null,this)};McxCreateBookmarkController.prototype.onBookmarkCreated=function(){return this._bookMarkCreatedEventHandler};McxCreateBookmarkController.prototype.onStartInteraction=function(){McxCreateBookmarkController.superClass_.onStartInteraction.call(this);this.base.setCursor(McxCursors.pointer)};
McxCreateBookmarkController.prototype.onEndInteraction=function(){this.base.setCursor(McxCursors.Default);this._dialog.getIsShown()&&this._dialog.close();this.getInteractionEndEventHandler().dispatchOnSuccess(this,null)};McxCreateBookmarkController.prototype.getInteractionEndEventHandler=function(){return this._interactionEndEventHandler};McxCreateBookmarkController.prototype.drawingCompleted=function(a){};
McxCreateBookmarkController.prototype.onMouseDown=function(a){if("left"==a.getButton()){var b=this.map.viewToWorld(a.getX(),a.getY());b.setCoordinateSystem(this.base.map.getCoordinateSystem());McxCreateBookmarkController.superClass_.onMouseDown.call(this,a);mcx.isDefAndNotNull(this._dialog)&&(a=b.transformTo(new McxCoordinateSystem(4326)),b=new McxBookMark,b.setLattitude(a.getX()),b.setLongitude(a.getY()),this._dialog.setBookmark(b),this._dialog.showDialog(!1,!1))}};js.builtin.McxMapping.Controller.McxExportMapController={};function McxExportMapController(a){mcx.base(this,a);this.base=this;this._drawinFinishedEventHandler=new McxEventHandler;this.canDraw=!0}mcx.inherits(McxExportMapController,McxPaintPolygonController);McxExportMapController.prototype.onCoordinateCreated=function(a,b){this.canDraw&&(this.base.points.push(b),McxExportMapController.superClass_.onCoordinateCreated.call(this,a,b))};
McxExportMapController.prototype.setDraw=function(a){this.canDraw=a};js.builtin.McxMapping.Controller.McxPanController={};
function McxPanController(){mcx.base(this);this.fromPoint=McxFactoryFinder.GeometryFactory(null).createPoint(0,0);this.toPoint=McxFactoryFinder.GeometryFactory(null).createPoint(0,0);this.lastMove=McxFactoryFinder.GeometryFactory(null).createPoint(0,0);this.started=!1;this.oldWorld=null;this.beforeLastPoint=McxFactoryFinder.GeometryFactory(null).createPoint(0,0);this.lastPoint=McxFactoryFinder.GeometryFactory(null).createPoint(0,0);this.symbolizer=new McxLineSymbolizer;this.base=this;this.firstPass=
!0;this.totalTime=this.totalY=this.totalX=this.velocity=0;this.isStop=!0}mcx.inherits(McxPanController,McxController);McxPanController.prototype.onStartInteraction=function(){this.base.setCursor(McxCursors.openHand);this.base.setDescription("McxMapping-PanController");this.symbolizer=new McxLineSymbolizer;this.symbolizer.setStroke(new McxStroke)};McxPanController.prototype.onEndInteraction=function(){this.base.map.getRenderer().paintNonLayer();this.base.setCursor(McxCursors.Default)};
McxPanController.prototype.paint=function(a){};McxPanController.prototype.onMouseClick=function(a){};McxPanController.prototype.onMouseWheel=function(a){};McxPanController.prototype.onMouseMove=function(a){if("left"==a.getButton()||"middle"==a.getButton())this.onPanning(a.getX(),a.getY())};McxPanController.prototype.onMouseUp=function(a){if("left"==a.getButton()||"middle"==a.getButton())this.onPanFinish(a.getX(),a.getY())};
McxPanController.prototype.onMouseDown=function(a){if("left"==a.getButton()||"middle"==a.getButton())this.onPanStart(a.getX(),a.getY())};McxPanController.prototype.onKeyUp=function(a){};McxPanController.prototype.onKeyDown=function(a){};McxPanController.prototype.onTap=function(a){a.getDeltaTime()};McxPanController.prototype.onDragStart=function(a){this.onPanStart(a.getX(),a.getY())};McxPanController.prototype.onDragEnd=function(a){this.onPanFinish(a.getX(),a.getY())};
McxPanController.prototype.onDrag=function(a){var b=this.toPoint.x-a.getX(),c=this.toPoint.y-a.getY();if(!(1>=Math.abs(b)&&1>=Math.abs(c)))this.onPanning(a.getX(),a.getY())};McxPanController.prototype.isInstanceOf=function(a){return McxPanController.superClass_.isInstanceOf.call(this,a)||"McxPanController"==a};
McxPanController.prototype.onPanStart=function(a,b){this.base.setCursor(McxCursors.closeHand);var c=McxFactoryFinder.GeometryFactory(null),d=c.createPoint(a,b);this.fromPoint=c.createPoint(d.x,d.y);this.toPoint=c.createPoint(d.x,d.y);this.started=!0;this.lastPoint=c.createPoint(d.x,d.y);this.initialWorld=this.map.getWorld().clone()};
McxPanController.prototype.onPanning=function(a,b){if(this.started){this.toPoint=new McxPoint(a,b,null);var c=this.toPoint.x-this.lastPoint.x,d=this.toPoint.y-this.lastPoint.y;if(0!=c||0!=d)this.totalTime=Date.now(),this.base.map.getRenderer().translate(-1*c*this.map.getPixelScale(),d*this.map.getPixelScale(),!1),this.beforeLastPoint=this.lastPoint,this.lastPoint=new McxPoint(a,b,null),this.base.map.getRenderer().paintNonLayer()}};
McxPanController.prototype.onPanFinish=function(a,b){if(this.started){var c=McxFactoryFinder.GeometryFactory(null).createPoint(a,b);if(c.equals(this.fromPoint))this.started=!1,this.base.setCursor(McxCursors.openHand);else{this.toPoint=c;var c=this.toPoint.x-this.beforeLastPoint.x,d=this.toPoint.y-this.beforeLastPoint.y,e=Date.now()-this.totalTime;if(this.base.map.getRenderer().isAnimationActive()&&(0!=c||0!=d)&&0!=e){0!=c&&(c+=c/Math.abs(c)*this.base.map.getDisplay().getWidth()*Math.abs(c)*.009/e);
0!=d&&(d+=d/Math.abs(d)*this.base.map.getDisplay().getHeight()*Math.abs(d)*.009/e);for(e=0;10>e;e++)this.base.map.getRenderer().translate(-1*c/10*this.map.getPixelScale(),d/10*this.map.getPixelScale(),!0);this.toPoint=new McxPoint(a+c,b+d,null)}var c=this.map.viewToWorld(this.fromPoint.x,this.fromPoint.y),d=this.map.viewToWorld(this.toPoint.x,this.toPoint.y),f=McxFactoryFinder.GeometryFactory(null).createPoint(c.x-d.x,c.y-d.y);if(!isNaN(f.x)&&!isNaN(f.y)){c=this.initialWorld;0>f.x?(d=c.left+f.x,e=
c.left-f.x):(d=c.right-f.x,e=c.right+f.x);if(0>f.y)var g=c.bottom+f.y,h=c.bottom-f.y;else g=c.top-f.y,h=c.top+f.y;var f=[],k=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem());f.push(k.createBounds(d,g,e,h));f.push(k.createBounds(d,c.bottom,e,c.top));f.push(k.createBounds(c.left,g,c.right,h));this.base.setCursor(McxCursors.openHand);this.started=!1;c=this.base.map.getWorld();new McxZoomUndo(this.base.map,this.initialWorld,c);this.base.map.getRenderer().paintLayer(null,f,!0);this.base.map.getRenderer().getRendererEndEventHandler().dispatchOnSuccess(this,
null)}}}};js.builtin.McxMapping.Controller.McxRectangleController={};function McxRectangleController(a){mcx.base(this);this.symbolizer=a;this.endCoordinate=null;this.started=!1;this.initialize();this.base=this}mcx.inherits(McxRectangleController,McxSnappableController);
McxRectangleController.prototype.initialize=function(){if(null==this.symbolizer){var a=new McxFill;a.setColor("blue");a.setOpacity(.2);var b=new McxStroke;b.setColor("blue");this.symbolizer=McxFactoryFinder.StyleFactory().createPolygonSymbolizerWithStrokeAndFill(b,a)}};McxRectangleController.prototype.onStartInteraction=function(){McxRectangleController.superClass_.onStartInteraction.call(this);this.base.setCursor.call(this,McxCursors.crossHair);this.base.setDescription.call(this,"McxMapping-PaintRectangleController")};
McxRectangleController.prototype.onEndInteraction=function(){this.base.setCursor.call(this,McxCursors.Default);this.base.map.getRenderer().paintNonLayer()};
McxRectangleController.prototype.onCoordinateCreated=function(a,b){null==this.base.startCoordinate?(this.base.startCoordinate=b,this.started=!0):(this.endCoordinate=b,this.drawingCompleted(this.base.startCoordinate,this.endCoordinate),this.started=!1,this.endCoordinate=this.base.startCoordinate=null,McxRectangleController.superClass_.onCoordinateCreated.call(this,a,b))};McxRectangleController.prototype.onMouseClick=function(a){};McxRectangleController.prototype.onMouseUp=function(a){};
McxRectangleController.prototype.onMouseWheel=function(a){};McxRectangleController.prototype.onKeyUp=function(a){};McxRectangleController.prototype.onKeyDown=function(a){};McxRectangleController.prototype.onKeyPress=function(a){};McxRectangleController.prototype.drawingCompleted=function(a,b){};
McxRectangleController.prototype.paint=function(a){McxRectangleController.superClass_.paint.call(this,a);null!=this.base.map&&this.started&&null!=this.base.startCoordinate&&null!=this.cursorPosition&&a.getGeodeticGraphics().drawRectangle(this.base.startCoordinate,this.cursorPosition,this.symbolizer,1)};McxRectangleController.prototype.reset=function(){this.endCoordinate=this.base.startCoordinate=null;this.started=!1};
McxRectangleController.prototype.isInstanceOf=function(a){return McxRectangleController.superClass_.isInstanceOf.call(this,a)||"McxRectangleController"==a};js.builtin.McxMapping.Controller.McxPrintRectangleController={};function McxPrintRectangleController(a){mcx.base(this,null);this.useSnap(!1);this.base=this;this._dialog=a}mcx.inherits(McxPrintRectangleController,McxRectangleController);
McxPrintRectangleController.prototype.drawingCompleted=function(a,b){var c=a.getX(),d=a.getY(),e=b.getX(),f=b.getY(),g=Math.min(c,e),h=Math.min(d,f),c=Math.max(c,e),d=Math.max(d,f),g=new McxBounds(g,h,c,d,this.base.map.getCoordinateSystem()),d=this.base.map.worldToView(a.getX(),a.getY()),f=this.base.map.worldToView(b.getX(),b.getY()),h=Math.abs(d.getX()-f.getX()),d=Math.abs(d.getY()-f.getY()),g=new McxEventArgs({size:{width:h,height:d},bounds:g});this._dialog.preview(g)};js.builtin.McxMapping.Controller.McxZoomToCursorController={};function McxZoomToCursorController(){mcx.base(this);this.alertTimerId=0;this.data=null;this.scaleLevel=1;this.base=this}mcx.inherits(McxZoomToCursorController,McxController);McxZoomToCursorController.prototype.paint=function(a){};McxZoomToCursorController.prototype.onMouseClick=function(a){};
McxZoomToCursorController.prototype.onMouseWheel=function(a){if(null!=this.base.map){var b=a.getWheelDelta()/3;a=this.base.map.viewToWorld(a.getX(),a.getY());this.base.map.getRenderer().zoomTo(b,a.x,a.y)}};McxZoomToCursorController.prototype.onMouseMove=function(a){};McxZoomToCursorController.prototype.onMouseUp=function(a){};McxZoomToCursorController.prototype.onMouseDown=function(a){};
McxZoomToCursorController.prototype.isInstanceOf=function(a){return McxZoomToCursorController.superClass_.isInstanceOf.call(this,a)||"McxZoomToCursorController"==a};js.builtin.McxMapping.Controller.McxZoomWindowController={};function McxZoomWindowController(){mcx.base(this,null);this.useSnap(!1);this.base=this}mcx.inherits(McxZoomWindowController,McxRectangleController);McxZoomWindowController.prototype.onStartInteraction=function(){McxZoomWindowController.superClass_.onStartInteraction.call(this);this.base.setCursor(McxCursors.zoomWindow);this.base.setDescription("McxMapping-ZoomWindowController")};
McxZoomWindowController.prototype.onMouseUp=function(a){"left"==a.getButton()&&null!=this.base.map&&null!=this.base.startCoordinate&&(this.base.map.getWorld(),a=this.base.map.viewToWorld(a.getX(),a.getY()),a.equals(this.base.startCoordinate)||(this.base.map.setWorld(Math.min(this.base.startCoordinate.getX(),a.getX()),Math.min(this.base.startCoordinate.getY(),a.getY()),Math.max(this.base.startCoordinate.getX(),a.getX()),Math.max(this.base.startCoordinate.getY(),a.getY())),this.reset(),this.base.map.getWorld(),
this.base.map.getRenderer().paintLayer(null,null)))};js.builtin.McxMapping.Dialog={};js.builtin.McxMapping.Dialog.BookmarkEditDialog={};js.builtin.McxMapping.Dialog.BookmarkEditDialog.McxBookMark={};function McxBookMark(){this._lattitude=this._longitude=NaN;this._title=this._description="";this._featureBalloon=new McxFeatureBalloon}McxBookMark.prototype.setLongitude=function(a){this._longitude=a};McxBookMark.prototype.setLattitude=function(a){this._lattitude=a};McxBookMark.prototype.setDescription=function(a){this._description=a};
McxBookMark.prototype.setTitle=function(a){this._title=a};McxBookMark.prototype.getLongitude=function(){return this._longitude};McxBookMark.prototype.getLattitude=function(){return this._lattitude};McxBookMark.prototype.getDescription=function(){return this._description};McxBookMark.prototype.getTitle=function(){return this._title};
McxBookMark.prototype.getFeatureBalloon=function(){this._featureBalloon.setTitle(this.getTitle());this._featureBalloon.setContent($("<div/>").html(this.getDescription()).css("max-width","250px").css("white-space","normal").css("word-wrap","break-word").addClass(""));return this._featureBalloon};js.builtin.McxMapping.Dialog.BookmarkEditDialog.McxBookmarkEditDialog={};function McxBookmarkEditDialog(){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._lattitudeEditor=new McxNumberBox(0,Number.MAX_VALUE,8);this._longitudeEditor=new McxNumberBox(0,Number.MAX_VALUE,8);this._bookmark=new McxBookMark;this._titleEditor=new McxTextBox(McxTextBoxType.Text);this._descriptionEditor=new McxTextArea}mcx.inherits(McxBookmarkEditDialog,McxDialogBase);
McxBookmarkEditDialog.prototype.initialize=function(){var a=new McxLayoutRow;a.createAndAddSpan(6,new McxLabeledEditor("Latitude",this._lattitudeEditor,"McxMapping-BookmarkLatitude",4));a.createAndAddSpan(6,new McxLabeledEditor("Longtitude",this._longitudeEditor,"McxMapping-BookmarkLongtitude",4));this.base.addChild(this._rootElement,new McxLabeledEditor("Title",this._titleEditor,"McxMapping-BookmarkTitle",2));this.base.addChild(this._rootElement,a);this.base.addChild(this._rootElement,new McxLabeledEditor("Description",
this._descriptionEditor,"McxMapping-BookmarkDescription",2));this._rootElement.keypress(function(a){a.stopPropagation()})};McxBookmarkEditDialog.prototype.setBookmark=function(a){if(a){this._bookmark=a;var b=a.getLattitude(),c=a.getLongitude(),d=a.getTitle();a=a.getDescription();b&&this._lattitudeEditor.setValue(b);c&&this._longitudeEditor.setValue(c);d&&this._titleEditor.setValue(d);a&&this._descriptionEditor.setValue(a)}};
McxBookmarkEditDialog.prototype.getBookmark=function(){this._bookmark=this._bookmark||new McxBookMark;this._bookmark.setLattitude(this._lattitudeEditor.getValue());this._bookmark.setLongitude(this._longitudeEditor.getValue());this._bookmark.setTitle(this._titleEditor.getValue());this._bookmark.setDescription(this._descriptionEditor.getValue());return this._bookmark};McxBookmarkEditDialog.prototype.getDialogTitle=function(){return"McxMapping-BookmarkDialog"};
McxBookmarkEditDialog.prototype.getLocalizationPath=function(){return"$McxMapping/assets/locale/mcxMapping"};McxBookmarkEditDialog.prototype.getContent=function(){return this._rootElement};js.builtin.McxMapping.Dialog.BookmarkEditDialog.McxBookmarkManagementDialog={};function McxBookmarkManagementDialog(a,b){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._bookMarkItemContainer=$("<div/>");this._addBookmarkButton=new McxButton;this._noBookmarkLabel=new McxLabelControl;this._markerGuid=a;this._map=b}mcx.inherits(McxBookmarkManagementDialog,McxDialogBase);
McxBookmarkManagementDialog.prototype.initialize=function(){this._addBookmarkButton.setText("Add BookMark");this._addBookmarkButton.setLocalizationKey("McxMapping-BookmarkDialogAddBookmark");this._addBookmarkButton.setImage("$McxMapping/assets/img/add-bookmark-white-16.png");this.base.addFooterButton(this._addBookmarkButton);this._noBookmarkLabel.setText("You have no bookmarks yet.");this._noBookmarkLabel.setLocalizationKey("McxMapping-NoBookmarks");this._noBookmarkLabel.css("text-align","center");
this._rootElement.append(this._bookMarkItemContainer);this.base.addChild(this._rootElement,this._noBookmarkLabel);this.bindEvents()};McxBookmarkManagementDialog.prototype.bindEvents=function(){var a=this;this._addBookmarkButton.getClickHandler().addListener(function(){this.base.minimize();var b=new McxCreateBookmarkAction(this._markerGuid);b.onBookmarkCreated().addListener(function(b){b&&(b=b.getArgs())&&a.addBookMarkUiItem(b);this.show()},null,this);this._map.getInputHandler().execute(b)},null,this)};
McxBookmarkManagementDialog.prototype.getDialogButtons=function(){return McxDialogButtons.none};McxBookmarkManagementDialog.prototype.setBookmarks=function(a){this.generateBookmarkUiItems(a)};McxBookmarkManagementDialog.prototype.getBookmarks=function(){for(var a=this.base.getChildrenOfType(McxDisplayItemView),b=[],c=0;c<a.length;c++){var d=a[c].getItem();0!=mcx.isInstanceOf(d,McxBookMark)&&d&&(b[b.length]=d)}return b};
McxBookmarkManagementDialog.prototype.createUiItemFromBookmark=function(a){var b=this,c=new McxDisplayItemView;c.setTitle(a.getTitle());c.setItem(a);a=new McxButton;a.setText("Remove");a.setLocalizationKey("McxMapping-RemoveBookmark");a.getClickHandler().addListener(function(){var a=this.getItem(),a=new McxCloseBookmarkAction(a,b._markerGuid);b._map.getInputHandler().execute(a);this.remove()},null,c);a.css("margin","0");a.setButtonState(McxButtonState.error);var d=new McxButton;d.setText("Go to");
d.setLocalizationKey("McxMapping-GoToBookmark");d.getClickHandler().addListener(function(){b.goToBookmark(b._map,c)},null,this);var e=new McxButton;e.setText("Edit");e.setLocalizationKey("McxMapping-EditBookmark");e.getClickHandler().addListener(function(){var a=this.getItem(),c=new McxEditBookmarkAction(a,b._markerGuid);c.onBookmarkEdited().addListener(function(){this.setTitle(a.getTitle())},null,this);b._map.getInputHandler().execute(c)},null,c);c.addToolButton(e);c.addToolButton(d);c.addToolButton(a);
McxLocalizationManager.localizeContent(c.getContent());this.base.addChild(this._bookMarkItemContainer,c)};McxBookmarkManagementDialog.prototype.addBookMarkUiItem=function(a){if(!a)return null;this._noBookmarkLabel.hide();var b=new McxAddBookmarkAction(a,this._markerGuid);this._map.getInputHandler().execute(b);this.createUiItemFromBookmark(a)};
McxBookmarkManagementDialog.prototype.goToBookmark=function(a,b){var c=b.getItem(),c=new McxPoint(c.getLattitude(),c.getLongitude(),new McxCoordinateSystem(4326)),c=new McxZoomBoundsAction([c.getBounds()]);c.setRatio(.1);a.getInputHandler().execute(c)};McxBookmarkManagementDialog.prototype.generateBookmarkUiItems=function(a){this._bookMarkItemContainer.empty();for(var b=0;b<a.length;b++)this.addBookMarkUiItem(a[b])};McxBookmarkManagementDialog.prototype.getDialogTitle=function(){return"McxMapping-BookmarksDialog"};
McxBookmarkManagementDialog.prototype.getLocalizationPath=function(){return"$McxMapping/assets/locale/mcxMapping"};McxBookmarkManagementDialog.prototype.getContent=function(){return this._rootElement};McxBookmarkManagementDialog.prototype.getDialogMaxHeight=function(){return 400};McxBookmarkManagementDialog.prototype.getMarkerGuid=function(){return this._markerGuid};js.builtin.McxMapping.Dialog.ExportMapDialog={};js.builtin.McxMapping.Dialog.ExportMapDialog.McxExportMapDialog={};function McxExportMapDialog(a){mcx.base(this,a);this.base=this;this._driverFilterCombo=new McxSelectBox;this._exportMapController=this.symbolizer=null;this._rootElement=$("<div/>");this._exportButton=this._polygon=this._layerListBox=this._map=null}mcx.inherits(McxExportMapDialog,McxDataSourceListDialog);
McxExportMapDialog.prototype.creationComplete=function(){var a=new McxFill;a.setColor("blue");a.setOpacity(.2);var b=new McxStroke;b.setColor("blue");this.symbolizer=McxFactoryFinder.StyleFactory().createPolygonSymbolizerWithStrokeAndFill(b,a);this._driverFilterCombo.setTextGetter("text");this._driverFilterCombo.setValueGetter("value");this._driverFilterCombo.addItemRange(driverFilterObject);this._driverFilterCombo.setValue("26c9c3d8-5d06-460c-8694-e2ca4664bba6");a=new McxButton;a.setButtonSize(McxButtonSize.small);
a.setButtonState(McxButtonState.active);a.setIsFullWidth(!1);a.getContent().attr("title",this.base.getLocaleValue("McxMapping-ExportMapDialogSelectAreaButtonLabel"));a.getContent().attr("data-localize","McxMapping-ExportMapDialogSelectAreaButtonLabel");a.getContent().attr("data-localize-for","title");a.setImage("$McxMapping/Dialog/ExportMapDialog/assets/img/selectonlayer32.png");a.getClickHandler().addListener(function(){this.startExportMapController()},null,this);this._exportButton=new McxButton;
this._exportButton.setButtonSize(McxButtonSize.medium);this._exportButton.setButtonState(McxButtonState.disabled);this._exportButton.setIsFullWidth(!1);this._exportButton.setImage("$McxMapping/Dialog/ExportMapDialog/assets/img/export16.png");this._exportButton.getContent().attr("title",this.base.getLocaleValue("McxMapping-ExportMapDialogExportButtonLabel"));this._exportButton.getContent().attr("data-localize","McxMapping-ExportMapDialogExportButtonLabel");this._exportButton.getContent().attr("data-localize-for",
"title");this._exportButton.getClickHandler().addListener(this.onExportButtonClick,null,this);for(var b=this._map.getLayers().toLayerArray(),c=[],d=0;d<b.length;d++)b[d].isInstanceOf("McxFsLayer")&&c.push(b[d]);this._layerListBox=new McxLayerListUserControl(c);c=new McxLayoutRow;b=new McxLabeledEditor("Layers",this._layerListBox);b.setLabelLocalizationKey("McxMapping-ExportMapLayerLayers");c.createAndAddSpan(12,b);c=new McxLayoutRow;d=new McxLabeledEditor("Result Type",this._driverFilterCombo);d.setLabelLocalizationKey("McxMapping-ExportMapLayerResultType");
c.createAndAddSpan(12,d);this.base.addChild(this._rootElement,b);this.base.addChild(this._rootElement,d);this.base.getFooterElement().empty();this.base.addFooterButton(a);this.base.addFooterButton(this._exportButton)};
McxExportMapDialog.prototype.startExportMapController=function(){null!=this._map&&(0==this._layerListBox.getSelectedLayers().length?(McxMessageBox.show("",this.base.getLocaleValue("McxMapping-ExportMapLayerSelectAlert"),McxMessageBoxType.Error,McxDialogButtons.ok),this._map.getInputHandler().setController(null)):(this._exportMapController=new McxExportMapController(this.symbolizer),this._exportMapController.getDrawingCompletedEventHandler().addListener(this.getDrawingCompletedPolygon,null,this),this._map.getInputHandler().setController(this._exportMapController)))};
McxExportMapDialog.prototype.setActiveMap=function(a){this._map=a};McxExportMapDialog.prototype.getDrawingCompletedPolygon=function(a){this._polygon=a.getGeometry();this._exportButton.setButtonState(McxButtonState.active);this._map.getInputHandler().setController(null)};McxExportMapDialog.prototype.getContent=function(){return this._rootElement};McxExportMapDialog.prototype.getLocalizationPath=function(){return"$McxMapping/assets/locale/mcxMapping"};McxExportMapDialog.prototype.getDialogButtons=function(){return McxDialogButtons.none};
McxExportMapDialog.prototype.onExportButtonClick=function(){var a=this._layerListBox.getSelectedLayers(),b=this._driverFilterCombo.getSelectedValue(),c=a[0].getDataSource().getSource();McxLoadingIndicator.setAsBusy(this.getContent(),!0).setText(this.base.getLocaleValue("McxMapping-ExportMapLayerWaitMessage"));if(0==a.length)McxMessageBox.show("",this.base.getLocaleValue("McxMapping-ExportMapLayerSelectAlert"),McxMessageBoxType.Error,McxDialogButtons.ok),this._map.getInputHandler().setController(null);
else{for(var d=0;d<a.length;d++)if(c!=a[d].getDataSource().getSource()){McxMessageBox.show("",this.base.getLocaleValue("McxMapping-ExportMapLayerSelectSameDataSourcesLayer"),McxMessageBoxType.Error,McxDialogButtons.ok);this._map.getInputHandler().setController(null);return}var d=c.split("@")[4],e=new McxFilter;e.setSpatialRelation(McxSpatialRelation.Intersects);c=new McxAjaxParameter;c.setParameters(this,function(){McxLoadingIndicator.setAsIdle(this.getContent())},function(){McxMessageBox.show("",
this.base.getLocaleValue("McxMapping-ExportMapFailMessage"),McxMessageBoxType.Error);McxLoadingIndicator.setAsIdle(this.getContent())});a=new McxExportMapAction(d,a,b?b.toString():"",e,[this._polygon]);a.setAjaxParameter(c);a.execute(this._map)}};McxExportMapDialog.prototype.getDialogTitle=function(){return"McxMapping-ExportMapDialogTitle"};js.builtin.McxMapping.Dialog.FindDistinctValueDialog={};js.builtin.McxMapping.Dialog.FindDistinctValueDialog.McxFindDistinctValueDialog={};function McxFindDistinctValueDialog(a,b){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._control=null;this._layer=a;this._field=b;this._dialogCloseHander=new McxEventHandler}mcx.inherits(McxFindDistinctValueDialog,McxDialogBase);McxFindDistinctValueDialog.prototype.getIsSingleInstance=function(){return!0};
McxFindDistinctValueDialog.prototype.initialize=function(){this.initializeUiControls()};
McxFindDistinctValueDialog.prototype.initializeUiControls=function(){var a=McxSettingsManager.read("SelectionSettings",null).getSettings(),b=400;0<a.length&&(b=JSON.parse(a[0]).MaximumSelectionCount);this._control=new McxAttributeValueSelectEditor;this._control.setMaximumListCount(parseInt(b,0));this._control.setLayerField(this._layer,this._field);this._control.getOnAbortButtonClick().addListener(this.base.close,null,this);this.base.addChild(this._rootElement,this._control)};
McxFindDistinctValueDialog.prototype.onClose=function(){this._dialogCloseHander.dispatchOnSuccess(null,null)};McxFindDistinctValueDialog.prototype.getDialogTitle=function(){return McxLocalizationManager.getLocaleValue("McxMapping-FindDistinctValueDialogTitle")};McxFindDistinctValueDialog.prototype.getLocalizationPath=function(){return"$McxMapping/Dialog/FindDistinctValueDialog/assets/locale/findDistinctValueDialog"};McxFindDistinctValueDialog.prototype.getDialogImageUrl=function(){return"$McxCommonDialog/assets/img/defaultDialogImage16.png"};
McxFindDistinctValueDialog.prototype.creationComplete=function(){};McxFindDistinctValueDialog.prototype.getContent=function(){return this._rootElement};McxFindDistinctValueDialog.prototype.getDialogCloseHandler=function(){return this._dialogCloseHander};McxFindDistinctValueDialog.prototype.getSelectedValue=function(){return this._control.getValue()};js.builtin.McxMapping.Dialog.Mcx3dHeightDialog={};js.builtin.McxMapping.Dialog.Mcx3dHeightDialog.Mcx3dHeightDialog={};function Mcx3dHeightDialog(a){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._map=a;this._fieldSelectBox=this._layerSelectBox=null}mcx.inherits(Mcx3dHeightDialog,McxDialogBase);Mcx3dHeightDialog.prototype.getIsSingleInstance=function(){return!0};Mcx3dHeightDialog.prototype.initialize=function(){this.initializeUiControls()};Mcx3dHeightDialog.prototype.onClose=function(){};
Mcx3dHeightDialog.prototype.getDialogSize=function(){return McxDialogSize.medium};Mcx3dHeightDialog.prototype.getDialogTitle=function(){return"McxMapping-HeightDialogTitle"};Mcx3dHeightDialog.prototype.getLocalizationPath=function(){return"$McxMapping/assets/locale/mcxMapping"};Mcx3dHeightDialog.prototype.creationComplete=function(){this.fillLayerList()};Mcx3dHeightDialog.prototype.getContent=function(){return this._rootElement};
Mcx3dHeightDialog.prototype.initializeUiControls=function(){var a=new McxLayoutRow,b=a.createAndAddSpan(3,"");b.getContent().attr("data-localize","McxMapping-Layers");this._layerSelectBox=new McxSelectBox;a.createAndAddSpan(9,this._layerSelectBox);this._layerSelectBox.getOnSelectHandler().addListener(this.layerChanged,null,this);var c=new McxLayoutRow,b=c.createAndAddSpan(3,"");b.getContent().attr("data-localize","McxMapping-Fields");this._fieldSelectBox=new McxSelectBox;c.createAndAddSpan(9,this._fieldSelectBox);
this._rootElement.append(a.getContent());this._rootElement.append(c.getContent())};
Mcx3dHeightDialog.prototype.fillLayerList=function(){this._layerSelectBox.setTextGetter("getName");this._layerSelectBox.setValueGetter("getName");for(var a=[],b=this._map.getLayers(),c=McxSettingsManager.read("QuickSearchLayerName",null).getSettings()[0],d=0;d<b.getCount();d++){var e=b.getAt(d);e.isInstanceOf("IMcxSelectableLayer")&&a.push(b.getAt(d));e.getName()==c&&(this._layerExist=!0)}this._layerSelectBox.addItemRange(a);this._layerExist&&""!=c&&this._layerSelectBox.setSelectedValue(c)};
Mcx3dHeightDialog.prototype.layerChanged=function(){this._fieldSelectBox.clear();this._fieldSelectBox.setTextGetter("getFieldName");this._fieldSelectBox.setValueGetter("getFieldName");for(var a=this._layerSelectBox.getSelectedItem(),b=a.getSchema().getFieldCount(),c=[],d=0;d<b;d++){var e=a.getSchema().getField(d);e.isIgnored()||c.push(e)}this._fieldSelectBox.addItemRange(c);this._layerExist&&(a=McxSettingsManager.read("QuickSearchFieldName",null).getSettings()[0],""!=a&&this._fieldSelectBox.setSelectedValue(a))};
Mcx3dHeightDialog.prototype.removeValueEditor=function(){this._valueSelectBox=this._valueTextBox=this._valueNumberBox=null};Mcx3dHeightDialog.prototype.getHeightFieldName=function(){return this._fieldSelectBox.getSelectedValue().toString()};js.builtin.McxMapping.Dialog.McxColorSelectDialog={};js.builtin.McxMapping.Dialog.McxColorSelectDialog.McxColorSelectDialog={};function McxColorSelectDialog(a){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._color=a;this._colorPicker=new McxColorPicker}mcx.inherits(McxColorSelectDialog,McxDialogBase);McxColorSelectDialog.prototype.getIsSingleInstance=function(){return!0};McxColorSelectDialog.prototype.initialize=function(){this.initializeUiControls()};
McxColorSelectDialog.prototype.onClose=function(){};McxColorSelectDialog.prototype.getDialogSize=function(){return McxDialogSize.medium};McxColorSelectDialog.prototype.getDialogTitle=function(){return"McxMapping-HeightDialogTitle"};McxColorSelectDialog.prototype.getLocalizationPath=function(){return"$McxMapping/assets/locale/mcxMapping"};McxColorSelectDialog.prototype.getContent=function(){return this._rootElement};
McxColorSelectDialog.prototype.initializeUiControls=function(){this._colorPicker.setColor(this._color.getHex());var a=new McxLabelControl;a.setText("Renk");a.setLocalizationKey("McxCommonDialog-color");a.createToolTip("McxCommonDialog-colorDescription");var b=new McxLayoutRow;b.createAndAddSpan(4,a);b.createAndAddSpan(8,this._colorPicker);(new McxLayoutRow).createAndAddSpan(12,b);a=new McxLabeledEditor("Color",this._colorPicker);a.setLabelLocalizationKey("McxCommonControl-mcxLayerPropertiesColor");
this.base.addChild(this._rootElement,a)};McxColorSelectDialog.prototype.getColorChangedEventHandler=function(){return this._colorPicker.getOnChangeHandler()};McxColorSelectDialog.prototype.getSelectedColor=function(){var a=new McxColor;a.setColorFromHex(this._colorPicker.getColor());return a};McxColorSelectDialog.prototype.setSelectedColor=function(a){this._colorPicker.setColor(a.getHex())};js.builtin.McxMapping.Dialog.QuickFindDialog={};js.builtin.McxMapping.Dialog.QuickFindDialog.McxQuickFindDialog={};function McxQuickFindDialog(a,b){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._map=a;this._interactionFactory=b}mcx.inherits(McxQuickFindDialog,McxDialogBase);McxQuickFindDialog.prototype.getIsSingleInstance=function(){return!0};McxQuickFindDialog.prototype.getDialogSize=function(){return McxDialogSize.medium};McxQuickFindDialog.prototype.getDialogTitle=function(){return"McxMapping-QuickFindDialogTitle"};
McxQuickFindDialog.prototype.getLocalizationPath=function(){return"$McxMapping/Dialog/QuickFindDialog/assets/locale/quickFindDialog"};
McxQuickFindDialog.prototype.creationComplete=function(){var a=new McxQuickFindControl(this._map,this._interactionFactory);a.initialize();var b=new McxButton;b.setText("Find");b.getClickHandler().addListener(a.findButtonClicked,null,a);b.setLocalizationKey("McxMapping-Search");var c=new McxButton;c.setText("Close");c.getClickHandler().addListener(this.base.close,null,this.base);c.setLocalizationKey("McxMapping-Close");this.base.addChild(this._rootElement,a);this.base.addFooterButton(b);this.base.addFooterButton(c)};
McxQuickFindDialog.prototype.getContent=function(){return this._rootElement};McxQuickFindDialog.prototype.cancelButtonClicked=function(){this.base.close()};McxQuickFindDialog.prototype.getDialogButtons=function(){return McxDialogButtons.none};js.builtin.McxMapping.Dialog.SubtypeEngineDialog={};js.builtin.McxMapping.Dialog.SubtypeEngineDialog.McxSubtypeEngineDialog={};function McxSubtypeEngineDialog(a){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this.map=a;this._subtypeEngineView=null}mcx.inherits(McxSubtypeEngineDialog,McxDialogBase);
McxSubtypeEngineDialog.prototype.creationComplete=function(){var a=this.map.getLayers().toLayerArray();this.map&&0<a.length?(this.createSubtypeEngine(a),this.base.getSubmitHandler().addListener(function(a){this._subtypeEngineView.applyStyle();this.map.getRenderer().paintLayer(null,null);a.setIsValidated(!0)},null,this),this.base.addChild(this._rootElement,this._subtypeEngineView)):(a=$("<div/>").css("padding","90px 0").css("font-size","18px").css("border","solid 0px #000").css("text-align","center").text(McxLocalizationManager.getLocaleValue("McxMapping-LayerNotFound")),
this.getContent().append(a))};McxSubtypeEngineDialog.prototype.getContent=function(){return this._rootElement};McxSubtypeEngineDialog.prototype.getDialogMaxHeight=function(){return 550};McxSubtypeEngineDialog.prototype.getDialogTitle=function(){return"McxMapping-SubTypeTitle"};
McxSubtypeEngineDialog.prototype.createSubtypeEngine=function(a){var b=new McxSubtypeEngineView,c=new McxCodedDomainThematicStyleEditor,d=new McxUniqueValueThematicStyleEditor,e=new McxRangeThematicStyleEditor,f=new McxThematicStyleClearEditor;c.initialize();d.initialize();e.initialize();f.initialize();b.addThematicStyleEditor(c);b.addThematicStyleEditor(d);b.addThematicStyleEditor(e);b.addThematicStyleEditor(f);b.setLayers(a);a=a[0];c.setSelectedLayer(a);d.setSelectedLayer(a);e.setSelectedLayer(a);
f.setSelectedLayer(a);switch(a.getSubtypeType().getSubtypeType()){case McxSubtypeType.CodedValueSubtype:b.setSelectedEditor(c);break;case McxSubtypeType.RangedValueSubtype:b.setSelectedEditor(e);break;case McxSubtypeType.UniqueValueSubtype:b.setSelectedEditor(d)}this._subtypeEngineView=b};McxSubtypeEngineDialog.prototype.getLocalizationPath=function(){return"$McxMapping/assets/locale/mcxMapping"};
js.builtin.Mcx3DMapping={};js.builtin.Mcx3DMapping.Mcx3DCameraController={};function Mcx3DCameraController(a){mcx.base(this);this.camera=a;this.isMouseDown=!1;this.theta=this.onMouseDownTheta=45;this.phi=this.onMouseDownPhi=60;this.onMouseDownPosition={x:0,y:0};this.radius=1600;this.projector=new THREE.Projector}mcx.inherits(Mcx3DCameraController,McxController);
Mcx3DCameraController.prototype.onMouseDown=function(a){a=a.getEvent();a.preventDefault();this.isMouseDown=!0;this.onMouseDownTheta=this.theta;this.onMouseDownPhi=this.phi;this.onMouseDownPosition.x=a.clientX;this.onMouseDownPosition.y=a.clientY};
Mcx3DCameraController.prototype.onMouseMove=function(a){a=a.getEvent();a.preventDefault();if(this.isMouseDown){this.theta=-(.5*(a.clientX-this.onMouseDownPosition.x))+this.onMouseDownTheta;this.phi=.5*(a.clientY-this.onMouseDownPosition.y)+this.onMouseDownPhi;this.phi=Math.min(180,Math.max(0,this.phi));a=this.theta*Math.PI/360;var b=this.phi*Math.PI/360;this.camera.position.x=this.radius*Math.sin(a)*Math.cos(b);this.camera.position.y=this.radius*Math.sin(b);this.camera.position.z=this.radius*Math.cos(a)*
Math.cos(b);this.camera.updateMatrix()}this.map.getDisplay().getWidth();this.map.getDisplay().getHeight();this.interact();this.render()};Mcx3DCameraController.prototype.onMouseUp=function(a){a=a.getEvent();a.preventDefault();this.isMouseDown=!1;this.onMouseDownPosition.x=a.clientX-this.onMouseDownPosition.x;this.onMouseDownPosition.y=a.clientY-this.onMouseDownPosition.y;this.interact();this.render()};Mcx3DCameraController.prototype.onMouseWheel=function(a){};
Mcx3DCameraController.prototype.interact=function(){};Mcx3DCameraController.prototype.render=function(){var a=this.map.getRenderer().getScene();this.map.getRenderer().renderer.render(a,this.camera)};js.builtin.Mcx3DMapping.Mcx3DInputHandler={};function Mcx3DInputHandler(a){mcx.base(this,a);this.base=this;this.scene=this.camera=null;this.initialize()}mcx.inherits(Mcx3DInputHandler,McxNativeInputHandler);
Mcx3DInputHandler.prototype.initialize=function(){var a=this.base.map.getRenderer();this.scene=a.getScene();this.camera=a.getCamera();this.base.panController=new Mcx3DPanZoomController(this.camera);this.base.panController.startInteraction(this.base.map);this.base.controller=new Mcx3DPanZoomController(this.camera);this.base.controller.getCursorChangedEventHandler().addListener(this.onCursorChanged,null,this);this.base.controller.getDescriptionChangedEventHandler().addListener(this.onDescriptionChanged,
null,this);this.base.controller.startInteraction(this.base.map);null!=this.base.lastControllerUI&&this.base.lastControllerUI.remove();(a=this.base.controller.getOptionUI())&&null!=a&&(this.base.lastControllerUI=this.base.showControllerUI(a))};
Mcx3DInputHandler.prototype.onMouseDown=function(a){"middle"==a.getButton()?(this.base.panController=new Mcx3DPanZoomController(this.camera),this.base.panController.startInteraction(this.base.map),this.base.panController.onMouseDown(a)):Mcx3DInputHandler.superClass_.onMouseDown.call(this,a)};Mcx3DInputHandler.prototype.onMouseWheel=function(a){this.map.getRenderer().abortRender();if(null!=this.base.panController)this.base.panController.onMouseWheel(a)};
Mcx3DInputHandler.prototype.setController=function(a){this.base.controller.endInteraction();this.base.controller=null==a?new Mcx3DPanZoomController(this.camera):a};js.builtin.Mcx3DMapping.Mcx3DPanZoomController={};
function Mcx3DPanZoomController(a){mcx.base(this);this.base=this;this.camera=a;this.enabled=!0;this.center=this.target=new THREE.Vector3;this.rotateRatio=0;this.noZoom=!1;this.zoomSpeed=1;this.minDistance=0;this.maxDistance=Infinity;this.noRotate=!1;this.rotateSpeed=1;this.noPan=!1;this.keyPanSpeed=7;this.autoRotate=!1;this.minPolarAngle=this.autoRotateSpeed=0;this.maxPolarAngle=Math.PI;this.noKeys=!1;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.EPS=0;this.rotateStart=new THREE.Vector2;this.rotateEnd=
new THREE.Vector2;this.rotateDelta=new THREE.Vector2;this.panStart=new THREE.Vector2;this.panEnd=new THREE.Vector2;this.panDelta=new THREE.Vector2;this.dollyStart=new THREE.Vector2;this.dollyEnd=new THREE.Vector2;this.dollyDelta=new THREE.Vector2;this.thetaDelta=this.phiDelta=0;this.scale=1;this.pan=new THREE.Vector3;this.lastPosition=new THREE.Vector3;this.STATE={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5};this.state=this.STATE.NONE;this.changeEvent={type:"change"};this.alertTimerId=
0}mcx.inherits(Mcx3DPanZoomController,McxController);Mcx3DPanZoomController.prototype.onStartInteraction=function(){this.base.setCursor(McxCursors.openHand);this.base.setDescription("Mcx3DPanZoomController");this.target=new THREE.Vector3(this.base.map.getDisplay().getWidth()/2,this.base.map.getDisplay().getHeight()/2,0);document.getElementById(this.base.map.getName()).addEventListener("contextmenu",function(a){a.preventDefault()},!1)};
Mcx3DPanZoomController.prototype.onEndInteraction=function(){this.base.map.getRenderer().paintNonLayer();this.base.setCursor(McxCursors.Default)};Mcx3DPanZoomController.prototype.onMouseClick=function(a){};Mcx3DPanZoomController.prototype.onKeyUp=function(a){};Mcx3DPanZoomController.prototype.onDragStart=function(a){};Mcx3DPanZoomController.prototype.onDragEnd=function(a){};Mcx3DPanZoomController.prototype.onDrag=function(a){};
Mcx3DPanZoomController.prototype.isInstanceOf=function(a){return Mcx3DPanZoomController.superClass_.isInstanceOf.call(this,a)||"Mcx3DPanZoomController"==a};Mcx3DPanZoomController.prototype.onPanStart=function(a,b){};Mcx3DPanZoomController.prototype.onPanning=function(a,b){};Mcx3DPanZoomController.prototype.onPanFinish=function(a,b){};Mcx3DPanZoomController.prototype.rotateLeft=function(a){a||(a=this.getAutoRotationAngle());this.thetaDelta+=a};
Mcx3DPanZoomController.prototype.rotateUp=function(a){a||(a=this.getAutoRotationAngle());this.phiDelta-=a};Mcx3DPanZoomController.prototype.panLeft=function(a){var b=new THREE.Vector3,c=this.camera.matrix.elements;b.set(c[0],c[1],c[2]);b.multiplyScalar(-a);this.pan.add(b)};Mcx3DPanZoomController.prototype.panUp=function(a){var b=new THREE.Vector3,c=this.camera.matrix.elements;b.set(c[4],c[5],c[6]);b.multiplyScalar(a);this.pan.add(b)};
Mcx3DPanZoomController.prototype.panning=function(a){var b=document.getElementById(this.base.map.getName());if(void 0!==this.camera.fov){var c=this.camera.position.clone().sub(this.target).length(),c=c*Math.tan(this.camera.fov/2*Math.PI/180);this.panLeft(2*a.x*c/b.clientHeight);this.panUp(2*a.y*c/b.clientHeight)}else void 0!==this.camera.top?(this.panLeft(a.x*(this.camera.right-this.camera.left)/b.clientWidth),this.panUp(a.y*(this.camera.top-this.camera.bottom)/b.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")};
Mcx3DPanZoomController.prototype.dollyIn=function(a){void 0===a&&(a=this.getZoomScale());this.scale/=a};Mcx3DPanZoomController.prototype.dollyOut=function(a){void 0===a&&(a=this.getZoomScale());this.scale*=a};
Mcx3DPanZoomController.prototype.update=function(a){var b=this.camera.position,c=b.clone().sub(this.target),d=Math.atan2(c.x,c.z),e=Math.atan2(Math.sqrt(c.x*c.x+c.z*c.z),c.y),d=d+this.thetaDelta,e=e+this.phiDelta,e=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,e)),e=Math.max(this.EPS,Math.min(Math.PI-this.EPS,e)),f=c.length()*this.scale,f=Math.max(this.minDistance,Math.min(this.maxDistance,f));this.target.add(this.pan);c.x=f*Math.sin(e)*Math.sin(d);c.y=f*Math.cos(e);c.z=f*Math.sin(e)*Math.cos(d);
b.copy(this.target).add(c);this.camera.lookAt(this.target);this.phiDelta=this.thetaDelta=0;this.scale=1;this.pan.set(0,0,0);if(0<this.lastPosition.distanceTo(this.camera.position)){(new THREE.EventDispatcher).dispatchEvent(this.changeEvent);this.lastPosition.copy(this.camera.position);clearTimeout(this.alertTimerId);var g=this;this.alertTimerId=setTimeout(function(){g.map.getRenderer().refreshScene()},10)}a&&this.base.map.getRenderer().refreshScene()};
Mcx3DPanZoomController.prototype.getAutoRotationAngle=function(){return 2*Math.PI/60/60*this.autoRotateSpeed};Mcx3DPanZoomController.prototype.getZoomScale=function(){return Math.pow(.95,this.zoomSpeed)};
Mcx3DPanZoomController.prototype.onMouseDown=function(a){!1!==this.enabled&&(this.base.setCursor(McxCursors.closeHand),a=a.getEvent(),a.preventDefault(),2===a.button?!0!==this.noRotate&&(this.state=this.STATE.ROTATE,this.rotateStart.set(a.clientX,a.clientY)):1===a.button?!0!==this.noZoom&&(this.state=this.STATE.DOLLY,this.dollyStart.set(a.clientX,a.clientY)):0===a.button&&!0!==this.noPan&&(this.state=this.STATE.PAN,this.panStart.set(a.clientX,a.clientY)))};
Mcx3DPanZoomController.prototype.onMouseMove=function(a){if(!1!==this.enabled){a=a.getEvent();a.preventDefault();var b=document.getElementById(this.base.map.getName()),c=!1;if(this.state===this.STATE.ROTATE){if(!0===this.noRotate)return;this.rotateEnd.set(a.clientX,a.clientY);this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart);this.rotateLeft(2*Math.PI*this.rotateDelta.x/b.clientWidth*this.rotateSpeed);this.rotateUp(2*Math.PI*this.rotateDelta.y/b.clientHeight*this.rotateSpeed);this.rotateStart.copy(this.rotateEnd)}else if(this.state===
this.STATE.DOLLY){if(!0===this.noZoom)return;this.dollyEnd.set(a.clientX,a.clientY);this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart);0<this.dollyDelta.y?this.dollyIn():this.dollyOut();this.dollyStart.copy(this.dollyEnd)}else if(this.state===this.STATE.PAN){if(!0===this.noPan)return;if(2<=Math.abs(a.clientX)||2<=Math.abs(a.clientY))c=!0;this.panEnd.set(a.clientX,a.clientY);this.panDelta.subVectors(this.panEnd,this.panStart);this.panning(this.panDelta);this.panStart.copy(this.panEnd)}this.update(c)}};
Mcx3DPanZoomController.prototype.onMouseUp=function(a){!1!==this.enabled&&(this.state=this.STATE.NONE,this.base.setCursor(McxCursors.openHand))};Mcx3DPanZoomController.prototype.onMouseWheel=function(a){a=a.getEvent();a.wheelDeltaY?this.camera.fov+=-.5*a.wheelDeltaY/40:a.wheelDelta?this.camera.fov+=.5*a.wheelDelta:a.detail&&(this.camera.fov+=.5*a.detail);this.camera.updateProjectionMatrix();this.base.map.getRenderer().refreshScene()};
Mcx3DPanZoomController.prototype.onKeyDown=function(a){if(!1!==this.enabled&&!0!==this.noKeys&&!0!==this.noPan){var b=!1;switch(a.getKeyCode()){case this.keys.UP:this.panning(new THREE.Vector2(0,this.keyPanSpeed));b=!0;break;case this.keys.BOTTOM:this.panning(new THREE.Vector2(0,-this.keyPanSpeed));b=!0;break;case this.keys.LEFT:this.panning(new THREE.Vector2(this.keyPanSpeed,0));b=!0;break;case this.keys.RIGHT:this.panning(new THREE.Vector2(-this.keyPanSpeed,0)),b=!0}b&&this.update()}};js.builtin.Mcx3DMapping.McxSelect3DController={};function McxSelect3DController(a){mcx.base(this);this.camera=a;this.projector=new THREE.Projector}mcx.inherits(McxSelect3DController,McxController);McxSelect3DController.prototype.onMouseDown=function(a){a=new THREE.Vector3(a.getX(),a.getY(),1);new THREE.Raycaster(this.camera.position,a.sub(this.camera.position).normalize())};
js.builtin.McxDimension={};js.builtin.McxDimension.Controller={};js.builtin.McxDimension.Controller.McxMeasureAreaController={};function McxMeasureAreaController(){mcx.base(this,null);this.base=this;this.textSymbolizer=null;this._controllerUI=new McxControllerUI;this._colorSelector=new McxColorSelector;this._centerPointX=[];this._centerPointY=[];this._centerDistance=[];this._allDistance=0;this._staticAngle={};this.initialize();this.createControllerUI()}mcx.inherits(McxMeasureAreaController,McxPaintPolygonController);
McxMeasureAreaController.prototype.initialize=function(){this.base.polygonSymbolizer=McxFactoryFinder.StyleFactory().createPolygonSymbolizer();var a=new McxFill;a.setColor("transparent");var b=new McxStroke;b.setDashPattern([5,5]);b.setWidth(2);this.base.polygonSymbolizer.setFill(a);this.base.polygonSymbolizer.setStroke(b);this.textSymbolizer=McxFactoryFinder.StyleFactory().createTextSymbolizer();a=new McxFont;a.setFontSize(10);this.textSymbolizer.setFont(a);a=new McxFill;a.setColor("black");this.textSymbolizer.setFill(a)};
McxMeasureAreaController.prototype.onStartInteraction=function(){McxMeasureAreaController.superClass_.onStartInteraction.call(this);this.base.setCursor(McxCursors.measure);this.base.setDescription("McxMapping-PaintRectangleController")};McxMeasureAreaController.prototype.reset=function(){this._allDistance=0;this._centerDistance=[];this._centerPointX=[];this._centerPointY=[];this._staticAngle=[];McxMeasureAreaController.superClass_.reset.call(this)};
McxMeasureAreaController.prototype.onEndInteraction=function(){McxMeasureAreaController.superClass_.onEndInteraction.call(this);this.base.setCursor(McxCursors.Default)};
McxMeasureAreaController.prototype.paint=function(a){if(!(0>=this.base.points.length)){for(var b=[],c=0;c<this.base.points.length;c++)b.push(this.base.points[c]);null!=this.base.cursorPosition&&b.push(this.base.cursorPosition);a.getGeodeticGraphics().drawPolygon(b,this.base.polygonSymbolizer,1,0,0);var c=this.base.map.getCoordinateSystem(),d=McxFactoryFinder.GeometryFactory(c).createLineString([b[b.length-2],b[b.length-1]]),e=-1*d.segmentize()[0].getAngle();-90>e&&-270<e&&(e=180+e);this.textSymbolizer.setRotation(e);
var e=d.getStartPoint(),d=d.getEndPoint(),f=(e.getX()+d.getX())/2,g=(e.getY()+d.getY())/2,f=McxFactoryFinder.GeometryFactory(c).createPoint(f,g),e=e.distanceTo(d);a.getGeodeticGraphics().drawText(e.toFixed(2),f,this.textSymbolizer,1.45,10,10);e=McxFactoryFinder.GeometryFactory(c).createPoint(this.base.points[this.base.points.length-1].getX(),this.base.points[this.base.points.length-1].getY());this._allDistance=McxFactoryFinder.GeometryFactory(c).createLineString(this.base.points).getLength();a.getGeodeticGraphics().drawText("\u2211 :"+
this._allDistance.toFixed(2),e,this.textSymbolizer,1.45,10,10);if(0<this._centerPointX.length)for(e=0;e<this._centerPointX.length;e++)this.textSymbolizer.setRotation(this._staticAngle[e]),d=McxFactoryFinder.GeometryFactory(c).createPoint(this._centerPointX[e],this._centerPointY[e]),f=this._centerDistance[e].toFixed(2),a.getGeodeticGraphics().drawText(f,d,this.textSymbolizer,1.45,10,10);b=McxFactoryFinder.GeometryFactory(c).createLinearRing(b);b.closeRing();b=McxFactoryFinder.GeometryFactory(c).createPolygon(b,
null);c=b.getArea();this.textSymbolizer.setRotation(0);a.getGeodeticGraphics().drawText("\u2211 :"+c.toFixed(2),b.getBounds().getCentroid(),this.textSymbolizer,1.45,10,10)}};
McxMeasureAreaController.prototype.drawingCompleted=function(a){var b=a.transformTo(new McxCoordinateSystem(4326));a=b.getArea();for(var b=b.getShell().segmentize(),c=0,d=0;d<=b.length-1;d++)c+=b[d].getLength();a=String.format(McxLocalizationManager.getLocaleValue("McxDimension-dimensionArea"),a.toFixed(3).toString(),c.toFixed(3).toString());McxMessageBox.show("",a.toString(),McxMessageBoxType.Information,McxDialogButtons.ok);this.reset()};
McxMeasureAreaController.prototype.onCoordinateCreated=function(a,b){McxMeasureAreaController.superClass_.onCoordinateCreated.call(this,a,b);var c=this.base.map.getCoordinateSystem(),d=McxFactoryFinder.GeometryFactory(c).createLineString(this.base.points),e=d.segmentize();this._centerDistance=[];this._centerPointX=[];this._centerPointY=[];this._staticAngle=[];for(var f=0;f<e.length;f++){var g=e[f].getStartPoint(),h=e[f].getEndPoint(),k=McxFactoryFinder.GeometryFactory(c).createLineSegment(g,h),m=
(g.getX()+h.getX())/2,n=(g.getY()+h.getY())/2,m=McxFactoryFinder.GeometryFactory(c).createPoint(m,n),k=-1*k.getAngle();-90>k&&-270<k&&(k=180+k);this._staticAngle.push(k);this._centerPointX.push(m.getX());this._centerPointY.push(m.getY());this._centerDistance.push(g.distanceTo(h))}this._allDistance=d.getLength()};McxMeasureAreaController.prototype.getOptionUI=function(){return this._controllerUI};
McxMeasureAreaController.prototype.createControllerUI=function(){this._colorSelector.setColor(this.base.polygonSymbolizer.getStroke().getColor());var a=McxSettingsManager.read("McxDimension-AreaDimensionSettings",null).getSettings();a&&0<a.length&&(a=JSON.parse(a[0]),this._colorSelector.setColor(a.Color));this._controllerUI.getSubmitHandler().addListener(function(){this.finishDraw();var a={Color:this._colorSelector.getColor()};McxSettingsManager.write("McxDimension-AreaDimensionSettings",JSON.stringify(a),
null)},null,this);this._colorSelector.getOnChangeHandler().addListener(function(){this.base.polygonSymbolizer.getStroke().setColor("#"+this._colorSelector.getColor())},null,this);this._controllerUI.addControl(this._colorSelector)};McxMeasureAreaController.prototype.setTextSymbolizer=function(a){this.textSymbolizer=a};js.builtin.McxDimension.Controller.McxMeasureLengthController={};function McxMeasureLengthController(){mcx.base(this,null);this.base=this;this.textSymbolizer=null;this._centerPointX=[];this._centerPointY=[];this._centerDistance=[];this._allDistance=0;this._staticAngle={};this._controllerUI=new McxControllerUI;this._colorSelector=new McxColorSelector;this.initialize();this.createControllerUI()}mcx.inherits(McxMeasureLengthController,McxPaintLineStringController);
McxMeasureLengthController.prototype.onStartInteraction=function(){McxMeasureLengthController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxDimension-MeasureController");this.base.setCursor(McxCursors.measure)};McxMeasureLengthController.prototype.onEndInteraction=function(){McxMeasureLengthController.superClass_.onEndInteraction.call(this);this.base.setCursor(McxCursors.Default)};
McxMeasureLengthController.prototype.initialize=function(){this.textSymbolizer=McxFactoryFinder.StyleFactory().createTextSymbolizer();var a=new McxFont;a.setFontSize(10);this.textSymbolizer.setFont(a);a=new McxFill;a.setColor("black");this.textSymbolizer.setFill(a);this.base.lineSymbolizer=McxFactoryFinder.StyleFactory().createLineSymbolizer();this.base.lineSymbolizer.getStroke().setDashPattern([5,5]);this.base.lineSymbolizer.getStroke().setWidth(2)};
McxMeasureLengthController.prototype.paint=function(a){if(!(0>=this.base.points.length)){for(var b=[],c=0;c<this.base.points.length;c++)b.push(this.base.points[c]);null!=this.base.cursorPosition&&b.push(this.base.cursorPosition);a.getGeodeticGraphics().drawLineString(b,this.base.lineSymbolizer,1,0,0);var c=this.base.map.getCoordinateSystem(),d=McxFactoryFinder.GeometryFactory(c).createLineString([b[b.length-2],b[b.length-1]]),b=-1*d.segmentize()[0].getAngle();-90>b&&-270<b&&(b=180+b);this.textSymbolizer.setRotation(b);
var b=d.getStartPoint(),d=d.getEndPoint(),e=(b.getX()+d.getX())/2,f=(b.getY()+d.getY())/2,e=McxFactoryFinder.GeometryFactory(c).createPoint(e,f),b=b.distanceTo(d);a.getGeodeticGraphics().drawText(b.toFixed(2),e,this.textSymbolizer,1.45,10,10);b=McxFactoryFinder.GeometryFactory(c).createPoint(this.base.points[this.base.points.length-1].getX(),this.base.points[this.base.points.length-1].getY());this._allDistance=McxFactoryFinder.GeometryFactory(c).createLineString(this.base.points).getLength();a.getGeodeticGraphics().drawText("\u2211 :"+
this._allDistance.toFixed(2),b,this.textSymbolizer,1.45,10,10);if(0<this._centerPointX.length)for(b=0;b<this._centerPointX.length;b++)this.textSymbolizer.setRotation(this._staticAngle[b]),d=McxFactoryFinder.GeometryFactory(c).createPoint(this._centerPointX[b],this._centerPointY[b]),e=this._centerDistance[b].toFixed(2),a.getGeodeticGraphics().drawText(e,d,this.textSymbolizer,1.45,10,10)}};
McxMeasureLengthController.prototype.onCoordinateCreated=function(a,b){McxMeasureLengthController.superClass_.onCoordinateCreated.call(this,a,b);var c=this.base.map.getCoordinateSystem(),d=McxFactoryFinder.GeometryFactory(c).createLineString(this.base.points),e=d.segmentize();this._centerDistance=[];this._centerPointX=[];this._centerPointY=[];this._staticAngle=[];for(var f=0;f<e.length;f++){var g=e[f].getStartPoint(),h=e[f].getEndPoint(),k=McxFactoryFinder.GeometryFactory(c).createLineSegment(g,h),
m=(g.getX()+h.getX())/2,n=(g.getY()+h.getY())/2,m=McxFactoryFinder.GeometryFactory(c).createPoint(m,n),k=-1*k.getAngle();-90>k&&-270<k&&(k=180+k);this._staticAngle.push(k);this._centerPointX.push(m.getX());this._centerPointY.push(m.getY());this._centerDistance.push(g.distanceTo(h))}this._allDistance=d.getLength()};
McxMeasureLengthController.prototype.finishDraw=function(){var a=String.format(McxLocalizationManager.getLocaleValue("McxDimension-dimensionTotalDistance"),this._allDistance.toFixed(2));McxMessageBox.show("",a.toString(),McxMessageBoxType.Information,McxDialogButtons.ok);McxMeasureLengthController.superClass_.finishDraw.call(this)};McxMeasureLengthController.prototype.reset=function(){this._allDistance=0;this._centerDistance=[];this._centerPointX=[];this._centerPointY=[];this._staticAngle=[];McxMeasureLengthController.superClass_.reset.call(this)};
McxMeasureLengthController.prototype.getOptionUI=function(){return this._controllerUI};
McxMeasureLengthController.prototype.createControllerUI=function(){this._colorSelector.setColor(this.lineSymbolizer.getStroke().getColor());var a=McxSettingsManager.read("McxDimension-MeasureSettings",null).getSettings();a&&0<a.length&&(a=JSON.parse(a[0]),this._colorSelector.setColor(a.Color));this._controllerUI.getSubmitHandler().addListener(function(){this.finishDraw();var a={Color:this._colorSelector.getColor()};McxSettingsManager.write("McxDimension-MeasureSettings",JSON.stringify(a),null)},null,
this);this._colorSelector.getOnChangeHandler().addListener(function(){this.base.lineSymbolizer.getStroke().setColor("#"+this._colorSelector.getColor())},null,this);this._controllerUI.addControl(this._colorSelector)};McxMeasureLengthController.prototype.setLineSymbolizer=function(a){this.base.lineSymbolizer=a};McxMeasureLengthController.prototype.setTextSymbolizer=function(a){this.textSymbolizer=a};js.builtin.McxDimension.Controller.McxShowCoordinateController={};function McxShowCoordinateController(){mcx.base(this,null);this.base=this;this.pointMarker=this._dialog=null;this.lastCreatedGuid=McxGuid.createGuid()}mcx.inherits(McxShowCoordinateController,McxPaintPointController);
McxShowCoordinateController.prototype.onStartInteraction=function(){McxShowCoordinateController.superClass_.onStartInteraction.call(this);this.base.setCursor(McxCursors.location);mcx.isDefAndNotNull(this._dialog)||(this._dialog=new McxShowCoordinateDialog,this._dialog.showDialog(!1,!1),this._dialog.getCloseButtonClickHandler().addListener(function(){this._dialog=null;this.base.map.getInputHandler().setController(null)},null,this));this.pointMarker=new McxPointMarker(new McxPoint(0,0,this.base.map.getCoordinateSystem()),
this.lastCreatedGuid);var a=new McxPointSymbolizer,b=document.createElement("div");b.style.width="40px";b.style.height="40px";b.className="tool-location";var c=document.createElement("div");$(c).append(b);a.setSymbols([new McxContentSymbol(c)]);this.pointMarker.setSymbolizer(a);this.base.map.getMarkerCollection().add(this.pointMarker)};
McxShowCoordinateController.prototype.onEndInteraction=function(){mcx.isDefAndNotNull(this._dialog)&&(this._dialog.close(),this._dialog=null);this.base.setCursor(McxCursors.Default);this.base.map.getMarkerCollection().removeWithGuid(this.lastCreatedGuid);this.base.map.getRenderer().paintNonLayer();McxShowCoordinateController.superClass_.onEndInteraction.call(this)};
McxShowCoordinateController.prototype.onCoordinateCreated=function(a,b){McxShowCoordinateController.superClass_.onCoordinateCreated.call(this,a,b);var c=this.base.map.worldToView(b.getX(),b.getY()),d=c.getX()+20,c=c.getY()+20,d=this.base.map.viewToWorld(d,c);mcx.isDefAndNotNull(this._dialog)&&(this._dialog.setY(d.getX().toString()),this._dialog.setX(d.getY().toString()),this.pointMarker.setGeometry(d),this.base.map.getRenderer().paintNonLayer())};
js.builtin.McxSelection={};js.builtin.McxSelection.McxFilterEventArgs={};function McxFilterEventArgs(a,b){mcx.base(this,b);this.filter=a}mcx.inherits(McxFilterEventArgs,McxResult);McxFilterEventArgs.prototype.getFilter=function(){return this.filter};McxFilterEventArgs.prototype.getArgs=function(){return McxFilterEventArgs.superClass_.getArgs.call(this)};js.builtin.McxSelection.McxMapInteractionFactory={};function McxMapInteractionFactory(){}McxMapInteractionFactory.prototype.createZoomLayerAction=function(a,b){return new McxZoomLayerAction(a,b)};McxMapInteractionFactory.prototype.createZoomFeatureAction=function(a,b){var c=new McxZoomFeatureAction(a);c.setRatio(b);return c};McxMapInteractionFactory.prototype.createZoomGeometryAction=function(a,b){var c=new McxZoomGeometryAction(a);b&&c.setRatio(b);return c};
McxMapInteractionFactory.prototype.createBlinkAction=function(a,b){return new McxBlinkAction(a,b)};McxMapInteractionFactory.prototype.createBlinkGeometryAction=function(a,b){return new McxBlinkGeometryAction(a,b)};McxMapInteractionFactory.prototype.createPanFeatureAction=function(a){return new McxPanFeatureAction(a)};McxMapInteractionFactory.prototype.createPanController=function(){return new McxPanController};
McxMapInteractionFactory.prototype.createIdentifyController=function(){var a=new McxIdentifyController;a.setterEnabled(!1);return a};McxMapInteractionFactory.prototype.createSelectController=function(){var a=new McxSelectController;a.setApplyMode(McxApplyMode.Select);a.setSelectToolMode(McxSelectToolMode.Fence);a.setterEnabled(!1);return a};
McxMapInteractionFactory.prototype.createMeasureController=function(){var a=new McxMeasureLengthController,b=McxFactoryFinder.StyleFactory().createLineSymbolizer();b.getStroke().setDashPattern([5,5,5]);b.getStroke().setWidth(2);a.setLineSymbolizer(b);return a};
McxMapInteractionFactory.prototype.createSelectOnActiveLayerController=function(a){var b=new McxSelectController;b.setApplyMode(McxApplyMode.Select);b.setSelectToolMode(McxSelectToolMode.Fence);a=a.getLayers().getActiveLayer();a=new McxFieldSet(a,null);b.setLayersAndFields(a);b.setterEnabled(!1);return b};McxMapInteractionFactory.prototype.createZoomWindowController=function(){return new McxZoomWindowController};McxMapInteractionFactory.prototype.createCoordinateSystemSetterAction=function(){return new McxCoordinateSystemSetterAction};
McxMapInteractionFactory.prototype.quickSearchAction=function(a){return(new McxQuickFindDialog(a,new McxMapInteractionFactory)).showDialog(!1,!0)};McxMapInteractionFactory.prototype.zoomLayersAction=function(a,b){var c=new McxZoomLayerAction(a,1);c.execute(b);return c};McxMapInteractionFactory.prototype.showCoordinateController=function(){return new McxShowCoordinateController};
McxMapInteractionFactory.prototype.createZoomToBoundsAction=function(a,b){var c=new McxZoomBoundsAction(a);c.setRatio(b);return c};McxMapInteractionFactory.prototype.createHighlightAction=function(a,b){return new McxHighLightAction(a,b)};McxMapInteractionFactory.prototype.createFeatureGridAction=function(a){return new McxFeatureGridAction(a,this)};McxMapInteractionFactory.prototype.createPrintOptionsAction=function(){return new McxPrintOptionsAction(this)};
McxMapInteractionFactory.prototype.createPrintRectangleController=function(a){return new McxPrintRectangleController(a)};js.builtin.McxSelection.Action={};js.builtin.McxSelection.Action.McxFeatureRequestAction={};
function McxFeatureRequestAction(a,b){this._filter=a;this._selectMode=b;this._attributeFilter="";this._features=[];this._selectedFeaturesByRequest=[];this._maxSelectionCount=5E3;this._selectCountPerRequest=500;this._layer=this._activeSearchResult=this._nextRequestObject=null;this._fields="";this._loadingPanel=null;this._relation=McxSpatialRelation.None;this._isSpatialQuery=!1;this._messageBox=null;this._selectedGeometryIndex=0;this._selectedGeometries=[];this._map=null}
McxFeatureRequestAction.prototype.execute=function(a){this._map=a;this._maxSelectionCount=McxSelectionHelper.instance.getMaxSelectionCount();this._selectCountPerRequest=McxSelectionHelper.instance.getSelectCountPerRequest();this._loadingPanel=McxLoadingIndicator.setAsBusy(null,!0);this._loadingPanel.getCancelEventHandler().addListener(this.cancelAllRequests,null,this);this._selectedGeometryIndex=0;var b=1+this._selectCountPerRequest-1;this._layer=this._filter.getLayer();this._fields=this._layer.getKeyField()+
","+this._layer.getGeometryField();this._relation=this._filter.getFilter().getSpatialRelation();this._attributeFilter=this._filter.getFilter().getAttributeFilter();this._selectedFeaturesByRequest=[];if("3"==this._selectMode)for(var c=this._layer.getSelection();c.read();)this._selectedFeaturesByRequest.push(c.getCurrent().getFeatureID());if("0"==this._selectMode||"3"==this._selectMode)McxSelectionHelper.instance.clearSelection(a),a.getRenderer().paintSelections();this._isSpatialQuery?(this._selectedGeometries=
this._filter.getFilter().getGeometryArray(),this._selectedGeometryIndex=1,this.createRequest(this._selectedGeometries[0],1,b)):this.createRequest(null,1,b);this.search()};
McxFeatureRequestAction.prototype.createRequest=function(a,b,c){this._isSpatialQuery&&(a=a.transformTo(this._layer.getCoordinateSystem()));var d=new McxAjaxParameter;d.setParameters(this,this.onSearchSuccess,this.onSearchFail);d.setArgs([this._selectMode,this._selectedFeaturesByRequest]);d.setTimeOut(McxSelectionHelper.instance.getSelectionRequestTimeout());d.setRange(b,c);this._nextRequestObject={geometry:a,first:b,last:c,ajax:d}};
McxFeatureRequestAction.prototype.search=function(){if(this._features.length>=this._maxSelectionCount)this.searchCompleted();else{var a=this._nextRequestObject,b=a.geometry,c=a.ajax,a=a.last;this.createRequest(b,a+1,a+this._selectCountPerRequest);this._isSpatialQuery&&(this._activeSearchResult=this._layer.search(this._fields,null,b,this._relation,c))}};
McxFeatureRequestAction.prototype.onSearchSuccess=function(a){a=a.getFeatureReader();for(var b=0;a.read();){if(McxSelectionHelper.instance.getSelectionStatus()){this.searchCompleted();return}var c=a.getCurrent(),d=new McxMemFeature(c.getLayer(),null);d.createFromFeature(c);"2"==this._selectMode?McxSelectionHelper.instance.removeSelection(this._map,[d]):McxSelectionHelper.instance.addSelection(this._map,[d]);this._features.push(d);b++}this._activeSearchResult=null;b==this._selectCountPerRequest?this.search():
this.searchCompleted()};McxFeatureRequestAction.prototype.onSearchFail=function(){this._activeSearchResult=null;this.searchCompleted()};McxFeatureRequestAction.prototype.getSelectedFeatures=function(){return this._features};McxFeatureRequestAction.prototype.setSpatialQuery=function(a){this._isSpatialQuery=a};
McxFeatureRequestAction.prototype.searchCompleted=function(){var a=1+this._selectCountPerRequest-1;this._selectedGeometries.length>this._selectedGeometryIndex?(this.createRequest(this._selectedGeometries[this._selectedGeometryIndex],1,a),this._selectedGeometryIndex++,this.search()):McxLoadingIndicator.setAsIdle(null)};McxFeatureRequestAction.prototype.cancelAllRequests=function(){this._activeSearchResult.abort()};
McxFeatureRequestAction.prototype.isInstanceOf=function(a){return"McxFeatureRequestAction"==a};js.builtin.McxSelection.Action.McxSelectByGeometryAction={};function McxSelectByGeometryAction(){this._layer=this._map=this._control=this._dialog=null;this._mapInteractionFactory=new McxMapInteractionFactory;this._searchUri=""}
McxSelectByGeometryAction.prototype.execute=function(a){this._map=a;this._dialog=new McxSelectByGeometryDialog(this._map);this._dialog.onCancelButtonClickHandler().addListener(this.cancelButtonClick,null,this);this._dialog.onSelectButtonClickHandler().addListener(this.onSubmitDialog,null,this);this._dialog.setLayerArray(this._map.getLayers().toLayerArray());this._dialog.showDialog(!1,!0);this._control=this._dialog.getSelectControl()};
McxSelectByGeometryAction.prototype.onSubmitDialog=function(a){if((this._layerFilterArray=this._control.getLayerFilter())&&0!=this._layerFilterArray.length)if(a=this._dialog.getSelectedRadioButton(),"map"==a.getValue())a=this._control.getSelectionMode(),a=new McxFeatureRequestAction(this._layerFilterArray[0],a),a.setSpatialQuery(!0),this._map.getInputHandler().execute(a);else{if("grid"==a.getValue()){var b=this._layerFilterArray[0].getLayer(),c=this._layerFilterArray[0].getFilter();a=b.getDataSource();
var d=b.getName(),b=new McxFilter;b.setAttributeFilter(c.getAttributeFilter());b.setSpatialRelation(c.getSpatialRelation());b.setGeometry(c.getGeometryArray()[0]);c=new McxAjaxParameter;c.setAsync(!1);a=a.getLayer(d,c,!0).getLayers()[0];a.getFilterCollection().addFilter(b);a=new McxFeatureGridWrapper(this._map,a,this._mapInteractionFactory);a.setToolbar(!0,!0,!1,!1);a.initialize();(new McxFeatureGridWrapperDialog(a)).showDialog()}}else a.setIsValidated(!1)};
McxSelectByGeometryAction.prototype.cancelButtonClick=function(){this._dialog.close()};McxSelectByGeometryAction.prototype.searchCompleted=function(){this._control.getLayer()};McxSelectByGeometryAction.prototype.getLayerArray=function(){return this._layer};McxSelectByGeometryAction.prototype.isInstanceOf=function(a){return"McxSelectByGeometryAction"==a};js.builtin.McxSelection.Action.McxSelectionByAttributeAction={};function McxSelectionByAttributeAction(){this._map=this._control=this._dialog=null;this._mapInteractionFactory=new McxMapInteractionFactory}
McxSelectionByAttributeAction.prototype.execute=function(a){this._map=a;this._dialog=new McxSelectByAttributeDialog(this._map);this._dialog.onCancelButtonClickHandler().addListener(this.cancelButtonClick,null,this);this._dialog.onSelectButtonClickHandler().addListener(this.selectButtonClick,null,this);this._dialog.setLayerArray(this._map.getLayers().toLayerArray());this._dialog.showDialog();this._control=this._dialog.getControl()};
McxSelectionByAttributeAction.prototype.selectButtonClick=function(){var a=this._control.getLayer(),b=this._control.getLayerFilter();if(this._dialog.showResultOnMap())b=this._control.getLayerFilter(),a=this._control.getSelectionMode(),a=new McxFeatureRequestAction(b,a),a.setSpatialQuery(!1),this._map.getInputHandler().execute(a);else if(this._dialog.showResultOnGrid()){var b=b.getFilter(),c=McxSelectionHelper.instance.getGridShowCount(),d=new McxFilter;d.setAttributeFilter(b.getAttributeFilter());
d.setGeometry(b.getGeometryArray()[0]);d.setSpatialRelation(b.getSpatialRelation());b=new McxAjaxParameter;b.setAsync(!0);b.setParameters(this,function(a){a=a.getLayers()[0];a.setFilter(d);a=new McxFeatureGridWrapper(this._map,a,this._mapInteractionFactory,c);a.setToolbar(!0,!0,!1,!1);a.initialize();(new McxFeatureGridWrapperDialog(a)).showDialog()},function(){});a.getDataSource().getLayer(a.getName(),b,!0)}};McxSelectionByAttributeAction.prototype.cancelButtonClick=function(){this._dialog.close()};
McxSelectionByAttributeAction.prototype.isInstanceOf=function(a){return"McxSelectionByAttributeAction"==a};js.builtin.McxSelection.Action.McxSelectionToNewLayer={};function McxSelectionToNewLayer(){this._map=this._mcxAddSelectedToDialog=null;this._selectedFeatures=[]}
McxSelectionToNewLayer.prototype.execute=function(a){var b=McxSelectionHelper.instance.getSelection(a);this._selectedFeatures=b;0<b.length?(this._mcxAddSelectedToDialog=new McxAddSelectedToDialog(!1),this._mcxAddSelectedToDialog.showDialog(!0),this._mcxAddSelectedToDialog.getOkButtonClickHandler().addListener(this.createLayer,null,this),this._map=a):McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxSelection-FeatureNotSelected"),McxMessageBoxType.Error)};
McxSelectionToNewLayer.prototype.createLayer=function(){var a=this._mcxAddSelectedToDialog.getLayerAndMapName().layerName;McxLoadingIndicator.setAsBusy(this._map.getContent());for(var b=(new McxMemDriver).openDataSource(" ").getDataSource(),c=b.createLayer(a,this._map.getCoordinateSystem(),McxGeometryType.Unknown,[]),d=[],e=this._selectedFeatures,a=e.length,f=[],g=0;g<a;g++){var h=e[g],k=h.getLayer();-1==d.indexOf(k)&&(d.push(k),f.push(h.getLayer().createEdit()))}for(g=0;g<a;g++)for(h=e[g],k=h.getLayer(),
f=h.getFieldCount(),h=0;h<f;h++){var m=k.getSchema().getField(h),n=c.getSchema().getField(m.getFieldName().toLowerCase());n||(n=c.getSchema().getField(m.getFieldName().toUpperCase()));n||c.createField(m)}for(var p=0,q=function(a){var b=a.getArgs();McxFeatureHelper.instance.copyFields(a.getFeature(),b);p++;p==u.length&&(a=new McxAjaxParameter,a.setAsync(!1),c.createEdit().insertRange(u,a),a=new McxAjaxParameter,a.setAsync(!1),a=new McxZoomBoundsAction([c.getEnvelope(a).getEnvelope()]),this._map.getInputHandler().execute(a),
McxLoadingIndicator.getInstance().setAsIdle(this._map.getContent()))},r=function(){},t=0,u=[],g=0;g<a;g++)k=c.createFeatureBuffer(),k.setGeometry(e[g].getGeometry()),u.push(k);a=new McxAjaxParameter;a.setParameters(this,function(a){a=a.getDomains();v=v.concat(a);t++;if(t==d.length){b.setDomains(v);this._map.getLayers().add(c);a=new McxAjaxParameter;for(var f=0;f<u.length;f++){var g=e[f],h=u[f];a.setParameters(this,q,r);a.setArgs(h);g.setMissing(a)}c.setSingleTile(!0)}},function(){t++;if(t==d.length){b.setDomains(v);
this._map.getLayers().add(c);for(var a=new McxAjaxParameter,f=0;f<u.length;f++){var g=e[f],h=u[f];a.setParameters(this,q,r);a.setArgs(h);g.setMissing(a)}c.setSingleTile(!0)}});for(var v=[],g=0;g<d.length;g++)d[g].getDataSource().getDomains(a)};McxSelectionToNewLayer.prototype.isInstanceOf=function(a){return"McxSelectionToNewLayer"==a};js.builtin.McxSelection.Controller={};js.builtin.McxSelection.Controller.IMcxSelectController={};function IMcxSelectController(){}IMcxSelectController.prototype.setSelectionBuffer=function(a){};IMcxSelectController.prototype.getSelectionBuffer=function(){};IMcxSelectController.prototype.getSelectionStartedEventHandler=function(){};IMcxSelectController.prototype.getSelectionCompletedEventHandler=function(){};IMcxSelectController.prototype.setLayersAndFields=function(a){};
IMcxSelectController.prototype.getLayers=function(){};IMcxSelectController.prototype.onFilterCreated=function(a){};IMcxSelectController.prototype.setApplyMode=function(a){};IMcxSelectController.prototype.setSelectMode=function(a){};IMcxSelectController.prototype.setSelectToolMode=function(a){};IMcxSelectController.prototype.setSpatialRelationMode=function(a){};IMcxSelectController.prototype.setterEnabled=function(a){};js.builtin.McxSelection.Controller.McxSelectController={};
function McxSelectController(){mcx.base(this);this.mouseCoordinateOnScreen=null;this.fenceDistance=3;this.cursorPolygonSymbolizer=new McxPolygonSymbolizer;var a=new McxStroke;a.setColor("blue");a.setWidth(2);this.cursorPolygonSymbolizer.setStroke(a);(new McxFill).setColor("transparent");this.cursorPolygonSymbolizer.setFill(null);this.map=null;this.enableBufferCursor=!0;this.layers=null;this.fieldSets=[];this.fields=[];this.alertTimerId=0;this.selectionBuffer=McxSelectionHelper.instance.getSnapSensitivity();
this.geometryTypes=null;this.polygonBoundarySelect=!0;this.filterCreatedEventHandler=new McxEventHandler;this.featureSelectionCompletedEventHandler=new McxEventHandler;this.featureSelectionStartedEventHandler=new McxEventHandler;this.applyMode=McxApplyMode.Select;this.selectMode=McxSelectMode.Add;this.selectOnActiveLayer=this.useHover=this.hitSelect=!1;this.selectToolMode=McxSelectToolMode.Fence;this.selectSpatialRelationMode=McxSpatialRelation.Intersects;this.points=[];this.started=!1;this.endCoordinate=
this.startCoordinate=null;this.polygonSymbolizer=new McxPolygonSymbolizer;a=new McxFill;a.setColor("blue");a.setOpacity(.2);var b=new McxStroke;b.setColor("blue");this.polygonSymbolizer.setFill(a);this.polygonSymbolizer.setStroke(b);this.hoverGeometry=null;this.hoverFeatureId=-1;this.hoverSymbolizer=new McxCompositeSymbolizer;this.lineSymbolizer=new McxLineSymbolizer;this.startCoordinateOnDisplay=null;this.canSet=!0;this.initialSelectedLayers=0;this.initialRequestedLayers=null;this.requestSend=0;
this.cursorPosition=this.origin=null;this.hoverTimerId=0;this.removeSelectionAfterDispose=!1;this.base=this;this.init()}mcx.inherits(McxSelectController,McxController);
McxSelectController.prototype.init=function(){var a=new McxPolygonSymbolizer,b=new McxFill;b.setColor("#FF4500");b.setOpacity(.5);a.setFill(b);this.hoverSymbolizer.setPolygonSymbolizer(a);a=new McxLineSymbolizer;b=new McxStroke;b.setColor("#FF4500");b.setWidth(3);a.setStroke(b);this.hoverSymbolizer.setLineSymbolizer(a);a=new McxPointSymbolizer;b=new McxFill;b.setColor("#FF4500");var c=new McxCircleMark;c.setFill(b);a.setSymbols([c]);this.hoverSymbolizer.setPointSymbolizer(a)};
McxSelectController.prototype.setLayersAndFields=function(a){this.canSet&&(a instanceof Array?this.fieldSets=a:(null==a&&(a=[]),this.fieldSets=[a]),this.base.setDescription("McxMapping-SelectOnActiveLayerController"))};
McxSelectController.prototype.onStartInteraction=function(){McxSelectController.superClass_.onStartInteraction.call(this);if(null==this.fieldSets||0>=this.fieldSets.length)this.applyMode==McxApplyMode.None?this.base.setDescription("McxMapping-IdentifySelectController"):this.canSet?this.base.setDescription("McxMapping-AdvancedSelectController"):this.base.setDescription("McxMapping-SelectController");else{this.base.setDescription("McxMapping-SelectOnActiveLayerController");var a=function(){var a=this.base.map.getLayers().getActiveLayer();
if(mcx.isDefAndNotNull(a)){var c=this.fieldSets[0].getFields(),a=new McxFieldSet(a,c);this.fieldSets[0]=a}};this.base.map.getLayers().onActiveLayerChanged().addListener(a,a,this)}this.enableBufferCursor?this.base.setCursor(McxCursors.none):this.base.setCursor(McxCursors.selectFeature)};
McxSelectController.prototype.onEndInteraction=function(){McxSelectController.superClass_.onEndInteraction.call(this);this.base.setCursor(McxCursors.selectFeature);this.points=[];this.cursorPosition=this.endCoordinate=this.startCoordinate=null;var a=this.enableBufferCursor;this.enableBufferCursor=!1;this.enableBufferCursor=a;this.hoverGeometry=null;this.hoverFeatureId=-1;null!=this.base.map&&(this.mouseCoordinateOnScreen=null,this.removeSelectionAfterDispose&&(McxSelectionHelper.instance.clearSelection(this.base.map),
this.base.map.getRenderer().paintSelections()),this.base.map.getRenderer().paintNonLayer())};
McxSelectController.prototype.onSelectFeaturesSuccess=function(a){var b=a.getFeatures(),c=a.getFilter();a=a.getLayer();c=c.getSelectMode();this.initialSelectedLayers++;null==b||0>=b.length||(c==McxSelectMode.Create&&a.clearSelection(),c==McxSelectMode.Add||c==McxSelectMode.Create?McxSelectionHelper.instance.addSelection(this.base.map,b):c==McxSelectMode.Remove&&McxSelectionHelper.instance.removeSelection(this.base.map,b));this.requestSend--;0==this.requestSend&&(this.initialSelectedLayers=0,this.featureSelectionCompletedEventHandler.dispatchOnSuccess(this,
null))};McxSelectController.prototype.selectFeaturesFail=function(){this.requestSend--;0==this.requestSend&&(this.initialSelectedLayers=0,this.featureSelectionCompletedEventHandler.dispatchOnSuccess(this,null))};
McxSelectController.prototype.drawingCompleted=function(a){var b,c=new McxSelectFilter;c.setGeometryTypes(this.geometryTypes);c.setPolygonBoundarySelect(this.polygonBoundarySelect);c.setSelectMode(this.selectMode);c.setSpatialRelation(this.selectSpatialRelationMode);if(null==this.fieldSets||0>=this.fieldSets.length){var d=this.map.getLayers().toLayerArray();this.fieldSets=[];for(var e=0;e<d.length;e++)this.fieldSets.push(new McxFieldSet(d[e],null))}d=[];for(e=0;e<this.fieldSets.length;e++){var f=
this.fieldSets[e];b=f.getLayer();b.getVisible()&&this.map.inVisibleRange(b.getMinScale(),b.getMaxScale())&&b.isSelectable()&&d.push(f)}if(0>=f.length)this.map.getRenderer().paintNonLayer();else{c.setFieldSets(d);this.initialRequestedLayers=[];for(f=0;f<c.getFieldSets().length;f++)this.initialRequestedLayers.push(c.getFieldSets()[f].getLayer());this.requestSend+=this.initialRequestedLayers.length;a.setCoordinateSystem(this.map.getCoordinateSystem());c.setGeometry(a);this.selectToolMode==McxSelectToolMode.Fence&&
(f=!1,d=null,d=a.getShell().getPoints()[0],f=a.getShell().getPoints()[1],d=this.base.map.worldToView(d.getX(),d.getY()),f=this.base.map.worldToView(f.getX(),f.getY()),f=d.distanceTo(f)<this.fenceDistance,d=a.getShell().getPoints()[0],f&&(this.hitSelect=!0,f=this.map.worldToView(d.getX(),d.getY()),d=this.selectionBuffer/2,a=this.map.viewToWorld(f.getX()-d,f.getY()-d),b=this.map.viewToWorld(f.getX()+d,f.getY()+d),c.setSpatialRelation(McxSpatialRelation.Intersects),f=Math.min(a.getX(),b.getX()),d=Math.min(a.getY(),
b.getY()),e=Math.max(a.getX(),b.getX()),a=Math.max(a.getY(),b.getY()),a=new McxBounds(f,d,e,a,this.map.getCoordinateSystem()),a=McxFactoryFinder.GeometryFactory(this.map.getCoordinateSystem()).createPolygon(a,null),c.setGeometry(a)));this.onFilterCreated(new McxFilterEventArgs(c,null));a=new McxAjaxParameter;a.setParameters(this,this.onSelectFeaturesSuccess,this.selectFeaturesFail);this.featureSelectionStartedEventHandler.dispatchOnSuccess(this,null);(new McxSelectionHelper).hitTest(a,c)}};
McxSelectController.prototype.getSelectionStartedEventHandler=function(){return this.featureSelectionStartedEventHandler};McxSelectController.prototype.getSelectionCompletedEventHandler=function(){return this.featureSelectionCompletedEventHandler};McxSelectController.prototype.isInstanceOf=function(a){return McxSelectController.superClass_.isInstanceOf.call(this,a)||"IMcxSelectController"==a||"McxSelectController"==a};
McxSelectController.prototype.setSelectionBuffer=function(a){this.selectionBuffer=a};McxSelectController.prototype.getSelectionBuffer=function(){return this.selectionBuffer};McxSelectController.prototype.getLayers=function(){return this.layers};McxSelectController.prototype.setApplyMode=function(a){this.canSet&&(this.applyMode=a)};McxSelectController.prototype.setSelectMode=function(a){this.canSet&&(this.selectMode=a)};
McxSelectController.prototype.setSelectToolMode=function(a){this.canSet&&(this.selectToolMode=a)};McxSelectController.prototype.setSpatialRelationMode=function(a){this.canSet&&(this.selectSpatialRelationMode=a)};McxSelectController.prototype.setterEnabled=function(a){this.canSet=a};McxSelectController.prototype.setHoverUse=function(a){this.useHover=a};McxSelectController.prototype.onFilterCreated=function(a){};
McxSelectController.prototype.onMouseMove=function(a){if(null!=this.map){this.mouseCoordinateOnScreen=new McxPoint(a.getX(),a.getY(),null);var b=this.map.viewToWorld(a.getX(),a.getY());this.cursorPosition=b;this.enableBufferCursor&&this.map.getRenderer().paintNonLayer();if(this.useHover){clearTimeout(this.alertTimerId);var c=this,d=new McxPoint(a.getX(),a.getY(),null);this.alertTimerId=setTimeout(function(){var a=c.findHoverFeature(d);null==a?(c.hoverGeometry=null,c.hoverFeatureId=-1):c.hoverGeometry=
a.transformTo(c.map.getCoordinateSystem());c.map.getRenderer().paintNonLayer()},10)}if(this.selectToolMode==McxSelectToolMode.Fence){if("left"!=a.getButton()||!this.started||this.endCoordinate&&this.endCoordinate.equals(b))return;this.endCoordinate=b}this.map.getRenderer().paintNonLayer()}};
McxSelectController.prototype.onMouseUp=function(a){if(null!=this.map&&this.selectToolMode==McxSelectToolMode.Fence&&"left"==a.getButton()&&this.started){this.map.getRenderer().paintNonLayer();this.endCoordinate=this.map.viewToWorld(a.getX(),a.getY());a=Math.min(this.startCoordinate.getX(),this.endCoordinate.getX());var b=Math.min(this.startCoordinate.getY(),this.endCoordinate.getY()),c=Math.max(this.startCoordinate.getX(),this.endCoordinate.getX()),d=Math.max(this.startCoordinate.getY(),this.endCoordinate.getY());
a=new McxBounds(a,b,c,d,this.map.getCoordinateSystem());a=McxFactoryFinder.GeometryFactory(this.map.getCoordinateSystem()).createPolygon(a,null);this.drawingCompleted(a);this.endCoordinate=this.startCoordinate=null;this.started=!1;this.map.getRenderer().paintNonLayer()}};
McxSelectController.prototype.onMouseDown=function(a){if(null!=this.map){McxSelectController.superClass_.onMouseDown.call(this,a);var b=this.map.viewToWorld(a.getX(),a.getY());if(this.selectToolMode==McxSelectToolMode.Fence)"left"==a.getButton()&&(this.startCoordinate=b,this.started=!0);else if(this.selectToolMode==McxSelectToolMode.Circle)if(null==this.origin)this.origin=b;else{a=(this.origin.getX()+b.getX())/2;var c=(this.origin.getY()+b.getY())/2;a=McxFactoryFinder.GeometryFactory(null).createPoint(a,
c);b=Math.sqrt(Math.pow(this.origin.getX()-b.getX(),2)+Math.pow(this.origin.getY()-b.getY(),2))/2;b=McxFactoryFinder.GeometryFactory(null).createEllipse(a.getX(),a.getY(),b,b);b=McxFactoryFinder.GeometryFactory(null).createPolygon(b,null);this.cursorPosition=this.origin=null;this.drawingCompleted(b)}else if(this.selectToolMode==McxSelectToolMode.LineString||this.selectToolMode==McxSelectToolMode.Polygon)"right"==a.getButton()?(this.selectToolMode==McxSelectToolMode.LineString?b=McxFactoryFinder.GeometryFactory(this.map.getCoordinateSystem()).createLineString(this.points):
(this.points.push(this.points[0]),b=McxFactoryFinder.GeometryFactory(this.map.getCoordinateSystem()).createLinearRing(this.points),b=McxFactoryFinder.GeometryFactory(this.map.getCoordinateSystem()).createPolygon(b,null)),this.drawingCompleted(b),this.points=[]):this.points.push(b)}};
McxSelectController.prototype.paint=function(a){if(null!=this.map){if(null!=this.mouseCoordinateOnScreen&&this.enableBufferCursor){a.getGeodeticGraphics().useTransform(!1);var b=new McxPoint(this.mouseCoordinateOnScreen.getX()-this.selectionBuffer/2,this.mouseCoordinateOnScreen.getY()-this.selectionBuffer/2,null),c=new McxPoint(this.mouseCoordinateOnScreen.getX()+this.selectionBuffer/2,this.mouseCoordinateOnScreen.getY()+this.selectionBuffer/2,null);a.getGeodeticGraphics().drawRectangle(b,c,this.cursorPolygonSymbolizer,
1);a.getGeodeticGraphics().useTransform(!0)}if(this.useHover&&null!=this.hoverGeometry){a.getGeodeticGraphics().useTransform(!1);if(this.hoverGeometry.isInstanceOf(McxGeometryType.MultiPolygon))for(c=this.hoverGeometry,b=0;b<c.getPolygons().length;b++)a.getGeodeticGraphics().drawPolygon(c.getPolygons()[b].getShell().getPoints(),this.hoverSymbolizer.getPolygonSymbolizer(),1,0,0);else if(this.hoverGeometry.isInstanceOf(McxGeometryType.Polygon))b=this.hoverGeometry,a.getGeodeticGraphics().drawPolygon(b.getShell().getPoints(),
this.hoverSymbolizer.getPolygonSymbolizer(),1,0,0);else if(this.hoverGeometry.isInstanceOf(McxGeometryType.LineString))b=this.hoverGeometry,a.getGeodeticGraphics().drawLineString(b.getPoints(),this.hoverSymbolizer.getLineSymbolizer(),1,0,0);else if(this.hoverGeometry.isInstanceOf(McxGeometryType.MultiLineString))for(c=this.hoverGeometry,b=0;b<c.getLines().length;b++)a.getGeodeticGraphics().drawLineString(c.getLines()[b].getPoints(),this.hoverSymbolizer.getLineSymbolizer(),1,0,0);else this.hoverGeometry.isInstanceOf(McxGeometryType.Point)&&
(b=this.hoverGeometry,a.getGeodeticGraphics().drawPoint(b,this.hoverSymbolizer.getPointSymbolizer(),1,0,0));a.getGeodeticGraphics().useTransform(!0)}this.selectToolMode==McxSelectToolMode.Circle?null==this.origin||this.origin.equals(this.cursorPosition)||null==this.polygonSymbolizer||(b=(this.origin.getX()+this.cursorPosition.getX())/2,c=(this.origin.getY()+this.cursorPosition.getY())/2,b=new McxPoint(b,c,null),c=Math.sqrt(Math.pow(this.origin.getX()-this.cursorPosition.getX(),2)+Math.pow(this.origin.getY()-
this.cursorPosition.getY(),2))/2,b=McxFactoryFinder.GeometryFactory(null).createEllipse(b.getX(),b.getY(),c,c),a.getGeodeticGraphics().drawPolygon(b.getPoints(),this.polygonSymbolizer,1,0,0)):this.selectToolMode==McxSelectToolMode.LineString?0>=this.points.length||(b=[],b=b.concat(this.points),b.push(this.cursorPosition),a.getGeodeticGraphics().drawLineString(b,this.lineSymbolizer,1,0,0)):this.selectToolMode==McxSelectToolMode.Polygon?null!=this.points&&1<=this.points.length&&(b=[],b=b.concat(this.points),
b.push(this.cursorPosition),a.getGeodeticGraphics().drawPolygon(b,this.polygonSymbolizer,1,0,0)):this.selectToolMode==McxSelectToolMode.Fence&&this.started&&null!=this.startCoordinate&&null!=this.endCoordinate&&(this.canSet||(this.startCoordinate.getX()<this.endCoordinate.getX()?this.selectSpatialRelationMode=McxSpatialRelation.Contains:this.selectSpatialRelationMode=McxSpatialRelation.Intersects),a.getGeodeticGraphics().drawRectangle(this.startCoordinate,this.endCoordinate,this.polygonSymbolizer,
1))}};
McxSelectController.prototype.onTap=function(a){this.selectToolMode=McxSelectToolMode.Fence;this.startCoordinate=this.map.viewToWorld(a.getX(),a.getY());this.endCoordinate=this.map.viewToWorld(a.getX(),a.getY());a=Math.min(this.startCoordinate.getX(),this.endCoordinate.getX());var b=Math.min(this.startCoordinate.getY(),this.endCoordinate.getY()),c=Math.max(this.startCoordinate.getX(),this.endCoordinate.getX()),d=Math.max(this.startCoordinate.getY(),this.endCoordinate.getY());a=new McxBounds(a,b,c,
d,this.map.getCoordinateSystem());a=McxFactoryFinder.GeometryFactory(this.map.getCoordinateSystem()).createPolygon(a,null);this.drawingCompleted(a);this.endCoordinate=this.startCoordinate=null;this.started=!1;this.map.getRenderer().paintNonLayer()};McxSelectController.prototype.onDoubleTap=function(a){};McxSelectController.prototype.onPinchIn=function(a){};McxSelectController.prototype.onPinchOut=function(a){};McxSelectController.prototype.onSwipe=function(a){};
McxSelectController.prototype.onSwipeLeft=function(a){};McxSelectController.prototype.onSwipeRight=function(a){};McxSelectController.prototype.onSwipeUp=function(a){};McxSelectController.prototype.onSwipeDown=function(a){};McxSelectController.prototype.onRotate=function(a){};McxSelectController.prototype.onDragStart=function(a){};McxSelectController.prototype.onDragEnd=function(a){};McxSelectController.prototype.onDrag=function(a){};McxSelectController.prototype.onKeyPress=function(a){};
McxSelectController.prototype.onKeyUp=function(a){};McxSelectController.prototype.onKeyDown=function(a){};
McxSelectController.prototype.findHoverFeature=function(a){var b=this.map.getLayers().getActiveLayer();if(!b.getVisible()||!this.map.inVisibleRange(b.getMinScale(),b.getMaxScale()))return null;var c=this.map.getPaintedFeatures(b),b=McxFactoryFinder.GeometryFactory(this.map.getCoordinateSystem()).createBounds(a.getX()-1,a.getY()-1,a.getX()+1,a.getY()+1),b=McxFactoryFinder.GeometryFactory(this.map.getCoordinateSystem()).createPolygon(b,null),d=McxFactoryFinder.GeometryFactory(null).createBounds(a.getX()-
10,a.getY()-10,a.getX()+10,a.getY()+10),d=McxFactoryFinder.GeometryFactory(null).createPolygon(d,null);if(null==c)return null;var c=c.getAll(),e;for(e in c){var f=c[e];if(null!=f&&(f=this.map.geometryToView(f),f.isInstanceOf(McxGeometryType.Point)||f.isInstanceOf(McxGeometryType.MultiPoint)||f.getBounds().intersectsBounds(a.getBounds())))if(this.hoverFeatureId=parseInt(e,10),f.isInstanceOf(McxGeometryType.Polygon)){var g=f,g=g.containsPoint(a);if("number"==typeof g||g)return f}else if(f.isInstanceOf(McxGeometryType.MultiPolygon))for(var h=
f,k=0;k<h.getPolygons().length;k++){if(g=h.getPolygons()[k],g=g.containsPoint(a),"number"==typeof g||g)return f}else if(f.isInstanceOf(McxGeometryType.LineString)){if(f.intersects(b))return f}else if(f.isInstanceOf(McxGeometryType.MultiLineString))for(h=f.getLines(),k=0;k<h.length;k++){if(h[k].intersects(b))return f}else if(f.isInstanceOf(McxGeometryType.Point)&&d.containsPoint(f))return f}this.hoverFeatureId=-1;return null};
McxSelectController.prototype.useBufferCursor=function(a){a?this.base.setCursor(McxCursors.none):this.base.setCursor(McxCursors.selectFeature);this.enableBufferCursor=a};js.builtin.McxSelection.Controller.McxIdentifyController={};function McxIdentifyController(){mcx.base(this);this.base=this;this.base.applyMode=McxApplyMode.None;this._featureBalloon=new McxFeatureBalloon;this.base.setHoverUse(!0);this.base.useBufferCursor(!1);this.base.setSelectToolMode(McxSelectToolMode.Fence);this.centroid=this.featureExplorerDialog=null}mcx.inherits(McxIdentifyController,McxSelectController);
McxIdentifyController.prototype.onSelectFeaturesFailed=function(a){a=a.getArgs();var b=a.getValue("totalFieldSetCount"),c=a.getValue("fieldSetCounter"),d=a.getValue("features");c++;b==c?(this.featureExplorerDialog.getFeatureExplorer().addFeatures(d),this.featureExplorerDialog.setAsIdle()):a.setValue("fieldSetCounter",c);this.base.selectFeaturesFail()};
McxIdentifyController.prototype.onSelectFeaturesSuccess=function(a){var b=a.getArgs(),c=b.getValue("totalFieldSetCount"),d=b.getValue("fieldSetCounter"),e=b.getValue("features");d++;a=a.getFeatures();if(null!=a&&0<a.length){for(var f=0;f<a.length;f++){var g=a[f];if(void 0==g.getGeometry()){var h=g.getLayer(),h=this.base.map.getPaintedFeatures(h);g.setGeometry(h.getElementWithIndex(g.getFeatureID()))}}e=e.concat(a)}c==d?(this.featureExplorerDialog.getFeatureExplorer().addFeatures(e),this.featureExplorerDialog.setAsIdle()):
(b.setValue("fieldSetCounter",d),b.setValue("features",e))};McxIdentifyController.prototype.getFields=function(a){var b=!0,c=[a.getKeyField()];a=a.getLabelFormat();if(null==a)return c;for(;1==b;){var d=a.match(/\[(.*?)\]/);null==d?b=!1:(c.push(d[1]),a=a.replace(d[0],""))}return c};McxIdentifyController.prototype.showFeatureExplorerDialog=function(){this.featureExplorerDialog.showDialog()};
McxIdentifyController.prototype.setIdentifyOption=function(a){0==this.featureExplorerDialog.getIsShown()&&this.showFeatureExplorerDialog();var b=new McxSelectFilter;b.setGeometryTypes(this.base.geometryTypes);b.setPolygonBoundarySelect(this.base.polygonBoundarySelect);b.setSelectMode(this.base.selectMode);b.setSpatialRelation(this.base.selectSpatialRelationMode);var c=this.base.map.getLayers();a=a||new McxKeyValuePair(null,null);if(mcx.isInstanceOf(a,McxKeyValuePair))if(a=a.getKey(),null==a||0==a){a=
c.getActiveLayer();if(a.isInstanceOf("McxTileLayer")||a.isInstanceOf("McxCacheLayer")||a.isInstanceOf("McxOrthophotoLayer"))return null;c=this.getFields(a);this.base.fields=c;c=new McxFieldSet(a,this.base.fields);b.setFieldSets([c])}else if(1==a){a=c.getAt(c.getCount()-1);if(a.isInstanceOf("McxTileLayer")||a.isInstanceOf("McxCacheLayer")||a.isInstanceOf("McxOrthophotoLayer"))return null;c=this.getFields(a);this.base.fields=c;c=new McxFieldSet(a,this.base.fields);b.setFieldSets([c])}else if(2==a){var d=
[];a=[];for(var e=0;e<c.getCount();e++){var f=c.getAt(e);f.isInstanceOf("McxTileLayer")||f.isInstanceOf("McxCacheLayer")||f.isInstanceOf("McxOrthophotoLayer")||f.isSelectable()&&d.push(f)}for(e=0;e<d.length;e++)c=this.getFields(d[e]),a.push(new McxFieldSet(d[e],c));b.setFieldSets(a)}else if(3==a){d=[];a=[];for(e=0;e<c.getCount();e++)f=c.getAt(e),f.isInstanceOf("McxTileLayer")||f.isInstanceOf("McxCacheLayer")||f.isInstanceOf("McxOrthophotoLayer")||f.getVisible()&&this.base.map.inVisibleRange(f.getMinScale(),
f.getMaxScale())&&d.push(f);for(e=0;e<d.length;e++)c=this.getFields(d[e]),a.push(new McxFieldSet(d[e],c));b.setFieldSets(a)}else{if(4==a){d=[];a=[];for(e=0;e<c.getCount();e++)f=c.getAt(e),f.isInstanceOf("McxTileLayer")||f.isInstanceOf("McxCacheLayer")||f.isInstanceOf("McxOrthophotoLayer")||this.base.map.inVisibleRange(f.getMinScale(),f.getMaxScale())&&d.push(f);for(e=0;e<d.length;e++)c=this.getFields(d[e]),a.push(new McxFieldSet(d[e],c));b.setFieldSets(a)}}else if(void 0!=a.isInstanceOf&&(a.isInstanceOf("McxFsLayer")||
a.isInstanceOf("McxMemLayer")))c=this.getFields(a),this.base.fields=c,c=new McxFieldSet(a,this.base.fields),b.setFieldSets([c]);else if(void 0!=a.isInstanceOf&&(a.isInstanceOf("McxTileLayer")||a.isInstanceOf("McxCacheLayer")||a.isInstanceOf("McxOrthophotoLayer")))return null;return b};McxIdentifyController.prototype.onStartInteraction=function(){McxIdentifyController.superClass_.onStartInteraction.call(this);this.featureExplorerDialog=new McxFeatureExplorerDialog(this.base.map);this.featureExplorerDialog.setMapInteractionFactory(new McxMapInteractionFactory)};
McxIdentifyController.prototype.onEndInteraction=function(){McxIdentifyController.superClass_.onEndInteraction.call(this);this.base.map.getRenderer().paintNonLayer()};
McxIdentifyController.prototype.drawingCompleted=function(a){this.centroid=a.getBounds().getCentroid();a.getBounds();this.base.map.worldToView(this.centroid.getX(),this.centroid.getY());var b;if(null==this.base.layers||0>=this.base.layers.length)this.base.layers=this.base.map.getLayers().toLayerArray();this.base.fields=[];var c=this.featureExplorerDialog.getFeatureExplorer().getIdentifyOption(),c=this.setIdentifyOption(c);if(null!=c){this.base.initialRequestedLayers=[];for(var d=0;d<c.getFieldSets().length;d++)this.base.initialRequestedLayers.push(c.getFieldSets()[d]);
this.base.requestSend+=this.base.initialRequestedLayers.length;a.setCoordinateSystem(this.base.map.getCoordinateSystem());c.setGeometry(a);var d=!1,e=null,d=a.getShell().getPoints()[0].equals(a.getShell().getPoints()[1]),e=a.getShell().getPoints()[0];if(d){this.base.hitSelect=!0;d=this.base.map.worldToView(e.getX(),e.getY());e=this.selectionBuffer/2;a=this.base.map.viewToWorld(d.getX()-e,d.getY()-e);b=this.base.map.viewToWorld(d.getX()+e,d.getY()+e);var d=Math.min(a.getX(),b.getX()),e=Math.min(a.getY(),
b.getY()),f=Math.max(a.getX(),b.getX());a=Math.max(a.getY(),b.getY());a=new McxBounds(d,e,f,a,this.base.map.getCoordinateSystem());a=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createPolygon(a,null);c.setGeometry(a)}this.base.onFilterCreated(new McxFilterEventArgs(c,null));a=new McxAjaxParameter;a.setParameters(this,this.onSelectFeaturesSuccess,this.onSelectFeaturesFailed);d=new McxDictionary;d.setValue("totalFieldSetCount",c.getFieldSets().length);d.setValue("fieldSetCounter",
0);d.setValue("features",[]);d.setValue("map",this.base.map);a.setArgs(d);this.base.featureSelectionStartedEventHandler.dispatchOnSuccess(this,null);d=new McxSelectionHelper;this.featureExplorerDialog.setAsBusy();d.hitTest(a,c);this.base.map.getRenderer().paintNonLayer()}};McxIdentifyController.prototype.isInstanceOf=function(a){return McxIdentifyController.superClass_.isInstanceOf.call(this,a)||"IMcxSelectController"==a||"McxIdentifyController"==a};
McxIdentifyController.prototype.getFeatureBalloon=function(){this._featureBalloon.setTitle("WMS INFO");return this._featureBalloon};js.builtin.McxSelection.Controller.McxSelectCopyController={};function McxSelectCopyController(){mcx.base(this);this._dialog=null;this.base=this;this._copySuccessEventHandler=new McxEventHandler}mcx.inherits(McxSelectCopyController,McxSelectController);McxSelectCopyController.prototype.onStartInteraction=function(){McxSelectCopyController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxEditAddon-ChangeLayerDescription")};
McxSelectCopyController.prototype.onMouseDown=function(a){McxSelectCopyController.superClass_.onMouseDown.call(this,a);"right"==a.getButton()&&this.selectionCompleted()};
McxSelectCopyController.prototype.selectionCompleted=function(){function a(){McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections()}var b=McxMapHelper.getSelectableLayers(this.base.map);this._dialog=new McxSelectCopyDialog(b);this._dialog.showDialog(!1,!0);this._dialog.getCloseButtonClickHandler().addListener(a,null,this);this._dialog.getCancelButtonClickHandler().addListener(a,null,this);this._dialog.getSubmitHandler().addListener(this.copySelection,
null,this)};
McxSelectCopyController.prototype.copySelection=function(a){a.setIsValidated(!1);a=McxSelectionHelper.instance.getSelection(this.base.map);a=McxFeatureHelper.instance.groupByLayer(a);var b=this._dialog.getSourceLayer(),c=this._dialog.getTargetLayer(),d=this._dialog.getDeleteSelectionStatus(),e=new McxAjaxParameter;e.setParameters(this,this.insertSuccess,this.commitFail);(new McxAjaxParameter).setParameters(this,this.updateSuccess,this.updateFail);var f=new McxAjaxParameter;f.setParameters(this,this.deleteSuccess,
this.commitFail);for(var g=0;g<a.length;g++)if(null==b||a[g].getLayer().getName()==b.getName())if(McxGeometryHelper.instance.checkLayerGeometryTypesEquivalence(c.getGeometryType(),a[g].getLayer().getGeometryType())){var h=a[g].getFeatures(),k=a[g].getLayer().createEdit();d&&k.deleteFeatureRange(h,f);McxFactoryFinder.GeometryFactory(c.getCoordinateSystem());for(var m=0;m<h.length;m++){var n=h[m],p=McxGeometryHelper.instance.createGeometryWithType(n.getGeometry(),c.getGeometryType(),c.getCoordinateSystem());
n.setGeometry(p);var q=c.createFeatureBuffer();q.setGeometry(p);q.setSymbolizer(n.getSymbolizer());k.insert(q,e)}}else McxMessageBox.show("Data",McxLocalizationManager.getLocaleValue("McxSelection-GeometryTypeError"),McxMessageBoxType.Error)};McxSelectCopyController.prototype.insertSuccess=function(a){a=McxFeatureHelper.instance.getBB(a.getFeatures());this.base.map.getRenderer().paintLayer(null,a);this._copySuccessEventHandler.dispatchOnSuccess(this,null)};
McxSelectCopyController.prototype.updateSuccess=function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxSelection-Completed"));this._copySuccessEventHandler.dispatchOnSuccess(this,null)};
McxSelectCopyController.prototype.deleteSuccess=function(a){a=McxFeatureHelper.instance.getBB(a.getFeatures());this.base.map.getRenderer().paintLayer(null,a);McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();this._copySuccessEventHandler.dispatchOnSuccess(this,null)};McxSelectCopyController.prototype.commitFail=function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxSelection-ErrorOccurred"),McxMessageBoxType.Error)};
McxSelectCopyController.prototype.updateFail=function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxSelection-ErrorOccurred"),McxMessageBoxType.Error)};McxSelectCopyController.prototype.getCopySuccessEventHandler=function(){return this._copySuccessEventHandler};js.builtin.McxSelection.Controller.McxSelectOnActiveLayerController={};function McxSelectOnActiveLayerController(){mcx.base(this);this.base=this;this.base.canSet=!1;this.base.applyMode=McxApplyMode.Select;this.base.selectToolMode=McxSelectToolMode.Fence;this.base.layers=[]}mcx.inherits(McxSelectOnActiveLayerController,McxSelectController);
McxSelectOnActiveLayerController.prototype.onStartInteraction=function(){McxSelectOnActiveLayerController.superClass_.onStartInteraction.call(this);this.base.map.getLayers().onActiveLayerChanged().addListener(function(){var a=this.map.getLayers().getActiveLayer();this.base.layers=[];this.base.layers.push(a)},null,this);var a=this.base.map.getLayers().getActiveLayer(),a=new McxFieldSet(a,""),b=this.base.canSet;this.base.canSet=!0;this.base.setLayersAndFields(a);this.base.canSet=b;McxSelectOnActiveLayerController.superClass_.onStartInteraction.call(this)};js.builtin.McxSelection.Dialog={};js.builtin.McxSelection.Dialog.SelectCopyDialog={};js.builtin.McxSelection.Dialog.SelectCopyDialog.McxSelectCopyDialog={};
function McxSelectCopyDialog(a){mcx.base(this);this.base=this;this._targetLayer=this._sourceLayer=this._sourceLayerSelectBox=this._rootElement=null;this._sourceName="sourceField";this._targetName="targetField";this._selectedFeatureCountSpan=$("<span/>");this._layerCollection=a;this._deleteSelectionCheck=this._targetLayerSelectBox=null;this._columnGridContainer=$("<div/>");this._columnGrid=new McxDataGrid}mcx.inherits(McxSelectCopyDialog,McxDialogBase);
McxSelectCopyDialog.prototype.getIsSingleInstance=function(){return!0};McxSelectCopyDialog.prototype.getDialogSize=function(){return McxDialogSize.medium};McxSelectCopyDialog.prototype.initialize=function(){this.initializeUiControls()};
McxSelectCopyDialog.prototype.initializeUiControls=function(){this._rootElement=$("<div/>");this._sourceLayerSelectBox=new McxSelectBox;this._sourceLayerSelectBox.addCustomItem(McxLocalizationManager.getLocaleValue("McxSelection-AllLayers"),"all");for(var a=0;a<this._layerCollection.length;a++)this._sourceLayerSelectBox.addCustomItem(this._layerCollection[a].getName(),this._layerCollection[a].getName());this._sourceLayerSelectBox.getOnSelectHandler().addListener(this.sourceLayerChanged,null,this);
var a=new McxLayoutRow,b=$("<span/>").attr("data-localize","McxSelection-EditAddonSourceLayer").addClass("");a.createAndAddSpan(4,b);a.createAndAddSpan(8,this._sourceLayerSelectBox);this.base.addChild(this._rootElement,a);a=new McxLayoutRow;b=$("<span/>").attr("data-localize","McxSelection-EditAddonFeatureCount").addClass("");a.createAndAddSpan(4,b);a.createAndAddSpan(8,this._selectedFeatureCountSpan);this.base.addChild(this._rootElement,a);this._targetLayerSelectBox=new McxSelectBox;this._targetLayerSelectBox.setTextGetter("getName");
this._targetLayerSelectBox.setValueGetter("getName");this._targetLayerSelectBox.addItemRange(this._layerCollection);this._targetLayerSelectBox.getOnSelectHandler().addListener(this.targetLayerChanged,null,this);a=new McxLayoutRow;b=$("<span/>").attr("data-localize","McxSelection-EditAddonTargetLayer").addClass("");a.createAndAddSpan(4,b);a.createAndAddSpan(8,this._targetLayerSelectBox);this.base.addChild(this._rootElement,a);this._targetLayer=this._targetLayerSelectBox.getSelectedItem();a=new McxLayoutRow;
b=$("<span/>").attr("data-localize","McxSelection-EditAddonDeleteSelection").addClass("");this._deleteSelectionCheck=new McxCheckBox;a.createAndAddSpan(4,b);a.createAndAddSpan(8,this._deleteSelectionCheck.getContent());this.base.addChild(this._rootElement,a);this._rootElement.append(this._columnGridContainer);this._columnGridContainer.css("border-width","1px").css("height","400px").addClass("");this.createColumnDataGrid()};McxSelectCopyDialog.prototype.getDialogTitle=function(){return McxLocalizationManager.getLocaleValue("McxSelection-CopyToLayer")};
McxSelectCopyDialog.prototype.getLocalizationPath=function(){return"$McxSelection/assets/locale/mcxSelection"};McxSelectCopyDialog.prototype.getContent=function(){return this._rootElement};
McxSelectCopyDialog.prototype.sourceLayerChanged=function(){if(mcx.isDefAndNotNull(this._sourceLayerSelectBox.getSelectedValue())){var a=this._sourceLayerSelectBox.getSelectedValue();if("all"==a)this._sourceLayer=null,this._selectedFeatureCountSpan.html("0"),this._columnGridContainer.empty();else{for(var b=0;b<this._layerCollection.length;b++)this._layerCollection[b].getName()==a&&(this._sourceLayer=this._layerCollection[b]);a=this._sourceLayer.getSelectionCount();this._selectedFeatureCountSpan.html(a.toString()+
" ");this.createColumnDataGrid()}}else this._sourceLayer=null,this._selectedFeatureCountSpan.html("0"),this._columnGridContainer.empty()};McxSelectCopyDialog.prototype.targetLayerChanged=function(){this._targetLayer=this._targetLayerSelectBox.getSelectedItem();this.createColumnDataGrid()};McxSelectCopyDialog.prototype.getSourceLayer=function(){return this._sourceLayer};McxSelectCopyDialog.prototype.getTargetLayer=function(){return this._targetLayer};
McxSelectCopyDialog.prototype.getDeleteSelectionStatus=function(){return this._deleteSelectionCheck.isChecked()};
McxSelectCopyDialog.prototype.createColumnDataGrid=function(){this._columnGridContainer.empty();if(null!=this._sourceLayer){for(var a=[],b=0;b<this._targetLayer.getSchema().getFieldCount();b++){var c=this._targetLayer.getSchema().getField(b),d=c.getFieldName(),e=c.getFieldType();"featureid"!=d.toLowerCase()&&"globalid"!=d.toLowerCase()&&"geometry"!=d.toLowerCase()&&(c={},c[this._targetName]=d,e=this.getEquivalentColumns(e,d),c[this._sourceName]=0==e.length?"":e[0],c.defaultValue="",a.push(c))}d=[];
for(b=0;b<this._sourceLayer.getSchema().getFieldCount();b++)e=this._sourceLayer.getSchema().getField(b),"geometry"!=e.getFieldName().toLowerCase()&&(c={name:e.getAlias(),value:e.getFieldName()},d.push(c));b=McxLocalizationManager.getLocaleValue("McxSelection-DefaultValue");this._columnGrid.addColumn((new McxStringColumn(this._targetLayer.getName())).bindField(this._targetName).isEditable(!1));this._columnGrid.addColumn((new McxSelectBoxColumn(this._sourceLayer.getName())).setSelectBoxParams(d,"value",
"name").bindField(this._sourceName).isEditable(!0));this._columnGrid.addColumn((new McxStringColumn(b)).bindField("defaultValue").isEditable(!0));this._columnGrid.getRowChangeHandler().addListener(this.afterRowEdited,null,this);this._columnGrid.getRowSelectHandler().addListener(this.onRowClicked,null,this);this._columnGrid.setIsEditable(!0);this._columnGrid.setHeight(250);this._columnGrid.setDataSource(new McxDataGridArrayDataSource(a));this._columnGrid.fitColumns();this._columnGrid.stretch();this._columnGridContainer.append(this._columnGrid.getContent())}};
McxSelectCopyDialog.prototype.getFieldNameArray=function(){return this._columnGrid.getData()};McxSelectCopyDialog.prototype.afterRowEdited=function(a){a=a.getRow();var b=a.getItem(),c=this._targetLayer.getSchema().getField(b[this._targetName]).getFieldType();null==McxFieldDefinition.tryChangeType(b.defaultValue,c)&&(b.defaultValue="",a.setItem(b))};
McxSelectCopyDialog.prototype.onRowClicked=function(a){a=a.getRow();var b=a.getItem();this._sourceLayer.getSchema().getField(b[this._sourceName]);b=this._targetLayer.getSchema().getField(b[this._targetName]);null==b?a.finishEditing():this.getEquivalentColumns(b.getFieldType())};
McxSelectCopyDialog.prototype.getEquivalentColumns=function(a,b){var c=[];switch(a){case McxDataType.Int16:if(mcx.isDefAndNotNull(b)){var d=this._sourceLayer.getSchema().getField(b.toString());if(null!=d){var e=d.getFieldType();if(e==McxDataType.Int16)return[d.getFieldName()]}break}for(d=0;d<this._sourceLayer.getSchema().getFieldCount();d++)e=this._sourceLayer.getSchema().getField(d).getFieldType(),e==McxDataType.Int16&&(e={name:this._sourceLayer.getSchema().getField(d).getFieldName(),value:this._sourceLayer.getSchema().getField(d).getFieldName()},
c.push(e));break;case McxDataType.Int32:if(mcx.isDefAndNotNull(b)){d=this._sourceLayer.getSchema().getField(b.toString());if(null!=d&&(e=d.getFieldType(),e==McxDataType.Int16||e==McxDataType.Int32))return[d.getFieldName()];break}for(d=0;d<this._sourceLayer.getSchema().getFieldCount();d++)if(e=this._sourceLayer.getSchema().getField(d).getFieldType(),e==McxDataType.Int16||e==McxDataType.Int32)e={name:this._sourceLayer.getSchema().getField(d).getFieldName(),value:this._sourceLayer.getSchema().getField(d).getFieldName()},
c.push(e);break;case McxDataType.Int64:if(mcx.isDefAndNotNull(b)){d=this._sourceLayer.getSchema().getField(b.toString());if(null!=d&&(e=d.getFieldType(),e==McxDataType.Int16||e==McxDataType.Int32||e==McxDataType.Int64))return[d.getFieldName()];break}for(d=0;d<this._sourceLayer.getSchema().getFieldCount();d++)if(e=this._sourceLayer.getSchema().getField(d).getFieldType(),e==McxDataType.Int16||e==McxDataType.Int32||e==McxDataType.Int64)e={name:this._sourceLayer.getSchema().getField(d).getFieldName(),
value:this._sourceLayer.getSchema().getField(d).getFieldName()},c.push(e);break;case McxDataType.Float:if(mcx.isDefAndNotNull(b)){d=this._sourceLayer.getSchema().getField(b.toString());if(null!=d&&(e=d.getFieldType(),e==McxDataType.Int16||e==McxDataType.Int32||e==McxDataType.Int64||e==McxDataType.Float))return[d.getFieldName()];break}for(d=0;d<this._sourceLayer.getSchema().getFieldCount();d++)if(e=this._sourceLayer.getSchema().getField(d).getFieldType(),e==McxDataType.Int16||e==McxDataType.Int32||
e==McxDataType.Int64||e==McxDataType.Float)e={name:this._sourceLayer.getSchema().getField(d).getFieldName(),value:this._sourceLayer.getSchema().getField(d).getFieldName()},c.push(e);break;case McxDataType.Double:if(mcx.isDefAndNotNull(b)){d=this._sourceLayer.getSchema().getField(b.toString());if(null!=d&&(e=d.getFieldType(),e==McxDataType.Int16||e==McxDataType.Int32||e==McxDataType.Int64||e==McxDataType.Double))return[d.getFieldName()];break}for(d=0;d<this._sourceLayer.getSchema().getFieldCount();d++)if(e=
this._sourceLayer.getSchema().getField(d).getFieldType(),e==McxDataType.Int16||e==McxDataType.Int32||e==McxDataType.Int64||e==McxDataType.Double)e={name:this._sourceLayer.getSchema().getField(d).getFieldName(),value:this._sourceLayer.getSchema().getField(d).getFieldName()},c.push(e);break;case McxDataType.String:if(mcx.isDefAndNotNull(b)){d=this._sourceLayer.getSchema().getField(b.toString());if(null!=d){e=d.getFieldType();if(e==McxDataType.Object||e==McxDataType.IMcxGeometry)break;return[d.getFieldName()]}break}for(d=
0;d<this._sourceLayer.getSchema().getFieldCount();d++)e=this._sourceLayer.getSchema().getField(d).getFieldType(),e!=McxDataType.Object&&e!=McxDataType.IMcxGeometry&&(e={name:this._sourceLayer.getSchema().getField(d).getFieldName(),value:this._sourceLayer.getSchema().getField(d).getFieldName()},c.push(e));break;case McxDataType.Guid:if(mcx.isDefAndNotNull(b)){d=this._sourceLayer.getSchema().getField(b.toString());if(null!=d&&(e=d.getFieldType(),e==McxDataType.Guid))return[d.getFieldName()];break}for(d=
0;d<this._sourceLayer.getSchema().getFieldCount();d++)e=this._targetLayer.getSchema().getField(d).getFieldType(),e==McxDataType.Guid&&(e={name:this._sourceLayer.getSchema().getField(d).getFieldName(),value:this._sourceLayer.getSchema().getField(d).getFieldName()},c.push(e));break;case McxDataType.Byte:if(mcx.isDefAndNotNull(b)){d=this._sourceLayer.getSchema().getField(b.toString());if(null!=d&&(e=d.getFieldType(),e==McxDataType.Byte))return[d.getFieldName()];break}for(d=0;d<this._sourceLayer.getSchema().getFieldCount();d++)e=
this._sourceLayer.getSchema().getField(d).getFieldType(),e==McxDataType.Byte&&(e={name:this._sourceLayer.getSchema().getField(d).getFieldName(),value:this._sourceLayer.getSchema().getField(d).getFieldName()},c.push(e));break;case McxDataType.Boolean:if(mcx.isDefAndNotNull(b)){d=this._sourceLayer.getSchema().getField(b.toString());if(null!=d&&(e=d.getFieldType(),e==McxDataType.Boolean))return[d.getFieldName()];break}for(d=0;d<this._sourceLayer.getSchema().getFieldCount();d++)e=this._sourceLayer.getSchema().getField(d).getFieldType(),
e==McxDataType.Boolean&&(e={name:this._sourceLayer.getSchema().getField(d).getFieldName(),value:this._sourceLayer.getSchema().getField(d).getFieldName()},c.push(e));break;case McxDataType.DateTime:if(mcx.isDefAndNotNull(b)){d=this._sourceLayer.getSchema().getField(b.toString());if(null!=d&&(e=d.getFieldType(),e==McxDataType.DateTime))return[d.getFieldName()];break}for(d=0;d<this._sourceLayer.getSchema().getFieldCount();d++)e=this._sourceLayer.getSchema().getField(d).getFieldType(),e==McxDataType.DateTime&&
(e={name:this._sourceLayer.getSchema().getField(d).getFieldName(),value:this._sourceLayer.getSchema().getField(d).getFieldName()},c.push(e));break;case McxDataType.IMcxSymbolizer:if(mcx.isDefAndNotNull(b)){d=this._sourceLayer.getSchema().getField(b.toString());if(null!=d&&(e=d.getFieldType(),e==McxDataType.IMcxSymbolizer))return[d.getFieldName()];break}for(d=0;d<this._sourceLayer.getSchema().getFieldCount();d++)e=this._sourceLayer.getSchema().getField(d).getFieldType(),e==McxDataType.IMcxSymbolizer&&
(e={name:this._sourceLayer.getSchema().getField(d).getFieldName(),value:this._sourceLayer.getSchema().getField(d).getFieldName()},c.push(e));break;case McxDataType.Object:if(mcx.isDefAndNotNull(b)){d=this._sourceLayer.getSchema().getField(b.toString());if(null!=d&&(e=d.getFieldType(),e==McxDataType.Object))return[d.getFieldName()];break}for(d=0;d<this._sourceLayer.getSchema().getFieldCount();d++)e=this._sourceLayer.getSchema().getField(d).getFieldType(),e==McxDataType.Object&&(e={name:this._sourceLayer.getSchema().getField(d).getFieldName(),
value:this._sourceLayer.getSchema().getField(d).getFieldName()},c.push(e))}return c};
js.builtin.McxDrawing={};js.builtin.McxDrawing.Action={};js.builtin.McxDrawing.Action.McxFeatureOperationAction={};function McxFeatureOperationAction(){this._insertedFeatures=[];this._deletedFeatures=[];this._updatedFeatures=[];this._preUpdatedFeatures=[];this._name=this._lastActionTime="";this.ajaxParam=this.activeLayer=this.map=null}McxFeatureOperationAction.prototype.AddList=function(a,b,c){var d=b.getLayer().createFeatureBuffer();d.createFromFeature(b);a.push(d);this.ajaxParam=c};
McxFeatureOperationAction.prototype.AddInsertList=function(a,b){for(var c=0;c<a.length;c++)this.AddList(this._insertedFeatures,a[c],b)};McxFeatureOperationAction.prototype.AddDeleteList=function(a,b){for(var c=0;c<a.length;c++)this.AddList(this._deletedFeatures,a[c],b)};McxFeatureOperationAction.prototype.AddUpdateList=function(a,b){for(var c=0;c<a.length;c++)this.AddList(this._updatedFeatures,a[c],b)};McxFeatureOperationAction.prototype.execute=function(a){this.map=a;this.redo()};
McxFeatureOperationAction.prototype.getLastActionTime=function(){return this._lastActionTime};McxFeatureOperationAction.prototype.getName=function(){return this._name};McxFeatureOperationAction.prototype.setName=function(a){this._name=a};
McxFeatureOperationAction.prototype.getInsertedFeatures=function(){for(var a=[],b=0;b<this._insertedFeatures.length;b++){var c=new McxMemFeature(this._insertedFeatures[b].getLayer(),this._insertedFeatures[b].getSchema());c.createFromFeature(this._insertedFeatures[b]);a.push(c)}return a};
McxFeatureOperationAction.prototype.getUpdatedFeatures=function(){for(var a=[],b=0;b<this._updatedFeatures.length;b++){var c=new McxMemFeature(this._updatedFeatures[b].getLayer(),this._updatedFeatures[b].getSchema());c.createFromFeature(this._updatedFeatures[b]);a.push(c)}return a};
McxFeatureOperationAction.prototype.getDeletedFeatures=function(){for(var a=[],b=0;b<this._deletedFeatures.length;b++){var c=(new McxMemFeature(this._deletedFeatures[b].getLayer(),this._deletedFeatures[b].getSchema())).createFromFeature(this._deletedFeatures[b]);a.push(c)}return a};
McxFeatureOperationAction.prototype.undo=function(){for(var a=McxFeatureGroup.groupFeatures(this._insertedFeatures),b=McxFeatureGroup.groupFeatures(this._deletedFeatures),c=McxFeatureGroup.groupFeatures(this._updatedFeatures),d=McxFeatureGroup.groupFeatures(this._preUpdatedFeatures),e=0;e<a.length;e++)for(var f=a[e].getLayer().createEdit(),g=a[e].getFeatures(),h=0;h<g.length;h++)f.delete(g[h].getFeatureID(),this.ajaxParam);for(e=0;e<b.length;e++)for(f=b[e].getLayer().createEdit(),g=b[e].getFeatures(),
h=0;h<g.length;h++)f.insert(g[h],this.ajaxParam);for(e=0;e<c.length;e++){f=c[e].getLayer().createEdit();g=c[e].getFeatures();for(h=0;h<g.length;h++)a=g[h].getLayer().findFeature(g[h].getFeatureID()),this._preUpdatedFeatures.push(a);f.updateRange(c[e].getFeatures(),this.ajaxParam)}for(e=0;e<d.length;e++)for(f=d[e].getLayer().createEdit(),g=d[e].getFeatures(),h=0;h<g.length;h++)f.update(g[h],this.ajaxParam);this._lastActionTime=McxDateTime.now().toString()};
McxFeatureOperationAction.prototype.HasUndo=function(){return!0};McxFeatureOperationAction.prototype.HasRedo=function(){return!0};
McxFeatureOperationAction.prototype.redo=function(){for(var a=McxFeatureGroup.groupFeatures(this._insertedFeatures),b=McxFeatureGroup.groupFeatures(this._deletedFeatures),c=McxFeatureGroup.groupFeatures(this._updatedFeatures),d=McxFeatureGroup.groupFeatures(this._preUpdatedFeatures),e=0;e<a.length;e++)for(var f=a[e].getLayer().createEdit(),g=a[e].getFeatures(),h=0;h<g.length;h++)f.insert(g[h],this.ajaxParam);for(e=0;e<b.length;e++)for(f=b[e].getLayer().createEdit(),g=b[e].getFeatures(),h=0;h<g.length;h++)f.delete(g[h].getFeatureID(),
this.ajaxParam);for(e=0;e<c.length;e++)for(f=c[e].getLayer().createEdit(),g=c[e].getFeatures(),h=0;h<g.length;h++)a=g[h].getLayer().findFeature(g[h].getFeatureID()),this._preUpdatedFeatures.push(a),f.update(g[h],this.ajaxParam);for(e=0;e<d.length;e++)for(f=d[e].getLayer().createEdit(),g=d[e].getFeatures(),h=0;h<g.length;h++)f.update(g[h],this.ajaxParam);this._lastActionTime=McxDateTime.now().toString()};McxFeatureOperationAction.prototype.isInstanceOf=function(a){return"IMcxUndoableAction"==a};js.builtin.McxDrawing.Action.McxSketchUndoableAction={};function McxSketchUndoableAction(){this.points=[];this.removedCoordinates=[];this.addedCoordinates=[];this.map=this.controller=null}McxSketchUndoableAction.prototype.execute=function(a){};McxSketchUndoableAction.prototype.finish=function(){};McxSketchUndoableAction.prototype.setController=function(a){this.controller=a};McxSketchUndoableAction.prototype.setAddedPoints=function(a){this.addedCoordinates=a};
McxSketchUndoableAction.prototype.setRemovedPoints=function(a){this.removedCoordinates=a};McxSketchUndoableAction.prototype.reset=function(){this.points=[];this.addedCoordinates=[];this.removedCoordinates=[];this.map.getRenderer().paintNonLayer()};McxSketchUndoableAction.prototype.undo=function(){this.controller.undo()};McxSketchUndoableAction.prototype.redo=function(){this.controller.redo()};McxSketchUndoableAction.prototype.isInstanceOf=function(a){return"IMcxSketchUndoableAction"==a};
McxSketchUndoableAction.prototype.HasUndo=function(){return 0<this.addedCoordinates.length};McxSketchUndoableAction.prototype.HasRedo=function(){return 0<this.removedCoordinates.length};js.builtin.McxDrawing.Controller={};js.builtin.McxDrawing.Controller.McxAdvanceCreateController={};function McxAdvanceCreateController(a,b){mcx.base(this,a,b);this.base=this}mcx.inherits(McxAdvanceCreateController,McxAdvancePaintController);McxAdvanceCreateController.prototype.onInsertSuccess=function(a){var b=a.getFeatures();a=McxFeatureHelper.instance.getLayers(b);b=McxFeatureHelper.instance.getBB(b);this.base.map.getRenderer().paintLayer(a,b)};
McxAdvanceCreateController.prototype.onInsertFail=function(a){McxMessageBox.show("",a.getExceptionMessage().getException(),McxMessageBoxType.Error);this.base.map.getRenderer().paintNonLayer()};
McxAdvanceCreateController.prototype.drawingCompleted=function(a){if(this.base.targetLayer.isInstanceOf("McxFsLayer")||this.base.targetLayer.isInstanceOf("McxMemLayer")){var b=a.transformTo(this.base.targetLayer.getCoordinateSystem());a=this.base.targetLayer.createFeatureBuffer();if(null!=a){a.setGeometry(b);b=new McxAjaxParameter;b.setParameters(this,this.onInsertSuccess,this.onInsertFail);var c=new McxFeatureOperationAction;c.AddInsertList([a],b);this.base.map.getInputHandler().execute(c)}}else McxMessageBox.show("",
McxLocalizationManager.getLocaleValue("McxDrawing-layerMayNotBeDrawn"),McxMessageBoxType.Error,McxDialogButtons.ok),this.base.map.getRenderer().paintNonLayer()};js.builtin.McxDrawing.Controller.McxCreateEllipseController={};function McxCreateEllipseController(a){mcx.base(this,a);this.activeLayer=null;this.base=this;this.setCircle(!1)}mcx.inherits(McxCreateEllipseController,McxPaintEllipseController);McxCreateEllipseController.prototype.onStartInteraction=function(){McxCreateEllipseController.superClass_.onStartInteraction.call(this);this.base.isCircle?this.base.setDescription("McxDrawAddon-DrawCircleDescription"):this.base.setDescription("McxDrawAddon-DrawEllipseDescription")};
McxCreateEllipseController.prototype.setCircle=function(a){McxCreateEllipseController.superClass_.setCircle.call(this,a)};McxCreateEllipseController.prototype.onEndInteraction=function(){McxCreateEllipseController.superClass_.onEndInteraction.call(this)};McxCreateEllipseController.prototype.onInsertSuccess=function(a){var b=a.getFeatures();a=McxFeatureHelper.instance.getLayers(b);b=McxFeatureHelper.instance.getBB(b);this.base.map.getRenderer().paintLayer(a,b)};
McxCreateEllipseController.prototype.onInsertFail=function(a){McxMessageBox.show("",a.getExceptionMessage().getException(),McxMessageBoxType.Error);this.base.map.getRenderer().paintNonLayer()};
McxCreateEllipseController.prototype.drawingCompleted=function(a){var b=this.base.map.getLayers().getActiveLayer();if(b.isInstanceOf("McxFsLayer")||b.isInstanceOf("McxMemLayer")){if(this.activeLayer=b,a=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createPolygon(a,null).transformTo(b.getCoordinateSystem()),b=b.createFeatureBuffer(),null!=b){b.setGeometry(a);a=new McxAjaxParameter;a.setParameters(this,this.onInsertSuccess,this.onInsertFail);var c=new McxFeatureOperationAction;
c.AddInsertList([b],a);c.setName(this.activeLayer.getAlias());this.base.map.getInputHandler().execute(c)}}else McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxDrawing-layerMayNotBeDrawn"),McxMessageBoxType.Error,McxDialogButtons.ok),this.base.map.getRenderer().paintNonLayer()};McxCreateEllipseController.prototype.onCoordinateCreated=function(a,b){McxCreateEllipseController.superClass_.onCoordinateCreated.call(this,a,b)};js.builtin.McxDrawing.Controller.McxCreateLinesController={};function McxCreateLinesController(a){mcx.base(this,a);this.activeLayer=null;this.base=this;this.insertFail=!1}mcx.inherits(McxCreateLinesController,McxPaintLineStringController);McxCreateLinesController.prototype.onStartInteraction=function(){McxCreateLinesController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxDrawAddon-DrawLinesDescription")};
McxCreateLinesController.prototype.onInsertSuccess=function(a){a=a.getFeatures();if(!(0>=a.length)){for(var b=this.base.map.getCoordinateSystem(),c=a[0].getGeometry().getBounds().transformTo(b),d=1;d<a.length;d++)var e=a[d].getGeometry().getBounds().transformTo(b),c=c.merge(e);this.base.map.getRenderer().paintLayer(this.activeLayer,c)}};McxCreateLinesController.prototype.onInsertFail=function(a){McxMessageBox.show("",a.getExceptionMessage().getException(),McxMessageBoxType.Error);this.base.map.getRenderer().paintNonLayer()};
McxCreateLinesController.prototype.drawingCompleted=function(a){var b=this.base.map.getLayers().getActiveLayer();if(b.isInstanceOf("McxFsLayer")||b.isInstanceOf("McxMemLayer")){this.activeLayer=b;var c=a.getPoints();a=[];for(var d=0;d<c.length-1;d++){var e=[];e.push(c[d]);e.push(c[d+1]);e=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createLineString(e).transformTo(b.getCoordinateSystem());a.push(e)}c=new McxAjaxParameter;c.setParameters(this,this.onInsertSuccess,this.onInsertFail);
c.setArgs([this.base.map]);e=[];for(d=0;d<a.length;d++){var f=b.createFeatureBuffer();f.setGeometry(a[d]);e.push(f)}b=new McxFeatureOperationAction;b.AddInsertList(e,c);this.base.map.getInputHandler().execute(b)}else McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxDrawing-layerMayNotBeDrawn"),McxMessageBoxType.Error,McxDialogButtons.ok),this.base.points=[],this.base.map.getRenderer().paintNonLayer()};js.builtin.McxDrawing.Controller.McxCreateLineSegmentController={};function McxCreateLineSegmentController(a){mcx.base(this,a);this.activeLayer=null;this.base=this}mcx.inherits(McxCreateLineSegmentController,McxPaintLineSegmentController);McxCreateLineSegmentController.prototype.onStartInteraction=function(){McxCreateLineSegmentController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxDrawAddon-DrawLineSegmentDescription")};
McxCreateLineSegmentController.prototype.onInsertSuccess=function(a){a=a.getFeatures();if(!(0>=a.length)){for(var b=this.base.map.getCoordinateSystem(),c=a[0].getGeometry().getBounds().transformTo(b),d=1;d<a.length;d++)var e=a[d].getGeometry().getBounds().transformTo(b),c=c.merge(e);this.base.map.getRenderer().paintLayer(this.activeLayer,c)}};McxCreateLineSegmentController.prototype.onInsertFail=function(a){McxMessageBox.show("",a.getExceptionMessage().getException(),McxMessageBoxType.Error);this.base.map.getRenderer().paintNonLayer()};
McxCreateLineSegmentController.prototype.drawingCompleted=function(a){var b=this.base.map.getLayers().getActiveLayer();if(b.isInstanceOf("McxFsLayer")||b.isInstanceOf("McxMemLayer")){if(this.activeLayer=b,a=McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createLineString(a.getPoints()).transformTo(b.getCoordinateSystem()),b.createEdit(),b=b.createFeatureBuffer(),b.setGeometry(a),null!=b){a=new McxAjaxParameter;a.setParameters(this,this.onInsertSuccess,this.onInsertFail);var c=new McxFeatureOperationAction;
c.AddInsertList([b],a);c.setName(this.activeLayer.getAlias());this.base.map.getInputHandler().execute(c)}}else McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxDrawing-layerMayNotBeDrawn"),McxMessageBoxType.Error,McxDialogButtons.ok),this.base.map.getRenderer().paintNonLayer()};js.builtin.McxDrawing.Controller.McxCreateLineStringController={};function McxCreateLineStringController(a){mcx.base(this,a);this.activeLayer=null;this.base=this}mcx.inherits(McxCreateLineStringController,McxPaintLineStringController);McxCreateLineStringController.prototype.onStartInteraction=function(){McxCreateLineStringController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxDrawAddon-DrawLineStringDescription")};
McxCreateLineStringController.prototype.onInsertSuccess=function(a){a=a.getFeatures();if(!(0>=a.length)){for(var b=this.base.map.getCoordinateSystem(),c=a[0].getGeometry().getBounds().transformTo(b),d=1;d<a.length;d++)var e=a[d].getGeometry().getBounds().transformTo(b),c=c.merge(e);this.base.map.getRenderer().paintLayer(this.activeLayer,c)}};McxCreateLineStringController.prototype.onInsertFail=function(a){McxMessageBox.show("",a.getExceptionMessage().getException(),McxMessageBoxType.Error)};
McxCreateLineStringController.prototype.drawingCompleted=function(a){var b=this.base.map.getLayers().getActiveLayer();if(b.isInstanceOf("McxFsLayer")||b.isInstanceOf("McxMemLayer")){if(this.activeLayer=b,a=a.transformTo(b.getCoordinateSystem()),b.createEdit(),b=b.createFeatureBuffer(),b.setGeometry(a),null!=b){a=new McxAjaxParameter;a.setParameters(this,this.onInsertSuccess,this.onInsertFail);var c=new McxFeatureOperationAction;c.AddInsertList([b],a);c.setName(this.activeLayer.getAlias());this.base.map.getInputHandler().execute(c)}}else McxMessageBox.show("",
McxLocalizationManager.getLocaleValue("McxDrawing-layerMayNotBeDrawn"),McxMessageBoxType.Error,McxDialogButtons.ok)};js.builtin.McxDrawing.Controller.McxCreateParallelLinesController={};function McxCreateParallelLinesController(a){mcx.base(this,a);this.activeLayer=null;this.rightDistance=this.leftDistance=5;this.middleLineSymbolizer=new McxLineSymbolizer;this._controllerUI=new McxControllerUI;this.base=this;this.initialize()}mcx.inherits(McxCreateParallelLinesController,McxPaintLineStringController);
McxCreateParallelLinesController.prototype.initialize=function(){var a=new McxStroke;a.setColor("red");this.middleLineSymbolizer.setStroke(a);this.createOptionUI()};
McxCreateParallelLinesController.prototype.onStartInteraction=function(){McxCreateParallelLinesController.superClass_.onStartInteraction.call(this);if(0==this.leftDistance&&0==this.rightDistance){var a=this.getOptionUI();a.setIsModal(!0);null==a||a.getUIStatus()||setTimeout($.proxy(function(){a.showUI();a.addClass("slide-left");a.setUIStatus(!0)},this),10)}this.base.setDescription("McxDrawAddon-DrawParallelLinesDescription")};McxCreateParallelLinesController.prototype.onEndInteraction=function(){McxCreateParallelLinesController.superClass_.onEndInteraction.call(this)};
McxCreateParallelLinesController.prototype.onInsertSuccess=function(a){a=McxFeatureHelper.instance.getBB(a.getFeatures());this.base.map.getRenderer().paintLayer(this.activeLayer,a)};McxCreateParallelLinesController.prototype.onInsertFail=function(a){McxMessageBox.show("",a.getExceptionMessage().getException(),McxMessageBoxType.Error)};
McxCreateParallelLinesController.prototype.paint=function(a){if(!(0>=this.base.points.length)){for(var b=[],c=0;c<this.base.points.length;c++)b.push(this.base.points[c]);null!=this.base.cursorPosition&&b.push(this.base.cursorPosition);var d=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createLineString(b),c=d.offset(this.leftDistance),d=d.offset(-1*this.rightDistance);a.getGeodeticGraphics().drawLineString(b,this.middleLineSymbolizer,1,0,0);a.getGeodeticGraphics().drawLineString(c.getPoints(),
this.base.lineSymbolizer,1,0,0);a.getGeodeticGraphics().drawLineString(d.getPoints(),this.base.lineSymbolizer,1,0,0)}};
McxCreateParallelLinesController.prototype.drawingCompleted=function(a){var b=this.base.map.getLayers().getActiveLayer();if(b.isInstanceOf("McxFsLayer")||b.isInstanceOf("McxMemLayer")){this.activeLayer=b;var c=a.offset(this.leftDistance),d=a.offset(-1*this.rightDistance),c=c.transformTo(b.getCoordinateSystem());c.setCoordinateSystem(a.getCoordinateSystem());d=d.transformTo(b.getCoordinateSystem());d.setCoordinateSystem(a.getCoordinateSystem());b.createEdit();a=[];var e=b.createFeatureBuffer();e.setGeometry(c);
a.push(e);b=b.createFeatureBuffer();b.setGeometry(d);a.push(b);b=new McxAjaxParameter;b.setParameters(this,this.onInsertSuccess,this.onInsertFail);c=new McxFeatureOperationAction;c.AddInsertList(a,b);c.setName(this.activeLayer.getAlias());this.base.map.getInputHandler().execute(c)}else McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxDrawing-layerMayNotBeDrawn"),McxMessageBoxType.Error,McxDialogButtons.ok),this.base.points=[],this.base.map.getRenderer().paintNonLayer()};
McxCreateParallelLinesController.prototype.getOptionUI=function(){return this._controllerUI};
McxCreateParallelLinesController.prototype.createOptionUI=function(){function a(){0>=c.getValue()&&0>=d.getValue()?this._controllerUI.setOkButtonState(McxButtonState.disabled):this._controllerUI.setOkButtonState(McxButtonState.active)}this._controllerUI.setTitle("Create Parallel Lines","McxDrawing-DrawParallelLines");var b=McxSettingsManager.read("McxDrawing-ParallelLinesSettings",null).getSettings();b&&0<b.length&&(b=JSON.parse(b[0]),this.rightDistance=parseFloat(b.RightDistance),this.leftDistance=
parseFloat(b.LeftDistance));var c=new McxNumberBox(0,Number.MAX_VALUE,8),d=new McxNumberBox(0,Number.MAX_VALUE,8);c.setValue(this.leftDistance);d.setValue(this.rightDistance);0>=this.leftDistance&&0>=this.rightDistance&&(this._controllerUI.setOkButtonState(McxButtonState.disabled),this._controllerUI.setCancelButtonState(McxButtonState.disabled));c.getOnChangeHandler().addListener(a,null,this);d.getOnChangeHandler().addListener(a,null,this);this._controllerUI.getSubmitHandler().addListener(function(){var a=
c.getValue();a&&(this.leftDistance=parseFloat(a));if(a=d.getValue())this.rightDistance=parseFloat(a);0>=this.rightDistance&&0>=this.leftDistance?this._controllerUI.setCancelButtonState(McxButtonState.disabled):this._controllerUI.setCancelButtonState(McxButtonState.active);McxSettingsManager.write("McxDrawing-ParallelLinesSettings",JSON.stringify({RightDistance:this.rightDistance,LeftDistance:this.leftDistance}),null);this.getOptionUI().hide();this.getOptionUI().removeClass("slide-left");this.getOptionUI().setUIStatus(!1)},
null,this);this._controllerUI.addControl(new McxLabeledEditor("left",c,"McxDrawing-CreateParallelLinesLeftLabel"));this._controllerUI.addControl(new McxLabeledEditor("right",d,"McxDrawing-CreateParallelLinesRightLabel"))};js.builtin.McxDrawing.Controller.McxCreatePointController={};function McxCreatePointController(a){mcx.base(this,a);this.activeLayer=null;this.base=this}mcx.inherits(McxCreatePointController,McxPaintPointController);McxCreatePointController.prototype.onStartInteraction=function(){McxCreatePointController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxDrawAddon-DrawPointDescription")};
McxCreatePointController.prototype.onInsertSuccess=function(a){a=a.getFeatures();a=McxFeatureHelper.instance.getBB(a);this.base.map.getRenderer().paintLayer(this.activeLayer,a)};McxCreatePointController.prototype.onInsertFail=function(a){McxMessageBox.show("",a.getExceptionMessage().getException(),McxMessageBoxType.Error)};
McxCreatePointController.prototype.drawingCompleted=function(a){var b=this.base.map.getLayers().getActiveLayer();if(b.isInstanceOf("McxFsLayer")||b.isInstanceOf("McxMemLayer")){this.activeLayer=b;a=a.transformTo(b.getCoordinateSystem());b=b.createFeatureBuffer();b.setGeometry(a);a=new McxAjaxParameter;a.setParameters(this,this.onInsertSuccess,this.onInsertFail);var c=new McxFeatureOperationAction;c.AddInsertList([b],a);c.setName(this.activeLayer.getAlias());this.base.map.getInputHandler().execute(c)}else McxMessageBox.show("",
McxLocalizationManager.getLocaleValue("McxDrawing-layerMayNotBeDrawn"),McxMessageBoxType.Error,McxDialogButtons.ok)};js.builtin.McxDrawing.Controller.McxCreatePolygonController={};function McxCreatePolygonController(a){mcx.base(this,a);this.activeLayer=null;this.base=this}mcx.inherits(McxCreatePolygonController,McxPaintPolygonController);McxCreatePolygonController.prototype.onStartInteraction=function(){McxCreatePolygonController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxDrawAddon-DrawPolygonDescription")};
McxCreatePolygonController.prototype.onInsertSuccess=function(a){this.map.getRenderer().paintLayer(this.activeLayer,null)};McxCreatePolygonController.prototype.onInsertFail=function(a){McxMessageBox.show("",a.getExceptionMessage().getException(),McxMessageBoxType.Error)};
McxCreatePolygonController.prototype.drawingCompleted=function(a){var b=this.base.map.getLayers().getActiveLayer();if(b.isInstanceOf("McxFsLayer")||b.isInstanceOf("McxMemLayer")){this.activeLayer=b;a=a.transformTo(b.getCoordinateSystem());b=b.createFeatureBuffer();b.setGeometry(a.clone());a=new McxAjaxParameter;a.setParameters(this,this.onInsertSuccess,this.onInsertFail);var c=new McxFeatureOperationAction;c.AddInsertList([b],a);c.setName(this.activeLayer.getAlias());this.base.map.getInputHandler().execute(c)}else McxMessageBox.show("",
McxLocalizationManager.getLocaleValue("McxDrawing-layerMayNotBeDrawn"),McxMessageBoxType.Error,McxDialogButtons.ok),this.base.map.getRenderer().paintNonLayer()};js.builtin.McxDrawing.Controller.McxCreateRectangleController={};function McxCreateRectangleController(a){mcx.base(this,a);this.activeLayer=null;this.base=this;this._point1XEditor=new McxNumberBox(Number.MIN_VALUE,Number.MAX_VALUE,8);this._point1YEditor=new McxNumberBox(Number.MIN_VALUE,Number.MAX_VALUE,8);this._point2XEditor=new McxNumberBox(Number.MIN_VALUE,Number.MAX_VALUE,8);this._point2YEditor=new McxNumberBox(Number.MIN_VALUE,Number.MAX_VALUE,8)}mcx.inherits(McxCreateRectangleController,McxPaintRectangleController);
McxCreateRectangleController.prototype.onStartInteraction=function(){McxCreateRectangleController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxDrawAddon-DrawRectangleDescription")};McxCreateRectangleController.prototype.onEndInteraction=function(){McxCreateRectangleController.superClass_.onEndInteraction.call(this);this.reset();this.base.map.getRenderer().paintNonLayer()};
McxCreateRectangleController.prototype.onInsertSuccess=function(a){a=a.getFeatures();a=McxFeatureHelper.instance.getBB(a);this.base.map.getRenderer().paintLayer(this.activeLayer,a);this._point1XEditor.setValue(NaN);this._point1YEditor.setValue(NaN);this._point2XEditor.setValue(NaN);this._point2YEditor.setValue(NaN)};McxCreateRectangleController.prototype.onInsertFail=function(a){McxMessageBox.show("",a.getExceptionMessage().getException(),McxMessageBoxType.Error)};
McxCreateRectangleController.prototype.drawingCompleted=function(a,b){var c=this.base.map.getLayers().getActiveLayer();if(c.isInstanceOf("McxFsLayer")||c.isInstanceOf("McxMemLayer")){if(this.activeLayer=c,!b.equals(a)){this.reset();var d=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createBounds(Math.min(a.getX(),b.getX()),Math.min(a.getY(),b.getY()),Math.max(a.getX(),b.getX()),Math.max(a.getY(),b.getY())),d=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createPolygon(d,
null).transformTo(c.getCoordinateSystem()),c=c.createFeatureBuffer();c.setGeometry(d);d=new McxAjaxParameter;d.setParameters(this,this.onInsertSuccess,this.onInsertFail);var e=new McxFeatureOperationAction;e.AddInsertList([c],d);this.base.map.getInputHandler().execute(e)}}else McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxDrawing-layerMayNotBeDrawn"),McxMessageBoxType.Error,McxDialogButtons.ok)};
McxCreateRectangleController.prototype.onCoordinateCreated=function(a,b){McxCreateRectangleController.superClass_.onCoordinateCreated.call(this,a,b);this.base.started?(this._point1XEditor.setValue(b.getX()),this._point1YEditor.setValue(b.getY())):(this._point1XEditor.setValue(NaN),this._point1YEditor.setValue(NaN),this._point2XEditor.setValue(NaN),this._point2YEditor.setValue(NaN))};
js.builtin.McxEditing={};js.builtin.McxEditing.Action={};js.builtin.McxEditing.Action.McxDeleteFeatureAction={};function McxDeleteFeatureAction(a){this.features=a;this.sendFeatureCount=this.requestedFeatureCount=0;this.messageBox=this.map=null;this.returnedFeatures=[]}
McxDeleteFeatureAction.prototype.onDeleteSuccess=function(a){this.requestedFeatureCount++;a=a.getFeatures();this.returnedFeatures=this.returnedFeatures.concat(a);if(this.requestedFeatureCount==this.sendFeatureCount){for(a=0;a<this.returnedFeatures.length;a++){var b=this.returnedFeatures[a],c=this.map.getPaintedFeatures(b.getLayer()).getAll()[b.getFeatureID()];c&&b.setGeometry(c)}a=McxFeatureHelper.instance.groupByLayer(this.returnedFeatures);for(b=0;b<a.length;b++){var c=a[b].getLayer(),d=a[b].getFeatures(),
d=McxFeatureHelper.instance.getBB(d);this.map.getRenderer().paintLayer(c,d)}}};McxDeleteFeatureAction.prototype.onDeleteFail=function(a){McxSelectionHelper.instance.clearSelection(this.map);this.map.getRenderer().paintSelections();"Delete features are denided."!=!a.getExceptionMessage().getException()&&(a=McxLocalizationManager.getLocaleValue("McxEditing-insufficientAuthority"),McxMessageBox.show("",a,McxMessageBoxType.Error))};
McxDeleteFeatureAction.prototype.execute=function(a){this.map=a;var b=McxLocalizationManager.getLocaleValue("McxEditing-confirmDeleteNumberOfFeature"),b=String.format(b,this.features.length),c=McxMessageBox.show("",b,McxMessageBoxType.Confirm);c.getMessageResultHandler().addListener(function(){McxSelectionHelper.instance.clearSelection(a);a.getRenderer().paintSelections();var b=[],e=0;if(c.getMessageResult()==McxMessageBoxResult.Ok){var f=McxFeatureGroup.groupFeatures(this.features);this.sendFeatureCount=
f.length;for(var g=0;g<f.length;g++){var h=f[g],k=h.getLayer();if(k.getEditable()){var k=k.createEdit(),h=h.getFeatures(),m=new McxAjaxParameter;m.setParameters(this,this.onDeleteSuccess,this.onDeleteFail);k.deleteFeatureRange(h,m)}else k=k.getName(),b[e]=k,e++}}e="";for(g=0;g<b.length;g++)e+=b[g]+", ";e=e.substring(0,e.length-2);1<=b.length&&(b=McxLocalizationManager.getLocaleValue("McxBase-notEditableLayer"),b=String.format(b,e),McxMessageBox.show("",b,McxMessageBoxType.Error,McxDialogButtons.ok));
a.getRenderer().paintSelections()},null,this);c.showDialog(!0,!1)};McxDeleteFeatureAction.prototype.isInstanceOf=function(a){return"McxDeleteFeatureAction"==a};js.builtin.McxEditing.Controller={};js.builtin.McxEditing.Controller.McxAddVertexController={};function McxAddVertexController(){mcx.base(this);this.selectBuffer=this.snapBuffer=10;this.pointSymbolizer=new McxPointSymbolizer;this.features=[];this.markers=[];this.shiftKeyPressed=!1;this.base=this;this.initialize()}mcx.inherits(McxAddVertexController,McxSnappableController);
McxAddVertexController.prototype.initialize=function(){var a=new McxStroke;a.setColor("blue");var b=new McxFill;b.setColor("transparent");var c=new McxSquareMark;c.setStroke(a);c.setFill(b);this.pointSymbolizer.setSymbols([c])};
McxAddVertexController.prototype.onStartInteraction=function(){McxAddVertexController.superClass_.onStartInteraction.call(this);this.markers=[];var a=new McxSelectionHelper;this.features=this.features.concat(a.getSelection(this.base.map));for(a=0;a<this.features.length;a++)this.markers.push(null);this.base.setDescription("McxEditing-AddVertexDescription");this.base.setCursor(McxCursors.selectFeature)};
McxAddVertexController.prototype.onEndInteraction=function(){this.features=[];this.markers=[];McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();this.base.map.getRenderer().paintNonLayer();McxAddVertexController.superClass_.onEndInteraction.call(this)};McxAddVertexController.prototype.onKeyUp=function(a){McxAddVertexController.superClass_.onKeyUp.call(this,a);a.getKeyCode()==McxKeyCode.shift&&(this.shiftKeyPressed=!1)};
McxAddVertexController.prototype.onKeyDown=function(a){McxAddVertexController.superClass_.onKeyDown.call(this,a);a.getKeyCode()==McxKeyCode.shift&&(this.shiftKeyPressed=!0)};
McxAddVertexController.prototype.paint=function(a){McxAddVertexController.superClass_.paint.call(this,a);var b=McxSelectionHelper.instance.getSelection(this.base.map);this.features=b;for(var c=0;c<b.length;c++)for(var d=McxGeometryHelper.instance.getPoints(b[c],this.base.map.getCoordinateSystem()),e=0;e<d.length;e++)a.getGeodeticGraphics().drawPoint(d[e],this.pointSymbolizer,1,0,0)};
McxAddVertexController.prototype.getSelected=function(a,b){var c=new McxSelectFilter,d=this.base.map.worldToView(b.getX(),b.getY()),e=this.selectBuffer/2,f=this.base.map.viewToWorld(d.getX()-e,d.getY()-e),g=this.base.map.viewToWorld(d.getX()+e,d.getY()+e),d=Math.min(f.getX(),g.getX()),e=Math.min(f.getY(),g.getY()),h=Math.max(f.getX(),g.getX()),f=Math.max(f.getY(),g.getY()),f=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createBounds(d,e,h,f),f=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createPolygon(f,
null);c.setGeometry(f);c.setSpatialRelation(McxSpatialRelation.Intersects);d=[];e=McxSelectionHelper.instance.getSelectableLayer(this.base.map);for(f=0;f<e.length;f++)d.push(new McxFieldSet(e[f],null));c.setFieldSets(d);d=this.base.map.getLayers().toLayerArray();for(e=0;e<d.length;e++)if(h=this.base.map.getPaintedFeatures(d[e]).getAll(),g=McxSelectionHelper.instance.hitTestByScreenFeatures(this.base.map,h,c),0!=g.length){var k=!0;for(f in g){h=new McxMemFeature(d[e],null);h.setFeatureID(parseInt(f,
10));h.setGeometry(g[f]);var m=McxSelectionHelper.instance.isSelected(h);m||(k=!1);if(m&&this.shiftKeyPressed){McxSelectionHelper.instance.removeSelection(this.base.map,h);for(c=0;c<this.features.length;c++)this.features[c].getFeatureID()==h.getFeatureID()&&this.features.splice(c,1);this.base.map.getRenderer().paintSelections();return}}if(k)return}McxSelectionHelper.instance.applyFilter(a,this.base.map,c)};
McxAddVertexController.prototype.onCoordinateCreated=function(a,b){var c=this.base.map.worldToView(b.getX(),b.getY()),d=[],e,f=function(){},g=new McxAjaxParameter;g.setParameters(this,function(a){a=a.getFeatures();a=McxFeatureHelper.instance.getBB(a);0<d.length&&this.base.map.getRenderer().paintLayer(d,a)},f);var h=new McxAjaxParameter;h.setParameters(this,function(a){a=a.getFeatures();for(var b=[],c=0;c<a.length;c++){var d=a[c].getGeometry();if(McxGeometryType.Point||d.isInstanceOf(McxGeometryType.MultiPoint))McxSelectionHelper.instance.removeSelection(this.base.map,
a[c]);else{for(var d=!1,f=0;f<this.features.length;f++)this.features[f].getFeatureID()==a[c].getFeatureID()&&(d=!0);d||b.push(a[c])}}e&&0<=e.length&&(this.features=this.features.concat(b))},f);var k=!1;if(!this.shiftKeyPressed){this.features=McxSelectionHelper.instance.getSelection(this.base.map);var m=McxFeatureGroup.groupFeatures(this.features);this.base.map.worldToView(b.getX(),b.getY());for(var n=!1,f={},p=0;p<m.length;p++){var q=m[p];e=q.getFeatures();q.getLayer();for(var r=!1,t=0;t<e.length;t++){var u=
e[t];if(u.getLayer().getEditable()){var n=!0,v=new McxMemFeature(u.getLayer(),null);v.setFeatureID(u.getFeatureID());var w=u.getGeometry();v.setGeometry(w.clone());var x=[];if(w.isInstanceOf(McxGeometryType.LineString))x.push(u.getGeometry());else if(w.isInstanceOf(McxGeometryType.Polygon)){var y=u.getGeometry();x.push(y.getShell());for(var A=y.getHoles(),B=0;B<A.length;B++)x.push(A[B])}else if(w.isInstanceOf(McxGeometryType.MultiPolygon)){for(var z=u.getGeometry(),y=z.getPolygons(),z=0;z<y.length;z++)x.push(y[z].getShell());
for(z=0;z<y.length;z++)for(A=y[z].getHoles(),B=0;B<A.length;B++)x.push(A[B])}else continue;A=null;for(B=0;B<x.length;B++){for(var C=-1,D=null,F=x[B],y=F.transformTo(this.base.map.getCoordinateSystem()).segmentize(),z=0;z<y.length;z++){var E=this.base.map.worldToView(y[z].getStartX(),y[z].getStartY()),G=this.base.map.worldToView(y[z].getEndX(),y[z].getEndY()),E=McxFactoryFinder.GeometryFactory(null).createLineSegment(E,G);if(!(c.distanceTo(E)>this.snapBuffer||E.getStartPoint().equals(c)||E.getEndPoint().equals(c)||
(D=y[z].getPerpendicularFoot(b,!1),D.equals(y[z].getStartPoint())||D.equals(y[z].getEndPoint())))){C=z+1;break}}0>C||(A=F)}if(null!=A){B=McxFactoryFinder.GeometryFactory(null).createLineString(A.getPoints());B.insertPoints(C,D);if(w.isInstanceOf(McxGeometryType.Polygon))if(y=w,A.equals(y.getShell()))k=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createLinearRing(B.getPoints()),y=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createPolygon(k,null),v.setGeometry(y);
else{k=w.getHoles();for(x=w=0;x<k.length;x++)if(k[x].equals(A)){w=x;break}k[w]=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createLinearRing(B.getPoints());u.setGeometry(McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createPolygon(y.getShell(),null));v.setGeometry(u.getGeometry());y.setHoles([]);y.setHoles(k)}else if(w.isInstanceOf(McxGeometryType.MultiPolygon)){z=w;E=z.getPolygons();for(B=0;B<E.length;B++)if(y=E[B],A.equals(y.getShell())){y.setShell(F);
y.setHoles([]);y.setHoles(y.getHoles());break}else{k=y.getHoles();w=-1;for(x=0;x<k.length;x++)if(k[x].equals(A)){w=x;break}if(-1!=w){k[w]=F;y.setHoles([]);y.setHoles(k);break}}v.setGeometry(z)}else v.setGeometry(B);for(k=0;k<this.features.length;k++)if(this.features[k].getFeatureID()==v.getFeatureID()){this.features[k]=v;break}u.setGeometry(v.getGeometry());v.getLayer().getCoordinateSystem()!=McxApplication.getActiveMap().getCoordinateSystem()&&v.getGeometry().setCoordinateSystem(v.getLayer().getCoordinateSystem());
v.getGeometry().setCoordinateSystem(q.getLayer().getCoordinateSystem());k=!0;v=new McxFeatureOperationAction;v.AddUpdateList([u],g);this.base.map.getInputHandler().execute(v);r||(r=!0)}}else u=u.getLayer().getName(),f[u]=u}r&&(d.push(q.getLayer()),this.base.map.getRenderer().paintNonLayer())}if(!n){c="";g=0;for(p in f)1<=g&&(c+=" and "),c+=p,g++;1<=g&&(f=McxLocalizationManager.getLocaleValue("McxBase-notEditableLayer"),f=String.format(f,c),McxMessageBox.show("",f,McxMessageBoxType.Error,McxDialogButtons.ok))}}k||
this.getSelected(h,b)};js.builtin.McxEditing.Controller.McxBreakLineController={};function McxBreakLineController(){mcx.base(this);this.selectBuffer=this.snapBuffer=10;this.pointSymbolizer=new McxPointSymbolizer;this.features=[];this.markers=[];this.shiftKeyPressed=!1;this.base=this;this.initialize()}mcx.inherits(McxBreakLineController,McxSnappableController);
McxBreakLineController.prototype.initialize=function(){var a=new McxStroke;a.setColor("blue");var b=new McxSquareMark;b.setStroke(a);a=new McxFill;a.setColor("transparent");b.setFill(a);this.pointSymbolizer.setSymbols([b])};
McxBreakLineController.prototype.onStartInteraction=function(){McxBreakLineController.superClass_.onStartInteraction.call(this);this.markers=[];McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();this.base.setDescription("McxEditing-BreakLineDescription");this.base.setCursor(McxCursors.selectFeature)};
McxBreakLineController.prototype.onEndInteraction=function(){McxBreakLineController.superClass_.onEndInteraction.call(this);McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();this.base.map.getRenderer().paintNonLayer()};McxBreakLineController.prototype.onKeyUp=function(a){McxBreakLineController.superClass_.onKeyUp.call(this,a);a.getKeyCode()==McxKeyCode.shift&&(this.shiftKeyPressed=!1)};
McxBreakLineController.prototype.onKeyDown=function(a){McxBreakLineController.superClass_.onKeyDown.call(this,a);a.getKeyCode()==McxKeyCode.shift&&(this.shiftKeyPressed=!0)};
McxBreakLineController.prototype.paint=function(a){McxBreakLineController.superClass_.paint.call(this,a);var b=McxSelectionHelper.instance.getSelection(this.base.map);null==this.features&&(this.features=[],this.features=b);for(var c=0;c<b.length;c++)for(var d=McxGeometryHelper.instance.getPoints(b[c],this.base.map.getCoordinateSystem()),e=0;e<d.length;e++)a.getGeodeticGraphics().drawPoint(d[e],this.pointSymbolizer,1,0,0)};
McxBreakLineController.prototype.getSelected=function(a,b){var c=new McxSelectFilter,d=this.base.map.worldToView(b.getX(),b.getY()),e=this.selectBuffer/2,f=this.base.map.viewToWorld(d.getX()-e,d.getY()-e),g=this.base.map.viewToWorld(d.getX()+e,d.getY()+e),d=Math.min(f.getX(),g.getX()),e=Math.min(f.getY(),g.getY()),h=Math.max(f.getX(),g.getX()),f=Math.max(f.getY(),g.getY()),f=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createBounds(d,e,h,f),f=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createPolygon(f,
null);c.setGeometry(f);c.setSpatialRelation(McxSpatialRelation.Intersects);d=[];e=McxSelectionHelper.instance.getSelectableLayer(this.base.map);for(f=0;f<e.length;f++)d.push(new McxFieldSet(e[f],null));c.setFieldSets(d);d=this.base.map.getLayers().toLayerArray();for(e=0;e<d.length;e++)if(h=this.base.map.getPaintedFeatures(d[e]).getAll(),g=McxSelectionHelper.instance.hitTestByScreenFeatures(this.base.map,h,c),0!=g.length){var k=!0;for(f in g){h=new McxMemFeature(d[e],null);h.setGeometry(g[f]);h.setFeatureID(parseInt(f,
10));var m=McxSelectionHelper.instance.isSelected(h);m||(k=!1);if(m&&this.shiftKeyPressed){McxSelectionHelper.instance.removeSelection(this.base.map,h);for(c=0;c<this.features.length;c++)this.features[c].getFeatureID()==h.getFeatureID()&&this.features.splice(c,1);this.base.map.getRenderer().paintLayer(h.getLayer(),h.getGeometry().getBounds());return}}if(k)return}McxSelectionHelper.instance.applyFilter(a,this.base.map,c)};
McxBreakLineController.prototype.onCoordinateCreated=function(a,b){var c=this.base.map.worldToView(b.getX(),b.getY()),d=[],e=function(){},f=new McxAjaxParameter;f.setParameters(this,function(a){a=a.getFeatures();a=McxFeatureHelper.instance.groupByLayer(a);for(var b=0;b<a.length;b++){var c=a[b].getLayer(),d=a[b].getFeatures(),d=McxFeatureHelper.instance.getBB(d);this.base.map.getRenderer().paintLayer(c,d)}},e);var g=new McxAjaxParameter;g.setParameters(this,function(a){a=a.getFeatures();for(var b=
[],c=0;c<a.length;c++)a[c].getGeometry().isInstanceOf(McxGeometryType.LineString)||a[c].getGeometry().isInstanceOf(McxGeometryType.LineSegment)||a[c].getGeometry().isInstanceOf(McxGeometryType.LinearRing)?b.push(a[c]):McxSelectionHelper.instance.removeSelection(this.base.map,a[c]);0<=b.length&&(this.features=this.features.concat(b))},e);if(!this.shiftKeyPressed){this.features=McxSelectionHelper.instance.getSelection(this.base.map);for(var e=McxFeatureGroup.groupFeatures(this.features),h=this.base.map.worldToView(b.getX(),
b.getY()),k=0;k<e.length;k++){var m=e[k],n=m.getFeatures();m.getLayer();for(var p=!1,q=0;q<n.length;q++){var r=n[q].getGeometry();if(r.isInstanceOf(McxGeometryType.LineString)){for(var t=-1,u=null,v=r.segmentize(),w=0;w<v.length;w++){var x=v[w].transformTo(this.base.map.getCoordinateSystem()),y=this.base.map.worldToView(x.getStartPoint().getX(),x.getStartPoint().getY()),x=this.base.map.worldToView(x.getEndPoint().getX(),x.getEndPoint().getY()),y=McxFactoryFinder.GeometryFactory(null).createLineSegment(y,
x);if(!(h.distanceTo(y)>this.snapBuffer||y.getStartPoint().equals(c)||y.getEndPoint().equals(c)||(u=v[w].getPerpendicularFoot(b,!1),u.equals(v[w].getStartPoint())||u.equals(v[w].getEndPoint())))){t=w+1;break}}if(!(0>t)){McxSelectionHelper.instance.removeSelection(this.base.map,n[q]);this.base.map.getRenderer().paintSelections();w=[];v=[];for(y=0;y<t;y++)w.push(r.getPoints()[y]);w.push(u);v.push(u);for(y=t;y<r.getPoints().length;y++)v.push(r.getPoints()[y]);r=[];u=McxFactoryFinder.GeometryFactory(m.getLayer().getCoordinateSystem());
w=u.createLineString(w);t=m.getLayer().createFeatureBuffer();t.setGeometry(w);r.push(t);v=u.createLineString(v);u=m.getLayer().createFeatureBuffer();u.setGeometry(v);r.push(u);v=new McxFeatureOperationAction;v.AddDeleteList(r,f);v.AddInsertList(r,f);this.base.map.getInputHandler().execute(v);McxFeatureHelper.instance.copyFields(n[q],t);McxFeatureHelper.instance.copyFields(n[q],u);McxSelectionHelper.instance.removeSelection(this.base.map,n[q]);McxSelectionHelper.instance.addSelection(this.base.map,
[t,u]);p||(p=!0);break}}}if(p){d.push(m.getLayer());break}}}this.getSelected(g,b)};js.builtin.McxEditing.Controller.McxChamferLineController={};
function McxChamferLineController(){mcx.base(this);this.base=this;this.base.canSet=!1;this.base.applyMode=McxApplyMode.Select;this.base.selectToolMode=McxSelectToolMode.Fence;this.primitiveSecondSelection=this.primitiveFirstSelection=this.activeLayer=null;this.counter=0;this.valueLine2=this.valueLine1=5;this.radius=10;this.inward=0;this._controllerUI=new McxControllerUI;this._value1Editor=new McxNumberBox(0,Number.MAX_VALUE,8);this._value2Editor=new McxNumberBox(0,Number.MAX_VALUE,8);this._radiusEditor=
new McxNumberBox(0,Number.MAX_VALUE,8);this._inwardEditor=new McxRadioButton("ward");this._outwardEditor=new McxRadioButton("ward");this.createControllerUI()}mcx.inherits(McxChamferLineController,McxSelectController);McxChamferLineController.prototype.onStartInteraction=function(){McxChamferLineController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxEditing-ChamferLineDescription")};
McxChamferLineController.prototype.onEndInteraction=function(){McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();this.base.map.getRenderer().paintNonLayer();McxChamferLineController.superClass_.onEndInteraction.call(this)};
McxChamferLineController.prototype.onMouseDown=function(a){McxChamferLineController.superClass_.onMouseDown.call(this,a);"right"==a.getButton()&&(this.primitiveFirstSelection&&this.primitiveSecondSelection?this.chamferLines(this.base.map):McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-chamferLineNonSelectedAlert"),McxMessageBoxType.Warning,McxDialogButtons.ok))};
McxChamferLineController.prototype.onSelectFeaturesSuccess=function(a){for(var b=a.getFeatures(),c=[],d=0;d<b.length;d++){var e=b[d].getGeometry();if(e.isInstanceOf(McxGeometryType.LineString)||e.isInstanceOf(McxGeometryType.LinearRing)||e.isInstanceOf(McxGeometryType.LineSegment)){c.push(b[d]);break}}0>=c.length||(b=new McxSelectResult(a.getFilter(),c,a.getLayer(),a.getArgs()),McxChamferLineController.superClass_.onSelectFeaturesSuccess.call(this,b),this.primitiveFirstSelection?this.primitiveSecondSelection=
a.getFilter().getGeometry():this.primitiveFirstSelection=a.getFilter().getGeometry())};
McxChamferLineController.prototype.chamferLines=function(a){var b=new McxAjaxParameter;b.setParameters(this,function(b){McxSelectionHelper.instance.clearSelection(a);a.getRenderer().paintSelections();McxFeatureHelper.instance.getBB(b.getFeatures());a.getRenderer().paintLayer(this.activeLayer,null)},function(b){McxSelectionHelper.instance.clearSelection(a);a.getRenderer().paintSelections()});this.activeLayer=a.getLayers().getActiveLayer();var c=this.primitiveFirstSelection.getBounds().getCentroid().clone(),
d=this.primitiveSecondSelection.getBounds().getCentroid().clone(),e=McxSelectionHelper.instance.getSelection(a),f=McxCornerLineController.convertFeaturesToViewport(a.getCoordinateSystem(),e);if(2!=e.length)return McxSelectionHelper.instance.clearSelection(a),a.getRenderer().paintSelections(),!1;if(!f[0].isInstanceOf(McxGeometryType.LineString)||!f[1].isInstanceOf(McxGeometryType.LineString))return!1;var g=f[0],h=f[1],k=g.segmentize(),f=h.segmentize(),g=McxCornerLineController.getClosestSegments(g,
h),m=g[1],h=g[2],n=g[0];if(null==n)return McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-chamferLineCornerLineFailedAlert"),McxMessageBoxType.Error,McxDialogButtons.ok),McxSelectionHelper.instance.clearSelection(a),a.getRenderer().paintSelections(),!1;var p,q=[];q.push(n);for(p=m;0<=p;p--)q.push(k[p].getStartPoint());g=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createLineString(q);q=[];q.push(n);q.push(k[m].getEndPoint());for(p=m+1;p<k.length;p++)q.push(k[p].getEndPoint());
k=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createLineString(q);m=(p=1>=g.getPoints().length?!1:1>=k.getPoints().length?!0:c.distanceTo(g)<c.distanceTo(k))?g.segmentize():k.segmentize();c=m[0].clone().getAltitudePoint(this.valueLine1,0);if(p)for(m=[],p=0;p<g.getPoints().length;p++)m.push(g.getPoints()[p]);else for(m=[],p=0;p<k.getPoints().length;p++)m.push(k.getPoints()[p]);k=m;k[0]=c;g=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createLineString(k);
e[0].setGeometry(g);m=[];m.push(n);for(p=h;0<=p;p--)m.push(f[p].getStartPoint());k=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createLineString(m);m=[];m.push(n);m.push(f[h].getEndPoint());for(p=h+1;p<f.length;p++)m.push(f[p].getEndPoint());f=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createLineString(m);m=(p=1>=k.getPoints().length?!1:1>=f.getPoints().length?!0:d.distanceTo(k)<d.distanceTo(f))?k.segmentize():f.segmentize();d=m[0].clone().getAltitudePoint(this.valueLine2,
0);if(p)for(m=[],p=0;p<k.getPoints().length;p++)m.push(k.getPoints()[p]);else for(m=[],p=0;p<f.getPoints().length;p++)m.push(f.getPoints()[p]);k=m;k[0]=d;f=McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createLineString(k);e[1].setGeometry(f);if(1E-14>Math.abs(this.radius-0)){c=g.segmentize();d=f.segmentize();if(c[0].length<this.valueLine1||d[0].length<this.valueLine2)return!1;c=[];g.getPoints().reverse();c=c.concat(g.getPoints());c=c.concat(f.getPoints());e[0].setGeometry(McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createLineString(c));
e[0].getLayer().getCoordinateSystem()!=a.getCoordinateSystem()&&e[0].getGeometry().setCoordinateSystem(e[0].getLayer().getCoordinateSystem())}else{h=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createEllipse(c.getX(),c.getY(),this.radius,this.radius);n=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createEllipse(d.getX(),d.getY(),this.radius,this.radius);k=new McxLineSymbolizer;p=new McxStroke;p.setColor("red");k.setStroke(p);a.createDrawContext().getGeodeticGraphics().drawLineString(h.getPoints(),
k,1,0,0);a.createDrawContext().getGeodeticGraphics().drawLineString(n.getPoints(),k,1,0,0);n=h.intersection(n);if(null==n||2>n.getPoints().length)return McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-chamferLineCantCreateGeometryAlert"),McxMessageBoxType.Error,McxDialogButtons.ok),!1;h=n.getPoints()[0].clone();k=n.getPoints()[1].clone();c.distanceTo(f.getStartPoint())<c.distanceTo(f.getEndPoint())?f.getEndPoint().distanceTo(h)<f.getEndPoint().distanceTo(k)?(n=h.clone(),k=
k.clone()):(n=k.clone(),k=h.clone()):f.getStartPoint().distanceTo(h)<f.getStartPoint().distanceTo(k)?(n=h.clone(),k=k.clone()):(n=k.clone(),k=h.clone());h=[2];h[0]=this.inward?k.clone():n.clone();h[1]=d.clone();n=McxFactoryFinder.GeometryFactory(null).createLineSegment(h[0],h[1]).getAngle();h[1]=c.clone();k=McxFactoryFinder.GeometryFactory(null).createLineSegment(h[0],h[1]).getAngle();m=McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createEllipticArc(h[0].getX(),h[0].getY(),this.radius,
this.radius,k,n);90<n&&180>n&&90<k&&180>k&&(n-=90,k-=90);p=m.getPoints();0!=m.getPoints().length&&(p[0]=c,p[p.length-1]=d);k>n&&(m=McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createEllipticArc(h[0].getX(),h[0].getY(),this.radius,this.radius,n,k),p=m.getPoints(),p[0]=d,p[p.length-1]=c);c=[];d=McxFactoryFinder.GeometryFactory(null).createLineString(p);if(k>n){f.getEndPoint().distanceTo(d.getStartPoint())<f.getStartPoint().distanceTo(d.getStartPoint())||f.getPoints().reverse();if(f.segmentize()[f.segmentize().length-
1].length<this.valueLine2)return McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-chamferLineInvalidLineAlert"),McxMessageBoxType.Error,McxDialogButtons.ok),!1;c=c.concat(f.getPoints());c=c.concat(d.getPoints());g.getStartPoint().distanceTo(d.getEndPoint())<g.getEndPoint().distanceTo(d.getEndPoint())||g.getPoints().reverse();if(g.segmentize()[0].length<this.valueLine1)return McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-chamferLineInvalidLineAlert"),
McxMessageBoxType.Error,McxDialogButtons.ok),!1;c=c.concat(g.getPoints())}else{g.getEndPoint().distanceTo(d.getStartPoint())<g.getStartPoint().distanceTo(d.getStartPoint())||g.getPoints().reverse();if(g.segmentize()[g.segmentize().length-1].length<this.valueLine1)return McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-chamferLineInvalidLineAlert"),McxMessageBoxType.Error,McxDialogButtons.ok),!1;c=c.concat(g.getPoints());c=c.concat(d.getPoints());f.getStartPoint().distanceTo(d.getEndPoint())<
f.getEndPoint().distanceTo(d.getEndPoint())||f.getPoints().reverse();if(f.segmentize()[0].length<this.valueLine2)return McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-chamferLineInvalidLineAlert"),McxMessageBoxType.Error,McxDialogButtons.ok),!1;c=c.concat(f.getPoints())}e[0].setGeometry(McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createLineString(c))}g=new McxFeatureOperationAction;g.AddUpdateList([e[0]],b);this.base.map.getInputHandler().execute(g);g=new McxFeatureOperationAction;
g.AddDeleteList([e[1]],b);this.base.map.getInputHandler().execute(g);return!0};McxChamferLineController.prototype.getOptionUI=function(){return this._controllerUI};
McxChamferLineController.prototype.createControllerUI=function(){this._controllerUI.setTitle("Chamfer","McxEditing-Chamfer");var a=McxSettingsManager.read("McxEditing-ChamferLineSettings",null).getSettings();a&&0<a.length&&(a=JSON.parse(a[0]),this.valueLine1=parseInt(a.Value1,10),this.valueLine2=parseInt(a.Value2,10),this.radius=parseInt(a.Radius,10),this.inward=parseInt(a.Inward,10));this._value1Editor.setValue(this.valueLine1);this._value2Editor.setValue(this.valueLine2);this._radiusEditor.setValue(this.radius);
this._inwardEditor.checked(this.inward?!0:!1);this._outwardEditor.checked(this.inward?!1:!0);this._controllerUI.addControl(new McxLabeledEditor("Value1",this._value1Editor,"McxEditing-chamferLineControllerValue1",5));this._controllerUI.addControl(new McxLabeledEditor("Value2",this._value2Editor,"McxEditing-chamferLineControllerValue2",5));this._controllerUI.addControl(new McxLabeledEditor("Radius",this._radiusEditor,"McxEditing-chamferLineControllerRadius",5));this._controllerUI.addControl(new McxLabeledEditor("Inward",
this._inwardEditor,"McxEditing-chamferLineControllerInward",5));this._controllerUI.addControl(new McxLabeledEditor("Outward",this._outwardEditor,"McxEditing-chamferLineControllerOutward",5));this._controllerUI.getSubmitHandler().addListener(function(){this.valueLine1=this._value1Editor.getValue();this.valueLine2=this._value2Editor.getValue();this.radius=this._radiusEditor.getValue();this.inward=this._inwardEditor.isChecked();McxSettingsManager.write("McxEditing-ChamferLineSettings",JSON.stringify({Value1:this.valueLine1,
Value2:this.valueLine2,Radius:this.radius,Inward:this.inward}),null);this._controllerUI.hide()},null,this)};js.builtin.McxEditing.Controller.McxCopyAttributeController={};function McxCopyAttributeController(){mcx.base(this);this.base=this;this._sourceFeature=null;this._targetFeatures=[];this._controllerUI=new McxControllerUI;this.initialize();this.base.setSelectToolMode(McxSelectToolMode.Fence)}mcx.inherits(McxCopyAttributeController,McxSelectController);
McxCopyAttributeController.prototype.initialize=function(){this._controllerUI.createAndAddFooterButton("Clear","McxEditing-CopyAttributeClear").getClickHandler().addListener(this.clearSelection,null,this);this._controllerUI.setTitle("\u00d6zellik Kopyala","McxEditing-CopyAttribute");this._controllerUI.displayMessage("Kaynak nesne se\u00e7iniz","McxEditing-SelectSourceFeature");this._controllerUI.getSubmitHandler().addListener(this.copyAttributes,null,this)};
McxCopyAttributeController.prototype.onStartInteraction=function(){McxCopyAttributeController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxEditing-CopyAttributeSelectSourceFeature")};
McxCopyAttributeController.prototype.onSelectFeaturesSuccess=function(a){var b=a.getFeatures();if(0!=b.length){if(0==mcx.isDefAndNotNull(this._sourceFeature)){if(1!=b.length){McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("McxEditing-SourceFeatureCountCantBeGreaterThanOne"),McxMessageBoxType.Warning);return}this._sourceFeature=b[0];this.base.setDescription("McxEditing-CopyAttributeSelectTargetFeature")}else this._targetFeatures=this._targetFeatures.concat(b),this._controllerUI.displayMessage("Kopyalama i\u015flemini tamamlamak i\u00e7in sa\u011f t\u0131klay\u0131n\u0131z.",
"McxEditing-FinishCopyingProcess");McxCopyAttributeController.superClass_.onSelectFeaturesSuccess.call(this,a)}};McxCopyAttributeController.prototype.clearSelection=function(){this._sourceFeature=null;this._targetFeatures=[];McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections()};
McxCopyAttributeController.prototype.copyAttributes=function(){var a={};if(this._sourceFeature&&this._targetFeatures&&0<this._targetFeatures.length){var b=new McxAjaxParameter;b.setAsync(!1);this._sourceFeature.setAllAttributes(b);for(var c=0;c<this._targetFeatures.length;c++){var d=this._targetFeatures[c];a[d.getLayer()]||McxFeatureHelper.instance.copyFields(this._sourceFeature,d);var e=new McxFeatureOperationAction;e.AddUpdateList([d],b);this.base.map.getInputHandler().execute(e)}this.clearSelection()}else McxMessageBox.show(null,
McxLocalizationManager.getLocaleValue("McxEditing-SelectSourceAndTargetFeatures"),McxMessageBoxType.Warning);this.base.setDescription("McxEditing-CopyAttributeSelectSourceFeature")};McxCopyAttributeController.prototype.onMouseDown=function(a){"right"==a.getButton()&&this.copyAttributes();McxCopyAttributeController.superClass_.onMouseDown.call(this,a)};McxCopyAttributeController.prototype.onEndInteraction=function(){this.clearSelection();McxCopyAttributeController.superClass_.onEndInteraction.call(this)};
McxCopyAttributeController.prototype.getOptionUI=function(){return this._controllerUI};js.builtin.McxEditing.Controller.McxCornerLineController={};function McxCornerLineController(){mcx.base(this);this.base=this;this.base.canSet=!1;this.base.applyMode=McxApplyMode.Select;this.base.selectToolMode=McxSelectToolMode.Fence;this.primitiveSecondSelection=this.primitiveFirstSelection=null;this.counter=0;this.activeLayer=null}mcx.inherits(McxCornerLineController,McxSelectController);
McxCornerLineController.prototype.onStartInteraction=function(){McxCornerLineController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxEditing-CornerLineDescription1")};McxCornerLineController.prototype.onEndInteraction=function(){McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();this.base.map.getRenderer().paintNonLayer();McxCornerLineController.superClass_.onEndInteraction.call(this)};
McxCornerLineController.prototype.onMouseDown=function(a){McxCornerLineController.superClass_.onMouseDown.call(this,a);"right"==a.getButton()&&(this.primitiveFirstSelection&&this.primitiveSecondSelection?this.cornerLines(this.base.map):McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-chamferLineNonSelectedAlert"),McxMessageBoxType.Warning,McxDialogButtons.ok))};
McxCornerLineController.prototype.onSelectFeaturesSuccess=function(a){for(var b=a.getFeatures(),c=[],d=0;d<b.length;d++){var e=b[d].getGeometry();if(e.isInstanceOf(McxGeometryType.LineString)||e.isInstanceOf(McxGeometryType.LinearRing)||e.isInstanceOf(McxGeometryType.LineSegment)){c.push(b[d]);break}}0>=c.length||(b=new McxSelectResult(a.getFilter(),c,a.getLayer(),a.getArgs()),McxCornerLineController.superClass_.onSelectFeaturesSuccess.call(this,b),this.primitiveFirstSelection?this.primitiveSecondSelection=
a.getFilter().getGeometry():this.primitiveFirstSelection=a.getFilter().getGeometry())};
McxCornerLineController.prototype.cornerLines=function(a){var b=new McxAjaxParameter;b.setParameters(this,function(b){McxSelectionHelper.instance.clearSelection(a);a.getRenderer().paintSelections();b=McxFeatureHelper.instance.getBB(b.getFeatures());a.getRenderer().paintLayer(this.activeLayer,b)},function(a){McxMessageBox.show("",a.getExceptionMessage().getException(),McxMessageBoxType.Error)});this.activeLayer=a.getLayers().getActiveLayer();var c=this.primitiveFirstSelection.getBounds().getCentroid().clone(),
d=this.primitiveSecondSelection.getBounds().getCentroid().clone(),e=McxSelectionHelper.instance.getSelection(a),f=McxCornerLineController.convertFeaturesToViewport(a.getCoordinateSystem(),e);if(2!=e.length)return McxSelectionHelper.instance.clearSelection(a),a.getRenderer().paintSelections(),!1;if(!f[0].isInstanceOf(McxGeometryType.LineString)||!f[1].isInstanceOf(McxGeometryType.LineString))return!1;var g=f[0],h=f[1],k=g.segmentize(),f=h.segmentize(),h=McxCornerLineController.getClosestSegments(g,
h),m=h[1],g=h[2],h=h[0];if(null==h)return McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-chamferLineCornerLineFailedAlert"),McxMessageBoxType.Error,McxDialogButtons.ok),McxSelectionHelper.instance.clearSelection(a),a.getRenderer().paintSelections(),!1;var n=!1,p=[];p.push(h);for(n=m;0<=n;n--)p.push(k[n].getStartPoint());var q=McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createLineString(p),p=[];p.push(h);p.push(k[m].getEndPoint());for(n=m+1;n<k.length;n++)p.push(k[n].getEndPoint());
k=McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createLineString(p);(n=1>=q.getPoints().length?!1:1>=k.getPoints().length?!0:c.distanceTo(q)<c.distanceTo(k))?e[0].setGeometry(q):e[0].setGeometry(k);e[0].getGeometry().setCoordinateSystem(a.getCoordinateSystem());k=[];k.push(h);for(n=g;0<=n;n--)k.push(f[n].getStartPoint());c=McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createLineString(k);k=[];k.push(h);k.push(f[g].getEndPoint());for(n=g+1;n<f.length;n++)k.push(f[n].getEndPoint());
f=McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createLineString(k);(n=1>=c.getPoints().length?!1:1>=f.getPoints().length?!0:d.distanceTo(c)<d.distanceTo(f))?e[1].setGeometry(c):e[1].setGeometry(f);e[1].getGeometry().setCoordinateSystem(a.getCoordinateSystem());e[0].getLayer().getCoordinateSystem()!=a.getCoordinateSystem()&&e[0].getGeometry().setCoordinateSystem(e[0].getLayer().getCoordinateSystem());d=new McxFeatureOperationAction;d.AddUpdateList([e[0],e[1]],b);this.base.map.getInputHandler().execute(d);
return!0};McxCornerLineController.getClosestSegments=function(a,b){for(var c=a.segmentize(),d=b.segmentize(),e=null,f=Number.MAX_VALUE,g=0,h=0,k=0;k<c.length;k++)for(var m=0;m<d.length;m++){var n=c[k].intersectSegment(d[m],!0);f>c[k].distanceTo(d[m])&&(e=n,f=c[k].distanceTo(d[m]),g=k,h=m)}return[e,g,h]};McxCornerLineController.convertFeaturesToViewport=function(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d].getGeometry();c.push(e.transformTo(a))}return c};js.builtin.McxEditing.Controller.McxCreateBufferController={};function McxCreateBufferController(){mcx.base(this);this.base=this;this.bufferValue=5;this.activeLayer=null;this._controllerUI=new McxControllerUI;this.deleteBaseGeometry=!1;this._bufferEditor=new McxNumberBox(0,Number.MAX_VALUE,8);this._deleteCheckbox=new McxCheckBox;this.createControllerUI()}mcx.inherits(McxCreateBufferController,McxSelectController);
McxCreateBufferController.prototype.onStartInteraction=function(){McxCreateBufferController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxEditing-CreateBufferDescription");if(0==this.bufferValue){var a=this.getOptionUI();a.setIsModal(!0);null==a||a.getUIStatus()||setTimeout($.proxy(function(){a.showUI();a.addClass("slide-left");a.setUIStatus(!0)},this),10)}};
McxCreateBufferController.prototype.onEndInteraction=function(){McxCreateBufferController.superClass_.onEndInteraction.call(this);this.base.map.getRenderer().paintSelections();McxSelectionHelper.instance.clearSelection(this.base.map)};
McxCreateBufferController.prototype.onMouseDown=function(a){McxDeleteFeaturesController.superClass_.onMouseDown.call(this,a);"right"==a.getButton()&&McxSelectionHelper.instance.checkSelection(this.base.map)&&(this.createBuffer()||McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-bufferCreationFailMessage"),McxMessageBoxType.Error))};
McxCreateBufferController.prototype.createBuffer=function(){var a=function(a){},b=function(a){a=a.getArgs();if(!(0>=a.length)){var b=McxFeatureHelper.instance.getBB(a);this.base.map.getRenderer().paintLayer(a[0].getLayer(),b)}},c=function(c){if(this._deleteCheckbox.isChecked()){c=c.getArgs()[0];var d=new McxAjaxParameter;d.setArgs(c);d.setParameters(this,a,b);var e=new McxFeatureOperationAction;e.AddDeleteList([c],d);this.base.map.getInputHandler().execute(e)}},d=function(a){},e=new McxAjaxParameter;
e.setParameters(this,function(a){var b=a.getFeatures();if(0<b.length){var e=McxFeatureHelper.instance.getBB(b);this.base.map.getRenderer().paintLayer(b[0].getLayer(),e);e=a.getArgs()[0];a=a.getArgs()[1];var f=new McxAjaxParameter;f.setAsync(!1);for(var g=0;g<b.length;g++)e[g].setMissing(f),McxFeatureHelper.instance.copyFields(e[g],b[g]);f=new McxAjaxParameter;f.setParameters(this,c,d);f.setArgs([e,a]);e=new McxFeatureOperationAction;e.AddUpdateList(b,f);this.base.map.getInputHandler().execute(e)}},
function(){McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections()});var f=McxSelectionHelper.instance.getSelection(this.base.map);if(null==f||0>=f.length)return McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-NoFeatureSelected"),McxMessageBoxType.Warning,McxDialogButtons.ok),!1;for(var g=[],f=McxFeatureGroup.groupFeatures(f),h=0;h<f.length;h++){for(var k=f[h],m=k.getFeatures(),k=k.getLayer(),n=k.createEdit(),p=[],q=0;q<m.length;q++){p.push(m[q]);
var r=m[q].getGeometry(),t=r.getCoordinateSystem(),r=r.buffer(this.bufferValue);r.setCoordinateSystem(t);t=k.createFeatureBuffer();t.setGeometry(r);t.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&t.getGeometry().setCoordinateSystem(t.getLayer().getCoordinateSystem());g.push(t)}e.setArgs([p,n]);m=new McxFeatureOperationAction;m.AddInsertList(g,e);this.base.map.getInputHandler().execute(m)}McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();
return!0};McxCreateBufferController.prototype.getOptionUI=function(){return this._controllerUI};
McxCreateBufferController.prototype.createControllerUI=function(){this._bufferEditor.setValue(this.bufferValue);this._deleteCheckbox.checked(this.deleteBaseGeometry);0>=this._bufferEditor.getValue()&&this._controllerUI.setOkButtonState(McxButtonState.disabled);this._controllerUI.setTitle("Create Buffer","McxEditing-CreateBuffer");var a=McxSettingsManager.read("McxEditing-CreateBufferSettings",null).getSettings();a&&0<a.length&&(a=JSON.parse(a[0]),this.bufferValue=parseInt(a.Length,10),this.deleteBaseGeometry=
1==parseInt(a.DeleteSelected,10));this._controllerUI.setCancelButtonState(McxButtonState.disabled);this._controllerUI.addControl(new McxLabeledEditor("Buffer",this._bufferEditor,"McxEditing-createBufferControllerBufferValue",5));this._controllerUI.addControl(new McxLabeledEditor("Delete",this._deleteCheckbox,"McxEditing-createBufferControllerDeleteBase",5));this._bufferEditor.setValue(this.bufferValue);this._deleteCheckbox.checked(this.deleteBaseGeometry);this._bufferEditor.getOnChangeHandler().addListener(function(){0>=
this._bufferEditor.getValue()?this._controllerUI.setOkButtonState(McxButtonState.disabled):this._controllerUI.setOkButtonState(McxButtonState.active)},null,this);this._controllerUI.getSubmitHandler().addListener(function(){var a=this._bufferEditor.getValue();a&&(this.bufferValue=parseFloat(a));this.deleteBaseGeometry=this._deleteCheckbox.isChecked();McxSettingsManager.write("McxEditing-CreateBufferSettings",JSON.stringify({Length:this.bufferValue,DeleteSelected:this.deleteBaseGeometry?1:0}),null);
this._controllerUI.hide()},null,this);return this._controllerUI};js.builtin.McxEditing.Controller.McxCreateHoleController={};function McxCreateHoleController(){mcx.base(this);this.base=this;this._selectedShellFeatures=[];this._selectedHoleFeatures=[];this._selectShellMode=!0;this._shellSymbolizer=McxFactoryFinder.StyleFactory().createPolygonSymbolizer();this._holeSymbolizer=McxFactoryFinder.StyleFactory().createPolygonSymbolizer()}mcx.inherits(McxCreateHoleController,McxSelectController);
McxCreateHoleController.prototype.onStartInteraction=function(){McxCreateHoleController.superClass_.onStartInteraction.call(this);this._shellSymbolizer.getFill().setOpacity(.1);this._shellSymbolizer.getStroke().setWidth(4);this._shellSymbolizer.getStroke().setColor("red");this._holeSymbolizer.getFill().setOpacity(.1);this._holeSymbolizer.getStroke().setWidth(2);this._holeSymbolizer.getStroke().setColor("red");this._holeSymbolizer.getStroke().setDashPattern([5,5]);this.base.setDescription("McxEditing-CreateHoleDescription")};
McxCreateHoleController.prototype.onEndInteraction=function(){McxCreateHoleController.superClass_.onEndInteraction.call(this);McxSelectionHelper.instance.clearSelection(this.base.map)};McxCreateHoleController.prototype.onMouseDown=function(a){McxCreateHoleController.superClass_.onMouseDown.call(this,a);"right"==a.getButton()&&(this._selectShellMode?this._selectShellMode=!1:(this.createHoles(),this._selectShellMode=!0))};
McxCreateHoleController.prototype.paint=function(a){McxCreateHoleController.superClass_.paint.call(this,a);if(0<this._selectedShellFeatures.length)for(var b=0;b<this._selectedShellFeatures.length;b++){var c=this._selectedShellFeatures[b].getGeometry();a.getGeodeticGraphics().drawPolygon(c.getShell().getPoints(),this._shellSymbolizer,1,0,0)}if(0<this._selectedHoleFeatures.length)for(b=0;b<this._selectedHoleFeatures.length;b++)c=this._selectedHoleFeatures[b].getGeometry(),a.getGeodeticGraphics().drawPolygon(c.getShell().getPoints(),
this._holeSymbolizer,1,0,0)};
McxCreateHoleController.prototype.createHoles=function(){if(0>=this._selectedShellFeatures.length)McxMessageBox.show("Hata","\u00d6ncelikle d\u0131\u015f nesneleri se\u00e7meniz gerekmektedir",McxMessageBoxType.Error,McxDialogButtons.ok);else if(0>=this._selectedShellFeatures.length)McxMessageBox.show("Hata","\u0130\u00e7 nesneleri se\u00e7meniz gerekmektedir",McxMessageBoxType.Error,McxDialogButtons.ok);else{for(var a=0;a<this._selectedShellFeatures.length;a++){var b=[],c=this._selectedShellFeatures[a].getGeometry();
if(c.isInstanceOf(McxGeometryType.Polygon)){var d=c.getHoles();0<d.length&&(b=b.concat(d));for(d=0;d<this._selectedHoleFeatures.length;d++){var e=this._selectedHoleFeatures[d].getGeometry();if(c.contains(e)){var f=e.getShell().getPoints(),f=f.reverse(),e=McxFactoryFinder.GeometryFactory(e.getCoordinateSystem()).createLinearRing(f);b.push(e)}}0>=b.length||(d=McxFactoryFinder.GeometryFactory(c.getCoordinateSystem()).createPolygon(c.getShell(),b),b=this._selectedShellFeatures[a].getLayer().createEdit(),
c=this._selectedShellFeatures[a].getLayer().findFeature(this._selectedShellFeatures[a].getFeatureID()),c.setGeometry(d),c.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&c.getGeometry().setCoordinateSystem(c.getLayer().getCoordinateSystem()),d=new McxAjaxParameter,d.setAsync(!1),b.update(c,d))}}this._selectedShellFeatures=[];this._selectedHoleFeatures=[];this._selectShellMode=!0;this.base.map.getRenderer().paintLayer(null,null)}};
McxCreateHoleController.prototype.onSelectFeaturesSuccess=function(a){a=a.getFeatures();for(var b=0;b<a.length;b++){var c=a[b],d=c.getGeometry();if(d.isInstanceOf(McxGeometryType.Polygon)||d.isInstanceOf(McxGeometryType.MultiPolygon))this._selectShellMode?this.add(this._selectedShellFeatures,c):this.containAny(this._selectedShellFeatures,c)||this.add(this._selectedHoleFeatures,c)}};
McxCreateHoleController.prototype.containAny=function(a,b){for(var c=!1,d=0;d<a.length;d++)a[d].getFeatureID()==b.getFeatureID()&&(c=!0);return c};McxCreateHoleController.prototype.add=function(a,b){this.containAny(a,b)||a.push(b);return a};js.builtin.McxEditing.Controller.McxCreateParallelController={};function McxCreateParallelController(){mcx.base(this);this.lastCursor=McxCursors.Default;this.distanceValue=5;this.activeLayer=null;this.segmentize=!0;this.canClick=this.deleteBaseGeometry=!1;this.layerActive=null;this.base=this;this._controllerUI=new McxControllerUI;this._distanceEditor=new McxNumberBox(0,Number.MAX_VALUE,8);this._deletebaseCheckbox=new McxCheckBox;this._segmentizeCheckbox=new McxCheckBox;this.createControllerUI()}
mcx.inherits(McxCreateParallelController,McxSelectController);McxCreateParallelController.prototype.onStartInteraction=function(){McxCreateParallelController.superClass_.onStartInteraction.call(this);McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();this.base.setDescription("McxEditing-CreateParallelDescription1");this.lastCursor=this.base.getCursor();0==this.distanceValue&&(this._distanceEditor.setValue(0),this._controllerUI.setIsModal(!0),this._controllerUI.showUI())};
McxCreateParallelController.prototype.onEndInteraction=function(){McxCreateParallelController.superClass_.onEndInteraction.call(this);McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections()};
McxCreateParallelController.prototype.onMouseDown=function(a){this.canClick?"left"==a.getButton()&&(1!=McxSelectionHelper.instance.getSelectionCount(this.base.map)?(this.canClick=!1,this.base.setCursor(this.lastCursor),this.base.setDescription("McxEditing-CreateParallelDescription1"),McxSelectionHelper.instance.clearSelection(this.base.map),this.base.map.getRenderer().paintSelections()):(a=McxFactoryFinder.GeometryFactory(null).createPoint(a.getX(),a.getY()),this.createParallel(a)||(this.base.setCursor(this.lastCursor),
this.base.setDescription("McxEditing-CreateParallelDescription1"),McxSelectionHelper.instance.clearSelection(this.base.map),this.base.map.getRenderer().paintSelections(),this.canClick=!1))):McxCreateParallelController.superClass_.onMouseDown.call(this,a)};
McxCreateParallelController.prototype.onSelectFeaturesSuccess=function(a){if(!this.canClick){var b=a.getFeatures();0>=b.length||(1<b.length&&(b=[b[0]]),a=new McxSelectResult(a.getFilter(),b,a.getLayer(),a.getArgs()),McxCreateParallelController.superClass_.onSelectFeaturesSuccess.call(this,a),this.canClick=!0,this.lastCursor=this.base.getCursor(),this.base.setCursor(McxCursors.crossHair),this.base.setDescription("McxEditing-CreateParallelDescription2"),this.base.map.getRenderer().paintNonLayer())}};
McxCreateParallelController.prototype.createParallel=function(a){if(null==a)return!1;var b=this.base.map.viewToWorld(a.getX(),a.getY());a=function(){this.base.setCursor(this.lastCursor);this.base.setDescription("McxEditing-CreateParallelDescription1");McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();this.canClick=!1};var c=new McxAjaxParameter;c.setParameters(this,this.insertSuccess,a);this.layerActive=this.base.map.getLayers().getActiveLayer();
var d=McxSelectionHelper.instance.getSelection(this.base.map);if(1!=d.length)return!1;var e=d[0].getGeometry(),f=McxFactoryFinder.GeometryFactory(e.getCoordinateSystem());if(e.isInstanceOf(McxGeometryType.LineString)){var g=e.transformTo(this.base.map.getCoordinateSystem()),e=g.offset(this.distanceValue),g=g.offset(-1*this.distanceValue),e=b.distanceTo(e)<b.distanceTo(g)?e:g;if(this.segmentize){for(var h=e.segmentize(),g=Number.MAX_VALUE,k=e=0;k<h.length;k++){var m=b.distanceTo(h[k]);g>m&&(g=m,e=
k)}f=f.createLineString(h[e].getPoints());b=this.layerActive.createFeatureBuffer();b.setGeometry(f)}else e.setCoordinateSystem(this.base.map.getCoordinateSystem()),b=this.layerActive.createFeatureBuffer(),b.setGeometry(e);b.getLayer().getCoordinateSystem()!=McxApplication.getActiveMap().getCoordinateSystem()&&b.getGeometry().setCoordinateSystem(b.getLayer().getCoordinateSystem());f=new McxFeatureOperationAction;f.AddInsertList([b],c);this.base.map.getInputHandler().execute(f);McxFeatureHelper.instance.copyFields(d[0],
b)}else if(e.isInstanceOf(McxGeometryType.Polygon))if(e=e.transformTo(this.base.map.getCoordinateSystem()),f=e.buffer(this.distanceValue),e=e.buffer(-1*this.distanceValue),f=b.distanceTo(f)<b.distanceTo(e)?f:e,f.setCoordinateSystem(this.base.map.getCoordinateSystem()),this.segmentize){f=f.getShell().segmentize();g=Number.MAX_VALUE;for(h=e=0;h<f.length;h++)m=b.distanceTo(f[h]),g>m&&(g=m,e=h);f[e].setCoordinateSystem(this.base.map.getCoordinateSystem());b=[];b.push(f[e].getStartPoint().clone());b.push(f[e].getEndPoint().clone());
f=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createLineString(b);b=this.layerActive.createFeatureBuffer();b.setGeometry(f);b.getLayer().getCoordinateSystem()!=McxApplication.getActiveMap().getCoordinateSystem()&&b.getGeometry().setCoordinateSystem(b.getLayer().getCoordinateSystem());McxFeatureHelper.instance.copyFields(d[0],b);f=new McxFeatureOperationAction;f.AddInsertList([b],c);this.base.map.getInputHandler().execute(f)}else f=f.clone(),f.setCoordinateSystem(this.base.map.getCoordinateSystem()),
b=this.layerActive.createFeatureBuffer(),b.setGeometry(f),b.getLayer().getCoordinateSystem()!=McxApplication.getActiveMap().getCoordinateSystem()&&b.getGeometry().setCoordinateSystem(b.getLayer().getCoordinateSystem()),f=new McxFeatureOperationAction,f.AddInsertList([b],c),this.base.map.getInputHandler().execute(f),McxFeatureHelper.instance.copyFields(d[0],b);c=new McxAjaxParameter;c.setParameters(this,this.deleteSuccess,a);this.deleteBaseGeometry&&(c.setArgs(d[0].getClone()),f=new McxFeatureOperationAction,
f.AddDeleteList([d[0]],c),this.base.map.getInputHandler().execute(f));return!0};McxCreateParallelController.prototype.insertSuccess=function(a){a=a.getFeatures();0<a.length&&this.base.map.getRenderer().paintLayer(a[0].getLayer(),McxFeatureHelper.instance.getBB(a));this.base.setDescription("McxEditing-CreateParallelDescription1");this.base.setCursor(this.lastCursor);McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();this.canClick=!1};
McxCreateParallelController.prototype.deleteSuccess=function(a){var b=a.getFeatures();1==b.length&&(a=b[0].getLayer(),b=McxFeatureHelper.instance.getBB(b),this.base.map.getRenderer().paintLayer(a,b))};McxCreateParallelController.prototype.getOptionUI=function(){return this._controllerUI};
McxCreateParallelController.prototype.createControllerUI=function(){this._controllerUI.setTitle("Create Parallel","McxEditing-CreateParallel");var a=McxSettingsManager.read("McxEditing-CreateParallelSettings",null).getSettings();a&&0<a.length&&(a=JSON.parse(a[0]),this.distanceValue=parseInt(a.Distance,10),this.deleteBaseGeometry=1==parseInt(a.DeleteGeometry,10),this.segmentize=1==parseInt(a.Segmentize,10));this._deletebaseCheckbox.checked(this.deleteBaseGeometry);this._segmentizeCheckbox.checked(this.segmentize);
this._distanceEditor.setValue(this.distanceValue);this._controllerUI.setCancelButtonState(McxButtonState.disabled);0>=this._distanceEditor.getValue()&&this._controllerUI.setOkButtonState(McxButtonState.disabled);this._distanceEditor.getOnChangeHandler().addListener(function(){0>=this._distanceEditor.getValue()?this._controllerUI.setOkButtonState(McxButtonState.disabled):this._controllerUI.setOkButtonState(McxButtonState.active)},null,this);this._controllerUI.getSubmitHandler().addListener(function(){this.distanceValue=
this._distanceEditor.getValue();this.deleteBaseGeometry=this._deletebaseCheckbox.isChecked();this.segmentize=this._segmentizeCheckbox.isChecked();McxSettingsManager.write("McxEditing-CreateParallelSettings",JSON.stringify({Distance:this.distanceValue,DeleteGeometry:this.deleteBaseGeometry?1:0,Segmentize:this.segmentize?1:0}),null);this._controllerUI.hide()},null,this);this._controllerUI.addControl(new McxLabeledEditor("Distance",this._distanceEditor,"McxEditing-createParallelControllerDistance",5));
this._controllerUI.addControl(new McxLabeledEditor("Delete Base",this._deletebaseCheckbox,"McxEditing-createParallelControllerDeleteBase",5));this._controllerUI.addControl(new McxLabeledEditor("Segmentize",this._segmentizeCheckbox,"McxEditing-createParallelControllerSegmentize",5))};McxCreateParallelController.prototype.paint=function(a){this.canClick||McxCreateParallelController.superClass_.paint.call(this,a)};js.builtin.McxEditing.Controller.McxDeleteFeaturesController={};function McxDeleteFeaturesController(){mcx.base(this);this.base=this;this.base.canSet=!1;this.base.applyMode=McxApplyMode.Select;this.base.selectToolMode=McxSelectToolMode.Fence}mcx.inherits(McxDeleteFeaturesController,McxSelectController);McxDeleteFeaturesController.prototype.onStartInteraction=function(){McxDeleteFeaturesController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxEditing-DeleteDescription")};
McxDeleteFeaturesController.prototype.onEndInteraction=function(){McxDeleteFeaturesController.superClass_.onEndInteraction.call(this);McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections()};
McxDeleteFeaturesController.prototype.onMouseDown=function(a){McxDeleteFeaturesController.superClass_.onMouseDown.call(this,a);"right"==a.getButton()&&McxSelectionHelper.instance.checkSelection(this.base.map)&&(a=McxSelectionHelper.instance.getSelection(this.base.map),(new McxDeleteFeatureAction(a)).execute(this.base.map))};js.builtin.McxEditing.Controller.McxDeleteVertexController={};function McxDeleteVertexController(){mcx.base(this);this.markerId=McxGuid.createGuid();this.markers=null;this.selectBuffer=this.snapBuffer=10;this.features=[];this.pointSymbolizer=new McxPointSymbolizer;this.shiftKeyPressed=!1;this.base=this;this.initialize()}mcx.inherits(McxDeleteVertexController,McxSnappableController);
McxDeleteVertexController.prototype.initialize=function(){var a=new McxStroke;a.setColor("blue");var b=new McxSquareMark;b.setStroke(a);a=new McxFill;a.setColor("transparent");b.setFill(a);this.pointSymbolizer.setSymbols([b])};McxDeleteVertexController.prototype.onKeyUp=function(a){McxDeleteVertexController.superClass_.onKeyUp.call(this,a);a.getKeyCode()==McxKeyCode.shift&&(this.shiftKeyPressed=!1)};
McxDeleteVertexController.prototype.onKeyDown=function(a){McxDeleteVertexController.superClass_.onKeyDown.call(this,a);a.getKeyCode()==McxKeyCode.shift&&(this.shiftKeyPressed=!0)};
McxDeleteVertexController.prototype.onStartInteraction=function(){McxDeleteVertexController.superClass_.onStartInteraction.call(this);this.markers=[];this.features=this.features.concat(McxSelectionHelper.instance.getSelection(this.base.map));for(var a=0;a<this.features.length;a++)this.markers.push(null);this.base.setDescription("McxEditing-DeleteVertexDescription");this.base.setCursor(McxCursors.selectFeature)};
McxDeleteVertexController.prototype.onEndInteraction=function(){this.features=[];this.markers=[];McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();this.base.map.getRenderer().paintNonLayer();McxDeleteVertexController.superClass_.onEndInteraction.call(this)};
McxDeleteVertexController.prototype.paint=function(a){McxDeleteVertexController.superClass_.paint.call(this,a);var b=McxSelectionHelper.instance.getSelection(this.base.map);null==this.features&&(this.features=[],this.features=b);for(var c=0;c<b.length;c++)for(var d=McxGeometryHelper.instance.getPoints(b[c],this.base.map.getCoordinateSystem()),e=0;e<d.length;e++)a.getGeodeticGraphics().drawPoint(d[e],this.pointSymbolizer,1,0,0)};
McxDeleteVertexController.prototype.onCoordinateCreated=function(a,b){var c=[],d=function(a){McxMessageBox.show("",a.getExceptionMessage().getException(),McxMessageBoxType.Error)},e=new McxAjaxParameter;e.setParameters(this,function(a){var b=a.getArgs();a=a.getFeatures();a=a.concat(b);b=McxFeatureHelper.instance.groupByLayer(a);for(a=0;a<b.length;a++){var c=b[a].getLayer(),d=b[a].getFeatures(),d=McxFeatureHelper.instance.getBB(d);this.base.map.getRenderer().paintLayer(c,d)}},d);var f=new McxAjaxParameter;
f.setParameters(this,function(a){for(var b=a.getFeatures(),c=[],d=0;d<b.length;d++){var e=b[d].getGeometry();e.isInstanceOf(McxGeometryType.Point)||e.isInstanceOf(McxGeometryType.MultiPoint)?McxSelectionHelper.instance.removeSelection(this.base.map,b[d]):c.push(b[d])}null!=a.getFeatures()&&(this.features=this.features.concat(c))},d);var d=!1,g=[];if(!this.shiftKeyPressed){for(var h=McxFeatureGroup.groupFeatures(this.features),k={},m=0;m<h.length;m++)for(var n=h[m],p=n.getFeatures(),q=!1,r=0;r<p.length;r++){var t=
p[r];if(t.getLayer().getEditable()){g.push(t.getClone());var u=new McxMemFeature(t.getLayer(),null);u.setFeatureID(t.getFeatureID());var v=t.getGeometry(),w=McxFactoryFinder.GeometryFactory(v.getCoordinateSystem());if(v.isInstanceOf(McxGeometryType.LineString)){w=t.getGeometry().clone();v=[];v.push(w);if(!this.removeVertex(v,b,!1))continue;d=!0;u.setGeometry(w)}else if(v.isInstanceOf(McxGeometryType.Polygon)){var x=t.getGeometry().clone(),v=[];v.push(x.getShell());for(var y=x.getHoles(),A=0;A<y.length;A++)v.push(y[A]);
if(!this.removeVertex(v,b,!0))continue;x.setShell(w.createLinearRing(v[0].getPoints()));x.getShell().closeRing();if(1<v.length)for(x.setHoles([]),y=1;y<v.length;y++)A=w.createLinearRing(v[m].getPoints()),A.closeRing(),x.setHoles(x.getHoles().concat(A));d=!0;u.setGeometry(x)}else if(v.isInstanceOf(McxGeometryType.MultiPolygon)){for(var B=t.getGeometry().clone(),z=B.getPolygons(),C=!1,D=0;D<z.length;D++){x=z[D];v=[];v.push(x.getShell());y=x.getHoles();for(A=0;A<y.length;A++)v.push(y[A]);if(this.removeVertex(v,
b,!0)&&(C=!0,x.setShell(w.createLinearRing(v[0].getPoints())),x.getShell().closeRing(),1<v.length))for(x.setHoles([]),y=1;y<v.length;y++)A=w.createLinearRing(v[m].getPoints()),A.closeRing(),x.setHoles(x.getHoles().concat(A))}C&&(d=!0,u.setGeometry(B))}else continue;d&&(t.setGeometry(u.getGeometry()),e.setArgs(g),u.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&u.getGeometry().setCoordinateSystem(u.getLayer().getCoordinateSystem()),t=new McxFeatureOperationAction,t.AddUpdateList([u],
e),this.base.map.getInputHandler().execute(t),q||(q=!0),c.push(n.getLayer()))}else u=t.getLayer().getName(),k[u]=u}c="";e=0;for(m in k)1<=e&&(c+=" and "),c+=m,e++;1<=e&&(k=McxLocalizationManager.getLocaleValue("McxBase-notEditableLayer"),k=String.format(k,c),McxMessageBox.show("",k,McxMessageBoxType.Warning,McxDialogButtons.ok))}d||this.getSelected(f,b)};
McxDeleteVertexController.prototype.getSelected=function(a,b){var c=new McxSelectFilter,d=this.base.map.worldToView(b.getX(),b.getY()),e=this.selectBuffer/2,f=this.base.map.viewToWorld(d.getX()-e,d.getY()-e),g=this.base.map.viewToWorld(d.getX()+e,d.getY()+e),d=Math.min(f.getX(),g.getX()),e=Math.min(f.getY(),g.getY()),h=Math.max(f.getX(),g.getX()),f=Math.max(f.getY(),g.getY()),f=McxFactoryFinder.GeometryFactory(null).createBounds(d,e,h,f),f=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createPolygon(f,
null);c.setGeometry(f);c.setSpatialRelation(McxSpatialRelation.Intersects);d=[];e=McxSelectionHelper.instance.getSelectableLayer(this.base.map);for(f=0;f<e.length;f++)d.push(new McxFieldSet(e[f],null));c.setFieldSets(d);d=this.base.map.getLayers().toLayerArray();for(e=0;e<d.length;e++)if(h=this.base.map.getPaintedFeatures(d[e]).getAll(),g=McxSelectionHelper.instance.hitTestByScreenFeatures(this.base.map,h,c),0!=g.length){var k=!0;for(f in g){h=new McxMemFeature(d[e],null);h.setFeatureID(parseInt(f,
10));h.setGeometry(g[f]);var m=McxSelectionHelper.instance.isSelected(h);m||(k=!1);if(m&&this.shiftKeyPressed){McxSelectionHelper.instance.removeSelection(this.base.map,h);for(c=0;c<this.features.length;c++)this.features[c].getFeatureID()==h.getFeatureID()&&this.features.splice(c,1);this.base.map.getRenderer().paintLayer(h.getLayer(),h.getGeometry().getBounds());return}}if(k)return}McxSelectionHelper.instance.applyFilter(a,this.base.map,c)};
McxDeleteVertexController.prototype.removeVertex=function(a,b,c){for(var d=0;d<a.length;d++){var e=a[d],f=e.transformTo(this.base.map.getCoordinateSystem()).getPoints();if(c&&4>=f.length)break;if(!c&&3>f.length)break;for(var g=this.base.map.worldToView(b.getX(),b.getY()),h=null,k=0,m=0;m<f.length;m++)if(!(this.base.map.worldToView(f[m].getX(),f[m].getY()).distanceTo(g)>this.snapBuffer)){h=f[m];k=m;break}if(null!=h)return 0!=k&&k!=e.getPoints().length-1||!e.getPoints()[0].equals(e.getPoints()[e.getPoints().length-
1])?e.getPoints().splice(k,1):(e.getPoints().splice(0,1),e.getPoints().splice(e.getPoints().length-1,1),e.getPoints().push(e.getPoints()[0].clone())),a[d]=e,!0}return!1};js.builtin.McxEditing.Controller.McxDifferenceController={};function McxDifferenceController(){mcx.base(this);this._geometry=this._targetLayer=this._secondFeature=this._firstFeature=this._dialog=null;this.base=this}mcx.inherits(McxDifferenceController,McxSelectController);
McxDifferenceController.prototype.onStartInteraction=function(){McxDifferenceController.superClass_.onStartInteraction.call(this);McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();this.base.setDescription("McxEditing-DifferenceDescription");this._secondFeature=this._firstFeature=null;this.getSelectionCompletedEventHandler().removeListener(this.onFeaturesSelected);this.getSelectionCompletedEventHandler().addListener(this.onFeaturesSelected,null,
this)};McxDifferenceController.prototype.onFeaturesSelected=function(){var a=McxSelectionHelper.instance.getSelection(this.base.map);0==a.length?this._secondFeature=this._firstFeature=null:1==a.length?(this._firstFeature=a[0],this._secondFeature=null):1<a.length&&(null==this._firstFeature?(this._firstFeature=a[0],this._secondFeature=a[1]):this._firstFeature.getFeatureID()==a[0].getFeatureID()?this._secondFeature=a[1]:this._secondFeature=a[0])};
McxDifferenceController.prototype.onMouseDown=function(a){McxDifferenceController.superClass_.onMouseDown.call(this,a);if("right"==a.getButton())if(null==this._firstFeature||null==this._secondFeature)McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-selectTwoFeatureMessage"),McxMessageBoxType.Warning),McxSelectionHelper.instance.clearSelection(this.base.map),this.base.map.getRenderer().paintSelections();else if(this._firstFeature.getGeometry().intersects(this._secondFeature.getGeometry()))try{this._geometry=
McxGeospatialServiceManager.difference(this._firstFeature.getGeometry(),this._secondFeature.getGeometry());var b=McxMarkerHelper.instance.createMarkerFromGeometry(this._geometry,McxGuid.createGuid());this.base.map.getMarkerCollection().addRange(b);this.base.map.getRenderer().paintNonLayer();var c=McxMapHelper.getSelectableLayers(this.base.map);this._dialog=new McxSaveEditResultDialog(c);this._dialog.getOkButtonClickHandler().addListener(this.applyOperation,null,this);this._dialog.onCloseDialog().addListener(this.dialogClosed,
null,this);this._dialog.showDialog(!0,!1);var d=McxLocalizationManager.getLocaleValue("McxEditing-Difference");this._dialog.setTitle(d,"McxEditing-Difference")}catch(e){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-SelectedGeometriesNotIntersectsOrEquals"),McxMessageBoxType.Warning)}else McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-SelectedGeometriesNotIntersects"),McxMessageBoxType.Warning),McxSelectionHelper.instance.clearSelection(this.base.map),
this.base.map.getRenderer().paintSelections()};
McxDifferenceController.prototype.applyOperation=function(){this._dialog.onCloseDialog().removeListener(this.applyOperation);this.base.setCursor(this.getCursor());this.base.setDescription("McxEditing-DifferenceDescription");this._targetLayer=this._dialog.getLayer();var a=McxGeometryHelper.instance.createGeometryWithType(this._geometry,this._targetLayer.getGeometryType(),this._targetLayer.getCoordinateSystem());if(null==a)McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-GeometryTypeNotSupportedError"),McxMessageBoxType.Error);
else{var b=this._targetLayer.createFeatureBuffer();b.setGeometry(a);a=new McxAjaxParameter;a.setParameters(this,this.insertSuccess,this.commitFail);var c=new McxFeatureOperationAction;c.AddInsertList([b],a);this.base.map.getInputHandler().execute(c)}};McxDifferenceController.prototype.dialogClosed=function(){this.base.map.getMarkerCollection().clear();McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections()};
McxDifferenceController.prototype.insertSuccess=function(a){a=a.getFeatures();var b=McxFeatureHelper.instance.getBB(a);this.base.map.getRenderer().paintLayer(this._targetLayer,b);if(0!=a.length)if(b=McxFeatureHelper.instance.groupByLayer([this._firstFeature,this._secondFeature]),1<b.length&&b[0].getLayer().getName()==this._targetLayer.getName()){a=a[0];var b=this._firstFeature,c=new McxAjaxParameter;c.setAsync(!1);b.setMissing(c);McxFeatureHelper.instance.copyFields(b,a);b=new McxAjaxParameter;b.setParameters(this,
this.updateSuccess,this.commitFail);c=new McxFeatureOperationAction;c.AddUpdateList([a],b);this.base.map.getInputHandler().execute(c)}else this.deleteFeatures()};McxDifferenceController.prototype.updateSuccess=function(){this.deleteFeatures()};
McxDifferenceController.prototype.deleteFeatures=function(){if(this._dialog.getDeleteStatus()){var a=new McxAjaxParameter;a.setParameters(this,this.deleteSuccess,this.commitFail);var b=new McxFeatureOperationAction;b.AddDeleteList([this._firstFeature],a);b.AddDeleteList([this._secondFeature],a);this.base.map.getInputHandler().execute(b)}else McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-ProcessCompleted"),McxMessageBoxType.Information)};
McxDifferenceController.prototype.deleteSuccess=function(a){a=McxFeatureHelper.instance.groupByLayer(a.getFeatures());for(var b=0;b<a.length;b++){var c=McxFeatureHelper.instance.getBB(a[b].getFeatures());this.base.map.getRenderer().paintLayer(a[b].getLayer(),c)}McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-ProcessCompleted"),McxMessageBoxType.Information)};
McxDifferenceController.prototype.commitFail=function(a){var b="",b=null!=a?a.getException():McxLocalizationManager.getLocaleValue("McxEditing-ErrorOccured");McxMessageBox.show("",b,McxMessageBoxType.Error)};js.builtin.McxEditing.Controller.McxEditVertexController={};function McxEditVertexController(){mcx.base(this);this.markerId=McxGuid.createGuid();this.selectBuffer=this.snapBuffer=10;this.features=[];this.markers=[];this.pointSymbolizer=new McxPointSymbolizer;this.isMoving=!1;this.canSelect=!0;this.shiftKeyPressed=!1;this.coordinates=[];this.base=this;this.initialize()}mcx.inherits(McxEditVertexController,McxSnappableController);
McxEditVertexController.prototype.initialize=function(){var a=new McxStroke;a.setColor("blue");var b=new McxSquareMark;b.setStroke(a);a=new McxFill;a.setColor("transparent");b.setFill(a);this.pointSymbolizer.setSymbols([b])};
McxEditVertexController.prototype.onStartInteraction=function(){McxEditVertexController.superClass_.onStartInteraction.call(this);this.markers=[];this.features=this.features.concat(McxSelectionHelper.instance.getSelection(this.base.map));for(var a=0;a<this.features.length;a++)this.markers.push(null);this.base.setDescription("McxEditing-EditVertexDescription");this.base.setCursor(McxCursors.selectFeature)};
McxEditVertexController.prototype.onEndInteraction=function(){this.features=[];this.markers=[];McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();this.base.map.getRenderer().paintNonLayer();McxEditVertexController.superClass_.onEndInteraction.call(this)};
McxEditVertexController.prototype.paint=function(a){McxEditVertexController.superClass_.paint.call(this,a);for(var b=this.base.map.getWorld(),c=McxSelectionHelper.instance.getSelection(this.base.map),d=0;d<c.length;d++)for(var e=McxGeometryHelper.instance.getPoints(c[d],this.base.map.getCoordinateSystem()),f=0;f<e.length;f++)b.contains(e[f].getX(),e[f].getY())&&a.getGeodeticGraphics().drawPoint(e[f],this.pointSymbolizer,1,0,0);if(0!=this.markers.length)for(d=0;d<this.markers.length;d++)b=this.markers[d],
null!=b&&b.paint(a)};McxEditVertexController.prototype.onMouseMove=function(a){McxEditVertexController.superClass_.onMouseMove.call(this,a);a=this.base.map.viewToWorld(a.getX(),a.getY());this.changeTransform(a);this.base.map.getRenderer().paintNonLayer()};McxEditVertexController.prototype.onKeyUp=function(a){McxEditVertexController.superClass_.onKeyUp.call(this,a);a.getKeyCode()==McxKeyCode.f4&&(this.features=[],this.markers=[]);a.getKeyCode()==McxKeyCode.shift&&(this.shiftKeyPressed=!1)};
McxEditVertexController.prototype.onKeyDown=function(a){McxEditVertexController.superClass_.onKeyDown.call(this,a);a.getKeyCode()==McxKeyCode.shift&&(this.shiftKeyPressed=!0)};
McxEditVertexController.prototype.onCoordinateCreated=function(a,b){!this.shiftKeyPressed&&0<this.features.length&&(this.coordinates.push(b),1==this.coordinates.length?this.startTransform():2==this.coordinates.length&&this.endTransform());if(this.canSelect){var c=new McxAjaxParameter;c.setParameters(this,function(){this.markers=[];this.features=[];for(var a=McxSelectionHelper.instance.getSelection(this.base.map),b=[],c=0;c<a.length;c++){var g=a[c].getGeometry();g.isInstanceOf(McxGeometryType.Point)||
g.isInstanceOf(McxGeometryType.MultiPoint)?McxSelectionHelper.instance.removeSelection(this.base.map,a[c]):b.push(a[c])}this.features=this.features.concat(b);for(c=0;c<this.features.length;c++)this.markers.push(null);this.base.map.getRenderer().paintNonLayer();this.coordinates=[]},function(){});this.getSelected(c,b)}this.isMoving||(this.canSelect=!0)};McxEditVertexController.prototype.clear=function(){for(var a=0;a<this.markers.length;a++)this.markers[a]=null;this.coordinates=[]};
McxEditVertexController.prototype.getSelected=function(a,b){var c=new McxSelectFilter,d=this.base.map.worldToView(b.getX(),b.getY()),e=this.selectBuffer/2,f=this.base.map.viewToWorld(d.getX()-e,d.getY()-e),g=this.base.map.viewToWorld(d.getX()+e,d.getY()+e),d=Math.min(f.getX(),g.getX()),e=Math.min(f.getY(),g.getY()),h=Math.max(f.getX(),g.getX()),f=Math.max(f.getY(),g.getY()),f=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createBounds(d,e,h,f),f=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createPolygon(f,
null);f.setCoordinateSystem(this.base.map.getCoordinateSystem());c.setGeometry(f);c.setSpatialRelation(McxSpatialRelation.Intersects);d=[];e=McxSelectionHelper.instance.getSelectableLayer(this.base.map);for(f=0;f<e.length;f++)d.push(new McxFieldSet(e[f],null));c.setFieldSets(d);d=this.base.map.getLayers().toLayerArray();for(e=0;e<d.length;e++)if(h=this.base.map.getPaintedFeatures(d[e]).getAll(),g=McxSelectionHelper.instance.hitTestByScreenFeatures(this.base.map,h,c),0!=g.length){var k=!0;for(f in g){h=
new McxMemFeature(d[e],null);h.setFeatureID(parseInt(f,10));h.setGeometry(g[f]);var m=McxSelectionHelper.instance.isSelected(h);m||(k=!1);if(h.getGeometry().isInstanceOf(McxGeometryType.Point)||h.getGeometry().isInstanceOf(McxGeometryType.MultiPoint))McxSelectionHelper.instance.removeSelection(this.base.map,h);else if(m&&this.shiftKeyPressed){McxSelectionHelper.instance.removeSelection(this.base.map,h);for(c=0;c<this.features.length;c++)this.features[c].getFeatureID()==h.getFeatureID()&&this.features.splice(c,
1);this.base.map.getRenderer().paintLayer(h.getLayer(),h.getGeometry().getBounds().transformTo(this.base.map.getCoordinateSystem()));return}}if(k)return}McxSelectionHelper.instance.applyFilter(a,this.base.map,c)};
McxEditVertexController.prototype.changeTransform=function(a){for(var b=!1,c=0;c<this.features.length;c++){var d=this.markers[c];if(null!=d&&null!=d.getTag()){var e=d.getTag();if(d.getGeometry().isInstanceOf(McxGeometryType.MultiPolygon))for(var d=d.getGeometry(),f=0;f<d.getPolygons().length;f++){var g=d.getPolygons()[f],h=g.getShell(),k=h.getPoints().length;if(k>e)0==e||e==k-1?(h.getPoints()[0]=a.clone(),h.getPoints()[k-1]=a.clone()):h.getPoints()[e]=a.clone();else{for(var h=g.getHoles[0],m=g.getShell().getPoints().length,
k=!1,n=0;n<g.getHoles().length;n++){if(m+g.getHoles()[n].getPoints().length>e){m+g.getHoles()[n].getPoints().length-1==e&&(k=!0);m==e&&(k=!0);h=g.getHoles()[n];break}m+=g.getHoles()[n].getPoints().length}k?(h.getPoints()[0]=a.clone(),h.getPoints()[h.getPoints().length-1]=a.clone()):h.getPoints()[e-m]=a.clone()}}else if(d.getGeometry().isInstanceOf(McxGeometryType.Polygon))if(g=d.getGeometry(),h=g.getShell(),k=h.getPoints().length,k>e)0==e||e==k-1?(h.getPoints()[0]=a.clone(),h.getPoints()[k-1]=a.clone()):
h.getPoints()[e]=a.clone();else{h=g.getHoles[0];m=g.getShell().getPoints().length;k=!1;for(n=0;n<g.getHoles().length;n++){if(m+g.getHoles()[n].getPoints().length>e){m+g.getHoles()[n].getPoints().length-1==e&&(k=!0);m==e&&(k=!0);h=g.getHoles()[n];break}m+=g.getHoles()[n].getPoints().length}k?(h.getPoints()[0]=a.clone(),h.getPoints()[h.getPoints().length-1]=a.clone()):h.getPoints()[e-m]=a.clone()}else if(d.getGeometry().isInstanceOf(McxGeometryType.MultiLineString))h=d.getGeometry().getLines()[0],h.getPoints()[e]=
a.clone();else if(d.getGeometry().isInstanceOf(McxGeometryType.LineString))h=d.getGeometry(),h.getPoints()[e]=a.clone();else if(d.getGeometry().isInstanceOf(McxGeometryType.Point))d.getGeometry(),a.clone();else continue;b||(b=!0)}}};
McxEditVertexController.prototype.startTransform=function(){for(var a=!1,b=this.base.map.getCoordinateSystem(),c=this.base.map.worldToView(this.coordinates[0].getX(),this.coordinates[0].getY()),d={},e=0;e<this.features.length;e++){var f=this.features[e];if(f.getLayer().getEditable()){for(var g=-1,h=McxGeometryHelper.instance.getPoints(f,b),k=0;k<h.length;k++)if(this.base.map.worldToView(h[k].getX(),h[k].getY()).distanceTo(c)<=this.snapBuffer){g=k;a=!0;break}0>g||(k=McxMarkerHelper.instance.createMarker(f,
this.markerId,this.base.map.getCoordinateSystem()),null!=k&&(k[0].setTag(g),this.markers[e]=k[0]))}else g=f.getLayer().getName(),d[g]=g}if(a)this.isMoving=!0,this.canSelect=!1;else{for(e=0;e<this.features.length;e++)if(f=this.features[e],f.getLayer().getEditable()){a=new McxMemFeature(f.getLayer(),null);a.setFeatureID(f.getFeatureID());var b=f.getGeometry(),h=McxFactoryFinder.GeometryFactory(b.getCoordinateSystem()),m=[];if(b.isInstanceOf(McxGeometryType.LineString))m.push(h.createLineString(f.getGeometry().getPoints()));
else if(b.isInstanceOf(McxGeometryType.MultiLineString))m.push(h.createLineString(f.getGeometry().getLines()[0].getPoints()));else if(b.isInstanceOf(McxGeometryType.Polygon)){m.push(h.createLineString(f.getGeometry().getShell().getPoints()));for(var n=f.getGeometry().getHoles(),p=0;p<n.length;p++)m.push(n[p])}else if(f.getGeometry().isInstanceOf(McxGeometryType.MultiPolygon))for(var q=f.getGeometry().clone(),g=q.getPolygons(),k=0;k<g.length;k++){var r=g[k];m.push(h.createLineString(r.getShell().getPoints()));
n=r.getHoles();for(p=0;p<n.length;p++)m.push(n[p])}else continue;for(p=n=0;p<m.length;p++){for(var g=-1,r=null,t=m[p],q=t.transformTo(this.base.map.getCoordinateSystem()),u=q.segmentize(),k=0;k<u.length;k++){var v=this.base.map.worldToView(u[k].getStartX(),u[k].getStartY()),w=this.base.map.worldToView(u[k].getEndX(),u[k].getEndY()),v=h.createLineSegment(v,w);if(!(c.distanceTo(v)>this.snapBuffer||v.getStartPoint().equals(c)||v.getEndPoint().equals(c)||(r=u[k].getPerpendicularFoot(this.coordinates[0],
!1),r.equals(u[k].getStartPoint())||r.equals(u[k].getEndPoint())))){g=k+1;break}}if(0>g)n+=t.getPoints().length;else{t=h.createLineString(q.getPoints());t.insertPoints(g,r);if(b.isInstanceOf(McxGeometryType.Polygon))r=b,1>p?(u=h.createLinearRing(t.getPoints()),r.setShell(u),f.getGeometry().setCoordinateSystem(this.base.map.getCoordinateSystem())):(u=h.createLinearRing(t.getPoints()),r.getHoles()[p-1]=u,r.getHoles()[p-1].closeRing()),a.setGeometry(r);else if(b.isInstanceOf(McxGeometryType.MultiPolygon)){q=
b;for(k=0;k<q.getPolygons().length;k++)r=q.getPolygons()[k],1>p?(u=h.createLinearRing(t.getPoints()),r.setShell(u)):(u=h.createLinearRing(t.getPoints()),r.getHoles()[p-1]=u,r.getHoles()[p-1].closeRing());a.setGeometry(q)}else a.setGeometry(t),a.getGeometry().setCoordinateSystem(this.base.map.getCoordinateSystem());f.getLayer().getEditable()?(this.isMoving=!0,this.canSelect=!1,a.getGeometry().setCoordinateSystem(this.base.map.getCoordinateSystem()),k=McxMarkerHelper.instance.createMarker(a,this.markerId,
this.base.map.getCoordinateSystem()),null!=k&&0<k.length&&(k[0].setTag(g+n),this.markers[e]=k[0])):(g=f.getLayer().getName(),d[g]=g)}}}else g=f.getLayer().getName(),d[g]=g;c="";f=0;for(e in d)1<=f&&(c+=" and "),c+=e,f++;1<=f&&(d=McxLocalizationManager.getLocaleValue("McxBase-notEditableLayer"),d=String.format(d,c),McxMessageBox.show("",d,McxMessageBoxType.Warning,McxDialogButtons.ok))}};
McxEditVertexController.prototype.successCommit=function(a){a=a.getFeatures();a=McxFeatureHelper.instance.groupByLayer(a);for(var b=0;b<a.length;b++){var c=a[b].getLayer(),d=a[b].getFeatures(),d=McxFeatureHelper.instance.getBB(d);this.base.map.getRenderer().paintLayer(c,d)}this.clear()};
McxEditVertexController.prototype.endTransform=function(){var a=[],b=new McxAjaxParameter;this.isMoving=!1;b.setParameters(this,this.successCommit,function(){});for(var c=0;c<this.features.length;c++){var d=this.features[c],e=this.markers[c];null!=e&&(b.setArgs(d.getClone()),d.setGeometry(e.getGeometry()),d.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&d.getGeometry().setCoordinateSystem(d.getLayer().getCoordinateSystem()),e=new McxFeatureOperationAction,e.AddUpdateList([d],
b),this.base.map.getInputHandler().execute(e),a.push(d.getLayer()))}};js.builtin.McxEditing.Controller.McxExtendLineController={};function McxExtendLineController(){mcx.base(this);this.base=this;this.base.canSet=!1;this.applyMode=McxApplyMode.Select;this.selectToolMode=McxSelectToolMode.Fence;this.layer=null;this.canExtend=!1;this.paintedLayer=[];this._nextButton=null;this.base.removeSelectionAfterDispose=!0}mcx.inherits(McxExtendLineController,McxSelectController);
McxExtendLineController.prototype.onStartInteraction=function(){McxExtendLineController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxEditing-ExtendLineDescription1")};McxExtendLineController.prototype.onEndInteraction=function(){McxExtendLineController.superClass_.onEndInteraction.call(this);this.base.map.getRenderer().paintNonLayer()};
McxExtendLineController.prototype.onMouseDown=function(a){McxExtendLineController.superClass_.onMouseDown.call(this,a);"right"==a.getButton()&&McxSelectionHelper.instance.checkSelection(this.base.map)&&(1>McxSelectionHelper.instance.getSelection(this.base.map).length?(McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-selectOneFeatureMessage"),McxMessageBoxType.Warning),McxSelectionHelper.instance.clearSelection(this.base.map),this.base.map.getRenderer().paintSelections()):(this.base.setDescription("McxEditing-ExtendLineDescription2"),
this.canExtend=!0))};McxExtendLineController.prototype.onSelectFeaturesSuccess=function(a){if(this.canExtend){for(var b=a.getFeatures(),c=[],d=0;d<b.length;d++){var e=b[d].getGeometry();(e.isInstanceOf(McxGeometryType.LineString)||e.isInstanceOf(McxGeometryType.LinearRing)||e.isInstanceOf(McxGeometryType.LineSegment))&&c.push(b[d])}0>=c.length||this.extend(this.base.map,c,a.getFilter().getGeometry())}else McxExtendLineController.superClass_.onSelectFeaturesSuccess.call(this,a)};
McxExtendLineController.prototype.extend=function(a,b,c){var d=new McxAjaxParameter;d.setParameters(this,function(a){a=a.getFeatures();a=McxFeatureHelper.instance.groupByLayer(a);for(var b=0;b<a.length;b++){var c=a[b].getLayer(),d=a[b].getFeatures(),d=McxFeatureHelper.instance.getBB(d);this.base.map.getRenderer().paintLayer(c,d)}},function(){});a=McxSelectionHelper.instance.getSelection(a);for(var e=this.convertFeaturesToViewport(a),f=[],g=0;g<e.length;g++){var h=e[g],k;h.isInstanceOf(McxGeometryType.LineString)?
k=h.segmentize():h.isInstanceOf(McxGeometryType.Polygon)&&(k=h.getShell().segmentize());f=f.concat(k)}c=c.getBounds().getCentroid().clone();k=this.convertFeaturesToViewport(b);for(g=0;g<k.length;g++)if(h=k[g],h.isInstanceOf(McxGeometryType.LineString)){for(var m=h,h=0;h<e.length;h++)if(b[g].getFeatureID()==a[h].getFeatureID())return!1;var h=m.segmentize(),n,p;c.distanceTo(h[h.length-1])<c.distanceTo(h[0])?(n=h.length-1,p=!0):(n=0,p=!1);1>=h.length&&m.getEndPoint().distanceTo(c)<m.getStartPoint().distanceTo(c)&&
(p=!0);for(var q=[f.length],r=[f.length],t=0;t<f.length;t++){var u=f[t].intersectSegmentWithOptions(h[n],!0),v=u[0],v=u[3];if(0>u[1]||1<u[1]||!v)r[t]=0,q[t]=0;else{if(p){if(h[n].getEndPoint().distanceTo(f[t])>m.getStartPoint().distanceTo(f[t])){r[t]=0;q[t]=0;continue}}else if(h[n].getStartPoint().distanceTo(f[t])>m.getEndPoint().distanceTo(f[t])){r[t]=0;q[t]=0;continue}v=McxFactoryFinder.GeometryFactory(f[t].getCoordinateSystem()).createLineString(f[t].getPoints());r[t]=h[n].getStartPoint().distanceTo(v);
q[t]=h[n].getEndPoint().distanceTo(v)}}for(var v=Number.MAX_VALUE,m=!1,t=0,u=!1,w=0;w<f.length;w++)p?v>q[w]&&0!=q[w]&&(v=q[w],t=w,u=!0):v>r[w]&&0!=r[w]&&(v=r[w],m=!0,t=w,u=!0);if(u){v=f[t].intersectSegment(h[n],!0);1>=h.length?m?(p=h[n].getEndPoint(),q=v):(q=h[n].getStartPoint(),p=v):0<n?(q=h[n].getStartPoint(),p=v):(p=h[n].getEndPoint(),q=v);p=McxFactoryFinder.GeometryFactory(null).createLineSegment(q,p);h[n]=p;n=[];for(p=0;p<h.length;p++)n=n.concat(h[p].getPoints());b[g].setGeometry(McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createLineString(n));
this.paintedLayer.push(b[g].getLayer());b[g].getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&b[g].getGeometry().setCoordinateSystem(b[g].getLayer().getCoordinateSystem());h=new McxFeatureOperationAction;h.AddUpdateList([b[g]],d);this.base.map.getInputHandler().execute(h)}}return!0};McxExtendLineController.prototype.convertFeaturesToViewport=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c].getGeometry();b.push(d.transformTo(this.base.map.getCoordinateSystem()))}return b};js.builtin.McxEditing.Controller.McxIntersectionController={};function McxIntersectionController(){mcx.base(this);this._dialog=null;this._features=[];this._geometry=this._targetLayer=null;this.base=this}mcx.inherits(McxIntersectionController,McxSelectController);
McxIntersectionController.prototype.onStartInteraction=function(){McxIntersectionController.superClass_.onStartInteraction.call(this);McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();this.base.setDescription("McxEditing-IntersectionDescription")};
McxIntersectionController.prototype.onMouseDown=function(a){McxIntersectionController.superClass_.onMouseDown.call(this,a);if("right"==a.getButton()&&McxSelectionHelper.instance.checkSelection(this.base.map))if(this._features=McxSelectionHelper.instance.getSelection(this.base.map),2!=this._features.length)McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-selectTwoFeatureMessage"),McxMessageBoxType.Warning),McxSelectionHelper.instance.clearSelection(this.base.map),this.base.map.getRenderer().paintSelections();
else try{this._geometry=McxGeospatialServiceManager.intersection(this._features[0].getGeometry(),this._features[1].getGeometry());var b=McxMarkerHelper.instance.createMarkerFromGeometry(this._geometry,McxGuid.createGuid());this.base.map.getMarkerCollection().addRange(b);this.base.map.getRenderer().paintNonLayer();var c=McxMapHelper.getSelectableLayers(this.base.map);this._dialog=new McxSaveEditResultDialog(c);this._dialog.getOkButtonClickHandler().addListener(this.applyOperation,null,this);this._dialog.onCloseDialog().addListener(this.dialogClosed,
null,this);this._dialog.showDialog(!0,!1);var d=McxLocalizationManager.getLocaleValue("McxEditing-Intersection");this._dialog.setTitle(d,"McxEditing-Intersection")}catch(e){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-SelectedGeometriesNotIntersects"),McxMessageBoxType.Warning)}};
McxIntersectionController.prototype.applyOperation=function(){this._dialog.onCloseDialog().removeListener(this.applyOperation);this.base.setCursor(this.getCursor());this.base.setDescription("McxEditing-IntersectionDescription");this._targetLayer=this._dialog.getLayer();var a=McxGeometryHelper.instance.createGeometryWithType(this._geometry,this._targetLayer.getGeometryType(),this._targetLayer.getCoordinateSystem());if(null==a)McxMessageBox.show("","McxEditing-GeometryTypeNotSupportedError",McxMessageBoxType.Error);
else{var b=this._targetLayer.createFeatureBuffer();b.setGeometry(a);a=new McxAjaxParameter;a.setParameters(this,this.insertSuccess,this.commitFail);b.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&b.getGeometry().setCoordinateSystem(b.getLayer().getCoordinateSystem());var c=new McxFeatureOperationAction;c.AddInsertList([b],a);this.base.map.getInputHandler().execute(c)}};
McxIntersectionController.prototype.dialogClosed=function(){this.base.map.getMarkerCollection().clear();McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections()};
McxIntersectionController.prototype.insertSuccess=function(a){a=a.getFeatures();var b=McxFeatureHelper.instance.getBB(a);this.base.map.getRenderer().paintLayer(this._targetLayer,b);if(0!=a.length)if(b=McxFeatureHelper.instance.groupByLayer(this._features),1<b.length&&b[0].getLayer().getName()==this._targetLayer.getName()){a=a[0];var b=this._features[0],c=new McxAjaxParameter;c.setAsync(!1);b.setMissing(c);McxFeatureHelper.instance.copyFields(b,a);b=new McxAjaxParameter;b.setParameters(this,this.updateSuccess,
this.commitFail);a.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&a.getGeometry().setCoordinateSystem(a.getLayer().getCoordinateSystem());c=new McxFeatureOperationAction;c.AddUpdateList([a],b);this.base.map.getInputHandler().execute(c)}else this.deleteFeatures()};McxIntersectionController.prototype.updateSuccess=function(){this.deleteFeatures()};
McxIntersectionController.prototype.deleteFeatures=function(){if(this._dialog.getDeleteStatus()){var a=new McxAjaxParameter;a.setParameters(this,this.deleteSuccess,this.commitFail);for(var b=McxFeatureHelper.instance.groupByLayer(this._features),c=0;c<b.length;c++){b[c].getLayer();var d=b[c].getFeatures(),e=new McxFeatureOperationAction;e.AddDeleteList(d,a);this.base.map.getInputHandler().execute(e)}}else McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-ProcessCompleted"),McxMessageBoxType.Information)};
McxIntersectionController.prototype.deleteSuccess=function(a){a=McxFeatureHelper.instance.groupByLayer(a.getFeatures());for(var b=0;b<a.length;b++){var c=McxFeatureHelper.instance.getBB(a[b].getFeatures());this.base.map.getRenderer().paintLayer(a[b].getLayer(),c)}McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-ProcessCompleted"),McxMessageBoxType.Information)};
McxIntersectionController.prototype.commitFail=function(a){var b="",b=null!=a?a.getException():McxLocalizationManager.getLocaleValue("McxEditing-ErrorOccured");McxMessageBox.show("",b,McxMessageBoxType.Error)};js.builtin.McxEditing.Controller.McxJoinLineController={};function McxJoinLineController(){mcx.base(this);this.base=this;this.base.canSet=!1;this.base.applyMode=McxApplyMode.Select;this.base.selectToolMode=McxSelectToolMode.Fence;this.targetLayer=null;this.deleteExisting=this.copyFields=!0;this.distanceEpsilon=5E-5;this._controllerUI=new McxControllerUI;this._bufferEditor=new McxNumberBox(Number.MIN_VALUE,Number.MAX_VALUE,8);this.createControllerUI()}mcx.inherits(McxJoinLineController,McxSelectController);
McxJoinLineController.prototype.onStartInteraction=function(){McxJoinLineController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxEditing-JoinLineDescription")};McxJoinLineController.prototype.onEndInteraction=function(){McxJoinLineController.superClass_.onEndInteraction.call(this);McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections()};
McxJoinLineController.prototype.onMouseDown=function(a){McxJoinLineController.superClass_.onMouseDown.call(this,a);"right"==a.getButton()&&McxSelectionHelper.instance.checkSelection(this.base.map)&&(a=McxSelectionHelper.instance.getSelection(this.base.map),1>=a.length?(McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-selectAtLeastTwoFeatureMessage"),McxMessageBoxType.Warning),McxSelectionHelper.instance.clearSelection(this.base.map),this.base.map.getRenderer().paintSelections()):
this.join(a,this.base.map))};McxJoinLineController.prototype.onSelectFeaturesSuccess=function(a){for(var b=a.getFeatures(),c=[],d=0;d<b.length;d++){var e=b[d].getGeometry();(e.isInstanceOf(McxGeometryType.LineString)||e.isInstanceOf(McxGeometryType.LinearRing)||e.isInstanceOf(McxGeometryType.LineSegment))&&c.push(b[d])}0>=c.length||(a=new McxSelectResult(a.getFilter(),c,a.getLayer(),a.getArgs()),McxJoinLineController.superClass_.onSelectFeaturesSuccess.call(this,a))};
McxJoinLineController.prototype.join=function(a,b){var c=new McxAjaxParameter;c.setParameters(this,function(a){a=McxFeatureHelper.instance.getBB(a.getFeatures());b.getRenderer().paintLayer(this.targetLayer,a)},function(){});var d=McxSelectionHelper.instance.getSelection(b);McxSelectionHelper.instance.clearSelection(b);this.base.map.getRenderer().paintSelections();var e=this.turnFeaturesToViewportFormat(d);if(0>=e.length)return McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-selectAtLeastTwoFeatureMessage"),
McxMessageBoxType.Warning),b.getRenderer().paintNonLayer(),!1;for(var f=0,g=0;g<e.length;g++)for(var h=g+1;h<e.length;h++)this.intersectAccordingToThreshold(e[g],e[h],this.distanceEpsilon)&&f++;if(f!=e.length-1)return McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-selectIntersectedLinesMessage"),McxMessageBoxType.Warning),b.getRenderer().paintNonLayer(),!1;if(2>e.length)return McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-selectAtLeastTwoLineMessage"),
McxMessageBoxType.Warning),b.getRenderer().paintNonLayer(),!1;f=this.createLineString(e,this.distanceEpsilon);if(null==f)return b.getRenderer().paintNonLayer(),!1;this.targetLayer=this.base.map.getLayers().getActiveLayer();e=this.targetLayer.createFeatureBuffer();e.setGeometry(f);e.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&e.getGeometry().setCoordinateSystem(e.getLayer().getCoordinateSystem());f=new McxFeatureOperationAction;f.AddInsertList([e],c);this.base.map.getInputHandler().execute(f);
if(this.copyFields){for(f=0;f<d[0].getFieldCount();f++)null==(f>=this.targetLayer.getSchema().getFieldCount()?null:this.targetLayer.getSchema().getField(f))&&(g=d[0].getLayer().getSchema().getField(f),this.targetLayer.createField(g));McxFeatureHelper.instance.copyFields(d[0],e)}if(this.deleteExisting)for(d=McxFeatureHelper.instance.groupByLayer(d),e=0;e<d.length;e++)f=d[e].getFeatures(),d[e].getLayer(),g=new McxFeatureOperationAction,g.AddDeleteList(f,c),this.base.map.getInputHandler().execute(g);
return!0};McxJoinLineController.prototype.intersectAccordingToThreshold=function(a,b,c){return a.distanceTo(b)<=c};McxJoinLineController.prototype.turnFeaturesToViewportFormat=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c].getGeometry();if(!(d.isInstanceOf(McxGeometryType.LineString)||d.isInstanceOf(McxGeometryType.LinearRing)||d.isInstanceOf(McxGeometryType.LineSegment)))return null;d=d.transformTo(this.base.map.getCoordinateSystem());b.push(d)}return b};
McxJoinLineController.prototype.createLineString=function(a,b){for(var c=!1,d=!1,e=!0,f=!0,g=0,h=0;h<a.length;h++){var k=a[h];if(!this.isEqualWithRespectToDistance(k.getStartPoint(),k.getEndPoint(),b)){for(var m=0;m<a.length;m++){var n=a[m];if(n!=k&&!this.isEqualWithRespectToDistance(n.getStartPoint(),n.getEndPoint(),b)){if(this.isEqualWithRespectToDistance(k.getStartPoint(),n.getEndPoint(),b)||this.isEqualWithRespectToDistance(k.getStartPoint(),n.getStartPoint(),b))e=!1;if(this.isEqualWithRespectToDistance(k.getEndPoint(),
n.getEndPoint(),b)||this.isEqualWithRespectToDistance(k.getEndPoint(),n.getStartPoint(),b))f=!1}}if(e||f){g=h;e?c=!0:d=!0;break}f=e=!0}}d&&(c=!0,d=a[g],2<d.getPoints().length?(d.getPoints().reverse(),a[g]=d):(d=a[g],a[g]=McxFactoryFinder.GeometryFactory(null).createLineSegment(d.getEndPoint(),d.getStartPoint())));h=a[0];a[0]=a[g];a[g]=h;if(!c)return null;g=!1;for(h=0;h<a.length-1;h++)if(d=a[h],!d.getStartPoint().equals(d.getEndPoint())){c=0;for(e=h+1;e<a.length;e++)if(f=a[e],!this.isEqualWithRespectToDistance(f.getEndPoint(),
f.getStartPoint(),b)){if(this.isEqualWithRespectToDistance(d.getEndPoint(),f.getStartPoint(),b)){c=e;break}if(this.isEqualWithRespectToDistance(d.getEndPoint(),f.getEndPoint(),b)){c=e;g=!0;break}}g&&(d=a[c],2<d.getPoints().length?d.getPoints().reverse():(d=a[c],g=McxFactoryFinder.GeometryFactory(null).createLineSegment(d.getEndPoint(),d.getStartPoint()),a[c]=g),g=!1);d=a[c];null==d||this.isEqualWithRespectToDistance(d.getStartPoint(),d.getEndPoint(),b)||0==c||(d=a[c],a[c]=a[h+1],a[h+1]=d)}for(c=0;c<
a.length&&(h=a[c],this.isEqualWithRespectToDistance(h.getStartPoint(),h.getEndPoint(),b));c++);g=[];d=!1;g=g.concat(a[c].getPoints());for(h=c+1;h<a.length;h++)if(e=a[h],!this.isEqualWithRespectToDistance(e.getStartPoint(),e.getEndPoint(),b)){if(h>c&&!this.isEqualWithRespectToDistance(e.getStartPoint(),a[h-1].getEndPoint(),b))return null;d=!0;g=g.concat(a[h].getPoints())}return d?McxFactoryFinder.GeometryFactory(null).createLineString(g):null};
McxJoinLineController.prototype.isEqualWithRespectToDistance=function(a,b,c){a=a.distanceTo(b);return c>=a};McxJoinLineController.prototype.getOptionUI=function(){return this._controllerUI};
McxJoinLineController.prototype.createControllerUI=function(){this._controllerUI=new McxControllerUI;var a=McxSettingsManager.read("McxEditing-JoinLineSettings",null).getSettings();a&&0<a.length&&(a=JSON.parse(a[0]),this.distanceEpsilon=parseInt(a.Distance,10));this._bufferEditor.setValue(this.distanceEpsilon);this._controllerUI.setTitle("Join Lines","McxEditing-JoinLines");this._controllerUI.addControl(new McxLabeledEditor("Value",this._bufferEditor,"McxEditing-createBufferControllerBufferValue",
5));this._controllerUI.getSubmitHandler().addListener(function(){if(McxSelectionHelper.instance.checkSelection(this.base.map)){var a=McxSelectionHelper.instance.getSelection(this.base.map);1>=a.length?(McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-selectAtLeastTwoFeatureMessage"),McxMessageBoxType.Warning),McxSelectionHelper.instance.clearSelection(this.base.map),this.base.map.getRenderer().paintSelections()):(McxSettingsManager.write("McxEditing-JoinLineSettings",JSON.stringify({Distance:this.distanceEpsilon}),
null),this.join(a,this.base.map))}},null,this);this._bufferEditor.getOnChangeHandler().addListener(function(){this.distanceEpsilon=this._bufferEditor.getValue()},null,this)};js.builtin.McxEditing.Controller.McxMoveCopyController={};function McxMoveCopyController(a){mcx.base(this);this.copy=a;this.markerId="";this.lastPosition=null;this.markers=[];this.features=[];this.base=this;this.initControllers()}mcx.inherits(McxMoveCopyController,McxCompositeController);
McxMoveCopyController.prototype.initControllers=function(){var a=new McxSelectController;this.base.add(a);a=McxFactoryFinder.StyleFactory().createLineSymbolizerWithColor("black");a=new McxPaintLineSegmentController(a);a.getPointListChangedEventHandler().addListener(this.segmentControllerCoordinateListChanged,null,this);this.base.add(a)};
McxMoveCopyController.prototype.segmentControllerCoordinateListChanged=function(a){switch(a.getPoints().length){case 1:this.onFirstCoordinateCreated(a.getPoints()[0]);this.setDescription(this.getDescriptionOfStep(2));break;case 2:this.onLineSegmentCreated(a.getPoints()[0],a.getPoints()[1]),McxSelectionHelper.instance.clearSelection(this.base.map),this.base.map.getRenderer().paintSelections()}};
McxMoveCopyController.prototype.onStartInteraction=function(){McxMoveCopyController.superClass_.onStartInteraction.call(this);this.setDescription(this.getDescriptionOfStep(0));this.markerId=McxGuid.createGuid()};McxMoveCopyController.prototype.onEndInteraction=function(){McxMoveCopyController.superClass_.onEndInteraction.call(this);this.markers=[];this.features=[];this.lastPosition=null;this.reset();McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections()};
McxMoveCopyController.prototype.nextStep=function(a,b){var c=!1;switch(b){case 0:this.setDescription(this.getDescriptionOfStep(0));break;case 1:McxSelectionHelper.instance.checkSelection(this.base.map)||(c=!0),this.setDescription(this.getDescriptionOfStep(1))}return c};McxMoveCopyController.prototype.paint=function(a){McxMoveCopyController.superClass_.paint.call(this,a);if(!(1>this.base.currentStep))for(var b=0;b<this.markers.length;b++)this.markers[b].paint(a)};
McxMoveCopyController.prototype.onMouseMove=function(a){McxMoveCopyController.superClass_.onMouseMove.call(this,a);if(!(1>this.base.currentStep)){a=this.base.map.viewToWorld(a.getX(),a.getY());for(var b=0;b<this.markers.length;b++){var c=this.markers[b];c.getGeometry().translate(-this.lastPosition.getX(),-this.lastPosition.getY());c.getGeometry().translate(a.getX(),a.getY())}this.lastPosition=a}};
McxMoveCopyController.prototype.reset=function(){McxMoveCopyController.superClass_.reset.call(this);this.markers=[];this.features=[];this.lastPosition=null};McxMoveCopyController.prototype.onFirstCoordinateCreated=function(a){var b=McxSelectionHelper.instance.getSelection(this.base.map);this.features=this.features.concat(b);null==this.lastPosition&&(this.lastPosition=a);a=McxMarkerHelper.instance.createMarker(this.features,this.markerId,this.base.map.getCoordinateSystem());this.markers=this.markers.concat(a)};
McxMoveCopyController.prototype.onLineSegmentCreated=function(a,b){this.end(a,b);this.base.map.getInputHandler().setController(null)};McxMoveCopyController.prototype.getDescriptionOfStep=function(a){if(this.copy)switch(a){case 0:return"McxEditing-CopyDescription1";case 1:return"McxEditing-CopyDescription2";case 2:return"McxEditing-CopyDescription3"}else switch(a){case 0:return"McxEditing-MoveDescription1";case 1:return"McxEditing-MoveDescription2";case 2:return"McxEditing-MoveDescription3"}return""};
McxMoveCopyController.prototype.end=function(a,b){for(var c=McxFeatureHelper.instance.groupByLayer(this.features),d=0;d<c.length;d++){var e=c[d].getFeatures();c[d].getLayer();for(var f=[],g=[],h=0;h<e.length;h++){var k=e[h],m=k.getClone(),n=k.getGeometry().clone().transformTo(this.base.map.getCoordinateSystem());n.translate(-a.getX(),-a.getY());n.translate(b.getX(),b.getY());k.setGeometry(n);var p=k.getLayer(),p=k.getGeometry().transformTo(p.getCoordinateSystem());k.setGeometry(p);p=c[d].getLayer().createFeatureBuffer();
this.copy?(p.setGeometry(n),p.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&p.getGeometry().setCoordinateSystem(p.getLayer().getCoordinateSystem()),g.push(p),f.push(m)):(m=f.push(m),m=new McxMemFeature(k.getLayer(),null),m.setFeatureID(k.getFeatureID()),m.setGeometry(k.getGeometry()),m.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&m.getGeometry().setCoordinateSystem(m.getLayer().getCoordinateSystem()),g.push(m))}this.copy?(e=new McxAjaxParameter,e.setParameters(this,
this.insertSuccess,this.insertFail),e.setArgs(f),f=new McxFeatureOperationAction,f.AddInsertList(g,e)):(e=new McxAjaxParameter,e.setParameters(this,this.updateSuccess,this.updateFail),e.setArgs(f),f=new McxFeatureOperationAction,f.AddUpdateList(g,e));this.base.map.getInputHandler().execute(f)}};
McxMoveCopyController.prototype.insertSuccess=function(a){var b=a.getFeatures(),c=a.getArgs(),d=new McxAjaxParameter;d.setAsync(!1);var e=new McxAjaxParameter;e.setParameters(this,this.updateSuccess,this.updateFail);for(a=0;a<b.length;a++){var f=b[a];c[a].setMissing(d);McxFeatureHelper.instance.copyFields(c[a],f);var g=new McxFeatureOperationAction;g.AddUpdateList([f],e);this.base.map.getInputHandler().execute(g)}b=McxFeatureHelper.instance.groupByLayer(b);for(a=0;a<b.length;a++)c=b[a].getLayer(),
d=b[a].getFeatures(),d=McxFeatureHelper.instance.getBB(d),this.base.map.getRenderer().paintLayer(c,d)};McxMoveCopyController.prototype.insertFail=function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-ErrorOccured"),McxMessageBoxType.Error)};
McxMoveCopyController.prototype.updateSuccess=function(a){if(!this.copy){var b=a.getArgs();a=a.getFeatures();a=a.concat(b);b=McxFeatureHelper.instance.groupByLayer(a);for(a=0;a<b.length;a++){var c=b[a].getLayer(),d=b[a].getFeatures(),d=McxFeatureHelper.instance.getBB(d);this.base.map.getRenderer().paintLayer(c,d)}}};McxMoveCopyController.prototype.updateFail=function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-ErrorOccured"),McxMessageBoxType.Error)};js.builtin.McxEditing.Controller.McxReverseController={};function McxReverseController(){mcx.base(this);this.base=this}mcx.inherits(McxReverseController,McxSelectController);McxReverseController.prototype.onStartInteraction=function(){McxReverseController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxEditing-ReverseDescription")};
McxReverseController.prototype.onMouseDown=function(a){McxReverseController.superClass_.onMouseDown.call(this,a);"right"==a.getButton()&&McxSelectionHelper.instance.checkSelection(this.base.map)&&this.reverse()};
McxReverseController.prototype.reverse=function(){var a=0,b=0,c=McxSelectionHelper.instance.getSelection(this.base.map);McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();var c=McxFeatureGroup.groupFeatures(c),a=c.length,d=new McxAjaxParameter;d.setParameters(this,function(c){c=c.getFeatures();if(0<c.length){var d=McxFeatureHelper.instance.getBB(c);this.base.map.getRenderer().paintLayer(c[0].getLayer(),d)}b++;b>=a&&McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-ProcessCompleted"),
McxMessageBoxType.Information)},function(){});for(var e=0;e<c.length;e++){c[e].getLayer();for(var f=c[e].getFeatures(),g=[],h=0;h<f.length;h++){var k=f[h];k.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&k.getGeometry().setCoordinateSystem(k.getLayer().getCoordinateSystem());var m=f[h].getGeometry(),n=m.getCoordinateSystem();if(!m.isInstanceOf(McxGeometryType.Point))if(m.isInstanceOf(McxGeometryType.LineSegment))m=k.getGeometry().getPoints(),m.reverse(),k.setGeometry(McxFactoryFinder.GeometryFactory(n).createLineSegment(m[0],
m[1])),g.push(k);else if(m.isInstanceOf(McxGeometryType.LineString))k.getGeometry().getPoints().reverse(),g.push(k);else if(m.isInstanceOf(McxGeometryType.MultiLineString)){n=k.getGeometry();for(e=0;e<n.getLines().length;e++)n.getLines()[e].getPoints().reverse();g.push(k)}else if(m.isInstanceOf(McxGeometryType.Polygon))k.getGeometry().getShell().getPoints().reverse(),g.push(k);else if(m.isInstanceOf(McxGeometryType.MultiPolygon)){n=k.getGeometry();for(e=0;e<n.getPolygons().length;e++)n.getPolygons()[e].getShell().getPoints().reverse();
g.push(k)}}f=new McxFeatureOperationAction;f.AddUpdateList([g],d);this.base.map.getInputHandler().execute(f)}};js.builtin.McxEditing.Controller.McxRotateController={};
function McxRotateController(a){mcx.base(this);this.dialogMode=!1;this._dialog=this._anchorPoint=null;this.copy=a;this.markerId="";this.lastPosition=null;this.lastAngle=0;this.markers=[];this.features=[];this.newFeatureDictionary=new McxDictionary;this.base=this;this._controllerUI=new McxControllerUI;this._angleNumberBox=new McxNumberBox(0,Number.MAX_VALUE,8);this.xNumberBox=new McxNumberBox(Number.MIN_VALUE,Number.MAX_VALUE,8);this.yNumberBox=new McxNumberBox(Number.MIN_VALUE,Number.MAX_VALUE,8);
this.createControllerUI();this.initControllers()}mcx.inherits(McxRotateController,McxCompositeController);McxRotateController.prototype.initControllers=function(){var a=new McxSelectController;this.base.add(a);a=McxFactoryFinder.StyleFactory().createLineSymbolizerWithColor("black");a=new McxPaintLineSegmentController(a);a.getPointListChangedEventHandler().addListener(this.segmentControllerCoordinateListChanged,null,this);this.base.add(a)};
McxRotateController.prototype.segmentControllerCoordinateListChanged=function(a){switch(a.getPoints().length){case 1:this.onFirstCoordinateCreated(a.getPoints()[0]);this._anchorPoint=a.getPoints()[0];this.xNumberBox.setValue(this._anchorPoint.getX());this.yNumberBox.setValue(this._anchorPoint.getY());this.setDescription(this.getDescriptionOfStep(2));break;case 2:this.onLineSegmentCreated(a.getPoints()[0],a.getPoints()[1]),McxSelectionHelper.instance.clearSelection(this.base.map),this.base.map.getRenderer().paintSelections(),
this.base.map.getInputHandler().setController(null),this.setDescription(this.getDescriptionOfStep(2))}};McxRotateController.prototype.onStartInteraction=function(){McxRotateController.superClass_.onStartInteraction.call(this);this.setDescription(this.getDescriptionOfStep(0));this.markerId=McxGuid.createGuid();0!=McxSelectionHelper.instance.getSelection(this.base.map).length&&this.base.performNextStep()};
McxRotateController.prototype.onEndInteraction=function(){McxRotateController.superClass_.onEndInteraction.call(this);this.markers=[];this.features=[];this.lastPosition=null;McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections()};
McxRotateController.prototype.nextStep=function(a,b){var c=!1;switch(b){case 0:var d=this.getDescriptionOfStep(0);this.base.setDescription(d);this._controllerUI.displayMessage(McxLocalizationManager.getLocaleValue(d),d);break;case 1:McxSelectionHelper.instance.checkSelection(this.base.map)||(c=!0),d=this.getDescriptionOfStep(1),this.base.setDescription(d),this._controllerUI.displayMessage(McxLocalizationManager.getLocaleValue(d),d)}return c};
McxRotateController.prototype.paint=function(a){this.dialogMode||McxRotateController.superClass_.paint.call(this,a);if(!(1>this.base.currentStep))for(var b=0;b<this.markers.length;b++)this.markers[b].paint(a)};
McxRotateController.prototype.onMouseMove=function(a){McxRotateController.superClass_.onMouseMove.call(this,a);if(!(1>this.base.currentStep)&&null!=this._anchorPoint){a=this.base.map.viewToWorld(a.getX(),a.getY());for(var b=(new McxLineSegment(this._anchorPoint.getX(),this._anchorPoint.getY(),a.getX(),a.getY(),this.base.map.getCoordinateSystem())).getAngle(),b=McxMath.degreeToRadian(b),c=0;c<this.markers.length;c++){var d=this.markers[c];d.getGeometry().rotate(this._anchorPoint,-this.lastAngle);d.getGeometry().rotate(this._anchorPoint,
b)}this.lastAngle=b;this.lastPosition=a}};McxRotateController.prototype.reset=function(){McxRotateController.superClass_.reset.call(this);this.markers=[];this.features=[];this.lastPosition=null};
McxRotateController.prototype.onFirstCoordinateCreated=function(a){var b=McxSelectionHelper.instance.getSelection(this.base.map);this.features=this.features.concat(b);null==this.lastPosition&&(this.lastPosition=a);a=McxMarkerHelper.instance.createMarker(this.features,this.markerId,this.base.map.getCoordinateSystem());this.markers=this.markers.concat(a)};McxRotateController.prototype.onKeyDown=function(a){a.getKeyCode()==McxKeyCode.enter&&(this.dialogMode=!this.dialogMode,this.base.map.getRenderer().paintNonLayer())};
McxRotateController.prototype.onLineSegmentCreated=function(a,b){this.end(a,b);this.onEndInteraction()};McxRotateController.prototype.getDescriptionOfStep=function(a){switch(a){case 0:return"McxEditing-RotateDescription1";case 1:return"McxEditing-RotateDescription2";case 2:return"McxEditing-RotateDescription3"}return""};McxRotateController.prototype.isCopy=function(){return this.copy};
McxRotateController.prototype.end=function(a,b){if(null!=this._anchorPoint){var c=(new McxLineSegment(a.getX(),a.getY(),b.getX(),b.getY(),this.base.map.getCoordinateSystem())).getAngle(),c=McxMath.degreeToRadian(c);this.rotateObjects(c)}};
McxRotateController.prototype.rotateObjects=function(a){for(var b=McxFeatureHelper.instance.groupByLayer(this.features),c=[],d=0;d<b.length;d++){var e=b[d].getFeatures();b[d].getLayer();for(var f=[],g=0;g<e.length;g++){var h=e[g],k=h.getClone(),m=h.getGeometry().clone().transformTo(this.base.map.getCoordinateSystem());m.rotate(this._anchorPoint,a);h.setGeometry(m);var n=h.getLayer(),n=h.getGeometry().transformTo(n.getCoordinateSystem());h.setGeometry(n);this.copy?(k=b[d].getLayer().createFeatureBuffer(),
k.setGeometry(m),k.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&k.getGeometry().setCoordinateSystem(k.getLayer().getCoordinateSystem()),f.push(k),this.newFeatureDictionary.setValue(k.getGlobalID(),h)):(c.push(k),m=new McxMemFeature(h.getLayer(),null),m.setFeatureID(h.getFeatureID()),m.setGeometry(h.getGeometry()),m.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&m.getGeometry().setCoordinateSystem(m.getLayer().getCoordinateSystem()),f.push(m));this.copy?
(h=new McxAjaxParameter,h.setParameters(this,this.insertSuccess,this.insertFail),m=new McxFeatureOperationAction,m.AddInsertList(f,h)):(h=new McxAjaxParameter,h.setParameters(this,this.updateSuccess,this.updateFail),h.setArgs(c),m=new McxFeatureOperationAction,m.AddUpdateList(f,h));this.base.map.getInputHandler().execute(m)}(new McxAjaxParameter).setAsync(!1)}};
McxRotateController.prototype.insertSuccess=function(a){var b=a.getFeatures(),c=new McxAjaxParameter;c.setParameters(this,this.updateSuccess,this.updateFail);for(a=0;a<b.length;a++){var d=b[a],e=this.newFeatureDictionary.getValue(d.getGlobalID()),f=new McxAjaxParameter;f.setAsync(!1);e.setMissing(f);McxFeatureHelper.instance.copyFields(e,d);d.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&d.getGeometry().setCoordinateSystem(d.getLayer().getCoordinateSystem());e=new McxFeatureOperationAction;
e.AddUpdateList([d],c);this.base.map.getInputHandler().execute(e)}b=McxFeatureHelper.instance.groupByLayer(b);for(a=0;a<b.length;a++)c=b[a].getLayer(),d=b[a].getFeatures(),d=McxFeatureHelper.instance.getBB(d),this.base.map.getRenderer().paintLayer(c,d)};McxRotateController.prototype.insertFail=function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-ErrorOccured"),McxMessageBoxType.Error)};
McxRotateController.prototype.updateSuccess=function(a){if(!this.copy){var b=a.getArgs();a=a.getFeatures();a=a.concat(b);b=McxFeatureHelper.instance.groupByLayer(a);for(a=0;a<b.length;a++){var c=b[a].getLayer(),d=b[a].getFeatures(),d=McxFeatureHelper.instance.getBB(d);this.base.map.getRenderer().paintLayer(c,d)}}};McxRotateController.prototype.updateFail=function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-ErrorOccured"),McxMessageBoxType.Error)};
McxRotateController.prototype.getOptionUI=function(){return this._controllerUI};
McxRotateController.prototype.createControllerUI=function(){function a(){if(this.dialogMode){var a=this.xNumberBox.getValue(),b=this.yNumberBox.getValue();this._anchorPoint=new McxPoint(a,b,null);a=this._angleNumberBox.getValue();this.lastAngle=McxMath.degreeToRadian(a);this.features=a=McxSelectionHelper.instance.getSelection(this.base.map);this.markers=McxMarkerHelper.instance.createMarker(a,this.markerId,this.base.map.getCoordinateSystem());for(a=0;a<this.markers.length;a++)this.markers[a].getGeometry().rotate(this._anchorPoint,
this.lastAngle);this.base.map.getRenderer().paintNonLayer()}}this._controllerUI.setTitle("Rotate","McxEditing-rotate");this._controllerUI.setWidth(200);this._controllerUI.setIsModal(!0);this._controllerUI.addControl(new McxLabeledEditor("Angle (Degree)",this._angleNumberBox,"McxEditing-angle",6));this._controllerUI.addControl(new McxLabeledEditor("X",this.xNumberBox,"McxEditing-x",6));this._controllerUI.addControl(new McxLabeledEditor("Y",this.yNumberBox,"McxEditing-y",6));var b=McxSettingsManager.read("McxEditing-RotateSettings",
null).getSettings();if(b&&0<b.length){var b=JSON.parse(b[0]),c=parseInt(b.Angle,10),d=parseFloat(b.X),b=parseFloat(b.Y);this._angleNumberBox.setValue(c);this.xNumberBox.setValue(d);this.yNumberBox.setValue(b)}this._angleNumberBox.getOnChangeHandler().addListener(a,null,this);this.yNumberBox.getOnChangeHandler().addListener(a,null,this);this.xNumberBox.getOnChangeHandler().addListener(a,null,this);this._controllerUI.onShowEventHandler().addListener(function(){this.dialogMode=!0;null==this._anchorPoint&&
(this._anchorPoint=this.base.map.getWorld().getCentroid());this.xNumberBox.setValue(this._anchorPoint.getX());this.yNumberBox.setValue(this._anchorPoint.getY());this._angleNumberBox.setValue(McxMath.radianToDegree(this.lastAngle))},null,this);this._controllerUI.getSubmitHandler().addListener(function(){this.dialogMode=!1;this.rotateObjects(this.lastAngle);this.base.map.getInputHandler().setController(null);var a={Angle:this._angleNumberBox.getValue(),X:this.xNumberBox.getValue(),Y:this.yNumberBox.getValue()};
McxSettingsManager.write("McxEditing-RotateSettings",JSON.stringify(a),null)},null,this)};js.builtin.McxEditing.Controller.McxScaleController={};
function McxScaleController(a){mcx.base(this);this.dialogMode=!1;this._dialog=this._anchorPoint=null;this.copy=a;this.markerId="";this.lastPosition=null;this.lastRatio=1;this.screenRatio=0;this.markers=[];this.features=[];this.newFeatureDictionary=new McxDictionary;this.base=this;this._controllerUI=new McxControllerUI;this._scaleEditor=new McxNumberBox(Number.MIN_VALUE,Number.MAX_VALUE,8);this._xEditor=new McxNumberBox(Number.MIN_VALUE,Number.MAX_VALUE,8);this._yEditor=new McxNumberBox(Number.MIN_VALUE,
Number.MAX_VALUE,8);this.initControllers();this.createControllerUI()}mcx.inherits(McxScaleController,McxCompositeController);McxScaleController.prototype.initControllers=function(){var a=new McxSelectController;this.base.add(a);a=McxFactoryFinder.StyleFactory().createLineSymbolizerWithColor("black");a=new McxPaintLineSegmentController(a);a.getPointListChangedEventHandler().addListener(this.segmentControllerCoordinateListChanged,null,this);this.base.add(a)};
McxScaleController.prototype.segmentControllerCoordinateListChanged=function(a){switch(a.getPoints().length){case 1:this.onFirstCoordinateCreated(a.getPoints()[0]);this._anchorPoint=a.getPoints()[0];a=this.getDescriptionOfStep(1);this.base.setDescription(a);this._controllerUI.displayMessage(McxLocalizationManager.getLocaleValue(a));this._scaleEditor.setIsEnabled(!0);break;case 2:this.onLineSegmentCreated(a.getPoints()[0],a.getPoints()[1]),McxSelectionHelper.instance.clearSelection(this.base.map),
this.base.map.getRenderer().paintSelections(),this.base.map.getInputHandler().setController(null)}};
McxScaleController.prototype.onStartInteraction=function(){McxScaleController.superClass_.onStartInteraction.call(this);var a=this.getDescriptionOfStep(0);this.base.setDescription(a);this._controllerUI.displayMessage(McxLocalizationManager.getLocaleValue(a),a);var a=this.base.map.viewToWorld(0,0),b=this.base.map.viewToWorld(40,40);this.screenRatio=(new McxLineSegment(a.getX(),a.getY(),b.getX(),b.getY(),this.base.map.getCoordinateSystem())).getLength();this.markerId=McxGuid.createGuid();0!=McxSelectionHelper.instance.getSelection(this.base.map).length&&
this.base.performNextStep()};McxScaleController.prototype.onEndInteraction=function(){McxScaleController.superClass_.onEndInteraction.call(this);this.markers=[];this.features=[];this.lastPosition=null;this.reset();McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections()};
McxScaleController.prototype.nextStep=function(a,b){var c=!1;switch(b){case 0:this.setDescription(this.getDescriptionOfStep(0));break;case 1:McxSelectionHelper.instance.checkSelection(this.base.map)||(c=!0),this.setDescription(this.getDescriptionOfStep(1))}return c};McxScaleController.prototype.paint=function(a){McxScaleController.superClass_.paint.call(this,a);for(var b=0;b<this.markers.length;b++)this.markers[b].paint(a)};
McxScaleController.prototype.onMouseMove=function(a){McxScaleController.superClass_.onMouseMove.call(this,a);if(!(1>this.base.currentStep)&&null!=this._anchorPoint){a=this.base.map.viewToWorld(a.getX(),a.getY());for(var b=(new McxLineSegment(this._anchorPoint.getX(),this._anchorPoint.getY(),a.getX(),a.getY(),this.base.map.getCoordinateSystem())).getLength()/this.screenRatio,c=0;c<this.markers.length;c++){var d=this.markers[c];d.getGeometry().isInstanceOf(McxGeometryType.Point)||d.getGeometry().isInstanceOf(McxGeometryType.MultiPoint)||
(d.getGeometry().scale(this._anchorPoint,1/this.lastRatio),d.getGeometry().scale(this._anchorPoint,b))}this._scaleEditor.setValue(b);this.lastRatio=b;this.lastPosition=a}};McxScaleController.prototype.onKeyDown=function(a){a.getKeyCode()==McxKeyCode.enter&&(this.dialogMode=!this.dialogMode,this.base.map.getRenderer().paintNonLayer())};McxScaleController.prototype.reset=function(){McxScaleController.superClass_.reset.call(this);this.markers=[];this.features=[];this.lastPosition=null};
McxScaleController.prototype.onFirstCoordinateCreated=function(a){var b=McxSelectionHelper.instance.getSelection(this.base.map);this.features=this.features.concat(b);null==this.lastPosition&&(this.lastPosition=a);a=McxMarkerHelper.instance.createMarker(this.features,this.markerId,this.base.map.getCoordinateSystem());this.markers=this.markers.concat(a)};McxScaleController.prototype.onLineSegmentCreated=function(a,b){this.end(a,b);McxFeatureHelper.instance.getLayers(this.features);this.base.map.getInputHandler().setController(null)};
McxScaleController.prototype.getDescriptionOfStep=function(a){if(this.copy)switch(a){case 0:return"McxEditing-CopyDescription1";case 1:return"McxEditing-CopyDescription2";case 2:return"McxEditing-CopyDescription3"}else switch(a){case 0:return"McxEditing-MoveDescription1";case 1:return"McxEditing-MoveDescription2";case 2:return"McxEditing-MoveDescription3"}return""};McxScaleController.prototype.isCopy=function(){return this.copy};
McxScaleController.prototype.end=function(a,b){if(null!=this._anchorPoint){var c=(new McxLineSegment(a.getX(),a.getY(),b.getX(),b.getY(),this.base.map.getCoordinateSystem())).getLength()/this.screenRatio;this.scaleObjects(c)}};
McxScaleController.prototype.scaleObjects=function(a){for(var b=McxFeatureHelper.instance.groupByLayer(this.features),c=[],d=0;d<b.length;d++){var e=b[d].getFeatures();b[d].getLayer();for(var f=new McxFeatureOperationAction,g=[],h=0;h<e.length;h++){var k=e[h],m=k.getClone();if(!k.getGeometry().isInstanceOf(McxGeometryType.Point)&&!k.getGeometry().isInstanceOf(McxGeometryType.Point)){var n=k.getGeometry().clone().transformTo(this.base.map.getCoordinateSystem());n.scale(this._anchorPoint,a);k.setGeometry(n);
var p=k.getLayer(),p=k.getGeometry().transformTo(p.getCoordinateSystem());k.setGeometry(p);this.copy?(m=b[d].getLayer().createFeatureBuffer(),m.setGeometry(n),m.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&m.getGeometry().setCoordinateSystem(m.getLayer().getCoordinateSystem()),g.push(m),this.newFeatureDictionary.setValue(m.getGlobalID(),k)):(c.push(m),n=new McxMemFeature(k.getLayer(),null),(new McxAjaxParameter).setAsync(!1),n.setFeatureID(k.getFeatureID()),n.setGeometry(k.getGeometry()),
n.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&n.getGeometry().setCoordinateSystem(n.getLayer().getCoordinateSystem()),g.push(n))}}this.copy?(e=new McxAjaxParameter,e.setParameters(this,this.insertSuccess,this.insertFail),f.AddInsertList(g,e)):(e=new McxAjaxParameter,e.setParameters(this,this.updateSuccess,this.updateFail),e.setArgs(c),f.AddUpdateList(g,e));this.base.map.getInputHandler().execute(f)}};
McxScaleController.prototype.insertSuccess=function(a){var b=a.getFeatures(),c=new McxAjaxParameter;c.setParameters(this,this.updateSuccess,this.updateFail);for(a=0;a<b.length;a++){var d=b[a],e=this.newFeatureDictionary.getValue(d.getGlobalID()),f=new McxAjaxParameter;f.setAsync(!1);e.setMissing(f);McxFeatureHelper.instance.copyFields(e,d);d.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&d.getGeometry().setCoordinateSystem(d.getLayer().getCoordinateSystem());e=new McxFeatureOperationAction;
e.AddUpdateList([d],c);this.base.map.getInputHandler().execute(e)}b=McxFeatureHelper.instance.groupByLayer(b);for(a=0;a<b.length;a++)c=b[a].getLayer(),d=b[a].getFeatures(),d=McxFeatureHelper.instance.getBB(d),this.base.map.getRenderer().paintLayer(c,d)};McxScaleController.prototype.insertFail=function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-ErrorOccured"),McxMessageBoxType.Error)};
McxScaleController.prototype.updateSuccess=function(a){if(!this.copy){var b=a.getArgs();a=a.getFeatures();a=a.concat(b);b=McxFeatureHelper.instance.groupByLayer(a);for(a=0;a<b.length;a++){var c=b[a].getLayer(),d=b[a].getFeatures(),d=McxFeatureHelper.instance.getBB(d);this.base.map.getRenderer().paintLayer(c,d)}}};McxScaleController.prototype.updateFail=function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-ErrorOccured"),McxMessageBoxType.Error)};
McxScaleController.prototype.getOptionUI=function(){return this._controllerUI};
McxScaleController.prototype.createControllerUI=function(){function a(){if(this.dialogMode){var a=this._xEditor.getValue(),b=this._yEditor.getValue();this._anchorPoint=new McxPoint(a,b,null);this.lastRatio=a=this._scaleEditor.getValue();this.features=b=McxSelectionHelper.instance.getSelection(this.base.map);this.markers=McxMarkerHelper.instance.createMarker(b,this.markerId,this.base.map.getCoordinateSystem());for(b=0;b<this.markers.length;b++)this.markers[b].getGeometry().scale(this._anchorPoint,
a);this.base.map.getRenderer().paintNonLayer()}}this._controllerUI.setTitle("Scale","McxEditing-scaleling");this._controllerUI.setWidth(200);this._controllerUI.addControl(new McxLabeledEditor("Scale",this._scaleEditor,"McxEditing-scale"));this._controllerUI.addControl(new McxLabeledEditor("X",this._xEditor,"McxEditing-xValue"));this._controllerUI.addControl(new McxLabeledEditor("Y",this._yEditor,"McxEditing-yValue"));this._scaleEditor.getOnChangeHandler().addListener(a,null,this);this._yEditor.getOnChangeHandler().addListener(a,
null,this);this._xEditor.getOnChangeHandler().addListener(a,null,this);this._controllerUI.onShowEventHandler().addListener(function(){this.dialogMode=!0;null==this._anchorPoint&&(this._anchorPoint=this.base.map.getWorld().getCentroid());this._xEditor.setValue(this._anchorPoint.getX());this._yEditor.setValue(this._anchorPoint.getY());this._scaleEditor.setValue(this.lastRatio)},null,this);this._controllerUI.getSubmitHandler().addListener(function(){this.dialogMode=!1;this.scaleObjects(this._scaleEditor.getValue());
this.base.map.getInputHandler().setController(null);var a={Scale:this._scaleEditor.getValue(),X:this._xEditor.getValue(),Y:this._yEditor.getValue()};McxSettingsManager.write("McxEditing-ScaleSettings",JSON.stringify(a),null)},null,this);var b=McxSettingsManager.read("McxEditing-ScaleSettings",null).getSettings();if(b&&0<b.length){b=JSON.parse(b[0]);this.lastRatio=parseInt(b.Scale,10);var c=parseFloat(b.X),b=parseFloat(b.Y);this._scaleEditor.setValue(this.lastRatio);this._xEditor.setValue(c);this._yEditor.setValue(b)}};js.builtin.McxEditing.Controller.McxSymmetrizeController={};function McxSymmetrizeController(a){mcx.base(this);this.copy=a;this.markers=[];this.markerId="";this._firstPoint=null;this.features=[];this.changedFeatures=null;this.base=this;this.initControllers()}mcx.inherits(McxSymmetrizeController,McxCompositeController);
McxSymmetrizeController.prototype.initControllers=function(){var a=new McxSelectController;this.base.add(a);a=McxFactoryFinder.StyleFactory().createLineSymbolizerWithColor("black");a=new McxPaintLineSegmentController(a);a.getPointListChangedEventHandler().addListener(this.segmentControllerCoordinateListChanged,null,this);this.base.add(a)};
McxSymmetrizeController.prototype.segmentControllerCoordinateListChanged=function(a){switch(a.getPoints().length){case 1:this.onFirstCoordinateCreated(a.getPoints()[0]);this.base.setDescription(this.getDescriptionOfStep(2));this._firstPoint=a.getPoints()[0];break;case 2:this.onLineSegmentCreated(a.getPoints()[0],a.getPoints()[1]),McxSelectionHelper.instance.clearSelection(this.base.map),this.base.map.getRenderer().paintSelections(),this.base.map.getInputHandler().setController(null)}};
McxSymmetrizeController.prototype.onStartInteraction=function(){McxSymmetrizeController.superClass_.onStartInteraction.call(this);this.markerId=McxGuid.createGuid();0!=McxSelectionHelper.instance.getSelection(this.base.map).length&&this.base.performNextStep()};
McxSymmetrizeController.prototype.onEndInteraction=function(){McxSymmetrizeController.superClass_.onEndInteraction.call(this);this.reset();this.features=[];this.markers=[];McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();this.base.map.getRenderer().paintNonLayer()};
McxSymmetrizeController.prototype.nextStep=function(a,b){var c=!1;switch(b){case 0:this.features=[];this.base.setDescription(this.getDescriptionOfStep(0));break;case 1:McxSelectionHelper.instance.checkSelection(this.base.map)||(c=!0),this.base.setDescription(this.getDescriptionOfStep(1))}return c};
McxSymmetrizeController.prototype.getDescriptionOfStep=function(a){if(this.copy)switch(a){case 0:return"McxEditing-SymmetrizeAndCopyDescription1";case 1:return"McxEditing-SymmetrizeAndCopyDescription2"}else switch(a){case 0:return"McxEditing-SymmetrizeAndMoveDescription1";case 1:return"McxEditing-SymmetrizeAndCopyDescription2"}return""};
McxSymmetrizeController.prototype.onFirstCoordinateCreated=function(a){a=McxSelectionHelper.instance.getSelection(this.base.map);this.features=[];this.features=this.features.concat(a);a=McxMarkerHelper.instance.createMarker(this.features,this.markerId,this.base.map.getCoordinateSystem());this.markers=this.markers.concat(a)};
McxSymmetrizeController.prototype.onLineSegmentCreated=function(a,b){var c=McxFactoryFinder.GeometryFactory(this.base.map.getCoordinateSystem()).createLineSegment(a,b);this.changedFeatures=this.features;this.symmetrizeFeatures(c)};McxSymmetrizeController.prototype.paint=function(a){McxSymmetrizeController.superClass_.paint.call(this,a);if(!(1>this.base.currentStep))for(var b=0;b<this.markers.length;b++)this.markers[b].paint(a)};
McxSymmetrizeController.prototype.symmetrizeFeatures=function(a){var b=new McxAjaxParameter;b.setParameters(this,function(a){a=a.getFeatures();a=McxFeatureHelper.instance.groupByLayer(a);for(var b=0;b<a.length;b++){var c=a[b].getLayer(),d=a[b].getFeatures(),d=McxFeatureHelper.instance.getBB(d);this.base.map.getRenderer().paintLayer(c,d)}},function(){for(var a=McxFeatureHelper.instance.groupByLayer(this.changedFeatures),b=0;b<a.length;b++){var c=a[b].getLayer(),d=a[b].getFeatures(),d=McxFeatureHelper.instance.getBB(d);
this.base.map.getRenderer().paintLayer(c,d)}});for(var c=0;c<this.features.length;c++){var d=this.features[c],e=this.symmetrizeGeometry(d.getGeometry(),a),f=d.getGeometry().getCoordinateSystem();e.setCoordinateSystem(f);f=d.getLayer().createFeatureBuffer();f.setGeometry(e);f.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&f.getGeometry().setCoordinateSystem(f.getLayer().getCoordinateSystem());e=new McxFeatureOperationAction;e.AddInsertList([f],b);this.base.map.getInputHandler().execute(e);
null!=f&&(e=new McxAjaxParameter,e.setAsync(!1),d.setMissing(e),McxFeatureHelper.instance.copyFields(d,f),d=new McxFeatureOperationAction,d.AddUpdateList([f],b),this.base.map.getInputHandler().execute(d))}};
McxSymmetrizeController.prototype.symmetrizeGeometry=function(a,b){var c=[],d=a.getCoordinateSystem(),e=McxFactoryFinder.GeometryFactory(d);if(a.isInstanceOf(McxGeometryType.Point))return c=this.symmetrizeCoordinate(a,b),c.setCoordinateSystem(d),c;if(a.isInstanceOf(McxGeometryType.MultiPoint)){for(var f=[],g=0;g<a.getPoints().length;g++)c=a.getPoints()[g],c=this.symmetrizeCoordinate(c,b),c.setCoordinateSystem(d),f.push(c);return e.createMultiPoint(f)}if(a.isInstanceOf(McxGeometryType.LineString))return c=
a.getPoints(),c=this.symmetrizeCoordinateList(c,b),c=e.createLineString(c);if(a.isInstanceOf(McxGeometryType.MultiLineString)){f=[];for(g=0;g<a.getLines().length;g++)c=a.getLines()[g],c=c.getPoints(),c=this.symmetrizeCoordinateList(c,b),c=e.createLineString(c),f.push(c);e=e.createMultiLineString(f);e.setCoordinateSystem(d);return e}if(a.isInstanceOf(McxGeometryType.Polygon)){for(var h=a,c=h.getShell().getPoints(),k=this.symmetrizeCoordinateList(c,b),m=h.getHoles(),h=[],n=0;n<m.length;n++)c=m[n].getPoints(),
c=this.symmetrizeCoordinateList(c,b),h.push(e.createLinearRing(c));c=e.createLinearRing(k);c=e.createPolygon(c,h);c.setCoordinateSystem(d);return c}if(a.isInstanceOf(McxGeometryType.MultiPolygon)){f=[];for(g=0;g<a.getPolygons().length;g++){h=a.getPolygons()[g];c=h.getShell().getPoints();k=this.symmetrizeCoordinateList(c,b);m=h.getHoles();h=[];for(n=0;n<m.length;n++)c=m[n].getPoints(),c=this.symmetrizeCoordinateList(c,b),h.push(e.createLinearRing(c));c=e.createLinearRing(k);c=e.createPolygon(c,h);
c.setCoordinateSystem(d);f.push(c)}return e.createMultiPolygon(f)}return null};McxSymmetrizeController.prototype.symmetrizeCoordinateList=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(this.symmetrizeCoordinate(a[d],b));return c};
McxSymmetrizeController.prototype.onMouseMove=function(a){McxSymmetrizeController.superClass_.onMouseMove.call(this,a);if(!(1>this.base.currentStep)&&null!=this.markers&&null!=this._firstPoint){a=this.base.map.viewToWorld(a.getX(),a.getY());a=new McxLineSegment(this._firstPoint.getX(),this._firstPoint.getY(),a.getX(),a.getY(),this.base.map.getCoordinateSystem());for(var b=0;b<this.markers.length;b++)this.markers[b].setGeometry(this.symmetrizeGeometry(this.features[b].getGeometry(),a));this.base.map.getRenderer().paintNonLayer()}};
McxSymmetrizeController.prototype.symmetrizeCoordinate=function(a,b){var c=b.getPerpendicularFoot(a,!0),d=c.getX()-a.getX(),e=c.getY()-a.getY(),d=c.getX()+d,c=c.getY()+e;return McxFactoryFinder.GeometryFactory(a.getCoordinateSystem()).createPoint(d,c)};js.builtin.McxEditing.Controller.McxTrimLineController={};function McxTrimLineController(){mcx.base(this);this.base=this;this.base.canSet=!1;this.base.applyMode=McxApplyMode.Select;this.base.selectToolMode=McxSelectToolMode.Fence;this.canClick=!1;this.activeLayer=null;this.base.removeSelectionAfterDispose=!0}mcx.inherits(McxTrimLineController,McxSelectController);McxTrimLineController.prototype.onStartInteraction=function(){McxTrimLineController.superClass_.onStartInteraction.call(this);this.base.setDescription("McxEditing-TrimLineDescription1")};
McxTrimLineController.prototype.onMouseDown=function(a){McxTrimLineController.superClass_.onMouseDown.call(this,a);"right"==a.getButton()&&McxSelectionHelper.instance.checkSelection(this.base.map)&&(1>McxSelectionHelper.instance.getSelection(this.base.map).length?(McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-selectOneFeatureMessage"),McxMessageBoxType.Warning),McxSelectionHelper.instance.clearSelection(this.base.map),this.base.map.getRenderer().paintSelections()):(this.base.setDescription("McxEditing-TrimLineDescription2"),
this.canClick=!0))};
McxTrimLineController.prototype.onSelectFeaturesSuccess=function(a){for(var b=a.getFeatures(),c=[],d=0;d<b.length;d++){var e=b[d].getGeometry();(e.isInstanceOf(McxGeometryType.LineString)||e.isInstanceOf(McxGeometryType.LinearRing)||e.isInstanceOf(McxGeometryType.LineSegment))&&c.push(b[d])}0>=c.length||(this.canClick?this.trim(this.base.map,c,a.getFilter().getGeometry()):(a=new McxSelectResult(a.getFilter(),c,a.getLayer(),a.getArgs()),McxTrimLineController.superClass_.onSelectFeaturesSuccess.call(this,a)))};
McxTrimLineController.prototype.trim=function(a,b,c){this.activeLayer=a.getLayers().getActiveLayer();var d=new McxAjaxParameter;d.setParameters(this,function(b){b=McxFeatureHelper.instance.getBB(b.getFeatures());a.getRenderer().paintLayer(this.activeLayer,b)},function(){});for(var e=this.convertFeaturesToViewport(b),f=0;f<e.length;f++){var g=McxSelectionHelper.instance.getSelection(a),h=this.convertFeaturesToViewport(g);if(1>g.length||0==g.length)return!1;if(!e[f].isInstanceOf(McxGeometryType.LineString))return McxMessageBox.show("",
McxLocalizationManager.getLocaleValue("McxEditing-onlyLinesTrimMessage"),McxMessageBoxType.Warning),!1;for(var k=!1,m=0;m<g.length;m++)g[m].getFeatureID()==b[f].getFeatureID()&&(k=!0,McxSelectionHelper.instance.removeSelection(a,g[m]));var n=e[f].clone(),p=n.segmentize(),q=[h.length+2*p.length],r=[];r.push(n.getStartPoint().clone());q[0]=p[0].getStartPoint().clone();for(var t=1,u=0;u<p.length;u++)q[u+1]=p[u].getEndPoint().clone();m=p.length+1;for(u=0;u<h.length;u++)if(b[f].getFeatureID()!=g[u].getFeatureID())for(var v=
0;v<p.length;v++){var w=this.intersectWithSegment(p[v],h[u]);null!=w&&(q[m]=w,r.push(w),t++,m++)}r.push(n.getEndPoint().clone());t++;h=[m];for(u=0;u<h.length;u++)h[u]=[];for(g=1;g<m;g++)h[g]=[2],h[g][0]=g,h[g][1]=q[0].distanceTo(q[g]);for(p=1;p<m;p++){g=h[p][1];n=p;for(u=p+1;u<m;u++)g>h[u][1]&&(g=h[u][1],n=u);u=h[n][1];v=h[n][0];h[n][1]=h[p][1];h[n][0]=h[p][0];h[p][1]=u;h[p][0]=v}g=[m];g[0]=q[0].clone();for(n=1;n<m;n++)g[n]=q[h[n][0]].clone();q=[t];for(u=0;u<q.length;u++)q[u]=[];for(u=1;u<t;u++)q[u]=
[2],q[u][0]=u,q[u][1]=r[0].distanceTo(r[u]);for(p=1;p<t;p++){h=q[p][1];n=p;for(u=p+1;u<t;u++)h>q[u][1]&&(h=q[u][1],n=u);u=q[n][1];v=q[n][0];q[n][1]=q[p][1];q[n][0]=q[p][0];q[p][1]=u;q[p][0]=v}u=[t];u[0]=r[0].clone();for(n=1;n<t;n++)u[n]=r[q[n][0]].clone();q=r=null;h=Number.MAX_VALUE;for(n=0;n<t-1;n++)p=McxFactoryFinder.GeometryFactory(null).createLineSegment(u[n],u[n+1]).distanceTo(c),h>p&&(r=u[n].clone(),q=u[n+1].clone(),h=p);if(null==r)return!1;n=h=!1;u=[m];t=[m];for(w=v=p=0;w<m;w++)g[w].equals(r)?
(u[p]=g[w],p++,h=!0):h?g[w].equals(q)?(t[v]=g[w],v++,n=!0):n&&(t[v]=g[w],v++):(u[p]=g[w],p++);h=[];h.push(u[0]);for(m=1;m<u.length;m++)null!=u[m]&&(g=Math.abs(u[m].getX()-u[m-1].getX()),r=Math.abs(u[m].getY()-u[m-1].getY()),(1E-6<g||1E-6<r)&&h.push(u[m]));q=!1;1<h.length&&(m=McxFactoryFinder.GeometryFactory(this.activeLayer.getCoordinateSystem()).createLineString(h),m.isInstanceOf(McxGeometryType.Point)||(m.setCoordinateSystem(a.getCoordinateSystem()),g=this.activeLayer.createFeatureBuffer(),g.setGeometry(m),
this.activeLayer.isInstanceOf("IMcxSelectableLayer")&&k&&McxSelectionHelper.instance.addSelection(a,[g]),McxFeatureHelper.instance.copyFields(b[f],g),m=new McxFeatureOperationAction,m.AddInsertList([g],d),this.base.map.getInputHandler().execute(m),q=!0));u=[];u.push(t[0]);for(m=1;m<t.length;m++)null!=t[m]&&(g=Math.abs(t[m].getX()-t[m-1].getX()),r=Math.abs(t[m].getY()-t[m-1].getY()),(1E-6<g||1E-6<r)&&u.push(t[m]));1<u.length&&(m=McxFactoryFinder.GeometryFactory(this.activeLayer.getCoordinateSystem()).createLineString(u),
m.isInstanceOf(McxGeometryType.Point)||(m.setCoordinateSystem(a.getCoordinateSystem()),g=this.activeLayer.createFeatureBuffer(),g.setGeometry(m),this.activeLayer.isInstanceOf("IMcxSelectableLayer")&&k&&McxSelectionHelper.instance.addSelection(a,[g]),McxFeatureHelper.instance.copyFields(b[f],g),m=new McxFeatureOperationAction,m.AddInsertList([g],d),this.base.map.getInputHandler().execute(m),q=!0));q?(m=new McxFeatureOperationAction,m.AddDeleteList([b[f]],d),this.base.map.getInputHandler().execute(m)):
this.activeLayer.isInstanceOf("IMcxSelectableLayer")&&k&&McxSelectionHelper.instance.addSelection(a,[b[f]])}return!0};McxTrimLineController.prototype.intersectWithSegment=function(a,b){for(var c=b.segmentize(),d=0;d<c.length;d++){var e=a.intersectSegmentWithOptions(c[d],!0),f=e[0];if(null!=f){f.distanceTo(b);f.distanceTo(c[d]);var g=e[1],h=e[2];if(e[3]&&-5E-8<g&&1.000000005>g&&-5E-8<h&&1.000000005>h)return f}}return null};
McxTrimLineController.prototype.convertFeaturesToViewport=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c].getGeometry();b.push(d.transformTo(this.base.map.getCoordinateSystem()))}return b};js.builtin.McxEditing.Controller.McxUnionGeometriesController={};function McxUnionGeometriesController(){mcx.base(this);this._dialog=null;this._features=[];this._geometry=this._targetLayer=null;this.base=this}mcx.inherits(McxUnionGeometriesController,McxSelectController);
McxUnionGeometriesController.prototype.onStartInteraction=function(){McxUnionGeometriesController.superClass_.onStartInteraction.call(this);McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections();this.base.setDescription("McxEditing-UnionDescription")};
McxUnionGeometriesController.prototype.onMouseDown=function(a){McxUnionGeometriesController.superClass_.onMouseDown.call(this,a);if("right"==a.getButton()&&McxSelectionHelper.instance.checkSelection(this.base.map))if(this._features=McxSelectionHelper.instance.getSelection(this.base.map),2>this._features.length)McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-selectAtLeastTwoFeatureMessage"),McxMessageBoxType.Warning),McxSelectionHelper.instance.clearSelection(this.base.map),
this.base.map.getRenderer().paintSelections();else try{a=[];for(var b=0;b<this._features.length;b++)a.push(this._features[b].getGeometry());this._geometry=McxGeospatialServiceManager.union(a);var c=McxMarkerHelper.instance.createMarkerFromGeometry(this._geometry,McxGuid.createGuid());this.base.map.getMarkerCollection().addRange(c);this.base.map.getRenderer().paintNonLayer();var d=McxMapHelper.getSelectableLayers(this.base.map);this._dialog=new McxSaveEditResultDialog(d);this._dialog.getOkButtonClickHandler().addListener(this.applyOperation,
null,this);this._dialog.onCloseDialog().addListener(this.dialogClosed,null,this);this._dialog.showDialog(!0,!1);var e=McxLocalizationManager.getLocaleValue("McxEditing-Union");this._dialog.setTitle(e,"McxEditing-Union")}catch(f){"geometries is null"==f.message&&McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-SelectedGeometriesProblem"),McxMessageBoxType.Error)}};
McxUnionGeometriesController.prototype.applyOperation=function(){this._dialog.onCloseDialog().removeListener(this.applyOperation);this.base.setCursor(this.getCursor());this.base.setDescription("McxEditing-UnionDescription");this._targetLayer=this._dialog.getLayer();var a=McxGeometryHelper.instance.createGeometryWithType(this._geometry,this._targetLayer.getGeometryType(),this._targetLayer.getCoordinateSystem());if(null==a)McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-GeometryTypeNotSupportedError"),
McxMessageBoxType.Error);else{for(var b=0;b<this._features.length;b++){var c=new McxAjaxParameter;c.setAsync(!1);this._features[b].setAllAttributes(c)}b=this._targetLayer.createFeatureBuffer();b=this.findSameValueFields(this._features);b.setGeometry(a);b.getLayer().getCoordinateSystem()!=this.base.map.getCoordinateSystem()&&b.getGeometry().setCoordinateSystem(b.getLayer().getCoordinateSystem());a=new McxAjaxParameter;a.setParameters(this,this.insertSuccess,this.commitFail);c=new McxFeatureOperationAction;
c.AddInsertList([b],a);this.base.map.getInputHandler().execute(c)}};McxUnionGeometriesController.prototype.dialogClosed=function(){this.base.map.getMarkerCollection().clear();McxSelectionHelper.instance.clearSelection(this.base.map);this.base.map.getRenderer().paintSelections()};
McxUnionGeometriesController.prototype.insertSuccess=function(a){a=a.getFeatures();var b=McxFeatureHelper.instance.getBB(a);this.base.map.getRenderer().paintLayer(this._targetLayer,b);if(0!=a.length)if(b=McxFeatureHelper.instance.groupByLayer(this._features),1<b.length&&b[0].getLayer().getName()==this._targetLayer.getName()){a=a[0];var b=this._features[0],c=new McxAjaxParameter;c.setAsync(!1);b.setMissing(c);McxFeatureHelper.instance.copyFields(b,a);b=new McxAjaxParameter;b.setParameters(this,this.updateSuccess,
this.commitFail);c=new McxFeatureOperationAction;c.AddUpdateList([a],b);this.base.map.getInputHandler().execute(c)}else this.deleteFeatures()};McxUnionGeometriesController.prototype.updateSuccess=function(){this.deleteFeatures()};
McxUnionGeometriesController.prototype.deleteFeatures=function(){if(this._dialog.getDeleteStatus()){var a=new McxAjaxParameter;a.setParameters(this,this.deleteSuccess,this.commitFail);for(var b=McxFeatureHelper.instance.groupByLayer(this._features),c=0;c<b.length;c++){b[c].getLayer();var d=b[c].getFeatures(),e=new McxFeatureOperationAction;e.AddDeleteList(d,a);this.base.map.getInputHandler().execute(e)}}else McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-ProcessCompleted"),
McxMessageBoxType.Information)};McxUnionGeometriesController.prototype.deleteSuccess=function(a){a=McxFeatureHelper.instance.groupByLayer(a.getFeatures());for(var b=0;b<a.length;b++){var c=McxFeatureHelper.instance.getBB(a[b].getFeatures());this.base.map.getRenderer().paintLayer(a[b].getLayer(),c)}McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxEditing-ProcessCompleted"),McxMessageBoxType.Information)};
McxUnionGeometriesController.prototype.commitFail=function(a){var b="",b=null!=a?a.getException():McxLocalizationManager.getLocaleValue("McxEditing-ErrorOccured");McxMessageBox.show("",b,McxMessageBoxType.Error)};
McxUnionGeometriesController.prototype.findSameValueFields=function(a){for(var b=[],c=0,d=null,e=0;1>e;e++)for(var f=a[e],d=f.getLayer(),c=d.getSchema().getFieldCount(),g=0;g<c;g++){var h=!0,k=d.getSchema().getField(g);if(""!==f.getValue(g)){for(var m=0;m<a.length;m++){var n=a[m];if(0==h)break;for(var p=0;p<c;p++){var q=n.getLayer().getSchema().getField(p);if(k.getFieldName()==q.getFieldName()&&f.getValue(g)!=n.getValue(p)){h=!1;break}}}1==h&&(h={},h.FieldName=f.getField(g).getFieldName(),h.value=
f.getValue(g),b.push(h))}}a=new McxMemFeature(d,null);for(e=0;e<b.length;e++)h=b[e],a.setValue(h.FieldName,h.value);return a};js.builtin.McxEditing.Dialog={};js.builtin.McxEditing.Dialog.SaveEditResultDialog={};js.builtin.McxEditing.Dialog.SaveEditResultDialog.McxSaveEditResultDialog={};function McxSaveEditResultDialog(a){mcx.base(this);this.base=this;this._rootElement=null;this._targetLayerArray=a;this._deleteCheckBox=this._layerSelectBox=null}mcx.inherits(McxSaveEditResultDialog,McxDialogBase);McxSaveEditResultDialog.prototype.getIsSingleInstance=function(){return!0};McxSaveEditResultDialog.prototype.initialize=function(){this.initializeUiControls()};
McxSaveEditResultDialog.prototype.getDialogSize=function(){return McxDialogSize.medium};
McxSaveEditResultDialog.prototype.initializeUiControls=function(){this._rootElement=$("<div/>");this._layerSelectBox=new McxSelectBox;this._layerSelectBox.setTextGetter("name");this._layerSelectBox.setValueGetter("value");for(var a=0;a<this._targetLayerArray.length;a++){var b={value:a,name:this._targetLayerArray[a].getName()};this._layerSelectBox.addItem(b)}a=new McxLayoutRow;b=$("<span/>").attr("data-localize","McxEditing-TargetLayer").addClass("");a.createAndAddSpan(5,b);a.createAndAddSpan(7,this._layerSelectBox);
this.base.addChild(this._rootElement,a);a=new McxLayoutRow;this._deleteCheckBox=new McxCheckBox;b=$("<span/>").attr("data-localize","McxEditing-DeleteSelection").addClass("");a.createAndAddSpan(5,b);a.createAndAddSpan(7,this._deleteCheckBox);this.base.addChild(this._rootElement,a)};McxSaveEditResultDialog.prototype.getDialogTitle=function(){return""};McxSaveEditResultDialog.prototype.getLocalizationPath=function(){return"$McxEditing/Dialog/SaveEditResultDialog/locale/saveEditResultDialog"};
McxSaveEditResultDialog.prototype.getContent=function(){return this._rootElement};McxSaveEditResultDialog.prototype.getLayer=function(){return this._targetLayerArray[this._layerSelectBox.getSelectedValue()]};McxSaveEditResultDialog.prototype.getDeleteStatus=function(){return this._deleteCheckBox.isChecked()};
js.app={};js.app.McxAppDomain={};js.app.McxAppDomain.IMcxAddon={};function IMcxAddon(){}IMcxAddon.prototype.getId=function(){};IMcxAddon.prototype.getName=function(){};IMcxAddon.prototype.getDescription=function(){};IMcxAddon.prototype.getRibbonControl=function(){};IMcxAddon.prototype.getLocalizationFilePath=function(){};IMcxAddon.prototype.initialize=function(a){};IMcxAddon.prototype.getCssFilePath=function(){};IMcxAddon.prototype.getMenuIconSrc=function(){};js.app.McxAppDomain.IMcxAddonInfo={};function IMcxAddonInfo(){}IMcxAddonInfo.prototype.getClassName=function(){};IMcxAddonInfo.prototype.getKeys=function(){};IMcxAddonInfo.prototype.getPath=function(){};IMcxAddonInfo.prototype.getId=function(){};js.app.McxAppDomain.IMcxAddonManager={};function IMcxAddonManager(){}IMcxAddonManager.prototype.getCount=function(){};IMcxAddonManager.prototype.getAddonByIndex=function(a){};IMcxAddonManager.prototype.getAddonById=function(a){};IMcxAddonManager.prototype.addAddon=function(a,b){};js.app.McxAppDomain.IMcxApplication={};function IMcxApplication(){}IMcxApplication.prototype.getHelperFinder=function(){};IMcxApplication.prototype.getConfigurations=function(){};IMcxApplication.prototype.getBeforeAddonInitializeHandler=function(){};IMcxApplication.prototype.addFloatingDialog=function(a,b,c,d,e,f,g,h){};IMcxApplication.prototype.addDockableDialog=function(a,b,c,d,e,f){};IMcxApplication.prototype.showNotification=function(a,b){};IMcxApplication.prototype.getDriverManager=function(){};
IMcxApplication.prototype.getToolBar=function(){};IMcxApplication.prototype.getLocaleValue=function(a){};IMcxApplication.prototype.getSecurityManager=function(){};IMcxApplication.prototype.addDocument=function(a){};IMcxApplication.prototype.removeDocument=function(a){};IMcxApplication.prototype.createDocument=function(a){};IMcxApplication.prototype.getActiveDocumentChangedEventHandler=function(){};IMcxApplication.prototype.getActiveMap=function(){};IMcxApplication.prototype.getActiveDocument=function(){};
IMcxApplication.prototype.initialize=function(){};IMcxApplication.prototype.getFeatureExplorerDialog=function(){};IMcxApplication.prototype.showFeatureExplorerDialog=function(){};IMcxApplication.prototype.getDocumentAddEventHandler=function(){};IMcxApplication.prototype.getDocuments=function(){};IMcxApplication.prototype.getWorkspaces=function(a){};IMcxApplication.prototype.setDocumentFactory=function(a){};IMcxApplication.prototype.getLoadingIndicator=function(){};
IMcxApplication.prototype.showMenu=function(){};IMcxApplication.prototype.hideMenu=function(){};IMcxApplication.prototype.getWorkspaceOpenedEventHandler=function(){};js.app.McxAppDomain.IMcxDocument={};function IMcxDocument(){}IMcxDocument.prototype.getContent=function(){};IMcxDocument.prototype.getTitleChangedEventHandler=function(){};IMcxDocument.prototype.getTitle=function(){};IMcxDocument.prototype.setTitle=function(a){};IMcxDocument.prototype.getMap=function(){};IMcxDocument.prototype.getWorkspaceInfo=function(){};IMcxDocument.prototype.setWorkspaceInfo=function(a){};IMcxDocument.prototype.setIsNeedUpdate=function(a){};
IMcxDocument.prototype.isNeedUpdate=function(){};IMcxDocument.prototype.getLegend=function(){};IMcxDocument.prototype.isInstanceOf=function(a){};js.app.McxAppDomain.IMcxDocumentFactory={};function IMcxDocumentFactory(){}IMcxDocumentFactory.prototype.createDocument=function(a){};js.app.McxAppDomain.IMcxDriverManager={};function IMcxDriverManager(){}IMcxDriverManager.prototype.addDriver=function(a){};IMcxDriverManager.prototype.getDriverByGuid=function(a){};IMcxDriverManager.prototype.getCount=function(){};IMcxDriverManager.prototype.getDriverByIndex=function(a){};IMcxDriverManager.prototype.openDataSource=function(a,b){};IMcxDriverManager.prototype.registerDataSource=function(a,b,c){};js.app.McxAppDomain.IMcxHelperFinder={};function IMcxHelperFinder(){}IMcxHelperFinder.prototype.getGeometryHelper=function(){};IMcxHelperFinder.prototype.getFeatureHelper=function(){};IMcxHelperFinder.prototype.getMarkerHelper=function(){};IMcxHelperFinder.prototype.getSelectionHelper=function(){};js.app.McxAppDomain.IMcxRibbonControl={};function IMcxRibbonControl(){}IMcxRibbonControl.prototype.getName=function(){};IMcxRibbonControl.prototype.getHtmlPageUrl=function(){};IMcxRibbonControl.prototype.initialize=function(a){};js.app.McxAppDomain.IMcxSecurityManager={};function IMcxSecurityManager(){}IMcxSecurityManager.prototype.authorizeUser=function(a,b,c,d){};IMcxSecurityManager.prototype.isInRole=function(a){};IMcxSecurityManager.prototype.getValueFromDictionary=function(a,b){};IMcxSecurityManager.prototype.getCurrentUser=function(){};IMcxSecurityManager.prototype.saveWorkspace=function(a,b){};IMcxSecurityManager.prototype.deleteWorkspace=function(a,b){};
IMcxSecurityManager.prototype.setDefaultWorkspace=function(a,b){};IMcxSecurityManager.prototype.setCloudServiceUrl=function(a){};IMcxSecurityManager.prototype.getUserRolesChangedEventHandler=function(){};IMcxSecurityManager.prototype.getAddonList=function(){};IMcxSecurityManager.prototype.recoverPassword=function(a,b,c,d){};IMcxSecurityManager.prototype.changePassword=function(a,b,c){};IMcxSecurityManager.prototype.getAddonInfo=function(){};js.app.McxAppDomain.McxAddonEventArgs={};function McxAddonEventArgs(a){mcx.base(this,a);this._addon=a}mcx.inherits(McxAddonEventArgs,McxEventArgs);McxAddonEventArgs.prototype.getAddon=function(){return this._addon};js.app.McxAppDomain.McxApplication={};var McxApplication=null;$(window).on("load",function(){McxApplication=new window.McxMain;$("body").bind("contextmenu",function(a){a.preventDefault();a.stopPropagation();return!1});McxApplication.initialize()});js.app.McxAppDomain.McxAuthorizeUserResult={};function McxAuthorizeUserResult(a){mcx.base(this);this._result=a}mcx.inherits(McxAuthorizeUserResult,McxResult);McxAuthorizeUserResult.prototype.getResult=function(){return this._result};js.app.McxAppDomain.McxDockPosition={};var McxDockPosition={left:0,right:1,bottom:2};js.app.McxAppDomain.McxDocumentSearchResult={};function McxDocumentSearchResult(){this._radioName=this._googleData=this._data=null}McxDocumentSearchResult.prototype.setData=function(a){this._data=a};McxDocumentSearchResult.prototype.setGoogleData=function(a){this._googleData=a};McxDocumentSearchResult.prototype.setDataSource=function(a){this._dataSource=a};McxDocumentSearchResult.prototype.setSearchRadioName=function(a){this._radioName=a};McxDocumentSearchResult.prototype.getData=function(){return this._data};
McxDocumentSearchResult.prototype.getGoogleData=function(){return this._googleData};McxDocumentSearchResult.prototype.getDataSource=function(){return this._dataSource};McxDocumentSearchResult.prototype.getSearchRadioName=function(){return this._radioName};js.app.McxAppDomain.McxGridCanvas={};
function McxGridCanvas(a,b,c){this.layer=a;this.zIndex=b.getLayers().getCount()+1;this.map=b;this.height=this.width=0;this.isDirty=!0;this.layerId=McxGuid.createGuid();this.wholeWorld=c.getBounds();this.cellWidth=c.getCellWidthInCoordinates();this.cellHeight=c.getCellHeightInCoordinates();this.cellSizeWidth=c.getCellCountOnXAxis();this.cellSizeHeight=c.getCellCountOnYAxis();this.textSymbolizer=McxFactoryFinder.StyleFactory().createTextSymbolizer();this.showCellValues=!1;this.rendererEventHandler=
new McxEventHandler;this.labelRendererEventHandler=new McxEventHandler;this.canvasId=McxGuid.createGuid();this.translateY=this.translateX=0;this.maxValue=c.getMaxValue();this.minValue=c.getMinValue();this.gradient=c.getGradient();this.paintedCells={};this.requests=[];this.definedLevels={};this.cleanCanvas=!0;this.renderAborted=!1;this.dataSource=c.getDataSource();this.queryLayerName=c.getQueryLayerName();this.initialize(this.zIndex)}
McxGridCanvas.prototype.initialize=function(a){a=$("<div/>").css("position","absolute").css("zIndex",this.zIndex).attr("id",this.layerId).addClass("");var b=$("<div/>").css("position","absolute").css("zIndex",this.zIndex).css("opacity",1).attr("id",this.layerId+"_divContainer").addClass(""),c=$("<div/>").css("position","absolute").css("zIndex",this.zIndex+1).attr("id",this.layerId+"_zoom").addClass(this.map.getRenderer().getZoomAnimationClass()),d=document.getElementById(this.map.getName()+"_layerContainer");
$(d).append(a);$(a).append(b);$(a).append(c);this.definedLevels[7.5E-8]=1920;this.definedLevels[1.5E-7]=960;this.definedLevels[3E-7]=480;this.definedLevels[6E-7]=90;this.definedLevels[2.4E-6]=90;this.definedLevels[4.8E-6]=90;this.definedLevels[9.6E-6]=30};McxGridCanvas.prototype.getLayer=function(){return this.layer};
McxGridCanvas.prototype.paintLayer=function(a){var b=function(a){var b=a.getFeatureReader(),c=a.getArgs()[0],d=a.getArgs()[1];this.paintedCells.push(d);a=document.getElementById(d.toString());a=document.createElement("canvas");a.id=d.toString();a.style.position="absolute";a.setAttribute("height",(Math.floor(c.getHeight())+2).toString()+"px");a.setAttribute("width",(Math.floor(c.getWidth())+2).toString()+"px");a.globalCompositeOperation="source-over";var d=document.getElementById(this.layerId+"_divContainer"),
e=(c.getLeft()-this.translateX).toString(),f=(c.getBottom()-this.translateY).toString();$(a).css("-webkit-transform","translate3d("+e+"px, "+f+"px,0px)").css("-moz-transform","translate3d("+e+"px, "+f+"px,0px)").css("-ms-transform","translate3d("+e+"px, "+f+"px,0px)").css("-o-transform","translate3d("+e+"px, "+f+"px,0px)").css("transform","translate3d("+e+"px, "+f+"px,0px)");for(var e=[],g=[],h=[],f=[],k=[];b.read();){var m=b.getCurrent(),n=m.getField(0),p=m.getValue(n.getAlias());if(p){k.push(p);
var n=m.getField(1),n=parseInt(m.getValue(n.getAlias()),10),q=m.getField(2),m=parseInt(m.getValue(q.getAlias()),10);g.push(n);h.push(m);n=this.calculateCellDisplay(n,m);if(!n)return;f.push(n);n=this.gradient.getColorAtStop((p-this.minValue)/(this.maxValue-this.minValue)*100);e.push(n)}}b=a.getContext("2d");for(n=0;n<e.length;n++)h=f[n].getLeft()-c.getLeft(),g=f[n].getBottom()-c.getBottom(),p=Math.floor(f[n].getWidth())+2,m=Math.floor(f[n].getHeight())+2,b.fillStyle=e[n].getRgbStyleString(),b.fillRect(h,
g,p,m);if(this.layer.isShowLabels())for(p=this.layer.getLabelSymbolizer(),b.font.fontsize(p.getFont().getFontSize()),m=p.getDisplacement().getDisplacementX(),q=p.getDisplacement().getDisplacementY(),n=0;n<e.length;n++)h=f[n].getLeft()-c.getLeft(),g=f[n].getBottom()-c.getBottom(),f[n].getWidth(),f[n].getHeight(),b.textBaseline="top",b.fillStyle=p.getFill().getColor(),h=m+h,g=q+g+20,b.fillText(k[n].toLocaleString(),h,g,100);0<e.length&&d.appendChild(a)};if(this.map.inVisibleRange(this.layer.getMinScale(),
this.layer.getMaxScale()))if(this.layer.getVisible()){this.abortRender();a=this.calculateGrid(a);this.cleanCanvas=!1;for(var c=a.getLeft(),d=a.getBottom(),e=a.getLeft(),f=a.getBottom(),g=this.getInterval(),h=a.getBottom();h<a.getTop()+1;h+=g)for(var k=a.getLeft();k<a.getRight()+1;k+=g){var c=k,d=h,e=k+g,f=h+g,m=c.toString()+" "+e.toString()+" "+d.toString()+" "+f.toString();if(!(-1<this.paintedCells.indexOf(m))){var n=this.calculateCellDisplay(k,h),p=this.calculateCellDisplay(k+g,h+g),q=Math.min(n.getLeft(),
p.getLeft()),r=Math.min(n.getBottom(),p.getBottom()),t=Math.max(n.getRight(),p.getRight()),n=Math.max(n.getTop(),p.getTop()),p=new McxAjaxParameter;p.setAsync(!1);d=this.dataSource.getLayer(this.queryLayerName+"@"+c+"@"+d+"@"+e+"@"+f,p,!1);c=d.getLayers()[0];if(null==c)return;this.requests.push(d.getRequest());d=new McxAjaxParameter;d.setParameters(this,b,b);d.setArgs([new McxBounds(q,r,t,n,null),m]);c.query("","",d)}}}else this.clearCanvas(),this.clearBackBuffer(),b=new McxRendererEventArgs(McxRendererStatus.End),
this.rendererEventHandler.dispatchOnSuccess(this,b);else this.clearCanvas(),b=new McxRendererEventArgs(McxRendererStatus.End),this.rendererEventHandler.dispatchOnSuccess(this,b)};McxGridCanvas.prototype.getLayers=function(){return[this.layer]};McxGridCanvas.prototype.draw=function(a,b){};McxGridCanvas.prototype.drawLabels=function(a,b){};McxGridCanvas.prototype.paintLabels=function(a){};McxGridCanvas.prototype.paintSelection=function(a){};
McxGridCanvas.prototype.isInstanceOf=function(a){return"McxGridCanvas"==a};McxGridCanvas.prototype.clearCanvas=function(){$("#"+this.layerId+"_divContainer").empty();this.requests=[];this.gradient.clear();this.cleanCanvas=!0};
McxGridCanvas.prototype.zoomTo=function(a,b,c){var d=$("#"+this.layerId+"_zoom");d.css("-webkit-transform-origin",a+"px "+b+"px").css("-moz-transform-origin",a+"px "+b+"px").css("-ms-transform-origin",a+"px "+b+"px").css("-o-transform-origin",a+"px "+b+"px").css("transform-origin",a+"px "+b+"px");d.css("-webkit-transform","scale3d("+c+","+c+",1)").css("-moz-transform","scale3d("+c+","+c+",1)").css("-ms-transform","scale3d("+c+","+c+",1)").css("-o-transform","scale3d("+c+","+c+",1)").css("transform",
"scale3d("+c+","+c+",1)")};McxGridCanvas.prototype.dispose=function(){$("#"+this.layerId).remove()};McxGridCanvas.prototype.clearBackBuffer=function(){};McxGridCanvas.prototype.paintBackBuffer=function(){$("#"+this.layerId+"_divContainer").children("*").appendTo("#"+this.layerId+"_zoom")};McxGridCanvas.prototype.setZoomAnimationClass=function(a){};
McxGridCanvas.prototype.resetZoomAnimationClass=function(){var a=$("#"+this.layerId+"_zoom");setTimeout(function(){a.empty();a.css("-webkit-transform","scale(1)").css("-moz-transform","scale(1)").css("-ms-transform","scale(1)").css("-o-transform","scale(1)").css("transform","scale(1)")},1E3)};McxGridCanvas.prototype.setOrder=function(a){$("#"+this.layerId).css("zIndex",a);$("#"+this.layerId+"_divContainer").css("zIndex",a);$("#"+this.layerId+"_zoom").css("zIndex",a+1)};
McxGridCanvas.prototype.setOpacity=function(a){this.layer.setOpacity(a);$("#"+this.layerId).css("opacity",a)};McxGridCanvas.prototype.setDisplay=function(a,b){var c=document.getElementById(this.layerId);null!=c&&(this.width=c.width=a,this.height=c.height=b)};McxGridCanvas.prototype.clearCache=function(){this.paintedCells=[]};
McxGridCanvas.prototype.abortRender=function(){this.requestsCanceled=!0;for(var a=0;a<this.requests.length;a++)this.requests[a].abort(),a==this.requests.length-1&&(this.requests=[]);this.requests=[]};
McxGridCanvas.prototype.calculateGrid=function(a){var b=null,b=this.cleanCanvas?this.map.getWorld():this.calculateCellWorld(a),c=this.cellWidth;a=this.cellHeight;var d=Math.floor((b.left-this.wholeWorld.left)/c),e=this.wholeWorld.left+d*c,d=Math.ceil((this.wholeWorld.top-b.bottom)/a),f=this.wholeWorld.top-d*a,d=Math.ceil((b.right-this.wholeWorld.left)/c),g=this.wholeWorld.left+d*c,d=Math.ceil((this.wholeWorld.top-b.top)/a),b=new McxBounds(e,f,g,this.wholeWorld.top-d*a,b.getCoordinateSystem()),e=Math.round(b.getWidth()/
c),d=Math.round(b.getHeight()/a),c=Math.round((b.left-this.wholeWorld.left)/c),f=Math.round((this.wholeWorld.top-b.top)/a),b=c-1;a=f-1;c=e+c+1;d=d+f+1;0>b&&(b=0);0>a&&(a=0);c>=this.cellSizeWidth&&(c=this.cellSizeWidth-1);d>=this.cellSizeHeight&&(d=this.cellSizeHeight-1);return new McxBounds(b,a,c,d,null)};McxGridCanvas.prototype.getNonLayerDrawContext=function(){var a=document.getElementById(this.layerId);return new McxDrawContext(this.map,a.getContext("2d"))};
McxGridCanvas.prototype.showIndex=function(a){this.showCellValues=a};McxGridCanvas.prototype.translate=function(a,b){0!=this.map.getPixelScale()&&(this.translateX+=-1*a/this.map.getPixelScale(),this.translateY+=b/this.map.getPixelScale())};McxGridCanvas.prototype.resetTranslation=function(){this.translateY=this.translateX=0};McxGridCanvas.prototype.getRendererEventHandler=function(){return this.rendererEventHandler};McxGridCanvas.prototype.getLabelRendererEventHandler=function(){return this.labelRendererEventHandler};
McxGridCanvas.prototype.canAddLayer=function(a){return!1};McxGridCanvas.prototype.addLayer=function(a){};McxGridCanvas.prototype.calculateCellWorld=function(a){for(var b=Number.MAX_VALUE,c=Number.MAX_VALUE,d=Number.MIN_VALUE,e=Number.MIN_VALUE,f=0;f<a.length;f++){var g=a[f].getWorld(),h=g.getLeft(),k=g.getRight(),m=g.getBottom(),g=g.getTop();h<b&&(b=h);m<c&&(c=m);k>d&&(d=k);g>e&&(e=g)}return new McxBounds(b,c,d,e,null)};
McxGridCanvas.prototype.calculateCellDisplay=function(a,b){var c=new McxPoint(this.wholeWorld.left,this.wholeWorld.top,null),d=this.cellWidth,e=this.cellHeight,f=c.x+(a+1)*d,g=c.y-b*e,c=this.map.worldToView(c.x+a*d,c.y-(b+1)*e),e=this.map.worldToView(f,g),f=Math.min(c.x,e.x),g=Math.min(c.y,e.y),d=Math.max(c.x,e.x),c=Math.max(c.y,e.y);return new McxBounds(f,g,d,c,this.map.getCoordinateSystem())};
McxGridCanvas.prototype.getInterval=function(){var a=this.map.getScale(),b=null,c;for(c in this.definedLevels)if(b=c,a<b)return this.definedLevels[c];return this.definedLevels[b]};McxGridCanvas.prototype.setLevels=function(a){this.definedLevels=a};
McxGridCanvas.prototype.getValueWithPoint=function(a){a=this.map.worldToView(a.getX(),a.getY());var b=this.getIntersect(a);if(!b||null==b)return Number.MIN_VALUE;var c=b.getContext("2d"),b=this.getTransform(b,!1),d=c.getImageData(a.getX()-b.getLeft(),a.getY()-b.getBottom(),1,1).data;a=d[0];c=d[1];b=d[2];d=d[3];return 0==a&&0==c&&0==b&&0==d?Number.MIN_VALUE:this.gradient.getValueOfColor(a,c,b)};
McxGridCanvas.prototype.getIntersect=function(a){for(var b=$("#"+this.layerId+"_divContainer").children("*"),c=0;c<b.length;c++)if(this.getTransform(b[c],!0).contains(a.getX(),a.getY()))return b[c];return null};
McxGridCanvas.prototype.getTransform=function(a,b){var c=a.style.transform;c||(c=a.style.webkitTransform);var d=0,e=0;c&&null!=c&&""!=c&&(d=parseFloat(c.split("(")[1].split(",")[0].replace("px",""))+this.translateX,e=parseFloat(c.split("(")[1].split(",")[1].replace("px",""))+this.translateY);if(0>=$(a).width()+d||0>=$(a).height()+e)return new McxBounds(0,0,0,0,null);0>d&&b&&(d=0);0>e&&b&&(e=0);return new McxBounds(d,e,$(a).width()+d,$(a).height()+e,null)};
McxGridCanvas.prototype.backBufferEnabled=function(a){};js.app.McxAppDomain.McxGridCanvasParameters={};function McxGridCanvasParameters(a,b,c,d,e,f,g,h){this.bounds=a;this.cellCountOnXAxis=b;this.cellCountOnYAxis=c;this.cellHeightInCoordinates=this.cellWidthInCoordinates=0;this.minValue=e;this.maxValue=d;this.gradient=f;this.queryLayerName=h;this.dataSource=g;this.initialize()}
McxGridCanvasParameters.prototype.initialize=function(){this.cellWidthInCoordinates=this.bounds.getWidth()/this.cellCountOnXAxis;this.cellHeightInCoordinates=this.bounds.getHeight()/this.cellCountOnYAxis};McxGridCanvasParameters.prototype.getCellWidthInCoordinates=function(){return this.cellWidthInCoordinates};McxGridCanvasParameters.prototype.getCellHeightInCoordinates=function(){return this.cellHeightInCoordinates};McxGridCanvasParameters.prototype.getCellCountOnXAxis=function(){return this.cellCountOnXAxis};
McxGridCanvasParameters.prototype.getCellCountOnYAxis=function(){return this.cellCountOnYAxis};McxGridCanvasParameters.prototype.getBounds=function(){return this.bounds};McxGridCanvasParameters.prototype.getMinValue=function(){return this.minValue};McxGridCanvasParameters.prototype.getMaxValue=function(){return this.maxValue};McxGridCanvasParameters.prototype.getGradient=function(){return this.gradient};McxGridCanvasParameters.prototype.getQueryLayerName=function(){return this.queryLayerName};
McxGridCanvasParameters.prototype.getDataSource=function(){return this.dataSource};js.app.McxAppDomain.McxHelpViewControl={};
function McxHelpViewControl(){mcx.base(this);this._rootElement=$("<div/>").addClass("mcx-help-view");this._tabButtonContainer=$("<div/>").addClass("mcx-help-view-tab-button-container");this._tabContentContainer=$("<div/>").addClass("mcx-help-view-tab-content-container");this._videoTabContent=$("<div/>").addClass("mcx-help-view-tab-content video");this._documentTabContent=$("<div/>").addClass("mcx-help-view-tab-content document");this._noDocumentsLabel=$("<div/>").addClass("mcx-help-view-tab-content");this.base=
this;this.initialize()}mcx.inherits(McxHelpViewControl,McxUserControl);
McxHelpViewControl.prototype.initialize=function(){var a=this;this._rootElement.append(this._tabButtonContainer);this._rootElement.append(this._tabContentContainer);this._tabContentContainer.append(this._videoTabContent.addClass("state-active-tab"));this._tabContentContainer.append(this._documentTabContent);var b=$("<div/>").addClass("mcx-help-view-tab-button").addClass("state-active-tab").html("Videos").attr("data-localize","McxApplication-mcxHelpViewVideos").data("tab-content",this._videoTabContent),
c=$("<div/>").addClass("mcx-help-view-tab-button").html("Documents").attr("data-localize","McxApplication-mcxHelpViewDocuments").data("tab-content",this._documentTabContent),d=function(){a._tabButtonContainer.find(".state-active-tab").removeClass("state-active-tab");a._tabContentContainer.find(".state-active-tab").removeClass("state-active-tab");$(this).addClass("state-active-tab");$(this).data("tab-content").addClass("state-active-tab")};$(b).click(d);$(c).click(d);this._tabButtonContainer.append(b);
this._tabButtonContainer.append(c)};McxHelpViewControl.prototype.addHelpDocumentUrl=function(a,b){var c=$("<div/>").addClass("mcx-help-view-document-box");c.append($("<a/>").addClass("mcx-help-view-document-overlay").html("Download").attr("data-localize","McxApplication-mcxHelpViewDownloadDocument").prop("href",b).prop("target","_blank")).append($("<div/>").addClass("mcx-help-view-document-image")).append($("<div/>").addClass("mcx-help-view-document-title").html(a));this._documentTabContent.append(c)};
McxHelpViewControl.prototype.addYoutubeChannel=function(a,b){var c=$("<div/>").addClass("mcx-video-channel-title").html(a),d=$("<div/>").addClass("mcx-video-channel-group").appendTo(this._videoTabContent).append(c);a&&d.append(c);var e=$("<ul/>").addClass("mcx-video-channel-list").appendTo(d);$.get(b,function(a){$(a).find("entry").each(function(){e.append($("<li/>").addClass("mcx-video-channel-item").append($("<a/>").attr("href",$(this).find("link:first").attr("href").toString()).attr("target","_blank").append('<div class="mcx-blog-video-frame"></div>').append($("<div/>").addClass("mcx-blog-video").css("background-image",
"url("+$(this).filterNode("media:thumbnail").attr("url")+")")).append($("<div/>").addClass("mcx-blog-video-title").text($(this).find("title").text().toString()))));d.show()})})};McxHelpViewControl.prototype.getLocalizationPath=function(){return"$McxApplication/assets/locale/mcxApplication"};McxHelpViewControl.prototype.getContent=function(){return this._rootElement};$.fn.filterNode=function(a){return this.find("*").filter(function(){return this.nodeName===a})};js.app.McxAppDomain.McxWorkspaceReader={};function McxWorkspaceReader(a){this.driverManager=a}McxWorkspaceReader.prototype.setMap=function(a,b,c,d){return a};McxWorkspaceReader.prototype.createUniqueKey=function(){return(new Date).getTime().toString()};
McxWorkspaceReader.prototype.readXmlToMap=function(a,b,c){var d=this,e=b.findSingleNode("World"),f=parseFloat(e.getSingleNode("MinX").getValue()),g=parseFloat(e.getSingleNode("MinY").getValue()),h=parseFloat(e.getSingleNode("MaxX").getValue()),e=parseFloat(e.getSingleNode("MaxY").getValue()),k="",m=null;b.hasChildNode("AuthorityCode")&&(k=b.findSingleNode("AuthorityCode").getValue());""!=k&&(k=k.split(":"),k=2==k.length?parseInt(k[1],10):0,m=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(k),
a.setCoordinateSystem(m));if(b.hasChildNode("ScaleSet")){for(var m=b.findSingleNode("ScaleSet").findNodes("Scale"),n=[],k=0;k<m.length;k++){var p=m[k].getValue();n.push(p)}0<n.length&&(k=new McxScaleSet(n),a.setScaleSet(k))}b.hasChildNode("RestrictionArea")&&(p=b.findSingleNode("RestrictionArea"),p.isEmpty()||(k=parseFloat(p.findSingleNode("MinX").getValue()),m=parseFloat(p.findSingleNode("MinY").getValue()),n=parseFloat(p.findSingleNode("MaxX").getValue()),p=parseFloat(p.findSingleNode("MaxY").getValue()),
k&&m&&n&&p&&(k=new McxBounds(k,m,n,p,a.getCoordinateSystem()),a.setRestrictedExtend(k))));a.setWorld(f,g,h,e);a.setOpeningBounds(a.getWorld().clone());var q=b.findNodes("Layer");if(0==q.length)return a;f={};for(k=0;k<q.length;k++)g=q[k],h=g.findSingleNode("DataSource").getValue(),0==mcx.isDefAndNotNull(f[h])&&(f[h]=[]),g.hasChildNode("Order")||g.appendTextNode("Order",(q.length-(k+1)).toString()),g.hasChildNode("UniqueId")||g.appendTextNode("UniqueId",McxGuid.createGuid().toLocaleUpperCase()),f[h].push(g);
var r=0,t=Object.keys(f).length,u;for(u in f){g=[];for(k in f[u])g.push(f[u][k].findSingleNode("Name").getValue());h=this.driverManager.openDataSource(u,!0).getDataSource();e=new McxAjaxParameter;e.setParameters(this,function(e){var f=e.getLayers();(function(a){var b=-1,c=a.length,d=function(){b++;b==c?a.callback():a.funcToLoop(d,b)};d()})({length:f.length,funcToLoop:function(c,e){setTimeout(function(){for(var g=f[e],h=0;h<q.length;h++){var k=q[h];if(k.hasChildNode("Name")){var m=!1;try{if((m=k.hasChildNode("IsProceed")?
k.findSingleNode("IsProceed"):null)&&"True"==m.getValue().toString())continue}catch(n){}var p=k.findSingleNode("Name").getValue(),m=p,p=p.split(":");2==p.length&&(m=p[1]);var p=g.getName(),r=p.split(":");2==r.length&&(p=r[1]);if(m==p){k.appendTextNode("IsProceed","True");h=d.createSymbolizerFromXml(k.findSingleNode("Symbolizer").findSingleNode("CompositeSymbolizer"));g.setSymbolizer(h);g.setMinScale(parseFloat(k.findSingleNode("MinScale").getValue()));g.setMaxScale(parseFloat(k.findSingleNode("MaxScale").getValue()));
g.setOpacity(parseFloat(k.findSingleNode("Opacity").getValue()));g.setOrder(parseFloat(k.findSingleNode("Order").getValue()));g.setSingleTile("True"==k.findSingleNode("SingleTile").getValue());g.setScaledLines("True"==k.findSingleNode("ScaleLabels").getValue());g.setCacheable("True"==k.findSingleNode("Cacheable").getValue());g.setVisible("True"==k.findSingleNode("Visible").getValue());g.setEditable("True"==k.findSingleNode("Editable").getValue());g.setGroupName(k.findSingleNode("GroupName").getValue());
g.setAlias(k.findSingleNode("Alias").getValue());g.setUniqueId(k.findSingleNode("UniqueId").getValue());(h=k.findSingleNode("SubtypeType").getValue())&&g.setSubtypeType(new McxDefinedSubtypeObject(parseInt(h.split(",")[0].toString(),0),h.split(",")[1]));h=k.findSingleNode("Filters");if(h.getValue())for(p=h.findNodes("Filter"),h=0;h<p.length;h++)m=d.createFilterFromXml(p[h]),g.getFilterCollection().add(m);else if(h=k.findSingleNode("AttributeFilter").getValue())m=new McxFilter,m.setFilterId("65AA9767-DA96-43D2-B9D2-FB4279682115"),
m.setAttributeFilter(h),g.getFilterCollection().add(m);g.setLabelSymbolizer(d.createSymbolizerFromXml(k.findSingleNode("LabelSymbolizer")));g.setShowLabels("True"==k.findSingleNode("showLabels").getValue());g.setLabelFormat(k.findSingleNode("labelFormat").getValue());g.setMinLabelScale(parseFloat(k.findSingleNode("MinLabelScale").getValue()));g.setMaxLabelScale(parseFloat(k.findSingleNode("MaxLabelScale").getValue()));g.setScaledLabels("True"==k.findSingleNode("ScaleLabels").getValue());m=k.findSingleNode("subtypes").findNodes("subtype");
g.getSubtypes().clear();for(h=0;h<m.length;h++)(p=d.createSubtypeFromXml(m[h]))&&null!=p&&(g.getSubtypes().add(p),r=g.getGeometryType(),r==McxGeometryType.Polygon||r==McxGeometryType.MultiPolygon||r==McxGeometryType.None||r==McxGeometryType.GeometryCollection?(p=p.getSymbolizer().getPolygonSymbolizer().getFill())&&p.getColor():(r==McxGeometryType.LinearRing||r==McxGeometryType.LineSegment||r==McxGeometryType.MultiLineString||r==McxGeometryType.LineString)&&(p=p.getSymbolizer().getLineSymbolizer().getStroke())&&
p.getColor());h="True"==k.findSingleNode("selectable").getValue();g.setSelectable(h);h=parseInt(k.findSingleNode("PainterMode").getValue(),10);0==h?g.setPainterMode(McxPainterMode.ByLayer):1==h?g.setPainterMode(McxPainterMode.ByFeature):g.setPainterMode(McxPainterMode.ByImage);m=k.findSingleNode("IsHeatMap");k=k.findSingleNode("IsClusterMap");m&&"True"==m.getValue()?(k=m.getAttributeValue("Radius"),h=m.getAttributeValue("Opacity"),p=m.getAttributeValue("Gradient"),m=m.getAttributeValue("AdditiveFields"),
k=k?parseFloat(k):10,h=h?parseFloat(h):100,r=McxPredefinedGradients.getGradientByName(p),p=new McxHeatMapCanvas(g,a),p.setParameters(parseFloat(k),parseFloat(h),r||McxPredefinedGradients.getGradientByName("Rainbow")),p.setAdditiveFields(m),k=a.getRenderer(),k.addCanvas(p)):k&&"True"==k.getValue()?(k=(k=k.getAttributeValue("Radius"))?parseInt(k,10):100,h=new McxClusterMapCanvas(g,a),h.setRadius(k),k=a.getRenderer(),k.addCanvas(h)):a.getLayers().add(g);g.getName()==b.findSingleNode("ActiveLayer").getValue()&&
a.getLayers().setActiveLayer(g);break}}}c()},100)},callback:function(){r++;if(r==t){for(var b=a.getLayers(),d=b.toLayerArray(),e=q.length-1;0<=e;e--)for(var f=q[e],g=0;g<d.length;g++){var h=d[g];if(h.getUniqueId()==f.findSingleNode("UniqueId").getValue()){b.changeOrder(h,h.getOrder());break}}a.setLayerCollection(b);a.getRenderer().adjustOrder(b.toLayerArray());t=0;c&&c.getSuccess()&&c.getSuccess().apply(c.getScope())}}})},null);h.getLayer(g.join(";"),e,!0)}return a};
McxWorkspaceReader.prototype.createSymbolizerFromXml=function(a){if(a.isEmpty())return null;switch(a.getNodeName()){case "pointsymbolizer":return McxSldReader.readPointSymbolizer(a);case "linesymbolizer":return McxSldReader.readLineSymbolizer(a);case "polygonsymbolizer":return McxSldReader.readPolygonSymbolizer(a);case "labelsymbolizer":return McxSldReader.readTextSymbolizer(a);case "compositesymbolizer":return McxSldReader.readCompositeSymbolizer(a)}return null};
McxWorkspaceReader.prototype.createSubtypeFromXml=function(a){if(!a||a.isEmpty())return null;var b=a.findSingleNode("Script").getValue(),c=a.findSingleNode("Visible").getValue(),b=new McxScript(b.toString()),b=new McxSubtype(b);b.setMinScale(parseFloat(a.findSingleNode("minScale").getValue()));b.setMaxScale(parseFloat(a.findSingleNode("maxScale").getValue()));a=a.findSingleNode("Symbolizer");0==a.isEmpty()&&(a=McxSldReader.readCompositeSymbolizer(a),b.setSymbolizer(a));b.setVisibility("true"==c.toLowerCase());
return b};McxWorkspaceReader.prototype.createFilterFromXml=function(a){if(!a||a.isEmpty())return null;var b=new McxFilter;b.setFilterId(a.findSingleNode("Id").getValue());var c=a.findSingleNode("AttributeFilter").getValue();c&&b.setAttributeFilter(c);a.findSingleNode("Geometry").getValue();return b};js.app.McxAppDomain.McxWorkspaceWriter={};function McxWorkspaceWriter(){}
McxWorkspaceWriter.prototype.writeMapToXml=function(a){for(var b=McxXMLReader.createXmlNode("Map"),c=McxXMLReader.createXmlNode("Layers"),d=a.getLayers().toLayerArray(),e=0;e<d.length;e++){var f=d[e];if(!f.isInstanceOf("McxMemLayer")){var g=a.getRenderer(),h=null,k=null;mcx.isInstanceOf(g,McxRenderer)&&((g=g.getCanvasByLayer(f))&&mcx.isInstanceOf(g,McxHeatMapCanvas)?h=g:g&&mcx.isInstanceOf(g,McxClusterMapCanvas)&&(k=g));var g=McxXMLReader.createXmlNode("Layer"),m=f.getMinScale(),n=f.getMaxScale();
g.appendTextNode("Name",f.getName());g.appendTextNode("DataSource",f.getDataSource().getSource());g.appendTextNode("ClassId",f.getClassId());g.appendTextNode("UniqueId",f.getUniqueId());m&&m!=Number.NaN&&g.appendTextNode("MinScale",m.toString());n&&n!=Number.NaN&&g.appendTextNode("MaxScale",n.toString());g.appendTextNode("Visible",f.getVisible()?"True":"False");g.appendTextNode("Editable",f.getEditable()?"True":"False");g.appendTextNode("ScaledLines",f.getScaledLines()?"True":"False");g.appendTextNode("Opacity",
f.getOpacity().toString());g.appendTextNode("Order",f.getOrder().toString());g.appendTextNode("SingleTile",f.isSingleTile()?"True":"False");g.appendTextNode("GroupName",f.getGroupName());g.appendTextNode("Alias",f.getAlias());if(h){var m=h.getRadius(),n=h.getOpacity(),p=h.getGradient(),h=h.getAdditiveFields(),q=g.appendTextNode("IsHeatMap","True");q.addAttributeValue("Radius",m?m.toString():"");q.addAttributeValue("Opacity",n?n.toString():"");q.addAttributeValue("Gradient",p?p.getName():"");q.addAttributeValue("AdditiveFields",
h)}else g.appendTextNode("IsHeatMap","False");k?(m=k.getRadius(),g.appendTextNode("IsClusterMap","True").addAttributeValue("Radius",m?m.toString():"")):g.appendTextNode("IsClusterMap","False");k=McxXMLReader.createXmlNode("Filters");for(h=0;h<f.getFilterCollection().getCount();h++)m=f.getFilterCollection().getFilter(h),n=McxXMLReader.createXmlNode("Filter"),n.appendTextNode("Id",m.getFilterId()),""!=m.getAttributeFilter()&&n.appendTextNode("AttributeFilter",m.getAttributeFilter()),null!=m.getGeometry()&&
(n.appendTextNode("Geometry",m.getGeometry().toString()),n.appendTextNode("GeometryRelation",m.getSpatialRelation())),k.appendNode(n);g.appendNode(k);f.isInstanceOf("IMcxLabeledLayer")&&g.appendTextNode("ScaleLabels",f.isScaledLabels()?"True":"False");g.appendTextNode("Cacheable",f.isCacheable()?"True":"False");k=McxXMLReader.createXmlNode("Symbolizer");k.appendNode(f.getSymbolizer().toSLD());g.appendNode(k);g.appendTextNode("ShowLabels",f.isShowLabels()?"True":"False");g.appendTextNode("ScaledLabels",
f.isScaledLabels()?"True":"False");(k=f.getMinLabelScale())&&k!=Number.NaN&&g.appendTextNode("MinLabelScale",k.toString());(k=f.getMaxLabelScale())&&k!=Number.NaN&&g.appendTextNode("MaxLabelScale",f.getMaxLabelScale().toString());mcx.isDefAndNotNull(f.getLabelFormat())&&g.appendTextNode("LabelFormat",f.getLabelFormat());mcx.isDefAndNotNull(f.getLabelSymbolizer())&&(k=McxXMLReader.createXmlNode("LabelSymbolizer"),k.appendNode(f.getLabelSymbolizer().toSLD()),g.appendNode(k));g.appendTextNode("Selectable",
f.isSelectable()?"True":"False");mcx.isDefAndNotNull(f.getSelectionColor())&&g.appendTextNode("SelectionColor",f.getSelectionColor());mcx.isDefAndNotNull(f.getSelectionOpacity())&&g.appendTextNode("SelectionOpacity",f.getSelectionOpacity().toString());g.appendTextNode("PainterMode",f.getPainterMode().toString());if(0<f.getSubtypes().getCount()&&(g.appendTextNode("SubtypeType",f.getSubtypeType().getSubtypeType().toString()+","+f.getSubtypeType().getSubtypeField().toString()),k=McxXMLReader.createXmlNode("Subtypes"),
f=f.getSubtypes(),0<f.getCount())){for(h=0;h<f.getCount();h++)m=f.getAt(h),0!=mcx.isDefAndNotNull(m)&&(n=McxXMLReader.createXmlNode("Subtype"),n.appendTextNode("Script",m.getScript().getScript().toString()),n.appendTextNode("minScale",m.getMinScale().toString()),n.appendTextNode("maxScale",m.getMaxScale().toString()),p=m.getSymbolizer(),mcx.isDefAndNotNull(p)&&(q=McxXMLReader.createXmlNode("Symbolizer"),q.appendNode(p.toSLD()),n.appendNode(q)),n.appendTextNode("Visible",m.isVisible().toString()),
k.appendNode(n));g.appendNode(k)}c.appendNode(g)}}b.appendNode(c);e=McxXMLReader.createXmlNode("World");e.appendTextNode("MinX",a.getWorld().getLeft().toString());e.appendTextNode("MaxX",a.getWorld().getRight().toString());e.appendTextNode("MinY",a.getWorld().getBottom().toString());e.appendTextNode("MaxY",a.getWorld().getTop().toString());b.appendNode(e);c=McxXMLReader.createXmlNode("ScaleSet");if(d=a.getScaleSet())for(e=0;e<d.getScaleLength();e++)c.appendTextNode("Scale",d.getZoomLevelAt(e).toString());
b.appendNode(c);e=a.getRestrictedExtend();c=McxXMLReader.createXmlNode("RestrictionArea");e&&(c.appendTextNode("MinX",e.getLeft().toString()),c.appendTextNode("MaxX",e.getRight().toString()),c.appendTextNode("MinY",e.getBottom().toString()),c.appendTextNode("MaxY",e.getTop().toString()));b.appendNode(c);mcx.isDefAndNotNull(a.getLayers().getActiveLayer())&&b.appendTextNode("ActiveLayer",a.getLayers().getActiveLayer().getName());mcx.isDefAndNotNull(a.getCoordinateSystem())&&b.appendTextNode("AuthorityCode",
a.getCoordinateSystem().getCode());return b};js.app.McxAppDomain.Action={};js.app.McxAppDomain.Action.McxNewMapAction={};function McxNewMapAction(){this._mapOpenCompleteHandler=new McxEventHandler}
McxNewMapAction.prototype.execute=function(a){var b=this;a=McxLocalizationManager.getLocaleValue("McxAppDomain-newMap");var c=new McxInputBoxDialog(a);c.getOkButtonClickHandler().addListener(function(){var a=McxApplication.createDocument(c.getValue());McxApplication.addDocument(a);b.getMapOpenCompleteHandler().dispatchOnSuccess(this,null)},null,this);McxApplication.addFloatingDialog(c,!0,!1,!0,!0)};McxNewMapAction.prototype.getMapOpenCompleteHandler=function(){return this._mapOpenCompleteHandler};
McxNewMapAction.prototype.isInstanceOf=function(a){return"McxNewMapAction"==a};js.app.McxAppDomain.Action.McxOnlineMapAction={};function McxOnlineMapAction(){}McxOnlineMapAction.prototype.execute=function(a){0==mcx.isDefAndNotNull(a)&&(a=McxApplication.getLocaleValue("McxAppDomain-OnlineMap"),a=McxApplication.createDocument(a),McxApplication.addDocument(a),a=a.getMap());a=new McxOnlineMapDialog(a);a.setDataSourceList(McxOnlineMapData.getData());McxApplication.addFloatingDialog(a,!0,!1,!1,!1,!1,!1,!1)};
McxOnlineMapAction.prototype.isInstanceOf=function(a){return"McxOnlineMapAction"==a};js.app.McxAppDomain.Document={};js.app.McxAppDomain.Document.McxReportDocument={};function McxReportDocument(a,b,c){mcx.base(this);this._rootElement=$("<div/>");this._queries={};this._parameters={};this._dataSource=a;this._name=b;this._title=c;this._url="";this.base=this;this._reportType=McxReportType.PDF}mcx.inherits(McxReportDocument,McxUserControl);
McxReportDocument.prototype.getContent=function(){var a=this;setTimeout(function(){a._rootElement.parents(".mcxpanel").addClass("eler-help-document-height");a._rootElement.parents(".mcxpanel-body").addClass("eler-help-document-height");a._rootElement.addClass("eler-help-document-height");a._rootElement.css("height","100%")},1E3);return this._rootElement};McxReportDocument.prototype.getTitleChangedEventHandler=function(){};McxReportDocument.prototype.getTitle=function(){return this._title};
McxReportDocument.prototype.setTitle=function(a){this._title=a};McxReportDocument.prototype.getMap=function(){};McxReportDocument.prototype.getWorkspaceInfo=function(){};McxReportDocument.prototype.setWorkspaceInfo=function(a){};McxReportDocument.prototype.setIsNeedUpdate=function(a){};McxReportDocument.prototype.isNeedUpdate=function(){};
McxReportDocument.prototype.prepare=function(){var a=new McxButton;a.setButtonSize(McxButtonSize.small);a.setIsFullWidth(!1);a.setImage("$McxAppDomain/assets/img/export16.png");a.setButtonVisualType(McxButtonVisualType.button);a.setButtonState(McxButtonState.active);var b=this._dataSource.getReportUri(this._name,this._queries,this._parameters,this._reportType),c=$('<object type="application/pdf" width="100%" height="100%"/>');c.attr("data",b);this._rootElement.append(c);a.getClickHandler().addListener(function(){window.open(b)},
null,this);this.base.addChildControl(a,new McxUIPosition(20,40,McxUIReferencePoint.topRight))};McxReportDocument.prototype.setHTMLPage=function(a){this._url=a;var b=$('<object type="application/pdf" width="100%" height="100%"/>');b.attr("data",a);this._rootElement.append(b)};McxReportDocument.prototype.isInstanceOf=function(a){return"McxReportDocument"==a};McxReportDocument.prototype.addQuery=function(a,b){this._queries[a]=b};
McxReportDocument.prototype.addParameter=function(a,b){this._parameters[a]=b};McxReportDocument.prototype.setReportType=function(a){this._reportType=a};McxReportDocument.prototype.getLegend=function(){return null};
js.app.McxApplication={};js.app.McxApplication.McxAddonInfo={};function McxAddonInfo(a,b,c,d){this._className=a;this._keys=b;this._path=c;this._id=d;this.correctAddonPath()}McxAddonInfo.prototype.correctAddonPath=function(){var a=$(this.getClassName().toLowerCase());if(0<a.length)return this._path=a.attr("src").toString()+"/"+this._path;a=$("mcxaddonpath");if(0<a.length)return this._path=a.attr("src").toString()+"/"+this._path};McxAddonInfo.prototype.getClassName=function(){return this._className};
McxAddonInfo.prototype.getKeys=function(){return this._keys};McxAddonInfo.prototype.getPath=function(){return this._path};McxAddonInfo.prototype.getId=function(){return this._id};js.app.McxApplication.McxAppMapInteractionFactory={};function McxAppMapInteractionFactory(){mcx.base(this)}mcx.inherits(McxAppMapInteractionFactory,McxMapInteractionFactory);McxAppMapInteractionFactory.prototype.createIdentifyController=function(){var a=new McxFeatureExplorerController;a.setterEnabled(!1);return a};js.app.McxApplication.McxAuthenticationManager={};function McxAuthenticationManager(a){this._uiManager=a;this._browserUri="";this._directlyLoginFlag=!1;this._loginSpecifiedWorkspaceId=this._loginObject=null}McxAuthenticationManager.prototype.setBrowserUri=function(a){this._browserUri=a};McxAuthenticationManager.prototype.setLoginObject=function(a){this._loginObject=a};
McxAuthenticationManager.prototype.startApplication=function(a,b,c,d){this._browserUri&&(mcx.isInstanceOf(McxApplication.getSecurityManager(),McxCloudSecurityManager)||this.directlyLogin("","",""),a&&b&&this.directlyLogin(a,b,c||"",d||""),this._directlyLoginFlag||(a?this.loginWithAutDialogWithCurrentNodeInfo(a):this.loginWithAutDialog()))};
McxAuthenticationManager.prototype.directlyLogin=function(a,b,c,d){this._directlyLoginFlag=!0;var e=McxApplication.getSecurityManager();mcx.isInstanceOf(e,McxCloudSecurityManager)&&(this._loginSpecifiedWorkspaceId=d||null,d=new McxAjaxParameter,d.setParameters(this,function(a){},function(a){alert("Authentication failed")}),McxApplication.getSecurityManager().authorizeUser(a,b,c,d))};McxAuthenticationManager.prototype.getLoginSpecifiedWorkspaceId=function(){return this._loginSpecifiedWorkspaceId};
McxAuthenticationManager.prototype.loginWithAutDialogWithCurrentNodeInfo=function(a){a=new McxNode(a,a,"","");var b=new McxUserAuthenticationDialog;b.setNodes([a]);McxApplication.addFloatingDialog(b,!0,!1,!1,!1,!1,!1,!1)};McxAuthenticationManager.prototype.loginWithAutDialog=function(){var a=new McxUserAuthenticationDialog;a.showDialog(!0,!1);a._isRightDockable=!1;a._isBottomDockable=!1};McxAuthenticationManager.prototype.getDirectlyLoginFlag=function(){return this._directlyLoginFlag};js.app.McxApplication.McxCloudSecurityManager={};function McxCloudSecurityManager(){this.password=this.userName=this.nodeId=this.cloudServiceUri="";this.addonInfo=[];this.addonList=[];this.user=null;this.workspaceInfoList=[];this.userRolesChangedEventHandler=new McxEventHandler;this._isInWsSaveProgress=!1;this._credentials="";this._addonCounter=0}
McxCloudSecurityManager.prototype.checkAddonInitializeFinished=function(){this._addonCounter>=this.addonInfo.length&&this.userRolesChangedEventHandler.dispatchOnSuccess(this,null)};
McxCloudSecurityManager.prototype.initialize=function(){this.addonInfo=this.getAddonRoles();this._addonCounter=0;for(var a=this,b=function(b){b=this.qty_input[0];if(window[b.getClassName()]){var c=new (window[b.getClassName()]);a.addonList.push(c);McxPathFinder.addAddonPath(b.getPath());a._addonCounter++;a._addonCounter==a.addonInfo.length&&a.checkAddonInitializeFinished()}else a._addonCounter++,a.checkAddonInitializeFinished()},c=function(){a._addonCounter++;a.checkAddonInitializeFinished()},d=0;d<
this.addonInfo.length;d++){var e=this.addonInfo[d];if(window[e.getClassName()]){var f=new (window[e.getClassName()]);a.addonList.push(f);McxPathFinder.addAddonPath(e.getPath());a._addonCounter++;a._addonCounter==a.addonInfo.length&&a.checkAddonInitializeFinished()}else f=this.cloudServiceUri+"getaddon?token="+encodeURIComponent(this.user.getToken())+"&addonid="+e.getId(),$.ajax({url:f,dataType:"script",async:!0,qty_input:[e,f],success:b,error:c})}};
McxCloudSecurityManager.prototype.authorizeUser=function(a,b,c,d){var e=this,f=new McxAuthorizeUserResult(!1),g="nodeId="+a;this._credentials=mcx.cry(b+";"+c).toString();b="credentials="+encodeURIComponent(this._credentials)+"&";McxAjaxServiceCall.getAjaxCall(this.cloudServiceUri+"GetAuthorizedUser?"+b+g,{},[this],"json",!1,null,d.getAsync(),function(b){b=e.parseJsonDataToUser(b,a,c);e.setUser(a,b,c);f=new McxAuthorizeUserResult(!0);d.getSuccess().call(d.getScope(),f)},function(a){});return f};
McxCloudSecurityManager.prototype.authorizeUserByCredential=function(a,b){var c=!1,d=this,e="nodeId="+a,f="credentials="+encodeURIComponent(b)+"&";McxAjaxServiceCall.getAjaxCall(this.cloudServiceUri+"GetAuthorizedUser?"+f+e,{},[this],"json",!1,null,!1,function(b){b=d.parseJsonDataToUser(b,a,"");d.setUser(a,b,"");c=!0},function(a){c=!1});return c};
McxCloudSecurityManager.prototype.parseJsonDataToUser=function(a,b,c){if(0==mcx.isDefAndNotNull(a))return null;var d=new McxUser;d.setDisplayName(a.DisplayName);d.setId(a.ID);d.setIsGroup(a.IsGroup);d.setUserName(a.UserName);d.setToken(encodeURI(a.Token));d.setNodeId(a.NodeId);(a=a.DefaultWorkspaceId)&&"0"!=a.toString()&&d.setDefaultWorkspaceId(parseFloat(a));b&&c&&d.setImage(this.cloudServiceUri+"GetUserImage?token="+d.getToken());return d};
McxCloudSecurityManager.prototype.isInRole=function(a){var b=!1;0==this.addonList.length&&this.getAddonRoles();for(var c=0;c<this.addonInfo.length;c++)for(var d=this.addonInfo[c].getKeys(),e=0;e<d.length;e++)d[e]==a&&(b=!0);return b};
McxCloudSecurityManager.prototype.shareWorkspace=function(a,b){for(var c=[],d=0;d<b.length;d++)c.push(b[d].getId());var c="sharedUsers="+c.join(";"),d="token="+encodeURIComponent(this.user.getToken())+"&",e="workspaceId="+a.getId()+"&";McxAjaxServiceCall.getAjaxCall(this.cloudServiceUri+"SetWorkspaceSharedUsers?"+d+e+c,{},[this],"json",!1,null,!1,function(a){0<b.length?McxMessageBox.show("",McxLocalizationManager.getLocaleValue("mcxShareSuccess")||"Shared.",McxMessageBoxType.Information):McxMessageBox.show("",
McxLocalizationManager.getLocaleValue("McxApplication-ShareRemoved")||"Shared Removed.",McxMessageBoxType.Information)},function(a){})};
McxCloudSecurityManager.prototype.getNodeUsers=function(){for(var a=this,b=[],c=[],d=0;d<b.length;d++)c.push(b[d].getId());c="token="+encodeURIComponent(this.user.getToken())+"&";McxAjaxServiceCall.getAjaxCall(this.cloudServiceUri+"GetNodeUsers?"+c,{},[this],"json",!1,null,!1,function(c){for(var d=0;d<c.length;d++)b.push(a.parseJsonDataToUser(c[d]))},function(a){});return b};McxCloudSecurityManager.prototype.getUserRolesChangedEventHandler=function(){return this.userRolesChangedEventHandler};
McxCloudSecurityManager.prototype.setCloudServiceUrl=function(a){this.cloudServiceUri=a[0]+"/rest/json/"};
McxCloudSecurityManager.prototype.getAddonRoles=function(){if(""==this.userName)return this.addonInfo;var a=this,b="token="+encodeURIComponent(this.user.getToken())+"&";McxAjaxServiceCall.getAjaxCall(this.cloudServiceUri+"GetUserRoles?"+b+"&type=2",{},[this],"json",!0,null,!1,function(b){if(null!=b&&0!=b.length){a.addonInfo=[];for(var d=0;d<b.length;d++){var e=b[d].Id,f=b[d].Path,g=b[d].Key,h=b[d].ClassName,f=h+"/"+h+".js",e=new McxAddonInfo(h,g,f,e);a.addonInfo[d]=e}}},function(){McxMessageBox.show("",
McxLocalizationManager.getLocaleValue("McxApplication-AddonRightsMessage"),McxMessageBoxType.Error)});return this.addonInfo};McxCloudSecurityManager.prototype.setUser=function(a,b,c){this.userName=b.getUserName();this.user=b;this.initialize()};
McxCloudSecurityManager.prototype.getNodes=function(){var a=[];McxAjaxServiceCall.getAjaxCall(this.cloudServiceUri+"GetNodes",{},[this],"json",!1,3E3,!1,function(b){if(0!=b.length)for(var c=0;c<b.length;c++)a[c]=new McxNode(b[c].ID,b[c].Name,b[c].HostId,b[c].Uri)},function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxApplication-SecurityServiceMessage"),McxMessageBoxType.Error);a=null});return a};
McxCloudSecurityManager.prototype.recoverPassword=function(a,b,c,d){var e=new McxResult,f=this.cloudServiceUri+"RenewalUserPassword?",f=f+("nodeId="+a)+("&userName="+b),f=f+("&email="+c);a=McxAjaxServiceCall.getAjaxCall(f,{},[this],"json",d.getAsync(),3E3,!1,function(a){d.getAsync()&&d.getSuccess().call(d.getScope(),e)},function(a){a=new McxExceptionMessage(a);e.setExceptionMessage(a);d.getAsync()&&d.getError().call(d.getScope(),e)});e.setRequest(a);return e};
McxCloudSecurityManager.prototype.changePassword=function(a,b,c){var d=new McxResult,e=this.cloudServiceUri+"ChangeUserPassword?",e=e+("token="+encodeURIComponent(this.user.getToken())),e=e+("&currentPassword="+mcx.cry(a)),e=e+("&newPassword="+mcx.cry(b));a=McxAjaxServiceCall.getAjaxCall(e,{},[this],"json",c.getAsync(),3E3,!1,function(a){c.getAsync()&&c.getSuccess().call(c.getScope(),d)},function(a){a=new McxExceptionMessage(a);d.setExceptionMessage(a);c.getAsync()&&c.getError().call(c.getScope(),
d)});d.setRequest(a);return d};McxCloudSecurityManager.prototype.setDefaultWorkspaceById=function(a){a="token="+encodeURIComponent(this.user.getToken());McxAjaxServiceCall.getAjaxCall(this.cloudServiceUri+"GetUserDefaultWorkspace?"+a,{},[this],"json",!1,null,!1,function(){},function(){})};
McxCloudSecurityManager.prototype.getWorkspaceInfos=function(a){var b=this;a=a||McxWorkspaceInfoGroupType.allWorkspaces;var c=[],d="type="+a+"&",e="token="+encodeURIComponent(this.user.getToken());McxAjaxServiceCall.getAjaxCall(this.cloudServiceUri+"GetUserWorkspaceInfo?"+d+e,{},[this],"json",!1,null,!1,function(d){if(0!=mcx.isDefAndNotNull(d)&&0!=d.length){var e="";switch(a){case McxWorkspaceInfoGroupType.allWorkspaces:e="mcxWorkspaceGroupAllWorkspaces";break;case McxWorkspaceInfoGroupType.myWorkspaces:e=
"mcxWorkspaceGroupMyWorkspaces";break;case McxWorkspaceInfoGroupType.sharedWithMe:e="mcxWorkspaceGroupSharedWithMe";break;case McxWorkspaceInfoGroupType.sharedWorkspaces:e="mcxWorkspaceGroupSharedWorkspaces"}for(var h=0;h<d.length;h++){var k=new McxWorkspaceInfo;k.setId(parseFloat(d[h].ID));k.setName(d[h].Name);k.setDescription(d[h].Description);k.setGroupName(e);k.setIsDefault(d[h].IsDefault);k.setCreationDate(d[h].CreationDate);k.setLastModifiedDate(d[h].LastModified);k.setImage(b.cloudServiceUri+
"GetUserWorkspaceImage?token="+b.user.getToken()+b.password+"&workspaceId="+k.getId());k.setOwner(b.parseJsonDataToUser(d[h].Owner));c.push(k)}}},function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxApplication-WorkspaceInfoMessage"),McxMessageBoxType.Error)});return this.workspaceInfoList=c};
McxCloudSecurityManager.prototype.getDefaultWorkspace=function(){var a=this.getCurrentUser();return a&&a.getDefaultWorkspaceId()?this.getWorkspaceById(parseFloat(a.getDefaultWorkspaceId())):null};
McxCloudSecurityManager.prototype.saveWorkspace=function(a,b,c){var d=this;this._isInWsSaveProgress=!0;var e=McxXMLReader.createXmlDocument(a),f=b.getId(),g=f?!0:!1;if(g&&!this.hasWritePermissionOnWorkspace(b))McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("McxApplication-mcxAccessDenied"),McxMessageBoxType.Error);else{0==mcx.isDefAndNotNull(b.getOwner())&&b.setOwner(this.getCurrentUser());var h=null;null!=b.getImage()&&(h=b.getImage().replace("data:image/jpeg;base64,",""));a={Token:this.user.getToken(),
Workspace:a?e.toString():null,Name:b.getName(),Image:h};g&&(a.Id=f);McxAjaxServiceCall.postAjaxCall(this.cloudServiceUri+(g?"UpdateUserWorkSpace":"InsertUserWorkspace"),!0,JSON.stringify(a),"application/json",null,"json",!1,null,!1,function(a){d._isInWsSaveProgress=!1;g||b.setId(parseFloat(a));mcx.isDefAndNotNull(c)&&c.getSuccess().call(c.getScope());b.getPropertyChangeHandler().dispatchOnSuccess(this,null);McxApplication.showNotification(McxLocalizationManager.getLocaleValue("McxApplication-mcxWorkspaceSaved"))},
function(){d._isInWsSaveProgress=!1;McxApplication.showNotification(McxLocalizationManager.getLocaleValue("McxApplication-mcxWorkspaceSaveFailed"));mcx.isDefAndNotNull(c)&&c.getError().call(c.getScope())})}};McxCloudSecurityManager.prototype.hasWritePermissionOnWorkspace=function(a){return mcx.isDefAndNotNull(this.getCurrentUser())&&mcx.isDefAndNotNull(a.getOwner())&&this.getCurrentUser().getId()==a.getOwner().getId()};
McxCloudSecurityManager.prototype.getUserUri=function(){var a=null,b="token="+encodeURIComponent(this.user.getToken())+"&";McxAjaxServiceCall.getAjaxCall(this.cloudServiceUri+"GetUserUri?"+b,{},[this],"json",!1,null,!1,function(b){a=b},function(){});return a};
McxCloudSecurityManager.prototype.getWorkspaceSharedUsers=function(a){var b=[],c=this,d="token="+encodeURIComponent(this.user.getToken())+"&";a="workspaceId="+a.getId();McxAjaxServiceCall.getAjaxCall(this.cloudServiceUri+"GetWorkspaceSharedUsers?"+d+a,{},[this],"json",!1,null,!1,function(a){if(0==mcx.isDefAndNotNull(a))return[];for(var d=0;d<a.length;d++)b.push(c.parseJsonDataToUser(a[d]))},function(){McxMessageBox.show(null,"Shared users data could not be received.")});return b};
McxCloudSecurityManager.prototype.deleteWorkspace=function(a,b){if(this.hasWritePermissionOnWorkspace(a)){var c={Token:this.user.getToken(),Workspace:"<workspace></workspace>",Id:a.getId()};McxAjaxServiceCall.postAjaxCall(this.cloudServiceUri+"DeleteUserWorkspace",!0,JSON.stringify(c),"application/json",null,"json",!1,null,!0,function(){var a=McxLocalizationManager.getLocaleValue("McxApplication-mcxWorkSpaceDeleted");McxApplication.showNotification(a);b.getSuccess().call(b.getScope())},function(){b.getError().call(b.getScope());
var a=McxLocalizationManager.getLocaleValue("McxApplication-mcxWorkSpaceDeleteFail");McxApplication.showNotification(a)})}else McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxApplication-mcxAccessDenied"),McxMessageBoxType.Error)};
McxCloudSecurityManager.prototype.setDefaultWorkspace=function(a,b){var c={Token:this.user.getToken(),Id:a.isDefault()?a.getId():-1};McxAjaxServiceCall.postAjaxCall(this.cloudServiceUri+"SetDefaultUserWorkspace",!0,JSON.stringify(c),"application/json",null,"json",!1,null,!0,function(){var c=McxLocalizationManager.getLocaleValue("McxApplication-mcxWorkSpaceSetAsDefault"),e=McxLocalizationManager.getLocaleValue("McxApplication-mcxWorkSpaceRemoveDefault");a.isDefault()?McxApplication.showNotification(c):
McxApplication.showNotification(e);mcx.isDefAndNotNull(b)&&mcx.isDefAndNotNull(b.getScope())&&b.getSuccess().call(b.getScope());a.getPropertyChangeHandler().dispatchOnSuccess(this,null)},function(){var a=McxLocalizationManager.getLocaleValue("McxApplication-mcxWorkSpaceColuntBeSetDefault");McxApplication.showNotification(a);mcx.isDefAndNotNull(b)&&mcx.isDefAndNotNull(b.getScope())&&b.getError().call(b.getScope())})};
McxCloudSecurityManager.prototype.getNodeUri=function(){if(null!=this.user)return this.getUserUri();var a="",b=this.getNodes();if(null==this.getCurrentUser())for(var c=0;c<b.length;c++){if(0!=b[c].uri||""!=b[c].uri){a=b[c].uri;break}}else for(c=0;c<b.length;c++)this.getCurrentUser().getNodeId()==b[c].id&&(a=b[c].uri);return 0==a||""==a?"":a};
McxCloudSecurityManager.prototype.getWorkspaceById=function(a){var b=null,c="token="+encodeURIComponent(this.user.getToken())+"&";McxAjaxServiceCall.getAjaxCall(this.cloudServiceUri+"GetUserWorkspace?"+c+("workspaceId="+a),{},[this],"text",!1,null,!1,function(a){0!=a.length&&(b=new McxWorkspaceDefinition(a))},function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxApplication-WorkspaceInfoMessage"),McxMessageBoxType.Error)});return b};
McxCloudSecurityManager.prototype.getCloudUri=function(){return this.cloudServiceUri};McxCloudSecurityManager.prototype.setCloudUri=function(a){this.cloudServiceUri=a};
McxCloudSecurityManager.prototype.getValueFromDictionary=function(a,b){if(null==this.user)return null;var c=[];b||(b=new McxAjaxParameter,b.setAsync(!1));var d="token="+encodeURIComponent(this.user.getToken())+"&";McxAjaxServiceCall.getAjaxCall(this.cloudServiceUri+"GetValueFromDictionary?"+d+("key="+a),{},[this],"json",!0,null,b.getAsync(),function(a){c=a;b.getAsync()&&b.getSuccess().call(b.getScope(),c)},function(a){c=[];b.getAsync()&&b.getError().call(b.getScope(),c)});return c};
McxCloudSecurityManager.prototype.getUserImage=function(){var a="token="+encodeURIComponent(this.user.getToken()),b="";McxAjaxServiceCall.getAjaxCall(this.cloudServiceUri+"GetUserImage?"+a,null,null,"json",!0,null,!1,function(a){b=a},function(){});return b};
McxCloudSecurityManager.prototype.getNodeId=function(a){a=this.cloudServiceUri+"GetNodeId?"+("name="+a)+"&token"+encodeURIComponent(this.user.getToken());var b="";McxAjaxServiceCall.getAjaxCall(a,null,null,"json",!0,null,!1,function(a){b=a},function(){});return b};McxCloudSecurityManager.prototype.getCurrentUser=function(){return this.user};
McxCloudSecurityManager.prototype.getNodeImage=function(){return this.nodeId&&""!=this.nodeId?this.cloudServiceUri+"GetNodeImage?nodeId="+this.nodeId+"&token="+encodeURIComponent(this.user.getToken()):""};McxCloudSecurityManager.prototype.getAddonList=function(){return this.addonList};McxCloudSecurityManager.prototype.getAddonInfo=function(){return this.addonInfo};McxCloudSecurityManager.prototype.getCredentials=function(){return this._credentials};js.app.McxApplication.McxCloudSettingsManager={};function McxCloudSettingsManager(){this.cloudServiceUrl=""}
McxCloudSettingsManager.prototype.read=function(a,b){var c=new McxSettingsResult;if(null==b){b=new McxAjaxParameter;var d=function(){};b.setParameters(this,d,d);b.setAsync(!1)}d=McxApplication.getSecurityManager().getCurrentUser();if(null==d)return c;d="token="+encodeURI(d.getToken());d=McxAjaxServiceCall.getAjaxCall(this.cloudServiceUrl+"GetUserSetting?"+d+"&"+("key="+a),{},[this],"json",!1,null,b.getAsync(),function(a){null==a&&b.getError().call(b.getScope(),c);null!=a&&0!=a.length&&c.setSettings(a);
b.getAsync()&&b.getSuccess().call(b.getScope(),c)},function(){var a=b.getError();a&&a.call(b.getScope(),c)});c.setRequest(d);return c};
McxCloudSettingsManager.prototype.write=function(a,b,c){function d(){c.getAsync()&&c.getSuccess().call(c.getScope())}function e(){c.getError().call(c.getScope())}if(null==c){c=new McxAjaxParameter;var f=function(){};c.setParameters(this,f,f);c.setAsync(!1)}f=McxApplication.getSecurityManager().getCurrentUser();null!=f&&(f="token="+encodeURI(f.getToken()),a="key="+a,b="value="+(Array.isArray(b)?b.join("$"):b),McxAjaxServiceCall.getAjaxCall(this.cloudServiceUrl+"SetUserSetting?"+f+"&"+a+"&"+b,{},[this],
"json",!1,null,c.getAsync(),d,e))};
McxCloudSettingsManager.prototype.delete=function(a,b){function c(){b.getAsync()&&b.getSuccess().call(b.getScope())}function d(){b.getError().call(b.getScope())}if(null==b){b=new McxAjaxParameter;var e=function(){};b.setParameters(this,e,e);b.setAsync(!1)}e=McxApplication.getSecurityManager().getCurrentUser();null!=e&&(e="token="+encodeURI(e.getToken()),McxAjaxServiceCall.getAjaxCall(this.cloudServiceUrl+"DeleteUserSetting?"+e+"&"+("key="+a),{},[this],"json",!1,null,!1,c,d))};
McxCloudSettingsManager.prototype.isAvailable=function(){return null==McxApplication.getSecurityManager().getCurrentUser()||null==this.cloudServiceUrl||""==this.cloudServiceUrl?!1:!0};McxCloudSettingsManager.prototype.setUri=function(a){this.cloudServiceUrl=a+"/rest/json/"};js.app.McxApplication.McxDialogManager={};
function McxDialogManager(){this._bottomDockBar=this._rightDockBar=this._featureExplorerDialog=null;this._dockResizeEventHandler=new McxEventHandler;this.initialize();this._rightDockBar.onUnDockRequest().addListener(this.onUnDockRequest,null,this);this._bottomDockBar.onUnDockRequest().addListener(this.onUnDockRequest,null,this);this._rightDockBar.onCloseDockPaneRequest().addListener(this.onCloseDockPaneRequest,null,this);this._bottomDockBar.onCloseDockPaneRequest().addListener(this.onCloseDockPaneRequest,null,
this)}McxDialogManager.prototype.onStopDrag=function(){var a=this[0],b=this[1];if(0!=(a._isRightDockable||a._isBottomDockable)){var c=a.getDialogPosition(),d=a.getDialogElement();a._isBottomDockable&&c.getY()+d.height()>$(window).height()-40?b.dockDialog(a,McxDockPosition.bottom):a._isRightDockable&&c.getX()+d.width()>$(window).width()-40&&b.dockDialog(a,McxDockPosition.right);$(".dockBar").removeClass("on-drag")}};
McxDialogManager.prototype.onStartDrag=function(){0!=(this._isRightDockable||this._isBottomDockable)&&(1==this._isRightDockable&&$(".dockBar.right").addClass("on-drag"),1==this._isBottomDockable&&$(".dockBar.bottom").addClass("on-drag"))};McxDialogManager.prototype.onDialogClose=function(){var a=this[0],b=this[1];a._lastDockPosition&&(a=a._dockPane)&&b.closeDockPane(a)};
McxDialogManager.prototype.onCloseDockPaneRequest=function(a){a.getDockBar();a=a.getDockPane();a.getDialog().getDialogElement().appendTo("body");a.getDialog().getContainerElement().append(a.getDialog().getContent());a.getDialog().close()};
McxDialogManager.prototype.onUnDockRequest=function(a){a.getDockBar();var b=a.getDockPane(),c=a.getUnDockRequestTriggerType();a.getMouseEventData();var d=b.getDialog();this.closeDockPane(b);d._lastDockPosition=null;if(c==McxUnDockRequestTriggerType.byContentHeaderDrag){c=a.getDragX();a=a.getDragY();d.setDialogPosition(c-d.getDialogElement().width()/2,a-10);var e=function(a){var b=d.getDialogElement(),c=a.pageX-b.width()/2;a=a.pageY-10;c=0>c?0:c;a=0>a?0:a;a=a+b.outerHeight(!0)>$("body").height()?$("body").height()-
b.outerHeight(!0):a;c=c+b.outerWidth(!0)>$("body").width()?$("body").width()-b.outerWidth(!0):c;d.setDialogPosition(0>c?0:c,0>a?0:a)},f=function(a){$("body").unbind("mousemove",e);$("body").unbind("mouseup",f)};$("body").mousemove(e).mouseup(f)}b.getDialog().updateLayout()};McxDialogManager.prototype.bindDialogEvents=function(a){a.onMoveEnd().addListener(this.onStopDrag,null,[a,this]);a.onMoveStart().addListener(this.onStartDrag,null,a);a.onCloseDialog().addListener(this.onDialogClose,null,[a,this])};
McxDialogManager.prototype.addFloatingDialog=function(a,b,c,d,e,f,g,h){if(a.getIsSingleInstance()&&McxDialogBase.isExistDialogOfType(a.constructor)&&mcx.isInstanceOf(McxDialogBase.getExistDialogOfType(a.constructor),McxDialogBase))return McxDialogBase.getExistDialogOfType(a.constructor).show();(d=a._lastDockPosition)?this.addDockableDialog(a,d,f,g,h):(a.showDialog(b,c),a._isRightDockable=g||!1,a._isBottomDockable=h||!1,this.bindDialogEvents(a))};
McxDialogManager.prototype.addDockableDialog=function(a,b,c,d,e,f){a.getIsSingleInstance()&&McxDialogBase.isExistDialogOfType(a.constructor)||(a._isRightDockable=b==McxDockPosition.right||d||!1,a._isBottomDockable=b==McxDockPosition.bottom||e||!1,a.getDialogElement().css("visibility","hidden"),a.showDialog(!1,f),this.dockDialog(a,b),a.getDialogElement().css("visibility","visible"),this.bindDialogEvents(a))};
McxDialogManager.prototype.dockDialog=function(a,b){if(!McxMobile.isMobile.any()&&0!=(a._isRightDockable||a._isBottomDockable)){var c=a.getDialogElement();a.centralizeDialog();c.detach();switch(b){case McxDockPosition.right:this._rightDockBar.addDialog(a);a._lastDockPosition=McxDockPosition.right;McxLocalizationManager.localizeContent(this._rightDockBar.getContent());break;case McxDockPosition.bottom:this._bottomDockBar.addDialog(a),a._lastDockPosition=McxDockPosition.bottom,McxLocalizationManager.localizeContent(this._bottomDockBar.getContent())}}};
McxDialogManager.prototype.centerDialog=function(a){a.setDialogPosition("auto","auto")};McxDialogManager.prototype.getRightDockBar=function(){return this._rightDockBar};McxDialogManager.prototype.getBottomDockBar=function(){return this._bottomDockBar};
McxDialogManager.prototype.initialize=function(){this._rightDockBar=new McxDockBar($("#rightDockBar"));this._bottomDockBar=new McxDockBar($("#bottomDockBar"));this._rightDockBar.setScreenPosition(McxDockBarScreenPosition.right);this._bottomDockBar.setScreenPosition(McxDockBarScreenPosition.bottom);this._rightDockBar.setDockContentWidth(480);this._rightDockBar.onResize().addListener(function(){this.getDockResizeHandler().dispatchOnSuccess(this,null)},null,this);this._bottomDockBar.onResize().addListener(function(){this.getDockResizeHandler().dispatchOnSuccess(this,
null)},null,this)};McxDialogManager.prototype.getDockResizeHandler=function(){return this._dockResizeEventHandler};McxDialogManager.prototype.getFeatureExplorerDialog=function(){this._featureExplorerDialog?this._featureExplorerDialog.setMap(McxApplication.getActiveMap()):(this._featureExplorerDialog=new McxFeatureExplorerDialog(McxApplication.getActiveMap()),this._featureExplorerDialog.setMapInteractionFactory(new McxMapInteractionFactory));return this._featureExplorerDialog};
McxDialogManager.prototype.appendDialogContentBackToDialog=function(a){a.getDialogElement().addClass("anim-suspend").appendTo("body");a.getDialogElement().append(a.getContainerElement()).append(a.getFooterElement())};McxDialogManager.prototype.closeDockPane=function(a){var b=a.getDialog(),c=a.getDockBar();this.appendDialogContentBackToDialog(b);c.removeDockPane(a)};McxDialogManager.prototype.initDialogManager=function(){};js.app.McxApplication.McxDriverManager={};function McxDriverManager(){this.registedDataSources=[];this.drivers=[];this.drivers.push(new McxFsDriver);this.drivers.push(new McxTileDriver);this.drivers.push(new McxOgcDriver);this.drivers.push(new McxArcGisDriver);this.drivers.push(new McxArcGisTileCacheDriver);this.drivers.push(new McxMemDriver)}McxDriverManager.prototype.addDriver=function(a){};
McxDriverManager.prototype.getDriverByGuid=function(a){for(var b=0;b<this.drivers.length;b++)if(this.drivers[b].getDriverID()==a)return this.drivers[b];return null};McxDriverManager.prototype.getCount=function(){};McxDriverManager.prototype.getDriverByIndex=function(a){};McxDriverManager.prototype.openDataSource=function(a){for(var b=0;b<this.drivers.length;b++){var c=this.drivers[b].openDataSource(a);if(null!=c)return c}return null};
McxDriverManager.prototype.registerDataSource=function(a){if(null!=this.registedDataSources[a])return this.registedDataSources[a];for(var b=0;b<this.drivers.length;b++){var c=this.drivers[b].openDataSource(a);if(null!=c)return this.registedDataSources[a]=c}return null};js.app.McxApplication.McxLocalizationPaths={};function McxLocalizationPaths(){}McxLocalizationPaths.getApplicationLocalePath=function(){return"$McxApplication/assets/locale/mcxApplication"};McxLocalizationPaths.getCommonControlLocalePath=function(){return"$McxCommonControl/assets/locale/mcxCommonControl"};McxLocalizationPaths.getMappingLocalePath=function(){return"$McxMapping/assets/locale/mcxMapping"};McxLocalizationPaths.getMcxDialogLocalePath=function(){return"$McxCommon/Dialog/locale/mcxDialog"};
McxLocalizationPaths.getMcxToolBarLocalePath=function(){return"$McxCommonControl/ToolBar/assets/locale/mcxToolBar"};McxLocalizationPaths.getMcxDockBarLocalePath=function(){return"$McxApplication/Docking/assets/locale/mcxDockBar"};McxLocalizationPaths.getDimensionLocalePath=function(){return"$McxDimension/assets/locale/mcxDimension"};McxLocalizationPaths.getBaseLocalePath=function(){return"$McxBase/assets/locale/mcxBase"};McxLocalizationPaths.getEditingLocalePath=function(){return"$McxEditing/assets/locale/mcxEditing"};
McxLocalizationPaths.getMemDriverLocalePath=function(){return"$McxMemDriver/assets/locale/mcxMemDriver"};McxLocalizationPaths.getServerDriverLocalePath=function(){return"$McxFsDriver/assets/locale/mcxFsDriver"};McxLocalizationPaths.getDrawingLocalePath=function(){return"$McxDrawing/assets/locale/mcxDrawing"};McxLocalizationPaths.getAppDomainLocalePath=function(){return"$McxAppDomain/assets/locale/appDomain"};js.app.McxApplication.McxLocalSecurityManager={};function McxLocalSecurityManager(){this.addonList=[];this.userRolesChangedEventHandler=new McxEventHandler}McxLocalSecurityManager.prototype.authorizeUser=function(a,b,c){};McxLocalSecurityManager.prototype.isInRole=function(a){};McxLocalSecurityManager.prototype.getValueFromDictionary=function(a,b){return[]};McxLocalSecurityManager.prototype.getCurrentUser=function(){};McxLocalSecurityManager.prototype.saveWorkspace=function(a,b){};
McxLocalSecurityManager.prototype.deleteWorkspace=function(a,b){};McxLocalSecurityManager.prototype.setDefaultWorkspace=function(a,b){};McxLocalSecurityManager.prototype.setCloudServiceUrl=function(a){for(var b=0;b<a.length;b++){var c=new window[a[b]];this.addonList.push(c)}this.userRolesChangedEventHandler.dispatchOnSuccess(this,null)};McxLocalSecurityManager.prototype.getUserRolesChangedEventHandler=function(){return this.userRolesChangedEventHandler};
McxLocalSecurityManager.prototype.getAddonList=function(){return this.addonList};McxLocalSecurityManager.prototype.getAddonInfo=function(){return[]};McxLocalSecurityManager.prototype.changePassword=function(a,b,c){return new McxResult};McxLocalSecurityManager.prototype.recoverPassword=function(a,b,c){return new McxResult};js.app.McxApplication.McxMain={};function McxMain(){this._configXml=this.documentFactory=this.uiManager=this.securityManager=this.driverManager=this.helpers=null;this._workspaceId=this._userName=this._password=this._nodeId="";this.workspaceOpenedEventHandler=new McxEventHandler}McxMain.prototype.getWorkspaceOpenedEventHandler=function(){return this.workspaceOpenedEventHandler};
McxMain.prototype.initialize=function(a,b,c,d){this._nodeId=a||"";this._userName=b||"";this._password=c||"";this._workspaceId=d||"";this.documentFactory=this.documentFactory||new McxDocumentFactory;McxLocalizationManager.addLocalePath(McxPathFinder.getFullPath(McxLocalizationPaths.getBaseLocalePath()));McxLocalizationManager.addLocalePath(McxPathFinder.getFullPath(McxLocalizationPaths.getEditingLocalePath()));McxLocalizationManager.addLocalePath(McxPathFinder.getFullPath(McxLocalizationPaths.getMappingLocalePath()));
McxLocalizationManager.addLocalePath(McxPathFinder.getFullPath(McxLocalizationPaths.getDimensionLocalePath()));McxLocalizationManager.addLocalePath(McxPathFinder.getFullPath(McxLocalizationPaths.getCommonControlLocalePath()));McxLocalizationManager.addLocalePath(McxPathFinder.getFullPath(McxLocalizationPaths.getMcxDialogLocalePath()));McxLocalizationManager.addLocalePath(McxPathFinder.getFullPath(McxLocalizationPaths.getMcxDockBarLocalePath()));McxLocalizationManager.addLocalePath(McxPathFinder.getFullPath(McxLocalizationPaths.getApplicationLocalePath()));
McxLocalizationManager.addLocalePath(McxPathFinder.getFullPath(McxLocalizationPaths.getMemDriverLocalePath()));McxLocalizationManager.addLocalePath(McxPathFinder.getFullPath(McxLocalizationPaths.getServerDriverLocalePath()));McxLocalizationManager.addLocalePath(McxPathFinder.getFullPath(McxLocalizationPaths.getDrawingLocalePath()));McxLocalizationManager.addLocalePath(McxPathFinder.getFullPath(McxLocalizationPaths.getAppDomainLocalePath()));McxLocalizationManager.applyLocalization();var e=this;$.ajax({url:$("mcxconfigurationpath").attr("src")||
"src/appdata/McxConfiguration.xml",dataType:"xml",cache:!0,async:!1,success:function(a){a=new McxXmlNode(a);e._configXml=a;var b=a.findSingleNode("appTitle");b.isEmpty()||$(document).attr("title",b.findSingleNode("name").getValue());var c=a.findSingleNode("driverManager"),b=c.findSingleNode("name").getValue();e.driverManager=new window[b];var c=a.findSingleNode("settingsManager"),b=c.findSingleNode("name").getValue(),d=new window[b],b="",c=c.findSingleNode("param");if(null!=c||c)b=c.getValue();d.setUri(b);
McxSettingsManager.settingsManager=d;c=a.findSingleNode("securityManager");b=c.findSingleNode("name").getValue();e.securityManager=new window[b];for(var c=c.findNodes("param"),d=[],m=0;m<c.length;m++)b=c[m].getValue(),d.push(b);e.securityManager.setCloudServiceUrl(d);e.uiManager=new McxUIManager(e.securityManager);var b=e._nodeId,c=e._userName,d=e._password,m=e._workspaceId,n=a.findSingleNode("authentication"),p=window.location.href.split("?");n.isEmpty()?1<p.length&&(b=b||p[1],c=c||p[2],d=d||p[3],
m=m||p[4]):(n.hasChildNode("node")&&(b=b||n.findSingleNode("node").getValue()),n.hasChildNode("userName")&&(c=c||n.findSingleNode("userName").getValue()),n.hasChildNode("password")&&(d=d||n.findSingleNode("password").getValue()),n.hasChildNode("workspace")&&(m=m||n.findSingleNode("workspace").getValue()));e.uiManager.initialize(b,c,d,m);a=a.findSingleNode("services").findSingleNode("geospatialService");a.isEmpty()||(McxGeospatialServiceManager.serviceUri=a.findSingleNode("uri").getValue()+"/rest/json/")}});
$("body").append($("<span/>").addClass("mcx-version").text(mcx.version))};McxMain.prototype.getBeforeAddonInitializeHandler=function(){return this.uiManager.getBeforeAddonInitializeHandler()};McxMain.prototype.getConfigurations=function(){return this._configXml};McxMain.prototype.getHelperFinder=function(){return this.helpers};McxMain.prototype.getToolBar=function(){return this.uiManager?this.uiManager.getToolBar():null};McxMain.prototype.getMenuBar=function(){return this.uiManager.getMenuBar()};
McxMain.prototype.addFloatingDialog=function(a,b,c,d,e,f,g,h){this.uiManager.getDialogManager().addFloatingDialog(a,b,c,d,e,f,g,h)};McxMain.prototype.addDockableDialog=function(a,b,c,d,e,f){this.uiManager.getDialogManager().addDockableDialog(a,b,c,d,e,f)};McxMain.prototype.showNotification=function(a,b){return this.uiManager.showNotification(a,b)};McxMain.prototype.getDriverManager=function(){return this.driverManager};
McxMain.prototype.getLocaleValue=function(a){a=McxLocalizationManager.getLocaleValue(a);null==a&&(a="");return a};McxMain.prototype.getSecurityManager=function(){return this.securityManager};McxMain.prototype.addDocument=function(a){for(var b=McxApplication.getSecurityManager().getAddonInfo(),c=[],d=0;d<b.length;d++)c=c.concat(b[d].getKeys());this.uiManager.applyRoles(c,a.getContent());this.uiManager.getDocumentContainer().addDocument(a)};
McxMain.prototype.onNewlyAddedMapRenderChange=function(a){a=this.scope;this.map.getRenderer().getRendererEndEventHandler().removeListener(a.onNewlyAddedMapRenderChange);a.uiManager.hideMenu()};McxMain.prototype.removeDocument=function(a){this.uiManager.getDocumentContainer()&&this.uiManager.getDocumentContainer().removeDocument(a)};McxMain.prototype.createDocument=function(a){return this.documentFactory.createDocument(a)};
McxMain.prototype.getActiveDocumentChangedEventHandler=function(){return this.uiManager.getDocumentContainer()?this.uiManager.getDocumentContainer().getActiveDocumentChangeHandler():null};McxMain.prototype.getActiveMap=function(){return null==this.uiManager.getDocumentContainer()||null==this.uiManager.getDocumentContainer().getActiveDocument()?null:this.uiManager.getDocumentContainer().getActiveDocument().getMap()};
McxMain.prototype.getActiveDocument=function(){return this.uiManager.getDocumentContainer()?this.uiManager.getDocumentContainer().getActiveDocument():null};McxMain.prototype.getDocumentAddEventHandler=function(){return this.uiManager.getDocumentContainer()?this.uiManager.getDocumentContainer().getDocumentAddEventHandler():null};McxMain.prototype.getDocuments=function(){return this.uiManager.getDocumentContainer()?this.uiManager.getDocumentContainer().getDocuments():null};
McxMain.prototype.getFeatureExplorerDialog=function(){return this.uiManager.getDialogManager().getFeatureExplorerDialog()};McxMain.prototype.showFeatureExplorerDialog=function(){this.addFloatingDialog(this.uiManager.getDialogManager().getFeatureExplorerDialog(),!1,!0,!1,!1,!0,!0,!0)};McxMain.prototype.getWorkspaces=function(a){return this.securityManager.getWorkspaceInfos(a)};McxMain.prototype.setDocumentFactory=function(a){this.documentFactory=a};McxMain.prototype.getLoadingIndicator=function(a){return McxLoadingIndicator.getInstance(a)};
McxMain.prototype.showMenu=function(){this.uiManager&&this.uiManager.showMenu()};McxMain.prototype.hideMenu=function(){this.uiManager&&this.uiManager.hideMenu()};McxMain.prototype.getMenubar=function(){return this.uiManager.getMenuBar()};js.app.McxApplication.McxNode={};function McxNode(a,b,c,d){this.id=a;this.name=b;this.hostId=c;this.uri=d}McxNode.prototype.getId=function(){return this.id};McxNode.prototype.getName=function(){return this.name};McxNode.prototype.getHostId=function(){return this.hostId};McxNode.prototype.getUri=function(){return this.uri};js.app.McxApplication.McxOpenWorkspaceAction={};function McxOpenWorkspaceAction(a,b){this._workspaceId=parseFloat(a);this._document=b||null}
McxOpenWorkspaceAction.prototype.execute=function(a){var b=McxApplication.getSecurityManager().getWorkspaceById(this._workspaceId);a=new McxWorkspaceInfo(this._workspaceId);for(var c=McxApplication.getWorkspaces(),d=0;d<c.length;d++)c[d].getId()==this._workspaceId&&(a=c[d]);if(0==mcx.isDefAndNotNull(b))a=McxLocalizationManager.getLocaleValue("mcxHomeTabWorkspaceNotFound"),McxMessageBox.show(null,a,McxMessageBoxType.Error);else for(var b=b.getDocuments(),c=new McxWorkspaceReader(McxApplication.getDriverManager()),
e=0,f=0,d=0;d<b.length;d++){var g=b[d],e=g.findNodes("Layer").length,h=this._document||McxApplication.createDocument(g.getSingleNode("Title").getValue().split(":")[1]);h.setWorkspaceInfo(a);0==h.getContent().parents("body").length&&McxApplication.addDocument(h);McxApplication.hideMenu();var k=h.getMap(),m=function(a){var b=a.getLayer();f++;f==e&&McxApplication.getWorkspaceOpenedEventHandler().dispatchOnSuccess(this,null);setTimeout(mcx.proxy(function(){k.getRenderer().paintLayer(b,null)},this),1)};
k.getLayers().onLayerAdded().addListener(m,null,this);h=new McxAjaxParameter;h.setParameters(this,function(){k.getLayers().onLayerAdded().removeListener(m)},function(){McxMessageBox.show(null,"Workspace y\u00fcklenemedi!",McxMessageBoxType.Error)});c.readXmlToMap(k,g,h)}};McxOpenWorkspaceAction.prototype.isInstanceOf=function(a){return"McxOpenWorkspaceAction"==a};js.app.McxApplication.McxUIManager={};function McxUIManager(a){this._authenticationManager=this._homeTabPage=this._toolBar=this._authenticationPanel=this._layerManager=this._dialogManager=this._documentContainer=this._defaultWorkspace=this._menuBar=null;this.addonList=[];this._beforeAddonInitializeEventHandler=new McxEventHandler;this.securityManager=a}
McxUIManager.prototype.initialize=function(a,b,c,d){this.securityManager.getUserRolesChangedEventHandler().addListener(this.userRolesChangedHandlerSuccess,this.userRolesChangedHandlerFailed,this);this.enableWindowResize();this.initializeDialogManager();this.initializeDocumentContainer();this.initializeAuthenticationManager(a,b,c,d);a=McxApplication.getSecurityManager().getCurrentUser();0==mcx.isDefAndNotNull(a)&&(this.initializeMenuBar(),this.showMenu(),this.hideLoadingPanel());this.initializeToolbar();
this.initializeLayerManager();this.initializeUIManager();this.relocateContents()};McxUIManager.prototype.hideLoadingPanel=function(){$("#loadingPanel").fadeOut(1E3)};McxUIManager.prototype.showLoadingPanel=function(){$("#loadingPanel").show(0)};McxUIManager.prototype.clearLayerManager=function(){this._layerManager.clear()};
McxUIManager.prototype.loadDefaultWorkspace=function(){var a=this;this._defaultWorkspace=McxApplication.getSecurityManager().getDefaultWorkspace();if(mcx.isDefAndNotNull(this._defaultWorkspace)){for(var b=this._defaultWorkspace.getDocuments(),c=0,d=0,e=0;e<b.length;e++){var f=b[e].findNodes("Layer");0==c&&(c+=f.length)}for(e=0;e<b.length;e++){var g=McxApplication.createDocument(b[e].getSingleNode("Title").getValue().split(":")[1]),f=new McxWorkspaceInfo(McxApplication.getSecurityManager().getCurrentUser().getDefaultWorkspaceId());
f.setOwner(McxApplication.getSecurityManager().getCurrentUser());g.setWorkspaceInfo(f);McxApplication.addDocument(g);var h=function(a){d++;c==d&&McxApplication.getWorkspaceOpenedEventHandler().dispatchOnSuccess(this,null);g.getMap().getRenderer().paintLayer(a.getLayer(),null)};g.getMap().getLayers().onLayerAdded().addListener(h,null,this);var f=new McxWorkspaceReader(McxApplication.getDriverManager()),k=function(){g.getMap().getLayers().onLayerAdded().removeListener(h);g.getMapOpenCompleteHandler().dispatchOnSuccess(a,
null)},m=new McxAjaxParameter;m.setParameters(this,k,k);f.readXmlToMap(g.getMap(),b[e],m)}}else this.showMenu()};McxUIManager.prototype.setUserToAuthenticationPanel=function(){var a=McxApplication.getSecurityManager().getCurrentUser();!mcx.isDefAndNotNull(this._authenticationPanel)||!mcx.isDefAndNotNull(a)||"guest"==a.getUserName()||mcx.isDefAndNotNull(this._authenticationPanel.getUser())&&this._authenticationPanel.getUser().getId()==a.getId()||this._authenticationPanel.setUser(McxApplication.getSecurityManager().getCurrentUser())};
McxUIManager.prototype.switchSettingManager=function(){$.ajax({url:$("mcxconfigurationpath").attr("src")||"src/appdata/McxConfiguration.xml",dataType:"xml",cache:!0,async:!1,success:function(a){a=$(a).find("settingsManager");var b=a.find("name").text(),b=new window[b],c="";a=a.find("param");if(null!=a||a)c=a.text();b.setUri(c);McxSettingsManager.settingsManager=b}})};
McxUIManager.prototype.userRolesChangedHandlerSuccess=function(){this.switchSettingManager();mcx.isDefAndNotNull(this._documentContainer)&&this._documentContainer.clearDocuments();this.setUserToAuthenticationPanel();mcx.isDefAndNotNull(this._dialogManager)&&this._dialogManager.getFeatureExplorerDialog().getFeatureExplorer().clearPages();this.initializeMenuBar();var a=this._authenticationManager.getLoginSpecifiedWorkspaceId();this.hideLoadingPanel();a?(new McxOpenWorkspaceAction(a)).execute(null):
this.loadDefaultWorkspace();this.relocateContents()};McxUIManager.prototype.userRolesChangedHandlerFailed=function(a){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxApplication-LoginUnexpectedError"),McxMessageBoxType.Error)};McxUIManager.prototype.getDocumentContainer=function(){return this._documentContainer};McxUIManager.prototype.getDialogManager=function(){return this._dialogManager};McxUIManager.prototype.getToolBar=function(){return this._toolBar};
McxUIManager.prototype.showNotification=function(a,b){var c=$("#notificationContainer");0==c.length&&(c=$("<div/>").attr("id","notificationContainer").css("position","absolute").css("z-index","9999999").css("top","5px").css("max-width","30%").css("right","10px").css("text-align","center"),$("body").append(c));var d=new McxNotificationBox(a);b||d.setAutoCloseTimeOut(3E3);var e=d.getContent();c.prepend(e);d.show();return d};
McxUIManager.prototype.initializeDocumentContainer=function(){this._documentContainer=new McxDocumentContainer("documentContainer");this._documentContainer.clearDocuments();this._documentContainer.getDocumentAddEventHandler().addListener(this.onDocumentCountChange,null,this);this._documentContainer.getDocumentCloseHandler().addListener(this.onDocumentCountChange,null,this);this._documentContainer.getActiveDocumentChangeHandler().addListener(this.onActiveDocumentChange,null,this);this._documentContainer.getAddButtonClickHandler().addListener(this.onDocumentContainerAddButtonClick,
null,this);this._documentContainer.getBeforeActiveDocumentChangeHandler().addListener(this.onBeforeActiveDocumentChange,null,this);this._documentContainer.getDocumentCloseHandler().addListener(function(a){this._documentContainer.removeDocument(a.getArgs());0==a.getArgs().getTagValue("#mapOrder#")&&this.clearLayerManager()},null,this)};
McxUIManager.prototype.onDocumentCountChange=function(){this._layerManager&&(0<this._documentContainer.getDocumentCount()?this._layerManager.show():this._layerManager.hide(),this.centralizeLayerManager())};
McxUIManager.prototype.enableWindowResize=function(){function a(){var a=McxApplication.getActiveDocument();if(null!=a&&a.isNeedUpdate()){var c=McxApplication.getActiveMap();c&&(c.getRenderer().abortRender(),c.getRenderer().paintLayer(null,null),a.setIsNeedUpdate(!1))}}$(window).resize($.proxy(this.repositionOverflowDialogs,this));$(window).resize($.proxy(this.relocateContents,this));$(window).resize($.proxy(this.resizeMap,this));$(window).resize($.proxy(function(){if($(document.activeElement).is("input,textarea,select")&&
McxMobile.isMobile.any())return!0;var b=window.resizeTimeoutHandle;b&&clearTimeout(b);window.resizeTimeoutHandle=setTimeout($.proxy(a,this),200)},this))};McxUIManager.prototype.initializeUIManager=function(){this.relocateContents();this._layerManager.slideOff();this.resizeMenuBar()};McxUIManager.prototype.initializeDialogManager=function(){this._dialogManager=new McxDialogManager;this._dialogManager.getDockResizeHandler().addListener(this.relocateContents,null,this)};
McxUIManager.prototype.initializeLayerManager=function(){this._layerManager=new McxLayerManager;var a=$("#layerManagerContainer");a.prepend(this._layerManager.getContent());this._layerManager.localize();this._layerManager.getVisibilityChangeHandler().addListener(function(){this._layerManager.getIsVisible()?a.addClass("state-open"):a.removeClass("state-open")},null,this);var b=null;null!=McxApplication&&(b=McxApplication.getActiveMap());mcx.isDefAndNotNull(b)&&this._layerManager.setMap(b);this._layerManager.hide();
this._layerManager.setMapInteractionFactory(new McxMapInteractionFactory)};McxUIManager.prototype.initializeUserAuthPanel=function(){null==this._authenticationPanel&&(this._authenticationPanel=new McxAuthenticationPanel,$("#upRightArea").append(this._authenticationPanel.getContent()));this.setUserToAuthenticationPanel()};
McxUIManager.prototype.initializeToolbar=function(){this._toolBar=new McxToolBar("documentContainer");this._toolBar.setMapInteractionFactory(new McxAppMapInteractionFactory);this._documentContainer.getDocumentAddEventHandler().addListener(function(a){"McxMapDocument"==McxClassName.getObjectClassName(a.getArgs())&&this._toolBar.setMap(McxApplication.getActiveMap())},function(a){this._toolBar.setMap(McxApplication.getActiveMap())},this);McxLocalizationManager.localizeContent(this._toolBar.getContent());
this._toolBar.initialize();var a=McxApplication.getActiveMap();mcx.isDefAndNotNull(a)&&this._toolBar.setMap(McxApplication.getActiveMap())};
McxUIManager.prototype.createAddonTabs=function(){this.addonList=this.securityManager.getAddonList();for(var a=this.securityManager.getAddonInfo(),b=this,c=[],d=0;d<a.length;d++)c=c.concat(a[d].getKeys());for(d=0;d<this.addonList.length;d++)if(a=this.addonList[d]){var e=new McxAddonMenuBarItem(a);e.getOnContentInitializeFinishHandler().addListener(function(){b.applyRoles(c,this.getContent());McxLocalizationManager.localizeContent(this.getContent())},null,e);this._menuBar.addMenuBarItem(e);this.getBeforeAddonInitializeHandler().dispatchOnSuccess(this,
new McxAddonEventArgs(a));a.initialize(null)}this._menuBar.getResizeEventHandler().addListener(this.relocateContents,null,this)};McxUIManager.prototype.getBeforeAddonInitializeHandler=function(){return this._beforeAddonInitializeEventHandler};McxUIManager.prototype.showMenu=function(){mcx.isDefAndNotNull(this._menuBar)&&this._menuBar.showMenu()};McxUIManager.prototype.hideMenu=function(){mcx.isDefAndNotNull(this._menuBar)&&this._menuBar.hideMenu()};
McxUIManager.prototype.initializeAuthenticationManager=function(a,b,c,d){var e=window.location.href;null==this._authenticationManager&&(this._authenticationManager=new McxAuthenticationManager(this));this._authenticationManager.setBrowserUri(e);this._authenticationManager.startApplication(a,b,c,d)};McxUIManager.prototype.createCustomMenuTabs=function(){var a=new McxGetCustomMenuListAction;a.execute(null);for(var a=a.getCustomMenuList(),b=0;b<a.length;b++)this._menuBar.addMenuBarItem(a[b])};
McxUIManager.prototype.initializeMenuBar=function(){0==mcx.isDefAndNotNull(this._menuBar)&&(this._menuBar=new McxMenuBar,$("#menuPlaceHolder").replaceWith(this._menuBar.getContent()));if(McxApplication.getSecurityManager().getCurrentUser()){var a=McxApplication.getSecurityManager().getNodeImage(),b=$("<img/>");$("#nodeImage").attr("src",a);b.load(function(){$("#nodeImage").attr("src",a).show()});b.error($.proxy(function(){$("#nodeImage").hide()},this));b.attr("src",a+"&"+Date.now().toString())}this._menuBar.clear();
this._homeTabPage=new McxHomeTabPage;this._menuBar.addMenuBarItem(this._homeTabPage);this.createAddonTabs();this.createCustomMenuTabs();this.initializeUserAuthPanel();this.initializeLanguageCombo();this.initializeHelpButton();this.initializeInspector()};
McxUIManager.prototype.initializeLanguageCombo=function(){var a=McxLocalizationManager.getLanguage(),a=[{text:"T\u00fcrk\u00e7e",value:"tr-TR",selected:0<=a.indexOf("tr"),imageSrc:McxPathFinder.getFullPath("$McxApplication/assets/img/uiCommonImages/flag-tr16.png")},{text:"English",value:"en-US",selected:0<=a.indexOf("en"),imageSrc:McxPathFinder.getFullPath("$McxApplication/assets/img/uiCommonImages/flag-us16.png")}];$("#languageSelectCombo").ddslick({data:a,width:120,selectText:"Language",imagePosition:"right",
onSelected:function(a){McxLocalizationManager.applyLocalization(a.selectedData.value)}});$("#languageSelectCombo").css("position","relative")};McxUIManager.prototype.initializeHelpButton=function(){$("#helpArea").unbind("click");McxLocalizationManager.localizeContent($("#helpArea"));$("#helpArea").click($.proxy(function(){window.open(McxPathFinder.getFullPath("etc/doc/help/index.html"),"_blank")},this))};
McxUIManager.prototype.initializeInspector=function(){$("#inspector-button").addClass("inspector-button");$("#inspector-button").attr("data-localize-for","title");$("#inspector-button").unbind("click");McxLocalizationManager.localizeContent($("#inspector-button"));$("#inspector-button").click($.proxy(function(){var a=this._documentContainer.getActiveDocument().getMap().getInputHandler();$("#inspector-button").hasClass("state-open")?(McxSettingsManager.write("user-inspector-status","closed",null),
$("#inspector-button").attr("data-localize","McxApplication-Inspector-Off"),a.setInspectorStatus(!1)):(McxSettingsManager.write("user-inspector-status","open",null),$("#inspector-button").attr("data-localize","McxApplication-Inspector-On"),a.setInspectorStatus(!0));$("#inspector-button").toggleClass("state-open");McxLocalizationManager.localizeContent($("#inspector-button"))},this))};
McxUIManager.prototype.onActiveDocumentChange=function(){var a=this._documentContainer.getActiveDocument(),b=a.getMap(),c=McxSettingsManager.read("user-inspector-status",null).getSettings();null==c||"open"==c?($("#inspector-button").addClass("state-open"),$("#inspector-button").attr("data-localize","McxApplication-Inspector-On"),b.getInputHandler().setInspectorStatus(!0)):($("#inspector-button").attr("data-localize","McxApplication-Inspector-Off"),b.getInputHandler().setInspectorStatus(!1));McxLocalizationManager.localizeContent($("#inspector-button"));
mcx.isDefAndNotNull(b)&&(mcx.isDefAndNotNull(this._layerManager)&&this._layerManager.setMap(b),mcx.isDefAndNotNull(this._toolBar)&&this._toolBar.setMap(b),a.isNeedUpdate()&&(b.getRenderer().paintLayer(null,null),a.setIsNeedUpdate(!1)))};McxUIManager.prototype.onDocumentContainerAddButtonClick=function(){(new McxNewMapAction).execute(null)};McxUIManager.prototype.onBeforeActiveDocumentChange=function(){var a=this._documentContainer.getActiveDocument().getMap();mcx.isDefAndNotNull(a)&&a.getRenderer().abortRender()};
McxUIManager.prototype.repositionOverflowDialogs=function(){$(".mcx-dialog").each(function(a,b){var c=$(b),d=c.offset();0>d.top&&(d.top=0);0>d.left&&(d.left=0);c.offset(d)})};McxUIManager.prototype.relocateContents=function(){this.resizeDocumentArea();this.centralizeLayerManager();this.resizeMenuBar()};McxUIManager.prototype.resizeMenuBar=function(){};
McxUIManager.prototype.centralizeLayerManager=function(){if(this._layerManager){var a=0,b=0,c=this._dialogManager?this._dialogManager.getBottomDockBar():null;this._menuBar&&(a=this._menuBar.getContent().outerHeight(!0));c&&0==c.isOnDragDropMode()&&(b=c.height());this._layerManager&&(this._layerManager.getContent().height($(window).height()-a-b),this._layerManager.show(),this._layerManager.centralizeLayerManager())}};
McxUIManager.prototype.resizeDocumentArea=function(){var a=$("#mainContainer"),b=this._documentContainer,c=this._dialogManager?this._dialogManager.getRightDockBar():null,d=this._dialogManager?this._dialogManager.getBottomDockBar():null;c&&!c.isOnDragDropMode()&&b.setRight(c.width());var e=$(window).height()-$("#mainContainer").offset().top;d&&!d.isOnDragDropMode()&&(e-=d.height());b&&e!=a.height()&&null!=McxApplication&&(b.setHeight(parseFloat($(window).height())),b=0,this._toolBar&&($(window).height(),
this._toolBar.getContent().outerHeight(!0),b=this._toolBar.getContent().parent().height()-($(window).height()-this._toolBar.getContent().parent().offset().top)),e=0,d&&!d.isOnDragDropMode()&&(d.height(),b+=d.height(),e=d.height()),this._menuBar&&c&&!c.isOnDragDropMode()&&c.getContent().height($(window).height()-e-this._menuBar.getContent().outerHeight(!0)),d&&d.locateDockContents(),c&&c.locateDockContents(),this._toolBar&&this._toolBar.getContent().css({bottom:b,top:"auto"}));a.width("auto");a=$("#documentArea");
a.find(".mcxpanel, .mcxpanel-body, .mcxtabs-wrap").css("width","100%");a.find(".mcxtabs-tool").css("padding","2px")};McxUIManager.prototype.resizeMap=function(){if(this._documentContainer){var a=this._documentContainer.getDocuments();if(a){for(var b=$("#mainContainer").height(),c=$("#mainContainer").width(),d=0;d<a.length;d++){var e=a[d],f=e.getMap();e.setIsNeedUpdate(!0)}(a=this._documentContainer.getActiveDocument())&&a.getMap()&&(f.setDisplay(c,b),a.setIsNeedUpdate(!1))}}};
McxUIManager.prototype.getMenuBar=function(){return this._menuBar};McxUIManager.prototype.applyRoles=function(a,b){mcx.isInstanceOf(this.securityManager,McxCloudSecurityManager)&&($(b).find("[data-role]").each(function(b,d){for(var e=$(d).attr("data-role"),f=!1,g=0;g<a.length;g++)if(a[g]==e){f=!0;break}f||$(d).remove()}),$(b).find(".mcx-menu-tab-content-group").filter(function(){return 0==$(this).find(".mcx-menu-tab-content-item").length}).remove())};js.app.McxApplication.McxWorkspaceDefinition={};function McxWorkspaceDefinition(a){this._xmlObject=a;this._rootNode=McxXMLReader.createXmlDocument(a)}McxWorkspaceDefinition.prototype.getDocuments=function(){return this._rootNode.findNodes("Document")};js.app.McxApplication.AuthenticationPanel={};js.app.McxApplication.AuthenticationPanel.McxAuthenticationPanel={};
function McxAuthenticationPanel(){this._user=this._userImage=this._floatPanel=this._logoutButton=this._changePasswordButton=this._loginButton=this._rootElement=null;this._defaultUserSmallImageUrl=McxPathFinder.getFullPath("$McxApplication/assets/img/authenticationPanel/default-user-small.png")||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAgAElEQVR4XuxdB5wV5bU/c2fmtt1ll44gdkXsIsZuJLHEElvsURJNfL4YW4yJJWqIT19MbDG2GPUZW6LYe4m9F6yoKCIWFKTtAltvmZn3O+2b795dZEEQwp2Nm7vs3jLzzZz/d87//M85DiRfK90KXDFuXH1dPrVpa1vLd9raWzdtnvHVCNf3By2Y11zfumBBXRRGTgQQRRDxueNDFDl+Nlvo029Am5vy5zc09fk0k8l+0NDY+HrfAYNfGT63fdqYcePKK91i1fgJOTV+/ivF6T/0179mPmn5dNuW2bMPXdDSsmPr/LmrdrR35svlkhOGATgpF8IwBNf1IJVy2ewRAeh/ggERQBhFEJTK9BjJd8pNQTqbC3J1DfObmvp9OHDIkEfqBw64d8haG7970EEHBSvFAtbwSSQA8B968a+++mq/NO2d3WbPnn3cvFkzt14wf14fNHgAB1KuB+A4gP8jI7c2emPxtOlXAoBxBvCHMP5bEEUQBiGEQUDg4KfTUZ++/WYNGDD4yfqmvtfv2HeVpxLv4D/zRkoA4D/sut146fmrTf/kozOmfz71gNZ5zf3DoEy7uuOmAI0fDTwUS8aLW7HLm50/3vVtD4D+XBEV8D84QtBnAoRhBEFQhiAIwHN9aOjXf1b/AYPv2Xzrbf8y9pe/mvQftqQ1fbgJAKyYl7/6ukT//NsF23w88a3/nTZl8naFzg4/5bnk0rPRxoZKwb0YrRqvWnHs+mvoH+/yhg6wAAB3+xgA4jfFX4cUQ7B3UQ7KFGKk09lg6GqrvzVio83+OHi9je5JQoQV8+ayjyoBgBXrGtH1GDcOt3L+Wr3+rC0+/fDDS6Z98tE2pUIh5Wcy4DhVl83andlgHTJM9QDIMRBg4NgfIwT+pdnXFTgW6gGwe8DegHgWjAH0hV4HhgnlcokAaeDQVb9Ye90R54WNg68dl5CHK9ZdZh1NAgArzqVxyPCf3ik1fb1WZ+TgHUbPnznz/Gkff7h9sdiV8tJs+D1eMLJ0tXh+Rkj/5AAAASHeygEifRM0YGIN4q8IP8OAgfIHkQkrCABC9QCYOGQvhD+TPzuCcqlEn9zYd8CMNdZa+/Q//v3GG1acpU6ORFcgAYDldC+cf+p/NfpOai0/nV1/wdyWtefM/GLdQasM7zNv3tzGQkfbOm0LFgwrdnWl3HQGUryVG8O1Lxr+bGJ92tXZB6BdPlISkC1TDbT6lNmhYCSwIYYzAQ7yieTyk62LoROwCFGoxq+kIr+OD6VUKtPjsNXW+HDjzbb85Ym/P+eJ5bTkycf2sAIJAHwLt8X48ePT7Z+8Paqtvf0H82fP/u78ec3rti+Y169ULme6Cl0pYusjIGLNTXkQOgBpzxUmny2f7ToiECBAMF+VXgEZnxi0QwaqbrsaZZwVUOhQz4LCAgUBAR12D/TzDb4wIFR4AsxFIMiQV4A/a7gQARQKBXA9Lxq5yeYPff8H+xy5x0EHzf4Wlj75iEWsQAIAy+gWGT/+ivp5H316wFeff3ZEa0vL5q3zmptKxaJDDL3jQCqVghANC69AoHE5x+bNbQG4LkBT3pU/8E6sICCbtTlyBATenB1IEQAgoKh/j0YZE3ZkpEIEaPzPXoQYP4YA9M1vX8k38C/Z62cgCekE2PBtANCfzSNxBBF0FbqgsbGpY6sxu/72t+f87xXLaPmTt+3lCiQA0MuF6u3TbvnLuB0/mzzp1LkzZ3y3jVR3ITgOpulYgKPuMRolG01MqBEwOBHM7wigGAD0r3PBc9k7YINjl14cdrFQ8QhieyeA0ecoj88YoAIf/kxM5+kXhQy2X2G8AQUBAQZJBugn0PsgkJG3wcDD5ybnF4pXoB4DejrlEhRLZVh/082eP+Dgn+w35oc/nNPb9U2et3RXIAGApbCe48ePdxd89MZPPv/ovTPmzf5qLRTkuLiFO7yDq7IO7S0IAVBYQ8YYhmQ86BXI/k7ufVshgkI5gvpMCuozrnGreVeP03z4XCt8Z/e9gtWrDA8cJw4H8LQRADhul/BAQILhRolFfQ/2CtQjMISkgA0RjZIlCCRVgI8IDPhIa4AhQ0T+B4QhQEdnJzT1679g253GHP6bc/50/1K4FMlbLOYKJACwmAtmPz2KIuf6P5/x0ylvv37u/LmzhqIgx/M8Ic04N0YxcRhCQIYQ8WMYsvuMYKAMPjvw4KYc6CiGUAoAfM+BPllX3G7eVZVcU24f5T/4SvINJH7H37G1RgQoZKNRKs4iyGeSkaPdChDEbjwDQwwQcbrPAI4VKqQc+kQBB/ZY0Mzp/SwAIAGR9Vn4dyQJMWLZeNToqy689qbjHESp5OtbW4EEAJZwqe+67pJt3n7hmRvmTv9sXdztXTR8caJxUfnmDyGACMoBA0C5HEFZwEB0NBDgriwZPHy96zpQLEVQDAG8lAPZdAqynkO7KAFHqB4AJ/fwtRg2aGBQ6cajUUZkmClyDxxw6SEFaLPoLbC9IRchxJ0w/fhZ+I1GS+68PGrIwtiBXAaHBikFhBR9Ev2VtAFk8Oz1KADQY4VXEEFXVyesPXKjV44+5Yxdt9566wVLeFmSly3mCiQAsJgL9tFDD2UefOrOv336wcSxQbmUSqezxjVW4pzde1TIhWTw9BiEUEKDCtgTMMIcJdUk5vYcB8qRwx6AiwYGkPcxnKg0ILZTjgd4h+d/cyghsYFoAchUxRPA3RqNFj0DNFokI8l4lTSQ92KWn3ds48EIeKlnoEtnACDlgIsAIO9HZKScH4Y+pBoUUOH3ldBAALOjvRVWW2vdGXsdePgOh/z0px8v5qVJnr4EK5AAwGIs2kP/unbzVx+5597ZM6YNT2ey4LpiPNYqovFTnB8EUCqj0ePOHzAQ0E2vxq9RP7vKbKQOk36hQ6/zPNyxHfBSKUh7CAxijJg1MGy+kfnImYgHbesBrHPkHVuMnwCAd28EAvy9i96BfT7CD7A3gOcgIQ0WB8murm9PQELvxyDDacW4PoFCHnwf8mYUXBgEKGUYAnR2dUJDn8bWnXbbfY9Txp33/GJcnuSpS7ACCQD0ctHuuPri41548LaLg2LRR+PnXU/iXnHj1SBotydZLIJA7PZTDI+fp+y/tUOSK5/Cb3ShHSgGEaRdDAkQZAB8MSgKIQIEDTYkJgbRzRfiTs5HEnYiCFLvQIGGn6SkHnsD/Dn0+Xgc6tYLMGmqj2J79WTUI7CyC/q+DAZ8LggKdNoUCnBYgMdepvOQ4iLJHOABF0tF8Dy/uPehhx1y3G/OvLuXlyh52hKsQAIAvVi0K3537LWTXn/xZ57ng08kH7vMaChif7I74m7Prj4+mjja0syb51OMLKw8uQBoKGyI+O74Hr7rEhGoLjqCAIIIvX9gpfTEAI3rjaGAJfFljkGIBklFci1AnEXAZWA7Va8Az0+8A9EFoHfAnkos+CEwQC+HjJp/prSlEpKGLESeQbwBURMiUJI3oKBAnAkDZKlUAtfzg30OPvTI404986ZeXKbkKUuwAgkAfM2iRVGUuvS0Yx6Y/MZLu2ezOUCyj8kuvMNTxgVGQycXH40/CCRurozzNdFHu6DJCLChkNFQDgA4hk7xczw3Bb6bokcCHFEBorEpr8BsPYoFI9LwE6VOR8cGLaLgOMY3vABbmuoEWG1YGU6YUAGBgPoMYIwv4QIBIDP+mjEgICDCU4BAvRE5ePIGKL5QgpDPkxqRRE7F6/CcSlRY5AT7HXrYkSee8fsEBJbAwBf1kgQAFrJCURS5F530k39//O7rY/L1DWT4ePNrfExGHERk8BTrVxm+utd6w3PumwlA3L1NDMwqH3GV0QXnmB+NHL0BlAQzGRgbNhouhRjd3odBR3dyPlY2as3fq4yYE4ekSxT3XDUGcQGQZifwDTQkwBABMxUIVJilUE4BkYTSnHRMTHraQFCtNOSQAI8BDZ+5kbKAI/Eoko0olct4TuWddt39wHEX/eWeRd3Qyd8XbwUSAFjIel12+rGPvf/qM7vk6/uQQanxa/6+FAaUwy6i8ZfZA9CMPBoJG0fKqOOQGESDxdex4UqKTbL4aGT4Gehmo3GhAaDRpb0UeB7rA3AXppgfvQYMBQh4RGMgOylbc+yCaxrQgADyBZgClBIifTT+gGYoJKxQyS+BlHAedJwIBPKNx4fHii4IeTh4TAoEkk7k9CUrFljxaIUE6BGIJ4MgQByBKggJVMrg+eniD/bcf49fn5MUEy2eiX/9sxMA6GF9rvz9Cf+a+MKTh+Tr6mkXxmY7FL6Sm4o3ZACFUhm6kOQrscuPX2gYnovyXTZYtDSOjyUNWI4BAGNnOxXIGQA2KtxVSUGIAIBhAAKAeCDGviWlhgBQIk8kztkbFZ9ltAoARshDAIAyZdUIVGYP4tp/UQrapYSWR4AkJR43fhstABo0eTsCdgE/kgpQPkYzBCYkEJ6EwyPxCjS8QY+nVAQ/nW0/9Zxzttxlr/2TrkNLCQUSAKhayJv/cs7ZL9x/2x9ydfWyw+kSqfGXoVAKoKsUQLEcEPmH+ynG6mio6L6TDBhrfJDMKodQRANAL0G1ALK7cScfjosRZDzs8iN5edpJgcVAGAaggEczAmS6YkgEABbxiKlCltzG8mIJuznMEFDgHV30AXasXlETEIcFBAgmi6FWHGsJKr0CPidNVQZlBkkTFlhhj/EGKCRBT0BThCyb1roChKGuzi4YMmzVr87569823HDDDZuXkg3U9NskAGBd/odvuWaPB2+88n4/7aW8lMcsOGltmaAqBwEUS7j7q/Gzyg5jdMwO6M6P5oG7Mt7wCBLID2i8Tq6tVSZLECAhAwIIMv/KM+B7YEiA2gA2MCXhNK3GLrcBAU0/IqkoIKPdPWLtvvANoiAy2QLNbDAhwUAhz0FDdsho45JiFR7J02mtNITBTsIeZjNQvyRZB+VMAgqBWEPAoYqlF6AQh8MBCplsAJCnt7e1w1rrjZzwzwcf2bKmLXcpnXwCALKQH06YMOD/Ljxtcuf85r5p7L5DKTDR1oUYb7PRIwDgjo4GhjE+Gy0aqUvMO97oKOLh56sSUHX8cQUgVdDJRkphhudABr0IHyXFGG7gzs50Pr4/GxcDEvMRGr1zFoDBBr0NfB260cgNSAUg7q226012p94HLwC9nzFINn5TEqweghAMfNzsEdBPCBCCBCwqsjgCV/wOXMsAvSIGQwIBDIMMQakEK2ZX2Hvi9KCIh4RExRe0tbXDTrvudt2fr7rm50vJDmr2bRIAkEt/ya9/9tzkt17Zvq6+XhRsfEeTDDYIadcvlLETLsex6Kr7fgrSEvOjEeCNTUZYLhuWvqKAR/LfpJGnHY1jfXovLwUZBBOPC2uI5KO4OQJfmXeJvTkVp/p7EdgI16CkJCkQlRfQUl0tJTQ7fLzbcxvxWFZc4TEYTQHnDkzPMAWBqtCAeAUhNDV1SOlNAYsyglOZOQFaTxOCIAggccp9BrhyUlKFGjYBZxo6OzujQ4466siTz/h90mrsG8BXAgAA8OCNf/vv+2+4/Kpcvs5IYskIyYhk10c5L96RGJe7Kcj4Lhk/xuVozOgdIDFYwOeRCEhEPry/muYZWBzEnXQkZ2AAwIGsbwEAfTaLfjysMnRRphsX9PAuK6lJZdEFhJh3EDUi7rYaEggAmNy/1QDMyH/JE+ACg258AZ2K6g3YC5BgRNSNcVpRScf4OOMaBKpYEDGTiqXMPayEheEDQCTQUlkpHAeCbC6fbz/3gr+sv/WYMV98Axuo6ZfWPABMmPDvxlvPP+/TrvYFTX46LVVzkpemFB/H/OUQKTkm+zJpF7KeR/lwcvnLIXQWSlCQ51MO29rVcDfDXzHDzbtbzIaz/j7tpyDnc8oPL4pWEKIkGAlAk1mQXZrJQvYekChEu9F2XLirKgCQFFlcbqrIE2Y93sXNkXZz+ZUL4BBBfHzNLJiUXhxeUFZBewcqOEjKT8MCOlZqgibrQXyAAKYVpnBXIyUFtZqQiUHtX9DR0QGbbDH6rWtvu3Pzmrbib3DyNQ8Al591wi3vvPDEYXX1DbSM6IDjDcmuNMf9aIx4b6Irnst4kPE8ctXRQ+CMQBm6ikz2KTuvaa6Y2bYBwGq2gcaNZb+eC9k0i37wC3d+EhphYhxrASQVaAzRiVhrIMVCRqeggiMJATCMQDAwEuVAm3OohxKXI4uzYj9IlsICtBgHhIfg3L7U/Ql5KLG9ce41WyDcAHIapFhkb4j4CglXVLnIiMMAgLBCWQQqRGIw0Gimvb0N9j3osLPO/OOfzv0GdlCzL61pAHjqgbs2uuOK8950UykPXXly+9GNRheamH6O5fEL2fls2oNc2iWXXIU4HbTzW8y2pPUQALhVFrLZvPOzXt5uysmGgcaNAJBLcwiAYIMAhIx5QMQZWIVBmgFQaTAXJaE3ooBAzrk0H2HZMOsECNRUQVhR40/ReYVXUm0RWnJsewWaLqAjppCBQwI+AyERNeUnPAIpCQ2nwSGNcgGqCIyVTJIaxDUU/oR4AfECtGYgl893nfW/F2zw3d12+6RmLXkJT7ymAeCiXx/95OS3XhqTq6vjzrtkNAHt5tizTo0fc/to/LhDU7de7HJbCqATlYAUHnBRCxNnfFOTYlAELZibJxDQ1JxmwFA8RCnEFNX8I7igB4CQUyqxG4/HhLs4PgdFQSQSqkgjomSYQUDDBBIuSXROgKYgIACgZcranUjr8u3UngqU4wCBPtWU91YDAWYVqFRICUb5N/MEcUzEFYesksR1VYkzrz33S9C2YXEyEhuiSFMU6qegRVgMqF2dnbD+Jhu/eONdD2y3hHZQsy+rWQB45NabRt1/w19ec1P0xRJWlPdiPF8sk/uPNxfepJm0B/m0R/E/fmEasFDArAAbP3vFUv5KOxrvUmz03ASDd664/x6FG+S+O0Qo5jMu5NNIKjrk+hOfgNt/5HBdAAqCKN0o6TIyCH5f3m1Z0UeCIkkbkk5fvQEqv+X6AVUP6r+1S5GWF7OHHbvZPVmHzQloVEDFQ0ZfoIAgtQgCAkosUm2FKh+FgVQuoFIlGQuEqIRYPADmO0RNGUVQLBbhiKOOOfS40067tWateQlOvGYB4PIzT3j4nRef+AEq/oiQksIeYvJR3huEZHRZX3Z+F4VBWKseC4HQcOiGJkKO9cKVxh/vvqatlmyk+IBxO4IKsv91WQ4v0DDQMBFc0GXnsIR3PAQKLQzCz6X8v7DptCNLDYC+LxftxOXELLDhY6L6BcoyYFqNm5WQWMnuBVjdtdi+weTOsW8gzSRQQTO1IuPCJKqIwH+z7yLZBT4urieIewZo96HKjsVxahCXRAVCJMHWRqTlMjYYnbHl0NXWGHf77cUlsIWafElNAsBbLz4x7Po/nT01KHWlUbar7bvU+HHnxYXxPdyVPXL7cYdFw0TCD0GAbj7R56ew7Xcqzl2TMWnJrnH9YxGQ3ml442PuH3f/uowHWZ9VgGj4CEK4U6Ph465fKHEYgM9nL4C78OpnIVlotwxH8CJ5sqUipAIc6cWnlXssT9by4sqWXQwGcb9/Nt9Kz6DiBrJ6EGjZNPU5JDBAj4AJTeUKtJUY8wKWfNhwJUYhYLonl0OtHuzuUeE4slFbb/OHy/9x87iatOYlOOmaBIDrzz/9khceve+kfL6OlgxjTzT6QpFz+WjblO7zXWL80aWmv4sEGJ+PtzG7sAwO+O/Y8LUASMp+TWtw6eBDXoMD2P8Pd300fgSBjM+hCLr/XYUyvR8aTv+mOpjd3EGAo2IhTf3pjo4NR5EzQKPlTsFSnCRAgKDBMbeUBssx2RwBekHauoz7GWofQm4Dxm4332WqBiQtk532lJsw5gJiL4A+Wz0AAQO7zJgrCvngteMR7/BKFqo4SDMC0k5NvIAyegF9+84/++LLVksai/YODWoOALDJx+/G7vlFy8zpq/h+mnY0JNxQ5Uf5/nJIu3kGWXnfk9JcVPgxOPDOj8YlhTtU8suGUQ44zqaOPdU973QwhxTbKPuPcT+6//iIoIMGXCwhD1Gi90IPZeRaA2Hyp3OgqxhSeTBqBkgeLG3AuNCGAQBde+IFRPuL7rgaP3YX4mIlaWem40PVK5BjJt2A8QoUxJTEjEt17cyBDi0x2QIhBpQY5EduU44Sa4ZMXsueQIAHjdhNVTC8EiJQ2okZUtXKYLS3tcGhR/38olPOGndK70ygtp9VcwBw22Xn7/b0/bc9goaFOzfuemjc6Noj8YdsNFblYeyP2nwySNUDmLJf0f5LTbvG/ZRi01i6m+sf9wNEgME8OJF/aRcacj7xAOgGI+Ov2gIEJt93YYfRa8LED6bDnHmdxDegp6CEILv1GtcjCHAfQgQhFtqzgVFzUQEA9B60wEgrAnVX1w5DJkSQvn928xHt4kPhhDUWzCYPVf0YNyXRbIWAgGlbJu3LpDEpdxWunGLELCsLg7RGANeJjzH2qvBp2ECk/4ABLcef+Yfhu+22W3ttm/eiz77mAOD8E8be9cl7b+3nZzIU+7NrL8RfGJIR4u7PpbkO7agIDsT2R9y3H3UA3EVX+/Xrzt+924/G3FI/Q1eEuv64sftfj+IiXzIM+HkYikgWIJf2YPcdR8DkT2bBpE9mQxCx8VeHAkoIovEjCBRFAUhkmpJxUnZMNfzUeSiuLuSYPU4fIlxpw04lD7WLkQKApg91DJgp3TVjyOKxZmzETAiSB6DkoAEC6T8ofQUkfWGFG3EbMW6bHnskeB21vRmuc1dXF+z+w33PPOfiv5y3aBOo7WfUFABMuPpqf/xTd8xobZ7TP+V6FNdSkQ919qF2lFTVh/l+3DHxhlZCDg2CmnKg/p+Mn4d7MguvqT4GADWYauOXYjup8UfyzwM0foz/ERDQoNDwMQ3J/QVDaGzIwF7fHQlz53XA069MoZkBaIBIGGI4oCQfHjuHIdwghIuSmOln8Iq9Aeo+LASmgoApNba7HVu2YQ/+tIFB5cc6OMSu4ecGoeyhME3A3Ikk9kwYYLIHFW3KJWcgAMZzB5loZa5FhFUyX0C7EeHnYEPRoasO//Kux59etbbNe9FnX1MAcNvlF+74zP3/fNoR9Qm72yUT23NcjmQci31oJxXGH29SNH7c/bUZJqrTbOOv7nXP3EAla86f4UDOZ/IP43/czSn9R4AUksCIZcAhDBlQD3vsOIK8hoefeR/mzuuiqUEcQmDPQOYDVCCERme6BGE2QRqR4HGywIZTdNw0VKoKpdSY0oaa2aDfxZ2B6UbRu0XnE4qqscID0CafWstvhn+w7JdmExMayKQQKlUW2ZG2Jze9BqUFmlU6bQBAOiLhOrGGIy5xolCgWIQDDh+73ylnjUv6CH4NDtQUAPxt3K8vf/2ZR36ZyeZJRIMxNqX1uPEkGTcSbLgr4i5DpKDUAVDRDXUFTtEMPhWkaJ9+nfunxmB2/4rCoNhwK3d/risgb0OKj7QSca3h/WG37UZQ6fHbk6bDi29+SuEJpgWVELT5ALzW2nhUG4VwXYPOJ4iHk6qCkPP1WsevfQdYVBT3IbDahZtKQbl9ZIdXIZEBBAMC8YTgUKTVLOLhAak620DVhSn0sqwR5ezg82cRAKiegUjXeGyZmbsAAIWuLthsiy2f//utt++w6H2wdp9RUwDwh6N/9P70T6aM9NJpCIyxMflHnX2kIw+5kTTUg/P91LBDUn60q5vilLi7rzLSpv6/YpAnFxmh54C9/TH1V5/1yAPQ2B9fT23GKP/PzTaw6eioDYbCd7dahzySrkIJxj/8NnR1lUgaiyBFZckSCmiaT8HHVv3FJcKx8CduyhOBywG6IQw1RLC7EJmuRNKYRHkDSt/JF1UBGM8g1hDo73QyMs8QQOmvThiKS4m1cpBl1RK7CInA8wYBSkIAcpFTPMhU3wXfO53OFH5x+slrHHTQkV/Vrol//ZnXDAA8df31Tffd93/TCx0dOWTS8cbpojn1vMujkVPFHf5NWnmZfD+6pJQ1wNp/JP5EUWcRURoLk1H1MPsP426SFYvwBwGAC4v4/ZC0I/GPDBTBGx89lO9vvTaM2nA4aeRzWQ+emzCVvIBsxiMvAHdGfE/qHmzl+skQjSDJLgaypMAybJTDFFHvCUlpNPumuQd7A3YfAu5QpMNDpL2XBQS0c4t3oOtCu7hMCGahkVYCiicgoQmVDOvkJSVPrHkC6Hnh/EQqm6brgMDMWgX96mhrhyOOPuask844M6kUXAgO1AwA3HblBTs/fc+//o396vBmLwZlEv5QY08UzxArjs08xUAoJRgXrijph79j99/Ki1OdfVygojurMv+a9qOiH8z7pzH2552b4lWJ1UmCLMbBrB3Aj3bbBNYY2o+IM/RCcPf/xz2vQXtnkQCloxSRYWIYoCCgvQK0R4A25KTuwdXNQgTElORDSKGdXQp7ODSwcvVazCNcgZEay3M4v28TBvGdZ40hobifUojS1pz1/1pFGE8cNryDComlWSqlb7FSUsqmuXuQBQAoqCp0wciNNnn/hrvv2zDxAHpegZoBgL+N+/X/vPHsY2f62SztjOjedxWZ/SfVHBJp6NpTv33s9qvpM5zUwyOx0O3mnD83sFBlXE9uP8etbAwky5WinzqV/aaZ+KOeApRqtEqKqXFoBE0NOTj8h6OgLu9T2hF3XEwLvvT2Z/DQM5Mgm/XJI0GBEFUVWiCgpcGiGDaAxQQhcwJ2UVB1CKMARKx9RRox/re2/mKRjzUrUexfewwqHBhnnu46axAJgZ7NBcS7f9yaTKYQmRqIuGeCqiErCFfqJxhCJpMpHfnfx61+xDHHzEhAoPsK1AwA/OmkIx+bMnHCLn46yw0/UP0n4h9cBFT2kdsto7xxM+IbHPWr3PYrrkbjGJ3y4KpWs1xde5m1azC66Sr7JdcfpwBLR1+WGCuocIERDhbdfINVYY/vjiTXArMTPIUHjyeCG+56DT77ci5kMggCAF1FrRhEwY80KpU8vwjVYJ8AACAASURBVB6Ppie1Y3FFVaB4NLbIR4U9tDETRcC3C6v5cH24K5HRD+jPOmbMyhowwWeGl3NNACIEtRjknd+uZVBiksCDJ5nIHAVOz1L2Ba+BDCDhEEBAxQoDsFT48KP/66QTT/vdpQkA1DAA/O7IfT+e/cWna/m+zzG+EG5a0YfGhYbExJ/kq4mJJukK9ejnkl4kr6Srjp0OM/r4eJGVSEPXHF1/zPej8aO7jjc0knRU9Vfi7sHoDXCfHDaqQ/YYBWsO7yutyOKZfAgGn3/VAtff9SoNJsHshGoIGHC0W7FIf62RZvjeFL5IWTBVBkqZsFH7aW2+mRLE5ulIazOVGWvPgW4goEvA1IKdPTTdifn3ogkwBULWUFMqb2a0wc/lAgcRA5HhYzYgNDwHhWA9AEBnRwdsN+Z7T1963T/GJABQowDw4vjxuTvvuHpm+7yWBiTztMsvx/8qTpH0GQIAtbnm+n40/pj4i0dbG516FeGnS6yxM8qJsZmIMX7K+fP7cNpPx3vFo8WwGcnG6w6BfXbZmO57lAOrhp/Da4fe85lXP4Z7Hn8X0mlPBoE60FXi80l7Wg3I2v/qkMCUBovuvxsIVHEcTOL13CfAuJGWP7kw15I2ZwUF6S+C78olw3ZDEXyajhfnVdV6A8r7yzfPPxAORmsCLA8ARUGDVhk691e/P2fImDFjsNF68mWtQE2EAA/ecu3qD/3zmilREOBsb3IbKf+PPfwCbqaBBs2MMnLJIokVtR+3plb2usrtFy+g0u3nPn/a6ss2fiTNtJ2Y9vHHFtnaoQ/j1rpcBg7fewsY2J+nE7Haj8U+yI5zzw10+V24/ZG34IU3PoV81jeHUKCW29xHUEuCaXyXCmzkmaY0uLp8WUChm/S3yiNgq4zZAvmnWGt3O1MX3/xFAABXn7wIaWzCBCT+P14b9pa0y5IhWE341Z2AtT8Z19pxnPDoY0/Y/CfHHvtOYv2VK1AjAPC3He+/6ZqnUyTh450ed1ke7cV3oT3amjcQFPzg71XvH/fzs3Pd1mbDr5Ihn1pOjC4/uv8YBqjx6/wAnRhE5BU1yGRD2HvnjckDwC8U/fDgERkGYuXcqRYhjODGe16Dtz/4EnIZX2JrB7A8GJ0Bag5iA4E1U0BvBe0UbBcAUTXjQoDApDq1NZnV8qsaEAwoVC+UfDgrDKWXoFQwxjelugQqOOJ3Q48M3RGesBTv/vTZVZ+D/0RR0N4/OvCEs/50wWUJANQgAPz5xJ+M/XjSxBvMzD6pAKR4X+SxBADi/vNthvGmTKmRWXsx29+zK8xCGW4giqQf1hRgq28U65D6mMgr1errwEw2fvQ88HW77bA+bDZyGP2ORoOLNoGyFBQUoxcQ3+joGSCZecNdr8I7k6dDLpumLZkyDCRn5nCG5hZSpiDmBbRlmBqp6VpUpXPQ0ubq1KcdFujOTApfQ+ct2kNg09buQar3E8JQ9Mfa4SCeTRiHIwzGPcf/el5YHLTldtvfetUNNx+aAEANAsAtl/3prCfuuPGcXF2ebhYyQmm5pRVs6gGQSIW8bNv42W037mdV3K+iGTsfj8U61ESUFITsJnPNPot9tGiI+xEE0LchB7tuPwJGrDWYPIFMGmcE8KRh/LYZdwUodGfQyNGwMZy4+b7X4PV3pkEm6/O4bnGleWfnyj8eYBqXA2stvs3U6Zpwl14mDW0QUKDQOQPqEcTNQiSgYWxjdl6s0d6gY40fm7h6AgJz5IEpI6pjyOgzxOB7Y/z4XtgpaJXhq71/9+NPJXqAKgSsiRDg6v859eLXnnr4V5lMhtxGnPbDAzM45mdln6Th6A7jlt7YGIwY/4p0H9/JlSIf3l3T+I2GT52EWJhDIbsUrmjDDh2OSYUsEME6qw2EnbZaFwb2ryM7xJ0f34c8CnH/uVuO8u6s2rMBCT0BfK97H58Ij7/4kbyOp3PqgFM04rikuQoEpIGoFWGYQSO8BlJ/L7JbJhE1G6KaCD6mirJgk+9HZSLbcwUXYE0x1nuTN37pJVxt7IIa9KDgovjSg/uPbxWUy9BvwMDmvY/46ZBjjjmmlHgB8QrUBACc99+HXP/pxx/+FCf4EoMc8tReLZVFQ0TyDVNxvKtI9xkSnbArray/vfto5RwaP7cPk5Fhssuq8WNzDmrFTQ1DdOBHGfr2qYOtNl8TNlxnFSr2oVHg+Ei9/BAAAFC5qIU6dmysjTYYBBhlqNbAc+GVdz6Dux6dCC0L2iGbSZtBn0wgMt+Br8G5fVQObBUCcZ2+DuqUjVsMjYzbYt3Nz2aKb2z8di9B1kpYk4UNEOiNKHoAyvSxFbOBaw8A+V03wlHzsJxutKkIfQ98xGvrpzPFn5187PCxY38xKwGA2gIA56T9dri7q7NjH8rpCwCwG45tvTn+1h75ZPw6l45IpRgAlOBS4Qu5/LTT82QfdNuJsJMGl8T2S5suFRgh+YhpvQ3XGw6jNlwd+jXlyN+gij4aDoo7swzPQAAwQ0Dj6bksUrKMx8TB/AMqBL+a0wr3/HsivP7u5+QCYJMT7Q7ErxUgkPHcXPUX6/1NgxDjdSgYxO69hkVx9V88esz2AhgotBzZkkxrWKAxvB0qGOEPew46Ul1nDBhAppqHbrZfgQUIPq7rRiM22GD7a26948UEAGoMAE4+eJdH2prn7OqqByAtwLkvPhu/CnHoRiUAEMO3W2OrtBfba4n0Fqv50Lhw5+Z4ny2T6vKtnb9QLJMBrrHqQBi1ydowdFCjlNuiy4+v5ZZd+Hp8b1OrLwaqRivesVHGmeBarqmy4AgmuJNPeG8aPPj0JPh8RjN42OBUZg+q3t8o7ER9RDURlkfAIp9Kma8t8Ksu9unWLMT2GLTLMHEX8SSimNyzwhoFNSmuip9v9wnk8MzUGFghQHXSAb2ADTbd+LBr/3XnvxIAqC0ASF106jGPT3zp2THZfD1P/8GYHD2AkPX3rIBjJR7vVLEXoHG2UGoUT2uOHw0/bsrBrjTeeJrnx12fG40GMGhAI2y+6Tqw2vDBPObLQXkv8gZM4nGeXnZgBAB00dEdJg+Ad2xj/FV3cGXqK6bW8GmZtA+dXUV4/o2p8NQrU2D6rAVMAvqeGeLBzUXjAIObhsSDS+yKPyUNVbRjH4pmBezdn8t/K0MHEw5YoUXFjm7Jqu22Y/HrOAVIoCD1v7ZsuaeMYxgEsPGo0Sdcfcu/klSgddFqgQNInf3zAx75YurkXdLUBThmtcn4CQjYE4hLemWuH+lVtVRWmmMIk059+WSct6rsyPilm642Gm2oz8PGG60Na685HOryOH0Y032cjvNTPODTdXkCMHfrRYEPG59pn1WV++9pB6vOf9ueAb5XJuNBa3sXTJg4DZ5/41P45Is5VG5MZCNlGeIKQG1zLpE4/S1uGSYgJVN/Y/WeJvTY/LQ5SEwKdu8NUGm01s6uACCDQDXE0EpJJSC1HkM9CDtTY3spul71jQ0Xdvl1Zz399NNdiRfAK1ATAHDCvjve1dXRvk88s09ELhIC6CRe0gRQDzuJNDHhLtV8NHLLDNvgWF1bcRH/JOw3TfUplal/wIj11oCR668DfRrrOWRIRSLqicB3sIwXv9HYQwIA0ywTQQcN0sT6laRcb27engABd/KMj30ESjD5k9nw2rvTYOKH02F2SzvdCUggouRYVXjo0eBxkAeiACGchCEOpVw4rtrTWETiconvDSBUufZCA5g5A3FmIwYM9sxkvBpNEpYx6zq3wFIokqiqihCMPYLoulJXcPIrU6Ys6M0a1sJzagIATv/JXrfM/vLLQ1A6i66mzulDt581AZgK1Bn1svNKIZA2wCC3GY3emmzLuzSHDVyXzkz/4EF9YbNRm8DgIUNoh+U2YygQQhDBb2xAEoKLUiPqlR+CE+EoMql5EWksW8XiG//CblwFBTRWPC48t5b5nfDh1Fnw5gdfwOSps2HO/A6akYhAgDoEHuTJ3kGl+x83AomJSh2QWnkEmjI1AiGLzWdCM2b5bUDQnT2WJEsDVhklTjoEasLK4QCGdtoctKeMQBSF/8hlyyc9/vrU+bVg3L05x1oAAOfPpxx91aTXXznGwxAAWX80Wuksq22/qPef0Ot4u1P9vcyx50473BLcCGdEhqqz9DCjgCTbJhuvB+uOHAk4cZhm+aGajwAA3f0QPGrIiRrDgB4RBJwoYBFMRAPFTfdcSu31cIV4h/66r0X9PX4tZTJ8BEaAeQs64eNpc+C9j2bClM9nw1ezF0BbR9GIjahVOrZH4wpp5imkPkFTh9WegH0kuhNXHr6IfapPx+IHMFPD04OlijHC0E3mGMo0YeYK2L2Im4vZgRD+KQGA6mXu/Z3SGzhZMZ/j3HL5+ec+ettNZ6Sz2AtActWWuo1GYFEREMtmeX69TN/R3vlWk0pVvmlLKyQRkeTbapstYeDQ4VSdh+QbGhYTfECGjsaP8iIXJUZRmQwfH7lDLnsByD6o6o2LY3qK1KzL1uPfl+xCUAaCjNyBzkIRZje3wWfTW2DK53PpcebcVmhtK1ATVa55YM0C90tkcNSjNSI+PRQNJazIU59POXyJR03sbmkvtFYBwwAaZorcAHE32pMRy4LjfgD6kQo4jAu0lteXuoKTkhAgvj9qAQDg8rNOPvm1Zx+7yPMzRqVGuwmCgdXXT/piGhWdegCS2ZPCE60+k7l5UQgjRqwNW2z1HejT1JeMHhWHTK6h54CdgKmqAFJRmXZ+Nv4yQFgGJ8SOxPgzGz/VJerOLyFAbDPVl6vq3zbz1dsra7blSiENGrAaNv6M7dPmL+gkEPjiq3kwfdY8mDGnFea0tENrWxdlO7ifgQw+0epFsmyuX6C6fvxCsJCeBxriGK9Ah5NUZAhYzKMybh6CIvJkmcPALc9ZE1BNAHKxFTkH1wfFBADs7aG3t8mSbSkryKsu/O2x+09646U7NbfPHWk5GxDXkvPBahts3NkwDFA1n1adaVdbjTG33HpL2GDTTaCuLg/ZbAbSaR983+PZfWT8yPDj7o5GXyKjh7AEToA/4zcKjgOI8PeaRzMBrJ3Qqt71u3sG3VzrXq+/RZN1y6HFv+BOQNxfgLoWFwNo6+iC5vmdMHNOK4mPZja3wtx5bdA8vwva2wvQgUNOA+yvKKlFETdR228LJJhv1AYhPB5MuTy7ozDxLTjjAFO4EhLQNVEPgCw9PnHd/fE9+jQ1XdwQuWfe/tJLnb1empX8iTUBAPff+n+j7rr2sgm0yWpnH4kpmb1nMQnPsscdjJlwYsHlfoorAcUtjwBGbTkKNt1yS6irz0Mum4VMNkvGrzp+aSfCuz4Ze8k8QlCCKCgCRGWIQrqj8choC+MNi25duf1iH1mrAZa9E9c9m64dd3g3rZ42xMaLx079FruKsKC9AM3z22FuSwfMmdcBzfM6oKW1E+Yt6IC2zhJ0FkqkkcB4XpuEcPm/CqEYCDQVi89hGTPv9CTiogrLuDaDrmQPABAEAWy42aYnX3frnZes5Da9WKdXEwBw41UXDHr+/rs+7+rszODtpQ0wudpNW3GYvhPCvLMGgNxWs0rcPAT/uc46a8C239sZGhsbIV+Xg2w2h3pziv+xvyAy+wwA6Obrbl/E0jQ2/LBIu34U4HeJY38EAgkB+LMX5awt2ivo/d1QZTXmhdVAYHkLWuhDFheLcrROgTIoVpcfEkhhK7ZiAO2dBWjrLEDL/C5Y0N4FLa1dML+tCxa04WMndHSUoaOrSGPSUEWJxVuUphXcIQ6CGrZYpcGCmdobkIGKry8CwFbb7HDEpddff3Pv12Tlf2ZNAMBTT43z7rr8udnNs2c1OSksCOL4X9NLvLNZPqf6nvIrlcJieIA/9+/XCDvvsQcMGLIK1NXXQS6Xh0w2A57vg+/5QogxqcdufpGM3gn4MSrjIwIBf6MXQDs/hQMxCRhvZb0g/RaZGViMm7lHVZFdiWODgh0+2CDCXAYTnGyl+MBLi65YtfCIX4uGiuIs1FJg1+b2rhIRj/PbijCvtRPmzu+AufM6KexADgK9CNMtSJScptrQkhFjLcDGm266/ZU335rUAli3Qk0AAJ7vqT/Z7/3PP548MuVxF91qDkBv0DiE5IyAGaIpbHcm7cFOu3wP1hqxIbn++bo6SGeykElnwaWpwtyfjwg9dO+DMgAZfhc/lgsQCgggOFDsT9/IA3A2QPvjVwtaeswJ0sXsfhl7iwdfpyDsBhkVT/56QIjDBa7kMX6WgoFoeJHc01Anfnv2tEwdgpVhwPi/UOTw4ZaH3oFn3viMQi4VGtn9AgjXpdQ7nU6Xfn7sCUl78KqLWjMA8Pv/PvyuD995c7+UjwAgLb2lnRRPqokjbt2piAnHwh9ts+25sNnmG8Nm22wPjU2NkM/XQzaXIwDAcWPYndd07qHNrwgY66Phh+UuCEsIAgXxAnD3x5+RAxAAIP+We+SbkVjGKuJLFRv3wi7f4l7W7vE+3ycLIwerPADDWehL9O9apseZk7hsj3kOAjz6GAYBJvuqj0WFUHxV+Npxn4T7n5kEtz3KTVG1jiMuTpL3oroP7AcwoOUHB/94lRNOOKGwGL7QSv/Uxb1T/mMX5MLTTzzj1Wf+fZ6nHoCEAbbxm1tPEIAJQSz5ZUHPsFUGwU677wH9Bw2E+oY+kMvXgZ/JQhqNH11/HB9GqjkkFCnHSMaOhh+VO9n1RyCgRwkHyAtAEpDkSeSaEAAY+q+KCLR3+4qrt6hLaf99YQavn9oTH9Dd7bd37Jgy0OdpGaU65AwGPABEwwIBApP9kOdUSHn0uDn8UgNHkdVTEz6Fq+94jcqr41btkqYlbodRvVQqwmprrvX+7Y8+kXQEqlUP4O/nj9v2mUfueT4IQ4dr/K0uNqoikx3PLoyhrryeC3W5NHx/991gjXVGQH2fBsjn6yCTz0M6k+O4H11/LKrR9tYU05cgKosHUOqEsFwgAOAwAP8mRKCkA9EwkDewAaA6EVDp7vdEAi6KOKzG8B7AoOJXPcT7FUjJnkKPYCDuPRkiYVoc3qAiM0IFJP1avB4h7eI3s8CPTpW9AfwsnJP44lvT4K//epnES0romoIuCwCKhQJsMmrz8deOv/vg/9gdbBkd+KK2jWX0sd/+215wyil1H7z34ldtC1rrI2yfZUp/xfUUNpkn0so0X3H/8QbbYvRmsMU225Hrj7t/NlcHaWT+M2lwXY8AgCXEWMSDNzru/pzzJ4NHAEBPQHgA8gyIG7A4ADQI2Q2NoLXCGO2MRHVIsPQuZaUbXu0NLAwQrJ3fMmSODsjfl/CGf2aQYy+BhDrC8DNhYIceUhilrcJFIJD1fXht0pdw8U0vkhrRBgCsyeCQjj0ABIA999v/2N9fcPFV3/6dt2J/4tK7a1bs86SjO+mQvSZO+2zqRmisNmmk0l4qBeCNxugAMNYcNmwwsf4DBw2CPo2NgH0FMjnc/bPE/KP7b8aI0b3LAIDknho8Gj/yAFGpwJyAxv+YEkShDImB8OZnEIi1ALywPcf9VZdvaVzNhe7+C9np7fjf6uijhfo05dDe/dUrsAlPVfEJSPDbsAvPpyQ9EDV3IOXN70yeCRf843nSbdgdiwkANAWIrdZTqWDsz47c+OhfnTrpP+A2/VYPcWncMt/qAX+TDzv3V8dc8eYLzxzrYlGQ3edOCUCJ/fEzuNNvCtK+B3vtszuste66tPPn6xsgm0fmPwdeOgO+n6bSXxIPUQAgBT00epvdfHT9yfgFABgUShBSepDVgcgDxADAvfFYB1DNAfRE+i/iMvaUEuiZ/reWtyo06Ob2xzssv8heRIn/bcEQju4m1NUhoHi+ljdgPB/t80dDA03ikEFQZgsiAKR9eHfKLPjzP56jtad6DmnvZtSdKBIqlmCVYcNmHfqL44cedNBBEnN8k7to5XptTQHAX885fYfnH33gGZaLa8uvWEVm2b+QeQDbbL0FbLPDtlDXUA/5+kbI1dVDJpsn8s/1MO+fAYcad8oEG3VtyaDLEvcr+YesP/IA+GhzAKIG1N3fsONqBOKWVN97FYbd86X8ugvcMxVYbfjVz5J/9wQIBlSkiZ9OCCA9BK4zpzkZCIQDkPl+RH5KSGDSggIqWhCl4RkuQzbjwVuTZ8JFN75AGQEz15Aau8T1Gjgb8Hu77n7fBX/7+z4rl+kunbOpLQA4/vjM21PfnjGveW5fB3sDWBVnutfaCzJ0lUGw/4F7QVNTP8jWNUC+vg+ks3mO/dMZQE8C4/+Uy/E//yeEFmUAJP7X/D+RgML+ixeAXgJ7APiNB4SblO6SepEFmszBWfF/tQbgm1zRinC/d+Sfbv7GC5BfEMmnBm2lN/UcKRugRKCmPtULEGUhs/58ZagEWhuUOtzq7M0PpsMlt7xMwiuaYiT9HW0AKHYVYOx//2LscaecetPSMZmV612+ye3yH7kSp/3skIcnvfPmD9CANftU0adeySYAOPigPWCdddcBP5uHbL4PZK3dHysLPS8NKST/ZPenm1RvZor/WfbL7D8bPqUAKe5XNSA+YrEMAgDvkAgCbH6iUJQyZQmHZd17uHT4K+2P3VslEH1MpatdeWGrSUBL1GNeawOVkn5xGo5Tf5IWNWBgCZ8o9WmFB9b7VnAfws3ocNSX35kGV4x/lUhAau1WBQCY/2/o09g+9vhfDT388MOTLkA9WGzNAcBlfzz7R0/de/sdKdc3OeWK+9hBTi6ErbbcCHbdZQfwMnna/bO5Bsjk6sGX2B+FP66LuX+fCQMiqvBRcvk2AGCcj1wAEX/sFSg40KPUBNDOzw31xShtZt2+VHY2YCHhwTeGZ9vVX3gYEINnHPcru89GjQfCBk48hwKB6h30McJJzdZ7WBwF7/58nhoO5LI+PPnqVLjuntcpTYs1BpWjywC6Ortg09FbPn3trbcno8EXcj/UHACMGzcu+8lLj81oXTCviVqE2YpWYY779WuCIw7ZA5r69afdP51HAKgHP8vCH9r9kfzzfJrQi8XucZce2ekUAEQLQMSfpv5MGCD1AEICOkQcWiGAjUw9uP/mmi7Obt9bYOiRJFRQ6Dk8iMFAY34VA1k7PJ2jpEmN8VvAR2AhBylpGQ6vxPilT2M+m4YHn/0Abn7oLQIA9ACqAQDTf4cddczBJ5522vjennatPa/mAAAv8DknHH37hBeeOQA7BFXXACBBNXLE2nDg/t8HL52FTL6BvtH405k8uGmU/aLwhz0A5BIIAOKuIaLrRxdXC3443687P+f/NQTAWoGSaQpCACBdLeId1DK4bsZe3TNwSS9p5S7fXZKroYJtIvauLyGLgBYr9sSbsV18MX4iAylfj+lSFQIpcFjvJb2RGQOYaEWwxUnItz36Dtzz1PskwUavTTMBVHVYLEH/QYNnnfyH84aNGTMG2y4lX0kIwCtw9w3XfueWv1/6UoSKXUM0xaszYEA/OGrs3tDYty/42XpI5+rBy/Duz+RfBjCEYPcfjR9BQAyPXAoWATGxhyAgegDhBOJqQAEGJALxOfg6ipFFNNNjLFzt8svndrP7xQGCnlJ+Pbv93YAh3q55AYXAYwJfDFqFPxIC2CnPODQwTf2MgIcIVXX7EWTx/Ulq7UA248M1d74KT7/6MbhenAXQcWXtbe2w5/4H/PUPF15yYmL5C1+BxblLVqZ1dH512L6TPv5o0gjfz1ScFwICzhD8r5//CFZfbVVIZVDxVw9eNk+G7/lZZv+9NGBpMXa16REAKA3Ixq81AXEJMNcCkBxYjV8zAQYAtB5AiUDrML8uHCB8WMzLWqE3qL7MC0v7CU1phwr6s4AAF/uoyg/Tc0Jw0s4vP0tIoPqAijoICgHs+F9DAazP8OCSm56FNyZ9SWnAErZ2k/Zg5VIZhVpdJ5x96hr77HPYzJXpxl3a57KYd8rS/vjl9343XXnJf42/9sqrM7kcb1xyKKzmBzj8kD1g1BYbQ8rPgZetIzIQjd5L5zj2R/cfU4Apj1vkitEREU/GL0pANWzd/e1HaQ7CnkKlFsB0BqLBJD35btWXzk4NLv66xh+xJDqAKjAw6Typ8jOqP+rDBiF5OgErIFUPYMKAWAUpvJ8h/zgE4I7N+JZ/vOZx+PiLZgoJVAeA7n9Hewds/p3v3HX1P2//0eKvRG29omYB4MADD3T7luZ/PnP650NRzadfWP+PZNKu398afrjX9wDcDLgZAYCK3R8BwCUNAJOA1OZS3Fd0Z1kIVBkKWJwAGb94ABomUPwvTLnpC2CKFCpcgIoLt7g7fm/ucdnNTTrSfk0FQWgrAPFJkt+vKACSPgdk8PHPxiNQgNBifikuUgCINQDUlJA6LrV2FOCcKx+lxiA8l4HHu+GMh5TnlY44+mcb/PyXJ0/pzanW8nNqFgDwol91/u9/++D4W/6UybIXwN4zp/NGrr8mHH3kgeDnkPirBzeTA9fLQMrPUOyPHgCICEg9AO3XRzc5kV0IANLwU4wd3X7tB2h3BaL4X70Go4kXPby66KQzsKXAVZdPLabiOb24vY0MYCHpvh6M3zT8IJfHzg6Iys9y/Tn1J8w/npsAARdMaTigj1XHYMQ/fF0oRPM9+GxGC5x39b8p/WfagwcRtLW2wS57/PDu/738yv17ceY1/5SaBoCnnnrKu/nicz6bM3OG8QLQxtDFbGpsgJNPHAv9Bg6ClJeDlM8cAH47WPwjGQAKAYQElCZX7AVIGKAdf9gbiNuAddcBYCZA+gJgW3AplTXdgWy76EkCXOkSLOaN3QsSsJrso7hJ/QMLAMzvhNQTApA1AJLmlHQnpwOVC7CyBgRIjEpG/iuTmhAAkADEqceX3PAU9WDQFCDOK/C8dOGya/6x3oajR3++mItQk0+vaQDAK/7Xcacd9cQDd1/nZ5gMxNsOSSUsAT725wfBhhuPhDCVARdjf2T/0Qtw0xz/UxbABcextQBxGGA6/dihgAEBqy+gZAuo33V1JkBZddMfrDcioMrL2tNF/V4IbAAAIABJREFU7k4rLGL3t4nCHpl/LQ7ikMCkAMnoxdBDnB0gYYDlBZgmKKYjEB8LOzTaGZjjf/xdLpeB+56cCLfcP4GagWj839raCnsdcODlZ59/8fE1ac1LcNI1DwC4Zicfvu/EyZPe2yiT4VAAPQC82fbecwfYe8+dIXB8cNJY/YcEIBo/5v8lDEAAECKQxUDkE4u0ld16o/RTXYCWCUtH4Lg5qD5fyoK1rt4QgdW+fVWT8KXBBVjxfff43wKJardf4VNqABi3tMehtfNLqKNEaVwbEKsfeUSbBQBaZ4HXBbgS8Mp/PQvPTZhCPRgxBCh0FdBbm33mhX9dY/To0R1LYAs1+ZIEAADgzpuuHvXPq654JYxCD6v6sKkHAsAGI9aE4449jDQAKT8LKS9LjwwAHjiaCkQPgECDS4Lxv1j7ro1BhOm3NQEGCHhACBGGFAZowwyrQaho/HlX7OGyLQ3jt9z6CmvokRC004P6s+oXJObXwijc2WnHR+ZfuBENA8RD0L6AFU39BVA19tcMAI4GO/dvD8En0zQDEEJnVyE6ZOyRhx5/+pm31aQlL+FJJwAgC3fp7397zSN33/7zfEOD8QLqclk4/TdHwSrDVoXITVNKEEMAwJ+NDgCNH70AF30HcVMtL4BGf1kgQAIhEQAJMcgeABqI9gdkwozCYGmWYerte7xi1i/j3Nli3hLV6cZFpANJ6Wc/R0uAVQBkdThG19/E/+Ll4L8l5DGdgW2vQkaERUL8cSaA27PNam6DcZfdD+2dJaofaG1rh81Gb/nYlTffvttinnTNPz0BALkFoijyj9l3l4+mf/HZ6tlslthmHCU29tA9YJddtodi6AkAZGnn11AAHDZ+IwmWdCDzCVZhkLT/5rSgGLw0BKkoCBIpcKwI5O42ccMNBhfTusgkBb7mUi52QxA1bRsUvgYQjOyXj5NJUBUAyc4vOz4ZOwEi/z6ugLTmIQgBENcACLA62AcgDS+//QlcesOTxNV0dBagsW//ljPOPnfdrXbeeW7NW/RiLkACANaC3fS3iza99+YbXy2Vimkf24eHEWy2yfpwwrGHgYONPyQEQE9AeQBMBRIAUBggZKDU6JtsgLL71fJgUyuAqUFWDpJxaNWcaQ8mjUFwvl71Bf5a139Rl7c7FWjevirXXwlCAkj6ZCUqsSuPDgKhoh4W/nBaNOZDKkHAlj4LD6CiKg0BSP5LQwUhl03DDXe/CA88+Q4BQKFYjv7rpOMPPOxnx9+5mPd+8vQeJ0rU+LL89Q+n/frf9919Ifb6wy6/+VwOfnfq0TBs1aEQOj6kiAjMig6AswFEAlrZAGarq0RBZNiqC4gN3qQG1UMwisA4L86pdooHKlpk8aWy3f9FGXwvLm5P6b4KQ9dd3i4O0qq/uAlInOLTBqkIAqp4ZFLQtAjXPoGY/qw4JSmxpmIrHtaK53veVQ/Ah598BV0dXbDDrrv+47xLrz6yF2eWPKWHFVgKd8zKt65nHHP4DW++8vLYXD5P6rIfH7wH/HDPMVAMHAoDHCoGEi6AUoHiBZjSYLxR+cso37T3v2YFdCoQxf+iESCj4NqBmAisbpTRA2wvLQLQHHTVDm/6/Vm/t4DCuPya/aAQwDJyowHA8xQgUPefWoHFA0QMqAkSMAGIu78Dad+HL2e2wLhL74V589tg3ZEbvHP1+Ps2k1aBK9+N+C2cUQIAC1nk048+/Pk3X3tpO1QJrrfumnDar39KzUBQGsyZANQEpAE0HYhDQZxKURCnzoUM09hXAIA7BgsfIO3D9HdcByDKQNHVx/tudy+gIjAwV3RxLq3N6Fs7vL02FWm/KoCQQR/s/lvTjYzghwEtNISoin90GnJVWbEQgFwIxACA35j/f+TZd+Cqm5+APn0amk8bd/bI7Xbbf9a3YCcr7Ucszl2y0i5CTyeGKsE7r7rolU+mTB6FLcB/c9JPo003Xd8phSkWA3lMBhI3QB6AiII0HajbEhmwJXe1PAGaGVDBC4hsWIuJtEMQN7k2YQBNLK4iAnuaD8gRwkIucUWMX70Cyg3EOv8KtqAH6W/s7fD5ouCH+Yw4BNCCJ/2dyoMrpMR2/K+NVqQACNuv/+8V98DEydMLxxx/zHcPOOqkV2rqplwGJ5sAwNcs6tVXX+2//fi9r0z+4IPNd9ppGzjxF4dChGQf7f4WAKguQEIBuzowHvTBhqFTgONW4LH7TzUCuktWZQMcVcmZvgP2LlytDvyGd4qt+uNARuOZqtSfejiSriRgiLv7EAiYluexyInP0RqDZvgNkVGZ1J9oKxwH0hkfPp02C86++M7wwCN+MvanJ5x6yzc8y+TlCQm46Htg/Pjx7uuP3PHY22++/b1zx50AG26wDpSClGQFsCW4Tx4BPrIeQJuEWtiqQhrxBhQEtAw4DgeEJCPBDI4Ml045WhykI7gWWiKs58Of3Rt0j3f27mFAxer0KP+Nh3ky16FFP6oBkHSf4T3EIzAcBzY/rewDqJV/setPxRmQy2bgpjufjjr9oWf/9o+XnLvoK5c8ozcr0Jt7pDfvs9I/57wTxl7X3t5x5G9OOsLBpiAoBmJBEKoCpUCISEAmBDV+rTBD3elMhxzlASRDYDUQMTUBpl++Jawxq825hvifS+FyVqv+zNv3IANW8g5dfjk3bmnGyj+T0iQvAD0DHYCi04/EC5Bz6Nb7T+J/HLs+b3473P3s1ItOveDvp6z0N9u3eIJL4Y75Fo92OX/UJaf/8ojNN1rz76NHb5QNydAZABAISBdAoiAhAiktiMsrA0P02I2hWEQYSYDj3gEmZ251zTFS2QqX3LxpL/f73ixgD0VBRg9k1/7Lz6oIFJcem30QAJimKApuqPwTVaT2BbQGoCCtwcQ/N1hV5R/+G2mV5g54aeTuJ2zbmzNIntP7FUgAoPdrRc+c+Oj/HbzqKv3/lUpnHawKJC9AOAANAarTgnFli107H/MBWjBkQgHRDMQkGe+UXGdkKebs3bmnEuFen1tPu7sNLtYbGYO3W37jccW7uj3ngHd9FASpJNrK/5sBoab0z2L9FQRo2HoQ1a/ynaGjf/RGr08peWKvViABgF4tU+WTvnr97onZbHojKhAiEODdX2sCMCOA3YIICKiNVdwyjL1dEfXY9fDSOIRKiLV2QEuDjTJQ4mwtNtK3WshV7EE32O1sq4ei8BOqJMDdMgZKaCLlV1n3zx1+xdU3A09iLoC8G1MlqOImzlZoCFAR/+NzswOeGLLNj3degkuVvGQRK5AAwBLcIl+++eR2Oa/9GTedcUkPgAavIiDpFWi8AQoLWMFWGbFL5xzaOa0WYiZNGPcI5Oaawq5rZYCVimND1/oAPaHFubS2B6AQ0JNXYFf9ac0/7/7c7EMzABb5Z3VF0uGnFcNPqMkR9f6t2P0ZNPFYvGKqz1obDdp814+W4FIlL0kAYNncAzPeuu/xfMb/PikCUQ+gTUFEGky6AJoarE1DGQRMXw/1AlQn0C1mlm7CtoZAdk5KAsjsgHh8WJU7sET2b8f/lVkB4ymQ2454ZHfwqWr4gYBVkf6LyT9O/4kHQaAlB6oegExZRs+JKiLrh944ePSPfrJsrmLyrotzmySrZa3Al68+OjybLU3205ksCYJMc1DXFArR7zQMEC8gnh+grrbVOZfcY7ujsLjLOizEgIEKg/SAvqaoZ7Gv2sLSgXanH+n+Y3f71XJfKvMtc+cfCQFMD0DN/1vqRjo8Y/wSBhAIYGum7Dw/U79Gv9EHzV/s00he0KsVSACgV8vU85NmvPXAhfmM92uWBMcFQaQFUHGQaRtWxQXohq3Tc6Q9tk4GqmgTriPDqDdAHH/zVKPurH3P0uAezqHC87cNv+dMAM09FA6D23lXyZxNiS/3NgxJ5aiSZrv0V49b9Aoq+UWzR+MnryACp274CYNG7XXZN7hEyUuTEGDZ3QNRFKXmvPPAZ5lsdlUi/ogHQKUgtgvntmFcLuyb1uE8QszK3pNB6UDQqtJZ0yTUMh7TLYgr57h9Fr4JTyau/OoNvi/M2HUKsGYuLDVghaCJjznu869Tkax2aAQCWicQDzyho5ZUaUXqD/kOv8/EwVv9eNOk0GfZ3b/kfC3bt1/53/3Ll+/apa4h/3DKT7t2X4CKlmFaMiwZARpHxr6vNUpL3HotGjKDM+IwwB4bphN44xoBVexWNgvp3RX4msYfkhHg5iZWs0977BeVMrP+36Q0Nauh9QAaxpgMg8b/DpOkFAbw7h85TiHI9tt86Bb7T+rd8SfPWtIVSABgSVfOet1Xb9xzS76u/jDyAEw2gHd+TgnyFCHNFMStw6TCvyK3LuWxdiWdZAq6dc8hIjCepEOH1FsnoBttUPWLCumvin4w6SfS3YoUJvf5w1ifK/5E9Udj0cQ7MEVR8jmm378O/GThFL42VTf4goGb7/PbpXBpkrdIQoBlfw9E017MzW1p+SSdzQ1mNSDWr0tdAA0QwTHiWivAXYMM8SWHxw0/tJTWKhwi1lzENOpqqxhIyTQCAWmmQSCw5KRgzPYLmhj5svxFy30r+vwLeWm0DLH6z8776+BQDli4xp/4Cnwk1j8EJ9Pw0cAHPljfGTdOY4VlfwFr+BMSD2ApXfzPX7xttz59+z2Y8jxXQYBlwUgIxp2D+HdWB2EFAFMUY3XXsTsEm9JaK5auqC3QgA5fL7oA+9zs6cU9nnMc4+ufTaGO6fNvA5TE9drrn4qXtONRPPuPx3/pkNB496cASBp9cr0/Kf4KYX7I6CGb7vbuUrosydskHsC3dw9Mf+Oeaxoamn7OhUDcxIJdfw4DmBDUUCAeKR4LhGLjV6Ox22Zxp2AV22hGQPvoadsw3bnteKAa57/GQ7Bdf9XqY88e9VB0iKcZ6yWCJXL/uasxjzgT158eVfHHez+3+hNxFI9iotAlzPY7c8jme5/37V2x5JMSD2Ap3gNRFDmz33novVxd/Ugi+KggSEFAtAIIAlRIhF5ADAJ8GBYA0D/VeKrSbcrCW3337fRcXL//NTTvQsMEyxPQwiVp8aXlyfGIL3X1hfyrSPvJMBA5J50lyMYvbb4EKOl9vfpnB40+YKeE9V+KN2Qv3ioBgF4s0uI85ePnx6/Wt1/f9/xMtj6uaJMpwpIaJK+gYpgIOcRiw3GaTJuJMNNvtdqyh2lYcwOwaYjJCuiVlbz9155DRQmwcAjmd3GKsqLKj7r+sMvPcb5WM7KsmZqBqGZBwU3lvlIhybMUIoiczCw3bFi3/9Z7LFictU6e+81XIAGAb76G3d7hy9fuPrS+se/NKddLMQjI7ADVBKBnYLICaAQMAJUy4UpX3jTcsNSARJoZcZCSiFrLo253D5mBbqkCO1xALpJBiOQ6NLJbwUdc+4rBpzLvjzgAq+GHHqdl/ExDaI9/Zv8jSJUjf8BOgzff9YVlcCmSt1zECiQAsIxukS9fv/eyxr79j6MyFxsEiANAYlAIQm0eIrujsZdqI61g/nl3tXUB8RRhywtQRDEhf0+xf9XvTNwv4Yco/uIZfnaPfx1wYuX/K0Z9xbwErwF6/8yN4MQf/Gs5VX/aKlvs8+dldBmSt00AYPndAzPefPCZhqamHXHXw5g/wuYW1OLamiVgSEFWCHbXZhnJkJEBk7EbGa61QxsOwezf4lt0F/p0xwQ7C6DDTavDDqu5B4l/qtV+khmocP21UlGAkNaCBVCFVN34YVvsc/Dyu0LJJycewDK8B6Jogj/7vXkf5Ovq1iKNO22BVToB00cAWXHpG9CtuYew51Zn4ApREOrmjTZf3XlLIGRKhy1X31x5Cxyk0o9dfy5BNn0JrVFeOu1Y23zFrr/0MbT6/NHH6KAUfETyMwyhBNkJQx58e6sk378Mb8BevHUCAL1YpG/ylE9eHT+kvr7/e/l8fT9i/bXYRWXBoh4k7YA2D6HKQeEFjE8gk4bIhqWCEMU/duNQM5a8smiH30t3eOtnc2J2Y06ZRSgxvHH9q8uVdb5fhUhJOhdV9CmMRT8qfS5D+nPwWzcYsunY9m+ytslrv/kKJADwzddwke/w8TPjN+43ZMgr6Vw+F2sEcOnRHeYCIk0L8qN8KwjYXb8Nq69uujU5SDMF3DDA1BkwPyCuuPX6igO3iD8z3EMafIYyrcjs+Mb1txR/VaQfHYLKfcn7QVALoRymWuYV2zYese1PvlzkwiVPWOYrkADAMl9i/oApL4z/3oBBQx/2s1mcJsKNLyEFkchgSThUAQaWUKZbzRbv5uymW6SfSQOy604X104Nqidgg4g+p+J52t7bYv0tfT839dBOv9L91wIc5TEIcmSwp+NEUA6hvbPsb7X6d/Z+71ta9uRjFrECCQB8i7fI1JfvOaD/4KG3er7vphyXmXAzAVd6ChJLHrcRM+3FdROvKPuNpwXxji8aAh0iomXGpqKvOjUYF/lwYFBd4y9iHmvHpxy/3bNQQYg6BKnUlxug8X/ozURQDpyuzsDZefUt90nSfd/iPbeoj0oAYFErtJT/PuX5Ow/uO3DQjbn6PmkT85tGGMwRsIyYVYJcLy+XqXrMl1Wowxu5DQDqHSzEC8AXmNZcUvuv3AJJeREMlOUXsY/G+/awz4pj0NxCrPTDQy4HYWFBZ3mvtbf50eNLeTmTt/uGK5AAwDdcwCV5+TuPXrf7sLVG3pura/BNIYzkx1U+rFwBgYGKhKpDAUu3T401aUO3Y381/mpS0Jb7xqIfEgAZvUGs6SfFnz3dWIqUYqmyeBbipVBtAzH+LpRLhWBBW2Hvtbc/+KElWavkNct2BRIAWLbru9B3f/XOi65ZZ5Ntf56rb2ASkBphsEhGC4m6aeYX9m52PwFTFCguedUOzYQgO/zkAdBP2nG4Ou2nIYDW+Gt7L/m9xP09uv6OC8X2BfDZuy++3vbZm1uPGfd0eTktdfKxX7MCCQAsp9vjsQvHnphpHPqXjcfsC7mGRs4IaHGMKZax+gbYswWqj7mieYfVGUjiejsjwHRALB6Ku/zEcl+e3iuTi2jEVzzWi3+2Cn2qj4Um+brQ1dEKU154AIJS4ZEdFqyzZ5LvX0432iI+NgGA5XRdnvrr0T8utHfcmB8wLLXRTvtCrk//GADI5RfFnJTNVgzOMMesqb1KOa/hC5WW68kLUNa+otbf6usvXX7jJqXx7k+lvnb/Aj0eKu11oX3OdPj41ccgLLRBuk+/e7eZOWz/BACW042WAMCKufBPXHH8rtC14P5SOUz7+b6w4U77QNPg4ZIViBWBFBJQPYEMyrBJQfvUZGdX5Z26+XExoHID1mgxivlFr69txypGmOvAD2nwYTwD0R5IAMG7iEM9D5qnfUDG7zoR+H4aMn2a7tjiqCsOSsp8V8z7MPEAltN1ef66U7cPW2f9u1SOsqVyAFHKhxHb7QVD192I+wpqEZF4A909AFsdJDG9IQklBVdBCsaEoF04xO29hcTTEWQyn4B2ehIDYcWf3dlHSoQ1xHBcSDkOzPjgFfj0zefA913IZLPgeS6k6/uO33TsXw5JAGA53WiJB7BiLvzLN/9u62j+zCdL5TBXKgVQLAWAQLDGqO/BOlvsAK6f4QM3O37sAVSkBmX3lfaicXAgvfUX6gHQHyTul5Jf7j6E5KDl7tsDP1R2bHX2RaYf+/9/+upD8OXkiZDNZiCdwe80+L4HXr7+zo0Ou+TABABWzPsw8QCW03V5/abf7BB0zH+8XA7TpVIIpXIIpSCCYrEEA9faCDba/geQqe8rrbOqhmfapcMGALjHHtk1koj8A0QqCyYnwa4c1Lp/LfzRsd4qLdYMAOsBCCwMUEhxkutBR/MX8MGz90Fb8yxI53KQSXuQTmcgnfYIAFK+//D4jy7da9w4fIPka0VbgQQAltMVeesfx+/qhOHDxXKQKpUjIC+gXIZyGaBUKkG2cRCM2PYHMGSN9YwoiMS99J+Ig2xhkHoK5u/KAlQP9pBd3wIEjgC4zp+GkNLPIZiGnuQVyO9Rb0C8RATT338JJr/yJIUImVwW0uk0pNM+pDM+Gb/vueB7qVduev+SbRMAWE43WhICrJgL//6/TtkvLBfvCkKAInoApTIUiwgCAQQECGUIwIFVR46G9bYcA9n6Jqmjl7CgSiFYGRZY/EAcA5gWXaoF0FbkLACMY3wuNZbSXuUIRCWICsVi+1yY9Mzd8NXUjyCTTZPL72fSkEmnwc/4tPtj/O+5KXA9912nb37LNceM61oxr0RtH1XiASyn6z/1kQuPKLZ8eWMQOUAhAAIA8QD8c7mM+vkASoUSZPoMgBHb7AzDR2zKY8bYu4+zAxVcgfIGemJVzUBINBRLhrneX918EQdZE4lVMBShRDkowfT3nocPX3kKCl3tkMmiy5+GNMb9vg8+7v5pF/x0mo3fpQYoXzl5b4vVdv3D9OW01MnHfs0KJACwnG6PqfeedWZYLv9PGERQQkMnwy9BqVjmcADBIAgBW+2VSyUIwhAGrTES1hm9IwwYvjZ3FLZqBNgDUGQQfUDFuYnqz27RTa49xQIMClJQFDcgjbiTUVCG5s/eg0nPPwBzp38JaXT3hehDAMgg4UduP7r8Pu76AgB0HJ1OrnHr4Tv/5p3ltNTJxyYAsOLdA58/dM51Ybl0VDmIAEGgHIREAJbLYvwCBOQNBAGUwwhKxRIZ/qC11od1R+0IA4evw70FzZdVNKSFeRbExzJg0f8rAJBXwCRgPFvMgSgsQdvMT+D9Z++HaVMmged5kM5kIYNufiYDmTS7/hjzp30XPN8n1x93fhd7AKQiLHgGJ9vwo6HfO+WuFe8qJEeUeADL6R748qH/eS4Ig+3DyKHdPcS4Hz2BEnsAHBKoR4AhAXoDmCnAn5GsAxi05vqw3pbfhcGrrQeOl5WUofoFcWWe7vHmVKuqCHnMOIICDuiIICx30I7/yZvPwecfvkcagEwmC17ap5jf9zOQoXQfuvyS7vPYA3BdlAKnuKiRfJQQj+33q+z823OW01InH5t4ACvWPfDFU9es6hRmvh5FMAiZfZy6g8aN3kCZMgEhGz+BQRnKRQSDMpTob2UiCYMggCAoU2au76BVYcjaI2Ho2htB36FrgpcWMNCZAXZHoBgFmEOQnH5YLsKCmZ/ApxNfgM/efRPmzZ3FQh4k+Ci2R4Yf3f0s7fr6Ox/TfR6Sfh64XgpcGvTDPQD4vSOsDbhnyC6n7bdiXYXkaDRgTFbiW16BGc9euWfU2fwAtgenkvwIAMnAEF39IIRyCY0bQ4IicQKYHoz5AQ4T8LkIDmGIIUQAAYp3AoD6fv1hyFrrweDh60DDgFUhna+DTF0jgQJ348VsXwmKnW3Q0TIL5n7xMcyeNhmav/wEWmZ+BUEUUirPc5nUQzkvPZKrj7G/7Pq482OaD59Lbr8LLimY0QPAzwkJAGh2gQOfZjOrjWra4cct3/JSJx+3iBVIQoDlcIvMfPbSi8JC58moomMPgHP1QYjfOGU7ICPHb/ICiuINFEvkGdDfC2UohwgGDAL4XJzSQ+EEdfCNIOWigWYgXdcX6urz0NC3HxQ62qB1XgsU2luhfUELlLq6ICUxu0u7OJN4PrH6vOvTI+36/IiMv4cqP8r1e2T8NBCZ2n9xwMHtyPg4nCgALz/g+wO2O/rJ5bDcyUcmIcCKcw9Eb99Y99Xsr15xHGdDJPRIU+ekxBOIyJiDCMigydCLZSiT+49ggB4BAgMDAj4G+DcMBZAjEE8gDBAEGBhIxYdegvYMEDUf79TYdQh498ZvAgBW8OHOj6QeGTzF+Uz24e8QHCjP73mQch0i/HDT174lvPOzopB+DsvgZer/PGCHX5664lyJ5EiSEGA53AOz3xy/ZzT34wfCVMYMyeQpOSnJxwN5AmhAyAkEGPcTEJQEBJATwJ0f/12icIHShMgNhAwCIYYINJ+P1XtUyENORtz+G8MBIuscxzJ+NGw0cvQAeLcnEEAwIB4A/84iH3wtegouNTXlib8iRBbZsDUSPAog60ZT7l2wzffH/nD7z5fDsicfuZAVSEKAZX1rRJHzqwe+GFp2gs3CKNruuNxjhw3yWlcPwCcAYHmvlP+KCYnylmN75AeQF0AgwF2/xBwAEYLFIv0e+QEECQQBfA0CAHECSAKilsDU/kf0meSqi9G6LrvwmE7knV0eMe5HMBAewLj7Jt5H4NA5f0r44WKqohB/lPqCKIR8qgi3fj54+jWfrf3KgHz0ku+lXk6XU+/dfvK2zcv6EiTvv/AVSABgGdwdvxo/LRfkg83LIYwpBOF3S2G0eVs5NWDT9Aw4vu8LUCbjl97/NAREGoDgzDxt6S+1Orh7o0eAOzoRhLjTk/svYEAhAIYCHDKg649ZBHw+SnrJC0Bigfg/Tg1iyIE7P3IEFL+7It3F3d33wcX4XoEAQQBDA0rxoduPpb+Y5mMQSTnsrXDxoe762ltQBoVEEXhOGb7s8ODQF9eDQpCCOt8J0ynni4znvpZ2nadCiJ4f0DV40u3jNiwug0uSvGXiASzbe+Dml+f2+axY2GbGguJe7cVoDIAzIopCDwU8nutAfV097Jd5FbaASVB0MjIhyB4Coi3CeSoQ76koxkFOAA0ZU39M8KGrT94AggHF/8gLICDg3/B3qCtADgA792BVH48J4+aiaKyaq2fjRyAgJl/cewwDyL2X9F7M8qOnAAQeFPJLybHG/JjzN6PEtLGIFBYhOPhQgqvnbQV3fJSG2XObwUs5kE6lwHcAfMcpuA68n/WdJ4Y21T0ysCn12mWHb52MC1+2t223iRPL+ONWrrd/6KMo88bMGVs2twcHLigEe5TK4douWgft3hFkfRdWaczRd1POg+/MuQPqi7MhdNNxD0AcFS4hAE8SZlAQHt3yCJAPQDJP4nzyBtjV16wBuf+BAAD+LMChen/a/WU0GU0iJPYeNfuSw1cw8DEs4NCAPQRR9hFwsOETPNGMT4vsk8lE3C1YvACdMRiG4IVd8HnTVjAhsw2QtmRFAAAgAElEQVRM+vgLePa9z2FGczukUTwEDgFBGtcgipAW+bgx7z2+alPurlmd7S8+9pvdkjFiy8B8khBgMRcV782LX5u+6tz50QHzisGhpSAaFUXg6m6Ihu95KVitKQfD++Uh7/Mumy/Mgc1m3UGtsiKcDGT6/8deAI3Nllp//VmkOpQlQCYff9CQgLwCAQEKFYgIRNadCUAm//DfWhLMJ0sggCQguvKUv0+BYxm7R8bPE42loIeMnfL71GuAcvvG+KWvmLQUFw6gGgSiENyoBHPSQ2FCv70h47qwoKMAT0/8DF58bxoUqfmoQ8CRT6Ug66YohAnCKPI954N6372/sSE9/sG2Z9+EceOS3gKLed8u7OkJAPRyIaMocv/8wswtmzuDo9pL4b5BCAOl64YZyFOOIuif92H9IQ3QN+sTgee7QKKa/ILJsHHLIxA46XgOoJJ/ZhCItgSXvvo0VQdBgcyWDI6FQ2zUvMOjR8BGj54AP0dif2rpxZE/zQ0Qh48AQIDARQ8kJak8zAqQV4C/A07v8ZZPaT7N8dsGT2tA5cPxVCHN/1d7AqkogILbAC/12xfKqSx4DmoVUvDW1Jlw9wsfQktbgYAFJdEeOFDnpyDvYopUQC+IChkPXsj67i1Oyn3gxT/sNquXly95WsIBLNk98NFHUebhljm7frmg8IvOUvR9cCBtBu1SMR3H13iTrtqUhxGD6iCDelhg46/3UtASeDCk+TVYp/VlCFJpmQNAyhkZEIpGppOA+Pc0N1DHhpmQwEq0kefNRkfegRi7uv3c2ltMn3L/WijEJQM0kES8APw83N3R2NGTIY+AnmOl+IhEYIWf6SxEskLmGbhhiIwno92f24mbRiI0qzCk8GdC3x9Cl9cELnCWA0Fn6qwFcNPj78BXzW3EMbCXE0LGTUEf1CU4AgIEfgSJ0xoy7vhV+2ZvvLP9+XcTr2DJ7u/EA1jIun0URZlHXpu97/TW8vFdpXAbtBFxoKlshmvouUsWsvOr9cvDugPraFfz3RT4KYAG/D8ngtkFF9ZufgZWaX8fAqznrxj9ZY8Ds4eCIBDIAFH8aBkiyiMA2BtAmw5DdpspPBB3X70AziiI/2BhgAkD0CeQ92VWP249RkRfSqcNaY5fGH/WE4vha4dg29it+N+EApIqdD14s2lPKGT7gQ8YqgB0od7BceDzOa1wzUNvQktrJ6dIUeEYRICFz41pF3JuyqQ08bRw3aMoaq/Puo/WZ/wrn5vU+jTcfhBXSiVfvVqBBACqlimKIu+y1+bsPqe99JuOUrgD7oZCnsvwTNz1eSdGo8M+fv3rfNhoSANp4bOuQx5A3sNUF0BHGaCl4MDaLU/CwI4pUEbnlhR48RSgeDy45tX17xR4s3dABqx/t0hCKzxQUOKe/eIh4A9VMwVNKCBaAAYadvMpV0AdvzhbEPcIsMg+fnMGgYpdvzr9x1oEHSFG+OJ68Hbf3aGc7Q8ZB0EEoLMUQXsphLLjUjhw47/fAqQENKwgbyCKoI/vQoPvmqwGAx5mScg7KOWzqaeH9a27fNqb8x557/aDknRiLyAgAQBZpCiKUte+0fyd6W3FMzpL4R6O46DIzTTapDS37PgyFoN2JzSSTYb1gXqf01k5n3LcUO87xG63lSJoLgCs3fw09OuYShoAbvWv7D+TbRwCWKPBhCSsBArV26puAHd/icw5w8epQ5L96olJhb91pWMAEINXbNHZAqafCLv1rOtXZj9uGqptxHhMuQ4VsXd/nScgNQH4Rm4G3u23O0C2EbIuvgagM4igrRhCayGAkuPCbU+/By+/Pw3SHhKBLI8mwjOMaJ2b0p7xwPRcyetBjyEMw7q0+0zOS1044dPio4lH8PUoUPMAgKz+01M6h704c/5v27rCoxzHqauUt/IC6o6PBocAQL38gggGN2Rg3YF5Mr6cD1BHO78DDWneUVuLETQXHVi9+QXo3zEZgkgM3Tb6qowAAQK5/TwzUGcHGvGQaQDKEmIdGqJgIBR9LM5XGbDJ3ceGr/IgSelL30Ct4mNVkr3Lx8NDtXkobdUyP6Aq/Ud1CDhYlH+PoqFSugkm9f8BZNJZyLgcYnQGIcwvRDC/K4RCBDD1q3lw7YMTCGBNHYNqIQgEPGhKu1zfoCSnhDp4oUj5GEZlz089OqxP7oKn3FefSziCnoGgpgEgiiL/8tdmHz6rvXx2OYQ1fMpH40bMj7FKgl1+LttFg3DoEUU+6wyogwF1PsWpeTF83P1xp8Kv1lIIc7pcGDz/dRja+haHAOTK20CAXgCTgMYzICJOgcAOF/TneAQ3Gb49SlxdfoyjhTOwLz//WUkBlR4Kh6A7foWox2b4dZaAdhBmPoCBIZb+8mwBa6owAPEjrdmhMKXf9wkgsx5+tgOd5RDmdYXQUgihrRBCVxDCtQ9MgM9mziexEBKbZOiS+cB1b0x7FBLw9RB/RzwYokeIoEXhFBTyGfefI4c0nnvn6TtP7YVXXFNPqUkAwF3/tnfnrj+5ufSnjlL4QzR8l9hv3LWlsEXjYQ2DyfiZ9cfdH1N+iBAbDKqDfDoF6RSmrRzok05BfdqBOo9Bo70UwcyuFNS3TYW1W56xAEBdfwYDMnY1eis8iH8Xpwhjj0DrCGSwKKUNGQzYdVd1YQWaxW2/lNnXOX90TpVsvu0BaDxvwgEzTlwGiVqqP0xLIgAwT8Bpey8Vwsy6DWFG02ho9LFAiIm+jnIE8woBNHdG0FosQwgpuOXxd+Ctj78CvDYUBmjzUlQ5irvfP5um98DQgN00nYjM8RADA/ZZQChwZgxryvzhpanFa5OwIMa4mgMAJPn+8vLMn85qD85NOc5glOlqFxt+ZMksV7dhPj7e+VmMw0CAuxCa2IaD85DzXMhgyi+dgsa0Aw2+A3mf89ed5QhmdTlQ6myFkc2PgRt00RhwHv6pcb+kACv+bQOCBRbo8mv9gKQL+WCVIOSwwNTmku33cJl11xTDiQ1fU3nSJkyHgaiiT6YDdwcBnSKMbj9PFuJSZOYH8HgQYD9o+h4EdYOhj4cpPs5SYJjU0hVCc2dAXAA++5bHJ8JbUxUA8G3w/STdKY/odQ3EuMuMPrC4DzO9iMGPCdsQ+uT9uxpz7q9fPn+/T2tqq1/IydYUANz5/uxV3psV/LmjFPzYcx3HQ5GOFLaw8WuBS7xj0p4iLj9V5pHQxiEAwM69I/pnYUCfHKQdgIaMwwCQTkEOPYCIU1zzChHM7QJYveV5GFD4DMooBhKjVQJQJcAc91vpQOEKKn6n3gLu8KolsEAgniOo59HTZZYGoPb8QGH0dV6AmQJcsdNbhJ/u7ur+Vxg+G7/u/qiA7EgPgMlNY6A+7UJ9OkL9P5J2sAABoDMgEEAisBwB3PDIG/DBF3Opu3CEjVMlDOASZwYOrHnAUKtPxufeB+LJ2N0QTQ2E0KJ43VIOfDqwLn3ihD4TH6h1bqAmAABd/itfmbPTl22FK8IIRvpeCjyqg3coxmT3nxl//JmIdWmnjzeTcFFcmktMM+9p81s7YdVcCjZYcwBxABjXNmVS9Jh32YvoCjQMcKBhwUewxoIJEKY86ZiJrrtyAbJzi2fA3gFrBHo0fq0m1MyBJSHmHV+6cqr6z/ICNE1oOgCLuEfbgROpp4NCrHmBFco+4+7rHEHZ9Q0fEKcE0ZPyUgAf9dkWOnPDoNGPiDBFP6VQRgIwJONHEGjHtOn8drjirhehPWTZMX8UhyaG+JMKSTzTAbk0vReGZ+JsiFiJLyRxJKRpECEVpQ2h0L8h86fyF+XzajlluNIDAEp4L3px5rEzO0rneU6qAV1+n6SvDveux444pLNJQUZ2bY3vyeVEAMA2XXzTUOzPnoADbZ1F6Jo5C/baYSSkIIQ+tBsxD5D3+KYvodAFY9wiQEdHO6zV8hykww4ISVPPO7iZ6afFQCTFxW/RDJBXwEDx/+19CZilZ1Xmd/dbS1dVb0l3ks5GSKIJkYhBkR1BxQEEh4DDqMFlRkcEFJ0RFcYwKDOiCOMGDINAlEGIisoeJWEJIQkhgYSQJuks3Umn03tXdS13v/Oc5T3f+b/737rV3UlvIc/Tqaq7/Pe///+d97znPctnacGBXgIVBa21GCnDNP4HF8SGIU7lN8NPUn22LbjG+swIQPNRD4CfOl5c04Z0FuXQCY+MXRi2r7qEqT/VR5BmQsa80OqH2aZ4/wONbugWS+GLX/1O+IcbNofxqXEZb8YMQM6TPT33OYh4SZ2Rq4hRVMo6AYlan2X2YRxxLunRdLFTIdFEvXT1qvrEr379HS/e83gMCU5qALjhwf7YNVsefvvBZu/XKKdM3p5EJQIBYgD0t5TAFoSyh0Joq6Bkxo+43xu/sgDaLeebN90ZLn/eReHUNZNhrNgP07VimCIRsFIMVa3faXYkFNjXKobq/NZw1tzXWejiUl+LxVWVZxGSPD8AoMzFMwQGEh4MqxyMMwWk0ECT+6oB+BstthGFM60aGl3UY3G9zBqQmn/t+bc6AM0E0NXsh1AKnbC/dkbYOnlpqJdLYYK8f1mMsdXph7lWNP75Vj8sNTvhXR/8fNhLrKFckqYm6nXglJ8IgFIbINkI6oOg67y6Rh2WAhSo2ZA25Ww2x4xcNR4KI0rF4o3rpio///V3vHzz4w0ETloA+Jtv7954947W/1lod19UoyGXRWrKERBg2q/KP4EBVe2R12iSi0fTjQpHXOrLDEC9P1eeFZgJFMulcMft94UNpV54+Qu/nwb5qQ5QZCGwzixA9IJmN7AguL/VD2vm7grrlu7T1CJpBbQPn5bhcnzvioKK1JxTDqFEBUQCCoGYAbMBGHkUCU1LUBAY3Eo8ekbBAGgBLr3ntgRHNZ4IenHb8MGMgFYFcp0k2WYvlEIv7KmeGbZPXMQ1/RPlEOr0VbiEuc9FUnPq/WfJ+5fE+//dtbeHqVPWyIQj7nGIIYCkAwUApPKxx0CzZoxSsZIyFFUwMh2FBOMAcqljX4WC4X3rJis/c9u7XvHVxxMInJQA8M+b5y74wv0HPlwoFJ5CtJ49f7Eonh8AoGxgvErLhmg6R5A6iENoP6f8OO4X1Z8y3wwGCgL9YggLi63wpc/eGF7/H58VTl8/FWqFPjMAEgMpE1Aje2Wxq88soNEJ4WAnhMriznDq4t2h1pnl43Nczn32FBZ4IRAeXwZ3sPGzhoBbpynApLw4AsFyt9jVAhjNh3d3DT3o9MuJ760aUJQ5voLU5NMP5bCzdlbYVX8Cq/3j5cA/qUGKDJiuw2yry/n/uUY3LHZDODDfCH/0ns+FxsQYe3/yzjLWDCIgvVe1AJ2bKNmGEGbqlVBlo1a2oI7fagSkyFltW3Y4NowADPbCrnM2TvzS9X/40k88XkDgpAOAD9+++ym3PLT0kWKx8ESi+/yPjZ4AgBagjMOiMl0yfvJG5JkpxmevoGk+jvmd+g/D7+ioLhEG+zwa+6s33hXGFubD61/9vFDotbkJiDIBJAYS3SWCQcoiHZNCDGIDC91iaLcaYWbxvjDTeDAUe7R5bin0qAbA8vnq2T0gmPd3Mb51EmoxkaUHFRxQOZhZ1ap0ir+Ooh8bmI/jfYcfev112jB2FOLR3/1Q7HdCr1AJs5W1YW/l9NCqTjMg1kuBaTpdBzL+Vi8EovsU+x+g4p9GN/Qr5fDhq78SvrD54TCzYQ2POJOxZlmPj9jfGICGBdPVCs8QEK1AmFwUOTNxgAJtvBjEEKhqk7hLp9Nd3LRu8pe/9icv+9vHAwicVADw7q/tfPrmXc2PlIphk8T8gT0/GT2n/FT0q5WL7J0JCEika2ncz7oSN/mA9uuIboACeX8tBEJNADeztDrhE1dfF171/CeFH3vmhaHfbnNNADEBSlOR55NGG3KS8pntvgiEi91CKDRnw3hjZ1jV3hNq3XneT6/LRi1vFAEQlX9q5CwYav7fAUR8nQqGVgzkioJ8XUCmmUeNfagYSMNM4pw/3vaLKXg3dAvlcKC0NuwrbwityqpQLYZQK/ZZ7CuXaI9A6Vrk79yi3L+o/8QCqC7ia7dvDX/1kS+HmbM36iRj2vDEMwAFAo4HZBaCtEMLO5iqlsNYicqDUciUDXXE+4vPZ+1VrwsXTBVRMSn3qNcLjenJ8i/f9ec/fdXJDgInDQD81U27nrl599LflUuF09COy4o/t+ZqzM9inxg/3XS0omKpZNJ9qvaT56e8NIOC1gDwgAplvPQ4Heue+3aEW/71pvDmX31huODs9aHU65oYSCXCZBCUbZDd8mSwB7Xysj7QL4YW/d5ph3JrNky094bJ7oFQ7rc4jma6yvn+khYRyW1jAHAZAowWyzQQ+fSgCoKyqIFIMJi4OShq/yVdGId9kLEX2bvKezqhFJqhFpaKE2z8rdI4G3y12DPDJ7GV/qOwidjPYrvH3n+u2eMy6XavGB7ePRv+6N2fDu3pVaE+Psaxv1T/iZFH5V+0BdQBxHCgF6ZrFe7CFLFQCoJsfwKl/75MSKok9Uow80P1oKRve71+c6Je+S/3vPunP3Ayg8BJAQDvvWXXM771yOLHKsXCRvLyrPRrjF/leXai/Ndh/PytCxyTe68vVX4q8mGDDpQAWymwgIGkBzWFpgMsbvzqnWHv3feHt/z6T4bT10+Gcr/LTGCiVOC8NwERAZIwAVmOAiQkKorW0OJQgZ5oh0KvFcq9Zqj0GqHab4ZyrxWK/XYo9cn0ujKmCxWFnBYkbSBWGFKWgUGBF7eWCcP0mT3oQA8b8kFU3g384N9FnyCwavcLoVWohkahHpYK9dAs1EK3UOHPYLYVaBYChVxIrYosQE091DhFLb8L1PXXkt+bvRDmltrhT9/72fDgYjvMnErUn/Y7jKk+GD8M20qCdRgKHl9dr4ayjimzQSg+FZikBb0IaEKpJmUwPLXb67emx+q/vPmvXvHBkxUETngA+PBtu5584/bFfyoVCmcZ7VcQYOqvo62oTZe8P4ZaMvXX9BLFft74udFHDRLqP8WJXAXIVNY1Bok1s3g4v9gM1193ayjs3x9+//UvCRtWT3BcTD0CVBdAWQFkBnRokIEAxEYCA9XlTZDkv3n+h9Btmq1XoN12+m0+fpGGEhaFjpPHRTkzdd9ZmMArGCAQP0NUfom1aShHt18MnX4xdAN+UiKPgpJi6BTKgbR9AhbmIzTSi/5poQ99LhkhY5wrmqI6iMUOeX75R7n/Vp/SgL3wFx/6fPjm1j3hlHNP412Q+DxsulGfR5rzsBPUACg4gAWQFkCLmLIAhGfoBxAWo9xOc4EYjublwDj/QBiBtEcgQ9AP7U5onrth8hdvfPtPffhkBIETGgDed9Mj59y6o/Ev1Uq4mGP9soh79Dt5feT8yfDHaDgne0weXs0daGjtFeMXA5c6f6T9JOYn78ceX9dTFxN50CasNILo6Z7Z+fDVa28Llfn58ObX/ruwacMUpwdJDMQ/HhpCYIRKXscuJCMgAqP2JMqn6Fy+SN/drdPENx6RigauNLDIl4+p4MVbknPePmY9pO5B9ylkQ0CYIUyZDZ1jZ01A9EU4w7+CPo++IhE8RWBdJMMn79/ucvxPLIfq8t9z1XXhxs0Ph43nb5LSXtrPALTf1P9YA4CmIDQooTeAwg4KAcTmEbJYg4DVPPj6B75kTIJkAIqEALi6Wg0KzabTW7rwtNX/4ct/9JJ/PtlA4IQFgH+8a27tDfft/3i7338mqvs43kfcz3vWSSqOvD9vhKFKHKX8yMhZ8S+g0k/of0fr/FHth9p/MSAxGDZO7biDoyGqyqW/zXbYNzsfvv6VO8LSrj3ht37xBeHS7z0jhHZb02GRCdSINnNWQoDJPL+K1jJEC55s8FZhEbuInhdy7O2XRe6dIWfJ/cCQTL2cIJyafuwnorl9ah/SJEUoICcZfaXk9hlMe4FrKijVR56fjJ4o/2KbBL9COLDQDu++6rrwjXt3hNMuPDs2+WiFX1rwY3G9lgLTh7D4x+BMadcyN2RZBkDHtUn8gvQkCAHdeLpGwtpEFpG2ZKRWwQBEMhQ60+uFPedtmHzZ9X/0U9efTCBwQgLAnf1+9X2feuBvOr3wCvKkRDkp1hcAUA2gREUnNJwjbltNN5ZEN5pAwxRVy3wj3VfqDxagHoBYgEzakXUCy+CUlLICyQoIHT240AhzC0th8ze2hPvv2BKueOlTw8t+9PsCtb+TqDdWKYQx1iSICZBoJqlC211XN97AQpMYNclsuby2hbcu85UR+n3hn61eVcTtwGIrstOPfJj/WKmuhckoS9H6BRnZRdN86V+P03xE7xc6/bDEhk+pz14IpXJ4YPu+8BcfujY8uH8xnHb+GfzpPM1Yi33Q7GMZACj+Su+tF8DNAVhTl3kMmNWIKkcbZOJBTwuFZHqSXlb+bjFPIGETWBB+p27CsPV7Ns285Mtv+8nbTxYQOOEAgEZ3ve267X/w0Fzzd2jjDXh83mWmrCm/YuB4f6KqtB8DLwMNn5BBHmjrJSwgdVo8vij+aPcFZZYpky5uxiw93tAThSkCAFAVDxxc4LLWHQ/tCrd88dZw2QWnhf/0ymeEs0+bCb1Wh/PiY2WaIlQItWIxVMvSlkxCoXT76nAStUIdyS/RAL9AkSd3JWZv64AWtszqFQzxJTLxxVp+bwKoFESp4fei4VOdQ4sYQJtUf+ruE1Xw+q9tCX/9sS+HVq0WTj3nNBlfzrQfuf5suS9fW18FqF2AUgEo3p9CO5oajApA6AVydZDFEJqDbkE2d8NuDZO4N0OJAFKEDhzpfvDcgX7hjsvOX/3CT77pxdtPBhA44QDgD6998FVbD7Q+NF4plGkDDvL8pPxz7M+/i9pP+XfZ1EIrZgsFzvc3tegHTT6Uj5cmH63201gYlX8ivSkxpoVnk3cUFCBQ6W5ASE3RwxQKtDrdsDS/FL72xdtCb34h/NzLfii84Gnnh8laiYU8YjD1YiHUKrIzjswnEFbD/3g6r27FRYRUB3jCO/vJRTLE0y1Ld3cHTTr/haics1Sb1kWwmq/FT1IZSYZPRT00uVeMn7x8uxNCk4p9Ot3Q6hZCsVwMu/Ytho9+8mvh2hs2h6kzN4Q1VOjDG5rIHEE2Zpnwqyk/1/WnAGvnoyCAHY/X1KsMnIjv8TqxZp1i7MRBiIR8aVy6kIeogBHwHAh6hcU79hxlNMaq5Wt+8KJzX3r1G3546UQHgRMKAP73Vx65ePOuhWvKpcJGeH72+uT91fjJoFbVStLoA+FM42CaPIOefiziTqAFrADgev3J+8u0O1GLeA1hSKgqxbh4GEsllbDUqaZsgEDgwMHQaHcYpO799tZw1y13hSeesTa86sWXhcsuOp3DABqBS9+DagUwo4BSaWTsnMJUVsBgwCAgmgH9J98xCnYMS4gYYoSSWaephxfKHzkFsg5SDi2lANS3T2BJwEiGTwKf9Dj0+PoRi6LmHvpJzxdKxdBo9cIXb7knfPQTt4T9i62w8YmbQn2yzvsaQtDjaT3I3aPZB9N/UO6rwEA3AR6erjmFd9wFiC+gsb+p/VqaDHElW9eAiyPzw6xVmCmQ9FmwyqE9FQQIkomhzEA/jFfL7932gZ/9le8CwFG6Ap/75iMTn9y6+Ml+v/8cGDsoPwMAs4FCmKyV+ScZARkMlF14fynoEQ9GhT38UxkAsgBY+Bj/LUtFjyWrQh5RrwFvJKkqLVahMEPHVh84uBgWl5qhVq2GhYML4a5v3BN2b90Rvu+C08JPPvfi8OQLNtKC4u46KqmV9KXMKKASZv7J6TUJD+h7Adz4b8oXoAHQlf3Cp/mcN8IB2Lx5TAU7EzXV2GDwuGYU49Pv3tjJKzKTIo2jVArNdifccue28E//+s1w9327wtQZ68PajWs5zpYGn5Tqo8pPi3h86y/AwH5KDQV9Xcr9S0NlRDCk/1S10Q7HmB4UIUczBSawpmxI434UUSkDtFdpCnPj6vHfuPMvf/pdR8kEHpOPOSEYAA30eNNnt71tb6P9Ruoq43x/Sbw+GAAxAvL8LAoqTYdR0I2j2XyI/clLGQjgdwUFFPlYqS/sPmNYAgJ+2TCV1TCAgcC8lnSukTC4sNhgA6lUSmH/7gPhrm9sCfM794Tzzjwl/NgzLghP+d4zwrrputbn0BRdMXoeXsJgID8tREAajnf2kfJWJq4GBppB9PqFSgdytjFDkDF8/R48/IQ1Etqjj+J68fr2j5lAX3YUKpfCwflmuO2uh8KnvvCtcNc9D4fa6qlwytkbQ61e5d2LPc23AR/cXiD1+5mBH2AFzqtL7C+dgVN1qv3XPQL8ndAMBwOAzwBYGCDGT89BS7C2YTMxSQNKRAW9JaZMOffBINBdOnfD1Eu//s7Lr3lMrPMoHPSEAID337j9R294cOFfxmulGmr7STRjAOD+/iLH1JTu894RTptEKUr9QeRjr8ZdfVSTDzCQ8IBy5CjVRfyveS8hAZovZiLgU2gZgUq61oQ+Y5POEBYWmuHgYoMXHoEAUfwDe+bCvd++P+zZtjOsnqqHpz35nPDDl54TnnDGmjBJ5YPKKuisZHqRgAJ/T/0bIQIDgC5cf2NNG1BaC2O3n2rwAD+yJ9ZAlCFRrI7rxeXQZLD0+aUiV/lt3zUXbr79gfBvN3wnPPTwvlBdPRVOPXtDGJsYY4Wfu/qwjRmae7Rpx0p9ncHHXY7E4GH4XCvQ77PGM1WlvH8EMU2YKqih/kF0AL5PGp5JBWY/FGy0GFc/xJohznAWOAqQ/1QL4BCQRF86kKYGRT+6/7lPWv/8f/idF52QE4ePewD413v3Tf/9N/Z+vlgsPIVqvTnNV6Y22yj81an7rkbpPjUMR/3pflEumpV+iH0kXvHilr5+8WhSBCMtwHJZJO5T4c+WQywSQXupxdSaCpRYVbpKpIyWRC5egaHRaoe5g0uhy000NPRC9uVbmFsKDz7wcNh6z0Oht9gIG06ZCk990pnhB773jHD2aavDmtCiyoQAACAASURBVKkxEbsgbLFvklBAJhoJMAD0uOaBY1ZhKqgNkLNwnl9FPgYa/Z034cD8Q82YsCimzIpSe7v2HQx3bnkkXH/rfeFbd+8IzVYnrDp1dVh32jqu55fdiuMW5fDcmOYj9hi9cGbyr9XzowhIaAsBA33n1WO0ibij/vwFdfQX2IA95kEAexlqGKDhmtx1bgBwqUELoGLykwFA2Z/qARQ+FgqFT/3aL5390iuf+1xqFj2h/juuAYCo/5s/t/WtO+dbv0fpHhb+VPmH6k/eYFW9zM/JWG9Z9BDE6QZRA0qM9yXuZ7HK4v+YFoQRWA2dUX3NE1tKPk21RcUNQpWEmxC5ZBNP3u+u02Um0Gy1IVHoVtyl0O20w97ds+HhbTvDjgd3MxjMTI9xg9HF520I521aFzadMsVsgVOHWtwkVX1Y7FEUtB54DB9S2uJBAB6XfCHYAnk7CivI4zZa3bD3wGLY+siBsPn+XeEb39ke7ntoX2gutUNleiKs3bAmTK1eFcqVSujS1uRcZalMQTf0iH+7+F+vT/TyAIQIdEb71ZNTxR9pPtzwmxQ0mZCp1Aa1C6iEQl2AYIPMEaB5ApojlIwEgN4KqGI2QNaE/PPh32KzG5589ro3X//HL/uDE8r60RdyvJ70n1637Qfu2rP0+WqlNIVSX9IAyNiJARAbWFUrh3olzvQHAIgHF+Onmn+O+fUnp64UAEi0EwFLO/RQ8KPsT6g+rF69qWeHbiWIwAZaGr2biF5upl1fYuqlRjMsNFoyXgvhBRFMFjELodXshIMHDoZdO/eFndv3hIX9BzljMDVZD5tOnQpnblgdzto4E87YMB3Wz0zy45MEhrSbLgOinwgeF603frAVUu6bnU5YXGyHuYVm2LlvITy0czZs27EvbH14f9i260CYn29xU//YzKqwet10WDUzGSo1ClPo2nZl/r4aH4/yysTxAITkumicbgABz84ZCG1GUnZCm4HUuOXXJEzY7pAljEnBum2adTYKA5AKQ51xoOGaaAco+EKJMBgh4oK4UQxU5oVmu/Hsizf+u89c+ZJrj1d7yjuv45YB0DDP1318yz82e/2X1LinXgweaj/9nKBOOy72Qd4c1WvytcjIqQRVWlE1hYVefAYDnfBrOW5JewnCa5SvHjMzQsqX2fmr6hamj13jKGtX2KKbXbTaHc4QUN4c4CGEVz5ftuqWUVeNpVaYn10I+/fOhn17DoS52YXQWWxwPFui61GvhFUTY2HNqnqYHKuG8fFqWDVRD1QwxV2SFZl+REp+m4Cx0wlzi62wuNgK80vNsG9uicXK+aU2sxQm3PVKGJ8cC1Orp8Lk1HiojdV4FBpy9zK1J/bli43FfD6ek8f0tSn9Twp87Npht+PQD6us3Der+muyjj9TKiY1IKNyX83/xduCYSEwfPrZUX1AHjMAsDugbENrA6RiULotBPAxhYhTpbf96KVnP/fqN75g9kQBgeMWAN5yzdbLtx1ofIwofplKZhH7KwiwEFSnsEAaf3zOnw2YZ/L3uBRVmntkEg2nrAgQfNOPxrko+GGqqNRfybRrFHGJ9uQuZ9NRGrdi2Aj/VCPQOgFOH2q/+1KzHehfh8duqcCYqWnXXXuJmqsWwAU4jXZYWmyEpYWlsLjY5J/0d7PZ4Xw7qe/Sc6zND6xhQSksspBXovCqUg61ei3UxqqhPlYN1bFaqNWqoVSW/QlZGCUPb/X6brcel7ZjRuFj+ySlhwxJBAZhTQy8OtsfAABPT8ZPA0XR5x/hMYOZ+TbHGo6GRgAa7iCUrkMKBTBlyMaiq1AowBG1AP5dW6yjgAoTkiKz09dMvGPze171W98FgCO4Atft2jX50S/tv67fL/xAlXbdVcovaT/J+U/VylH118m+UeiShh3qQCNqKyKfTP4B9cdjMuZbAKPnG2f43quQprXieGi5r2beBhNpWQsUXiG9A3G3Wyl1jVVwBE6NZovz6MRavNCFWJgXv5W1guJHzUMovXb6UajBRuuHaCp95nWrMT+6GyEyKjuBwUexLhbiZPryUQWpdN5GeKuVRIYgBfhiyE4A9AyAL5T2VRRokxWq6xD13TIv9ouArP1fN3SQ26YMQFQ7Ve8FCGjUGPYOpJAqpiEx8kwgRsch6O0W0LQKQeMXWiCkvQONdrf9g+etf9G1/+tlJ0Rq8LhkAG+95oHX3Ldv6S/GqrTllqj+ZPSI/4n2U8EPNdBQoQx6/GGYdMsp7icAwCQaqVaLIIA6ABT/SJeckUZn/C7uV6MZDgCI/+MrwAoAAtjgUuJP6AIKBPpYu9sNjWaHgQDz7WBEUruC98rnYEoOwMFAAnoE4mq8F7l189TumPpaOz/9Owqb2KTTGzDUehg2mvByXpOk9WIqLwqAPGuxSKk+usfSpq3fVINzAcFMw5NpMfEJmw+ARiYTHaEBaCmypmp5ExI3UkyueSwmY0jmD9WhLgw/MlxUCpJkJ7R+Idzy4qdses7f/NcfWzgCP3hU3nrcAcDHb9s/8+ktu64vFsJFZvzk+VkHEO8/UxevwGk/lMXqaqCbQcZMPei06wxXrSntl6o2zf3rZF8M94z1/rbGNKZESWj2UqUyQPT8MMqoDtoi1+pAa2flk9XNLg0QxGNTPEolp5Q2JH1AAERWmRmjWH/8WzMBxhYGimgG8+pyiKz6Hmm6PpfnrUeBB8RA91NUeC3U1c9kxoLvobX51NrL05qFMIhluewF8vq4B3J99QVCbPSN7k2aRuQn9PpiEIowMd3PwKYj6wRipFH5kJoBQLFFRgsACtB4+U44Y2bidze/72f+51Gx4iP4kOMOAN74yXt+dfd89y9J+LNiH2UAZPRU8EPin5TIxoIY0EB49IVmV4Zvah27gICk/1AGjPHe0kaq+XFdQJmCn8TzW3uu5YxSYUrOJitW4+84s47jfw0JiA0Q5+QxYzbyWlKHJMiRQt/kSbkyEw/yN/bE8zSdBTdT1yNIeCACpYZRSqefUmSk1xwwQN33oh5CEWELyiLccQBE8lkRZPjs1djxGgpb6J5OVKSUG/fDy/w+9aYJebkOzvY1bLduP3yWYKdeOzVyMXwZcir1CXF7c8kOYF1AE4pZAGECEAPBEpEdoL6I3u7Ln3Xh0z/4+mffcwT2+Zi/9bgCgOvu3DX5d3fu+3I/hCcTAJDAR+k++kelv1QLQN4fDTL0GDfCaO4fhTxNmj/XIvFPYn4qYZW8PzX+aHmrjqxCs0ss+pFQQA4bi35wJ8z4h9waLwTGmpRo/ELh4V1E+BKdUJqIaFFKzA4giOEBhzMKBCQARvGKlQXNa0ORV29rYJDk1lWtF8OMxs801pXJihEIUOH31LAh/PG3cMAjdQn6mFP0Y1gk4h/dQ9qchYQ+iWlU5lPHDgIAkEfcn0nGW5CQZQPCIsj6Kako11T2G5Sho9jAtE9pTAIABiYFBtwrBjCo//AQUQ+QjEBsJ6bzpXU3M1F574Mf/PnjumHouAKAt3z2vp994EDzKirpZeMnyl8hHUAqAKngh7y/bOYp/8ggxUGL8EeUnnL/rP7zltDaqQb1XysCMfyTa/a19UsLAHUpxQo6X0yzIkhWVwXj8gsWlJZBwGiwxtWsfjkDNPFOd8ZR8YxYQKdD9Q1dHrxB5baiL8KYI2gInXf19gw+6g1hlInnB5swvcGO60IFdY/61qhLmNHr+XiA0WnIYAuUjJCt1WVug8l5Rv0H662N7Uc0MHFQYUNjNny+GiYZvWkhtNmIhF4FKlxiBiO7EFGBRgYAAIYW84mxi9fJsgCUYSIkaXV6S+edtvo53/zzV9y8onVzDF503ABAv98v/8rV37mmH/rPpQVRpVHazABKPOuPBz9QkYu1xyoAmA4ssSTRe9pimgZSgPJL+6rWAnDnmpQFo+pP/K/5eKvOs+k/LvM3uMVk9q6hLNhnA+D1M0VCeBv2vDdq4FR8sALdHgtlxcge0EIjlZ+addqdLuf36W8ZXJEIcKrsi8E6tqCGLKm7QT2Av4/TFpCay7IGZCYcqMkYLQmFdDMV3saLNgstiqBLVJ9qOFCJqEP6jPXTa9lImeL7an+kSUEYoPkrS3GVHMYokIERuhKVf8wkwNbmfB1kdyRcK3drrAaAz4D2E7DKQC8O0nnQ/g+9sGaifvW2D13ximNg2yv6yOMGAN553YPPuf2RuX+tl0tlLvbRkl+u+eecfzmMUezvN/XU2FydHy8WVv9bNKAi9qbLbjwS+6MoiMd8od/dCn+E3sl6swoAqwGQKzrqkpn7x9qzZLX3/qpuZVJ6qRiXieU5QxVprNXOY6EGMn4qM6bQh4p8ujyow0ZsoePOef2BeB6gATCAjmGFPshypKKhbs1tTCGCjFbZM2uzuQ28cxGYjkNCTddBUY/xgI4wBzOwJF80eEsLKF2Xv1XFRzaEBddYXchGrtud8S7ENqAkBQA5jiQEfI+AllqyvsBjnNzW8iJMNNu91vc9Yd2zbvyTl9+0Ios8yi8atZqPyunQmK/f+qd73jfb7PwCVa0h5SdAUOBKtmmu94/Kv7T8YoloI0+/z9N+Kf6H1+f5dOwlY+8/tvrmmNA8i95g2K8LLXLNPr1yTqGKGSkjtQkIqGf0sS6ESDYiCH3qUb3i7roMGQQsJag75roRWtzOS914rB10GRh4fh823YB45z/TDd0wRqBCpSn4Lg1poQxEPa3Rp3tD94j3Z9CQDfl4aAN8FSxk91mTmFZzfB6YqSIBQEHic5xbBA275CZAit7i2JFtPUbpVhpBrjoATyTWkEGrF2PEAdpPX9SPWZfHZdt3ZC+k6nLtZO1D2676+VcfFWM6xA85LgDgH259+KxPbT5wY7Vc2FAtEwDQWC/5SUZP3p/SQtIPD+U/flMeNKEdbAutLs/943JXjKnS8VWoCKSfQv+1Ai2jGwHp9fiZAZ0xJ+xBIatOx6ViKSyEKareQz33Ipal7tICIgcSafENaKptk2UaATbWkIDf1+QzCHQpBBJgwD9U+PGcPtUMrElIqxljelGvjXpWJsJq8NKhKMNSOEPOAAs6HWN6DwKRA5iLt5vrU3xpWKWVUhrbiyaPOa0x3EJ2Qmv8XZMSDWDhrcd5g1Eyek236u8m1oJB8DoRkxHqrxuMalpQBsdiuGisKWm2enOvfNYTL7vqN59/9yHa52P+8uMCAP7k81tfe8cjB/9skpo9yOvzrroy74+yAdO08ys1t+iOP6QaR++vBRg63JO2m2aPzxNq+zyfLo6wIg9Io75EA+DYlG+qVpmp+i8FHwnh9yHBMrfFC1kGBZESZCi/LXwDhpg6zBTIqGEjFhX1322RRVoBN7XFWXqSHoyiIt5jE4tcHp5n8+ncAaviS70lrA+AJJfNKTDqmBFGqHuPb9PiHUu5ZuN2b8yWPVH530/wtSyLU+iFbEPDQCcHshbgBJIBkEpA7QWg3RHod8sAaMjkawK0Q9DAR1OOEiIKAPA34d2G3Y7D2kpOn06j0S46e83v3fq/X/m2x9yiD/EDjjkAkPj32r/f/G/Nbv/ZJPSR1yfhT2oASmGyTg0/UhGGzT1Z+Qf910ISupG01dc85f+d4UsKUEuCNT1j035sIwzneVRXkOO7y5NcqWUiAGOhnqPke/0YCvi6gcwi1xy6pdMyBoY4Ohq6BwETDRH/a50+jICTh0gHekBBCKLJ+Cj8DdYymI5gBp+l8kgdIh6n18NgM8KeAoval5bq6n2B0bEVCl3zAIkCKcu6WN0B6LjWIXgAYC1ADd6lAGVHYlcUZAAA/SMyQ3EUsv2KpIyhD7hKQRVWC4XCbT918fk//MErn0vbQB83/x1zAPjAzTsu++Lde78wVi2OE/1H3p91gHIxTI8RK6ButjgNB0MwVWS24RVLtO2Utv/afHodWskDQIj6auuveH8sRb9zvGZ4+BZFoMkV/3D1MjFA1iua4buHPZWV3wc9v+Xc1e17AVEKb8QYYoEOhDdXlMMagQ4m0XifZUTVFGLKMVL0OJoLaUU9N1dViHSjfL5PP8o52XdSULAsiKU+df2roZqwhnoEvi3o6lOGxv0aOubLBqPo/TOKHs8Vl1uKm7IpV2I8WjTBWROiT9KYJVujsyBI70PBkDEw3yWazQAwA7CeEclpYpAo/dFq98Kl5657zlff+YovHjfWvwJJ+zE/19/5xJa37jrYfBNN9RHjlxQgpYloUCbF/2z8SP8578+Arpt0krBH3l/if1H9eVItyoB58q/GvJjYo/4kSgDe4OPVcfmATP153sXJGLdxfMcFMgaf9SrDPL83/ozx0fnTAjbD0uOZVwdAiIEzWPg+ezTlqOrvFfIILCpIOgDIGJWj+lbXgMdM+4hqPcABNQZI4ssxXarPAwD9DlAwEpDNRERGoCGACxHsfDVjIt8TOw9T8Y+ObUsAwKoEES65gMdmBbLX1wyA1gbE7VOgFciaXDNVe8f2D/3CcdUpeEwZQL/fr/6Xj22+PvT7l7HH5/JfzRFT7E8dfxD/FARYa1X+L1Qeu9LQltNdmU2vu9GS8cvcet38QycBc5yrLcNIU6GIQ0w1AYIkGhiJigOMAIq0N/gcr69uiw0px/NHrxjr6b13U2enlT7alsvHjAAgng1imSs75pepUfnafy2QiAJgPLfYk5BlCQAkOzfsNpQYuRmmQJiyB4wuiuIdmrQ4b+uyJWAbyFbIfZHvoOUNMQPAsgmuQxYAWATkxaQMgGch6HwAZQv+fgiIuT0DeAprFATj5KAIAITT5ULhW9975uqnfvWdrzhu9hM4pgDwjuvu/6E7H164rl4u1Tn2ZxYQswAzY5L6AwOQ/f1gfm5HX/X0c42u5P87tPW0oC5rADzKWoQ/af5x20hpy28UeNXf25VJ/x5p/rZIsSCxaOMC9YxA0cKp/QPGD2/oPaujtpEBqAFoliOOv4ZxS5ggmOBAQEMKX+SDeYYwLoQyy3l/o/96vmAEEPEkWnDiHJ2LttGKNgDaj9AC9B8hAYqSlMGbJgCKH1+HpwCm/DcAgCuUUP8v6j/6Avh31ANIjGS1A3adrfgHWQGUBUtaUDoIkZrUVuYC1Wj0+xdvWvvMW/7ilV9Z2Sp67F91TAHgNz+++U2zS523Ev0nwU8AQFgANf1QVoBHW3H8L1NwsXe7OjJplmEBsMcVgNRBRyBAJbJUA4B6APQF8M64vBriJBdx+vFSxF/zjH/UJUtEMPNuMS9tHhL3dznjh9HkGH80fDCLyDDE0KIh8QIHq3AxsVFnVykILypG5FJ4iSCZyVQgfsd5QhuAJsDl+DGux/kJADgF3w0+jTpIBA7v5b3nTxlKBAA9f3qjG1MmAEfZEykGEnbQlRJhpwdI3VAsHhJewjzU7ZRI8b88JoNkFBCUKQA8aS1uWjf+P7a8/9W//9ib9so+YdRqXtlRDuNVpP6/7uq7Ptvs9n8Ewh8DgQLA9FiFB36w+o+5964eW4p4ZNIPeXYq/plvdczrSypQwICHgqgCTkyAi394AIjsCKOtAIoD2UuSgsHKv2qiGusbLc4XZ+2ovmMCELW8Mal3hAcdNH7lxq4hB8wD2YCYXospRBwHG52K4WhDTCLw+c9Om37MAF3drJUcOxDD94fGYBWRvurQaxrxsrhehyg2et0hA1jJMQA4NI1ZSoEREqQAoBOCAAg+BQstALUAXB1ILgkAQFdTU4MABJsxKRmXarl4w69fvOOZV155Zaw+X/mietRfecwA4INf2faEL98/e1OlXFzLAKD0n/fKo/h/jHL/Sv915DVif12XYvza1UcCoGQAZAQYzQKIIqCwBGIL3G4LgShzObNFPkIKBi9PzkN2lCgAZu9TxugTw5c/o0iWxvnRQLJeMPW+iibWW29Ve6DczvtL+s9rEJjrZydngzcld65eWo+BWgEDGMcMrCHJx+IGAP5YQ7IHygZwXSIgeTVfn80wGTwGPSJqCHYMzooAADCdWDsAEQZwY5UUB1kYlCmE0s5Amx6lMxvV+xMcSMcDmoW01kTxudXpHXzpM8697OrffuF3HnVrPowDHjMA+IPP3Hf5vXvmPzZGI5+08o9FwFIxTNSk8Ydif2yNJcU/crrsvbWYB5tXHGx0wlKbPH5PhUDdqtrtZhOHf8Q8slwzvQxa6+0fSq/pIbUD481OFIzG7mP/6L2zir/BQ9ziKlX8NatgdQKONWQ+SyICFckUTNyxjE7ra/I8PBhEZtaACYZgDspsLBcvF8FSjxnPjDAMRUI54qbpBjHMiSGDf0y/WxJmiAaQF//LaDAo/TILwIUEDAIyIUj0Sa0lYBzS1kWX9qMx6rJupC4AtQH0Us3Y8mFopsP3n7v+1Tf/2Ss/dBj2+qi/5ZgAAM37/+1/ufuP9xxs/SbRfBL+kAakKkCq+6eiIC780a2weOwXX2Cl7/D+1ADU6YfZZod/kvJP3h/U3zQAVLq5jTCYvqEGyDAgbq6xXCHQyDuRGr33/NHRqnVE8Qv2rE/I2rP6VpfPNsyQLwABL3r+6BEj9Xc5eheze/puv7uBHWAAgCMDKfPALlWYCH1e+DNtwYFUVm/QtCWuT07tgTCfbOeiHC7LEKLegawAqiQl/cfzFzLxf1IKjAnG1jzkMxC4O9mWYBkiIQAgXwH1APSHgB1pVBtXT/zfrVe9+j+NXENH4QXHCgBKr/nYtz7baofn16ti/OT5qemHQoCZcZr/DvVf971L+v5B55nud3thrtFh42cQMBFQagG4S44yADa8Ms59FzHHmboHAgaceBdGtQJHh5+xfl0MicdXI9C1nm1m0VgCk3LtuNAGjCb7/Hr0hgPaQsb7R+Mxw3EGhMEfnsp7ABj0/lk2gc+OoBKHgHpRz46fhA8DVYc+B2+gNdi6jLyfap8D6T/6rlIApIVQvu1XuwKJ9luZMG8couCBegkDJgCANgRZhyBv6ay7SUltACQRiM6kV1ULhdve8Kpn/dCVr7iodRRsfNmPOCYA8I93PbT201/fd3OhWDiXmn4k7qefhTBWK2vnn3SSDQz+0N59upco7KHhH1QDwNV/zACi+MdlwNoGzKEDUmRIOWUs3Jl4xvAHkGDwojqb995brd//sHQAPGkEAfjY/HgfBgsqb3qbA4bljX+Q+hsOecru0niZ41lxjgeRvEpBaAbOMzv9IDbqxGKe+N0Aau4zMsCXrZ8Yrv4n5b9szJLWk6lLSP9pvA/678eEAQDScMYLk8gGaG8Afw+eHlyU0AHTg9XL0FdptnoHf+nHzn/Ke1//o8d8XNgxAYD33fjgJV/avPeG8Wp5Au2+qAJcVaf6f6n9p92AeOinpf/EtFD8IxtYhkBbMzEAqOfnKkCuARBBkFOAmIzDXsS2g/TuXQqA+J4lmQC8aqVXK7NA9M1e2Xelv6DnKgUavfW0Peup4YYQmo7w/GrhSEXleeEMDfd0OqeoJiNSJmGE9/4GTqmK7s/H0Xn0MGQAKQEcf55ZEdSBhm2RFseuSY5fS6WtvDdOBJb0n+sK1PhfWApXEIlwbAVk0v2YpgNFB3ApQk0J2ndS4XCx0Q4/+bRzX/LPv//iTzwuGcCf/Nt9L7j9obnPUfUPx/40958ZQIlr/8dp8IfuBEQbYsbuv5i7h/pPRk8twNwERIM/WAcQJsBTgLj1Ne52m8m9QNCJGqDcj7zOv+Xk//QuJukAIweZ9B7epPG/Mzxv8Edi/CljMKHPhLgIJoMaQoypM95ZtQcfi/uMg8XiCZCYTjHCm0cQQZYAAKcGDHBV44zCZiwwQhWffKaIeDL/D23SsRHIqv+0+AcDQuUYEjuhmEjOzQnIafOPAoAfGSan64echrDU7ITvf+K6373ixy/709f9xBObxxIEVurTHrVz/I2PPTg2Vlv4Dw/ub7yfevypAajuqgBXT1R4+2cBAN39FsbnNu6Qqj5p8CHvv9hSAOjSOPDIABgA3ABQyWqJ0WVj+iwKZC5MXjowuSIDEYDBvrwwgkA0fDzu8+tZg4+L346SI/jl0f5seDBImzOeNsnBR5aQn7bLYwwD6bqM2h9DAh/7ZysHXfouE4IMCpcDKVBfoIRpvmiUsmEqMHqU+KL4B5qAxvxWBBTFw0ytgaU01dPTD638892BVigklDKmnqltvdMNG9ZM/PWLLj3rv7/nDT+y/VEzrsM40FEHgE/efmD13Xv2v/rmB/b/Ke3uI55fcv/EAAgAeOPPYrYEGCfK+q0VAAkAzBIAtGkOgKisnAqkOoC8FKCn57S+dXiF3Cb8l1ICJQYrvMA5coC+Uw0af6Egwf+d/D4s3vfdcmm6D8ad8dJ56cOB2NbH30iPxEm/3jtbbYNT6r33zwWRRMT0x7DmI0WutMAn+7cap2cZrm1XvD3qK9x0ZRMA0f1Hx/GjwEQfsJHgfhoQwpEhAJCpBKTxYBwixLbgWHla4FFtU+PVa1/+Q0/87fe+4bm3rHBZPSYvO+oA8Ndf2rF++8GDr/72I/Nvp1gfk384FVgthtXjVWUA1P9PJcC684/6a4z+ZhFQKf4s1wBIHwBSgagEZAFQuwClgEXjfx71jv5tVwqQO/hjyGXyqJR7eyIU4Le46OMbfKFQ9G6OKagtZoxO6cMw48+N6weov5uIlAp/3lgVUTzdjh5/SN7f4udB75+m/nyq0PL2AxQ/v3aBj2VeX6cnm3ovAR/afzEDkD9DPb1MU0IrsLKDDP2XC43zMkDWWF+2a8EsgLhxKD3K48FMBJQRZixE92kwauGb66YmfmfrVVd85jGx7BUe9KgDwLu/suWUXQd6V2x+ZP7tFAJQ8Q9nAsAAxiu6m60MkeSNPxlQY4MF6v+pqo+8PgFAg3L/Wv/PdQA8HFOGgUgVoIwNRxER6D8Mc6DAByRgSOyfXri8EMAbdowBlMynOoEZ3DKGD0NMjT/z3ixlRkiRBRaJbf34rIwRei88YPzD036ZsGOgziC/BiEr/o2uFDQmgFSoGrvMRuSiCe3kk5SPLUob6QAAIABJREFUVPXJvk+y+Qc8fDIZWF+HicuZ8MS8fwylTN13+wWkIqCUCWOzkNjqrFrMA/1+702tT77uwyu01cfkZUcdAD58+9bVDz3cueKWbQfeSXP+0QaMdODMeIVbgLkLUGcAkLZCc+ZA0hkAOLaXoh8CAIh/bPzaDoyNQXkQJgaBcP12pLesBWQagUZ4+5XehhxEyACCUUkAwqDhw3j5GVPEQW3jT1B+W7QuyzAQL/t0XHpcF0t7TxxBBN4wnk+mAEe/QjTSlcT+SRGPAU5e7K8GDuPnOF/pPsIZZQMy+0CnAOv+CqI/gPIr3XepQZy3iX/+XOQmIIMphT22lwGovhQCRXCQMmEB1wEA2Fro9d/U+NRr/3alS+qxeN1RB4DLP3ZndUMvXL57vvG3kvvXMWCcDaAsQCVM1kvs+QECnAbUUn1oALKHQ589/4FGOxYBUSswpwF1XwBNBYqgK5RXaLPbUddd2ZQJCPM4zEuvgqN/9yAIZA1fnbuNvBo0fhifAzEpKMiU+nrwkIVttEGLZAZBxYuReTG4N4Cs4acio6YKBhqTfP2AvMYX/gwrFPJpOJyDGLhrWlKxjyk9Cj4Y9LXW31p8Qf/1vX6PAJ/3F6uNo8cSwKb1wwEGr41Y/ccbh/J26vI4/6fVq3pIgPnjEwDoerz9mi1Pv/n+A18Yr5XKsuV3LAWmsGB6rMqbgVAWgDsBKRUoFID/wyAQAgAqAiIGQJSfDJ9TgJQFsGGgNAiUN3xR+g8TgzIvx02Z/sBMwMPEAHmbp476uTDIeDrqKfwDTjQEmLifYuSjjd/AABkQW4ny/sGeAVea7I6fJ/x5o+V3+Tx8kscfECVVuBtI/el26gAufK4ZN4O5tujyMaS5iQ3WSnhV/NPef6H+WgwEdkDvpHJgMB+dF+DpP/0uoVLMUkjLL669rJ8M/ddtxKnTlF9npcGiQSmwbO33w5tajzcGQBfr3Tc8ePq1d+68pVosbsDsP8oGxDmAFW4IkjFgsheAjJoW46H7J2PA+7wLMA0CIY8vPQACAJwR4BJg8TIMAvpe7eeKJm3Y4lz9ETj+FCu8rQMQrNDHGbG9z9F9XXr8xWGoiil6CPWqiNsVFeQzkUbMVtelgJBJIyZGi4WfCpDGAHy44Yp+BKjFKPF5g3UI+pxtxBmbgeS1iN0V+Hn0sR5St/KW8F5FOlP55X2p0Vtzj+3SLBpBfH+29iHWAETdQ61d6D/vS4r+f5QFu0nBiP81DegHo4Z+//5+r/97rU+/7iNH5FuO8M2HS26P6GP7/X7pig/cdk2z03seGz7Tf2oJLtko8JmxSqA+AdIBqBCIQAD/MeLrIBACAOoElLhfxD+MBeMsgdsLEOtRZ4GqAcXxX05m0I/KuTz+IVMQ3eXIUwO9tYtobkYR35nVJcwoMwaN9yksZLx/dpEOpf043hBGkWe02Xx9VvUfLvwpFQfo+nN1KTswEMYJ9ebGKnwmQUU8cQBI88UBp/DuoP+yaYpr/dWbbwVBDFxSISghRrYTMQNcGZCW/D9fJ+35jzMAJf2HdmCO/y2DEweKEjDVysVbvufs1b9987tede0RGdMRvvmYAACd8+s/csfvPnig8Yck+GEIiEwDwmhw2gy0whuCRAagdEuLYTAIVHYCkgIggIBUAgr95zJgzQQYqWYZIPv1M2Kgv7CHe5UcGHhcSHUAE/jErq1LYcDrHxLlt4PFmN+BiffgQKSs8QNQHPVVb5/ptBMo02k/g7UDli50WQGbJ5DsdyC0XtV8GKjunSinrgZrxgvPr9QeYl8SEojWoF2AJnQi5QcRMsukovenmw8tQIxfCsliyo/vrQMDuddJ/O9YHdUBrF5Vu/olP3jW777/DT++5Qht+IjefrhL+4g+lN78x5+575Kv3L/n+nqluIrGgREIVIwJyO7ApAHQngDjNckK+P/Q2z/f6OhWYFH953SgbQcmoQKtLYQAkUmkXYCDl2NY//9K0oCyaPMowaC3VzNSF58FAbVb8IZlxb742kHan8kkOMUf55mmCiOLiMJjLvWHyKh5RQ8kSL0CJHAOchwYMGi8347LARCO6/rz4wanGGaiLcnc488BQBxyCmAx4RAZAP+9lJrhusQIitkmm71uHw0GiWo/AYCYCYjgIPE/LwG3T2Gj3QkXbVr7xuc9ae27/vx1P/H4KgXWVVy48sorS/ee9eK/W2r2/n1F9wDATzABiIDUJUjhALEDigQwDpy8OrUBUxiAzT9EANRegI4YP/QC2UdAa7ltpgMS/nJmGcM+lPr/5SDRgYDBgf5inQD+b88cnICQFfwiuHiQ8Wq/tfYCiIYKiU7t5s/zE4JgnFmxUGeLZvvwXcGMdN2lLAIGDnDCLsXyuAGC9uuLVicyGoMRHvd7JVrlXmQD2AXJx/YmGgolsfmEEYiUMWmtv4GhDC10ZRxq0LyUhBHIO0WkEqyKzkpCFrefQL8fGkvt7s88/4nP+ts3vog2DJUTiv/lBpFH7HGHHOBoMAD/GfGKhVD4bx+5+dl37w2frlaLVTJ2MnD6KalBmQ/IQ0G1HkBYgZQIk2emGF8mAelmoNwEFMeCYydgpv/Ymz6TmkuNPysC4pod7kXK3MlMOGDWrosn+7d5cTcGG2sk1Q9Sr52h8zAqXdv5VYMjFH8bDJJlAbKwnWimxi6fkeTw0U/v0mx4TawZoCIdgI+n5VDusa8BwAmfLbl+0xDsM9zcw4yWoNoEzjcRXI0NKQPQAEAn/crEdW0Zdd2AYvR8TbjgL1H/3WfQmqwUwk3nbfvEj9x++zU0D8BuafI7EOmxsv1Bh/cof1Ke4QMA6GfxkksuKV3y2vf95UK7cAXX/+t+gJ4RoBaAQYBaA3VmP0aFEQA0OqL2owVYpgD1eD8AZAGkhViRGPaWsfcsGAgbGCECphdsCHZ7/xH1QGf0niHkeXzvHjKvlWN4r8/xaUQJ9ayDqT42NbwwE3fLukPsDhYRDdWt2Ixop5+hKTxmac57G/VHoQ5TdBXg+GRcy62132IaLyYOqfHbXEdXt29df5p5yGx1Fq+1hQYeFDMMSS62uzRyPTDnz1y2VQEZE5BRYAAAec8A/W91wpPPGH/NN97/n6/S0Rb0Fklb5P/D3X9MmMHhOrdhWLGc0cdmaeFI/O81/+P/nLF9zSWfKJdL57CH5z0BIxigK5B+YtdZ3CBU95GogtFfSP3hb0kBShrQz2fLhb88QBAkyPlvhAqQ3K4BEBgw+gj4ZtApN1TPmvX6tpJzxb5Mig+SfZKik4fVyGD8fraef077qX1OXuxXCy0cIHHpLWzPi3Au/s9OGHLblukxI/AM0QzANpzBg/qbNwdTgZjnWKBGBFodilZfNmOXGYhFY3JvkrHfvEDoCqowyB4/CtboPaWehHK/e8umhz760ru/+VXaHEQ2KIj/jjoYPBoAcMhGD+PHz5/7479/wezYpv9bq5ZqsgmobAzKxUDUFVgu0K4qoahFQTDeOBWIPH0MA7gHgGsAenEjEFFybEAjagoyPYDDrsbhXqU8zDZ6nBp8/NuNAMyIiMMNH8YbXZd5MNQH6ANId1maSzdYjPqCGhpbtfg+GKERC3TJSRxgc/3ZCMy4syKe7EsgQzoASii5RUwujCTG+1Y4pKIPjpHN23shUTMF7jvHa+bZkg9nfFpWVoPihdVZyL5k1NzjEVnz/+oaRCBU4NC4X6+eFf80Gq3GJTOzP3v71W+5QV/MU+qGgAAeBzMAS4gLJasdHBaBP9ylnfpFT+2Z3us//zseK7nn+fd6vV76qbd+9IqF8Q1vrpWLRcT5lZJsCorpwNQUJBuDKrrq7rbY9AM/M8av3p+hVZEfXxoonTf7n19zJFfH344o+qOKJdJ0IZxiHA4worAXBbo8us+PYcqJizVHxftG8x3dF9uFIAdKL0kvhATZ6rwopqFc12L7hOKb4dPoLQOOuEvRoOHruUBIBNAYXdfrYs+LD/aCnYmQTvw0VgBbxprQ8FAoexoCwNixs7F2kSKVjPtrkQby/xF0Wu1uOGv84B/e/w+/90Fn8ACAPCDgpFUOOKShggeEQwaBI1nieG9K7WH0ZNz0+4DB5zxWWjM5WX7mf/vAq8PaM99QK5eK2BHItgXnzkCEAWKdGA0Gik+bPsD703Mx/pcbygtPgRq2lhX65SvlPZYbBOgV8IY7+DrneWJwbi/z3h6L0wS/6MYdOKTpPY15kwWd1hDwsMuIIOqFHe1XJuDTdLKTTxT6YgowNuCIRhB3KzYm4fcZRJkujmXH9Xl8Z9Ba9GPXQ0MU/SgBJKSCUJvgGE68jvDmarig5mBhuguRKHf6WiCAwrKl/nDHTODTu4TUILw/boe2/tLhaKu6ic6edzeuect7qDu5JV6fDNwbfgoGeaDgWYHXDQ4bBA4HAPAe7/Utpk/ofWr89Dce49+r8nepH0KxUqmUn//G911e3HDBb1TL5QrF/VwJSCxA5wLQfAD05/DV0LZWpPqk7l+MH7UCtHDF0JwIuKJNP+LlOdSMYBYUopFm+JvFxwB1WWUwNG+vyse1CEWs3byyLU6IfdFwvccDt83QfScacqksPj9TpCO72gg4xDn5lu9Xg5K/YziCrcbxudb4Y4M24lbmGVqv5xDPE2JgFDO9UAnKLtcEaotZovIr2zPVwNe+q8b7UtYr+X6+B67cN3Ue/JlQ/O0zo25A58dFaJ1O59T+znfv/szb/p8z+i5Fo60sCHhAGPZ7XrjgGcEhA8GhAIA3fPogeP7ljL+c0H387Q3fQKEfQqlcLpef8yt/8PTa+c/4zXK1uo7CAUwG5s1BdXtwGcIgSjMbum4T7kU/gIOuXfNmuEoDnX/LWDme4nUx5Kr55wZZQeT3mQIbXuzg8AoA9qdZucbPLuhzBSvm7V0jjkYWKu75z47xL7YDM9DJGL0O0oRwluyRF4t91Ij5C6NST+ISq/hTmi2ApSGGMgT5bA8avibBsY8MMEYWRO/HNKH4neUOGzAoksqcfn0cxu0oP4w/MrA419+RMVX6FYBZV1I0oGPrccnrl0N759SBO9619/q/vlGpPBl+xrj1bwKDDl4Tsr+nbCFlBstpBHnENfPYSgEgFfryYnzv2el5GPbAT/L6ZOzuNUX3Nx/70h+//MzTf+QXXlOcWPsDsjuw3x8Am3doGKA3Gx6f+/8VECB8O8ZoTUW4Est1/o3aCWjUFfaxvH+tN7644DI8HiRUFrLTB8yIXPwrS169sxoLYu0sGETj4Md9Rx6UdJfLRwENhmuawSLF50REL9JFdpCvJfhQw4wV+XroIWm1IgzZYm6o7cgQ0JEkxpPrjt8VWM3Tx9AAar9nh7jUuO6ZSw/9QlVk0xlsU9NC6HS63en+gWsL3/nHq/ZtuXV3DtUHEJhxExAkjIAAwYcFw1iB1wk8lfSnPXSZHgoApDF/6vnNu6vXp78BCvy7o/tm/Gr4AAz7SY/PzKytXfbzV76wfs6TX14s19YgFYiULBdcWOwm24VJ0Y8CA4eq4NlxIIOYQF68H6/TkRp+esUHvLzRf/ARfUC9f0zLRaqvpms0IFvPH+93Nt7PFuV46hxz87JuxGPGeXo4vhm/E+Jkgw3VudVS+Ax8GOHEN6HmEGKyVB1GxObqsiTx+6kBJ4Ag3l/DoVhgofQdm3JA+4ivUxvWgypI6A2Ta4Br5sQ8Z05yjhFcODCSlGe/3Jy7vbbzpr8/cNs/3QEBD17eeXgzZscIGBQcCOA1+AmGMEw/OCwmsBIASGN+T/2HxfgwcIBCeYjx07E8cPDxHCgUS6VS+ayLn7r+vBf89NNqG77n6WFs+pxCoVCisEDugdwIaFhS7y8uAtuAp+q/yfv27Q8/1h/FAOLzTgzEOeJJCFgmuAEUlK5nVGYYEnIHcJfyvU1UFL6tzMH9jIl5DSuc0DfK+C0b4JtyIvOwdKEX5Ly3tsf1+3ljN69tiZJsCtTeEisqoIHIlUDRTaKh8DVF/74DAzN4vS96GU134HAhpjKzdQERTKgJLfT6nbHe7LfKO2793L5vfPybodvNNdYECMzDLwMCOE4eG/CfkdYSrJgJrBQAUsEvT93Po/xgAez9Pe1PQgALH4YxAgKG8VUztQtf8MoLNjzp2U8L0xsvCtXx9TIpCIM+5afcRHRteQ8hXxfkEGm+TMXfwBVZySVaDgaMUIKHyjnAOw6AgTNo59UyVXuIa4xF+Fp6rGwxzCik6ePJEA6LiZ13tfp4qO1WNahTePhzQbMxiw/pQpyU8/KWnvSAlDVk+kxhAAp6SMU5FmHpORfHy/nHdEyk7yrixahIRUy/MayKdibiOfBAWhCgbACh8yW6vVDotWdnuntu7Txw4/V777z23hC6w9J6FrcXhsT3+jh7+xwmAABIWQHYwLBiIudJ8tfoqNU9TPEHAGQU/STuT43fhwQeDDKhQ6IFeIZh4QHRgrUbz5w471kvvnDy3MsuLcycfkGojq/RQb8WL8s6jdQfXyZtA8al8eLeQBnwqCvlr29O9KUcxYwfIGBvQ91/EhH4uN6DgLwfYphZjhqQGig/nC0SEpruvb7Ez75iz4/UxudkS4FRF5BuCmrxS7Z2QL8swCjG3fCwSMGha67v6umd4Ad1XuRGfk0q9sk1wdxHeH9XZ2FeXRyBaTSm/OO7xVJphCiUZu53O81ae/ae+tyWrzfu/tIds4/cO5vk6tP0HoyTQcB7ex8S5LCA1Og9C8hjBEgL+lShccxhLmrUsh5G//MAIGPgSu2R6iunHp/Sfv41jvqnYqLXGnxWgc+hWCyWVm/cNL7x0uedM/2E77+gvO6s80sTazb2i6UqXD0bNqa3uG8cI4Dhl+FQ03/phc5mAxJkgCfL3CY1TjZUkIasCggBUXL03uNmPbMHGaT4YsbAg0B8n+BQVom32N48P16DEMUVKw3E/VlGExmJ98QuPEIMDvDWUAakJ8OeNLyIRuyMn9lLpP6GqwAIYhwm3MXvEz9OOkkpti/2us1Ce25rZXbrtwoP3vitPffdtlONOU3LZYw9L8/vwoCMN08BQOsFPAj4LAG9N/3bAwBdUJ9aynFJsrYOFQDo9dAA0px+GssPYwA+zs+L/9PUoQcAfCbOg+sHXMFRoVYbq2y8+Gmnrr3wB88ZO+38c0ozG88s1CbXhUKxxOECpxEHUWCQ+Y+6NMMwdcjjhgQx5hQ6gHAAf8B7R8O2SAAG6FR6O4YzWtB6OROU3joRLBnEwZ/o5vDJ52lZr1IDeSgKhfHrpFt6x8+LGRB8T6dL8LQcDzTcMh9z9t64NcsGuo/iJJ89yZT86rFjXYB8loQYABuciwp9ei4yQboXSv32QrlxYFt59oFvLz5w090Ht92+Sw0axkXePA8AYNj0uoFCnzQNiNqAQ2QAowAAYHDEDMCDBIwuL+8/LOX3qGoALqtgAKDG74VDD1LFsVWraxsufuqGdec9ZVPt1CecGVadclpxfGptoVip0R2iYaPcZJRiodq/hQ0rQEt/tf37YKTxeQfODptjyW0EEVmwDjSU9kfv7ig+ez19r8b0asuxok+V+KhM6CBP7aZjyDAjkYNZXO4ZgMbN3vtG9RzhSfTs9g2Aa56KG7B5QIR6qN9ez8nn/Ad0lIyC797nmZb7XGJS1KAjjKrXLXYWd9cbe+4v7t+yZe7er22d33nvfr34Kb0eZvwpAxj4O9EALOZPioTysgF5OkCeBoBzjbd4GV+1Ejc3LAzwqbthef9RWYBMLQDSh+rV096BVA8YAKLkfR6wDBTK1Xpl4/nft3rm3CdvnNp0wemlmQ2nhrGZ9f3a5FSxWK5yr4EOIBX0Sy7RqCs2hGxFycvsGbkLuT0D0YErZMnEERDSfPwaH5NjuXr+iAAal3vxzcfXjs5HdBnMIuA8ddONLAPRr+LYjhchLVpxXhjAwCndpJcBufzotZUhWPYgsgih8/o8MxybvquxvoqSZPR8ibqdYntxX7297+HiwYe2tnZ8e9u++25/pNM42HZG7+Np+93ReLCBtG4/9fyI//OKenxx0HKpwGEaQMpC4DEeNQAAC8DSH1YBmNL5vAIgfs2QbECmFkCNeTk9wAOCDwkyDAAMwYUuKTAUxqfW1NadfeHM1JkXrK+uP/eU+pqNpxQm1qwpja+aLlbGx0OxUMI+AkaJRgFBYtQZABgw+OgpXXIvU/3jiIAJX0CNAXHQmL/3oi4UABVG5SBIg2UIvOdOU4kCFPEzYZTR4/pwwaciY1oNApxeCO+5TUPwgIAKu0y8pAVSoBSxJgGiHVci6jyvQqe5EBoH94TF3TtK89sf7u7esmNu2527G4tzNJQjL34eeEwpv4UAOeJfSvvNQyexvwFBTuyPqsCV1gEAbGD4nv4PcUeREqxkGadhAL0nNbKBQh6l6x4UfDEQgYA9l6T+MrUFzqt7MGABcEQ5MoWUacViet703fAafE8GuGKxWFx1ypkTq057wszkxnPXjK3ftLYyvX51ZdWamWJ9arpYHR/vF8t1CiFILCKBgUMKDjSTeGGZ22Deze6Jz1t5DMiChDp6HysgdNd+gax3t1MABfbpNWQLBjw/Pj+CABs/XucFP33Me+u0DmHQo8P/67kOnFMUEGNVozIj0HrNclDsrpJfN3Sb84XG3P7e4t5d/YM7d3b2PLBzadc9e5Z2b5t3cXxqMP7vDOXX0R8DYUBOK+8AJR9i+D4bwO+h0CBpElpJabAHI+/5V+T9vWEvEyXYUz4U8IaTpw0MNP34sl+tCkzZwEA5sKsohDGPDAOGgALevxwAANjwGnxH/70ZHCam19cnTzl9fHrDWdOl6VNXTZ1y+kyvvnqmPrVmqlebXFWsjo0VyrV6L5SqVLFEjUm8u5F6XvodolTehQdrR2zgy4mzzyltj45U0CfpCbDVYGnDrPjmRbVI0/XTVRxE9sBSeYnxZ85RT3KQ/jtGwss1m4nwlY18qmzUsr8j/exS0Q0LfL1Q7Pea/XZjsdRdmguNA/sKi3v3dPZt37O0/6H9zT1b9y3u20HDNj2FTw0k9fAwJv7pjH4YO/DU23vhlO5ndICcXgAGgGUqAPPCBv/Zh+X5se5WygD8Ok01gTwASPWBVCPwfxeTIiH2yDkFQb5MeFgDUlqlmMdU2NClTCTDEFJm4wFh2O8ACQuTqtV6eWL1mmp56tTx9RtOH2uPrV617tTTp9u1ibHi+Nqp8fGJerNQmwi18fFSqVLpl6v1dq9ULpeKxXKpUGAVuhdCqaQFTqpOkzbBxMIp5RJ/u7Shfy7aWra70BURxZg7CUEyBhxBJgp+ObTf4npBo6zxy/Eh4AFwKMWG2fkEklTdSY+12p1epdhvFdrNpW6ntTTWX5prLc0tVNtz+xuzu+YKB3ftn929fa41+/BC48DeBvoTlXulhg7D1sCIL6MXyrzBpx41TwNIjc+MP6n084bP3X9J3n9YN2Ba/z9MWEy/w4q9fp4xr4QBpK/JM4phZcJ5gt5AGXE1KQPWNuHcYiAYbyL8pfpEauR5zwMQ8Fz6vfzjeSFDHiDiGAYMevH48WKxWKiPryrXxqcr5em19Q2nrKs1i/Vqu7ZmcmJ6emxiYqKyVJiY6NcmxmuVSrlSG692y2PjhVKlymORKKVZrtZCqVyhpGY/FIr0j5MaxaIOPmGibsE2GR+nQPVESP1uS9109r7CkI3Si7Gj9oDez7MZFWBk622pu5S2/z53bEr8LXO8+zwbrNOlIpp+p9UKvV43dBpLxe7SwtJSox2ai4uTxcWD+/btaZSXZufGw8Lizl07G/35PYsLs/ubvU4LRmDfyMmmeZ7dv27A2PWm+MdTQ8+wAf2sVOjj9yyTCsRzZtB4bU4bsA8dhlUTpsCjN1g0zkEZeWUmfTgMII895BnNMLEwNfw0z8+ensAg7QvA3ICcQSN2jJy435/HMEBYzuh9+ACDpmMOeH8X+eN5fB7dIJxHCgp5IJGCNIMGJSmKxXKhVKmUKhMz1dLYVLVSqxZDoVwq1uql+vh4pVmZqo/Xxyplnp9WKvYKZX6+XK+Xe6WxWq9UqPT7xWKtXC6snqxhOk+ByHW/XyiQT+5RbW2h0OcT7vGuijzxmubettq9/r75piQcu+1OtddqtdtLzW6n1S12aO+udrfRaPZCa3Gp3zrYbJGBdxvd1uJSp9DYv9RaWuh0Oq1+r9Mitd3/B4PkSEm9Jf3uRa28RZ/n8dnbOxoPQMjzmmmYkBfrGzNIQoO8mB+P0Xvg+TEEJH39csaeBzjDvmuC4iszfiy8lb86/5UeRLzn855zOcqeBwAZxjAEDAAQeawjY+hDWMIwyp/HBPIeMwDQcIL+JnDzjMAbd8oUljN8f00BJgOgMOTGGcsgSbJIAxWL5UK1Xi8VKuPlUKrxfmuVUqlwyqq6bJpapBxcqcDJQ5q+kjHLbp8kC7LDUij0mu1uf/fsEi+4QrfdDe2lTqc13+20Wl1piaMymtiSlHgmv1C91/L0Nf09pbbGBuJc3gylH2bsAI88RpDn8VPv7sMDA4082q+1/N5jL0fjYeheR/AgkoYs+H7+52Hb8JEwgLwPzQOD1NCGeeRhIAGjMg2A1p7qBniPN3jSD9Jj4Xl7nRqtfx8MOvXUw0KDlDXg/R4E/WPClOU//94UiIe9Jr3eKdCsFCAOZ7EsF1+Oei7PuHEO/jkYqPbh8Uu89897rTdqGEReSLDcY/wZCiap180YfY73N5BQWk/n4GsAvOHnAUgKEqmxp+edXrfDuZeZ9zzaAJAuQr+4h9HslQBCxsCTsWP8nLIE/j0vDHAlw8M+z4zVvXbZ0CAx5DyjHmboHiTS3/MAwe6TA5FhwDEKmPF8eu9TGrkcrcx9rfPIw7zUME/vjTc15FF/p2HBMJpPwDKM7nvjJDBINQHE+2yQauzLhgo5KcLMZyQZirxzToH1sGn+cijxWAJAnsfK827eSPKMc8B75xT3eI9Pn2usoepqFoYNsqjdAAAD+UlEQVTUBYxKEeaCgGMQqZEPi/W9LuBZQN7v3kjTe5THsvzr8xZK+p7l1kRK0/Pu43KLMw8c8o6ZhgDLUX//2gGDHxIK4D2phgCP7w3Yv9ZrB2TsqaGvxJDxHjAK79nzQpBhAHjEHn7UAY4mAKTsIKWw/u/l4vBh2oIHimGgYY87xuABID0GGMUoJmDsQb9k5vUroP7DWAA9TosnBc5hXjwFk9QYV3K/8Z70s/0ixXPe0+d5/WGGn7fg6TFv3AgF8mjwKKrM78kp4LFjuaq+1MjzjNUbbR6LSMFkmM6wHOjhnj4mnn4YEKxkQYwCkSN9Ps875VHn1AhTI89jEnmvScElF2yUOfAxXUjgDT33HPW13hBT4877G69P35dr6AmgDAPWvPuykvs9agH6RZxZtENCgBQY8tiDN/K813t9wBsXQCMFCRg/KHtqwAOvT2oD8l4/LLRYERjphRp67Y7UiA73/StZEId77CN533LsYDkDyvPguV7deeqVAEIKPmaoyiQADKyju2OPAgIz/Jz3pd48BYk8cMjz2kd6j1ODHeb9U6+O8yPDwXv4WAoUw4DAHyfjMd37YNjD2EH6uBcL857zjw2Lx/MMPT3XvL9TQDsSu3jU33uki+NRP6FlDrgcKOBt3vg8UHgjzzPKlD2Meo0ZfI4Q6J9Lj5MxascyBow9R+xLv38KACu9l6NeN4oB4HPzvFm62O1Yznjp8zNUvxV7IfMosgeKYc+PejzP4496jL5LXpYhBbr0Ovjz9WB5NG1lxZ81ajGs+EDH4IVp6EAXfhhI5Bn0csa5EtruPyv1+j53nxcqpN58FLil92nU3wOAcgT3J/XU/lApWOT97R8b5fWXM67UyGGgKwWI1DvnGW4eo0jPCX+nxr1S4DyCW/Hov/VEBoD0avgbkoJD3mtHhRmpkeYZrT9G3u+pIXpgyXvOe/W8ezPM8Ifdx+Xur39uucU77Lk8w/bsIL3meQacBy553nwYs/AGO8xQR73Xn/NygHZCGvgoyDiZAGDUd/UGnPfaPNAY9hjAJmUK3oBHAUj62vT80s8+FEAYdS2G3feVLvLljH+YQQ17Tx4rSIFkGFCkxp3396jH8q7VSq/DqOt83D//eAOA5W7IqGuxHO0exjiWM9pRNH45FrNSzz4K6PK89KhFuxJGkMcEVupd844/Cjy8kS/HQvx3e9wY+ZEs+lGL4fHy/ChwyPPmw65NGgZ47WLUcTzzGHXtV3rOo47zaBpUHgikochKDPPRes1Kv/tJ+7pHe5GctBfqCL/YoVxnvDYPGI4nMF+JEXrwAHgdyqU8lM84lON+97V6BQ5lYX73op2YV+BI7vF3DfDEvOcrPuv/D/+FFnCGwlbVAAAAAElFTkSuQmCC";this._defaultUserLargeImageUrl=
McxPathFinder.getFullPath("$McxApplication/assets/img/authenticationPanel/default-user-large.png")||this._defaultUserSmallImageUrl;this.initialize();this.bindEvents()}
McxAuthenticationPanel.prototype.initialize=function(){this._loginButton=$("<a/>").addClass("mcx-menu-login-button").attr("href","#").append($("<img/>").addClass("mcx-menu-login-button-image")).append($("<span/>").addClass("mcx-menu-login-button-label").html(McxLocalizationManager.getLocaleValue("McxApplication-logIn")).attr("data-localize","McxApplication-logIn").css("vertical-align","middle"));this._changePasswordButton=$("<div/>").append($("<button/>").html(McxLocalizationManager.getLocaleValue("McxApplication-changeButton")).attr("data-localize",
"McxApplication-changeButton").addClass("mcx-menu-change-button").addClass("mcx-input"));this._logoutButton=$("<div/>").append($("<button/>").html(McxLocalizationManager.getLocaleValue("McxApplication-Logout")).attr("data-localize","McxApplication-Logout").addClass("mcx-menu-logout-button").addClass("mcx-input"));McxLocalizationManager.localizeContent(this._loginButton);this._floatPanel=$("<div/>").addClass("mcx-menu-user-panel");this._rootElement=$("<div/>").addClass("mcx-menu-user-auth-button-panel");
this._rootElement.append(this._loginButton);this._rootElement.append(this._floatPanel)};McxAuthenticationPanel.prototype.bindEvents=function(){var a=this;this._loginButton.click(function(b){mcx.isDefAndNotNull(a._user)?$(a._rootElement).toggleClass("state-open"):(new McxUserAuthenticationAction).execute()});this._logoutButton.click(function(a){a=window.location.href.replace("#","");window.location=a.split("?")[0]});this._changePasswordButton.click(function(){(new McxUserPasswordChangeAction).execute()})};
McxAuthenticationPanel.prototype.getContent=function(){return this._rootElement};
McxAuthenticationPanel.prototype.setUser=function(a){this._user=a;mcx.isDefAndNotNull(a)&&(a.getImageUrl()&&this._loginButton.find(".mcx-menu-login-button-image").prop("src",a.getImageUrl()),this._loginButton.find("span").replaceWith($('<span class="mcx-menu-login-button-label">'+a.getDisplayName()+"</span>")),this._floatPanel.html("").append($("<span/>").addClass("mcx-menu-user-auth-button-panel-arrow")).append($("<table/>").css("width","100%").css("height","100%").append($("<tr/>").append($("<td/>").css("width",
"50%").css("padding","10px").append($("<img/>").prop("src",a.getImageUrl())).append($("<div/>").html(this._user.getDisplayName()).css({color:"#222222","margin-top":"10px","max-width":"80px",overflow:"hidden",padding:"2px 0","text-overflow":"ellipsis"}))).append($("<td/>").css("background","#eee").css("padding","10px").append($("<div/>").append(this._changePasswordButton).append(this._logoutButton))))));McxLocalizationManager.localizeContent(this._logoutButton)};
McxAuthenticationPanel.prototype.getUser=function(){return this._user};js.app.McxApplication.Controller={};js.app.McxApplication.Controller.McxFeatureExplorerController={};function McxFeatureExplorerController(){mcx.base(this);this.base=this}mcx.inherits(McxFeatureExplorerController,McxIdentifyController);McxFeatureExplorerController.prototype.onStartInteraction=function(){this.base.featureExplorerDialog=McxApplication.getFeatureExplorerDialog();this.base.featureExplorerDialog.setMapInteractionFactory(new McxMapInteractionFactory)};
McxFeatureExplorerController.prototype.showFeatureExplorerDialog=function(){McxApplication.addFloatingDialog(this.base.featureExplorerDialog,!1,!0,!1,!1,!1,!0,!1)};js.app.McxApplication.Dialog={};js.app.McxApplication.Dialog.AuthenticationDialog={};js.app.McxApplication.Dialog.AuthenticationDialog.McxUserAuthenticationAction={};function McxUserAuthenticationAction(){}
McxUserAuthenticationAction.prototype.execute=function(){if(mcx.isInstanceOf(McxApplication.getSecurityManager(),McxCloudSecurityManager)){var a=new McxUserAuthenticationDialog;McxApplication.addFloatingDialog(a,!0,!1,!1,!1,!1,!1,!1)}else McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxApplication-LoginNotSupportedOnLocalService"),McxMessageBoxType.Error,McxDialogButtons.ok)};McxUserAuthenticationAction.prototype.isInstanceOf=function(a){return"McxUserAuthenticationAction"==a};js.app.McxApplication.Dialog.AuthenticationDialog.McxUserAuthenticationDialog={};
function McxUserAuthenticationDialog(){mcx.base(this);this._rememberMeKey="mcxAuthenticationRememberMe";this._loginUserNameKey="mcxAuthenticationUserName";this._loginPasswordKey="mcxAuthenticationPassword";this._loginNodeKey="mcxAuthenticationNode";this._forgotPasswordKey="mcAuthenticationForgotPassword";this._nodeArray=null;this._nodeSelectBox=new McxSelectBox;this._rememberMeCheckBox=new McxCheckBox;this._userNameTextBox=new McxTextBox;this._passwordTextBox=new McxTextBox(McxTextBoxType.Password);
this._emailTextBox=new McxTextBox;this._forgotPasswordButton=$("<div/>");this.base=this;this._rootElement=$("<div/>");this._loginPanel=new McxPanel;this._forgotPasswordPanel=new McxPanel;this._recoverEmailTextBox=this._recoverUserNameTextBox=this._recoverLoginButton=this._recoverNodeSelectBox=null;this._containerElement=$("<div/>");this._isRecover=!1;this._nodeList=null}mcx.inherits(McxUserAuthenticationDialog,McxDialog);McxUserAuthenticationDialog.prototype.getDialogId=function(){return"mcxUserAuthDialog"};
McxUserAuthenticationDialog.prototype.initialize=function(){this._rootElement.width(350);this._rootElement.css("overflow","hidden");this._containerElement.width(850);this._rootElement.append(this._containerElement);this._nodeList=McxApplication.getSecurityManager().getNodes();this.createLoginPanel();this.createRecoverPanel();this.rememberLogInInfo();this.base.getSubmitHandler().addListener(this.onSubmit,null,this)};
McxUserAuthenticationDialog.prototype.onSubmit=function(a){if(a.getIsValidated())if(this.setAsBusy(),this._isRecover){var b=this._recoverUserNameTextBox.getValue(),c=this._recoverNodeSelectBox.getSelectedValue(),d=this._recoverEmailTextBox.getValue();if(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(d)){var e=new McxAjaxParameter;e.setParameters(this,function(){McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("mcxAuthenticationEmailSuccessMessage"),
McxMessageBoxType.Information);a.setIsValidated(!1)},function(b){McxMessageBox.show(null,b.getExceptionMessage().getException(),McxMessageBoxType.Error);a.setIsValidated(!1)});McxApplication.getSecurityManager().recoverPassword(parseFloat(c),b,d,e)}else McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("mcxAuthenticationEmailFormatMessage"),McxMessageBoxType.Error),a.setIsValidated(!1),this.setAsIdle()}else b=this.getUserName(),c=this.getPassword(),d=this.getNode(),e=new McxAjaxParameter,
e.setParameters(this,function(b){a.setIsValidated(b.getResult());this.saveLoginInfo();this.setAsIdle()},function(b){a.setIsValidated(b.getResult());McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("mcxAuthenticationFailedMessage"),McxMessageBoxType.Error);this.setAsIdle()}),McxApplication.getSecurityManager().authorizeUser(d.getId(),b,c,e)};
McxUserAuthenticationDialog.prototype.createLoginPanel=function(){this._loginPanel.getContent().addClass("mcx-login-panel");this._nodeSelectBox.setValueGetter("getId");this._nodeSelectBox.setTextGetter("getName");this._nodeSelectBox.addItemRange(this._nodeList);this._rememberMeCheckBox.setText(" ",this._rememberMeKey);this._forgotPasswordButton.attr("data-localize",this._forgotPasswordKey);this._forgotPasswordButton.text(McxLocalizationManager.getLocaleValue(this._forgotPasswordKey));this._forgotPasswordButton.on("click",
$.proxy(this.forgotPassword,this));var a=new McxLabeledEditor("Node",this._nodeSelectBox);a.setLabelLocalizationKey(this._loginNodeKey);this._loginPanel.addControl(a);a=new McxLabeledEditor("User Name",this._userNameTextBox);a.setLabelLocalizationKey(this._loginUserNameKey);this._loginPanel.addControl(a);a=new McxLabeledEditor("Password",this._passwordTextBox);a.setLabelLocalizationKey(this._loginPasswordKey);this._loginPanel.addControl(a);a=new McxLayoutRow;a.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center);
a.createAndAddSpan(3,new McxLabelControl);a.createAndAddSpan(4,this._rememberMeCheckBox);a.createAndAddSpan(5,this._forgotPasswordButton).getContent().css("text-align","right").css("padding","5px 0").css("cursor","pointer").css("color","#3d9ac4");this._loginPanel.addControl(a);this.base.addChild(this._containerElement,this._loginPanel);this.base.setOkButtonText("Log In","mcxUserAuthenticationLogin")};
McxUserAuthenticationDialog.prototype.forgotPassword=function(){this._isRecover?(this._loginPanel.getContent().removeClass("mcx-login-inactive"),this._forgotPasswordPanel.getContent().removeClass("mcx-recover-active"),this._forgotPasswordPanel.getContent().addClass("state-hidden"),this.base.setOkButtonText(McxLocalizationManager.getLocaleValue("mcxUserAuthenticationLogin"),"mcxUserAuthenticationLogin"),this._isRecover=!1):(this._loginPanel.getContent().addClass("mcx-login-inactive"),this._forgotPasswordPanel.getContent().addClass("mcx-recover-active"),
this._forgotPasswordPanel.getContent().removeClass("state-hidden"),this.base.setOkButtonText(McxLocalizationManager.getLocaleValue("mcxUserAuthenticationRecover"),"mcxUserAuthenticationRecover"),this._isRecover=!0)};
McxUserAuthenticationDialog.prototype.createRecoverPanel=function(){this._forgotPasswordPanel.getContent().addClass("mcx-recover-panel state-hidden");this._recoverNodeSelectBox=new McxSelectBox;this._recoverNodeSelectBox.setValueGetter("getId");this._recoverNodeSelectBox.setTextGetter("getName");this._recoverNodeSelectBox.addItemRange(this._nodeList);this._recoverLoginButton=$("<div/>");this._recoverLoginButton.attr("data-localize","mcxUserAuthenticationLogin");this._recoverLoginButton.text(McxLocalizationManager.getLocaleValue("mcxUserAuthenticationLogin"));
this._recoverLoginButton.on("click",$.proxy(this.forgotPassword,this));var a=new McxLabeledEditor("Node",this._recoverNodeSelectBox);a.setLabelLocalizationKey(this._loginNodeKey);this._forgotPasswordPanel.addControl(a);this._recoverUserNameTextBox=new McxTextBox;a=new McxLabeledEditor("User Name",this._recoverUserNameTextBox);a.setLabelLocalizationKey(this._loginUserNameKey);this._forgotPasswordPanel.addControl(a);this._recoverEmailTextBox=new McxTextBox;a=new McxLabeledEditor("Password",this._recoverEmailTextBox);
a.setLabelLocalizationKey("mcxUserAuthenticationEmail");this._forgotPasswordPanel.addControl(a);a=new McxLayoutRow;a.setSpanAlignmentMode(McxLayoutSpanAlignmentMode.center);a.createAndAddSpan(3,new McxLabelControl);a.createAndAddSpan(4,new McxLabelControl);a.createAndAddSpan(5,this._recoverLoginButton).getContent().css("text-align","right").css("padding","5px 0").css("cursor","pointer").css("color","#3d9ac4");this._forgotPasswordPanel.addControl(a);this.base.addChild(this._containerElement,this._forgotPasswordPanel);
this.rememberLogInInfo()};McxUserAuthenticationDialog.prototype.saveLoginInfo=function(){var a=this._rememberMeCheckBox.isChecked(),b=new McxStorageSettingsManager;a?(b.write(this._loginUserNameKey,this.getUserName(),null),b.write(this._loginNodeKey,this.getNode().getId(),null)):(b.delete(this._loginUserNameKey,null),b.delete(this._loginNodeKey,null));b.write(this._rememberMeKey,this._rememberMeCheckBox.isChecked().toString(),null)};
McxUserAuthenticationDialog.prototype.rememberLogInInfo=function(){var a=new McxStorageSettingsManager,b=a.read(this._rememberMeKey,null).getSettings();null!=b&&0!=b.length&&"true"==b[0]&&(b=a.read(this._loginUserNameKey,null).getSettings(),null!=b&&0!=b.length&&(b=b[0],a=a.read(this._loginNodeKey,null).getSettings(),null!=a&&0!=a.length&&(a=a[0],this._nodeSelectBox.setSelectedValue(a),this._userNameTextBox.setValue(b),this._recoverNodeSelectBox.setSelectedValue(a),this._recoverUserNameTextBox.setValue(b),
this._rememberMeCheckBox.checked(!0))))};McxUserAuthenticationDialog.prototype.setNodes=function(a){this._nodeArray=a};McxUserAuthenticationDialog.prototype.getDialogTitle=function(){return"mcxUserAuthenticationDialogTitle"};McxUserAuthenticationDialog.prototype.getLocalizationPath=function(){return"$McxApplication/Dialog/AuthenticationDialog/assets/locale/mcxUserAuthenticationDialog"};McxUserAuthenticationDialog.prototype.getUserName=function(){return this._userNameTextBox.getValue()};
McxUserAuthenticationDialog.prototype.getPassword=function(){return this._passwordTextBox.getValue()};McxUserAuthenticationDialog.prototype.getNode=function(){return this._nodeSelectBox.getSelectedItem()};McxUserAuthenticationDialog.prototype.getDialogButtons=function(){return McxDialogButtons.ok};McxUserAuthenticationDialog.prototype.getDialogToolButtons=function(){return McxDialogToolButtons.none};McxUserAuthenticationDialog.prototype.getDialogSize=function(){return McxDialogSize.auto};
McxUserAuthenticationDialog.prototype.getContent=function(){return this._rootElement};js.app.McxApplication.Dialog.AuthenticationDialog.McxUserPasswordChangeAction={};function McxUserPasswordChangeAction(){this._dialog=null}
McxUserPasswordChangeAction.prototype.execute=function(){mcx.isInstanceOf(McxApplication.getSecurityManager(),McxCloudSecurityManager)?(this._dialog=new McxUserPasswordChangeDialog,this._dialog.getSubmitHandler().addListener(this.onDialogSubmit,null,this),McxApplication.addFloatingDialog(this._dialog,!0,!1,!1,!1,!1,!1,!1)):McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxApplication-LoginNotSupportedOnLocalService"),McxMessageBoxType.Error,McxDialogButtons.ok)};
McxUserPasswordChangeAction.prototype.onDialogSubmit=function(a){if(a.getIsValidated()){var b=this._dialog.getCurrentPassword(),c=this._dialog.getPassword(),d=this._dialog.getPasswordRepeat(),e=/^.*(?=.{8,})(?=.*[a-zA-Z])(?=.*\d).*$/;c!=d?(McxMessageBox.show("",McxLocalizationManager.getLocaleValue("mcxAuthenticationPassMatchMessage"),McxMessageBoxType.Error),a.setIsValidated(!1)):e.test(c)&&e.test(d)?(d=new McxAjaxParameter,d.setParameters(this,function(){McxMessageBox.show("",McxLocalizationManager.getLocaleValue("mcxAuthenticationPassSuccessMessage"),
McxMessageBoxType.Information)},function(b){McxMessageBox.show("",b.getExceptionMessage().getException(),McxMessageBoxType.Error);a.setIsValidated(!1)}),McxApplication.getSecurityManager().changePassword(b,c,d)):(McxMessageBox.show("",McxLocalizationManager.getLocaleValue("mcxAuthenticationPassFormatMessage"),McxMessageBoxType.Error),a.setIsValidated(!1))}};McxUserPasswordChangeAction.prototype.isInstanceOf=function(a){return"McxUserPasswordChangeAction"==a};js.app.McxApplication.Dialog.AuthenticationDialog.McxUserPasswordChangeDialog={};function McxUserPasswordChangeDialog(){mcx.base(this);this.base=this;this._rootElement=$("<div/>");this._repeatPasswordText=this._newPasswordText=this._currentPasswordText=null}mcx.inherits(McxUserPasswordChangeDialog,McxDialogBase);
McxUserPasswordChangeDialog.prototype.initialize=function(){this._currentPasswordText=new McxTextBox(McxTextBoxType.Password);this._newPasswordText=new McxTextBox(McxTextBoxType.Password);this._repeatPasswordText=new McxTextBox(McxTextBoxType.Password);this.base.addChild(this._rootElement,new McxLabeledEditor("Current Password",this._currentPasswordText,"mcxAuthenticationCurrentPass",4));this.base.addChild(this._rootElement,new McxLabeledEditor("Password",this._newPasswordText,"mcxAuthenticationPass",
4));this.base.addChild(this._rootElement,new McxLabeledEditor("Re-Password",this._repeatPasswordText,"mcxAuthenticationRePass",4));this.base.setOkButtonText("Change","mcxAuthenticationChangeButton")};McxUserPasswordChangeDialog.prototype.getCurrentPassword=function(){return this._currentPasswordText.getValue()};McxUserPasswordChangeDialog.prototype.getPassword=function(){return this._newPasswordText.getValue()};McxUserPasswordChangeDialog.prototype.getPasswordRepeat=function(){return this._repeatPasswordText.getValue()};
McxUserPasswordChangeDialog.prototype.getDialogTitle=function(){return"mcxUserAuthenticationChangeTitle"};McxUserPasswordChangeDialog.prototype.getLocalizationPath=function(){return"$McxApplication/Dialog/AuthenticationDialog/assets/locale/mcxUserAuthenticationDialog"};McxUserPasswordChangeDialog.prototype.getDialogButtons=function(){return McxDialogButtons.okCancel};McxUserPasswordChangeDialog.prototype.getDialogSize=function(){return McxDialogSize.medium};
McxUserPasswordChangeDialog.prototype.getContent=function(){return this._rootElement};js.app.McxApplication.Docking={};js.app.McxApplication.Docking.McxCloseDockPaneRequestEventArgs={};function McxCloseDockPaneRequestEventArgs(a,b){mcx.base(this,null);this._dockPane=a;this._dockBar=b}mcx.inherits(McxCloseDockPaneRequestEventArgs,McxEventArgs);McxCloseDockPaneRequestEventArgs.prototype.getDockPane=function(){return this._dockPane};McxCloseDockPaneRequestEventArgs.prototype.getDockBar=function(){return this._dockBar};js.app.McxApplication.Docking.McxDockBar={};
function McxDockBar(a){this.ul=a;this.zIndex=0;this.dockPaneHeight=50;this.dockPaneWidth=120;this.horizontalPaneHeight=230;this.dockContentWidth=480;this.unDockRequestHandler=new McxEventHandler;this.onCloseDockPaneRequestHandler=new McxEventHandler;this.resizeEventHandler=new McxEventHandler;this.onPinChangeHandler=new McxEventHandler;this.onBeforeShowDockContentHandler=new McxEventHandler;this._dockPanes=[];this._resizeHandleBottom=this._resizeHandleRight=this._resizeHandleLeft=null;this.screenPosition=
McxDockBarScreenPosition.left;this.init()}
McxDockBar.prototype.init=function(){$(this.ul).addClass("dockBar").css({listStyle:"none",margin:"0px",padding:"0px"});this._resizeHandleLeft=$("<li/>").addClass("dock-resize-handle").addClass("dock-resize-handle-left");this._resizeHandleRight=$("<li/>").addClass("dock-resize-handle").addClass("dock-resize-handle-right");this._resizeHandleBottom=$("<li/>").addClass("dock-resize-handle").addClass("dock-resize-handle-bottom");$(this.ul).append(this._resizeHandleLeft);$(this.ul).append(this._resizeHandleRight);
$(this.ul).append(this._resizeHandleBottom);$(this.ul).delegate(".dock-resize-handle","mousedown",function(){$(this).addClass("active-handle")});this.initResizeHandlers()};
McxDockBar.prototype.locateResizeHandles=function(){switch(this.getScreenPosition()){case McxDockBarScreenPosition.bottom:this._resizeHandleBottom.css("bottom",this.height()).addClass("dock-resize-handle-visible");case McxDockBarScreenPosition.right:this._resizeHandleRight.css("right",this.width()).addClass("dock-resize-handle-visible");default:this._resizeHandleLeft.css("left",this.width()).addClass("dock-resize-handle-visible")}};McxDockBar.prototype.getDockPaneHeight=function(){return this.dockPaneHeight};
McxDockBar.prototype.getDockPaneWidth=function(){return this.dockPaneWidth};McxDockBar.prototype.getDockContentWidth=function(){var a=this.dockContentWidth;McxMobile.checkIfMobile()&&(a=parseFloat($(document).width()-$(this.ul).width()));return a};McxDockBar.prototype.setDockContentWidth=function(a){this.dockContentWidth=a;for(var b=0;b<this._dockPanes.length;b++)this._dockPanes[b].setContentWidth(a)};
McxDockBar.prototype.getPinnedPaneCount=function(){for(var a=0,b=0;b<this._dockPanes.length;b++)this._dockPanes[b].isPinned()&&a++;return a};McxDockBar.prototype.width=function(){var a=$(this.ul).find(".dockPane ul.dockContent").not(".autoHideContent")[0];return $(this.ul).width()+parseFloat(a?$(a).width():0)};
McxDockBar.prototype.height=function(){if(this.getScreenPosition()==McxDockBarScreenPosition.bottom){var a=$(this.ul).find(".dockPane ul.dockContent").not(".autoHideContent")[0];return $(this.ul).outerHeight()+parseFloat(a?a.style.height.toString().replace("px",""):0)}return this.getScreenPosition()==McxDockBarScreenPosition.left||this.getScreenPosition()==McxDockBarScreenPosition.right?$(this.ul).outerHeight(!0):0};
McxDockBar.prototype.removeDockPane=function(a){for(var b=0;b<this._dockPanes.length;b++)this._dockPanes[b]==a&&(this._dockPanes.splice(b,1),a.getContent().remove(),0==this.getPinnedPaneCount()&&(this.onResize().dispatchOnSuccess(this,new McxEventArgs(null)),this.ul.addClass("state-empty")),this.locateDockContents());a.getDialog()._dockPane=null;a.setDockBar(null)};
McxDockBar.prototype.addDialog=function(a){var b=new McxDockPane(a);a._dockPane=b;b.setDockBar(this);this.getPinnedPaneCount();$(this.ul).append(b.getContent());this._dockPanes.push(b);b.setContentWidth(this.getDockContentWidth());b.setZIndex(this.zIndex++);$(".dockBar").removeClass("on-drag");this.ul.removeClass("state-empty");this.locateDockContents();this.locateResizeHandles();this.onResize().dispatchOnSuccess(this,null);this.bindEvents(b)};
McxDockBar.prototype.bindEvents=function(a){a.onPinButtonClick().addListener(function(){var a=this.getPinnedPaneCount();this.locateDockContents();1==a&&(this.onResize().dispatchOnSuccess(this),this.onPinChange().dispatchOnSuccess(this),$(this.ul).find(".dock-resize-handle-visible").show())},null,this);a.onUnPinButtonClick().addListener(function(){var b=this.getPinnedPaneCount();this.locateDockContents();0==b&&(this.onResize().dispatchOnSuccess(this,null),this.onPinChange().dispatchOnSuccess(this,
null),$(this.ul).find(".dock-resize-handle-visible").hide());a.hideDockContent()},null,this);a.onUnDockButtonClick().addListener(function(){this.onUnDockRequest().dispatchOnSuccess(this,new McxUnDockRequestEventArgs(a,this,McxUnDockRequestTriggerType.byUnDockButton))},null,this);a.getCloseButtonClickHandler().addListener(function(){this.onCloseDockPaneRequest().dispatchOnSuccess(this,new McxCloseDockPaneRequestEventArgs(a,this))},null,this);a.onContentHeaderDrag().addListener(function(b){this.onUnDockRequest().dispatchOnSuccess(this,
new McxUnDockRequestEventArgs(a,this,McxUnDockRequestTriggerType.byContentHeaderDrag,b.clientX,b.clientY,b))},null,this);var b=this;a.getContent().hover(function(){a.isPinned()||(a.setZIndex(b.zIndex++),a.showDockContent(),a.getDialog().updateLayout(),clearTimeout(a.hideInterval))},function(){a.isPinned()||(a.hideInterval=setTimeout(function(){a.hideDockContent()},400))})};
McxDockBar.prototype.initResizeHandlers=function(){var a=this,b=function(b){a._resizeHandleBottom.offset({top:b.clientY})},c=function(d){a.horizontalPaneHeight=$(window).height()-a._resizeHandleBottom.offset().top-40;a.locateDockContents();a.onResize().dispatchOnSuccess(a,null);$(window)[0].removeEventListener("mousemove",b,!0);$(window)[0].removeEventListener("mouseup",c,!0);$(".active-handle").removeClass("active-handle")},d=function(b){a._resizeHandleLeft.css("left",b.clientX-2)},e=function(b){a.dockContentWidth=
b.clientX-42;a.locateDockContents();a.onResize().dispatchOnSuccess(a,null);$(window)[0].removeEventListener("mousemove",d,!0);$(window)[0].removeEventListener("mouseup",e,!0);$(".active-handle").removeClass("active-handle")},f=function(b){a._resizeHandleRight.css("right",$(window).width()-b.clientX-2)},g=function(b){a.dockContentWidth=$(window).width()-b.pageX-42;a.locateDockContents();a.onResize().dispatchOnSuccess(a,null);$(window)[0].removeEventListener("mousemove",f,!0);$(window)[0].removeEventListener("mouseup",
g,!0);$(".active-handle").removeClass("active-handle")};this._resizeHandleLeft.mousedown(function(){$(window)[0].addEventListener("mousemove",d,!0);$(window)[0].addEventListener("mouseup",e,!0)});this._resizeHandleRight.mousedown(function(){$(window)[0].addEventListener("mousemove",f,!0);$(window)[0].addEventListener("mouseup",g,!0)});this._resizeHandleBottom.mousedown(function(){$(window)[0].addEventListener("mousemove",b,!0);$(window)[0].addEventListener("mouseup",c,!0)})};
McxDockBar.prototype.locateDockContents=function(){for(var a=$(this.ul).height()/this.getPinnedPaneCount(),b=$(this.ul).width()/this.getPinnedPaneCount(),c=0,d=0,e=$(this.ul).width(),f=$(this.ul).outerHeight(!0),g=0;g<this._dockPanes.length;g++){var h=this._dockPanes[g];if(h.isPinned()){var k=this.getScreenPosition();k==McxDockBarScreenPosition.left||k==McxDockBarScreenPosition.right?(h.setHeight(a),h.setTop(c),h.setWidth(this.dockContentWidth),this.getScreenPosition()==McxDockBarScreenPosition.left&&
(h.setLeft(e),h.setRight("auto")),this.getScreenPosition()==McxDockBarScreenPosition.right&&(h.setLeft("auto"),h.setRight(e)),c+=a):(h.setWidth("auto"),h.setContentLeft(d),h.setContentRight(e-(d+b)),h.setHeight(this.horizontalPaneHeight),this.getScreenPosition()==McxDockBarScreenPosition.bottom&&h.setBottom(f-1),d+=b)}}for(g=0;g<this._dockPanes.length;g++)h=this._dockPanes[g],h.isPinned()&&h.getDialog().updateLayout()};
McxDockBar.prototype.setScreenPosition=function(a){this.screenPosition=a;switch(a){case McxDockBarScreenPosition.bottom:$.browser.mozilla&&$(this.ul).css("overflow","hidden");$(this.ul).addClass("bottom");$(this.ul).removeClass("right");break;case McxDockBarScreenPosition.right:$(this.ul).removeClass("bottom");$(this.ul).addClass("right");break;default:$(this.ul).removeClass("right"),$(this.ul).removeClass("bottom")}this.locateDockContents()};McxDockBar.prototype.getScreenPosition=function(){return this.screenPosition};
McxDockBar.prototype.onResize=function(){return this.resizeEventHandler};McxDockBar.prototype.onPinChange=function(){return this.onPinChangeHandler};McxDockBar.prototype.onBeforeShowDockContent=function(){return this.onBeforeShowDockContentHandler};McxDockBar.prototype.onCloseDockPaneRequest=function(){return this.onCloseDockPaneRequestHandler};McxDockBar.prototype.onUnDockRequest=function(){return this.unDockRequestHandler};McxDockBar.prototype.isOnDragDropMode=function(){return $(this.ul).hasClass("on-drag")};
McxDockBar.prototype.setTop=function(a){$(this.ul).css("top",a)};McxDockBar.prototype.setBottom=function(a){$(this.ul).css("bottom",a)};McxDockBar.prototype.getContent=function(){return $(this.ul)};js.app.McxApplication.Docking.McxDockBarScreenPosition={};var McxDockBarScreenPosition={left:0,right:1,bottom:2};js.app.McxApplication.Docking.McxDockPane={};
function McxDockPane(a){this._dialog=a;this._dockBar=null;this._onPinButtonClickHandler=new McxEventHandler;this._onUnPinButtonClickHandler=new McxEventHandler;this._onUnDockButtonClickHandler=new McxEventHandler;this._onCloseButtonClickHandler=new McxEventHandler;this._onContentHeaderDragHandler=new McxEventHandler;this._dockContentHeader=this._dockContentBody=this._closeButton=this._unDockButton=this._unPinButton=this._pinButton=this._dockPaneContent=this._rootElement=null;this.init(a);this.bindEvents()}
McxDockPane.prototype.init=function(a){a.getDialogImageUrl();var b=a.getDialogTitle(),c=$("<div/>").addClass("dockPane-dialog-wrapper").append(a.getContainerElement()).append(a.getFooterElement());a.getDialogElement().hasClass("no-buttons")&&c.addClass("no-buttons");a=$("<li/>").addClass("dockPane").addClass("dockPane-open");var d=$("<img/>").attr("src",McxPathFinder.getFullPath("$McxApplication/Docking/img/dialog-image.png")).addClass("dockPaneIcon"),e=$("<span/>").addClass("dockPaneTitle").addClass("hidden-phone").attr("data-localize",
b).html(b),f=$("<ul/>").addClass("dockContent"),g=$("<li/>").addClass("dockContentHeader"),b=$("<span/>").attr("data-localize",b).html(b),h=$("<div/>").addClass("pinButton"),k=$("<div/>").addClass("unpinButton"),m=$("<div/>").addClass("unDockButton"),n=$("<div/>").addClass("dockPaneCloseButton"),c=$("<li/>").addClass("dockContentBody").append(c);g.append(b);g.append(h);g.append(k);g.append(m);g.append(n);f.append(g);f.append(c);a.append(d);a.append(e);a.append(f);this._rootElement=a;this._dockPaneContent=
f;this._pinButton=h;this._unPinButton=k;this._unDockButton=m;this._closeButton=n;this._dockContentBody=c;this._dockContentHeader=g};
McxDockPane.prototype.bindEvents=function(){var a=this,b=function(a){a.stopPropagation()};this._dockPaneContent.click(function(a){a.stopPropagation()});this._rootElement.click(function(){a.isPinned()?a.unPinDockPane():a.pinDockPane()});this._pinButton.click(function(){a.pinDockPane()});this._unPinButton.click(function(){a.unPinDockPane()});this._unDockButton.click(function(){a.onUnDockButtonClick().dispatchOnSuccess(a,new McxEventArgs(null))});this._closeButton.click(function(b){a.getCloseButtonClickHandler().dispatchOnSuccess(a,
new McxEventArgs(null))});this._pinButton.mousedown(b);this._unPinButton.mousedown(b);this._unDockButton.mousedown(b);this._closeButton.mousedown(b);this._dockContentHeader.mousedown(function(){$(this).data("isMouseDownOnHeader",!0)}).mouseup(function(){$(this).data("isMouseDownOnHeader",!1)}).mousemove(function(b){1==$(this).data("isMouseDownOnHeader")&&a.onContentHeaderDrag().dispatchOnSuccess(a,b)})};McxDockPane.prototype.onPinButtonClick=function(){return this._onPinButtonClickHandler};
McxDockPane.prototype.onUnPinButtonClick=function(){return this._onUnPinButtonClickHandler};McxDockPane.prototype.onUnDockButtonClick=function(){return this._onUnDockButtonClickHandler};McxDockPane.prototype.getCloseButtonClickHandler=function(){return this._onCloseButtonClickHandler};McxDockPane.prototype.onContentHeaderDrag=function(){return this._onContentHeaderDragHandler};McxDockPane.prototype.isPinned=function(){return!this._dockPaneContent.hasClass("autoHideContent")};
McxDockPane.prototype.setTop=function(a){this._dockPaneContent.css("top",a);this._dockPaneContent.css("bottom","")};McxDockPane.prototype.setLeft=function(a){this._dockPaneContent.css("left",a)};McxDockPane.prototype.setRight=function(a){this._dockPaneContent.css("right",a)};McxDockPane.prototype.setBottom=function(a){this._dockPaneContent.css("bottom",a);this._dockPaneContent.css("top","auto")};McxDockPane.prototype.setZIndex=function(a){this._dockPaneContent.css("z-index",a)};
McxDockPane.prototype.setHeight=function(a){this._dockPaneContent.css("height",a);this._dockContentBody.css("height",a-34)};McxDockPane.prototype.setWidth=function(a){this._dockPaneContent.css("width",a)};McxDockPane.prototype.setContentWidth=function(a){this._dockPaneContent.width(a)};McxDockPane.prototype.setContentLeft=function(a){this._dockPaneContent.css("left",a)};McxDockPane.prototype.setContentRight=function(a){this._dockPaneContent.css("right",a)};
McxDockPane.prototype.showDockContent=function(){this._dockPaneContent.css("display","block");this._dockPaneContent.css("opacity",1);switch(this.getParentDockBarScreenPosition()){case McxDockBarScreenPosition.bottom:this._dockPaneContent.css("bottom",$(this._rootElement).outerHeight(!0)+1);break;case McxDockBarScreenPosition.right:this._dockContentBody.css("height",this._dockPaneContent.height()-34);this._dockPaneContent.css("right",$(this._rootElement).outerWidth(!0));break;default:this._dockContentBody.css("height",
this._dockPaneContent.height()-34),this._dockPaneContent.css("left",$(this._rootElement).outerWidth(!0))}};
McxDockPane.prototype.hideDockContent=function(){this._dockPaneContent.css("opacity",0).css("display","none");switch(this.getParentDockBarScreenPosition()){case McxDockBarScreenPosition.bottom:this._dockPaneContent.css("bottom",0).css("left",0).css("right",0).css("width","auto");break;case McxDockBarScreenPosition.right:this._dockPaneContent.css("right",-this._dockPaneContent.width()).css("height","auto").css("top",0).css("bottom",0);break;default:this._dockPaneContent.css("left",-this._dockPaneContent.width()).css("height",
"auto").css("top",0).css("bottom",0)}};McxDockPane.prototype.getDialog=function(){return this._dialog};McxDockPane.prototype.setDockBar=function(a){this._dockBar=a};McxDockPane.prototype.getDockBar=function(){return this._dockBar};McxDockPane.prototype.getParentDockBarScreenPosition=function(){var a=this._rootElement.parents(".dockBar");return a.hasClass("right")?McxDockBarScreenPosition.right:a.hasClass("bottom")?McxDockBarScreenPosition.bottom:McxDockBarScreenPosition.left};
McxDockPane.prototype.close=function(){this._dialog.close()};McxDockPane.prototype.pinDockPane=function(){this._dockPaneContent.is(":visible")||this.showDockContent();this._dockPaneContent.removeClass("autoHideContent");this._rootElement.addClass("dockPane-open");this._pinButton.hide();this._unPinButton.show();this.onPinButtonClick().dispatchOnSuccess(this,new McxEventArgs(null))};
McxDockPane.prototype.unPinDockPane=function(){this._dockPaneContent.addClass("autoHideContent");this._rootElement.removeClass("dockPane-open");this._pinButton.show();this._unPinButton.hide();this.onUnPinButtonClick().dispatchOnSuccess(this,new McxEventArgs(null))};McxDockPane.prototype.getContent=function(){return this._rootElement};js.app.McxApplication.Docking.McxUnDockRequestEventArgs={};function McxUnDockRequestEventArgs(a,b,c,d,e,f){mcx.base(this,null);this._dockPane=a;this._dockBar=b;this._unDockRequestTriggerType=c;this._dragMouseX=d;this._dragMouseY=e;this._mouseEventData=f}mcx.inherits(McxUnDockRequestEventArgs,McxEventArgs);McxUnDockRequestEventArgs.prototype.getDockPane=function(){return this._dockPane};McxUnDockRequestEventArgs.prototype.getDockBar=function(){return this._dockBar};
McxUnDockRequestEventArgs.prototype.getUnDockRequestTriggerType=function(){return this._unDockRequestTriggerType};McxUnDockRequestEventArgs.prototype.getDragX=function(){return this._dragMouseX};McxUnDockRequestEventArgs.prototype.getDragY=function(){return this._dragMouseY};McxUnDockRequestEventArgs.prototype.getMouseEventData=function(){return this._mouseEventData};js.app.McxApplication.Docking.McxUnDockRequestTriggerType={};var McxUnDockRequestTriggerType={byUnDockButton:0,byContentHeaderDrag:1};js.app.McxApplication.Document={};js.app.McxApplication.Document.McxDocumentAddEventArgs={};function McxDocumentAddEventArgs(a){mcx.base(this,null);this._document=a}mcx.inherits(McxDocumentAddEventArgs,McxEventArgs);McxDocumentAddEventArgs.prototype.getDocument=function(){return this._document};js.app.McxApplication.Document.McxDocumentContainer={};
function McxDocumentContainer(a){this.appendToId=a;this.cssSelectorAppendTo="#"+a;this.documents=[];this.uniqueElementId=(new Date).getTime().toString();this.activeDocumentChangeEventHandler=new McxEventHandler;this.beforeActiveDocumentChangeEventHandler=new McxEventHandler;this.documentAddEventHandler=new McxEventHandler;this.addButtonClickHandler=new McxEventHandler;this._documentCloseHandler=new McxEventHandler;this.tabContainer=this.initialDocument=null;this._tabControl=new McxTabControl;this.createTabContainer()}
McxDocumentContainer.prototype.clearDocuments=function(){this._tabControl.clear()};
McxDocumentContainer.prototype.addDocument=function(a){this.documents.push(a);this.onBeforeActiveDocumentChange();var b=new McxTabPage;b.setTitle(a.getTitle());if(mcx.isInstanceOf(a,McxUserControl))b.setControl(a);else{var c=new McxPanel;c.addElement(a.getContent());b.setControl(c)}this._tabControl.addTabPage(b,!0);this._tabControl.showTab(b);this._tabControl.getContent().find(".mcx-tab-header-item").css({margin:"2px 0",padding:"5px"});this.onDocumentAdd(a);a.getTitleChangedEventHandler().addListener(this.documentTitleChanged,
null,{doc:a,tabPage:b});a.localize()};McxDocumentContainer.prototype.removeDocument=function(a){this.onBeforeActiveDocumentChange();var b=this.documents.indexOf(a);-1<b&&this.documents.splice(b,1);mcx.isInstanceOf(a,McxUserControl)?a.remove():a.getContent().remove()};McxDocumentContainer.prototype.createDocumentWithTitle=function(a){return new McxMapDocument(a)};
McxDocumentContainer.prototype.getMaps=function(){for(var a=[],b=0;b<this.documents.length;b++)null!=this.documents[b].getMap()&&a.push(this.documents[b].getMap());return a};McxDocumentContainer.prototype.getActiveDocument=function(){if(0==this._tabControl.getPages().length)return null;var a=this._tabControl.getActiveTabPage();return a?a.getControl():null};McxDocumentContainer.prototype.getActiveDocumentChangeHandler=function(){return this.activeDocumentChangeEventHandler};
McxDocumentContainer.prototype.getBeforeActiveDocumentChangeHandler=function(){return this.beforeActiveDocumentChangeEventHandler};McxDocumentContainer.prototype.getDocumentAddEventHandler=function(){return this.documentAddEventHandler};McxDocumentContainer.prototype.getAddButtonClickHandler=function(){return this.addButtonClickHandler};McxDocumentContainer.prototype.getDocumentCloseHandler=function(){return this._documentCloseHandler};
McxDocumentContainer.prototype.createTabContainer=function(){this.tabContainer=$("<div/>").attr("id",this.uniqueElementId);$(this.cssSelectorAppendTo).append(this._tabControl.getContent());this._tabControl.getContent().find(".mcx-tab-header-container").css({"z-index":999999,background:"#eee",color:"#333",padding:"0 2px",position:"absolute",right:0,border:"1px solid #ccc"});this._tabControl.getContent().find(".mcx-tab-content-container").css({bottom:0,left:0,overflow:"hidden",position:"absolute",right:0,
padding:0,"z-index":1,top:0});this._tabControl.getTabChangeHandler().addListener(function(a){this.getActiveDocumentChangeHandler().dispatchOnSuccess(this,new McxEventArgs(a.getArgs().getControl()))},null,this);this._tabControl.getBeforeTabChangeHandler().addListener(function(a){this.getBeforeActiveDocumentChangeHandler().dispatchOnSuccess(this,new McxEventArgs(a.getArgs().getControl()))},null,this);this._tabControl.getTabCloseHandler().addListener(function(a){this.getDocumentCloseHandler().dispatchOnSuccess(this,
new McxEventArgs(a.getArgs().getControl()))},null,this)};McxDocumentContainer.prototype.createUniqueKey=function(){return(new Date).getTime().toString()};McxDocumentContainer.prototype.onActiveDocumentChange=function(a){this.getActiveDocumentChangeHandler().dispatchOnSuccess(this,new McxEventArgs(a))};McxDocumentContainer.prototype.onBeforeActiveDocumentChange=function(){this.getActiveDocument()&&this.getBeforeActiveDocumentChangeHandler().dispatchOnSuccess(this,null)};
McxDocumentContainer.prototype.onDocumentAdd=function(a){this.getDocumentAddEventHandler().dispatchOnSuccess(this,new McxDocumentAddEventArgs(a))};McxDocumentContainer.prototype.documentTitleChanged=function(){this.tabPage.setTitle(this.doc.getTitle())};McxDocumentContainer.prototype.onAddButtonClick=function(){this.addButtonClickHandler.dispatchOnSuccess(this,null)};McxDocumentContainer.prototype.createDocument=function(){var a=new McxMapDocument("Test");this.addDocument(a)};
McxDocumentContainer.prototype.setLeft=function(a){$(this.cssSelectorAppendTo).css("margin-left",a)};McxDocumentContainer.prototype.setRight=function(a){$(this.cssSelectorAppendTo).css("margin-right",a)};McxDocumentContainer.prototype.setTop=function(a){$(this.cssSelectorAppendTo).css("margin-top",a)};McxDocumentContainer.prototype.setBottom=function(a){$(this.cssSelectorAppendTo).css("margin-bottom",a)};McxDocumentContainer.prototype.getDocuments=function(){return this.documents};
McxDocumentContainer.prototype.getDocumentCount=function(){return this.documents.length};McxDocumentContainer.prototype.setHeight=function(a){return $(this.cssSelectorAppendTo).height(a)};js.app.McxApplication.Document.McxDocumentFactory={};function McxDocumentFactory(){}McxDocumentFactory.prototype.createDocument=function(a){return new McxMapDocument(a)};js.app.McxApplication.Document.McxInitialDocument={};function McxInitialDocument(a){this.rootElement=null;this.title=a||"Initial";this.titleChangedEventHandler=new McxEventHandler;this.initialize()}McxInitialDocument.prototype.getContent=function(){return this.rootElement};McxInitialDocument.prototype.getMap=function(){return null};McxInitialDocument.prototype.getTitleChangedEventHandler=function(){return this.titleChangedEventHandler};McxInitialDocument.prototype.getTitle=function(){return this.title};
McxInitialDocument.prototype.setTitle=function(a){this.title=a;this.titleChangedEventHandler.dispatchOnSuccess(this,null)};
McxInitialDocument.prototype.initialize=function(){this.rootElement=$("<div/>").css("width","100%").css("height","100%").css("position","relative");$("body").append(this.rootElement);this.rootElement.append('<div class="mcx-content-area-container" style="margin-top:300px"><div class="mcx-content-area-title" data-localize="app_initialDoc_title"></div><div class="mcx-content-area"><div style="display: table-row;"><div id="initialNewMapButton" class="mcx-img-button"><div class="mcx-img-button-img-wrapper"><img src="src/js/addon/McxMapAddon/assets/img/newMap32.png"></div><div class="mcx-img-button-text-wrapper" data-localize="app_newMap_Button"><small>New Map</small></div></div><div id="initialWorkspaceDialogButton" class="mcx-img-button"><div class="mcx-img-button-img-wrapper"><img src="img/newMap.png"></div><div class="mcx-img-button-text-wrapper" data-localize="app_wsMap_Button"><small>Open Workspace</small></div></div><div id="initialOnlineMapMapButton" class="mcx-img-button"><div class="mcx-img-button-img-wrapper"><img src="src/js/addon/McxMapAddon/assets/img/maps32.png"></div><div class="mcx-img-button-text-wrapper" data-localize="app_onlineMap_Button"><small>Online Maps</small></div></div></div></div></div>');$("#initialNewMapButton").click(null,
McxInitialDocument.createNewMapDocument);$("#initialOnlineMapMapButton").click(null,McxInitialDocument.createOnlineMapDocument);$("#initialWorkspaceDialogButton").click(null,McxInitialDocument.createWorkspcaceDocument);McxLocalizationManager.applyPath(McxLocalizationPaths.getApplicationLocalePath())};
McxInitialDocument.createNewMapDocument=function(){var a=McxLocalizationManager.getLocaleValue("McxApplication-newMap"),b=new McxInputBoxDialog(a);b.getOkButtonClickHandler().addListener(function(){var a=McxApplication.createDocument(b.getValue());McxApplication.addDocument(a)},null,this);McxApplication.addFloatingDialog(b,!1,!1,!0,!0)};
McxInitialDocument.createOnlineMapDocument=function(){var a=McxApplication.createDocument("Online Map");McxApplication.addDocument(a);a=new McxOnlineMapDialog(a.getMap());a.setDataSourceList(McxOnlineMapData.getData());McxApplication.addFloatingDialog(a,!1,!0,!1,!1,!0,!0,!0)};
McxInitialDocument.createWorkspcaceDocument=function(){if(0!=McxApplication.getWorkspaces().length){var a=new McxWorkspaceSelectionDialog;a.setWorkspaces(McxApplication.getWorkspaces());McxApplication.addFloatingDialog(a,!1,!0,!1,!1,!0,!0,!0)}};McxInitialDocument.prototype.getWorkspaceInfo=function(){return null};McxInitialDocument.prototype.setWorkspaceInfo=function(a){};McxInitialDocument.prototype.setIsNeedUpdate=function(a){};McxInitialDocument.prototype.isNeedUpdate=function(){return!1};
McxInitialDocument.prototype.isInstanceOf=function(a){return"McxInitialDocument"==a};McxInitialDocument.prototype.getLegend=function(){return null};js.app.McxApplication.Document.McxMapDocument={};
function McxMapDocument(a){mcx.base(this);this.base=this;this._rootElement=this._map=null;this._title=a||"Map";this._workspaceInfo=new McxWorkspaceInfo;this._titleChangedEventHandler=new McxEventHandler;this._resultAreaClickEventHandler=new McxEventHandler;this._isNeedUpdate=!0;this._searchAreaContainer=this._searchInput=this._resultArea=null;this._offset=0;this._locked=!1;this._selectBox=this.request=null;this._mapOpenCompleteHandler=new McxEventHandler;this._legendControl=null;this._emptyAreaTimer=
this._searchTimer=0;this._dataSource=null;this.initialize()}mcx.inherits(McxMapDocument,McxUserControl);McxMapDocument.prototype.initialize=function(){var a=new McxMap;this._rootElement=$("<div/>").css("width","100%").css("height","100%").css("position","relative");this._rootElement.append(a.getContent());this.configureMap(a);this._map=a;this.createZoomControl();this.createLegendControl();this.createWaterMark();this.createSearchArea()};
McxMapDocument.prototype.onSearchAreaSettingsSuccess=function(a){var b=a.getSettings();if(!(null!=b||0<b.length)){var c=this;this._searchAreaContainer=$('<div class="search-area-container state-open" />');a=$("<div/>").addClass("search-area-textArea-container");this._searchAreaContainer.append(a);this._searchInput=new McxTextBox(McxTextBoxType.Text);this._searchInput.setWidth("99%");this._searchInput.setHeight(27);$(this._searchInput.getContent().find("input")[0]).css("max-height","99999px");this._searchInput.getKeyPressHandler().addListener(this.onSearchInputKeyPress,
null,this);this._searchInput.getContent().addClass("search-area-textInput");this._searchInput.setPlaceHolder(McxApplication.getLocaleValue("McxApplication-documentSearch"),"McxApplication-documentSearch");this._selectBox=$("<div/>").addClass("search-area-select");var d=$("<div/>").addClass("search-area-options").attr("tabindex","0");this._selectBox.append(d);a.append(this._selectBox);a.append(this._searchInput.getContent());var e=$('<div id="googleSearchInputContainer" />');e.css("display","none");
a.append(e);var e=$("<div/>").addClass("search-area-option chosen"),f=$("<div/>").addClass("search-area-option-toggle-button");d.append(f);d.append(e);for(var g=0;g<b.length;g++){var h=b[g];h&&(e=$("<div/>").addClass("search-area-option"),e.text(h.split(";")[0]),e.attr("data-value",h.split(";")[1]?h.split(";")[1]:""),d.append(e))}f.click(function(){d.toggleClass("show-all");c._searchAreaContainer.toggleClass("size-full-height");d.focus()});d.find(".search-area-option:not(.chosen)").click(function(){d.find(".search-area-option.chosen").attr("data-value",
$(this).attr("data-value").toString()).text($(this).text().toString());d.toggleClass("show-all");c._searchAreaContainer.toggleClass("size-full-height");d.focus();c.onSearchButtonClick()});d.focusout(function(){d.removeClass("show-all");c._searchAreaContainer.removeClass("size-full-height")});d.find(".search-area-option.chosen").click(function(){d.toggleClass("show-all");c._searchAreaContainer.toggleClass("size-full-height");d.focus()});b=d.find(".search-area-option").eq(1);d.find(".search-area-option.chosen").attr("data-value",
b.attr("data-value").toString()).text(b.text().toString());b=$("<div/>").addClass("mcx-search-area-toggle-button");b.click($.proxy(function(){this._searchAreaContainer.toggleClass("state-open")},this));this._resultArea=$('<div id="resultArea" />');this._resultArea.addClass("result-area-container");this._searchAreaContainer.removeClass("state-open");this._searchAreaContainer.append(b);this._searchAreaContainer.append(this._resultArea);this._searchAreaContainer.append($("<div/>").addClass("search-area-show-button").append($("<div/>").addClass("search-area-hover-area")));
this._rootElement.append(this._searchAreaContainer);this._rootElement.mousemove(function(a){var b=a.pageY-$(this).offset().top;a=a.pageX-$(this).offset().left;200<b&&600<a&&0==c._searchAreaContainer.hasClass("state-hidden")&&c._searchAreaContainer.addClass("state-hidden")});a.hover($.proxy(this.onHover,this));d.hover($.proxy(this.onHover,this));this._resultArea.hover($.proxy(this.onHover,this));$(".search-area-hover-area").hover($.proxy(this.onHover,this))}};
McxMapDocument.prototype.onHover=function(a){this._searchAreaContainer.hasClass("state-hidden")&&this._searchAreaContainer.removeClass("state-hidden");a.stopPropagation()};McxMapDocument.prototype.getContent=function(){return this._rootElement};McxMapDocument.prototype.getMap=function(){return this._map};McxMapDocument.prototype.getTitleChangedEventHandler=function(){return this._titleChangedEventHandler};McxMapDocument.prototype.getTitle=function(){return this._title};
McxMapDocument.prototype.setTitle=function(a){this._title!=a&&(this._title=a,this._titleChangedEventHandler.dispatchOnSuccess(this,new McxEventArgs(this)))};McxMapDocument.prototype.getDataSource=function(){var a,b=McxApplication.getSecurityManager().getValueFromDictionary("App.Main.Datasource.Search");null!=b&&0<b.length&&(a=b[0]);if(!a)return null;b=new McxAjaxParameter;b.setAsync(!1);return McxApplication.getDriverManager().registerDataSource(a,!1,b).getDataSource()};
McxMapDocument.prototype.configureMap=function(a){var b=new McxRenderer(a);a.setRenderer(b);a.setLayerCollection(b);this._map=a;b=new McxCanvasProvider;a.getRenderer().addCanvasProvider(b);var b=new McxPointSnapEngine(this._map),c=new McxVertexSnapEngine(this._map),d=new McxIntersectionSnapEngine(this._map),e=new McxMidPointSnapEngine(this._map),f=new McxPerpendicularSnapEngine(this._map),g=new McxNearestSnapEngine(this._map),h=new McxEnvelopeCenterSnapEngine(this._map);a.addSnapEngine(b);a.addSnapEngine(c);
a.addSnapEngine(d);a.addSnapEngine(f);a.addSnapEngine(e);a.addSnapEngine(g);a.addSnapEngine(h);b=new McxNativeInputHandler(a);a.setInputHandler(b);a.setDisplay($(window).width(),$(window).height())};McxMapDocument.prototype.createZoomControl=function(){var a=new McxScaleControl(this._map);this.base.addChild(this._rootElement,a)};McxMapDocument.prototype.createLegendControl=function(){var a=new McxLegendControl;this.base.addChild(this._rootElement,a)};
McxMapDocument.prototype.createWaterMark=function(){var a=new McxRenderStatusWatermark;a.setMap(this._map);this._rootElement.append(a.getContent())};McxMapDocument.prototype.createSearchArea=function(){var a=new McxAjaxParameter;a.setParameters(this,this.onSearchAreaSettingsSuccess,null);McxSettingsManager.read("App.Main.Search.Option",a)};
McxMapDocument.prototype.createWatermark=function(){var a,b=new McxAjaxParameter;b.setParameters(this,function(b){0<b.length&&(a=b[0]);if(a){var d=this;McxAjaxServiceCall.getAjaxCall(a,null,null,"html",!0,null,!0,function(a){a=$(a);0<a.length&&d.getContent().append(a)},null)}},null);McxApplication.getSecurityManager().getValueFromDictionary("App.Main.Widget",b)};McxMapDocument.prototype.getWorkspaceInfo=function(){return this._workspaceInfo};
McxMapDocument.prototype.setWorkspaceInfo=function(a){this._workspaceInfo=a};McxMapDocument.prototype.setIsNeedUpdate=function(a){this._isNeedUpdate=a};McxMapDocument.prototype.isNeedUpdate=function(){return this._isNeedUpdate};McxMapDocument.prototype.getLegend=function(){return this._legendControl};McxMapDocument.prototype.onSearchFailed=function(){};
McxMapDocument.prototype.onSearchInputKeyPress=function(){0<this._searchTimer&&clearTimeout(this._searchTimer);null!=this.request&&this.request.abort();2<this._searchInput.getValue().length?this._searchTimer=setTimeout($.proxy(this.onSearchButtonClick,this),1E3):$(this._resultArea).empty()};McxMapDocument.prototype.onSearchButtonClick=function(){this._offset=0;$(this._resultArea).scrollTop(0);$(this._resultArea).empty();this.search(11);this._locked=!1};
McxMapDocument.prototype.search=function(a){if(!(!this._dataSource||null===this._dataSource||1>this._searchInput.getValue().length||this._locked)){null!=this.request&&this.request.abort();this._searchAreaContainer.addClass("state-open");this.createRequestLoadingArea();var b,c=this._selectBox.find(".search-area-option.chosen");c&&(c=c.attr("data-value"),"GOOGLE_SEARCH"===c?(this.createRequestLoadingArea(),this.searchGoogle(this._searchInput.getValue())):"CUSTOM_SEARCH"===c?(this.createRequestLoadingArea(),
this.searchGeneral(this._searchInput.getValue())):""!==c&&(b=c.replace("#text","'"+this._searchInput.getValue()+"'"),b=b.replace("#limit",a.toString()),b.replace("#offset",this._offset.toString()),b=new McxAjaxParameter,b.setAsync(!1),a=this._dataSource.getLayer("full_text_search@"+c+"@"+this._searchInput.getValue()+"@"+a+"@"+this._offset,b).getLayers()[0],c=new McxAjaxParameter,c.setParameters(this,this.onSearchSuccess,this.onSearchFailed),a.query(null,"",c)))}};
McxMapDocument.prototype.onSearchSuccess=function(a){$(".loading-area-container").hide();var b=this,c=this._dataSource;if(this._dataSource&&null!=this._dataSource){a=a.getFeatureReader();var d=this._resultArea;if(0<a.count()){for(;a.read();){var e=a.getCurrent(),f=e.getValue("parse").toString(),g=e.getValue("result").toString(),e=e.getValue("fid"),h=$('<div class="result-area-content-container" >'),k=$('<div class="mcx-row-fluid result-area-content"></div></div>'),m=$('<div class="result-area-content-left" />'),
n=$('<div class="result-area-content-right" />');m.html(g);$(h).data("value",f);h.click(function(){var a=new McxDocumentSearchResult;a.setData($(this).data("value").toString());a.setDataSource(c);a=new McxEventArgs(a);b._resultAreaClickEventHandler.dispatchOnSuccess(this,a)});g=new McxButton;g.setButtonSize(McxButtonSize.small);g.setText("Go");g.setLocalizationKey("mcxMapDocumentGoButton");g.setButtonState(McxButtonState.active);g.setData("value",f);g.getClickHandler().addListener(function(){this._map.getWorld();
var a=this.getData("value").toString().split("#");if(!(2>a.length)){var d=parseFloat(a[0]),a=a[1],e=new McxAjaxParameter;e.setAsync(!1);a=c.getLayer(c.getName()+":"+a,e).getLayers()[0];null!=a&&(d=a.findFeature(d),(a=d.getGeometry())?(a=a.getBounds(),e=$("<div/>").addClass("location-marker-32"),e=new McxContentMarker(a.getCentroid(),McxGuid.createGuid(),e),b._map.getMarkerCollection().clear(),b._map.getMarkerCollection().add(e),a=new McxZoomBoundsAction([a]),a.setRatio(.25),b._map.getInputHandler().execute(a),
(new McxBlinkAction([d],6E3)).execute(b._map),b._searchAreaContainer.removeClass("state-open"),b._searchAreaContainer.removeClass("option-state-open"),setTimeout(function(){$(".location-marker-32").remove();b.map.getMarkerCollection().clear()},1E4)):McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("mcxDocumentSearchGeometryNotFound"),McxMessageBoxType.Error))}},null,g);n.append(g.getContent());k.append(m);0<e&&k.append(n);h.append(k);McxLocalizationManager.localizeContent(h,this.getLocalizationPath());
this._resultArea.append(h)}$(this._resultArea).unbind("scroll");$(this._resultArea).bind("scroll",function(){$(this).scrollTop()+$(this).innerHeight()>=$(this)[0].scrollHeight&&(b._locked||$(this).scrollTop($(this).scrollTop()-10),b.search(100),b._locked=!0)});b._locked=!1}else 0==a.count()&&0==$(".result-area-content-container:not(.loading-area-container)").length&&(h=$('<div class="result-area-content-container" >'),k=$('<div class="mcx-row-fluid result-area-content"></div></div>'),m=$('<div class="result-area-content-left" />'),
m.attr("data-localize","mcxMapDocumentNoResult"),m.text("No Result"),k.append(m),h.append(k),McxLocalizationManager.localizeContent(h,this.getLocalizationPath()),this._resultArea.append(h),12>b._offset&&(this._emptyAreaTimer=setTimeout(function(){$(d).empty()},4E3)))}};McxMapDocument.prototype.clearFeatureBaloon=function(a){McxApplication.getActiveMap().getMarkerCollection().removeWithGuid(a.getArgs().toString());McxApplication.getActiveMap().getRenderer().paintNonLayer()};
McxMapDocument.prototype.searchGoogle=function(a){var b=new google.LatLng(41.0480556,29.02361110000004);a={location:b,radius:"5000",query:this._searchInput.getValue()};var b=new google.Map(document.getElementById("googleSearchInputContainer"),{center:b,zoom:15}),c=new google.places.PlacesService(b);c.textSearch(a,function(a,b){if(b!=Window.google.places.PlacesServiceStatus.OK){var g=$('<div class="result-area-content-container" >'),h=$('<div class="mcx-row-fluid result-area-content"></div></div>'),
k=$('<div class="result-area-content-left" />');k.html("Aranan kritere g\u00f6re sonu\u00e7 bulunamam\u0131\u015ft\u0131r.");k.attr("data-localize","mcxMapDocumentNoResult");h.append(k);g.append(h);d._resultArea.append(g);this._emptyAreaTimer=setTimeout(function(){$(d._resultArea).empty()},4E3)}for(var m=0,n;n=a[m];m++){var g=$('<div class="result-area-content-container" >'),h=$('<div class="mcx-row-fluid result-area-content"></div></div>'),k=$('<div class="result-area-content-left" />'),p=$('<div class="result-area-content-right" />');
k.html(n.name+" <br/> "+n.formatted_address);$(g).data("data-x",n.geometry.location.lat());$(g).data("data-y",n.geometry.location.lng());$(g).data("data-reference",n.reference);g.click(function(){var a=parseFloat($(this).data("data-x")),b=parseFloat($(this).data("data-y")),e=$(this).data("data-reference").toString(),f=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(4326),a=McxFactoryFinder.GeometryFactory(f).createPoint(a,b),g=new McxDocumentSearchResult;g.setSearchRadioName("Google");
c.getDetails({reference:e},function(a,b){if(b==Window.google.places.PlacesServiceStatus.OK){g.setGoogleData(a);var c=new McxEventArgs(g);d._resultAreaClickEventHandler.dispatchOnSuccess(this,c)}});g.geometry=a});var q=new McxButton;q.setButtonSize(McxButtonSize.small);q.setText("Git");q.setButtonState(McxButtonState.active);q.setData("data-y",n.geometry.location.lat());q.setData("data-x",n.geometry.location.lng());q.getClickHandler().addListener(function(){var a=parseFloat(this.getData("data-x")),
b=parseFloat(this.getData("data-y")),c=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(4326),a=McxFactoryFinder.GeometryFactory(c).createPoint(a,b),b=$("<div>").addClass("location-marker-32"),b=new McxContentMarker(a,McxGuid.createGuid(),b);d.map.getMarkerCollection().clear();d.map.getMarkerCollection().add(b);a=new McxZoomBoundsAction([a.getBounds()]);a.setRatio(.25);d.map.getInputHandler().execute(a);d._searchAreaContainer.removeClass("state-open");setTimeout(function(){$(".location-marker-32").remove();
d.map.getMarkerCollection().clear()},1E4)},null,q);p.append(q.getContent());h.append(k);h.append(p);g.append(h);d._resultArea.append(g)}});$(this._resultArea).empty();var d=this};
McxMapDocument.prototype.searchGeneral=function(a){$(this._resultArea).empty();var b=this,c=[],d=$('<div class="result-area-content-container" >'),e=$('<div class="mcx-row-fluid result-area-content"></div></div>'),f=$('<div class="result-area-content-left" />');f.html("Aranan kritere g\u00f6re sonu\u00e7 bulunamam\u0131\u015ft\u0131r.");f.attr("data-localize","mcxMapDocumentNoResult");e.append(f);d.append(e);b._resultArea.append(d);var g=function(a){$(".result-area-content-left").empty();for(var c=
0,d;d=a[c];c++){var e=$('<div class="result-area-content-container" >'),f=$('<div class="mcx-row-fluid result-area-content"></div></div>'),g=$('<div class="result-area-content-left" />'),h=$('<div class="result-area-content-right" />');g.html(d.name+" <br/> "+d.formatted_address);$(e).data("data-x",d.lat);$(e).data("data-y",d.lng);$(e).data("data-reference",d.reference);e.click(function(){parseFloat($(this).data("data-x"));parseFloat($(this).data("data-y"));$(this).data("data-reference")});var k=
new McxButton;k.setButtonSize(McxButtonSize.small);k.setText("Git");k.setButtonState(McxButtonState.active);k.setData("data-y",d.lat);k.setData("data-x",d.lng);k.getClickHandler().addListener(function(){var a=parseFloat(this.getData("data-x")),c=parseFloat(this.getData("data-y")),d=McxFactoryFinder.CoordinateSystemFactory().createCoordinateSystem(4326),a=McxFactoryFinder.GeometryFactory(d).createPoint(a,c),c=$("<div>").addClass("location-marker-32"),c=new McxContentMarker(a,McxGuid.createGuid(),c);
b.map.getMarkerCollection().clear();b.map.getMarkerCollection().add(c);a=new McxZoomBoundsAction([a.getBounds()]);a.setRatio(.25);b.map.getInputHandler().execute(a);b._searchAreaContainer.removeClass("state-open");setTimeout(function(){$(".location-marker-32").remove();b.map.getMarkerCollection().clear()},1E4)},null,k);h.append(k.getContent());f.append(g);f.append(h);e.append(f);b._resultArea.append(e)}},d=a.replace(/\,/g,"").replace(/\./g,"").replace(/\s+/,"");if(isNaN(parseInt(d,10)))$.ajax({type:"GET",
url:"http://cbsportal.iski.gov.tr/sehirharitasi_text/"+a,crossDomain:!0,success:function(a){a=a.ArrayOfAramaResult.AramaResult;for(var b=0;b<a.length;b++)c.push({name:a[b].ADI,formatted_address:a[b].ILCE_ADI+" | "+a[b].ARANACAK,lat:a[b].LAT,lng:a[b].LON,reference:""});g(c)},error:null});else{a=a.split(",");var h=parseFloat(a[1].replace(/\s+/,"")),k=parseFloat(a[0].replace(/\s+/,""));$.ajax({type:"GET",url:"http://cbsportal.iski.gov.tr/sehirharitasi_koord/"+h+"/"+k,crossDomain:!0,success:function(a){a=
a.ArrayOfInfo.Info;c.push({name:a.Ilce,formatted_address:a.Yol+" | "+a.Mahalle,lat:k,lng:h,reference:""});g(c)},error:null})}};
McxMapDocument.prototype.createRequestLoadingArea=function(){clearTimeout(this._emptyAreaTimer);$(".more-area-container").hide();$(".loading-area-container").hide();var a=$('<div class="result-area-content-container loading-area-container" >'),b=$('<div class="mcx-row-fluid result-area-content"></div></div>'),c=$('<div class="result-area-content-left" />');c.attr("data-localize","mcxMapDocumentLoading");c.text("Loading");b.append(c);a.append(b);McxLocalizationManager.localizeContent(a,this.getLocalizationPath());
this._resultArea.append(a)};McxMapDocument.prototype.getLocalizationPath=function(){return"$McxApplication/assets/locale/mcxApplication"};McxMapDocument.prototype.getMapOpenCompleteHandler=function(){return this._mapOpenCompleteHandler};McxMapDocument.prototype.isInstanceOf=function(a){return"McxMapDocument"==a};js.app.McxApplication.MenuBar={};js.app.McxApplication.MenuBar.IMcxMenuBarItem={};function IMcxMenuBarItem(){}IMcxMenuBarItem.prototype.initializeContent=function(){};IMcxMenuBarItem.prototype.getOnContentInitializeFinishHandler=function(){};IMcxMenuBarItem.prototype.getContent=function(){};IMcxMenuBarItem.prototype.getTitle=function(){};IMcxMenuBarItem.prototype.getMenuIcon=function(){};IMcxMenuBarItem.prototype.getIsFullPage=function(){};IMcxMenuBarItem.prototype.getLocalizationFilePath=function(){};js.app.McxApplication.MenuBar.McxAddonMenuBarItem={};function McxAddonMenuBarItem(a){this._addon=a;this._contentInitializeFinishEventHandler=new McxEventHandler;this._content=null}McxAddonMenuBarItem.prototype.getTitle=function(){return null!=this._addon.getRibbonControl()?this._addon.getRibbonControl().getName():"Bo\u015f "};
McxAddonMenuBarItem.prototype.initializeContent=function(){var a=this._addon.getRibbonControl(),b=McxPathFinder.getFullPath(this._addon.getCssFilePath());0==$("head").find('link[data-addon-style="'+this._addon.getId()+'"]').length&&$("head").prepend($("<link>").attr("rel","stylesheet").attr("data-addon-style",this._addon.getId()).attr("type","text/css").attr("href",b));a&&this.loadUserControl(a)};McxAddonMenuBarItem.prototype.getOnContentInitializeFinishHandler=function(){return this._contentInitializeFinishEventHandler};
McxAddonMenuBarItem.prototype.getContent=function(){return this._content};McxAddonMenuBarItem.prototype.getMenuIcon=function(){return this._addon.getMenuIconSrc()};McxAddonMenuBarItem.prototype.getIsFullPage=function(){return!1};McxAddonMenuBarItem.prototype.getLocalizationFilePath=function(){return this._addon.getLocalizationFilePath()};McxAddonMenuBarItem.prototype.getAddon=function(){return this._addon};
McxAddonMenuBarItem.prototype.loadUserControl=function(a){var b=this;McxAjaxServiceCall.getAjaxCall(McxPathFinder.getFullPath(a.getHtmlPageUrl()),null,a,"text",!1,null,!0,function(a){b._content=$(a);b.getOnContentInitializeFinishHandler().dispatchOnSuccess(b,null)},function(){McxMessageBox.show(null,"Failed to load ribbon control.",McxMessageBoxType.Error)})};js.app.McxApplication.MenuBar.McxCreateCustomMenuAction={};function McxCreateCustomMenuAction(){this._editCustomMenuDialog=new McxEditCustomMenuDialog;this._onCustomMenuCreateHandler=new McxEventHandler}
McxCreateCustomMenuAction.prototype.execute=function(a){this._editCustomMenuDialog.getSubmitHandler().addListener(function(a){var c=this._editCustomMenuDialog.getCustomMenu();c&&c.getTitle()&&0!=c.getCustomMenuItemList().length?this.onCustomMenuCreated().dispatchOnSuccess(this,new McxEventArgs(c)):(a.setIsValidated(!1),McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("McxApplication-mcxCustomMenuRequiredFields"),McxMessageBoxType.Error))},null,this);this._editCustomMenuDialog.showDialog()};
McxCreateCustomMenuAction.prototype.onCustomMenuCreated=function(){return this._onCustomMenuCreateHandler};McxCreateCustomMenuAction.prototype.isInstanceOf=function(a){return"McxCreateCustomMenuAction"==a};js.app.McxApplication.MenuBar.McxCustomMenu={};function McxCustomMenu(){this._rootElement=null;this._menuItemGroup=$("<div/>").addClass("mcx-menu-tab-content-group");this._title="";this._customMenuItems=[];this._menuBar=McxApplication.getMenuBar();this._onContentInitializeFinishHandler=new McxEventHandler}McxCustomMenu.prototype.getTitle=function(){return this._title};
McxCustomMenu.prototype.orderMenuItems=function(){for(var a=0;a<this._customMenuItems.length;a++){var b=this._customMenuItems[a].getElementId();this.getContent().find('[original-element-id="'+b+'"]').appendTo(this._menuItemGroup)}};
McxCustomMenu.prototype.initializeContent=function(){function a(){f++;f==Object.keys(b).length&&(this.orderMenuItems(),this.getOnContentInitializeFinishHandler().dispatchOnSuccess(this,null))}this._rootElement=$("<div/>").addClass("mcx-menu-tab").append(this._menuItemGroup);for(var b={},c=0;c<this._customMenuItems.length;c++){var d=this._customMenuItems[c],e=d.getAddonName();b[e]=b[e]||[];b[e].push(d)}var f=0;for(e in b)if(d=this.findAddonMenuItem(e),McxLocalizationManager.downloadPath(d.getAddon().getLocalizationFilePath()),
d){var g=d.getContent(),h=b[e];if(g){for(c in h)this.extractMenuContent(h[c].getElementId(),g);a.call(this)}else d.getOnContentInitializeFinishHandler().addListener(function(){for(var b=this[0],c=this[1],d=this[2],e=0;e<c.length;e++)b.extractMenuContent(c[e].getElementId(),d.getContent());a.call(b)},null,[this,h,d]),d.initializeContent()}};McxCustomMenu.prototype.getOnContentInitializeFinishHandler=function(){return this._onContentInitializeFinishHandler};McxCustomMenu.prototype.getContent=function(){return this._rootElement};
McxCustomMenu.prototype.getMenuIcon=function(){return""};McxCustomMenu.prototype.getIsFullPage=function(){return!1};McxCustomMenu.prototype.getLocalizationFilePath=function(){return""};McxCustomMenu.prototype.setMenuBar=function(a){this._menuBar=a};McxCustomMenu.prototype.setTitle=function(a){this._title=a};McxCustomMenu.prototype.addCustomMenuItem=function(a){this._customMenuItems[this._customMenuItems.length]=a};McxCustomMenu.prototype.clearCustomMenuItems=function(){this._customMenuItems=[]};
McxCustomMenu.prototype.findAddonMenuItem=function(a){this._menuBar=this._menuBar||McxApplication.getMenuBar();if(!this._menuBar)return null;for(var b=this._menuBar.getMenuItems(McxAddonMenuBarItem),c=0;c<b.length;c++){var d=b[c];if(d.getAddon().getDescription()==a)return d}};
McxCustomMenu.prototype.extractMenuContent=function(a,b){var c=b.find("#"+a).clone();c.attr("original-element-id",a).data("original-element-id",a);c.click(function(){var a=$(this).data("original-element-id");$("#"+a).click()});this._menuItemGroup.append(c)};McxCustomMenu.prototype.getCustomMenuItemList=function(){return this._customMenuItems};
McxCustomMenu.prototype.clone=function(){var a=new McxCustomMenu;a.setTitle(this.getTitle());for(var b=this.getCustomMenuItemList(),c=0;c<b.length;c++)a.addCustomMenuItem(b[c]);return a};js.app.McxApplication.MenuBar.McxCustomMenuItem={};function McxCustomMenuItem(a,b){this._addonName=a;this._elementId=b}McxCustomMenuItem.prototype.getElementId=function(){return this._elementId};McxCustomMenuItem.prototype.getAddonName=function(){return this._addonName};js.app.McxApplication.MenuBar.McxEditCustomMenuAction={};function McxEditCustomMenuAction(a){this._customMenu=a;this._editCustomMenuDialog=new McxEditCustomMenuDialog;this._onCustomMenuEditHandler=new McxEventHandler}
McxEditCustomMenuAction.prototype.execute=function(a){this._editCustomMenuDialog.setCustomMenu(this._customMenu);this._editCustomMenuDialog.getSubmitHandler().addListener(function(a){var c=this._editCustomMenuDialog.getCustomMenu();c&&c.getTitle()&&0!=c.getCustomMenuItemList().length?this.onCustomMenuEditHandler().dispatchOnSuccess(this,null):(a.setIsValidated(!1),McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("McxApplication-mcxCustomMenuRequiredFields"),McxMessageBoxType.Error))},
null,this);this._editCustomMenuDialog.showDialog()};McxEditCustomMenuAction.prototype.onCustomMenuEditHandler=function(){return this._onCustomMenuEditHandler};McxEditCustomMenuAction.prototype.isInstanceOf=function(a){return"McxEditCustomMenuAction"==a};js.app.McxApplication.MenuBar.McxEditCustomMenuDialog={};
function McxEditCustomMenuDialog(){mcx.base(this);this._rootElement=$("<div/>");this._customMenu=new McxCustomMenu;this._dropElement=new McxLayoutRow;this._titleEditor=new McxTextBox(McxTextBoxType.Text);this._menuItemListEditor=new McxListBox;this._moveUpSelectedMenuItemsButton=new McxButton;this._moveDownSelectedMenuItemsButton=new McxButton;this._clearMenuItemListButton=new McxButton;this._removeSelectedMenuItemsButton=new McxButton;this.base=this;this.preInitializeControls()}
mcx.inherits(McxEditCustomMenuDialog,McxDialogBase);McxEditCustomMenuDialog.prototype.preInitializeControls=function(){this._menuItemListEditor.setTextGetter("description");this._menuItemListEditor.setValueGetter("getElementId")};
McxEditCustomMenuDialog.prototype.enableMenuItemDragging=function(){for(var a=McxApplication.getMenuBar().getMenuItems(McxAddonMenuBarItem),b=0;b<a.length;b++){var c=a[b],d=c.getContent();d?McxUserControl.enableDragging(d.find(".mcx-menu-tab-content-item")):(c.getOnContentInitializeFinishHandler().addListener(function(){var a=this.addonMenu.getContent();McxUserControl.enableDragging(a.find(".mcx-menu-tab-content-item"))},null,{self:this,addonMenu:c}),c.initializeContent())}};
McxEditCustomMenuDialog.prototype.bindEvents=function(){this._clearMenuItemListButton.getClickHandler().addListener(function(){this._menuItemListEditor.clear();this.arrangeMenuItemList()},null,this);this._removeSelectedMenuItemsButton.getClickHandler().addListener(function(){this._menuItemListEditor.removeSelectedItems();this.arrangeMenuItemList()},null,this);this._dropElement.onDrop().addListener(function(a){var b=a.getDragItem();0==mcx.isInstanceOf(b,McxUserControl)&&b.hasClass("mcx-menu-tab-content-item")&&
(a=McxApplication.getMenuBar().getActiveMenu())&&mcx.isInstanceOf(a,McxAddonMenuBarItem)&&(b=b.attr("id").toString(),a=a.getAddon().getDescription(),a=new McxCustomMenuItem(a,b),this.addMenuItem(a))},null,this)};
McxEditCustomMenuDialog.prototype.initialize=function(){this.arrangeMenuItemList();this._menuItemListEditor.setMultiSelect(!0);this._clearMenuItemListButton.setText("T\u00fcm\u00fcn\u00fc Kald\u0131r");this._clearMenuItemListButton.setLocalizationKey("McxApplication-mcxCustomMenuRemoveAllItems");this._removeSelectedMenuItemsButton.setText("Se\u00e7iliyi Kald\u0131r");this._removeSelectedMenuItemsButton.setLocalizationKey("McxApplication-mcxCustomMenuRemoveSelectedItems");this._moveDownSelectedMenuItemsButton.setImage("$McxApplication/assets/img/customMenuDialog/moveDown.png");
this._moveUpSelectedMenuItemsButton.setImage("$McxApplication/assets/img/customMenuDialog/moveUp.png");this._moveDownSelectedMenuItemsButton.getClickHandler().addListener(this._menuItemListEditor.moveDownSelection,null,this._menuItemListEditor);this._moveUpSelectedMenuItemsButton.getClickHandler().addListener(this._menuItemListEditor.moveUpSelection,null,this._menuItemListEditor);this._dropElement.getContent().css("height","100px").addClass("mcx-custom-menu-drop-box");this._dropElement.enableDropping();
this._dropElement.createAndAddSpan(12,$("<div/>").addClass("mcx-menu-item-drop-box").html("Men\u00fc butonlar\u0131n\u0131 kutucu\u011fa s\u00fcr\u00fckleyip b\u0131rak\u0131n\u0131z.").attr("data-localize","McxApplication-mcxCustomMenuDragDropItems"));this.enableMenuItemDragging();this.base.addChild(this._rootElement,this._dropElement);this.base.addChild(this._rootElement,new McxLabeledEditor("Title",this._titleEditor,"McxApplication-mcxCustomMenuTitle"));this.base.addChild(this._rootElement,new McxLabeledEditor("Menu Items",
this._menuItemListEditor,"McxApplication-mcxCustomMenuItems"));this.base.addFooterButton(this._moveUpSelectedMenuItemsButton);this.base.addFooterButton(this._moveDownSelectedMenuItemsButton);this.base.addFooterButton(this._removeSelectedMenuItemsButton);this.base.addFooterButton(this._clearMenuItemListButton);this._moveDownSelectedMenuItemsButton.css("min-width","0");this._moveUpSelectedMenuItemsButton.css("min-width","0");this.bindEvents()};
McxEditCustomMenuDialog.prototype.setCustomMenu=function(a){this._customMenu=a;this._titleEditor.setValue(a.getTitle());if(this._customMenu.getContent())this.fillMenuItemList(a.getCustomMenuItemList());else{var b=function(){this.fillMenuItemList(a.getCustomMenuItemList());this._customMenu.getOnContentInitializeFinishHandler().removeListener(b)};this._customMenu.getOnContentInitializeFinishHandler().addListener(b,null,this);this._customMenu.initializeContent()}};
McxEditCustomMenuDialog.prototype.arrangeMenuItemList=function(){var a=this._menuItemListEditor.getItems().length;4>a?this._menuItemListEditor.setVisibleItemCount(4):4<a&&10>a?this._menuItemListEditor.fitHeightToOptionsLength():10<=a&&this._menuItemListEditor.setVisibleItemCount(10)};
McxEditCustomMenuDialog.prototype.addMenuItem=function(a){for(var b=this._menuItemListEditor.getItems(McxCustomMenuItem),c=0;c<b.length;c++)if(b[c].getElementId()==a.getElementId())return;b=$("#"+a.getElementId()).find(".mcx-menu-tab-content-item-label");a.description=McxLocalizationManager.getLocaleValue(b.attr("data-localize").toString());this._menuItemListEditor.addItem(a);this.arrangeMenuItemList()};
McxEditCustomMenuDialog.prototype.fillMenuItemList=function(a){this._menuItemListEditor.clear();for(var b=0;b<a.length;b++)this.addMenuItem(a[b])};McxEditCustomMenuDialog.prototype.getCustomMenu=function(){var a=this._menuItemListEditor.getItems(McxCustomMenuItem);this._customMenu.setTitle(this._titleEditor.getValue());this._customMenu.clearCustomMenuItems();for(var b=0;b<a.length;b++)this._customMenu.addCustomMenuItem(a[b]);return this._customMenu};McxEditCustomMenuDialog.prototype.getContent=function(){return this._rootElement};
McxEditCustomMenuDialog.prototype.onClose=function(){McxUserControl.disableDragging($(".mcx-menu-tab-content-item"))};McxEditCustomMenuDialog.prototype.getDialogTitle=function(){return"McxApplication-mcxEditCustomMenuDialogTitle"};McxEditCustomMenuDialog.prototype.getDialogSize=function(){return McxDialogSize.medium};js.app.McxApplication.MenuBar.McxGetCustomMenuListAction={};function McxGetCustomMenuListAction(){this._settingKey="HTML5.Main.Menu.CustomMenu";this._customMenuList=[]}McxGetCustomMenuListAction.prototype.execute=function(a){a=McxSettingsManager.read(this._settingKey,null);var b;if(a&&a.getSettings()&&0<a.getSettings().length){a=a.getSettings()[0];try{b=JSON.parse(a)}catch(c){b=null}}a=[];b&&(a=this.deSerializeCustomMenuRangeJson(b));this._customMenuList=a};
McxGetCustomMenuListAction.prototype.deSerializeCustomMenuRangeJson=function(a){for(var b=[],c=0;c<a.length;c++)b.push(this.deSerializeCustomMenuJson(a[c]));return b};McxGetCustomMenuListAction.prototype.deSerializeCustomMenuJson=function(a){var b=new McxCustomMenu;b.setTitle(a.title);if(a.items&&0<a.items.length)for(var c=0;c<a.items.length;c++){var d=a.items[c],d=new McxCustomMenuItem(d.addon,d.elementId);b.addCustomMenuItem(d)}return b};McxGetCustomMenuListAction.prototype.getCustomMenuList=function(){return this._customMenuList};
McxGetCustomMenuListAction.prototype.isInstanceOf=function(a){return"McxGetCustomMenuListAction"==a};js.app.McxApplication.MenuBar.McxHomeTabPage={};function McxHomeTabPage(){this._loadingBar=this._workspaceList=this._defaulWorkspaceInfo=this._blogAndVideoContainer=this._headerContainer=this._workspaceContainer=this._rootElement=this._tabElement=null;this._onContentInitializeFinishHandler=new McxEventHandler;this._customMenuButton=new McxButton;this.initialize()}
McxHomeTabPage.prototype.initialize=function(){McxApplication.getSecurityManager().getUserRolesChangedEventHandler().addListener(this.updateAuthorization,null,this)};McxHomeTabPage.prototype.updateAuthorization=function(){var a=new McxAjaxParameter;a.setAsync(!1);a=McxSettingsManager.read("HTML5.Main.Menu.UserMenu",a);a.getSettings()[0]&&"FALSE"==a.getSettings()[0]?this._customMenuButton.hide():this._customMenuButton.show()};McxHomeTabPage.prototype.clearWorkspaceArea=function(){this._workspaceContainer.html("")};
McxHomeTabPage.prototype.createWorkspaceArea=function(a,b){var c=new McxWorkspaceManagerView;c.setWorkspaceInfoRange(a);0<b.length&&c.addReportRange(b);var d=new McxLayoutRow;d.createAndAddSpan(12,c.getContent());this._workspaceContainer.append(d.getContent());c.getWorkspaceInfoClickHandler().addListener(this.onWorkspaceOpenRequest,null,this);c.getWorkspaceInfoDeleteRequestHandler().addListener(this.onWorkspaceDeleteRequest,null,this);c.getWorkspaceInfoShareRequestHandler().addListener(this.onWorkspaceShareRequest,
null,this);c.getWorkspaceInfoRenameRequestHandler().addListener(this.onWorkspaceRenameRequest,null,this);c.getWorkspaceInfoSetDefaultRequestHandler().addListener(this.onWorkspaceSetAsDefaultRequest,null,this);c.getReportOpenButtonClickHandler().addListener(this.onReportOpenButtonClick,null,this);c.getReportSaveButtonClickHandler().addListener(this.onReportSaveButtonClick,null,this);McxLocalizationManager.localizeContent(c.getContent())};
McxHomeTabPage.prototype.onWorkspaceRenameRequest=function(a){a.getWorkspaceInfo().setImage(null);a=a.getWorkspaceInfo();McxApplication.getSecurityManager().saveWorkspace(null,a);McxApplication.getActiveDocument().setTitle(a.getName())};McxHomeTabPage.prototype.onWorkspaceShareRequest=function(a){(new McxShareWorkspaceAction(a.getWorkspaceInfo())).execute(null)};
McxHomeTabPage.prototype.onReportOpenButtonClick=function(a){a=a.getArgs();var b="",c=McxApplication.getSecurityManager().getValueFromDictionary("App.Main.Datasource.Default");0<c.length&&(b=c[0]);for(var b=(new McxFsDriver).openDataSource(b).getDataSource(),c=null,d=McxApplication.getDocuments(),e=0;e<d.length;e++)mcx.isInstanceOf(d[e],McxReportDocument)&&d[e].getTitle()==a&&(c=d[e],c.prepare(),McxApplication.hideMenu());null==c&&(c=new McxReportDocument(b,a,a.toString()),c.prepare(),McxApplication.hideMenu(),
McxApplication.addDocument(c))};
McxHomeTabPage.prototype.onReportSaveButtonClick=function(a){var b=a.getArgs(),c=new McxListBox;c.setWidth("100%");c.setValueGetter("value");c.setTextGetter("text");c.setIsLocalizable(!0);for(var d in McxReportType)c.addItem({text:"McxApplication-ReportType"+d,value:McxReportType[d]});var e=new McxLayoutRow;e.createAndAddSpan(12,c);a=b.getContent().find(".mcx-report-info-button-container");e.getContent().addClass("mcx-workspace-info-save-selectBox");a.append(e.getContent());c.getContent().find(".mcx-input").focus();
McxLocalizationManager.localizeContent(c.getContent());c.getOnSelectHandler().addListener(function(){var a=c.getSelectedItems(),d=null,h;for(h in McxReportType)McxReportType[h]==a[0].value&&(d=h);a="";h=McxApplication.getSecurityManager().getValueFromDictionary("App.Main.Datasource.Default");0<h.length&&(a=h[0]);d=(new McxFsDriver).openDataSource(a).getDataSource().getReportUri(b.getReportName(),null,null,McxReportType[d]);window.location.href=d;e.getContent().detach()},null,this);c.getOnBlurHandler().addListener(function(){e.getContent().detach()},
null,this)};McxHomeTabPage.prototype.onWorkspaceSetAsDefaultRequest=function(a){mcx.isDefAndNotNull(a.getWorkspaceInfo().getId())&&McxApplication.getSecurityManager().setDefaultWorkspace(a.getWorkspaceInfo())};McxHomeTabPage.prototype.onWorkspaceOpenRequest=function(a){this.loadWorkspace(a.getWorkspaceInfo())};
McxHomeTabPage.prototype.refreshWorkspaceArea=function(){this.clearWorkspaceArea();var a=McxApplication.getWorkspaces(),a=a.concat(McxApplication.getWorkspaces(McxWorkspaceInfoGroupType.myWorkspaces)),a=a.concat(McxApplication.getWorkspaces(McxWorkspaceInfoGroupType.sharedWithMe)),a=a.concat(McxApplication.getWorkspaces(McxWorkspaceInfoGroupType.sharedWorkspaces)),b=McxSettingsManager.read("App.User.Report",null).getSettings();this.createWorkspaceArea(a,b)};
McxHomeTabPage.prototype.onWorkspaceDeleteRequest=function(a){if(McxApplication.getSecurityManager().hasWritePermissionOnWorkspace(a.getWorkspaceInfo())){var b=new McxAjaxParameter;b.setParameters(this,function(){this.refreshWorkspaceArea()},function(){});if(mcx.isDefAndNotNull(a.getWorkspaceInfo().getId())){var c=McxLocalizationManager.getLocaleValue("homeTabConfirmDeleteWorkspace")||"Are you sure to delete this workspace?";McxMessageBox.show(null,c,McxMessageBoxType.Confirm).getMessageResultHandler().addListener(function(c){c.getResult()==
McxMessageBoxResult.Ok&&McxApplication.getSecurityManager().deleteWorkspace(a.getWorkspaceInfo(),b)},null,this)}}else McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("McxApplication-mcxAccessDenied"),McxMessageBoxType.Error,McxDialogButtons.ok)};McxHomeTabPage.prototype.setWorkspaces=function(a,b){this.clearWorkspaceArea();this.createWorkspaceArea(a,b);for(var c=0;c<a.length;c++)a[c].isDefault()&&(this._defaulWorkspaceInfo=a[c]);this._workspaceList=a};
McxHomeTabPage.prototype.loadDefaultWorkspace=function(){null!=this._defaulWorkspaceInfo&&this.loadWorkspace(this._defaulWorkspaceInfo)};McxHomeTabPage.prototype.loadWorkspace=function(a){var b=a.getId(),c=a.getName();null!=b&&(c=McxApplication.createDocument(c.toString()),c.setWorkspaceInfo(a),(new McxOpenWorkspaceAction(b,c)).execute(null))};McxHomeTabPage.prototype.onWorkspaceMapRenderEnd=function(a){a=this.scope;var b=this.map;a.setLoadingBarVisibility(!1);b.getRenderer().getRendererEndEventHandler().removeListener(a.onWorkspaceMapRenderEnd)};
McxHomeTabPage.prototype.createLoadingBar=function(){this._loadingBar=$("<div/>").addClass("home-loading-bar");this._headerContainer.append(this._loadingBar)};
McxHomeTabPage.prototype.createHeaderButtons=function(){var a=new McxButton;a.setButtonSize(McxButtonSize.large);a.setText("Create New Map");a.setLocalizationKey("homeTabCreateNewMap");a.setImage("mcx-image-new-map-48");a.getClickHandler().addListener(function(){var a=new McxNewMapAction;a.getMapOpenCompleteHandler().addListener(function(){McxApplication.hideMenu()},null,this);a.execute(null)},null,this);var b=new McxButton;b.setButtonSize(McxButtonSize.large);b.setText("Open Online Map");b.setLocalizationKey("homeTabOpenOnlineMap");
b.setImage("mcx-image-online-map-48");b.getClickHandler().addListener(function(){(new McxOnlineMapAction).execute(null);McxApplication.hideMenu()},null,this);var c=new McxButton;c.setButtonSize(McxButtonSize.large);c.setImage("mcx-image-refresh-48");c.getContent().attr("data-localize","McxApplication-RefreshButton");c.getContent().attr("data-localize-for","title");c.getClickHandler().addListener(function(){this.refreshWorkspaceArea();c.setButtonState(McxButtonState.normal)},null,this);this._customMenuButton.setButtonSize(McxButtonSize.large);
this._customMenuButton.setText("Menus");this._customMenuButton.setLocalizationKey("McxApplication-mcxUserDefinedMenus");this._customMenuButton.setImage("mcx-image-menu-48");this._customMenuButton.addClass("mcx-mobile-hidden");this._customMenuButton.getClickHandler().addListener(function(){(new McxManageCustomMenusAction).execute(null)},null,this);this._headerContainer.append(a.getContent());this._headerContainer.append(b.getContent());this._headerContainer.append(this._customMenuButton.getContent());
this._headerContainer.append(c.getContent())};
McxHomeTabPage.prototype.createBlogAndVideoPanel=function(){this._blogAndVideoContainer.addClass("mcx-blog-container").append($("<h1/>").text("MapCodeX'den Son Haberler")).append($("<ul/>").addClass("news").append($("<li/>").append($("<a/>").text("MapCodeX Masa\u00fcst\u00fc indirmek i\u00e7in t\u0131klay\u0131n\u0131z.").attr("href","http://mapcodexpublish.com/mcxdesktop/publish.htm").attr("target","_blank"))).append($("<li/>").append($("<a/>").text("MapCodeX Server indirmek i\u00e7in t\u0131klay\u0131n\u0131z").attr("href","http://mapcodexpublish.com/mcxserverdev/publish.htm").attr("target",
"_blank"))).append($("<li/>").append($("<a/>").text("MapCodeX \u00fcr\u00fcnler sayfas\u0131 i\u00e7in t\u0131klay\u0131n\u0131z").attr("href","http://mapcodex.com/Products/Overview.aspx?ProductId=1").attr("target","_blank"))).append($("<li/>").append($("<a/>").text("OGC sertifikasyonlar\u0131 i\u00e7in t\u0131klay\u0131n\u0131z").attr("href","http://www.opengeospatial.org/resource/products/compliant#RKSoft_").attr("target","_blank"))).append($("<li/>").append($("<a/>").text("Hata ve istek bildirimleri i\u00e7in t\u0131klay\u0131n\u0131z").attr("href",
"http://mapcodexpublish.com/jira").attr("target","_blank"))).append($("<li/>").append($("<a/>").text("Mail i\u00e7in info@mapcodex.com").attr("href","mailto:info@mapcodex.com?Subject=Info"))));this.getHomeHtmlContent()};
McxHomeTabPage.prototype.createHomeTabPage=function(){this._tabElement=$('<div id="home_tab"></div>');this._workspaceContainer=$("<div/>").css("width","60%").css("display","inline-block").addClass("home-workspace-container");this._blogAndVideoContainer=$("<div/>").css("width","36%").css("display","inline-block").addClass("home-blog-video-container").addClass("visible-desktop");this._headerContainer=$("<div/>").css("margin","10px 10px 30px 10px").addClass("");this.createHeaderButtons();this.createBlogAndVideoPanel();
this.createLoadingBar();this._tabElement.append(this._headerContainer);this._tabElement.append(this._workspaceContainer);this._tabElement.append(this._blogAndVideoContainer);this._rootElement=$("<div/>").addClass("mcx-menu-tab").append(this._tabElement);this.getOnContentInitializeFinishHandler().dispatchOnSuccess(this,null)};McxHomeTabPage.prototype.setLoadingBarVisibility=function(a){a?this._loadingBar.addClass("active"):this._loadingBar.removeClass("active")};
McxHomeTabPage.prototype.createHelpView=function(){var a=new McxHelpViewControl;a.addYoutubeChannel("MapCodex Web Client","https://gdata.youtube.com/feeds/api/users/MapCodeXWebClient/uploads");a.addHelpDocumentUrl("MapCodex",McxPathFinder.getFullPath("$McxApplication/doc/ana.pdf"));a.addHelpDocumentUrl("MapCodex (Eng)",McxPathFinder.getFullPath("$McxApplication/doc/ana_eng.pdf"));a.addHelpDocumentUrl("MapCodex Web",McxPathFinder.getFullPath("$McxApplication/doc/web.pdf"));a.addHelpDocumentUrl("MapCodex Web Help",
McxPathFinder.getFullPath("etc/doc/help/index.html"));this._blogAndVideoContainer.append(a.getContent());a.localize()};McxHomeTabPage.prototype.loadHomeHtmlContentFromUri=function(a){var b=$("<div/>").addClass("");a=$("<iframe/>").css({width:"100%",height:"720px",border:"none"}).load(function(){McxLoadingIndicator.setAsIdle(b)}).prop("src",a);McxLoadingIndicator.setAsBusy(b);this._blogAndVideoContainer.empty().css("padding","15px").append(b.append(a))};
McxHomeTabPage.prototype.getHomeHtmlContent=function(){var a=McxApplication.getSecurityManager();mcx.isInstanceOf(a,McxCloudSecurityManager)?(a=McxApplication.getSecurityManager().getNodeUri(),""!=a?this.loadHomeHtmlContentFromUri(a):this.createHelpView()):this.createHelpView()};McxHomeTabPage.prototype.getContent=function(){return this._rootElement};McxHomeTabPage.prototype.initializeContent=function(){this._tabElement=$("#home_tab");0==this._tabElement.length&&this.createHomeTabPage();this.loadWorkspaceInfos()};
McxHomeTabPage.prototype.getOnContentInitializeFinishHandler=function(){return this._onContentInitializeFinishHandler};McxHomeTabPage.prototype.getTitle=function(){return"McxApplication-appHome"};McxHomeTabPage.prototype.getMenuIcon=function(){return McxPathFinder.getFullPath("$McxApplication/assets/img/homeTabPage/home-addon.png")};McxHomeTabPage.prototype.getIsFullPage=function(){return!0};McxHomeTabPage.prototype.getLocalizationFilePath=function(){return"$McxApplication/assets/locale/mcxApplication"};
McxHomeTabPage.prototype.loadWorkspaceInfos=function(){if(mcx.isDefAndNotNull(McxApplication.getSecurityManager().getCurrentUser())&&(0==mcx.isDefAndNotNull(this._workspaceList)||0==this._workspaceList.length)){var a=McxApplication.getWorkspaces(McxWorkspaceInfoGroupType.allWorkspaces),a=a.concat(McxApplication.getWorkspaces(McxWorkspaceInfoGroupType.myWorkspaces)),a=a.concat(McxApplication.getWorkspaces(McxWorkspaceInfoGroupType.sharedWithMe)),a=a.concat(McxApplication.getWorkspaces(McxWorkspaceInfoGroupType.sharedWorkspaces)),
b=McxSettingsManager.read("HTML5.User.Report",null).getSettings();this.setWorkspaces(a,b)}};js.app.McxApplication.MenuBar.McxManageCustomMenusAction={};function McxManageCustomMenusAction(){this._manageCustomMenusDialog=new McxManageCustomMenusDialog}McxManageCustomMenusAction.prototype.execute=function(a){a=new McxGetCustomMenuListAction;a.execute(null);this._manageCustomMenusDialog.setCustomMenuList(a.getCustomMenuList());this._manageCustomMenusDialog.getSubmitHandler().addListener(this.onSubmit,null,this);this._manageCustomMenusDialog.showDialog()};
McxManageCustomMenusAction.prototype.onSubmit=function(){var a=this._manageCustomMenusDialog.getCustomMenuList();(new McxSaveCustomMenuListAction(a)).execute(null)};McxManageCustomMenusAction.prototype.isInstanceOf=function(a){return"McxManageCustomMenusAction"==a};js.app.McxApplication.MenuBar.McxManageCustomMenusDialog={};function McxManageCustomMenusDialog(){mcx.base(this);this.base=this;this._noMenuLabel=$("<div/>").css("text-align","center").attr("data-localize","McxApplication-mcxNoCustomMenuLabel").addClass("");this._rootElement=$("<div/>").addClass("mcx-manage-common-menus-dialog")}mcx.inherits(McxManageCustomMenusDialog,McxDialogBase);
McxManageCustomMenusDialog.prototype.initialize=function(){this._rootElement.append(this._noMenuLabel);var a=new McxButton;a.setText("Create Menu");a.setLocalizationKey("McxApplication-mcxCustomMenuCreate");a.getClickHandler().addListener(function(){var a=new McxCreateCustomMenuAction;a.onCustomMenuCreated().addListener(function(a){a=a.getArgs();this.createMenuUiItem(a)},null,this);a.execute(null)},null,this);this.base.addFooterButton(a)};
McxManageCustomMenusDialog.prototype.setCustomMenuList=function(a){for(var b=0;b<a.length;b++)this.createMenuUiItem(a[b])};
McxManageCustomMenusDialog.prototype.createMenuUiItem=function(a){var b=this,c=new McxDisplayItemView;c.setItem(a);c.setTitle(a.getTitle());a=new McxButton;a.setText("Remove");a.setLocalizationKey("McxApplication-mcxCustomMenuRemove");a.getClickHandler().addListener(function(){var a=McxMessageBox.show("",McxLocalizationManager.getLocaleValue("McxApplication-mcxCustomMenuRemoveConfirmMessage"),McxMessageBoxType.Confirm);a.getMessageResultHandler().addListener(function(){a.getMessageResult()==McxMessageBoxResult.Ok&&
(this.remove(),0==b.getChildrenOfType(McxDisplayItemView).length&&b._noMenuLabel.show())},null,this)},null,c);var d=new McxButton;d.setText("Edit");d.setLocalizationKey("McxApplication-mcxCustomMenuEdit");d.getClickHandler().addListener(function(){var a=this,b=a.getItem(),c=new McxEditCustomMenuAction(b);c.onCustomMenuEditHandler().addListener(function(){a.setTitle(b.getTitle())},null,this);c.execute(null)},null,c);c.addToolButton(d);c.addToolButton(a);this._noMenuLabel.hide();McxLocalizationManager.localizeContent(c.getContent());
this.base.addChild(this._rootElement,c)};McxManageCustomMenusDialog.prototype.getCustomMenuList=function(){for(var a=this.base.getChildrenOfType(McxDisplayItemView),b=[],c=0;c<a.length;c++){var d=a[c].getItem();d&&(b[b.length]=d)}return b};McxManageCustomMenusDialog.prototype.getLocalizationPath=function(){return""};McxManageCustomMenusDialog.prototype.getContent=function(){return this._rootElement};McxManageCustomMenusDialog.prototype.getDialogTitle=function(){return"McxApplication-mcxCustomMenusDialogTitle"};
McxManageCustomMenusDialog.prototype.getDialogSize=function(){return McxDialogSize.medium};js.app.McxApplication.MenuBar.McxMenuBar={};function McxMenuBar(){this._resizeEventHandler=new McxEventHandler;this._menuBatItemList=[];this._menuHeaderItemList=this._menuHeaderPinButton=this._contentPageContainer=this._headerContainer=this._activeMenu=this._rootElement=null;this._isResizeRequired=!1;this._menuBarItemDataKey="menuBarItem";this.initialize()}
McxMenuBar.prototype.initialize=function(){this._rootElement=$("<div/>").addClass("mcx-menu").addClass("state-empty");this._headerContainer=$("<div/>").addClass("mcx-menu-header-container");this._contentPageContainer=$("<div/>").addClass("mcx-menu-tab-container");this._menuHeaderPinButton=$("<div/>").addClass("mcx-menu-header-panel").addClass("mcx-menu-header-pin-button");this._menuHeaderItemList=$("<ul/>").addClass("mcx-menu-header-panel").addClass("mcx-menu-header-item-list");this._rootElement.append(this._headerContainer.append($('<img id="nodeImage" class="logo-top-left hidden-phone" height="32" style="margin-right:10px"/>').addClass("mcx-menu-header-panel").hide()).append(this._menuHeaderItemList).append(this._menuHeaderPinButton).append($('<div id="upRightArea"></div>'))).append(this._contentPageContainer);
var a=this._rootElement.find("#upRightArea");a.append($('<div id="inspector-button" title=""></div>'));a.append($('<div id="helpArea" class="mcx-help-button" data-localize="McxApplication-Help" data-localize-for="title" title=""></div>'));a.append($('<div id="languageSelectionPanel" class=inline><select id="languageSelectCombo" style="display: none;"></select></div>'));McxLocalizationManager.onLocalizationDoneHandler().addListener(function(){this.reCalculateButtonSize()},null,this);this._menuHeaderPinButton.click($.proxy(function(){this.toggleMenuSize();
this.getResizeEventHandler().dispatchOnSuccess(this,null)},this));$(document).mousedown($.proxy(function(a){0==$(a.target).hasClass("mcx-menu-user-auth-button-panel")&&0==$(a.target).parents(".mcx-menu-user-auth-button-panel").length&&$(this._rootElement).find(".mcx-menu-user-auth-button-panel").removeClass("state-open")},this));$(document).click(function(a){if(0!=$(a.target).hasClass("mcx-menu-tab-content-item")||0!=$(a.target).parents(".mcx-menu-tab-content-item").length){var c=$(a.target).parents(".mcx-menu-tab-content-item");
0==c.length&&(c=$(a.target));if(0!=c.is("[data-state-toggle-class]")){a=(a=c.attr("data-state-toggle-locale"))?a.toString():"";var d=c.find("[data-localize]").attr("data-localize").toString();c.find("[data-localize]").attr("data-localize",a);c.attr("data-state-toggle-locale",d);a=McxApplication.getLocaleValue(a);c.find(".mcx-menu-tab-content-item-label[data-localize]").html(a);c.find("[data-localize]").attr("title",a);a=c.attr("data-state-toggle-class").toString();c.toggleClass(a);c.is("[data-ribbon-toggle]")&&
$("#"+c.attr("data-ribbon-toggle")).toggleClass("state-closed")}}});$(document).on("click",".ribbon-button-small",function(){var a=$(this);if(0<a.parents(".mcx-ribbon-group-multiselect").length)a.toggleClass("ribbon-button-small-selected");else if(!a.is(".ribbon-button-small-selected")){var c=a.parents(".mcx-ribbon-group").eq(0),d=a.parents(".mcx-ribbon-inner-group").eq(0);0<d.length?d.find(".ribbon-button-small-selected").removeClass("ribbon-button-small-selected"):0<c.length&&c.find(".ribbon-button-small-selected").removeClass("ribbon-button-small-selected");
a.addClass("ribbon-button-small-selected")}})};
McxMenuBar.prototype.addTab=function(a,b,c,d){this._rootElement.removeClass("state-empty");var e=this,f=$("<li/>").addClass("mcx-menu-header-item");c=$("<div/>").addClass("mcx-menu-header-item-image").addClass(c);a=$("<div/>").attr("data-localize",a).text(a).addClass("mcx-menu-header-item-label");f.data("content",b).append(c).append(a);d&&f.addClass("size-full-page");f.click(function(){$(this).hasClass("size-full-page")?e._rootElement.addClass("size-full-page"):e._rootElement.removeClass("size-full-page");
$(this).hasClass("state-selected")&&$(this).data("content").hasClass("state-selected")?e._rootElement.toggleClass("state-open"):(e._rootElement.addClass("state-open"),$(this).parents(".mcx-menu-header-item-list").find(".state-selected").removeClass("state-selected"),$(this).addClass("state-selected"),$(this).parents(".mcx-menu").find(".mcx-menu-tab-container").find(".state-selected").removeClass("state-selected"),$(this).data("content").addClass("state-selected"),e._isResizeRequired&&0==(e.getIsFullPage()&&
e.getIsOpen())&&(e.getResizeEventHandler().dispatchOnSuccess(this,null),e._isResizeRequired=!1))});0==this._menuHeaderItemList.children().length&&f.click();this._menuHeaderItemList.append(f);this._contentPageContainer.append(b)};
McxMenuBar.prototype.appendMenuContent=function(a){a=a.data(this._menuBarItemDataKey);var b=a.getContent();b.find(".mcx-menu-tab-content-item-label").each(function(a,b){var e=$(b).attr("data-localize");e&&($(b).prev(".mcx-menu-tab-content-item-image").attr("data-localize-for","title"),$(b).prev(".mcx-menu-tab-content-item-image").attr("data-localize",e.toString()))});this._contentPageContainer.append(b);McxLocalizationManager.localizeContent(b,a.getLocalizationFilePath(),!0);this.reCalculateButtonSize();
mcx.isInstanceOf(a,McxAddonMenuBarItem)&&a.getAddon().getRibbonControl().initialize(null)};McxMenuBar.prototype.onMenuBarItemContentLoaded=function(){var a=this.menuBar,b=this.menuBarHeaderItemElement,c=b.data(a._menuBarItemDataKey);a.selectMenuItem(b);c.getOnContentInitializeFinishHandler().removeListener(a.onMenuBarItemContentLoaded);a.reCalculateButtonSize()};
McxMenuBar.prototype.addMenuBarItem=function(a){this._rootElement.removeClass("state-empty");var b=this,c=$("<li/>").data(this._menuBarItemDataKey,a).addClass("mcx-menu-header-item"),d=$("<div/>").addClass("mcx-menu-header-item-image"),e=a.getMenuIcon()||"";0<e.indexOf(".png")||0<e.indexOf(".gif")||0<e.indexOf(".jpg")||0<e.indexOf(".jpeg")||0<e.indexOf("http")?d.css("background-image",'url("'+e+'")'):d.addClass(e);e=$("<div/>").attr("data-localize",a.getTitle()).text(McxLocalizationManager.getLocaleValue(a.getTitle())).addClass("mcx-menu-header-item-label");
a.getIsFullPage()&&c.addClass("size-full-page");c.append(d).append(e);McxLocalizationManager.localizeContent(c,a.getLocalizationFilePath());a.getOnContentInitializeFinishHandler().addListener(function(){var a=this.self,b=this.menuBarHeaderItemElement,c=this.menuBarItem;c.getContent()&&0==c.getContent().parents("body").length&&a.appendMenuContent(b)},null,{self:b,menuBarHeaderItemElement:c,menuBarItem:a});c.click(function(){var a=$(this),c=a.data(b._menuBarItemDataKey);null==c.getContent()?(c.getOnContentInitializeFinishHandler().removeListener(b.onMenuBarItemContentLoaded),
c.getOnContentInitializeFinishHandler().addListener(b.onMenuBarItemContentLoaded,null,{menuBar:b,menuBarHeaderItemElement:a}),c.initializeContent()):(c.getContent()&&0==c.getContent().parents("body").length&&b.appendMenuContent(a),b.selectMenuItem(a),b.reCalculateButtonSize())});this._menuHeaderItemList.append(c);this._menuBatItemList.push(a)};
McxMenuBar.prototype.removeCustomMenus=function(){this.getMenuItems(McxCustomMenu);var a=this;this._menuHeaderItemList.find(".mcx-menu-header-item").each(function(b,c){var d=$(c),e=d.data(a._menuBarItemDataKey);e&&mcx.isInstanceOf(e,McxCustomMenu)&&((e=e.getContent())&&e.remove(),d.remove())})};McxMenuBar.prototype.getActiveMenu=function(){return this._activeMenu};
McxMenuBar.prototype.selectMenuItem=function(a){var b=a.data(this._menuBarItemDataKey);this._activeMenu=b;a.hasClass("size-full-page")?this._rootElement.addClass("size-full-page"):this._rootElement.removeClass("size-full-page");a.hasClass("state-selected")&&b.getContent().hasClass("state-selected")?(this._rootElement.toggleClass("state-open").toggleClass("state-pin"),this.getIsFullPage()&&this._rootElement.hasClass("state-open")||this.getResizeEventHandler().dispatchOnSuccess(this,null)):(this._rootElement.addClass("state-open"),
a.parents(".mcx-menu-header-item-list").find(".state-selected").removeClass("state-selected"),a.addClass("state-selected"),a.parents(".mcx-menu").find(".mcx-menu-tab-container").find(".state-selected").removeClass("state-selected"),b.getContent().addClass("state-selected"),0==this.getIsFullPage()&&this.getResizeEventHandler().dispatchOnSuccess(this,null))};
McxMenuBar.prototype.showMenu=function(){0==this._menuHeaderItemList.find(".mcx-menu-header-item.state-selected").length?this._menuHeaderItemList.find(".mcx-menu-header-item:first").click():this._rootElement.addClass("state-open");0==this.getIsFullPage()?this.getResizeEventHandler().dispatchOnSuccess(this,null):this._isResizeRequired=!0};
McxMenuBar.prototype.hideMenu=function(){this._rootElement.removeClass("state-open");this.getResizeEventHandler().dispatchOnSuccess(this,null);this._isResizeRequired=!0};McxMenuBar.prototype.toggleMenuSize=function(){this._rootElement.toggleClass("size-small")};McxMenuBar.prototype.getIsOpen=function(){return this._rootElement.hasClass("state-open")};McxMenuBar.prototype.getIsFullPage=function(){return this._rootElement.hasClass("size-full-page")};
McxMenuBar.prototype.clear=function(){this._rootElement.removeClass().addClass("mcx-menu").addClass("state-empty");this._menuHeaderItemList.empty();this._contentPageContainer.empty()};McxMenuBar.prototype.getResizeEventHandler=function(){return this._resizeEventHandler};
McxMenuBar.prototype.reCalculateButtonSize=function(){var a=$("<div></div>").css({position:"absolute",visibility:"hidden",top:0,left:0}).appendTo($("body"));this._rootElement.find(".mcx-menu-tab-content-item-label").each(function(b,c){for(var d=0,e=$(c),f=e.html().split(" "),g=0;g<f.length;g++)a.text(f[g]),f[g+1]&&5>f[g].length&&6>f[g+1].length&&a.text(f[g]+" "+f[g+1]),d=Math.max(d,a.width());e.width(d+2)});a.remove()};
McxMenuBar.prototype.getMenuItems=function(a){return a?this._menuBatItemList.filter(function(b){return mcx.isInstanceOf(b,a)}):this._menuBatItemList};McxMenuBar.prototype.getContent=function(){return this._rootElement};js.app.McxApplication.MenuBar.McxSaveCustomMenuListAction={};function McxSaveCustomMenuListAction(a){this._menuList=a;this._settingKey="HTML5.Main.Menu.CustomMenu"}McxSaveCustomMenuListAction.prototype.execute=function(a){if(this._menuList){a=this.serializeCustomMenuRangeJson(this._menuList);McxSettingsManager.write(this._settingKey,a,null);a=McxApplication.getMenuBar();a.removeCustomMenus();for(var b=0;b<this._menuList.length;b++)a.addMenuBarItem(this._menuList[b].clone())}};
McxSaveCustomMenuListAction.prototype.serializeCustomMenuRangeJson=function(a){for(var b=[],c=0;c<a.length;c++){for(var d=a[c],e={title:d.getTitle(),items:[]},d=d.getCustomMenuItemList(),f=0;f<d.length;f++)e.items.push({elementId:d[f].getElementId(),addon:d[f].getAddonName()});b.push(e)}a="";try{a=JSON.stringify(b)}catch(g){McxMessageBox.show(null,McxLocalizationManager.getLocaleValue("McxApplication-mcxSaveCustomMenuJsonParseArror"),McxMessageBoxType.Error)}return a};
McxSaveCustomMenuListAction.prototype.isInstanceOf=function(a){return"McxSaveCustomMenuListAction"==a};js.app.McxApplication.MenuBar.McxShareWorkspaceAction={};function McxShareWorkspaceAction(a){this._workspaceInfo=a}
McxShareWorkspaceAction.prototype.execute=function(a){var b=new McxShareWorkspaceDialog;a=McxApplication.getSecurityManager().getNodeUsers();var c=McxApplication.getSecurityManager().getWorkspaceSharedUsers(this._workspaceInfo);b.setUserRange(a);b.setAlreadySharedUserRange(c);var d=McxApplication.getSecurityManager().hasWritePermissionOnWorkspace(this._workspaceInfo);b.setIsReadOnly(!d);McxApplication.addFloatingDialog(b,!0,!1,!0,!0);b.getOkButtonClickHandler().addListener(function(){if(d){var a=
b.getSelectedUsers();McxApplication.getSecurityManager().shareWorkspace(this._workspaceInfo,a)}},null,this)};McxShareWorkspaceAction.prototype.isInstanceOf=function(a){return"McxShareWorkspaceAction"==a};
